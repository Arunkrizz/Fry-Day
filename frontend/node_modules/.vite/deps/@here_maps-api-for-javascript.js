import "./chunk-2LSFTFF7.js";

// node_modules/@here/maps-api-for-javascript/bin/mapsjs.bundle.js
(function() {
  var p, aa = [];
  function ba(a2) {
    return function() {
      return aa[a2].apply(this, arguments);
    };
  }
  function ca(a2, b2) {
    return aa[a2] = b2;
  }
  function da(a2) {
    var b2 = 0;
    return function() {
      return b2 < a2.length ? { done: false, value: a2[b2++] } : { done: true };
    };
  }
  function ea(a2) {
    var b2 = "undefined" != typeof Symbol && Symbol.iterator && a2[Symbol.iterator];
    return b2 ? b2.call(a2) : { next: da(a2) };
  }
  function fa(a2) {
    for (var b2, c2 = []; !(b2 = a2.next()).done; )
      c2.push(b2.value);
    return c2;
  }
  var ia = "function" == typeof Object.defineProperties ? Object.defineProperty : function(a2, b2, c2) {
    a2 != Array.prototype && a2 != Object.prototype && (a2[b2] = c2.value);
  }, ja = "undefined" != typeof window && window === this ? this : "undefined" != typeof global && null != global ? global : this;
  function ka(a2, b2) {
    if (b2) {
      var c2 = ja;
      a2 = a2.split(".");
      for (var d = 0; d < a2.length - 1; d++) {
        var e = a2[d];
        e in c2 || (c2[e] = {});
        c2 = c2[e];
      }
      a2 = a2[a2.length - 1];
      d = c2[a2];
      b2 = b2(d);
      b2 != d && null != b2 && ia(c2, a2, { configurable: true, writable: true, value: b2 });
    }
  }
  ka("Array.prototype.find", function(a2) {
    return a2 ? a2 : function(b2, c2) {
      a: {
        var d = this;
        d instanceof String && (d = String(d));
        for (var e = d.length, f2 = 0; f2 < e; f2++) {
          var g = d[f2];
          if (b2.call(c2, g, f2, d)) {
            b2 = g;
            break a;
          }
        }
        b2 = void 0;
      }
      return b2;
    };
  });
  function la() {
    la = function() {
    };
    ja.Symbol || (ja.Symbol = ma);
  }
  function na(a2, b2) {
    this.a = a2;
    ia(this, "description", { configurable: true, writable: true, value: b2 });
  }
  na.prototype.toString = function() {
    return this.a;
  };
  var ma = function() {
    function a2(c2) {
      if (this instanceof a2)
        throw new TypeError("Symbol is not a constructor");
      return new na("jscomp_symbol_" + (c2 || "") + "_" + b2++, c2);
    }
    var b2 = 0;
    return a2;
  }();
  function oa() {
    la();
    var a2 = ja.Symbol.iterator;
    a2 || (a2 = ja.Symbol.iterator = ja.Symbol("Symbol.iterator"));
    "function" != typeof Array.prototype[a2] && ia(Array.prototype, a2, { configurable: true, writable: true, value: function() {
      return pa(da(this));
    } });
    oa = function() {
    };
  }
  function pa(a2) {
    oa();
    a2 = { next: a2 };
    a2[ja.Symbol.iterator] = function() {
      return this;
    };
    return a2;
  }
  function qa(a2, b2) {
    oa();
    a2 instanceof String && (a2 += "");
    var c2 = 0, d = { next: function() {
      if (c2 < a2.length) {
        var e = c2++;
        return { value: b2(e, a2[e]), done: false };
      }
      d.next = function() {
        return { done: true, value: void 0 };
      };
      return d.next();
    } };
    d[Symbol.iterator] = function() {
      return d;
    };
    return d;
  }
  ka("Array.prototype.keys", function(a2) {
    return a2 ? a2 : function() {
      return qa(this, function(b2) {
        return b2;
      });
    };
  });
  var ra;
  if ("function" == typeof Object.setPrototypeOf)
    ra = Object.setPrototypeOf;
  else {
    var sa;
    a: {
      var ta = { Fg: true }, ua = {};
      try {
        ua.__proto__ = ta;
        sa = ua.Fg;
        break a;
      } catch (a2) {
      }
      sa = false;
    }
    ra = sa ? function(a2, b2) {
      a2.__proto__ = b2;
      if (a2.__proto__ !== b2)
        throw new TypeError(a2 + " is not extensible");
      return a2;
    } : null;
  }
  var va = ra;
  ka("Object.setPrototypeOf", function(a2) {
    return a2 || va;
  });
  ka("Object.values", function(a2) {
    return a2 ? a2 : function(b2) {
      var c2 = [], d;
      for (d in b2)
        Object.prototype.hasOwnProperty.call(b2, d) && c2.push(b2[d]);
      return c2;
    };
  });
  ka("Object.is", function(a2) {
    return a2 ? a2 : function(b2, c2) {
      return b2 === c2 ? 0 !== b2 || 1 / b2 === 1 / c2 : b2 !== b2 && c2 !== c2;
    };
  });
  ka("Array.prototype.includes", function(a2) {
    return a2 ? a2 : function(b2, c2) {
      var d = this;
      d instanceof String && (d = String(d));
      var e = d.length;
      c2 = c2 || 0;
      for (0 > c2 && (c2 = Math.max(c2 + e, 0)); c2 < e; c2++) {
        var f2 = d[c2];
        if (f2 === b2 || Object.is(f2, b2))
          return true;
      }
      return false;
    };
  });
  ka("Promise", function(a2) {
    function b2(g) {
      this.C = 0;
      this.b = void 0;
      this.a = [];
      var h = this.c();
      try {
        g(h.resolve, h.reject);
      } catch (k) {
        h.reject(k);
      }
    }
    function c2() {
      this.a = null;
    }
    function d(g) {
      return g instanceof b2 ? g : new b2(function(h) {
        h(g);
      });
    }
    if (a2)
      return a2;
    c2.prototype.b = function(g) {
      if (null == this.a) {
        this.a = [];
        var h = this;
        this.c(function() {
          h.g();
        });
      }
      this.a.push(g);
    };
    var e = ja.setTimeout;
    c2.prototype.c = function(g) {
      e(g, 0);
    };
    c2.prototype.g = function() {
      for (; this.a && this.a.length; ) {
        var g = this.a;
        this.a = [];
        for (var h = 0; h < g.length; ++h) {
          var k = g[h];
          g[h] = null;
          try {
            k();
          } catch (l) {
            this.f(l);
          }
        }
      }
      this.a = null;
    };
    c2.prototype.f = function(g) {
      this.c(function() {
        throw g;
      });
    };
    b2.prototype.c = function() {
      function g(l) {
        return function(m) {
          k || (k = true, l.call(h, m));
        };
      }
      var h = this, k = false;
      return { resolve: g(this.m), reject: g(this.f) };
    };
    b2.prototype.m = function(g) {
      if (g === this)
        this.f(new TypeError("A Promise cannot resolve to itself"));
      else if (g instanceof b2)
        this.U(g);
      else {
        a:
          switch (typeof g) {
            case "object":
              var h = null != g;
              break a;
            case "function":
              h = true;
              break a;
            default:
              h = false;
          }
        h ? this.s(g) : this.g(g);
      }
    };
    b2.prototype.s = function(g) {
      var h = void 0;
      try {
        h = g.then;
      } catch (k) {
        this.f(k);
        return;
      }
      "function" == typeof h ? this.u(h, g) : this.g(g);
    };
    b2.prototype.f = function(g) {
      this.i(2, g);
    };
    b2.prototype.g = function(g) {
      this.i(1, g);
    };
    b2.prototype.i = function(g, h) {
      if (0 != this.C)
        throw Error("Cannot settle(" + g + ", " + h + "): Promise already settled in state" + this.C);
      this.C = g;
      this.b = h;
      this.l();
    };
    b2.prototype.l = function() {
      if (null != this.a) {
        for (var g = 0; g < this.a.length; ++g)
          f2.b(this.a[g]);
        this.a = null;
      }
    };
    var f2 = new c2();
    b2.prototype.U = function(g) {
      var h = this.c();
      g.sf(h.resolve, h.reject);
    };
    b2.prototype.u = function(g, h) {
      var k = this.c();
      try {
        g.call(h, k.resolve, k.reject);
      } catch (l) {
        k.reject(l);
      }
    };
    b2.prototype.then = function(g, h) {
      function k(q, r) {
        return "function" == typeof q ? function(v) {
          try {
            l(q(v));
          } catch (w) {
            m(w);
          }
        } : r;
      }
      var l, m, n = new b2(function(q, r) {
        l = q;
        m = r;
      });
      this.sf(k(g, l), k(h, m));
      return n;
    };
    b2.prototype.catch = function(g) {
      return this.then(void 0, g);
    };
    b2.prototype.sf = function(g, h) {
      function k() {
        switch (l.C) {
          case 1:
            g(l.b);
            break;
          case 2:
            h(l.b);
            break;
          default:
            throw Error("Unexpected state: " + l.C);
        }
      }
      var l = this;
      null == this.a ? f2.b(k) : this.a.push(k);
    };
    b2.resolve = d;
    b2.reject = function(g) {
      return new b2(function(h, k) {
        k(g);
      });
    };
    b2.race = function(g) {
      return new b2(function(h, k) {
        for (var l = ea(g), m = l.next(); !m.done; m = l.next())
          d(m.value).sf(h, k);
      });
    };
    b2.all = function(g) {
      var h = ea(g), k = h.next();
      return k.done ? d([]) : new b2(function(l, m) {
        function n(v) {
          return function(w) {
            q[v] = w;
            r--;
            0 == r && l(q);
          };
        }
        var q = [], r = 0;
        do
          q.push(void 0), r++, d(k.value).sf(n(q.length - 1), m), k = h.next();
        while (!k.done);
      });
    };
    return b2;
  });
  ka("Object.entries", function(a2) {
    return a2 ? a2 : function(b2) {
      var c2 = [], d;
      for (d in b2)
        Object.prototype.hasOwnProperty.call(b2, d) && c2.push([d, b2[d]]);
      return c2;
    };
  });
  var wa = "function" == typeof Object.assign ? Object.assign : function(a2, b2) {
    for (var c2 = 1; c2 < arguments.length; c2++) {
      var d = arguments[c2];
      if (d)
        for (var e in d)
          Object.prototype.hasOwnProperty.call(d, e) && (a2[e] = d[e]);
    }
    return a2;
  };
  ka("Object.assign", function(a2) {
    return a2 || wa;
  });
  ka("Math.log2", function(a2) {
    return a2 ? a2 : function(b2) {
      return Math.log(b2) / Math.LN2;
    };
  });
  var xa = this || self;
  function ya(a2, b2, c2) {
    a2 = a2.split(".");
    c2 = c2 || xa;
    a2[0] in c2 || "undefined" == typeof c2.execScript || c2.execScript("var " + a2[0]);
    for (var d; a2.length && (d = a2.shift()); )
      a2.length || void 0 === b2 ? c2[d] && c2[d] !== Object.prototype[d] ? c2 = c2[d] : c2 = c2[d] = {} : c2[d] = b2;
  }
  function za() {
  }
  function Aa(a2) {
    var b2 = typeof a2;
    if ("object" == b2)
      if (a2) {
        if (a2 instanceof Array)
          return "array";
        if (a2 instanceof Object)
          return b2;
        var c2 = Object.prototype.toString.call(a2);
        if ("[object Window]" == c2)
          return "object";
        if ("[object Array]" == c2 || "number" == typeof a2.length && "undefined" != typeof a2.splice && "undefined" != typeof a2.propertyIsEnumerable && !a2.propertyIsEnumerable("splice"))
          return "array";
        if ("[object Function]" == c2 || "undefined" != typeof a2.call && "undefined" != typeof a2.propertyIsEnumerable && !a2.propertyIsEnumerable("call"))
          return "function";
      } else
        return "null";
    else if ("function" == b2 && "undefined" == typeof a2.call)
      return "object";
    return b2;
  }
  function Ca(a2) {
    var b2 = Aa(a2);
    return "array" == b2 || "object" == b2 && "number" == typeof a2.length;
  }
  function Da(a2) {
    return "function" == Aa(a2);
  }
  function Ea(a2) {
    var b2 = typeof a2;
    return "object" == b2 && null != a2 || "function" == b2;
  }
  var Ga = "closure_uid_" + (1e9 * Math.random() >>> 0), Ha = 0;
  function Ia(a2, b2, c2) {
    return a2.call.apply(a2.bind, arguments);
  }
  function Ja(a2, b2, c2) {
    if (!a2)
      throw Error();
    if (2 < arguments.length) {
      var d = Array.prototype.slice.call(arguments, 2);
      return function() {
        var e = Array.prototype.slice.call(arguments);
        Array.prototype.unshift.apply(e, d);
        return a2.apply(b2, e);
      };
    }
    return function() {
      return a2.apply(b2, arguments);
    };
  }
  function Ka(a2, b2, c2) {
    Function.prototype.bind && -1 != Function.prototype.bind.toString().indexOf("native code") ? Ka = Ia : Ka = Ja;
    return Ka.apply(null, arguments);
  }
  function La(a2, b2) {
    var c2 = Array.prototype.slice.call(arguments, 1);
    return function() {
      var d = c2.slice();
      d.push.apply(d, arguments);
      return a2.apply(this, d);
    };
  }
  function t(a2, b2) {
    ya(a2, b2, void 0);
  }
  function u(a2, b2) {
    function c2() {
    }
    c2.prototype = b2.prototype;
    a2.j = b2.prototype;
    a2.prototype = new c2();
    a2.prototype.constructor = a2;
    a2.ap = function(d, e, f2) {
      for (var g = Array(arguments.length - 2), h = 2; h < arguments.length; h++)
        g[h - 2] = arguments[h];
      return b2.prototype[e].apply(d, g);
    };
  }
  ;
  function Ma(a2) {
    if (Error.captureStackTrace)
      Error.captureStackTrace(this, Ma);
    else {
      var b2 = Error().stack;
      b2 && (this.stack = b2);
    }
    a2 && (this.message = String(a2));
  }
  u(Ma, Error);
  Ma.prototype.name = "CustomError";
  function Na(a2, b2) {
    this.c = a2;
    this.f = b2;
    this.b = 0;
    this.a = null;
  }
  Na.prototype.get = function() {
    if (0 < this.b) {
      this.b--;
      var a2 = this.a;
      this.a = a2.next;
      a2.next = null;
    } else
      a2 = this.c();
    return a2;
  };
  Na.prototype.put = function(a2) {
    this.f(a2);
    100 > this.b && (this.b++, a2.next = this.a, this.a = a2);
  };
  function Oa() {
    this.b = this.a = null;
  }
  var Qa = new Na(function() {
    return new Pa();
  }, function(a2) {
    a2.reset();
  });
  Oa.prototype.add = function(a2, b2) {
    var c2 = Qa.get();
    c2.set(a2, b2);
    this.b ? this.b.next = c2 : this.a = c2;
    this.b = c2;
  };
  Oa.prototype.remove = function() {
    var a2 = null;
    this.a && (a2 = this.a, this.a = this.a.next, this.a || (this.b = null), a2.next = null);
    return a2;
  };
  function Pa() {
    this.next = this.b = this.a = null;
  }
  Pa.prototype.set = function(a2, b2) {
    this.a = a2;
    this.b = b2;
    this.next = null;
  };
  Pa.prototype.reset = function() {
    this.next = this.b = this.a = null;
  };
  var Ra = String.prototype.trim ? function(a2) {
    return a2.trim();
  } : function(a2) {
    return /^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a2)[1];
  };
  function Sa(a2, b2) {
    return -1 != a2.indexOf(b2);
  }
  function Ta(a2, b2) {
    return a2 < b2 ? -1 : a2 > b2 ? 1 : 0;
  }
  ;
  function Ua(a2, b2) {
    for (var c2 in a2)
      if (b2.call(void 0, a2[c2], c2, a2))
        return true;
    return false;
  }
  function Va(a2) {
    for (var b2 in a2)
      return false;
    return true;
  }
  function Wa(a2) {
    var b2 = {}, c2;
    for (c2 in a2)
      b2[c2] = a2[c2];
    return b2;
  }
  var Xa = "constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
  function Ya(a2, b2) {
    for (var c2, d, e = 1; e < arguments.length; e++) {
      d = arguments[e];
      for (c2 in d)
        a2[c2] = d[c2];
      for (var f2 = 0; f2 < Xa.length; f2++)
        c2 = Xa[f2], Object.prototype.hasOwnProperty.call(d, c2) && (a2[c2] = d[c2]);
    }
  }
  ;
  var Za;
  a: {
    var $a = xa.navigator;
    if ($a) {
      var ab = $a.userAgent;
      if (ab) {
        Za = ab;
        break a;
      }
    }
    Za = "";
  }
  function bb(a2) {
    return Sa(Za, a2);
  }
  ;
  var cb = Array.prototype.indexOf ? function(a2, b2) {
    return Array.prototype.indexOf.call(a2, b2, void 0);
  } : function(a2, b2) {
    if ("string" === typeof a2)
      return "string" !== typeof b2 || 1 != b2.length ? -1 : a2.indexOf(b2, 0);
    for (var c2 = 0; c2 < a2.length; c2++)
      if (c2 in a2 && a2[c2] === b2)
        return c2;
    return -1;
  };
  function db(a2, b2) {
    this.b = a2 === eb && b2 || "";
    this.a = fb;
  }
  var fb = {}, eb = {}, gb = new db(eb, "");
  function hb(a2, b2) {
    this.b = a2 === ib && b2 || "";
    this.a = jb;
  }
  hb.prototype.rc = function() {
    return 1;
  };
  var jb = {}, ib = {};
  function kb() {
    this.b = "";
    this.c = lb;
    this.a = null;
  }
  kb.prototype.rc = function() {
    return this.a;
  };
  function mb() {
    var a2 = nb;
    if (a2 instanceof kb && a2.constructor === kb && a2.c === lb)
      return a2.b;
    Aa(a2);
    return "type_error:SafeHtml";
  }
  var lb = {};
  function ob(a2) {
    var b2 = new kb();
    b2.b = a2;
    b2.a = 0;
    return b2;
  }
  ob("<!DOCTYPE html>");
  var nb = ob("");
  ob("<br>");
  function pb(a2) {
    var b2 = new hb(ib, gb instanceof db && gb.constructor === db && gb.a === fb ? gb.b : "type_error:Const");
    b2 instanceof hb && b2.constructor === hb && b2.a === jb ? b2 = b2.b : (Aa(b2), b2 = "type_error:TrustedResourceUrl");
    a2.src = b2.toString();
  }
  ;
  function qb(a2) {
    qb[" "](a2);
    return a2;
  }
  qb[" "] = za;
  function sb(a2, b2) {
    var c2 = tb;
    return Object.prototype.hasOwnProperty.call(c2, a2) ? c2[a2] : c2[a2] = b2(a2);
  }
  ;
  var ub = bb("Opera"), vb = bb("Trident") || bb("MSIE"), wb = bb("Edge"), xb = bb("Gecko") && !(Sa(Za.toLowerCase(), "webkit") && !bb("Edge")) && !(bb("Trident") || bb("MSIE")) && !bb("Edge"), yb = Sa(Za.toLowerCase(), "webkit") && !bb("Edge");
  function zb() {
    var a2 = xa.document;
    return a2 ? a2.documentMode : void 0;
  }
  var Ab;
  a: {
    var Bb = "", Cb = function() {
      var a2 = Za;
      if (xb)
        return /rv:([^\);]+)(\)|;)/.exec(a2);
      if (wb)
        return /Edge\/([\d\.]+)/.exec(a2);
      if (vb)
        return /\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a2);
      if (yb)
        return /WebKit\/(\S+)/.exec(a2);
      if (ub)
        return /(?:Version)[ \/]?(\S+)/.exec(a2);
    }();
    Cb && (Bb = Cb ? Cb[1] : "");
    if (vb) {
      var Db = zb();
      if (null != Db && Db > parseFloat(Bb)) {
        Ab = String(Db);
        break a;
      }
    }
    Ab = Bb;
  }
  var tb = {};
  function Eb(a2) {
    return sb(a2, function() {
      for (var b2 = 0, c2 = Ra(String(Ab)).split("."), d = Ra(String(a2)).split("."), e = Math.max(c2.length, d.length), f2 = 0; 0 == b2 && f2 < e; f2++) {
        var g = c2[f2] || "", h = d[f2] || "";
        do {
          g = /(\d*)(\D*)(.*)/.exec(g) || ["", "", "", ""];
          h = /(\d*)(\D*)(.*)/.exec(h) || ["", "", "", ""];
          if (0 == g[0].length && 0 == h[0].length)
            break;
          b2 = 0 == g[1].length ? 0 : parseInt(g[1], 10);
          var k = 0 == h[1].length ? 0 : parseInt(h[1], 10);
          b2 = Ta(b2, k) || Ta(0 == g[2].length, 0 == h[2].length) || Ta(g[2], h[2]);
          g = g[3];
          h = h[3];
        } while (0 == b2);
      }
      return 0 <= b2;
    });
  }
  var Fb;
  Fb = xa.document && vb ? zb() : void 0;
  !xb && !vb || vb && 9 <= Number(Fb) || xb && Eb("1.9.1");
  vb && Eb("9");
  function Gb(a2) {
    var b2 = document;
    a2 = String(a2);
    "application/xhtml+xml" === b2.contentType && (a2 = a2.toLowerCase());
    return b2.createElement(a2);
  }
  ;
  function Hb(a2) {
    xa.setTimeout(function() {
      throw a2;
    }, 0);
  }
  var Ib;
  function Kb() {
    var a2 = xa.MessageChannel;
    "undefined" === typeof a2 && "undefined" !== typeof window && window.postMessage && window.addEventListener && !bb("Presto") && (a2 = function() {
      var e = Gb("IFRAME");
      e.style.display = "none";
      pb(e);
      document.documentElement.appendChild(e);
      var f2 = e.contentWindow;
      e = f2.document;
      e.open();
      e.write(mb());
      e.close();
      var g = "callImmediate" + Math.random(), h = "file:" == f2.location.protocol ? "*" : f2.location.protocol + "//" + f2.location.host;
      e = Ka(
        function(k) {
          if (("*" == h || k.origin == h) && k.data == g)
            this.port1.onmessage();
        },
        this
      );
      f2.addEventListener("message", e, false);
      this.port1 = {};
      this.port2 = { postMessage: function() {
        f2.postMessage(g, h);
      } };
    });
    if ("undefined" !== typeof a2 && !bb("Trident") && !bb("MSIE")) {
      var b2 = new a2(), c2 = {}, d = c2;
      b2.port1.onmessage = function() {
        if (void 0 !== c2.next) {
          c2 = c2.next;
          var e = c2.bj;
          c2.bj = null;
          e();
        }
      };
      return function(e) {
        d.next = { bj: e };
        d = d.next;
        b2.port2.postMessage(0);
      };
    }
    return "undefined" !== typeof document && "onreadystatechange" in Gb("SCRIPT") ? function(e) {
      var f2 = Gb("SCRIPT");
      f2.onreadystatechange = function() {
        f2.onreadystatechange = null;
        f2.parentNode.removeChild(f2);
        f2 = null;
        e();
        e = null;
      };
      document.documentElement.appendChild(f2);
    } : function(e) {
      xa.setTimeout(e, 0);
    };
  }
  ;
  function Lb(a2, b2) {
    Mb || Nb();
    Ob || (Mb(), Ob = true);
    Pb.add(a2, b2);
  }
  var Mb;
  function Nb() {
    if (xa.Promise && xa.Promise.resolve) {
      var a2 = xa.Promise.resolve(void 0);
      Mb = function() {
        a2.then(Qb);
      };
    } else
      Mb = function() {
        var b2 = Qb;
        !Da(xa.setImmediate) || xa.Window && xa.Window.prototype && !bb("Edge") && xa.Window.prototype.setImmediate == xa.setImmediate ? (Ib || (Ib = Kb()), Ib(b2)) : xa.setImmediate(b2);
      };
  }
  var Ob = false, Pb = new Oa();
  function Qb() {
    for (var a2; a2 = Pb.remove(); ) {
      try {
        a2.a.call(a2.b);
      } catch (b2) {
        Hb(b2);
      }
      Qa.put(a2);
    }
    Ob = false;
  }
  ;
  function Rb(a2) {
    this.C = Sb;
    this.i = void 0;
    this.c = this.a = this.b = null;
    this.f = this.g = false;
    if (a2 != za)
      try {
        var b2 = this;
        a2.call(void 0, function(c2) {
          Tb(b2, Ub, c2);
        }, function(c2) {
          Tb(b2, Vb, c2);
        });
      } catch (c2) {
        Tb(this, Vb, c2);
      }
  }
  var Sb = 0, Ub = 2, Vb = 3;
  function Wb() {
    this.next = this.c = this.b = this.f = this.a = null;
    this.g = false;
  }
  Wb.prototype.reset = function() {
    this.c = this.b = this.f = this.a = null;
    this.g = false;
  };
  var Xb = new Na(function() {
    return new Wb();
  }, function(a2) {
    a2.reset();
  });
  function Yb(a2, b2, c2) {
    var d = Xb.get();
    d.f = a2;
    d.b = b2;
    d.c = c2;
    return d;
  }
  function Zb(a2) {
    if (a2 instanceof Rb)
      return a2;
    var b2 = new Rb(za);
    Tb(b2, Ub, a2);
    return b2;
  }
  function $b(a2) {
    return new Rb(function(b2, c2) {
      c2(a2);
    });
  }
  function ac() {
    var a2, b2, c2 = new Rb(function(d, e) {
      a2 = d;
      b2 = e;
    });
    return new cc(c2, a2, b2);
  }
  Rb.prototype.then = function(a2, b2, c2) {
    return dc(this, Da(a2) ? a2 : null, Da(b2) ? b2 : null, c2);
  };
  Rb.prototype.$goog_Thenable = true;
  Rb.prototype.cancel = function(a2) {
    if (this.C == Sb) {
      var b2 = new ec(a2);
      Lb(function() {
        fc(this, b2);
      }, this);
    }
  };
  function fc(a2, b2) {
    if (a2.C == Sb)
      if (a2.b) {
        var c2 = a2.b;
        if (c2.a) {
          for (var d = 0, e = null, f2 = null, g = c2.a; g && (g.g || (d++, g.a == a2 && (e = g), !(e && 1 < d))); g = g.next)
            e || (f2 = g);
          e && (c2.C == Sb && 1 == d ? fc(c2, b2) : (f2 ? (d = f2, d.next == c2.c && (c2.c = d), d.next = d.next.next) : gc(c2), hc(c2, e, Vb, b2)));
        }
        a2.b = null;
      } else
        Tb(a2, Vb, b2);
  }
  function ic(a2, b2) {
    a2.a || a2.C != Ub && a2.C != Vb || jc(a2);
    a2.c ? a2.c.next = b2 : a2.a = b2;
    a2.c = b2;
  }
  function dc(a2, b2, c2, d) {
    var e = Yb(null, null, null);
    e.a = new Rb(function(f2, g) {
      e.f = b2 ? function(h) {
        try {
          var k = b2.call(d, h);
          f2(k);
        } catch (l) {
          g(l);
        }
      } : f2;
      e.b = c2 ? function(h) {
        try {
          var k = c2.call(d, h);
          void 0 === k && h instanceof ec ? g(h) : f2(k);
        } catch (l) {
          g(l);
        }
      } : g;
    });
    e.a.b = a2;
    ic(a2, e);
    return e.a;
  }
  Rb.prototype.s = function(a2) {
    this.C = Sb;
    Tb(this, Ub, a2);
  };
  Rb.prototype.m = function(a2) {
    this.C = Sb;
    Tb(this, Vb, a2);
  };
  function Tb(a2, b2, c2) {
    if (a2.C == Sb) {
      a2 === c2 && (b2 = Vb, c2 = new TypeError("Promise cannot resolve to itself"));
      a2.C = 1;
      a: {
        var d = c2, e = a2.s, f2 = a2.m;
        if (d instanceof Rb) {
          ic(d, Yb(e || za, f2 || null, a2));
          var g = true;
        } else {
          if (d)
            try {
              var h = !!d.$goog_Thenable;
            } catch (l) {
              h = false;
            }
          else
            h = false;
          if (h)
            d.then(e, f2, a2), g = true;
          else {
            if (Ea(d))
              try {
                var k = d.then;
                if (Da(k)) {
                  kc(d, k, e, f2, a2);
                  g = true;
                  break a;
                }
              } catch (l) {
                f2.call(a2, l);
                g = true;
                break a;
              }
            g = false;
          }
        }
      }
      g || (a2.i = c2, a2.C = b2, a2.b = null, jc(a2), b2 != Vb || c2 instanceof ec || lc(a2, c2));
    }
  }
  function kc(a2, b2, c2, d, e) {
    function f2(k) {
      h || (h = true, d.call(e, k));
    }
    function g(k) {
      h || (h = true, c2.call(e, k));
    }
    var h = false;
    try {
      b2.call(a2, g, f2);
    } catch (k) {
      f2(k);
    }
  }
  function jc(a2) {
    a2.g || (a2.g = true, Lb(a2.l, a2));
  }
  function gc(a2) {
    var b2 = null;
    a2.a && (b2 = a2.a, a2.a = b2.next, b2.next = null);
    a2.a || (a2.c = null);
    return b2;
  }
  Rb.prototype.l = function() {
    for (var a2; a2 = gc(this); )
      hc(this, a2, this.C, this.i);
    this.g = false;
  };
  function hc(a2, b2, c2, d) {
    if (c2 == Vb && b2.b && !b2.g)
      for (; a2 && a2.f; a2 = a2.b)
        a2.f = false;
    if (b2.a)
      b2.a.b = null, mc(b2, c2, d);
    else
      try {
        b2.g ? b2.f.call(b2.c) : mc(b2, c2, d);
      } catch (e) {
        nc.call(null, e);
      }
    Xb.put(b2);
  }
  function mc(a2, b2, c2) {
    b2 == Ub ? a2.f.call(a2.c, c2) : a2.b && a2.b.call(a2.c, c2);
  }
  function lc(a2, b2) {
    a2.f = true;
    Lb(function() {
      a2.f && nc.call(null, b2);
    });
  }
  var nc = Hb;
  function ec(a2) {
    Ma.call(this, a2);
  }
  u(ec, Ma);
  ec.prototype.name = "cancel";
  function cc(a2, b2, c2) {
    this.Ak = a2;
    this.resolve = b2;
    this.reject = c2;
  }
  ;
  var x = this;
  function oc() {
    return Object.create(z, void 0);
  }
  var A = Ka, pc = String, qc = x.Object.freeze || function(a2) {
    return a2;
  };
  function rc(a2) {
    for (var b2 = Object.keys(a2), c2 = b2.length, d; c2--; )
      d = a2[b2[c2]], Ea(d) && rc(d);
    return qc(a2);
  }
  function sc(a2) {
    var b2 = Aa(a2);
    if ("object" == b2 || "array" == b2) {
      if (Da(a2.clone))
        return a2.clone();
      b2 = "array" == b2 ? [] : {};
      for (var c2 in a2)
        a2.hasOwnProperty(c2) && (b2[c2] = sc(a2[c2]));
      return b2;
    }
    return a2;
  }
  var B = [].pop(), z = /x/.exec("");
  function tc(a2, b2) {
    return pc(a2).split(b2 !== B ? b2 : " ");
  }
  var uc = "prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
  function C(a2, b2, c2, d, e) {
    if (!(b2 = a2 instanceof b2) && c2)
      throw new D(c2, d, vc(e) ? e : a2);
    return b2;
  }
  function xc(a2, b2) {
    if (true === (C(a2, b2) && a2.constructor === b2))
      throw new TypeError("Illegal constructor " + yc(b2));
  }
  function zc(a2, b2, c2, d, e) {
    if (!(b2 = Ac(a2) === b2) && c2)
      throw new D(c2, d, vc(e) ? e : a2);
    return b2;
  }
  function Bc(a2, b2, c2, d) {
    return zc(a2, "Array", b2, c2, d);
  }
  t("H.lang.isArray", Bc);
  function vc(a2) {
    return a2 !== B;
  }
  function Cc(a2) {
    return "string" === typeof a2;
  }
  t("H.lang.isString", Cc);
  var Dc = parseInt, Ec = parseFloat, E = isNaN;
  function Fc(a2) {
    return a2 === +a2;
  }
  t("H.lang.isNumber", Fc);
  t("H.lang.isInteger", Number.isInteger ? Number.isInteger : function(a2) {
    return "number" === typeof a2 && 0 === a2 % 1;
  });
  function Gc(a2) {
    return !E(+a2);
  }
  function Ac(a2) {
    var b2 = Object[uc[0]][uc[6]].call(a2).match(/^\[object (\w+)\]$/);
    return b2 ? b2[1] : typeof a2;
  }
  var Hc = [];
  function Ic(a2) {
    0 > Hc.indexOf(a2) && Hc.push(a2);
  }
  Ic(Hc);
  function yc(a2, b2, c2, d) {
    var e = "", f2 = 2 > arguments.length, g;
    f2 && (b2 = { H: x.H }, c2 = "", d = Hc.slice());
    Jc(b2, true, function(h, k) {
      try {
        if (g = h[k], k = Kc(h, g), !(Ea(g) && g.window === g && g.self === g || Ea(g) && 0 < g.nodeType && Da(g.cloneNode)) && Ea(g)) {
          if (g === a2)
            return e = c2 + "." + k, true;
          if (0 > d.indexOf(g) && (d.push(g), e = yc(a2, g, c2 + "." + k, d)))
            return true;
        }
      } catch (l) {
      }
    });
    f2 && (e = e ? e.substr(1).replace("." + uc[0] + ".", "#") : "~" + (Da(a2) ? Lc(a2) + "()" : Ac(a2)));
    return e;
  }
  function Kc(a2, b2) {
    var c2 = [];
    Jc(a2, false, function(d, e) {
      d[e] === b2 && c2.push(e);
    });
    return c2.sort(Mc)[0];
  }
  function Mc(a2, b2) {
    return b2.length - a2.length;
  }
  var Nc = Object[uc[0]][uc[2]];
  function Jc(a2, b2, c2) {
    var d;
    if (a2) {
      for (e in a2)
        if ((!b2 || Nc.call(a2, e)) && c2(a2, e, true))
          return;
      for (d = uc.length; d--; ) {
        var e = uc[d];
        if ((!b2 || Nc.call(a2, e)) && c2(a2, e, false))
          break;
      }
    }
  }
  function Lc(a2) {
    return (a2 = /^\s*function ([^\( ]+)/.exec(a2)) ? a2[1] : "anonymous";
  }
  function Oc(a2, b2, c2) {
    c2[b2] = "#" + b2;
  }
  var Pc = !!x.__karma__;
  function Qc() {
    throw Error("unimplemented method");
  }
  ;
  function Rc(a2, b2) {
    b2 = b2 || {};
    "status" in b2 && (this.status = +b2.status);
    "statusText" in b2 && (this.statusText = b2.statusText);
    this.ok = 200 <= this.status && 300 > this.status;
    this.f = false;
    a2 ? "string" === typeof a2 ? this.c = a2 : (b2 = x.ArrayBuffer) && b2.prototype.isPrototypeOf(a2) ? this.a = a2 : b2 && a2.buffer ? this.a = a2.buffer : x.Blob.prototype.isPrototypeOf(a2) && (this.b = a2) : this.c = "";
  }
  t("H.net.Response", Rc);
  Rc.prototype.type = "default";
  Rc.prototype.type = Rc.prototype.type;
  Rc.prototype.status = 200;
  Rc.prototype.status = Rc.prototype.status;
  Rc.prototype.statusText = "OK";
  Rc.prototype.statusText = Rc.prototype.statusText;
  function Sc(a2) {
    if (a2.f)
      return $b(new TypeError("Already read"));
    a2.f = true;
  }
  Rc.error = function() {
    Rc.a || (Rc.a = new Rc(null, { status: 0, statusText: "" }), Rc.a.type = "error");
    return Rc.a;
  };
  Rc.error = Rc.error;
  Rc.prototype.text = function() {
    var a2 = Sc(this);
    if (!a2)
      if (this.c)
        a2 = Zb(this.c);
      else if (this.a) {
        a2 = new Uint8Array(this.a);
        var b2 = a2.length, c2 = Array(b2), d;
        for (d = 0; d < b2; d++)
          c2[d] = String.fromCharCode(a2[d]);
        a2 = Zb(c2.join(""));
      } else
        this.b ? a2 = Tc(this.b) : a2 = $b("Unsupported response body");
    return a2;
  };
  Rc.prototype.json = function() {
    return this.text().then(x.JSON.parse);
  };
  Rc.prototype.blob = function() {
    var a2, b2 = Sc(this);
    b2 || (this.b ? a2 = this.b : this.a && (a2 = new Blob([this.a], { type: "application/octet-stream" })));
    return b2 || Zb(a2);
  };
  Rc.prototype.arrayBuffer = function() {
    return this.a ? Sc(this) || Zb(this.a.slice(0)) : this.blob().then(Rc.b);
  };
  Rc.b = function(a2) {
    var b2 = new FileReader();
    b2.readAsArrayBuffer(a2);
    return new Rb(function(c2, d) {
      b2.onload = function() {
        c2(b2.result);
      };
      b2.onerror = function() {
        d(b2.error);
      };
    });
  };
  function Tc(a2) {
    var b2 = new FileReader();
    b2.readAsText(a2);
    return new Rb(function(c2, d) {
      b2.onload = function() {
        c2(b2.result);
      };
      b2.onerror = function() {
        d(b2.error);
      };
    });
  }
  !Pc && x.Response && x.Response.error && (Rc = x.Response, Ic(Rc.prototype));
  function D(a2, b2, c2) {
    var d = arguments.length;
    b2 = b2 !== B ? +b2 : b2;
    if (b2 !== B) {
      var e = (e = /^.*?\(([^\)]+)/.exec(("" + a2).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm, ""))) ? tc(e[1].replace(/\s+/g, ""), ",") : [];
      e.forEach(Oc);
      e = e[b2] || "#" + b2;
    }
    var f2 = a2 ? yc(a2) : "";
    d = 2 < d ? pc(c2) : "";
    if (e || d)
      f2 += " (Argument " + (e || "") + (d ? " " + d : "") + ")";
    d = Error(f2);
    Object.setPrototypeOf(d, D.prototype);
    return d;
  }
  u(D, Error);
  t("H.lang.InvalidArgumentError", D);
  D.prototype.name = "InvalidArgumentError";
  function Uc(a2, b2, c2) {
    function d() {
      var m = A(l.b, l), n = +k.timeout || 0;
      Vc ? (Wc(l, "timeout", m), e.timeout = n) : n && (l.f = setTimeout(function() {
        e.abort();
        l.b({ type: "timeout" });
      }, n));
      Wc(l, "error", m);
      Wc(l, "load", m);
      e.send(k.data);
    }
    var e, f2, g, h = c2 && c2.headers || {}, k = {}, l = this;
    if (!Da(b2))
      throw new D(Uc, 1, "function required");
    Ya(h, Xc.headers, h);
    Ya(k, Xc, c2 || {});
    k.headers = h;
    this.c = b2;
    this.a = e = new XMLHttpRequest();
    b2 = k.method;
    try {
      e.open(b2, a2, true);
      for (f2 in h)
        h.hasOwnProperty(f2) && (g = h[f2]) && e.setRequestHeader(f2, g);
      e.withCredentials = !!k.withCredentials;
      d();
    } catch (m) {
      this.b({ type: "cors" });
    }
  }
  t("H.net.Xhr", Uc);
  var Xc = { method: "GET", headers: {}, data: null }, Yc = "withCredentials" in new XMLHttpRequest(), Vc = "timeout" in new XMLHttpRequest();
  function Wc(a2, b2, c2) {
    Yc ? a2.a.addEventListener(b2, c2) : a2.a["on" + b2] = c2;
  }
  function Zc(a2, b2, c2) {
    Yc ? a2.a.removeEventListener(b2, c2) : a2.a["on" + b2] = null;
  }
  Uc.prototype.abort = function() {
    this.a && (this.a.abort(), this.a && this.b({ type: "abort" }));
  };
  Uc.prototype.abort = Uc.prototype.abort;
  Uc.prototype.b = function(a2) {
    var b2 = a2.type;
    a2 = this.a;
    var c2;
    this.f && clearTimeout(this.f);
    "load" === b2 ? a2 instanceof XMLHttpRequest && 200 !== a2.status && (c2 = "network") : c2 = 4 === a2.readyState && 0 === a2.status && "error" == b2 ? "cors" : "error" != b2 ? b2 : "network";
    b2 = this.b;
    Zc(this, "timeout", b2);
    Zc(this, "error", b2);
    Zc(this, "load", b2);
    a2 = 0 === a2.status || c2 && "network" !== c2 ? Rc.error() : new Rc(a2.responseText || null, a2);
    c2 = this.c;
    delete this.b;
    delete this.c;
    delete this.a;
    c2(a2);
  };
  function $c(a2, b2) {
    var c2 = [];
    a2 && c2.push(yc(a2));
    1 < arguments.length && c2.push("" + b2);
    c2 = Error(c2.join(" "));
    Object.setPrototypeOf(c2, $c.prototype);
    return c2;
  }
  u($c, Error);
  t("H.lang.IllegalOperationError", $c);
  $c.prototype.name = "IllegalOperationError";
  var bd, cd, dd;
  function ed() {
    this.constructor = this.constructor;
    if (!Cc("STATIC_DB"))
      throw new D(this.constructor, 0);
    this.g = fd();
    if (!this.g)
      throw new $c(this.constructor, "This browser does not support IndexedDB");
    this.a = [];
    this.c = [];
    this.Zh = A(this.Zh, this);
  }
  var gd, hd;
  p = ed.prototype;
  p.put = function(a2, b2, c2, d) {
    if (!Cc(a2) && !Fc(a2))
      throw new D(this.put, 0);
    if (!id(b2))
      throw new D(this.put, 1);
    jd(this, function(e) {
      kd(e.put(b2, a2), c2, d);
    }, d);
  };
  p.get = function(a2, b2, c2) {
    var d;
    if (!Cc(a2) && !Fc(a2))
      throw new D(this.get, 0);
    if (!Da(b2))
      throw new D(this.get, 1);
    jd(this, function(e) {
      d = e.get(a2);
      kd(d, b2, c2);
    }, c2);
    return { cancel: function() {
      d && (d.onsuccess = ld);
    } };
  };
  p.remove = function(a2, b2, c2) {
    if (!Cc(a2) && !Fc(a2))
      throw new D(this.remove, 0);
    jd(this, function(d) {
      kd(d["delete"](a2), b2, c2);
    }, c2);
  };
  p.clear = function(a2, b2) {
    jd(this, function(c2) {
      kd(c2.clear(), a2, b2);
    }, b2);
  };
  p.Zh = function() {
    var a2 = this.b.result;
    a2.objectStoreNames.contains("data") || a2.createObjectStore("data");
  };
  function md(a2, b2, c2) {
    if (a2.b)
      a2.a ? (a2.a.push(b2), c2 && a2.c.push(c2)) : a2.f ? c2 && c2(a2.f) : b2(a2.b.result);
    else {
      a2.b = a2.g.open("H_STATIC_DB", 1);
      a2.b.onupgradeneeded = a2.Zh;
      var d = a2.b.onerror = function() {
        clearTimeout(a2.i);
        a2.f = this.error;
        a2.c.forEach(function(e) {
          e(a2.f);
        });
        delete a2.a;
        delete a2.c;
      };
      a2.i = setTimeout(function() {
        d.call({ error: Error("DbOpenTimeoutError") });
      }, 500);
      a2.b.onsuccess = function() {
        clearTimeout(a2.i);
        a2.a ? (a2.a.forEach(function(e) {
          e(this.result);
        }, this), delete a2.a, delete a2.c) : (delete a2.b, delete a2.f, a2.a = [], a2.c = []);
      };
      a2.a.push(b2);
      c2 && a2.c.push(c2);
    }
  }
  function jd(a2, b2, c2) {
    md(a2, function(d) {
      d = d.transaction(["data"], "readwrite");
      b2(d.objectStore("data"));
    }, c2);
  }
  function kd(a2, b2, c2) {
    b2 && (a2.onsuccess = function() {
      b2(this.result);
    });
    c2 && (a2.onerror = function() {
      c2(this.error);
    });
  }
  function id(a2) {
    var b2 = Object.prototype.toString.call(a2);
    return "[object Blob]" === b2 || "[object ArrayBuffer]" === b2 || Cc(a2) || Ea(a2);
  }
  function nd() {
    gd || (gd = new ed());
    return gd;
  }
  t("H.util.IndexedDBStorage.getInstance", nd);
  function fd() {
    return x.indexedDB || x.webkitIndexedDB || x.mozIndexedDB || x.msIndexedDB;
  }
  function od() {
    var a2 = "";
    if (!vc(hd))
      if ("file:" === window.location.protocol && -1 < navigator.userAgent.toLowerCase().indexOf("firefox") && 128 <= window.location.href.length)
        hd = false;
      else {
        try {
          var b2 = fd();
          a2 = "H_TEST_DB";
          var c2 = b2 && b2.open(a2, 1);
        } catch (d) {
        }
        hd = !!c2 && null === c2.onupgradeneeded;
        c2 && b2.deleteDatabase && b2.deleteDatabase(a2);
      }
    return hd;
  }
  t("H.util.IndexedDBStorage.isSupported", od);
  function qd() {
    0 != rd && (sd[this[Ga] || (this[Ga] = ++Ha)] = this);
    this.zd = this.zd;
    this.mb = this.mb;
  }
  var rd = 0, sd = {};
  qd.prototype.zd = false;
  qd.prototype.F = function() {
    if (!this.zd && (this.zd = true, this.o(), 0 != rd)) {
      var a2 = this[Ga] || (this[Ga] = ++Ha);
      if (0 != rd && this.mb && 0 < this.mb.length)
        throw Error(this + " did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");
      delete sd[a2];
    }
  };
  qd.prototype.tb = function(a2, b2) {
    this.zd ? void 0 !== b2 ? a2.call(b2) : a2() : (this.mb || (this.mb = []), this.mb.push(void 0 !== b2 ? Ka(a2, b2) : a2));
  };
  qd.prototype.o = function() {
    if (this.mb)
      for (; this.mb.length; )
        this.mb.shift()();
  };
  function td(a2) {
    a2 && "function" == typeof a2.F && a2.F();
  }
  ;
  function ud(a2, b2) {
    this.type = a2;
    this.currentTarget = this.target = b2;
    this.c = this.a = false;
    this.Ik = true;
  }
  ud.prototype.stopPropagation = function() {
    this.a = true;
  };
  ud.prototype.preventDefault = function() {
    this.c = true;
    this.Ik = false;
  };
  t("H.util.Event", ud);
  ud.prototype.stopPropagation = ud.prototype.stopPropagation;
  ud.prototype.stopPropagation = ud.prototype.stopPropagation;
  ud.prototype.CAPTURING_PHASE = 1;
  ud.prototype.CAPTURING_PHASE = ud.prototype.CAPTURING_PHASE;
  ud.prototype.AT_TARGET = 2;
  ud.prototype.AT_TARGET = ud.prototype.AT_TARGET;
  ud.prototype.BUBBLING_PHASE = 3;
  ud.prototype.BUBBLING_PHASE = ud.prototype.BUBBLING_PHASE;
  ud.prototype.eventPhase = 0;
  ud.prototype.eventPhase = ud.prototype.eventPhase;
  function vd(a2, b2, c2) {
    vd.j.constructor.call(this, a2, c2);
    this.data = b2;
  }
  u(vd, ud);
  t("H.util.DataEvent", vd);
  function wd(a2, b2, c2) {
    wd.j.constructor.call(this, a2, c2);
    this.message = b2;
  }
  u(wd, ud);
  t("H.util.ErrorEvent", wd);
  var xd = Math, yd = xd.min, zd = xd.max, Ad = xd.round, Bd = xd.floor, Cd = xd.ceil, Dd = xd.abs, Ed = xd.log, Fd = xd.sqrt, Gd = xd.pow, Hd = xd.exp, Id = xd.sin, Jd = xd.asin, Kd = xd.cos, Ld = xd.tan, Md = xd.atan, Nd = xd.atan2, Od = xd.LN2, Pd = xd.PI, Qd = Pd / 2, Rd = Pd / 4, Sd = 2 * Pd, Td = 3 * Pd, Ud = Pd / 180, Vd = 180 / Pd, Wd = 1 / 0, Xd = Gd(-2, 53), Yd = Yd || function(a2) {
    return Ed(a2) / Od;
  };
  function Zd(a2, b2) {
    var c2;
    return 0 > (c2 = a2 % b2) === 0 > b2 ? c2 : c2 + b2;
  }
  function $d(a2, b2, c2) {
    b2 -= c2 = c2 || 0;
    a2 -= c2;
    return a2 - Bd(a2 / b2) * b2 + c2;
  }
  t("H.math.normalize", $d);
  function ae(a2, b2, c2) {
    return a2 > c2 ? c2 : a2 < b2 ? b2 : a2;
  }
  t("H.math.clamp", ae);
  function be(a2, b2, c2, d) {
    d || (d = 0);
    return b2 < c2 ? a2 >= b2 - d && a2 <= c2 + d : a2 >= c2 - d && a2 <= b2 + d;
  }
  function ce(a2, b2, c2, d, e, f2) {
    return Fd(Gd((a2 - e) * (d - f2) - (b2 - f2) * (c2 - e), 2) / (Gd(c2 - e, 2) + Gd(d - f2, 2)));
  }
  var de = { NONE: 0, VERTEX: 1, EDGE: 2, SURFACE: 3 };
  t("H.math.CoverType", de);
  function ee(a2, b2, c2, d, e, f2) {
    var g = c2.length, h = g, k = c2[0], l = 0, m = 0, n = 0;
    d = d / 2 || 0;
    var q = f2 || 2;
    f2 = q * (e ? 0 : 1) + 1;
    for (var r = q - 2; 1 != l && h > f2; ) {
      h -= r;
      var v = c2[--h];
      q = c2[--h];
      var w = c2[h ? h - r - 1 : (g + (h - r - 1)) % g];
      var y = c2[h ? h - r - 2 : (g + (h - r - 2)) % g];
      if (q >= a2 - d && q <= a2 + d && v >= b2 - d && v <= b2 + d || y >= a2 - d && y <= a2 + d && w >= b2 - d && w <= b2 + d)
        l = 1;
      else if (!l && q === a2)
        y === a2 && (v < b2 && w > b2 || v > b2 && w < b2) || (k <= a2 && y > a2 || k >= a2 && y < a2) && (v >= b2 ? ++m : ++n), l = be(b2, v, w, d) && ce(a2, b2, q, v, y, w) <= d ? 2 : 0;
      else if (!l && be(a2, q, y, d)) {
        if (q < a2 && y > a2 || q > a2 && y < a2)
          k = v + (a2 - q) / (y - q) * (w - v), m += k > b2, n += k < b2;
        l = be(b2, v, w, d) && ce(a2, b2, q, v, y, w) <= d ? 2 : 0;
      }
      k = q;
    }
    !l && e && 0 !== n && 0 !== m % 2 && (l = 3);
    return l;
  }
  function fe(a2, b2) {
    return ee(a2.x, a2.y, b2, 0, true) !== de.NONE;
  }
  t("H.math.isPointInsidePolygon", fe);
  function ge(a2) {
    for (var b2 = a2.length, c2 = new Float64Array(2 * b2), d = b2 && vc(a2[0].x); b2--; ) {
      var e = a2[b2], f2 = b2 << 1;
      c2[f2] = d ? e.x : e[0];
      c2[f2 + 1] = d ? e.y : e[1];
    }
    return c2;
  }
  t("H.math.flatten", ge);
  function he() {
  }
  t("H.util.ICancelable", he);
  he.prototype.cancel = function() {
  };
  he.prototype.cancel = he.prototype.cancel;
  function ie(a2, b2, c2) {
    this.type = a2;
    this.data = b2;
    this.c = ac();
    this.resolve = A(this.resolve, this);
    this.reject = A(this.reject, this);
    this.priority = je;
    c2 !== B && (this.priority = c2);
    this.fh().add(this);
  }
  var je = 1, ke = { Vo: 0, Yo: je, To: 2 };
  p = ie.prototype;
  p.then = function(a2, b2, c2) {
    return this.c.Ak.then(a2, b2, c2);
  };
  p.resolve = function(a2) {
    this.Yd = 3;
    this.c.resolve(a2);
  };
  p.reject = function(a2) {
    this.Yd = 5;
    this.c.reject(a2);
  };
  p.Yd = 0;
  p.cancel = function() {
    3 > this.Yd && (this.oe(), this.fh().remove(this), this.Yd = 4);
  };
  ie.prototype.cancel = ie.prototype.cancel;
  function le(a2) {
    var b2;
    this.a = {};
    for (b2 in ke)
      this.a[ke[b2]] = [];
    this.Ze = a2;
    this.Ze.addEventListener("allocatable", A(this.b, this));
  }
  t("H.util.JobManager", le);
  var me = Object.keys(ke).map(function(a2) {
    return ke[a2];
  }).sort().reverse();
  le.prototype.add = function(a2) {
    C(a2, ie, this.add, 0);
    this.a[a2.priority].push(a2);
    this.b();
  };
  le.prototype.contains = function(a2) {
    return -1 < this.a[a2.priority].indexOf(a2);
  };
  le.prototype.remove = function(a2) {
    var b2 = a2.priority, c2 = this.a[b2].indexOf(a2);
    if (-1 < c2)
      return this.a[b2].splice(c2, 1), true;
    a2.Li && this.Ze.yf(a2.Li);
    return false;
  };
  le.prototype.b = function() {
    me.forEach(function(a2) {
      this.a[a2] = this.a[a2].filter(function(b2) {
        var c2;
        if ((c2 = this.Ze.Jg(b2)) !== z) {
          var d = A(this.Ze.yf, this.Ze, c2, b2);
          b2.Li = c2;
          b2.then(d, d);
          b2.Yd = b2.qj(c2) ? 1 : 5;
        } else
          return true;
      }, this);
    }, this);
  };
  function ne(a2, b2, c2) {
    var d = [], e = arguments.length;
    a2 && d.push(yc(a2));
    1 < e && (e = 2 < e && Bc(c2) ? " out of [" + c2[0] + "..." + c2[1] + "]" : "", d.push("(" + b2 + e + ")"));
    d = Error(d.join(" "));
    Object.setPrototypeOf(d, ne.prototype);
    return d;
  }
  u(ne, Error);
  t("H.lang.OutOfRangeError", ne);
  ne.prototype.name = "OutOfRangeError";
  var oe = "closure_listenable_" + (1e6 * Math.random() | 0);
  function pe(a2) {
    return !(!a2 || !a2[oe]);
  }
  var qe = 0;
  function re(a2, b2, c2, d, e) {
    this.listener = a2;
    this.proxy = null;
    this.src = b2;
    this.type = c2;
    this.capture = !!d;
    this.Mf = e;
    this.key = ++qe;
    this.be = this.rf = false;
  }
  function se(a2) {
    a2.be = true;
    a2.listener = null;
    a2.proxy = null;
    a2.src = null;
    a2.Mf = null;
  }
  ;
  function te(a2) {
    this.src = a2;
    this.a = {};
    this.b = 0;
  }
  te.prototype.add = function(a2, b2, c2, d, e) {
    var f2 = a2.toString();
    a2 = this.a[f2];
    a2 || (a2 = this.a[f2] = [], this.b++);
    var g = ue(a2, b2, d, e);
    -1 < g ? (b2 = a2[g], c2 || (b2.rf = false)) : (b2 = new re(b2, this.src, f2, !!d, e), b2.rf = c2, a2.push(b2));
    return b2;
  };
  te.prototype.remove = function(a2, b2, c2, d) {
    a2 = a2.toString();
    if (!(a2 in this.a))
      return false;
    var e = this.a[a2];
    b2 = ue(e, b2, c2, d);
    return -1 < b2 ? (se(e[b2]), Array.prototype.splice.call(e, b2, 1), 0 == e.length && (delete this.a[a2], this.b--), true) : false;
  };
  function ve(a2, b2) {
    var c2 = b2.type;
    if (!(c2 in a2.a))
      return false;
    var d = a2.a[c2], e = cb(d, b2), f2;
    (f2 = 0 <= e) && Array.prototype.splice.call(d, e, 1);
    f2 && (se(b2), 0 == a2.a[c2].length && (delete a2.a[c2], a2.b--));
    return f2;
  }
  te.prototype.na = function(a2) {
    a2 = a2 && a2.toString();
    var b2 = 0, c2;
    for (c2 in this.a)
      if (!a2 || c2 == a2) {
        for (var d = this.a[c2], e = 0; e < d.length; e++)
          ++b2, se(d[e]);
        delete this.a[c2];
        this.b--;
      }
    return b2;
  };
  te.prototype.sh = function(a2, b2) {
    var c2 = void 0 !== a2, d = c2 ? a2.toString() : "", e = void 0 !== b2;
    return Ua(this.a, function(f2) {
      for (var g = 0; g < f2.length; ++g)
        if (!(c2 && f2[g].type != d || e && f2[g].capture != b2))
          return true;
      return false;
    });
  };
  function ue(a2, b2, c2, d) {
    for (var e = 0; e < a2.length; ++e) {
      var f2 = a2[e];
      if (!f2.be && f2.listener == b2 && f2.capture == !!c2 && f2.Mf == d)
        return e;
    }
    return -1;
  }
  ;
  var we = !vb || 9 <= Number(Fb), xe = vb && !Eb("9");
  !yb || Eb("528");
  xb && Eb("1.9b") || vb && Eb("8") || ub && Eb("9.5") || yb && Eb("528");
  xb && !Eb("8") || vb && Eb("9");
  var ye = function() {
    if (!xa.addEventListener || !Object.defineProperty)
      return false;
    var a2 = false, b2 = Object.defineProperty({}, "passive", { get: function() {
      a2 = true;
    } });
    try {
      xa.addEventListener("test", za, b2), xa.removeEventListener("test", za, b2);
    } catch (c2) {
    }
    return a2;
  }();
  function ze(a2, b2) {
    ud.call(this, a2 ? a2.type : "");
    this.relatedTarget = this.currentTarget = this.target = null;
    this.button = this.screenY = this.screenX = this.clientY = this.clientX = 0;
    this.key = "";
    this.metaKey = this.shiftKey = this.altKey = this.ctrlKey = false;
    this.pointerId = 0;
    this.pointerType = "";
    this.b = null;
    if (a2) {
      var c2 = this.type = a2.type, d = a2.changedTouches && a2.changedTouches.length ? a2.changedTouches[0] : null;
      this.target = a2.target || a2.srcElement;
      this.currentTarget = b2;
      if (b2 = a2.relatedTarget) {
        if (xb) {
          a: {
            try {
              qb(b2.nodeName);
              var e = true;
              break a;
            } catch (f2) {
            }
            e = false;
          }
          e || (b2 = null);
        }
      } else
        "mouseover" == c2 ? b2 = a2.fromElement : "mouseout" == c2 && (b2 = a2.toElement);
      this.relatedTarget = b2;
      d ? (this.clientX = void 0 !== d.clientX ? d.clientX : d.pageX, this.clientY = void 0 !== d.clientY ? d.clientY : d.pageY, this.screenX = d.screenX || 0, this.screenY = d.screenY || 0) : (this.clientX = void 0 !== a2.clientX ? a2.clientX : a2.pageX, this.clientY = void 0 !== a2.clientY ? a2.clientY : a2.pageY, this.screenX = a2.screenX || 0, this.screenY = a2.screenY || 0);
      this.button = a2.button;
      this.key = a2.key || "";
      this.ctrlKey = a2.ctrlKey;
      this.altKey = a2.altKey;
      this.shiftKey = a2.shiftKey;
      this.metaKey = a2.metaKey;
      this.pointerId = a2.pointerId || 0;
      this.pointerType = "string" === typeof a2.pointerType ? a2.pointerType : Ae[a2.pointerType] || "";
      this.b = a2;
      a2.defaultPrevented && this.preventDefault();
    }
  }
  u(ze, ud);
  var Ae = { 2: "touch", 3: "pen", 4: "mouse" };
  ze.prototype.stopPropagation = function() {
    ze.j.stopPropagation.call(this);
    this.b.stopPropagation ? this.b.stopPropagation() : this.b.cancelBubble = true;
  };
  ze.prototype.preventDefault = function() {
    ze.j.preventDefault.call(this);
    var a2 = this.b;
    if (a2.preventDefault)
      a2.preventDefault();
    else if (a2.returnValue = false, xe)
      try {
        if (a2.ctrlKey || 112 <= a2.keyCode && 123 >= a2.keyCode)
          a2.keyCode = -1;
      } catch (b2) {
      }
  };
  var Be = "closure_lm_" + (1e6 * Math.random() | 0), Ce = {}, De = 0;
  function Ee(a2, b2, c2, d, e) {
    if (d && d.once)
      return Fe(a2, b2, c2, d, e);
    if ("array" == Aa(b2)) {
      for (var f2 = 0; f2 < b2.length; f2++)
        Ee(a2, b2[f2], c2, d, e);
      return null;
    }
    c2 = Ge(c2);
    return pe(a2) ? a2.U.add(String(b2), c2, false, Ea(d) ? !!d.capture : !!d, e) : He(a2, b2, c2, false, d, e);
  }
  function He(a2, b2, c2, d, e, f2) {
    if (!b2)
      throw Error("Invalid event type");
    var g = Ea(e) ? !!e.capture : !!e, h = Ie(a2);
    h || (a2[Be] = h = new te(a2));
    c2 = h.add(b2, c2, d, g, f2);
    if (c2.proxy)
      return c2;
    d = Je();
    c2.proxy = d;
    d.src = a2;
    d.listener = c2;
    if (a2.addEventListener)
      ye || (e = g), void 0 === e && (e = false), a2.addEventListener(b2.toString(), d, e);
    else if (a2.attachEvent)
      a2.attachEvent(Ke(b2.toString()), d);
    else if (a2.addListener && a2.removeListener)
      a2.addListener(d);
    else
      throw Error("addEventListener and attachEvent are unavailable.");
    De++;
    return c2;
  }
  function Je() {
    var a2 = Le, b2 = we ? function(c2) {
      return a2.call(b2.src, b2.listener, c2);
    } : function(c2) {
      c2 = a2.call(b2.src, b2.listener, c2);
      if (!c2)
        return c2;
    };
    return b2;
  }
  function Fe(a2, b2, c2, d, e) {
    if ("array" == Aa(b2)) {
      for (var f2 = 0; f2 < b2.length; f2++)
        Fe(a2, b2[f2], c2, d, e);
      return null;
    }
    c2 = Ge(c2);
    return pe(a2) ? a2.U.add(String(b2), c2, true, Ea(d) ? !!d.capture : !!d, e) : He(a2, b2, c2, true, d, e);
  }
  function Me(a2, b2, c2, d, e) {
    if ("array" == Aa(b2)) {
      for (var f2 = 0; f2 < b2.length; f2++)
        Me(a2, b2[f2], c2, d, e);
      return null;
    }
    d = Ea(d) ? !!d.capture : !!d;
    c2 = Ge(c2);
    if (pe(a2))
      return a2.U.remove(String(b2), c2, d, e);
    if (!a2)
      return false;
    if (a2 = Ie(a2)) {
      if (b2 = a2.a[b2.toString()], a2 = -1, b2 && (a2 = ue(b2, c2, d, e)), c2 = -1 < a2 ? b2[a2] : null)
        return Ne(c2);
    }
    return false;
  }
  function Ne(a2) {
    if ("number" === typeof a2 || !a2 || a2.be)
      return false;
    var b2 = a2.src;
    if (pe(b2))
      return ve(b2.U, a2);
    var c2 = a2.type, d = a2.proxy;
    b2.removeEventListener ? b2.removeEventListener(c2, d, a2.capture) : b2.detachEvent ? b2.detachEvent(Ke(c2), d) : b2.addListener && b2.removeListener && b2.removeListener(d);
    De--;
    (c2 = Ie(b2)) ? (ve(c2, a2), 0 == c2.b && (c2.src = null, b2[Be] = null)) : se(a2);
    return true;
  }
  function Ke(a2) {
    return a2 in Ce ? Ce[a2] : Ce[a2] = "on" + a2;
  }
  function Oe(a2, b2, c2, d) {
    var e = true;
    if (a2 = Ie(a2)) {
      if (b2 = a2.a[b2.toString()])
        for (b2 = b2.concat(), a2 = 0; a2 < b2.length; a2++) {
          var f2 = b2[a2];
          f2 && f2.capture == c2 && !f2.be && (f2 = Pe(f2, d), e = e && false !== f2);
        }
    }
    return e;
  }
  function Pe(a2, b2) {
    var c2 = a2.listener, d = a2.Mf || a2.src;
    a2.rf && Ne(a2);
    return c2.call(d, b2);
  }
  function Le(a2, b2) {
    if (a2.be)
      return true;
    if (!we) {
      if (!b2)
        a: {
          b2 = ["window", "event"];
          for (var c2 = xa, d = 0; d < b2.length; d++)
            if (c2 = c2[b2[d]], null == c2) {
              b2 = null;
              break a;
            }
          b2 = c2;
        }
      d = b2;
      b2 = new ze(d, this);
      c2 = true;
      if (!(0 > d.keyCode || void 0 != d.returnValue)) {
        a: {
          var e = false;
          if (0 == d.keyCode)
            try {
              d.keyCode = -1;
              break a;
            } catch (g) {
              e = true;
            }
          if (e || void 0 == d.returnValue)
            d.returnValue = true;
        }
        d = [];
        for (e = b2.currentTarget; e; e = e.parentNode)
          d.push(e);
        a2 = a2.type;
        for (e = d.length - 1; !b2.a && 0 <= e; e--) {
          b2.currentTarget = d[e];
          var f2 = Oe(d[e], a2, true, b2);
          c2 = c2 && f2;
        }
        for (e = 0; !b2.a && e < d.length; e++)
          b2.currentTarget = d[e], f2 = Oe(d[e], a2, false, b2), c2 = c2 && f2;
      }
      return c2;
    }
    return Pe(a2, new ze(b2, this));
  }
  function Ie(a2) {
    a2 = a2[Be];
    return a2 instanceof te ? a2 : null;
  }
  var Qe = "__closure_events_fn_" + (1e9 * Math.random() >>> 0);
  function Ge(a2) {
    if (Da(a2))
      return a2;
    a2[Qe] || (a2[Qe] = function(b2) {
      return a2.handleEvent(b2);
    });
    return a2[Qe];
  }
  ;
  function F() {
    qd.call(this);
    this.U = new te(this);
    this.wn = this;
    this.Mg = null;
  }
  u(F, qd);
  F.prototype[oe] = true;
  p = F.prototype;
  p.Mb = function() {
    return this.Mg;
  };
  p.ka = function(a2) {
    this.Mg = a2;
  };
  p.addEventListener = function(a2, b2, c2, d) {
    Ee(this, a2, b2, c2, d);
  };
  p.removeEventListener = function(a2, b2, c2, d) {
    Me(this, a2, b2, c2, d);
  };
  p.dispatchEvent = function(a2) {
    var b2, c2 = this.Mb();
    if (c2)
      for (b2 = []; c2; c2 = c2.Mb())
        b2.push(c2);
    c2 = this.wn;
    var d = a2.type || a2;
    if ("string" === typeof a2)
      a2 = new ud(a2, c2);
    else if (a2 instanceof ud)
      a2.target = a2.target || c2;
    else {
      var e = a2;
      a2 = new ud(d, c2);
      Ya(a2, e);
    }
    e = true;
    if (b2)
      for (var f2 = b2.length - 1; !a2.a && 0 <= f2; f2--) {
        var g = a2.currentTarget = b2[f2];
        e = g.jd(d, true, a2) && e;
      }
    a2.a || (g = a2.currentTarget = c2, e = g.jd(d, true, a2) && e, a2.a || (e = g.jd(d, false, a2) && e));
    if (b2)
      for (f2 = 0; !a2.a && f2 < b2.length; f2++)
        g = a2.currentTarget = b2[f2], e = g.jd(d, false, a2) && e;
    return e;
  };
  p.o = function() {
    F.j.o.call(this);
    this.U && this.U.na(void 0);
    this.Mg = null;
  };
  p.jd = function(a2, b2, c2) {
    a2 = this.U.a[String(a2)];
    if (!a2)
      return true;
    a2 = a2.concat();
    for (var d = true, e = 0; e < a2.length; ++e) {
      var f2 = a2[e];
      if (f2 && !f2.be && f2.capture == b2) {
        var g = f2.listener, h = f2.Mf || f2.src;
        f2.rf && ve(this.U, f2);
        d = false !== g.call(h, c2) && d;
      }
    }
    return d && 0 != c2.Ik;
  };
  p.sh = function(a2, b2) {
    return this.U.sh(void 0 !== a2 ? String(a2) : void 0, b2);
  };
  t("H.util.EventTarget", F);
  F.prototype.ka = F.prototype.ka;
  F.prototype.setParentEventTarget = F.prototype.ka;
  F.prototype.Mb = F.prototype.Mb;
  F.prototype.getParentEventTarget = F.prototype.Mb;
  F.prototype.addEventListener = F.prototype.addEventListener;
  F.prototype.addEventListener = F.prototype.addEventListener;
  F.prototype.removeEventListener = F.prototype.removeEventListener;
  F.prototype.removeEventListener = F.prototype.removeEventListener;
  F.prototype.dispatchEvent = F.prototype.dispatchEvent;
  F.prototype.dispatchEvent = F.prototype.dispatchEvent;
  F.prototype.F = F.prototype.F;
  F.prototype.dispose = F.prototype.F;
  F.prototype.tb = F.prototype.tb;
  F.prototype.addOnDisposeCallback = F.prototype.tb;
  F.prototype.xn = F.prototype.jd;
  F.prototype.jd = function(a2, b2, c2) {
    var d, e, f2 = true;
    var g = c2[c2.currentTarget === c2.target ? "AT_TARGET" : b2 ? "CAPTURING_PHASE" : (d = true, "BUBBLING_PHASE")];
    if (!d || "pointerenter" !== (e = c2.type) && "pointerleave" !== e)
      c2.eventPhase = g, f2 = F.prototype.xn.apply(this, arguments), d && this.Mb && null === this.Mb() && delete c2.eventPhase;
    return f2;
  };
  F.prototype.Tk = function(a2) {
    for (var b2, c2 = this; c2 && (b2 = c2.Mb()) && b2 !== a2; )
      c2 = b2;
    b2 || c2.ka(a2);
  };
  F.prototype.setRootParentEventTarget = F.prototype.Tk;
  function Re(a2) {
    a2 = a2 || {};
    var b2 = a2.callback;
    this.b = a2.label;
    Da(b2) && (this.callback = b2);
    this.a = !!a2.disabled;
    Re.j.constructor.call(this);
  }
  u(Re, F);
  t("H.util.ContextItem", Re);
  Re.prototype.Ge = function() {
    return this.b;
  };
  Re.prototype.getLabel = Re.prototype.Ge;
  Re.prototype.Jc = function(a2) {
    this.b !== a2 && (this.b = a2, this.dispatchEvent("update"));
    return this;
  };
  Re.prototype.setLabel = Re.prototype.Jc;
  Re.prototype.dc = function() {
    return this.a;
  };
  Re.prototype.isDisabled = Re.prototype.dc;
  Re.prototype.va = function(a2) {
    a2 !== this.a && (this.a = a2, this.dispatchEvent("update"));
    return this;
  };
  Re.prototype.setDisabled = Re.prototype.va;
  var Se = new Re();
  Re.SEPARATOR = Se;
  function Te(a2) {
    if (x.document) {
      var b2 = document.createElement("canvas");
      b2.width = b2.height = 1;
      return b2.getContext("2d", { fp: a2 });
    }
    return null;
  }
  function Ue() {
    return window.devicePixelRatio || 1;
  }
  t("H.util.getPixelRatio", Ue);
  var Ve = /^rgba\(([^,]+),([^,]+),([^,]+),([^)]+)\)$/;
  function We(a2) {
    var b2 = Xe[a2], c2 = x.RegExp;
    b2 || (x.Uint8ClampedArray || (x.Uint8ClampedArray = function(d) {
      return d instanceof Number ? Array(d) : d.map(function(e) {
        return ae(Ad(e), 0, 255);
      });
    }), "none" === a2 ? b2 = new Uint8ClampedArray([0, 0, 0, 0]) : (Ye.fillStyle = "black", Ye.fillStyle = a2, Ve.test(Ye.fillStyle) ? b2 = new Uint8ClampedArray([c2.$1, c2.$2, c2.$3, 255 * c2.$4]) : (Ye.clearRect(0, 0, 1, 1), Ye.fillRect(0, 0, 1, 1), b2 = Ye.getImageData(0, 0, 1, 1).data)), Xe[a2] = b2);
    return b2;
  }
  function Ze(a2) {
    return "none" !== a2 && 0 < We(a2)[3];
  }
  var Xe = oc(), $e = !!x.VBArray;
  t("H.util.eval", function(a) {
    return eval(a);
  });
  function af(a2, b2) {
    return a2 !== B ? a2 : b2;
  }
  function bf(a2) {
    return /^<svg/.test(a2) ? "data:image/svg+xml;charset=utf-8," + encodeURIComponent(a2) : a2;
  }
  t("H.util.provide", function(a2) {
    var b2 = xa.$jscomp;
    if (b2 && ("function" != typeof b2.Vl ? 0 : b2.Vl()))
      throw Error("goog.provide cannot be used within a module.");
    ya(a2, void 0);
  });
  function cf(a2) {
    this.fc = 0 < +a2 ? xd.round(a2) : 0;
  }
  cf.prototype.next = function(a2) {
    if (9007199254740992 === this.fc)
      throw new ne(a2, this.fc, [0, 9007199254740991]);
    return this.fc++;
  };
  var df = new cf(), ef = A(df.next, df);
  function ff() {
    return true;
  }
  function gf() {
    return false;
  }
  function ld() {
  }
  var hf = qc([]), jf = qc({});
  function kf(a2) {
    return "CANVAS" === a2.tagName ? [a2] : a2.getElementsByTagName("CANVAS");
  }
  function lf(a2, b2, c2) {
    var d;
    b2 = a2.ownerDocument === b2 ? a2.cloneNode(true) : b2.importNode(a2, true);
    if (c2)
      for (a2 = kf(a2), c2 = kf(b2), d = c2.length; d--; )
        c2[d].getContext("2d").drawImage(a2[d], 0, 0);
    return b2;
  }
  var Ye = Te(true), mf = Te(false);
  function nf(a2) {
    var b2 = a2.complete, c2 = 0 < a2.naturalWidth;
    if (b2 && !c2 && $e)
      try {
        mf.drawImage(a2, 0, 0), c2 = true;
      } catch (d) {
      }
    return b2 && c2;
  }
  var of = x.BlobBuilder || x.WebKitBlobBuilder || x.MozBlobBuilder;
  function pf(a2, b2) {
    b2 = b2 || "";
    if (of) {
      var c2 = new of();
      c2.append(a2);
      a2 = c2.getBlob(b2);
    } else
      a2 = new Blob([a2], { type: b2 });
    return a2;
  }
  var qf = x.navigator;
  cd = /Edge\/\d+/.test(qf.appVersion);
  dd = /(A|a)ndroid/.test(qf.appVersion);
  function rf() {
    var a2 = rf.a;
    a2 || (a2 = this, rf.a = a2, Ic(rf.a), F.call(a2), sf(this));
    return a2;
  }
  u(rf, F);
  rf.prototype.o = function() {
    rf.j.o.call(this);
    sf(this);
  };
  function sf(a2) {
    a2.g = 10;
    a2.i = 6;
    a2.a = oc();
    a2.b = oc();
    a2.c = 0;
  }
  rf.prototype.Jg = function(a2) {
    a2 = a2.type;
    var b2 = this.a[a2] || 0;
    if (this.c < this.g && b2 < this.i) {
      var c2 = ++this.f;
      this.c++;
      this.a[a2] = b2 + 1;
      this.b[c2 + ""] = a2;
      return c2;
    }
    return z;
  };
  rf.prototype.yf = function(a2) {
    var b2 = this.b[a2];
    if (!vc(b2) || !this.a[b2])
      throw new $c(this.yf, "Unknown requestId");
    this.c--;
    this.a[b2]--;
    this.a[b2] || delete this.a[b2];
    delete this.b[a2];
    this.dispatchEvent("allocatable");
  };
  rf.prototype.f = -1;
  function tf(a2, b2, c2, d) {
    if (!uf[a2])
      throw new D(tf, 0, "Mime type is not supported");
    this.f = a2;
    a2 = d ? Wa(d) : {};
    "crossOrigin" in a2 || (a2.crossOrigin = "anonymous");
    this.a = a2;
    vf.href = b2.toString();
    ie.call(this, vf.protocol + "//" + vf.hostname, b2, c2);
  }
  u(tf, ie);
  tf.prototype.qj = function() {
    this.b = uf[this.f].call(this);
    return true;
  };
  tf.prototype.oe = function() {
    this.b && (this.b.abort(), delete this.b);
  };
  var uf = { "application/json": function() {
    var a2 = this, b2 = wf(this.a), c2 = b2.headers;
    b2.headers = c2 = c2 ? Wa(c2) : {};
    c2.Accept = "application/json";
    return new Uc(this.data, function(d) {
      200 <= d.status && 300 > d.status ? a2.resolve(d.json()) : a2.reject(d);
    }, b2);
  }, "text/plain": function() {
    var a2 = this;
    return new Uc(this.data, function(b2) {
      200 <= b2.status && 300 > b2.status ? a2.resolve(b2.text()) : a2.reject(b2);
    }, wf(this.a));
  }, image: function() {
    var a2 = x.document.createElement("img"), b2 = this, c2 = this.data;
    a2.onload = A(this.resolve, this, a2);
    a2.onerror = function() {
      b2.reject(Rc.error());
    };
    a2.crossOrigin = this.a.crossOrigin;
    a2.src = c2;
    return { abort: function() {
      a2.onerror = a2.onload = null;
      $e && nf(a2) || a2.removeAttribute("src");
    } };
  } };
  (function() {
    try {
      var a2 = new XMLHttpRequest();
      a2.open("get", "/", true);
    } catch (b2) {
      a2 = {};
    }
    "response" in a2 && (uf.arraybuffer = function() {
      var b2 = new XMLHttpRequest(), c2 = this, d = this.a, e = d.headers, f2;
      b2.open("GET", this.data);
      xf(b2, d);
      b2.responseType = "arraybuffer";
      if (e)
        for (f2 in e)
          b2.setRequestHeader(f2, e[f2]);
      b2.onerror = b2.ontimeout = function() {
        c2.reject(Rc.error());
      };
      b2.onload = function() {
        c2.resolve(new Rc(b2.response));
      };
      b2.send();
      return b2;
    });
  })();
  var yf = new le(new rf());
  tf.prototype.fh = function() {
    return yf;
  };
  var vf = x.document.createElement("a");
  function wf(a2) {
    var b2 = Wa(a2);
    delete b2.crossOrigin;
    xf(b2, a2);
    return b2;
  }
  function xf(a2, b2) {
    a2.withCredentials = "use-credentials" === b2.crossOrigin;
  }
  ;
  function J(a2, b2) {
    this.x = +a2;
    this.y = +b2;
  }
  t("H.math.Point", J);
  J.prototype.set = J;
  J.prototype.set = J.prototype.set;
  J.prototype.clone = function(a2) {
    a2 ? (a2.x = this.x, a2.y = this.y) : a2 = new J(this.x, this.y);
    return a2;
  };
  J.prototype.clone = J.prototype.clone;
  J.prototype.add = function(a2) {
    this.x += a2.x;
    this.y += a2.y;
    return this;
  };
  J.prototype.add = J.prototype.add;
  J.prototype.sub = function(a2) {
    this.x -= a2.x;
    this.y -= a2.y;
    return this;
  };
  J.prototype.sub = J.prototype.sub;
  J.prototype.scale = function(a2, b2) {
    this.x *= a2;
    this.y *= void 0 === b2 ? a2 : b2;
    return this;
  };
  J.prototype.scale = J.prototype.scale;
  J.prototype.round = function() {
    this.x = Ad(this.x);
    this.y = Ad(this.y);
    return this;
  };
  J.prototype.round = J.prototype.round;
  J.prototype.floor = function() {
    this.x = Bd(this.x);
    this.y = Bd(this.y);
    return this;
  };
  J.prototype.floor = J.prototype.floor;
  J.prototype.ceil = function() {
    this.x = Cd(this.x);
    this.y = Cd(this.y);
    return this;
  };
  J.prototype.ceil = J.prototype.ceil;
  J.prototype.ia = function(a2) {
    return !(!a2 || this.x !== a2.x || this.y !== a2.y);
  };
  J.prototype.equals = J.prototype.ia;
  J.prototype.Cj = function(a2, b2) {
    var c2 = b2.x - a2.x, d = b2.y - a2.y, e = a2;
    if (c2 || d) {
      var f2 = ((this.x - a2.x) * c2 + (this.y - a2.y) * d) / (c2 * c2 + d * d);
      0 >= f2 ? e = a2 : 1 <= f2 ? e = b2 : e = new J(a2.x + f2 * c2, a2.y + f2 * d);
    }
    return e;
  };
  J.prototype.getNearest = J.prototype.Cj;
  J.prototype.Wa = function(a2) {
    return Fd(Gd(this.x - a2.x, 2) + Gd(this.y - a2.y, 2));
  };
  J.prototype.distance = J.prototype.Wa;
  function zf(a2) {
    if (!a2)
      throw Error("invalid argument");
    return a2 instanceof J ? a2 : new J(a2.x, a2.y);
  }
  J.fromIPoint = zf;
  function Af(a2) {
    var b2 = Bf[a2];
    if (!b2)
      if (a2 in Cf)
        b2 = Bf[a2] = a2;
      else {
        b2 = Df.length;
        var c2 = "", d = a2.charAt(0).toUpperCase() + a2.substr(1), e = "", f2 = false;
        Ef && (e = Ef + d, f2 = e in Cf);
        for (; b2-- && !f2; )
          c2 = Df[b2], e = c2 + d, f2 = e in Cf;
        f2 && (Ef = c2);
        if (b2 = f2 ? e : null)
          Bf[a2] = b2;
        else
          throw Error("Could not find any variant of CSS property [" + a2 + "]");
      }
    return b2;
  }
  t("H.dom.cssPrefixer.prefix", Af);
  var Df = ["O", "Ms", "ms", "Moz", "Webkit"], Bf = {}, Ef = "", Cf = document.createElement("span").style;
  function Ff(a2, b2, c2, d) {
    if (!a2 || !b2 || !c2)
      throw new D(Ff, B, "Must specify name, version and revision parameter");
    this.name = a2;
    this.version = b2;
    this.revision = c2;
    d && Ya(this, d);
  }
  t("H.util.BuildInfo", Ff);
  Ff.prototype.toString = function() {
    var a2, b2 = [];
    for (a2 in this)
      Cc(this[a2]) && b2.push(this[a2]);
    return b2.join(";");
  };
  var Gf = {};
  function Hf(a2, b2, c2, d) {
    if (!a2)
      throw new D(Hf, 1, "Must specify a name parameter");
    return Gf[a2] || (Gf[a2] = new Ff(a2, b2, c2, d));
  }
  Ff.get = Hf;
  function If() {
    If.j.constructor.call(this);
    this.a = Jf(this);
    this.f = oc();
    this.c = A(this.c, this);
    this.a.addEventListener("message", this.c);
    this.b = {};
  }
  u(If, F);
  If.prototype.o = function() {
    this.a.terminate();
  };
  If.prototype.g = function(a2) {
    var b2 = a2.type, c2 = !!this.f[b2], d = a2.data, e = Kf++, f2 = d && d.Mo ? d.Mo : B, g = true;
    c2 ? (this.b[e] = a2, Lf(this, b2, e, d && d.message, f2)) : (a2.reject(new D(this.g, 0, "processor_not_found")), g = false);
    return g;
  };
  If.prototype.c = function(a2) {
    a2 = a2.data;
    var b2 = this.b[a2.taskId], c2 = a2.taskId, d = a2.data, e = this;
    if (2 === a2.type)
      new tf("arraybuffer", d).then(function(f2) {
        return f2.arrayBuffer();
      }).then(function(f2) {
        e.a.postMessage(["3", c2, [f2]], [f2]);
      }, function() {
        e.a.postMessage(["3", c2, [null, "ERROR"]]);
      });
    else {
      if (b2) {
        switch (a2.type) {
          case 1:
            b2.resolve(d);
            break;
          case 0:
            b2.reject(d);
        }
        delete this.b[c2];
      }
      this.dispatchEvent(new ud(this.A.IDLE));
    }
  };
  var Kf = 0;
  function Mf(a2, b2, c2) {
    var d = Kf++, e;
    a2.b[d] = e = ac();
    Lf(a2, b2, d, c2);
    return e.Ak;
  }
  function Lf(a2, b2, c2, d, e) {
    d === B || Ca(d) || (d = [d]);
    try {
      a2.a.postMessage([b2, c2, d], e);
    } catch (f2) {
      a2 = a2.b[c2], a2.reject(f2.message);
    }
  }
  If.prototype.A = { IDLE: "idle", Ni: "error" };
  If.prototype.i = function(a2, b2) {
    var c2 = this.l || (this.l = new ud(this.A.Ni));
    c2.data = b2;
    delete this.f[a2];
    this.dispatchEvent(c2);
  };
  function Jf(a) {
    var b = x.H.__bootstrap__;
    b = Da(b) ? ("" + b).replace(/^[^{]+{((.|[\r\n])+?)}\s*$/, "$1") : "" + b;
    if (x.Worker && x.URL)
      try {
        var c = new x.Worker(x.URL.createObjectURL(pf(b, "application/javascript")));
      } catch (d) {
      }
    c || (a = new Nf(a), function() {
      eval("var self = arguments[0];" + b);
    }(a), c = new Of(a));
    return c;
  }
  function Of(a2) {
    F.call(this);
    this.a = a2;
  }
  u(Of, F);
  Of.prototype.postMessage = function(a2) {
    x.setTimeout(A(this.b, this, a2), 0);
  };
  Of.prototype.b = function(a2) {
    var b2 = new ud("message");
    b2.data = a2;
    this.a.dispatchEvent(b2);
  };
  Of.prototype.terminate = function() {
    this.a.F();
    this.F();
  };
  function Nf(a2) {
    F.call(this);
    this.a = a2;
    this.addEventListener = A(this.addEventListener, this);
    this.removeEventListener = A(this.removeEventListener, this);
    this.postMessage = A(this.postMessage, this);
    this.eval = A(eval, this);
  }
  u(Nf, F);
  Nf.prototype.postMessage = function(a2) {
    var b2 = new ud("message");
    b2.data = a2;
    x.setTimeout(A(this.a.c, this.a, b2), 0);
  };
  function Pf() {
    var a2 = Qf;
    a2 || (a2 = Qf = this, F.call(a2), Rf(this));
    return a2;
  }
  var Qf;
  u(Pf, F);
  Pf.prototype.o = function() {
    Pf.j.o.call(this);
    Rf(this);
  };
  function Rf(a2) {
    var b2 = a2.b, c2;
    if (b2)
      for (c2 = b2.length; c2--; )
        b2[c2].F();
    a2.b = [];
    Ic(a2.b);
    a2.c = {};
    a2.f = oc();
  }
  Pf.prototype.Jg = function(a2) {
    var b2;
    a2 = a2.type;
    if (b2 = this.f[a2]) {
      var c2 = this.b;
      var d = c2[0];
      d || (d = c2[0] = new If(), this.tb(La(td, d)), Va(this.c) || (c2 = x.Object.keys(this.c), Mf(d, "0", c2)));
      c2 = d;
      c2.f[a2] || (c2.f[a2] = b2, Mf(c2, "1", [a2, Da(b2) ? b2 + "" : b2]).then(ld, A(c2.i, c2, a2)));
    } else
      throw new $c(this.Jg, 'Unknown type "' + a2 + '"');
    return d;
  };
  Pf.prototype.yf = function() {
  };
  Pf.prototype.a = function(a2, b2) {
    var c2 = this.f, d = c2[a2];
    if (d) {
      if (b2 !== d)
        throw new $c(this.a, 'Type "' + a2 + '" is already registered');
    } else
      c2[a2] = b2;
  };
  function Sf(a2, b2, c2) {
    ie.call(this, a2, b2, c2);
  }
  var Tf;
  u(Sf, ie);
  Sf.prototype.fh = function() {
    Tf || (Tf = new le(new Pf()));
    return Tf;
  };
  Sf.prototype.oe = function() {
  };
  Sf.prototype.qj = function(a2) {
    return a2.g(this);
  };
  function Uf(a2, b2, c2, d, e, f2) {
    var g, h, k = a2.length, l, m;
    if (k)
      for (g = []; k--; ) {
        var n = a2[k];
        var q = n.length;
        var r = 0;
        for (l = 1; l < q; l++)
          if (m = Vf(n[l - 1], n[l], c2, b2, d, e)) {
            var v = m[0];
            var w = m[1];
            r && r.ia(v) ? h.push(w) : g.push(h = m);
            r = w;
            f2 && (l = q, k = 0);
          }
      }
    else
      g = a2;
    return g;
  }
  t("H.math.clipping.clipStrips", Uf);
  function Vf(a2, b2, c2, d, e, f2) {
    var g = a2.x;
    a2 = -a2.y;
    var h = b2.x;
    b2 = -b2.y;
    c2 = -c2;
    f2 = -f2;
    if (g > h) {
      if (h > e || g < d)
        return;
      var k = g;
      var l = a2;
      g = h;
      a2 = b2;
      h = k;
      b2 = l;
      k = 1;
    } else if (g > e || h < d)
      return;
    if (a2 > b2) {
      if (b2 > c2 || a2 < f2)
        return;
      var m = 1;
      a2 = -a2;
      b2 = -b2;
      l = f2;
      f2 = -c2;
      c2 = -l;
    } else if (a2 > c2 || b2 < f2)
      return;
    if (g < d) {
      if ((a2 += (d - g) * (b2 - a2) / (h - g)) > c2)
        return;
      g = d;
    }
    if (a2 < f2) {
      if ((g += (f2 - a2) * (h - g) / (b2 - a2)) > e)
        return;
      a2 = f2;
    }
    h > e && (b2 = a2 + (e - g) * (b2 - a2) / (h - g), h = e);
    b2 > c2 && (h = g + (c2 - a2) * (h - g) / (b2 - a2), b2 = c2);
    m && (a2 = -a2, b2 = -b2);
    return k ? [new J(h, -b2), new J(g, -a2)] : [new J(g, -a2), new J(h, -b2)];
  }
  function Wf(a2, b2, c2) {
    a2 = Xf(a2, true);
    b2 = Xf(b2, false);
    var d, e;
    var f2 = {};
    var g = d = 1;
    switch (~~(c2 || 0)) {
      case 1:
        g = d = 0;
        break;
      case 2:
        d = 0;
        g = 1;
        break;
      case 3:
        d = 1, g = 0;
    }
    c2 = d;
    var h = g;
    if (b2 && a2) {
      b2.se = new Yf(b2.x, b2.y, null, Zf(b2));
      a2.se = new Yf(a2.x, a2.y, null, Zf(a2));
      for (g = b2; g.next; g = g.next)
        if (!g.Za) {
          for (d = a2; d.next; d = d.next)
            if (!d.Za) {
              var k = $f(g.next);
              var l = $f(d.next);
              if (e = ag(g, k, d, l, f2)) {
                e = f2.pl;
                var m = f2.ql;
                var n = f2.Po;
                var q = f2.Qo;
                e = new Yf(n, q, null, null, null, null, true, 0, 0, e);
                bg(e, g, k);
                k = new Yf(n, q, null, null, null, null, true, 0, 0, m);
                bg(k, d, l);
                e.Th = k;
                k.Th = e;
              }
            }
        }
      f2 = fe(b2, cg(a2));
      c2 && (f2 = !f2);
      for (g = b2; g; g = g.next)
        g.Za && (g.vh = f2, f2 = !f2);
      f2 = fe(a2, cg(b2));
      h && (f2 = !f2);
      for (d = a2; d.next; d = d.next)
        d.Za && (d.vh = f2, f2 = !f2);
      dg(b2);
      for (dg(a2); (a2 = eg(b2)) != b2; ) {
        for (c2 = null; !a2.yg; a2 = a2.Th) {
          for (f2 = a2.vh; ; ) {
            c2 = new Yf(a2.x, a2.y, c2);
            c2.artificial = a2.Za || a2.Sj;
            a2.yg = 1;
            a2 = f2 ? a2.next : a2.gc;
            if (!a2)
              break;
            if (a2.Za) {
              a2.yg = 1;
              break;
            }
          }
          if (!a2)
            break;
        }
        c2.Uh = r || null;
        var r = c2;
      }
      return r;
    }
  }
  t("H.math.clipping.clipPolygon", Wf);
  function Yf(a2, b2, c2, d, e, f2, g, h, k, l) {
    this.x = a2;
    this.y = b2;
    this.next = c2 || null;
    this.gc = d || null;
    this.Uh = e || null;
    this.Th = f2 || null;
    this.Za = !!g;
    this.vh = !!h;
    this.yg = k || 0;
    this.alpha = l || 0;
    d && (d.next = this);
    c2 && (c2.gc = this);
    this.Sj = false;
    this.se = null;
  }
  function $f(a2) {
    for (; a2 && a2.Za; )
      a2 = a2.next;
    return a2;
  }
  function Zf(a2) {
    if (a2)
      for (; a2.next; )
        a2 = a2.next;
    return a2;
  }
  function eg(a2) {
    var b2 = a2;
    if (b2) {
      do
        b2 = b2.next;
      while (b2 != a2 && (!b2.Za || b2.Za && b2.yg));
    }
    return b2;
  }
  function dg(a2) {
    var b2 = Zf(a2);
    b2.gc.next = a2;
    a2.gc = b2.gc;
  }
  function ag(a2, b2, c2, d, e, f2) {
    var g, h = b2.x - a2.x, k = b2.y - a2.y;
    var l = d.x - c2.x;
    var m = d.y - c2.y;
    var n = h * m - k * l;
    if (!n)
      return 0;
    l = ((c2.x - a2.x) * m - (c2.y - a2.y) * l) / n;
    n = (k * (c2.x - a2.x) - h * (c2.y - a2.y)) / n;
    if (0 > l || 1 < l || 0 > n || 1 < n)
      return 0;
    0 === l ? g = a2 : 1 === l ? g = b2 : 0 === n ? g = c2 : 1 === n && (g = d);
    if (g && !f2)
      return g.x += 2480549651603763e-20, g.y += 7321997314118067e-20, g.se && (g.se.x = g.x, g.se.y = g.y), ag(a2, b2, c2, d, e);
    e.Po = a2.x + l * h;
    e.Qo = a2.y + l * k;
    e.pl = l;
    e.ql = n;
    return 1;
  }
  function cg(a2) {
    for (var b2 = []; a2; )
      b2.push(a2.x, a2.y), a2 = a2.next;
    return b2;
  }
  function bg(a2, b2, c2) {
    for (b2 = b2.next; b2 !== c2 && b2.alpha <= a2.alpha; )
      b2 = b2.next;
    a2.next = b2;
    a2.gc = b2.gc;
    a2.next.gc = a2;
    a2.gc.next = a2;
  }
  function Xf(a2, b2) {
    for (var c2, d = null, e = 0, f2 = a2.length; e < f2; e++) {
      c2 = new Yf(a2[e].x, a2[e].y, d);
      c2.Sj = b2;
      if (c2.next = d)
        d.gc = c2;
      d = c2;
    }
    return d;
  }
  ;
  function fg(a2, b2, c2) {
    var d = ae(+a2, -90, 90);
    if (b2 && E(d))
      throw new D(b2, c2, a2);
    return d;
  }
  function gg(a2, b2, c2) {
    var d = +a2;
    if (-180 > d || 180 < d)
      d = Zd(d + 180, 360) - 180;
    if (b2 && E(d))
      throw new D(b2, c2, a2);
    return d;
  }
  function hg(a2, b2, c2) {
    var d;
    if (a2 !== B && E(d = +a2) && b2)
      throw new D(b2, c2, a2);
    return d;
  }
  function ig(a2, b2) {
    return 0 > a2 !== 0 > b2 && 180 < Dd(b2 - a2);
  }
  t("H.geo.isDBC", ig);
  function jg() {
    xc(this, jg);
  }
  t("H.geo.AbstractGeometry", jg);
  jg.prototype.getBoundingBox = jg.prototype.K;
  jg.prototype.equals = jg.prototype.ia;
  jg.prototype.rb = "";
  jg.prototype.Hb = "";
  jg.prototype.toString = function() {
    return this.cd([this.rb.toUpperCase(), " "]).join("");
  };
  jg.prototype.toString = jg.prototype.toString;
  jg.prototype.Kc = function() {
    return { type: this.Hb, coordinates: this.bd() };
  };
  jg.prototype.toGeoJSON = jg.prototype.Kc;
  jg.prototype.Y = function() {
    return { type: this.rb, coordinates: this.pc(), boundingBox: this.K().Y() };
  };
  jg.prototype.forWorkerMessage = jg.prototype.Y;
  function kg(a2, b2, c2) {
    this.lat = fg(a2, kg, 0);
    this.lng = gg(b2, kg, 1);
    c2 !== B && (this.alt = hg(c2, kg, 2));
  }
  u(kg, jg);
  t("H.geo.Point", kg);
  kg.prototype.ia = function(a2) {
    return this === a2 || !!a2 && this.lat === a2.lat && this.lng === a2.lng && (this.alt || 0) === (a2.alt || 0);
  };
  kg.prototype.equals = kg.prototype.ia;
  kg.prototype.Wa = function(a2) {
    if (this === a2 || this.lat === a2.lat && this.lng === a2.lng)
      a2 = 0;
    else {
      var b2 = this.lat * Ud;
      var c2 = a2.lat * Ud;
      a2 = 1274200158e-2 * Jd(yd(1, Fd(Gd(Id((b2 - c2) / 2), 2) + Kd(b2) * Kd(c2) * Gd(Id((this.lng * Ud - a2.lng * Ud) / 2), 2))));
    }
    return a2;
  };
  kg.prototype.distance = kg.prototype.Wa;
  kg.prototype.zg = function(a2, b2, c2) {
    var d;
    if (c2) {
      if (d = b2 / 637100079e-2) {
        b2 = a2 * Ud;
        a2 = Ud * this.lat;
        var e = Id(a2);
        c2 = Id(d);
        var f2 = Kd(d);
        d = Ud * this.lng;
        var g = Kd(a2);
        a2 = Jd(g * Kd(b2) * c2 + e * f2);
        b2 = Nd(Id(b2) * g * c2, f2 - e * Id(a2));
        b2 = (d + b2 + Pd) % (2 * Pd) - Pd;
        b2 *= Vd;
        e = new kg(a2 * Vd, (b2 + 540) % 360 - 180);
      }
      return e || this;
    }
    a2 = (a2 % 360 + 360) % 360;
    if (0 === (a2 + 90) % 180)
      return a2 = this.lng + b2 / (637100079e-2 * Sd * Kd(this.lat * Ud)) * (270 === a2 ? -360 : 360), new kg(this.lat, (a2 + 540) % 360 - 180);
    if (b2 /= 637100079e-2)
      a2 *= Ud, e = this.lat * Ud, c2 = this.lng * Ud, d = e + b2 * Kd(a2), f2 = d - e, g = Ed(Ld(d / 2 + Rd) / Ld(e / 2 + Rd)), g = E(f2 / g) ? Kd(e) : f2 / g, a2 = b2 * Id(a2) / g, Dd(d) > Qd && (d = 0 < d ? Pd - d : -(Pd + d)), d = new kg(d * Vd, ((c2 + a2 + Td + (Dd(e + f2) > Qd ? Pd : 0)) % Sd - Pd) * Vd);
    return d || this;
  };
  kg.prototype.walk = kg.prototype.zg;
  kg.prototype.K = function() {
    return new K(this.lat, this.lng, this.lat, this.lng);
  };
  kg.prototype.getBoundingBox = kg.prototype.K;
  function lg(a2, b2, c2) {
    var d = Ea(a2) && !(E(a2.lat = fg(a2.lat)) || E(a2.lng = gg(a2.lng)) || a2.alt !== B && E(a2.alt = hg(a2.alt)));
    if (!d && b2)
      throw new D(b2, c2, a2);
    return d;
  }
  kg.validate = lg;
  function ng(a2) {
    if (!a2)
      throw new D(ng, 0, a2);
    return new kg(a2.lat, a2.lng, a2.alt);
  }
  kg.fromIPoint = ng;
  p = kg.prototype;
  p.rb = "Point";
  p.cd = function(a2) {
    a2.push("(", this.lng, " ", this.lat, ")");
    return a2;
  };
  p.Hb = "Point";
  p.bd = function() {
    return [this.lng, this.lat, this.alt || 0];
  };
  p.pc = function() {
    return [this.lat, this.lng, this.alt || 0];
  };
  function K(a2, b2, c2, d) {
    og(this, fg(a2, K, 0), gg(b2, K, 1), fg(c2, K, 2), gg(d, K, 3));
  }
  u(K, jg);
  t("H.geo.Rect", K);
  K.prototype.rb = "Polygon";
  K.prototype.cd = function(a2) {
    var b2 = this.c, c2 = this.a, d = this.f, e = this.b;
    a2.push("(", "(", c2, " ", b2, ",", e, " ", b2, ",", e, " ", d, ",", c2, " ", d, ",", c2, " ", b2, ")", ")");
    return a2;
  };
  K.prototype.ia = function(a2) {
    var b2 = this === a2;
    !b2 && C(a2, K) && (b2 = this.c === a2.c && this.a === a2.a && this.f === a2.f && this.b === a2.b);
    return b2;
  };
  K.prototype.equals = K.prototype.ia;
  K.prototype.clone = function() {
    return new K(this.c, this.a, this.f, this.b);
  };
  K.prototype.clone = K.prototype.clone;
  function og(a2, b2, c2, d, e) {
    a2.a = c2;
    a2.b = e;
    b2 < d && (c2 = b2, b2 = d, d = c2);
    a2.c = b2;
    a2.f = d;
    a2.l = a2.g = a2.i = null;
    return a2;
  }
  K.prototype.Nb = function() {
    this.l || (this.l = new kg(this.c, this.a));
    return this.l;
  };
  K.prototype.getTopLeft = K.prototype.Nb;
  K.prototype.Jb = function() {
    this.g || (this.g = new kg(this.f, this.b));
    return this.g;
  };
  K.prototype.getBottomRight = K.prototype.Jb;
  K.prototype.bn = function() {
    return this.c;
  };
  K.prototype.getTop = K.prototype.bn;
  K.prototype.Pl = function() {
    return this.f;
  };
  K.prototype.getBottom = K.prototype.Pl;
  K.prototype.xm = function() {
    return this.a;
  };
  K.prototype.getLeft = K.prototype.xm;
  K.prototype.Sm = function() {
    return this.b;
  };
  K.prototype.getRight = K.prototype.Sm;
  K.prototype.bb = function() {
    this.i || (this.i = new kg(this.f + (this.c - this.f) / 2, pg(this.a, this.Ab())));
    return this.i;
  };
  K.prototype.getCenter = K.prototype.bb;
  K.prototype.Ab = function() {
    return qg(this.a, this.b);
  };
  K.prototype.getWidth = K.prototype.Ab;
  K.prototype.Ld = function() {
    return this.c - this.f;
  };
  K.prototype.getHeight = K.prototype.Ld;
  K.prototype.Bb = function() {
    return this.a > this.b;
  };
  K.prototype.isCDB = K.prototype.Bb;
  K.prototype.Rf = function() {
    return !this.Ab() && !this.Ld();
  };
  K.prototype.isEmpty = K.prototype.Rf;
  K.prototype.K = function() {
    return new K(this.c, this.a, this.f, this.b);
  };
  K.prototype.getBoundingBox = K.prototype.K;
  K.prototype.uf = function(a2, b2, c2) {
    var d = this.bb();
    c2 || (a2 = fg(a2, this.uf, 0), b2 = gg(b2, this.uf, 1));
    b2 = this.Xc(a2, b2, c2);
    a2 = b2.bb();
    return a2.lat === d.lat && a2.lng === d.lng && this.Ld() === b2.Ld() && this.Ab() === b2.Ab();
  };
  K.prototype.containsLatLng = K.prototype.uf;
  K.prototype.gd = function(a2, b2) {
    b2 || lg(a2, this.gd, 0);
    return this.uf(a2.lat, a2.lng, b2);
  };
  K.prototype.containsPoint = K.prototype.gd;
  K.prototype.Qg = function(a2, b2) {
    var c2 = this.bb();
    if (!b2 && !C(a2, K))
      throw new D(this.Qg, 0, a2);
    b2 = this.ec(a2, b2);
    a2 = b2.bb();
    return a2.lat === c2.lat && a2.lng === c2.lng && this.Ld() === b2.Ld() && this.Ab() === b2.Ab();
  };
  K.prototype.containsRect = K.prototype.Qg;
  K.prototype.Xc = function(a2, b2, c2, d) {
    if (!c2) {
      if (E(a2 = fg(a2)))
        throw new D(this.Xc, 0, a2);
      if (E(b2 = gg(b2)))
        throw new D(this.Xc, 1, b2);
    }
    return rg(this.c, this.a, this.f, this.b, a2, b2, a2, b2, d);
  };
  K.prototype.mergeLatLng = K.prototype.Xc;
  K.prototype.jk = function(a2, b2, c2) {
    b2 || lg(a2, this.jk, 0);
    return this.Xc(a2.lat, a2.lng, b2, c2);
  };
  K.prototype.mergePoint = K.prototype.jk;
  K.prototype.ec = function(a2, b2, c2) {
    if (!b2 && !C(a2, K))
      throw new D(this.ec, 0, a2);
    return rg(this.c, this.a, this.f, this.b, a2.c, a2.a, a2.f, a2.b, c2);
  };
  K.prototype.mergeRect = K.prototype.ec;
  K.prototype.Bc = function(a2, b2, c2, d, e, f2) {
    e || (a2 = fg(a2, this.Bc, 0), b2 = gg(b2, this.Bc, 1), c2 = fg(c2, this.Bc, 2), d = gg(d, this.Bc, 3));
    return rg(this.c, this.a, this.f, this.b, a2, b2, c2, d, f2);
  };
  K.prototype.mergeTopLeftBottomRight = K.prototype.Bc;
  K.prototype.nd = function(a2, b2) {
    var c2 = this.a <= this.b, d = a2.a <= a2.b, e = this.a < a2.b, f2 = a2.a < this.b;
    if (!b2 && !C(a2, K))
      throw new D(this.nd, 0, a2);
    return this.f <= a2.c && a2.f <= this.c && (!c2 && (!d || e || f2) || !d && (e || f2) || e && f2);
  };
  K.prototype.intersects = K.prototype.nd;
  function qg(a2, b2) {
    a2 = b2 - a2;
    return a2 + (0 > a2 ? 360 : 0);
  }
  function pg(a2, b2) {
    a2 += b2 / 2;
    return a2 - (180 < a2 ? 360 : 0);
  }
  function rg(a2, b2, c2, d, e, f2, g, h, k) {
    c2 = yd(c2, g);
    a2 = zd(a2, e);
    e = qg(b2, d);
    var l = pg(b2, e);
    g = qg(f2, h);
    var m = pg(f2, g) - l;
    m += 0 > m - 1e-6 ? 360 : 0;
    if (180 > m - 1e-6) {
      l = b2;
      var n = h;
    } else
      m = 360 - m, l = f2, n = d;
    m = m + e / 2 + g / 2;
    360 <= m + 5e-7 ? (l = -180, n = 180) : m - 5e-7 < e ? (l = b2, n = d) : m - 5e-7 < g && (l = f2, n = h);
    return k ? og(k, a2, l, c2, n) : new K(a2, l, c2, n);
  }
  K.merge = rg;
  function sg(a2, b2, c2) {
    c2 || (lg(a2, sg, 0), lg(b2, sg, 1));
    return new K(a2.lat, a2.lng, b2.lat, b2.lng);
  }
  K.fromPoints = sg;
  function tg(a2, b2) {
    var c2 = 1, d = a2.length, e = null;
    if (!Ca(a2))
      throw new D(tg, 0, a2);
    if (0 < d) {
      var f2 = a2[0];
      for (e = sg(f2, f2, b2); c2 < d; c2++)
        f2 = a2[c2], e.Xc(f2.lat, f2.lng, b2, e);
    }
    return e;
  }
  K.coverPoints = tg;
  function ug(a2, b2) {
    var c2 = 3, d = a2.length, e;
    if (!(b2 || a2 && null != a2.length))
      throw new D(ug, 0, a2);
    if (0 < d)
      for (e = new K(a2[0], a2[1], a2[0], a2[1]); c2 < d; c2 += 3)
        e.Xc(a2[c2], a2[c2 + 1], b2, e);
    return e;
  }
  K.coverLatLngAlts = ug;
  function vg(a2, b2) {
    var c2 = 1, d = a2.length, e;
    if (b2 && (!a2 || null == a2.length))
      throw new D(vg, 0, a2);
    if (0 < d)
      for (e = new K(a2[0].c, a2[0].a, a2[0].f, a2[0].b); c2 < d; c2++)
        e.ec(a2[c2], b2, e);
    return e;
  }
  K.coverRects = vg;
  K.prototype.Hk = function(a2, b2) {
    var c2 = this.a, d = this.c, e = this.b, f2 = this.f, g = this.bb().lng;
    lg(a2, this.Hk, 0);
    var h = a2.lat - f2 - (d - f2) / 2;
    var k = a2.lng - g;
    k = 180 < k || -180 > k ? -(g + a2.lng) : k;
    a2 = c2 + (0 > k ? 2 * k : 0);
    a2 = -180 > a2 ? 360 + a2 : a2;
    e += 0 < k ? 2 * k : 0;
    e = 180 < e ? e - 360 : e;
    d = 0 < h ? d + 2 * h : d;
    90 <= d && (d = 90);
    f2 = 0 > h ? f2 + 2 * h : f2;
    -90 >= f2 && (f2 = -90);
    return b2 ? og(b2, d, a2, f2, e) : new K(d, a2, f2, e);
  };
  K.prototype.resizeToCenter = K.prototype.Hk;
  K.prototype.Hb = "Polygon";
  K.prototype.bd = function() {
    return [[this.a, this.c, 0], [this.b, this.c, 0], [this.b, this.f, 0], [this.a, this.f, 0], [this.a, this.c, 0]];
  };
  K.prototype.Y = function() {
    return this.pc();
  };
  K.prototype.pc = function() {
    return [this.c, this.a, this.f, this.b];
  };
  function wg(a2, b2, c2, d, e, f2) {
    xc(this, wg);
    this.c = a2 || 10;
    this.b = null;
    this.f = d || 0;
    this.g = e || 0;
    this.i = b2 || 1;
    this.l = c2 || 1;
    this.m = !!f2;
    this.flush();
  }
  function xg(a2) {
    var b2 = a2.b;
    if (a2.m && !b2) {
      var c2 = a2.head;
      if (c2.entries || c2[0] || c2[1] || c2[2] || c2[3])
        b2 = [c2], b2 = yg([b2, b2, b2, b2], [c2[6], c2[7], c2[4], c2[5]]), a2.b = b2;
    }
    return b2;
  }
  function yg(a2, b2) {
    var c2, d, e, f2, g = 0;
    for (c2 = 3; 0 <= c2; c2--) {
      var h = c2 + 4;
      var k = 0 < c2 % 3;
      var l = [];
      var m = b2[c2];
      var n = a2[c2];
      for (d = n.length; d--; ) {
        var q = n[d];
        if (e = q.entries)
          for (f2 = e.length; f2--; ) {
            var r = e[f2].a(c2);
            if (k ? r > m : r < m)
              m = r;
          }
        for (f2 = 4; f2--; )
          (e = q[f2]) && (k ? e[h] > m : e[h] < m) && l.push(e);
      }
      g += l.length;
      b2[c2] = m;
      a2[c2] = l;
    }
    g && (b2 = yg(a2, b2));
    return b2;
  }
  function zg(a2, b2, c2) {
    var d, e;
    if (a2.m && (d = a2.b))
      for (e = 3; 0 <= e; e--) {
        var f2 = b2.a(e);
        if (e % 3 ? f2 >= d[e] : f2 <= d[e])
          if (c2)
            d[e] = f2;
          else {
            a2.b = null;
            break;
          }
      }
  }
  wg.prototype.remove = function(a2) {
    var b2, c2, d, e = false;
    a2 && (b2 = a2.node) && b2.b === this && (c2 = b2.entries) && 0 <= (d = c2.indexOf(a2)) && (c2.splice(d, 1), this.s(b2), zg(this, a2, false), e = true);
    return e;
  };
  wg.prototype.flush = function() {
    var a2 = new Ag(B, NaN, this.f - this.i, this.g - this.l, this.f + this.i, this.g + this.l);
    a2.b = this;
    this.head = this.a = a2;
    this.b = null;
  };
  function Bg(a2, b2) {
    var c2 = a2.head, d;
    if (b2) {
      var e = b2;
      if (e !== c2) {
        for (c2 = e; e = e.parent; )
          if (e.entries || 1 < e.a)
            c2 = e;
      }
    } else
      for (; !c2.entries && 2 > (d = c2.a); )
        if (d)
          c2 = e;
        else
          break;
    a2.head = c2;
  }
  wg.prototype.Za = function(a2, b2, c2, d, e, f2) {
    var g = [], h = this.head, k = this.a;
    a2 <= h[5] && b2 <= h[6] && (e ? c2 >= h[7] : c2 > h[7]) && (f2 ? d >= h[4] : d > h[4]) && Cg(this, h, g, a2, b2, c2, d, f2 || d >= k[6], e || c2 >= k[5]);
    return g;
  };
  function Cg(a2, b2, c2, d, e, f2, g, h, k) {
    var l = b2.entries, m = b2[7], n = b2[4], q = b2[5], r = b2[6], v = b2[8], w = b2[9], y;
    if (l) {
      var G = l.length;
      if (e > n || d > m || g < r || f2 < q)
        for (; G--; ) {
          m = l[G];
          n = m.a(3);
          q = m.a(0);
          r = m.a(1);
          var I = m.a(2);
          I >= e && r >= d && (q < g || h && q == g) && (n < f2 || k && n == f2) && c2.push(m);
        }
      else
        for (; G--; )
          c2.push(l[G]);
    }
    if (f2 > v || k && f2 == v)
      e < w && (y = b2[1]) && Cg(a2, y, c2, d, e, f2, g, h, k), (g > w || h && g == w) && (y = b2[3]) && Cg(a2, y, c2, d, e, f2, g, h, k);
    d < v && (e < w && (y = b2[0]) && Cg(a2, y, c2, d, e, f2, g, h, k), (g > w || h && g == w) && (y = b2[2]) && Cg(a2, y, c2, d, e, f2, g, h, k));
  }
  wg.prototype.Lc = ba(1);
  var Dg = 0;
  function Ag(a2, b2, c2, d, e, f2) {
    this.c = b2;
    a2 && (this.parent = a2, this.b = a2.b, b2 & 1 ? (c2 = a2[8], e = a2[5]) : (c2 = a2[7], e = a2[8]), b2 & 2 ? (d = a2[9], f2 = a2[6]) : (d = a2[4], f2 = a2[9]));
    this[7] = c2;
    this[5] = e;
    this[8] = (c2 + e) / 2;
    this[4] = d;
    this[6] = f2;
    this[9] = (d + f2) / 2;
  }
  Ag.prototype.a = 0;
  function Eg(a2, b2) {
    return a2[b2] || (++a2.a, a2[b2] = new Ag(a2, b2));
  }
  Ag.prototype.removeChild = function(a2) {
    var b2 = a2.c;
    this[b2] === a2 && (delete this[b2], delete a2.parent, --this.a);
  };
  Ag.prototype.Lc = ba(0);
  function Fg(a2, b2) {
    (a2.entries || (a2.entries = [])).push(b2);
    b2.node = a2;
  }
  function Gg(a2, b2, c2, d, e) {
    var f2 = a2[5], g = a2[6];
    return a2[7] <= b2 && a2[4] <= c2 && (f2 > d || f2 === d && f2 === a2.b.a[5]) && (g > e || g === e && g === a2.b.a[6]);
  }
  ;
  function Hg(a2, b2, c2, d, e, f2) {
    Hg.j.constructor.apply(this, arguments);
  }
  u(Hg, wg);
  Hg.prototype.s = function(a2) {
    for (var b2, c2, d = this.head; a2; ) {
      if (!(b2 = a2.entries) || !b2.length) {
        if (b2 && delete a2.entries, !a2.a && (c2 = a2.parent)) {
          c2.removeChild(a2);
          d === a2 && (d = c2);
          a2 = c2;
          continue;
        }
      }
      break;
    }
    this.head !== d && (this.head = d, Bg(this));
  };
  function Ig(a2, b2, c2, d, e) {
    if (Gg(a2.a, b2, c2, d, e))
      return Jg(a2, a2.a, b2, c2, d, e, a2.c);
    throw Error("Coordinates out of bounds");
  }
  Hg.prototype.yc = function(a2, b2) {
    return Ig(this, a2, b2, a2, b2);
  };
  function Jg(a2, b2, c2, d, e, f2, g) {
    var h = b2[8], k = b2[9], l = 0, m = 0;
    g && (e < h || (l = +(c2 >= h))) && (f2 < k || (m = +(d >= k))) ? c2 = Jg(a2, Eg(b2, l | m << 1), c2, d, e, f2, g - 1) : (Fg(b2, c2 = new Kg(c2, d, e, f2)), zg(a2, c2, true), Bg(a2, b2));
    return c2;
  }
  function Kg(a2, b2, c2, d) {
    this.id = Dg++;
    this[0] = b2;
    this[1] = c2;
    this[2] = d;
    this[3] = a2;
  }
  Kg.prototype.a = function(a2) {
    return this[a2];
  };
  function Lg(a2) {
    this.g = new Hg(+a2 || 10, 180, 90, 0, 0, true);
    this.f = [];
    this.i = false;
    this.a = this.b = this.c = null;
  }
  t("H.geo.QuadTree", Lg);
  p = Lg.prototype;
  p.Eh = 0;
  p.Rc = function() {
    return this.Eh;
  };
  p.Bb = function() {
    return this.i;
  };
  p.K = function() {
    var a2, b2;
    if (!this.c) {
      var c2 = [];
      !this.b && (a2 = xg(this.g)) && (this.b = new K(-a2[0], a2[3], -a2[2], a2[1]));
      (b2 = this.b) && c2.push(b2);
      var d, e, f2;
      if (!this.a && (f2 = (e = this.f).length)) {
        a2 = 90;
        var g = 360;
        var h = -90;
        for (d = 0; f2--; ) {
          var k = e[f2];
          a2 = yd(a2, k[0]);
          g = yd(g, k[3]);
          h = zd(h, k[2]);
          d = zd(d, k[1]);
        }
        this.a = new K(-a2, g, -h, d - 360);
      }
      (b2 = this.a) && c2.push(b2);
      if (b2 = c2[0])
        c2[1] && (b2 = b2.ec(c2[1], true)), this.c = b2;
    }
    return this.c;
  };
  function Mg(a2, b2, c2, d, e, f2) {
    f2 ? (f2 = new Kg(e, -b2, c2 + 360, -d), a2.f.push(f2), a2.i = true, a2.a && a2.a.Bc(b2, c2, d, e, true, a2.a)) : (f2 = Ig(a2.g, c2, -b2, e, -d), a2.b && a2.b.Bc(b2, c2, d, e, true, a2.b));
    ++a2.Eh;
    a2.c = null;
    return f2;
  }
  p.yc = function(a2) {
    var b2 = a2.lng;
    a2 = a2.lat;
    return Mg(this, a2, b2, a2, b2, false);
  };
  p.Pj = function(a2) {
    var b2 = a2.Nb(), c2 = a2.Jb();
    return (a2 = a2.Bb()) ? Mg(this, b2.lat, c2.lng, c2.lat, b2.lng, a2) : Mg(this, b2.lat, b2.lng, c2.lat, c2.lng, a2);
  };
  Lg.prototype.insertBoundingBox = Lg.prototype.Pj;
  Lg.prototype.remove = function(a2) {
    var b2;
    if (a2.node) {
      var c2 = this.g.remove(a2);
      this.b = null;
    } else if (a2 = (b2 = this.f).indexOf(a2), c2 = 0 <= a2)
      b2.splice(a2, 1), this.i = 0 < b2.length, this.a = null;
    c2 && (--this.Eh, this.c = null);
    return c2;
  };
  Lg.prototype.remove = Lg.prototype.remove;
  function Ng(a2, b2, c2, d, e, f2, g) {
    a2 = a2.f;
    var h = a2.length, k = [], l;
    if (h) {
      var m = c2 + 360;
      for (l = e + 360; h--; ) {
        var n = a2[h];
        Og(n, b2, c2, d, e, f2, g) ? k.push(n) : Og(n, b2, m, d, l, f2, g) && k.push(n);
      }
    }
    return k;
  }
  function Og(a2, b2, c2, d, e, f2, g) {
    var h = a2[3], k = a2[0], l = a2[1];
    a2 = a2[2];
    return (f2 ? k <= d : k < d) && (g ? h <= e : h < e) && a2 >= b2 && l >= c2;
  }
  function Pg(a2, b2) {
    var c2, d, e;
    if (c2 = b2.length) {
      var f2 = a2.length;
      for (d = {}; f2--; )
        d[a2[f2].id] = 1;
      for (; c2--; )
        (e = b2[c2]).id in d || a2.push(e);
    }
  }
  Lg.prototype.Pf = function(a2, b2, c2) {
    var d = this.g, e = a2.Nb(), f2 = a2.Jb(), g = -e.lat;
    e = e.lng;
    var h = -f2.lat;
    f2 = f2.lng;
    !b2 && g === h || !c2 && e === f2 ? a2 = [] : a2.Bb() ? (a2 = d.Za(-180, g, f2, h, c2, b2), Pg(a2, d.Za(e, g, 180, h, false, b2)), Pg(a2, Ng(this, g, f2, h, e + 360, b2, c2))) : (a2 = d.Za(e, g, f2, h, c2, b2), Pg(a2, Ng(this, g, e, h, f2, b2, c2)));
    return a2;
  };
  Lg.prototype.intersectBoundingBox = Lg.prototype.Pf;
  var Qg = [62, -1, -1, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, 63, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51], Rg = "undefined" !== typeof BigInt ? BigInt : Number;
  function Sg(a2) {
    var b2 = Rg(0), c2 = Rg(0), d = [];
    a2.split("").forEach(function(e) {
      e = Rg(Qg[e.charCodeAt(0) - 45]);
      b2 |= (e & Rg(31)) << c2;
      (e & Rg(32)) === Rg(0) ? (d.push(b2), b2 = Rg(0), c2 = Rg(0)) : c2 += Rg(5);
    });
    if (0 < c2)
      throw Error("Invalid encoding");
    return d;
  }
  function Tg(a2) {
    a2 & Rg(1) && (a2 = ~a2);
    a2 >>= Rg(1);
    return +a2.toString();
  }
  function Ug(a2) {
    var b2 = void 0 === a2.precision ? 5 : a2.precision, c2 = void 0 === a2.hf ? 0 : a2.hf, d = void 0 === a2.jf ? 0 : a2.jf;
    a2 = a2.ci;
    var e = Math.pow(10, b2), f2 = Math.pow(10, d);
    b2 = Vg(b2, c2, d);
    var g = [], h = Rg(0), k = Rg(0), l = Rg(0);
    a2.forEach(function(m) {
      var n = Rg(Math.round(m[0] * e));
      g.push(Wg(n - h));
      h = n;
      n = Rg(Math.round(m[1] * e));
      g.push(Wg(n - k));
      k = n;
      c2 && (m = Rg(Math.round(m[2] * f2)), g.push(Wg(m - l)), l = m);
    });
    return (b2 instanceof Array ? b2 : fa(ea(b2))).concat(g instanceof Array ? g : fa(ea(g))).join("");
  }
  function Vg(a2, b2, c2) {
    if (0 > a2 || 15 < a2)
      throw Error("precision out of range. Should be between 0 and 15");
    if (0 > c2 || 15 < c2)
      throw Error("thirdDimPrecision out of range. Should be between 0 and 15");
    if (0 > b2 || 7 < b2 || 4 === b2 || 5 === b2)
      throw Error("thirdDim should be between 0, 1, 2, 3, 6 or 7");
    a2 |= c2 << 7 | b2 << 4;
    return Xg(1) + Xg(a2);
  }
  function Xg(a2) {
    var b2 = "";
    for (a2 = Rg(a2); 31 < a2; ) {
      var c2 = a2 & Rg(31) | Rg(32);
      b2 += "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[c2];
      a2 >>= Rg(5);
    }
    return b2 + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[a2];
  }
  function Wg(a2) {
    a2 = Rg(a2);
    var b2 = 0 > a2;
    a2 <<= Rg(1);
    b2 && (a2 = ~a2);
    return Xg(a2);
  }
  function Yg(a2) {
    return Ug({ ci: a2.polyline, precision: a2.precision, hf: a2.thirdDim, jf: a2.thirdDimPrecision });
  }
  t("H.util.flexiblePolyline.encode", Yg);
  function Zg(a2) {
    a2 = Sg(a2);
    if (1 !== +a2[0].toString())
      throw Error("Invalid format version");
    var b2 = +a2[1].toString();
    b2 = { precision: b2 & 15, hf: b2 >> 4 & 7, jf: b2 >> 7 & 15 };
    for (var c2 = Math.pow(10, b2.precision), d = Math.pow(10, b2.jf), e = b2.hf, f2 = 0, g = 0, h = 0, k = [], l = 2; l < a2.length; ) {
      var m = Tg(a2[l]) / c2, n = Tg(a2[l + 1]) / c2;
      f2 += m;
      g += n;
      e ? (m = Tg(a2[l + 2]) / d, h += m, k.push([f2, g, h]), l += 3) : (k.push([f2, g]), l += 2);
    }
    if (l !== a2.length)
      throw Error("Invalid encoding. Premature ending reached");
    a2 = Object.assign({}, b2, { ci: k });
    return {
      polyline: a2.ci,
      precision: a2.precision,
      thirdDim: a2.hf,
      thirdDimPrecision: a2.jf
    };
  }
  t("H.util.flexiblePolyline.decode", Zg);
  function L(a2) {
    L.j.constructor.call(this);
    a2 && $g(a2, L, 0);
    this.$ = a2 || [];
    this.a = ah(this, 0, this.$.length);
  }
  u(L, jg);
  t("H.geo.LineString", L);
  function ah(a2, b2, c2) {
    a2 = a2.$;
    var d = 0;
    b2 = zd(b2, 0);
    c2 = yd(c2, a2.length);
    c2 -= 2;
    for (b2 += 1; b2 < c2; )
      d += ig(a2[b2], a2[b2 += 3]);
    return d;
  }
  L.prototype.gi = function(a2, b2, c2) {
    bh(this, a2, b2, c2, this.gi);
  };
  L.prototype.pushLatLngAlt = L.prototype.gi;
  function bh(a2, b2, c2, d, e) {
    var f2 = a2.$.length;
    b2 = fg(b2, e);
    c2 = gg(c2, e);
    a2.$.push(fg(b2, e), gg(c2, e), d === B ? 0 : hg(d, e));
    f2 && (a2.a += ig(a2.$[f2 - 2], c2));
    delete a2.b;
    delete a2.c;
  }
  L.prototype.ff = function(a2, b2, c2) {
    c2 && $g(c2, this.ff, 2);
    void 0 === b2 && (b2 = this.$.length);
    b2 && (this.a -= ah(this, a2 - 3, a2 + b2 + 3));
    var d = c2 ? this.$.splice.apply(this.$, [a2, b2].concat(c2)) : this.$.splice(a2, b2);
    c2 && (this.a += ah(this, a2 - 3, a2 + c2.length + 3));
    b2 && !c2 && (this.a += ah(this, a2 - 3, a2 - 3));
    delete this.b;
    delete this.c;
    return d;
  };
  L.prototype.spliceLatLngAlts = L.prototype.ff;
  L.prototype.Qj = function(a2, b2, c2, d) {
    this.ff(a2, 0, [b2, c2, d]);
  };
  L.prototype.insertLatLngAlt = L.prototype.Qj;
  L.prototype.Dk = function(a2) {
    this.ff(a2, 3);
  };
  L.prototype.removeLatLngAlt = L.prototype.Dk;
  L.prototype.qd = function(a2) {
    bh(this, a2.lat, a2.lng, a2.alt, this.qd);
  };
  L.prototype.pushPoint = L.prototype.qd;
  L.prototype.yc = function(a2, b2) {
    this.Qj(3 * a2, b2.lat, b2.lng, b2.alt);
  };
  L.prototype.insertPoint = L.prototype.yc;
  L.prototype.Xe = function(a2) {
    this.Dk(3 * a2);
  };
  L.prototype.removePoint = L.prototype.Xe;
  L.prototype.ye = function(a2, b2) {
    var c2 = this.$, d = 3 * a2;
    a2 = c2[d];
    var e = c2[d + 1];
    c2 = c2[d + 2];
    b2 && (b2.lat = a2, b2.lng = e, b2.alt = c2);
    return b2 || new kg(a2, e, c2);
  };
  L.prototype.extractPoint = L.prototype.ye;
  L.prototype.El = function(a2, b2, c2) {
    var d = this.$;
    b2 = b2 || 0;
    c2 = af(c2, d.length / 3);
    for (var e = 3 * b2; b2 < c2; )
      a2(d[e++], d[e++], d[e++], b2++);
  };
  L.prototype.eachLatLngAlt = L.prototype.El;
  L.isDBC = ig;
  L.prototype.eh = function(a2) {
    var b2 = this.a;
    a2 && (a2 = this.$, b2 += ig(a2[a2.length - 2], a2[1]));
    return b2;
  };
  L.prototype.getDBCs = L.prototype.eh;
  L.prototype.Ie = function() {
    return this.$.length / 3;
  };
  L.prototype.getPointCount = L.prototype.Ie;
  L.prototype.um = function() {
    return this.$;
  };
  L.prototype.getLatLngAltArray = L.prototype.um;
  L.prototype.b = z;
  L.prototype.K = function() {
    var a2;
    if (!(a2 = this.b)) {
      a2 = this.$;
      var b2 = a2.length, c2 = 3, d, e, f2 = z;
      if (3 <= b2) {
        var g = d = a2[0];
        var h = e = a2[1];
        for (f2 = new K(g, h, d, e); c2 < b2; c2 += 3) {
          g = a2[c2 - 3];
          h = a2[c2 - 2];
          d = a2[c2];
          e = a2[c2 + 1];
          if (h > e && 180 < e - h || h < e && -180 > h - e || e < h && 180 > Dd(e - h)) {
            var k = h;
            h = e;
            e = k;
          }
          g < d && (k = g, g = d, d = k);
          rg(f2.c, f2.a, f2.f, f2.b, g, h, d, e, f2);
        }
      }
      a2 = this.b = f2;
    }
    return a2;
  };
  L.prototype.getBoundingBox = L.prototype.K;
  L.prototype.nn = function() {
    return this.b !== z;
  };
  L.prototype.hasBoundingBox = L.prototype.nn;
  function $g(a2, b2, c2) {
    for (var d = a2.length, e = !(d % 3), f2; e && d; )
      e = !(E(a2[--d] = hg((f2 = a2[d]) === B ? 0 : f2)) || E(a2[--d] = gg(a2[d])) || E(a2[--d] = fg(a2[d])));
    if (!e && b2)
      throw new D(b2, c2, a2);
  }
  function ch(a2) {
    var b2 = new L(), c2 = 0, d = a2.length;
    if (d % 2)
      throw new D(ch, 0, a2);
    for (; c2 < d; )
      bh(b2, a2[c2++], a2[c2++], 0, ch);
    return b2;
  }
  L.fromLatLngArray = ch;
  L.prototype.ia = function(a2) {
    var b2 = this === a2, c2;
    if (!b2 && (b2 = C(a2, L))) {
      var d = this.$;
      a2 = a2.$;
      for (b2 = (c2 = d.length) === a2.length; b2 && c2--; )
        b2 = d[c2] == a2[c2];
    }
    return b2;
  };
  L.prototype.equals = L.prototype.ia;
  function dh(a2, b2) {
    return a2.b - b2.b;
  }
  function eh(a2, b2) {
    var c2 = a2.$, d = -2, e = [], f2;
    var g = a2.c;
    if (!g) {
      g = a2.c = new Lg();
      var h = 0;
      var k = a2.$;
      var l = k.length;
      for (f2 = 0; f2 < l; f2 += 3) {
        var m = k[f2];
        var n = k[f2 + 1];
        if (f2) {
          if (r < n) {
            var q = r;
            var r = n;
          } else
            q = n;
          if (w < m)
            var v = m;
          else {
            v = w;
            var w = m;
          }
          q = Mg(g, v, q, w, r, 180 < r - q);
          q.b = h++;
        }
        w = m;
        r = n;
      }
    }
    g = g.Pf(b2).sort(dh);
    k = g.length;
    for (b2 = 0; b2 < k; b2++) {
      h = g[b2];
      h = h.b;
      l = 3 * h;
      if (h > d + 1) {
        var y = [c2[l], c2[l + 1]];
        e.push(y);
      }
      d = h;
      y.push(c2[l + 3], c2[l + 4]);
    }
    if (a2.a) {
      c2 = [];
      d = e.length;
      for (b2 = 0; b2 < d; b2++)
        if (y = e[b2], g = y.length) {
          k = [];
          for (a2 = 0; a2 < g; a2 += 2)
            h = y[a2], l = y[a2 + 1], k.push(h, l), f2 = y[a2 - 1], a2 && ig(l, f2) && (c2.push(k), k = [], f2 += 0 > f2 ? 360 : -360, k.push(y[a2 - 2], f2, h, l));
          c2.push(k);
        }
      e = c2;
    }
    return e;
  }
  p = L.prototype;
  p.rb = "LineString";
  p.cd = function(a2, b2) {
    var c2 = this.$, d = c2.length, e;
    if (d) {
      a2.push("(");
      for (e = 0; e < d; e += 3)
        e && a2.push(","), a2.push(c2[e + 1], " ", c2[e]);
      b2 && (c2[0] !== c2[d - 3] || c2[1] !== c2[d - 2]) && a2.push(",", c2[1], " ", c2[0]);
      a2.push(")");
    } else
      a2.push("EMPTY");
    return a2;
  };
  p.Hb = "LineString";
  p.bd = function() {
    var a2 = [], b2 = this.$, c2 = b2.length, d;
    for (d = 0; d < c2; d += 3)
      a2.push([b2[d + 1], b2[d], b2[d + 2]]);
    return a2;
  };
  p.pc = function() {
    var a2 = this.$, b2;
    if (this.K().Bb()) {
      a2 = a2.slice();
      var c2 = 1;
      for (b2 = a2.length; c2 < b2; c2 += 3)
        0 > a2[c2] && (a2[c2] += 360);
    }
    return a2;
  };
  p.Ko = function(a2) {
    a2 = void 0 === a2 ? 5 : a2;
    for (var b2 = this.$, c2 = b2.length, d = [], e = 0; e < c2; e += 3)
      d.push([b2[e], b2[e + 1], b2[e + 2]]);
    return Yg({ polyline: d, precision: a2, thirdDim: 2, thirdDimPrecision: a2 });
  };
  L.prototype.toFlexiblePolyline = L.prototype.Ko;
  function fh(a2) {
    var b2 = Zg(a2);
    a2 = b2.polyline;
    var c2 = b2.thirdDim;
    b2 = 2 === c2 || 3 === c2;
    c2 = 0 === c2;
    if (!a2)
      throw new D(fh, 0, "data");
    if (b2 || c2) {
      c2 = a2.length;
      var d = Array(3 * c2);
      for (var e = 0, f2 = 0; e < c2; e++) {
        var g = a2[e];
        d[f2++] = g[0];
        d[f2++] = g[1];
        d[f2++] = b2 ? g[2] : 0;
      }
    }
    if (!d)
      throw new D(fh, 0, "only ABSENT, ALTITUDE or ELEVATION are supported as type of the 3rd dimension");
    return new L(d);
  }
  L.fromFlexiblePolyline = fh;
  function gh(a2) {
    xc(this, gh);
    gh.j.constructor.call(this);
    this.la = hh(this, a2, this.constructor, 0);
  }
  u(gh, jg);
  t("H.geo.MultiGeometry", gh);
  gh.prototype.splice = function(a2, b2, c2) {
    a2 = [a2];
    b2 !== B && a2.push(b2);
    c2 && (b2 = hh(this, c2, this.splice, 2), a2 = a2.concat(b2));
    this.a = z;
    return this.la.splice.apply(this.la, a2);
  };
  gh.prototype.splice = gh.prototype.splice;
  gh.prototype.hc = function(a2) {
    var b2 = this.la.length;
    if (!(0 <= a2 && a2 < b2))
      throw new ne(this.hc, a2, [0, b2 - 1]);
    this.a = z;
    return this.la.splice(a2, 1)[0];
  };
  gh.prototype.removeAt = gh.prototype.hc;
  gh.prototype.remove = function(a2) {
    a2 = this.la.indexOf(a2);
    if (0 <= a2) {
      var b2 = this.la.splice(a2, 1)[0];
      this.a = z;
    }
    return b2 || z;
  };
  gh.prototype.remove = gh.prototype.remove;
  gh.prototype.mm = function() {
    return this.la;
  };
  gh.prototype.getGeometries = gh.prototype.mm;
  gh.prototype.push = function(a2) {
    var b2 = hh(this, [a2], this.push, 0)[0];
    this.a && (this.a = this.a.ec(a2.K()));
    this.la.push(b2);
  };
  gh.prototype.push = gh.prototype.push;
  gh.prototype.K = function() {
    var a2;
    if (!(a2 = this.a)) {
      a2 = z;
      var b2, c2;
      if (this.la.length) {
        for (a2 = this.la[0].K(), c2 = 1; c2 < this.la.length; c2++)
          if (b2 = this.la[c2].K())
            a2 = a2 ? a2.ec(b2) : b2;
      }
    }
    return this.a = a2;
  };
  gh.prototype.getBoundingBox = gh.prototype.K;
  gh.prototype.a = z;
  function hh(a2, b2, c2, d) {
    var e, f2 = [];
    if (!Bc(b2))
      throw new D(c2, d);
    for (e = 0; e < b2.length; e++)
      if (a2.b(b2[e]))
        f2.push(a2.c(b2[e]));
      else
        throw new D(c2, d);
    return f2;
  }
  gh.prototype.c = function(a2) {
    return a2;
  };
  gh.prototype.ia = function(a2) {
    var b2 = this === a2, c2;
    if (!b2 && (b2 = C(a2, this.constructor))) {
      var d = this.la;
      a2 = a2.la;
      for (b2 = (c2 = d.length) === a2.length; b2 && c2--; )
        b2 = d[c2].ia(a2[c2]);
    }
    return b2;
  };
  gh.prototype.equals = gh.prototype.ia;
  gh.prototype.cd = function(a2) {
    var b2 = this.la, c2 = b2.length, d, e, f2 = false;
    if (c2) {
      a2.push("(");
      for (d = 0; d < c2; d++)
        (e = 0 < d && f2) && a2.push(","), b2[d].cd(a2), "EMPTY" === a2[a2.length - 1] ? a2.splice(-1 - +e, 1 + +e) : f2 = true;
      f2 ? a2.push(")") : a2.splice(-1, 1, "EMPTY");
    } else
      a2.push("EMPTY");
    return a2;
  };
  gh.prototype.pc = function() {
    for (var a2 = [], b2 = this.la, c2 = b2.length; c2--; )
      a2[c2] = b2[c2].pc();
    return a2;
  };
  gh.prototype.Y = function() {
    var a2 = gh.j.Y.call(this);
    a2.type = this.rb;
    return a2;
  };
  gh.prototype.bd = function() {
    for (var a2 = [], b2 = this.la, c2 = b2.length; c2--; )
      a2[c2] = b2[c2].bd();
    return a2;
  };
  function ih(a2) {
    ih.j.constructor.call(this, a2);
  }
  u(ih, gh);
  t("H.geo.MultiLineString", ih);
  ih.prototype.b = function(a2) {
    return C(a2, L);
  };
  ih.prototype.rb = "Multi" + L.prototype.rb;
  ih.prototype.Hb = "Multi" + L.prototype.Hb;
  function jh() {
  }
  t("H.map.provider.Invalidations", jh);
  jh.MARK_INITIAL = Xd;
  jh.prototype.update = function(a2, b2) {
    b2 !== kh.NONE && (this.a = a2, b2 & kh.SPATIAL && (this.f = a2), b2 & kh.VISUAL && (this.g = a2), b2 & kh.ADD && (this.b = a2), b2 & kh.REMOVE && (this.c = a2), b2 & kh.Z_ORDER && (this.l = a2), b2 & kh.VOLATILITY && (this.i = a2));
  };
  jh.prototype.update = jh.prototype.update;
  jh.prototype.Bm = function() {
    return this.a;
  };
  jh.prototype.getMark = jh.prototype.Bm;
  jh.prototype.a = Xd;
  jh.prototype.rn = function(a2) {
    return this.a > a2;
  };
  jh.prototype.isAny = jh.prototype.rn;
  jh.prototype.g = Xd;
  jh.prototype.Vd = function(a2) {
    return this.g > a2;
  };
  jh.prototype.isVisual = jh.prototype.Vd;
  jh.prototype.f = Xd;
  jh.prototype.yh = function(a2) {
    return this.f > a2;
  };
  jh.prototype.isSpatial = jh.prototype.yh;
  jh.prototype.b = Xd;
  jh.prototype.Rj = function(a2) {
    return this.b > a2;
  };
  jh.prototype.isAdd = jh.prototype.Rj;
  jh.prototype.c = Xd;
  jh.prototype.Sf = function(a2) {
    return this.c > a2;
  };
  jh.prototype.isRemove = jh.prototype.Sf;
  jh.prototype.l = Xd;
  jh.prototype.zh = function(a2) {
    return this.l > a2;
  };
  jh.prototype.isZOrder = jh.prototype.zh;
  jh.prototype.i = Xd;
  jh.prototype.vn = function(a2) {
    return this.i > a2;
  };
  jh.prototype.isVolatility = jh.prototype.vn;
  var kh = { NONE: 0, VISUAL: 1, SPATIAL: 2, ADD: 4, REMOVE: 8, Z_ORDER: 16, VOLATILITY: 32 };
  jh.Flag = kh;
  function lh(a2) {
    lh.j.constructor.call(this);
    void 0 !== a2 && (this.data = a2);
  }
  u(lh, F);
  t("H.map.Feature", lh);
  lh.prototype.getData = function() {
    return this.data;
  };
  lh.prototype.getData = lh.prototype.getData;
  lh.prototype.o = function() {
    lh.j.o.call(this);
    delete this.data;
  };
  function M(a2) {
    xc(this, M);
    M.j.constructor.call(this, a2 ? a2.data : B);
    this.ea = mh.next();
    if (a2) {
      var b2 = "min";
      Fc(a2[b2]) && (this.m = a2[b2]);
      b2 = "max";
      Fc(a2[b2]) && (this.s = a2[b2]);
      b2 = "visibility";
      b2 in a2 && (this.u = !!a2[b2]);
      b2 = "volatility";
      b2 in a2 && (this.P = !!a2[b2]);
      b2 = "zIndex";
      b2 in a2 && (this.l = +a2[b2] || 0);
      b2 = "provider";
      b2 in a2 && !C(a2[b2], N) && (this.ma = a2[b2], this.ra(kh.ADD));
    }
  }
  u(M, lh);
  t("H.map.Object", M);
  var mh = new cf(1), nh = { ANY: 31, OVERLAY: 1, SPATIAL: 2, MARKER: 4, DOM_MARKER: 8, GROUP: 16 };
  M.Type = nh;
  M.prototype.cb = function() {
    return this.ea;
  };
  M.prototype.getId = M.prototype.cb;
  M.prototype.Ai = function(a2) {
    if (!Fc(a2) && !Cc(a2))
      throw new D(this.Ai, 0, "id must be a number or a string");
    this.i = a2;
    return this;
  };
  M.prototype.setRemoteId = M.prototype.Ai;
  M.prototype.Rm = function() {
    return this.i;
  };
  M.prototype.getRemoteId = M.prototype.Rm;
  M.prototype.m = -1 / 0;
  M.prototype.s = 1 / 0;
  M.prototype.zj = function(a2) {
    var b2 = this.s;
    if (a2)
      for (a2 = this; a2 = a2.Fa; )
        b2 = yd(b2, a2.s);
    return b2;
  };
  M.prototype.getMax = M.prototype.zj;
  M.prototype.Bj = function(a2) {
    var b2 = this.m;
    if (a2)
      for (a2 = this; a2 = a2.Fa; )
        b2 = zd(b2, a2.m);
    return b2;
  };
  M.prototype.getMin = M.prototype.Bj;
  M.prototype.u = true;
  M.prototype.qb = function(a2) {
    var b2 = this.u;
    (a2 = !!a2) !== b2 && (this.u = a2, this.invalidate(kh.VISUAL));
    return this;
  };
  M.prototype.setVisibility = M.prototype.qb;
  M.prototype.wc = function(a2) {
    for (var b2 = this, c2; (c2 = b2.u) && a2 && (b2 = b2.Fa); )
      ;
    return c2;
  };
  M.prototype.getVisibility = M.prototype.wc;
  M.prototype.P = false;
  M.prototype.Lf = function(a2) {
    for (var b2 = this, c2; !(c2 = b2.P) && a2 && (b2 = b2.Fa); )
      ;
    return c2;
  };
  M.prototype.getVolatility = M.prototype.Lf;
  M.prototype.Vk = function(a2) {
    var b2 = this.P;
    b2 !== !!a2 && (this.P = !b2, this.invalidate(kh.VOLATILITY));
    return this;
  };
  M.prototype.setVolatility = M.prototype.Vk;
  M.prototype.l = B;
  M.prototype.Ij = function() {
    return this.l;
  };
  M.prototype.getZIndex = M.prototype.Ij;
  M.prototype.fe = function(a2) {
    a2 !== this.l && (this.Ye(), this.l = a2, this.invalidate(kh.Z_ORDER));
    return this;
  };
  M.prototype.setZIndex = M.prototype.fe;
  M.prototype.L = B;
  M.prototype.Uc = function() {
    var a2 = this.L, b2, c2;
    if (!a2) {
      var d = +((b2 = this.l) !== B);
      (a2 = this.Fa) ? (a2 = a2.Uc().slice(), a2[0] |= d) : a2 = [d];
      a2.push(b2 || 0, 0 > (c2 = this.Di) ? this.ea : c2);
      this.L = a2;
    }
    return a2;
  };
  M.prototype.getZInfo = M.prototype.Uc;
  M.prototype.Ye = function() {
    this.L = B;
  };
  function oh(a2, b2, c2) {
    var d, e;
    if (!c2 || a2[0] | b2[0]) {
      var f2 = a2.length;
      var g = b2.length;
      var h = yd(f2, g);
      var k = 1;
      for (e = 1 + +c2; k < h; k += e)
        if (d = a2[k] - b2[k])
          return d;
    }
    return c2 ? 0 : f2 - g;
  }
  M.compareZInfo = oh;
  function ph(a2, b2) {
    return a2.cj(b2);
  }
  M.compareZOrder = ph;
  M.prototype.cj = function(a2) {
    return this.T - a2.T || oh(this.Uc(), a2.Uc(), false);
  };
  M.prototype.compareZOrder = M.prototype.cj;
  p = M.prototype;
  p.previousSibling = z;
  p.nextSibling = z;
  p.Di = -1;
  p.Fa = z;
  p.Fm = function() {
    return this.Fa;
  };
  M.prototype.getParentGroup = M.prototype.Fm;
  M.prototype.bc = function() {
    for (var a2 = this, b2; b2 = a2.Fa; )
      a2 = b2;
    return a2;
  };
  M.prototype.getRootGroup = M.prototype.bc;
  M.prototype.contains = function(a2) {
    return this === a2;
  };
  M.prototype.contains = M.prototype.contains;
  M.prototype.ka = function(a2) {
    if (this.Fa)
      throw new $c(this.ka, "Not allowed for a child of a group");
    M.j.ka.call(this, a2);
  };
  M.prototype.setParentEventTarget = M.prototype.ka;
  M.prototype.draggable = false;
  M.prototype.ma = z;
  M.prototype.ca = function() {
    return this.ma;
  };
  M.prototype.getProvider = M.prototype.ca;
  M.prototype.ee = function(a2, b2) {
    var c2 = this.ma, d;
    if (d = c2 !== a2) {
      if (b2 && (c2 && !C(c2, N) || a2 && !C(a2, N)))
        throw new $c(b2, "Only LocalObjectProvider allows an object transfers");
      b2 = this.type !== nh.GROUP;
      c2 && (this.invalidate(kh.REMOVE), b2 && c2.Ga(this));
      if (this.ma = a2)
        b2 && a2.fa(this), this.ta = z, this.invalidate(kh.ADD);
    }
    return d;
  };
  M.prototype.ta = z;
  M.prototype.Kb = function() {
    return this.ta || (this.ta = new jh());
  };
  M.prototype.getInvalidations = M.prototype.Kb;
  M.prototype.ra = function(a2) {
    var b2 = this.ca(), c2;
    (c2 = !!b2) && b2.invalidateObject(this, a2);
    return c2;
  };
  M.prototype.invalidate = M.prototype.ra;
  M.prototype.o = function() {
    this.Fa && this.Fa.Ga(this);
    M.j.o.call(this);
  };
  M.prototype.setData = function(a2) {
    this.data = a2;
    return this;
  };
  M.prototype.setData = M.prototype.setData;
  M.prototype.Kc = function(a2) {
    var b2;
    if (a2 && !Da(a2))
      throw new D(M.prototype.Kc, 0, "opt_callback must be a function");
    a2 = qh(this, a2 ? a2(this.data) : this.data, !!a2);
    this instanceof rh || this instanceof sh || this instanceof th || this instanceof uh ? b2 = { type: "Feature", properties: a2, geometry: this.ga().Kc() } : b2 = { type: "FeatureCollection", features: hf };
    this.i && (b2.id = this.i);
    return b2;
  };
  M.prototype.toGeoJSON = M.prototype.Kc;
  function qh(a2, b2, c2) {
    if (null === b2 || b2 === B)
      return null;
    if (0 <= Object.keys(b2).length && "[object Object]" !== Object.prototype.toString.call(b2))
      throw Error(vh(a2, c2));
    try {
      return JSON.stringify(b2), b2;
    } catch (d) {
      throw Error(vh(a2, c2));
    }
  }
  function vh(a2, b2) {
    return "Object Remote-Id: " + a2.i + " - " + (b2 ? "The value returned by the callback is not a valid JSON object and cannot be set as Feature properties." : "The given object data is not a valid JSON object and cannot be set as Feature properties.");
  }
  M.prototype.Y = function() {
    return { id: this.ea, properties: { min: this.Bj(), max: this.zj(), zIdx: this.l, sIdx: this.Di, parent: this.Fa ? this.Fa.cb() : 0, visible: this.wc(), "volatile": this.Lf() }, type: "Feature" };
  };
  M.prototype.forWorkerMessage = M.prototype.Y;
  function wh(a2) {
    var b2;
    if (a2) {
      var c2 = xh;
      for (b2 = C(a2, wh); c2--; ) {
        var d = yh[c2];
        if (a2.hasOwnProperty(d)) {
          var e = a2[d];
          if (b2)
            this[d] = e;
          else {
            if ((e = zh[c2](e)) === Ah)
              throw new D(wh, 0, d + ": " + a2[d]);
            e !== this[d] && e !== B && (this[d] = e);
          }
        }
      }
      c2 = b2 ? a2.b : this.lineWidth && Ze(this.strokeColor);
      c2 || (this.b = c2);
      c2 = b2 ? a2.Ob : Ze(this.fillColor);
      c2 || (this.Ob = c2);
      c2 = b2 ? a2.a : "none" !== this.strokeColor && this.lineWidth;
      c2 || (this.a = c2);
    }
    qc(this);
  }
  t("H.map.SpatialStyle", wh);
  wh.prototype.Ob = true;
  wh.prototype.b = true;
  wh.prototype.a = true;
  var yh = "strokeColor fillColor lineWidth lineCap lineJoin miterLimit lineDash lineDashOffset lineDashImage lineHeadCap lineTailCap".split(" ");
  wh.prototype.strokeColor = "rgba(0,85,170,.6)";
  wh.prototype.strokeColor = wh.prototype.strokeColor;
  wh.prototype.fillColor = "rgba(0,85,170,.4)";
  wh.prototype.fillColor = wh.prototype.fillColor;
  wh.prototype.lineWidth = 2;
  wh.prototype.lineWidth = wh.prototype.lineWidth;
  wh.prototype.lineCap = "round";
  wh.prototype.lineCap = wh.prototype.lineCap;
  wh.prototype.lineJoin = "miter";
  wh.prototype.lineJoin = wh.prototype.lineJoin;
  wh.prototype.miterLimit = 1;
  wh.prototype.miterLimit = wh.prototype.miterLimit;
  wh.prototype.Bn = hf;
  wh.prototype.lineDash = wh.prototype.Bn;
  wh.prototype.lineDashOffset = 0;
  wh.prototype.lineDashOffset = wh.prototype.lineDashOffset;
  wh.prototype.Cn = B;
  wh.prototype.lineDashImage = wh.prototype.Cn;
  wh.prototype.Dn = B;
  wh.prototype.lineHeadCap = wh.prototype.Dn;
  wh.prototype.En = B;
  wh.prototype.lineTailCap = wh.prototype.En;
  var xh = yh.length;
  wh.prototype.ia = function(a2) {
    var b2 = this === a2;
    if (!b2 && a2) {
      for (b2 = 0; b2 < xh; b2++) {
        var c2 = yh[b2];
        if (this[c2] !== a2[c2])
          break;
      }
      b2 = b2 === xh;
    }
    return b2;
  };
  wh.prototype.equals = wh.prototype.ia;
  wh.prototype.vj = function(a2) {
    if (a2) {
      var b2 = {};
      Ya(b2, this, a2);
    } else
      b2 = this;
    return new wh(b2);
  };
  wh.prototype.getCopy = wh.prototype.vj;
  var Ah = qc({}), zh = [function(a2) {
    return a2 ? pc(a2) : Ah;
  }, function(a2) {
    return a2 ? pc(a2) : Ah;
  }, function(a2) {
    return 0 <= a2 && 100 >= a2 ? +a2 : Ah;
  }, function(a2) {
    a2 = pc(a2);
    return "butt" === a2 || "square" === a2 || "round" === a2 || "arrow-head" === a2 || "arrow-tail" === a2 ? a2 : Ah;
  }, function(a2) {
    return "round" === a2 || "bevel" === a2 || "miter" === a2 ? a2 : Ah;
  }, function(a2) {
    return 0 < a2 && 100 >= a2 ? +a2 : Ah;
  }, function(a2) {
    return a2 && a2.every && a2.every(Gc) ? a2 : Ah;
  }, function(a2) {
    return E(+a2) ? Ah : +a2;
  }, function(a2) {
    return a2 === B || a2 instanceof HTMLImageElement || a2 instanceof HTMLCanvasElement || Object.values(Bh).includes(a2) ? a2 : Ah;
  }, function(a2) {
    return vc(a2) ? zh[3](a2) : B;
  }, function(a2) {
    return vc(a2) ? zh[3](a2) : B;
  }], Ch = new Image().src = "data:image/svg+xml;base64," + btoa('<svg width="128" height="128" viewBox="0 0 128 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><g id="arrow"><path style="fill:#ff0000" d="M 0,0 32,64 2,128 128,64 Z"/></g></svg> '), Dh = new Image().src = "data:image/svg+xml;base64," + btoa('<svg width="128" height="128" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg"><circle style="fill:#ffffff" cx="64" cy="64" r="64" /></svg>'), Bh = { ARROW: Ch, CIRCLE: Dh };
  wh.DashImage = Bh;
  wh.MAX_LINE_WIDTH = 100;
  var Eh = new wh();
  wh.DEFAULT_STYLE = Eh;
  var Fh = "fillColor strokeColor lineWidth lineCap lineJoin miterLimit lineDashOffset lineDash lineTailCap lineHeadCap".split(" ");
  wh.prototype.Y = function() {
    for (var a2 = {}, b2 = Fh.length, c2; b2--; )
      c2 = Fh[b2], a2[c2] = this[c2];
    return a2;
  };
  wh.prototype.forWorkerMessage = wh.prototype.Y;
  function Gh(a2) {
    var b2;
    if (a2) {
      var c2 = C(a2, Gh);
      for (b2 in a2)
        if (b2 in this) {
          var d = a2[b2];
          d !== this[b2] && ("fillColor" === b2 || 0 < (d = +d)) && (this[b2] = d);
        }
      a2 = c2 ? a2.Ob : !!(Ze(this.fillColor) && this.width && this.width);
      a2 || (this.Ob = a2);
    }
    qc(this);
  }
  t("H.map.ArrowStyle", Gh);
  Gh.prototype.Ob = true;
  Gh.prototype.fillColor = "rgba(255,255,255,.75)";
  Gh.prototype.width = 1.2;
  Gh.prototype.length = 1.6;
  Gh.prototype.frequency = 5;
  Gh.prototype.uj = function() {
    return new Gh(this);
  };
  Gh.prototype.ia = function(a2) {
    var b2 = this === a2;
    !b2 && a2 && (b2 = a2.width === this.width && a2.fillColor === this.fillColor && a2.length === this.length && a2.frequency === this.frequency);
    return b2;
  };
  Gh.prototype.equals = Gh.prototype.ia;
  function Hh(a2, b2) {
    var c2;
    Hh.j.constructor.call(this, b2);
    b2 && this.gb(b2.style);
    a2 && (this.g = true);
    b2 && (c2 = b2.arrows) && this.Mk(c2);
  }
  u(Hh, M);
  t("H.map.Spatial", Hh);
  Hh.prototype.type = nh.SPATIAL;
  Hh.prototype.T = 0;
  Hh.prototype.style = Eh;
  Hh.prototype.V = function() {
    return this.style;
  };
  Hh.prototype.getStyle = Hh.prototype.V;
  Hh.prototype.gb = function(a2) {
    var b2 = true;
    a2 ? this.style = C(a2, wh) ? a2 : new wh(a2) : this.style ? delete this.style : b2 = false;
    b2 && this.invalidate(kh.VISUAL);
    return this;
  };
  Hh.prototype.setStyle = Hh.prototype.gb;
  Hh.prototype.Ml = function() {
    return this.c;
  };
  Hh.prototype.getArrows = Hh.prototype.Ml;
  Hh.prototype.Mk = function(a2) {
    var b2 = this.c, c2 = false;
    !a2 && b2 ? (delete this.c, c2 = true) : !a2 || b2 && b2.ia(a2) || (this.c = new Gh(a2), c2 = true);
    c2 && "none" !== this.style.strokeColor && this.ra(1);
    return this;
  };
  Hh.prototype.setArrows = Hh.prototype.Mk;
  function Ih(a2, b2) {
    var c2 = false, d = false, e;
    if (b2.length) {
      for (c2 = 0; c2 < b2.length; c2++)
        if (b2[c2] !== Jh) {
          d = true;
          break;
        }
      b2 = a2.style;
      c2 = d ? b2.b || b2.Ob && a2.g || (e = a2.c || false) && b2.a && e.Ob : b2.Ob;
    }
    return c2 && a2.wc(true);
  }
  Hh.prototype.g = false;
  Hh.prototype.sn = function() {
    return this.g;
  };
  Hh.prototype.isClosed = Hh.prototype.sn;
  Hh.prototype.getGeometriesForTile = Hh.prototype.Kd;
  Hh.prototype.gh = function() {
    return B;
  };
  Hh.prototype.getLabels = Hh.prototype.gh;
  function Kh(a2, b2) {
    Kh.j.constructor.call(this, a2, b2);
  }
  u(Kh, Hh);
  t("H.map.GeoShape", Kh);
  Kh.prototype.getBoundingBox = Kh.prototype.K;
  function Lh(a2, b2, c2, d) {
    var e = [], f2 = b2.length, g;
    for (g = 0; g < f2; g++) {
      var h = b2[g];
      h.length && e.push(Mh(a2, h, c2, d));
    }
    return e;
  }
  function Mh(a2, b2, c2, d) {
    var e, f2 = [], g = b2.length, h = 0;
    a2.xa = 0;
    for (e = e || 0; h < g; )
      f2.push(Nh(a2, b2[h++], b2[h++], e, d));
    c2 && f2.push(Nh(a2, b2[0], b2[1], e, d));
    return f2;
  }
  function Nh(a2, b2, c2, d, e) {
    var f2 = a2.xa;
    f2 && 180 < Dd(f2 - c2) && (c2 += 0 > f2 ? -360 : 360);
    a2.xa = c2;
    return e.Ah(b2, c2 + d);
  }
  function Oh(a2, b2, c2) {
    for (var d = b2, e, f2 = a2.length + b2, g, h; d--; ) {
      b2 = a2[d];
      g = b2.length;
      for (e = Array(g); g--; )
        h = b2[g], e[g] = new J(h.x + c2, h.y);
      a2[--f2] = e;
    }
  }
  ;
  function Ph(a2, b2, c2) {
    this.paths = this.a = a2;
    b2 !== B && (this.interiorsIndex = this.b = b2);
    c2 !== B && (this.outlinesIndex = this.c = c2);
  }
  Ph.prototype.b = Wd;
  Ph.prototype.interiorsIndex = Ph.prototype.b;
  Ph.prototype.c = Wd;
  Ph.prototype.outlinesIndex = Ph.prototype.c;
  var Jh = rc(new Ph([])), Qh = qc([]);
  function th(a2, b2) {
    th.j.constructor.call(this, false, b2);
    this.da(a2);
  }
  u(th, Kh);
  t("H.map.Polyline", th);
  th.prototype.K = function() {
    return this.a.K();
  };
  th.prototype.getBoundingBox = th.prototype.K;
  th.prototype.da = function(a2) {
    var b2 = this.da, c2, d;
    if (C(a2, ih)) {
      var e = a2.la;
      if (c2 = e.length)
        for (d = 0; d < c2; d++)
          Rh(e[d], b2);
      else
        throw new D(b2, 0);
    } else
      Rh(a2, b2);
    this.b = !!e;
    this.a = a2;
    this.ra(kh.SPATIAL);
    return this;
  };
  th.prototype.setGeometry = th.prototype.da;
  th.prototype.ga = function() {
    return this.a;
  };
  th.prototype.getGeometry = th.prototype.ga;
  th.prototype.clip = function(a2) {
    var b2 = this.a;
    return eh(this.b ? b2.la[0] : b2, a2);
  };
  th.prototype.clip = th.prototype.clip;
  th.prototype.Kd = function(a2) {
    var b2 = this.a;
    var c2, d = [];
    if (this.b)
      for (b2 = b2.la, c2 = b2.length; c2--; )
        Sh(this, b2[c2], a2, d);
    else
      Sh(this, b2, a2, d);
    return d.length ? d : B;
  };
  th.prototype.getGeometriesForTile = th.prototype.Kd;
  function Rh(a2, b2) {
    if (!C(a2, L) || 2 > a2.Ie())
      throw new D(b2, 0);
  }
  function Sh(a2, b2, c2, d) {
    var e = eh(b2, c2.Hf());
    if (e.length && (b2 = c2.Jf(), a2 = Lh(a2, e, false, b2), e = a2.length)) {
      var f2 = c2.Le();
      b2 = b2.w;
      c2.x || Oh(a2, e, -b2);
      c2.x === (1 << c2.z) - 1 && Oh(a2, e, b2);
      c2 = Uf(a2, f2.left, f2.top, f2.right, f2.bottom, false);
      c2.length && d.push(new Ph(c2));
    }
  }
  th.prototype.Y = function() {
    var a2 = th.j.Y.call(this), b2 = a2.properties;
    a2.geometry = this.ga().Y();
    b2.style = this.V().Y();
    b2.height = 0;
    return a2;
  };
  th.prototype.forWorkerMessage = th.prototype.Y;
  var Th;
  function Uh(a2, b2) {
    if (x.URL)
      return new x.URL(a2, b2).toString();
    if (!a2 || !Vh(a2))
      return a2;
    if (!b2 || Vh(b2))
      throw new TypeError("Failed to construct 'URL': Invalid base URL");
    Th || (Th = document.createElement("a"), Ic(Th));
    var c2 = Th;
    c2.href = b2;
    "/" !== a2[0] ? a2 = c2.href.replace(/\/[^\/]*$/, "/") + a2 : ((b2 = c2.origin) || (b2 = c2.protocol + "//" + c2.host), a2 = b2 + a2);
    return a2;
  }
  function Vh(a2) {
    var b2 = false;
    "string" === typeof a2 && (b2 = !(-1 < a2.search(/^(http|https|data|blob):/) || "//" === a2.substr(0, 2)));
    return b2;
  }
  ;
  function Wh(a2, b2) {
    Wh.j.constructor.call(this);
    if (b2 && Vh(b2))
      throw new D(Wh, 1, "Base URL must be absolute");
    this.C = Xh.INIT;
    this.Ca = null;
    this.Yb = b2;
  }
  u(Wh, F);
  t("H.map.render.Style", Wh);
  Wh.prototype.load = Wh.prototype.load;
  Wh.prototype.getState = function() {
    return this.C;
  };
  Wh.prototype.getState = Wh.prototype.getState;
  Wh.prototype.O = function(a2) {
    this.C = a2;
  };
  Wh.prototype.setState = Wh.prototype.O;
  Wh.prototype.Ib = function() {
    return this.Yb;
  };
  Wh.prototype.getBaseUrl = Wh.prototype.Ib;
  Wh.prototype.qc = function() {
    return sc(this.Ca);
  };
  Wh.prototype.getConfig = Wh.prototype.qc;
  Wh.prototype.Tl = function() {
    return this.Ca;
  };
  Wh.prototype.getConfigReference = Wh.prototype.Tl;
  Wh.prototype.vd = function(a2) {
    this.Ca = a2;
  };
  Wh.prototype.setConfig = Wh.prototype.vd;
  Wh.prototype.Gb = function(a2) {
    this.Ca = null;
    this.O(Xh.ERROR);
    this.sh(Yh) ? this.dispatchEvent(new wd(Yh, a2, this)) : console.error(a2);
  };
  Wh.prototype.dispatchError = Wh.prototype.Gb;
  Wh.prototype.o = function() {
    Wh.j.o.call(this);
    this.Ca = null;
  };
  var Yh = "error", Zh = { ed: "change", Ni: Yh }, Xh = { ERROR: -1, INIT: 0, LOADING: 1, READY: 2 };
  Wh.State = Xh;
  function $h(a2, b2) {
    var c2, d = arguments.length, e, f2;
    for (c2 = 1; c2 < d; c2++)
      if ((e = arguments[c2]) && e !== a2 && e !== g) {
        var g = e;
        for (f2 in e) {
          var h = e[f2];
          a2[f2] !== h && (ai(h) ? ai(a2[f2]) ? a2[f2] = $h(a2[f2], h) : a2[f2] = sc(h) : void 0 !== h && (a2[f2] = sc(h)));
        }
      }
    return a2;
  }
  t("H.util.webgl.mergeObjects", $h);
  var bi = oc();
  function ci(a2, b2, c2) {
    var d = c2[a2];
    return b2 && d in b2 && 0 > uc.indexOf(d) ? (b2 = b2[d], ++a2 < c2.length ? ci(a2, b2, c2) : b2) : bi;
  }
  var di = ci.bind(null, 0), ei = { polygons: 1, lines: 1, "pattern-lines": 1, points: 1, text: 1, raster: 1, custom_icons: 1, overlays: 1 }, fi = { data: 1, draw: 1, enabled: 1, filter: 1, properties: 1 }, gi = Object.keys(fi);
  function hi(a2, b2, c2, d, e, f2) {
    var g = d[a2], h = c2[g];
    if (++a2 < d.length) {
      var k = b2[g] || {};
      for (c2 = gi.length; c2--; ) {
        var l = gi[c2];
        if ("draw" !== l || !f2) {
          var m = h[l];
          m !== B && (k[l] = sc(m));
        }
      }
      hi(a2, k, h, d, e, f2);
    } else
      e ? k = sc(h) : (k = h, delete c2[g]);
    b2[g] = b2[g] ? $h(b2[g], k) : k;
  }
  var ii = hi.bind(null, 0);
  function ji(a2, b2) {
    a2 in ei && (b2[a2] = 1);
  }
  function ki(a2, b2, c2) {
    var d, e, f2;
    for (d in a2)
      if (fi[d]) {
        if ("draw" === d) {
          var g = a2[d];
          for (e in g) {
            var h = g[e];
            (f2 = h.style) ? (h.style = b2 + f2, ji(f2, c2)) : (delete g[e], g[b2 + e] = h, ji(e, c2));
          }
        }
      } else
        ki(a2[d], b2, c2);
  }
  function li(a2, b2) {
    var c2 = {}, d, e, f2, g;
    b2 += "_";
    a2 = $h({}, a2);
    if (d = a2.styles)
      for (e in d) {
        var h = d[e];
        delete d[e];
        d[b2 + e] = h;
        if (f2 = h.mix)
          for (Cc(f2) && (f2 = [f2]), g = f2.length; g--; )
            ji(f2[g], c2), f2[g] = b2 + f2[g];
        if (g = h.base)
          f2 || (f2 = h.mix = []), f2.unshift(b2 + g), delete h.base, ji(g, c2);
        ji(e, c2);
      }
    else
      d = a2.styles = {};
    if (h = a2.layers)
      for (e in h)
        f2 = h[e], delete h[e], (g = f2.data) && !g.layer && (g.layer = e), h[b2 + e] = f2, ki(f2, b2, c2);
    for (e in c2)
      d[b2 + e] = { base: e };
    return a2;
  }
  function mi(a2, b2) {
    var c2 = a2.sources, d = Object.keys(c2)[0], e = $h(c2[d], { uid: b2 });
    c2 = a2.layers;
    var f2;
    a2.sources = {};
    a2.sources[b2] = e;
    for (f2 in c2)
      a2 = c2[f2], a2.data ? a2.data.source === d && (a2.data.source = b2) : a2.data = { source: b2 };
  }
  function ni(a2, b2) {
    var c2;
    var d = a2.textures;
    a2 = a2.fonts;
    for (c2 in d) {
      var e = d[c2];
      e.url && (e.url = Uh(e.url, b2));
    }
    for (c2 in a2)
      if (e = a2[c2], Bc(e))
        for (d = 0; d < e.length; d++) {
          var f2 = e[d];
          f2.url = f2.url && Uh(f2.url, b2);
        }
      else
        f2 = e, f2.url = f2.url && Uh(f2.url, b2);
  }
  function oi(a2, b2) {
    return "function(){return " + ("feature." + a2 + (b2 || "")) + ";}";
  }
  function pi(a2) {
    return oi("style." + a2, void 0);
  }
  function qi(a2, b2, c2, d) {
    a2 = { base: a2, blend: b2, blend_order: c2 };
    d && (a2.clean_depth = !!d);
    return a2;
  }
  function ri(a2) {
    var b2 = {};
    b2["translucent-" + (a2 ? "extruded-" : "") + "polygons"] = { color: pi("fillColor"), order: 1, interactive: true, extrude: a2 };
    return b2;
  }
  function si(a2, b2, c2, d) {
    a2 = { data: { source: a2, layer: b2 } };
    c2 && (a2.draw = c2);
    d && (a2.filter = d);
    return a2;
  }
  function ai(a2) {
    return Ea(a2) && !Bc(a2);
  }
  ;
  function ti(a2, b2) {
    ti.j.constructor.call(this, a2, b2);
    if (Cc(a2))
      ui.test(a2) && -1 === a2.indexOf("import:") ? (this.b = a2, b2 || (this.g = Vh(this.b) ? B : this.b)) : this.c = a2;
    else if (Ea(a2))
      this.vd(sc(a2));
    else
      throw new D(ti, 0, "invalid style configuration");
  }
  u(ti, Wh);
  t("H.map.render.webgl.Style", ti);
  ti.prototype.load = function() {
    var a2 = this, b2 = this.Ib();
    this.b ? (this.O(Xh.LOADING), new tf("text/plain", this.b).then(function(c2) {
      var d = {};
      return vi(c2, b2, false, (d[b2] = true, d));
    }).then(function(c2) {
      return a2.vd(c2);
    }, function(c2) {
      return a2.Gb(c2.message);
    }), delete this.b) : this.c && (this.O(Xh.LOADING), vi(this.c, b2).then(function(c2) {
      return a2.vd(c2);
    }, function(c2) {
      return a2.Gb(c2.message);
    }), delete this.c);
  };
  ti.prototype.load = ti.prototype.load;
  ti.prototype.Rk = function(a2, b2, c2) {
    var d;
    wi(this);
    a2 = xi(this, a2, this.Rk, c2);
    for (c2 = 0; c2 < a2.length; c2++) {
      var e = a2[c2].eb.draw;
      for (d in e) {
        var f2 = e[d];
        ai(f2) && (f2.interactive = !!b2);
      }
    }
    yi(this);
  };
  ti.prototype.setInteractive = ti.prototype.Rk;
  ti.prototype.setProperty = function(a2, b2, c2) {
    var d, e = a2.split("."), f2 = 0, g = e.length;
    wi(this);
    if (!vc(b2))
      throw new D(this.setProperty, 1, "value");
    if (d = zi(this.Ca, e)) {
      if (!(d.parent instanceof Object) || d.parent instanceof Array)
        if (c2)
          e.pop(), e = zi(this.Ca, e), d.parent = e.parent[e.fg] = {};
        else
          throw new D(this.setProperty, 0, a2 + " property is not primitive type");
      d.parent[d.fg] = b2;
    } else {
      for (d = this.Ca; f2 !== g - 1; )
        d[e[f2]] = {}, d = d[e[f2++]];
      d[e[f2]] = b2;
    }
    Ai(this) && yi(this);
  };
  ti.prototype.setProperty = ti.prototype.setProperty;
  ti.prototype.kh = function(a2) {
    wi(this);
    return (a2 = zi(this.Ca, a2.split("."))) ? sc(a2.node) : void 0;
  };
  ti.prototype.getProperty = ti.prototype.kh;
  ti.prototype.removeProperty = function(a2) {
    wi(this);
    (a2 = zi(this.Ca, a2.split("."))) && a2.parent && a2.parent.hasOwnProperty(a2.fg) && (delete a2.parent[a2.fg], Ai(this) && yi(this));
  };
  ti.prototype.removeProperty = ti.prototype.removeProperty;
  ti.prototype.xe = function(a2, b2, c2) {
    var d;
    wi(this);
    var e = this.Ca;
    var f2 = e.layers;
    var g = xi(this, a2, this.xe, false);
    a2 = g.length;
    for (d = {}; a2--; )
      ii(d, f2, g[a2].id, !!b2, !!c2);
    c2 = {};
    g = Object.keys(e);
    for (a2 = g.length; a2--; ) {
      var h = g[a2];
      var k = e[h];
      c2[h] = k === f2 ? d : sc(k);
    }
    b2 || yi(this);
    return c2;
  };
  ti.prototype.extractConfig = ti.prototype.xe;
  ti.prototype.Oe = function(a2) {
    wi(this);
    if (!Ea(a2))
      throw new D(this.Oe, 0, "config");
    this.vd($h(this.Ca, a2));
  };
  ti.prototype.mergeConfig = ti.prototype.Oe;
  ti.prototype.a = ba(2);
  ti.prototype.toString = function() {
    return this.getState() === Xh.READY ? x.H.gl.yaml.safeDump(this.Ca, { lineWidth: 120 }) : "";
  };
  ti.prototype.o = function() {
    ti.j.o.call(this);
    delete this.c;
    delete this.b;
  };
  function Ai(a2) {
    var b2 = a2.Ca, c2;
    if (Ea(b2)) {
      var d;
      if (d = a2.f) {
        b2 = b2 && b2.sources;
        d = false;
        for (var e in b2)
          if (b2[e].type === a2.f) {
            d = true;
            break;
          }
        d = !(b2 ? d : 1);
      }
      d && (c2 = "invalid source, the only valid type is " + a2.f);
    } else
      c2 = "invalid style configuration";
    c2 && a2.Gb(c2);
    return !c2;
  }
  function yi(a2) {
    a2.dispatchEvent(new ud("change", a2));
  }
  function wi(a2) {
    if (a2.getState() !== Xh.READY)
      throw new $c(a2.Oe, "style is not ready yet");
  }
  function xi(a2, b2, c2, d) {
    var e = [], f2 = Bc(b2) ? b2 : [b2], g, h;
    void 0 === d && (d = true);
    for (f2 = f2.sort().reverse(); g = f2.pop(); ) {
      b2 = String(g).split(".");
      a: {
        var k = a2.Ca;
        for (var l = b2.length; l-- && !fi[b2[l]]; )
          ;
        if (k && 0 > l && (k = di(k.layers, b2), ai(k)))
          break a;
        k = bi;
      }
      if (k === bi)
        throw new D(c2, 0, 'Unresolvable layer ID "' + g + '"');
      e.push({ id: b2, eb: k });
      if (d)
        for (h in k)
          !fi[h] && ai(k[h]) && f2.push(g + "." + h);
    }
    return e;
  }
  function zi(a2, b2) {
    var c2 = 0, d;
    for (d = b2.length; c2 !== d; ) {
      var e = b2[c2++];
      var f2 = a2;
      a2 = f2[e];
      if (!a2)
        break;
    }
    return c2 === d ? { node: a2, parent: f2, fg: e } : void 0;
  }
  var ui = /^(http[s]?)?.*\.ya?ml/i;
  function vi(a2, b2, c2, d) {
    c2 = void 0 === c2 ? false : c2;
    d = void 0 === d ? {} : d;
    try {
      var e = x.H.gl.yaml.safeLoad(a2, { json: true });
    } catch (f2) {
      return Promise.reject(f2);
    }
    return e && (a2 = e["import"], Cc(a2) && (a2 = [a2]), c2 && b2 && Bi(e, b2), delete e["import"], Bc(a2) && a2.length) ? (c2 = a2.reduce(function(f2, g) {
      var h = b2 ? Uh(g, b2) : g;
      d[h] || (d[h] = true, f2.push(new tf("text/plain", h).then(function(k) {
        return vi(k, h, true, d);
      })));
      return f2;
    }, []), Promise.all(c2).then(function(f2) {
      var g = {};
      f2.forEach(function(h) {
        return h && $h(g, h);
      });
      $h(g, e);
      return g;
    })) : Promise.resolve(e);
  }
  function Bi(a2, b2) {
    function c2(g) {
      g.url && (g.url = Uh(g.url, b2));
    }
    var d = a2 && a2.fonts;
    if (d)
      for (var e in d)
        Bc(d[e]) ? d[e].forEach(c2) : c2(d[e]);
    if (a2 = a2 && a2.textures)
      for (var f2 in a2)
        c2(a2[f2]);
  }
  ti.normalize = Bi;
  ti.prototype.vd = function(a2) {
    ti.j.vd.call(this, a2);
    Ai(this) && (this.O(Xh.READY), yi(this));
  };
  ti.prototype.qc = function() {
    return ti.j.qc.call(this);
  };
  ti.prototype.getConfig = ti.prototype.qc;
  ti.prototype.Ib = function() {
    return this.g || ti.j.Ib.call(this);
  };
  ti.prototype.getBaseUrl = ti.prototype.Ib;
  t("H.map.Style", ti);
  ti.State = Xh;
  function O(a2, b2) {
    var c2;
    O.j.constructor.call(this);
    C(a2, L, O, 0);
    if (b2 !== B && Bc(b2, O, 1)) {
      for (c2 = 0; c2 < b2.length; c2++)
        C(b2[c2], L, O, 1, "index " + c2);
      this.a = b2;
    } else
      this.a = [];
    this.b = a2;
    this.c = [];
  }
  u(O, jg);
  t("H.geo.Polygon", O);
  function Ci(a2) {
    var b2 = O, c2 = L, d = a2.c, e = a2.a, f2 = a2.f, g = a2.b;
    e = [d, e, B, d, g, B, f2, g, B, f2, e, B];
    180 <= a2.Ab() && (e.splice(9, 0, f2, a2 = a2.bb().lng, B), e.splice(3, 0, d, a2, B));
    return new b2(new c2(e));
  }
  O.fromRect = Ci;
  var Di = { NORTH: 90, SOUTH: -90 };
  O.Direction = Di;
  O.prototype.pd = Di.NORTH;
  O.prototype.Sk = function(a2) {
    this.pd !== a2 && (this.f = z, this.c.length = 0, this.pd = a2);
    return this;
  };
  O.prototype.setPoleCovering = O.prototype.Sk;
  O.prototype.Km = function() {
    return this.pd;
  };
  O.prototype.getPoleCovering = O.prototype.Km;
  O.prototype.fm = function() {
    return this.b;
  };
  O.prototype.getExterior = O.prototype.fm;
  O.prototype.Pk = function(a2) {
    if (!C(a2, L))
      throw new D(this.Pk, 0, a2);
    this.b = a2;
    this.f = z;
  };
  O.prototype.setExterior = O.prototype.Pk;
  O.prototype.rm = function() {
    return this.a;
  };
  O.prototype.getInteriors = O.prototype.rm;
  O.prototype.xg = function(a2, b2, c2) {
    var d = arguments.length, e;
    for (e = 2; e < d; e++)
      C(arguments[e], L, this.xg, e);
    var f2 = this.a.splice.apply(this.a, arguments);
    for (e = 2; e < d; e++)
      arguments[e] = B;
    this.c.splice.apply(this.c, arguments);
    return f2;
  };
  O.prototype.spliceInteriors = O.prototype.xg;
  O.prototype.no = function(a2) {
    return this.xg(a2, 1)[0];
  };
  O.prototype.removeInteriorAt = O.prototype.no;
  O.prototype.mo = function(a2) {
    a2 = this.a.indexOf(a2);
    return 0 > a2 ? B : this.xg(a2, 1)[0];
  };
  O.prototype.removeInterior = O.prototype.mo;
  O.prototype.Bk = function(a2) {
    if (!C(a2, L))
      throw new D(this.Bk, 0, a2);
    this.a.push(a2);
  };
  O.prototype.pushInterior = O.prototype.Bk;
  O.prototype.K = function() {
    var a2 = this.f;
    a2 || (this.f = a2 = Ei(this.b, this.pd));
    return a2;
  };
  O.prototype.getBoundingBox = O.prototype.K;
  p = O.prototype;
  p.tj = function(a2) {
    var b2 = this.a.length;
    if (0 > a2 || a2 >= b2)
      throw new ne(this.tj, a2, [0, b2 - 1]);
    (b2 = this.c[a2]) || (this.c[a2] = b2 = Ei(this.a[a2], this.pd));
    return b2;
  };
  function Ei(a2, b2) {
    var c2, d, e;
    if (e = a2.K())
      (c2 = a2.eh(true)) && (d = a2.Ie()) && (e = e.ec(tg([a2.ye(0), a2.ye(d - 1)], true), true)), 360 === e.Ab() && 1 === c2 % 2 && (e = e.Xc(b2, 0));
    return e;
  }
  p.rb = "Polygon";
  p.cd = function(a2) {
    var b2 = this.a, c2 = b2.length, d;
    if (this.b.Ie()) {
      a2.push("(");
      this.b.cd(a2, true);
      for (d = 0; d < c2; d++)
        b2[d].Ie() && (a2.push(","), b2[d].cd(a2, true));
      a2.push(")");
    } else
      a2.push("EMPTY");
    return a2;
  };
  p.Hb = "Polygon";
  p.bd = function() {
    var a2, b2 = [], c2 = this.a, d = this.b.bd();
    d[0].toString() !== d[d.length - 1].toString() && d.push(d[0]);
    b2.push(d);
    for (a2 = 0; a2 < c2.length; a2++)
      d = c2[a2].bd(), d[0].toString() !== d[d.length - 1].toString() && d.push(d[0]), b2.push(d);
    return b2;
  };
  p.Y = function() {
    var a2 = O.j.Y.call(this);
    this.K().Bb() && (a2.type = "Multi" + a2.type);
    return a2;
  };
  p.pc = function() {
    var a2 = [], b2 = this.a, c2 = b2.length;
    for (a2.push(this.b.pc()); c2--; )
      a2[c2 + 1] = b2[c2].pc();
    return this.K().Bb() ? [a2] : a2;
  };
  p.ia = function(a2) {
    var b2 = false;
    if (C(a2, O)) {
      var c2 = a2.a, d = this.a.length;
      b2 = c2.length;
      var e = 0;
      for (b2 = this.b.ia(a2.b) && d === b2; b2 && e < d; )
        b2 = b2 && this.a[e].ia(c2[e]), e++;
    }
    return b2;
  };
  O.prototype.equals = O.prototype.ia;
  function Fi(a2, b2, c2, d) {
    d = void 0 === d ? true : d;
    var e = a2.a, f2 = Gi.bind(null, b2, c2);
    return ee(b2, c2, a2.b.$, 0, true, 3) !== de.NONE ? d ? !e.some(f2) : true : false;
  }
  function Gi(a2, b2, c2) {
    return ee(a2, b2, c2.$, 0, true, 3) === de.SURFACE;
  }
  function Hi(a2, b2) {
    b2 = b2.$;
    a2 = a2.b.$;
    var c2, d, e = b2.length - 3, f2 = a2.length - 3, g = {};
    for (c2 = 0; c2 < e; c2 += 3) {
      var h = b2[c2];
      var k = b2[c2 + 1];
      var l = b2[c2 + 3];
      var m = b2[c2 + 4];
      for (d = 0; d < f2; d += 3) {
        var n = a2[d];
        var q = a2[d + 1];
        var r = a2[d + 3];
        var v = a2[d + 4];
        if (ag(new Yf(k, h), new Yf(m, l), new Yf(q, n), new Yf(v, r), g, true))
          return true;
      }
    }
    return false;
  }
  function Ii(a2, b2) {
    var c2 = b2.b, d = b2.a, e = d.length, f2 = c2.$, g = f2.length, h = a2.b.$, k = h.length;
    if (Hi(a2, c2))
      return true;
    for (c2 = 0; c2 < g; c2 += 3)
      if (Fi(a2, f2[c2], f2[c2 + 1]))
        return true;
    for (c2 = 0; c2 < k; c2 += 3)
      if (Fi(b2, h[c2], h[c2 + 1]))
        return true;
    for (c2 = 0; c2 < e; c2++)
      if (Hi(a2, d[c2]))
        return true;
    return false;
  }
  ;
  function Ji(a2) {
    Ji.j.constructor.call(this, a2);
  }
  u(Ji, gh);
  t("H.geo.MultiPolygon", Ji);
  Ji.prototype.b = function(a2) {
    return C(a2, O);
  };
  Ji.prototype.rb = "Multi" + O.prototype.rb;
  Ji.prototype.Hb = "Multi" + O.prototype.Hb;
  function uh(a2, b2) {
    var c2 = b2 && (+b2.extrusion || +b2.extrude) || 0, d = b2 && +b2.elevation || 0, e = 0;
    uh.j.constructor.call(this, true, b2);
    0 < d && (e += d, this.b = d);
    0 < c2 && (e += c2, this.f = c2);
    if (2047 < e)
      throw new ne(uh, e, [0, 2047]);
    C(a2, L) ? this.da(new O(a2)) : this.da(a2);
  }
  u(uh, Kh);
  t("H.map.Polygon", uh);
  var Ki = new O(new L([0, 0, 0, 0, 0, 0, 0, 0, 0]));
  uh.prototype.f = 0;
  uh.prototype.b = 0;
  uh.prototype.a = Ki;
  uh.MAX_EXTRUDE_HEIGHT = 2047;
  uh.prototype.pi = function(a2) {
    var b2 = +a2;
    if (b2 !== a2)
      throw new D(this.pi, 0, a2);
    if (0 > b2 || 2047 < this.b + b2)
      throw new ne(this.pi, this.b + b2, [0, 2047]);
    this.f = b2;
    this.ra(kh.SPATIAL);
  };
  uh.prototype.setExtrusion = uh.prototype.pi;
  uh.prototype.gm = function() {
    return this.f;
  };
  uh.prototype.getExtrusion = uh.prototype.gm;
  uh.prototype.oi = function(a2) {
    var b2 = +a2;
    if (b2 !== a2)
      throw new D(this.oi, 0, a2);
    if (0 > b2 || 2047 < this.f + b2)
      throw new ne(this.oi, this.f + b2, [0, 2047]);
    this.b = b2;
    this.ra(kh.SPATIAL);
  };
  uh.prototype.setElevation = uh.prototype.oi;
  uh.prototype.bm = function() {
    return this.b;
  };
  uh.prototype.getElevation = uh.prototype.bm;
  uh.prototype.ga = function() {
    return this.a;
  };
  uh.prototype.getGeometry = uh.prototype.ga;
  uh.prototype.da = function(a2) {
    if (C(a2, O))
      var b2 = false;
    else
      C(a2, Ji, this.da, 0), b2 = true;
    this.J = b2;
    b2 = this.a;
    this.a = a2;
    b2 !== Ki && this.ra(kh.SPATIAL);
    return this;
  };
  uh.prototype.setGeometry = uh.prototype.da;
  uh.prototype.K = function() {
    return this.ga().K();
  };
  uh.prototype.getBoundingBox = uh.prototype.K;
  uh.prototype.Kd = function(a2) {
    var b2, c2 = this.ga(), d, e;
    if (this.J) {
      c2 = c2.la;
      var f2 = 0;
      for (e = c2.length; f2 < e; f2++)
        if (d = Li(this, c2[f2], a2, c2[f2].pd))
          b2 || (b2 = []), b2.push(d);
    } else
      d = this.ab, d === B && (d = this.J ? Di.NORTH : this.ga().pd), (d = Li(this, c2, a2, d)) && (b2 = [d]);
    return b2;
  };
  uh.prototype.getGeometriesForTile = uh.prototype.Kd;
  function Li(a2, b2, c2, d) {
    var e, f2, g = 0, h = true;
    if (e = Mi(a2, b2.b, c2, d, b2.K())) {
      var k = new Ph(e);
      var l = b2.a;
      if (f2 = l.length) {
        for (k.b = k.a.length; g < f2; g++)
          if (e = Mi(a2, l[g], c2, d, b2.tj(g)))
            k.a = k.a.concat(e);
      }
      f2 = k.a.length;
      for (g = 0; g < f2; g++)
        if (k.a[g] !== Qh) {
          h = false;
          break;
        }
      h && (k = g % 2 ? Jh : B);
    }
    return k;
  }
  function Mi(a2, b2, c2, d, e) {
    var f2 = c2.Le(), g = e, h = g.Ab();
    var k = [[]];
    var l = b2.$;
    var m = [], n = l.length, q, r = false;
    for (q = 0; q < n; q += 3) {
      var v = l[q];
      var w = l[q + 1];
      r || 180 != Dd(w) || (m.push(v), m.push(w), m.push(v), m.push(-w), r = true);
      m.push(v);
      m.push(w);
    }
    l = m;
    360 > h && -180 == g.a && (g = new K(g.c, 180, g.f, g.b));
    360 > h && 180 == g.b && (g = new K(g.c, g.a, g.f, -180));
    if (g.Bb()) {
      h = l;
      v = h.length;
      l = -1;
      for (m = 0; m < v - 2; m += 2)
        if (ig(h[m + 1], h[m + 3])) {
          l = m + 2;
          break;
        }
      -1 === l && ig(h[v - 1], h[1]) && (l = v);
      -1 !== l && (n = h[l - 2], m = h[l - 1], q = h[l % v], r = h[(l + 1) % v], 180 !== Dd(n) && 180 !== Dd(q) && (w = Dd(q - n), v = Dd(r - m), v += 180 < v ? -360 : 0, r = Dd(180 - r), r += 180 < r ? -360 : 0, v && r && (w /= Dd(v) / Dd(r), n = q + (q > n ? -w : w), m = 0 < m ? 180 : -180, h.splice(l, 0, n, m, n, -m))));
      l = h;
    }
    k[0] = Ni(l.concat(), g.a);
    360 > g.Ab() && g.gd(new kg(g.c, 180)) && (l = Ni(l.concat(), g.b), k.push(l));
    g = c2.Jf();
    a2 = Lh(a2, k, true, g);
    if (360 === e.Ab() && 1 === b2.eh(true) % 2) {
      b2 = a2;
      a2 = c2.Le();
      b2[0][1].x > b2[0][b2[0].length - 1].x && (b2[0] = b2[0].reverse());
      l = [];
      h = b2[0].length - 1;
      for (k = 0; k < h; k++)
        m = b2[0][k], l[k] = new J(m.x - 2 * g.w, m.y), l[k + h] = new J(m.x - g.w, m.y), l[k + 2 * h] = new J(m.x, m.y), l[k + 3 * h] = new J(m.x + g.w, m.y), l[k + 4 * h] = new J(m.x + 2 * g.w, m.y);
      b2[0] = l;
      k = g.Ah(d, 0);
      k.y = 2 * a2[d === Di.NORTH ? "top" : "bottom"];
      d = k.clone();
      k.x = b2[0][b2[0].length - 1].x + 1;
      d.x = b2[0][0].x - 1;
      b2[0].push(k, d);
      a2 = b2;
    }
    d = f2.left;
    b2 = f2.top;
    k = f2.right;
    f2 = f2.bottom;
    if (Uf(a2, d, b2, k, f2, true).length) {
      if (!c2.Hf().Qg(e)) {
        c2 = a2;
        e = [new J(d, b2), new J(k, b2), new J(k, f2), new J(d, f2)];
        f2 = [];
        for (a2 = c2.length; a2--; )
          if (d = Wf(e, c2[a2]))
            for (b2 = Oi(d), f2.push(b2); d.Uh; )
              d = d.Uh, b2 = Oi(d), f2.push(b2);
        a2 = f2;
      }
    } else
      c2 = Pi(d, b2, a2[0]), a2[1] && (c2 = c2 !== Pi(d, b2, a2[1])), a2 = c2 ? [Qh] : B;
    return a2;
  }
  function Pi(a2, b2, c2) {
    var d, e, f2;
    var g = d = c2[0].x;
    var h = e = c2[0].y;
    var k = 1;
    for (f2 = c2.length; k < f2; k++) {
      var l = c2[k].x;
      var m = c2[k].y;
      l > d ? d = l : l < g && (g = l);
      m > e ? e = m : m < h && (h = m);
    }
    return g <= a2 && a2 <= d && h <= b2 && b2 <= e && fe({ x: a2, y: b2 }, ge(c2.concat(c2[0])));
  }
  function Oi(a2) {
    var b2 = [], c2 = a2;
    do {
      var d = Ad(100 * (c2.eo ? c2.eo : c2.x)) / 100;
      var e = Ad(100 * (c2.fo ? c2.fo : c2.y)) / 100;
      if (!f2 || 0.01 < Fd(Gd(f2.x - d, 2) + Gd(f2.y - e, 2))) {
        var f2 = new J(d, e);
        b2.push(f2);
      }
      c2 = c2.next;
    } while (c2 && c2 !== a2);
    return b2;
  }
  uh.prototype.aa = z;
  function Ni(a2, b2) {
    var c2, d = Number.POSITIVE_INFINITY, e = -1, f2 = a2.length;
    for (c2 = 0; c2 < f2; c2 += 2) {
      var g = Dd(a2[c2 + 1] - b2);
      g += 180 < g ? 360 - g : g;
      g < d && (d = g, e = c2);
    }
    return 0 < c2 ? (b2 = a2.splice(e, a2.length - e), b2.concat(a2)) : a2;
  }
  uh.prototype.Y = function() {
    var a2 = uh.j.Y.call(this), b2 = this.ga(), c2 = this.J ? b2.la : [b2], d, e = a2.properties;
    var f2 = a2.geometry = b2.Y();
    e.style = this.V().Y();
    e.height = this.f + this.b;
    e.min_height = this.b;
    if (this.K().Bb() && (f2.type = "MultiPolygon", this.J)) {
      var g = [];
      c2.forEach(function(h, k) {
        d = f2.coordinates[k];
        h.K().Bb() ? g = g.concat(d) : g.push(d);
      });
      f2.coordinates = g;
    }
    return a2;
  };
  uh.prototype.forWorkerMessage = uh.prototype.Y;
  function Qi(a2, b2, c2) {
    Qi.j.constructor.call(this, Ki, c2);
    this.tg(a2);
    this.zi(b2);
    c2 && "precision" in c2 && this.yi(c2.precision);
  }
  u(Qi, uh);
  t("H.map.Circle", Qi);
  Qi.prototype.tg = function(a2) {
    (a2 = ng(a2)).ia(this.R) || (this.R = a2, Ri(this));
  };
  Qi.prototype.setCenter = Qi.prototype.tg;
  Qi.prototype.bb = function() {
    return this.R;
  };
  Qi.prototype.getCenter = Qi.prototype.bb;
  Qi.prototype.zi = function(a2) {
    if (E(a2 = ae(a2, 0, 637100079e-2 * Pd / 2)))
      throw new D(this.zi, 0, a2);
    this.wa !== a2 && (this.wa = a2, Ri(this));
  };
  Qi.prototype.setRadius = Qi.prototype.zi;
  Qi.prototype.Qm = function() {
    return this.wa;
  };
  Qi.prototype.getRadius = Qi.prototype.Qm;
  Qi.prototype.D = 60;
  Qi.prototype.yi = function(a2) {
    if (!Fc(a2))
      throw new D(this.yi, 0, a2);
    this.D !== (a2 = ae(Ad(a2), 4, 360)) && (this.D = a2, Ri(this));
  };
  Qi.prototype.setPrecision = Qi.prototype.yi;
  Qi.prototype.Nm = function() {
    return this.D;
  };
  Qi.prototype.getPrecision = Qi.prototype.Nm;
  Qi.prototype.da = function() {
    return this;
  };
  Qi.prototype.setGeometry = Qi.prototype.da;
  Qi.prototype.ga = function() {
    this.a === Ki && Qi.j.da.call(this, Si(this));
    return this.a;
  };
  Qi.prototype.getGeometry = Qi.prototype.ga;
  function Ri(a2) {
    a2.a !== z && Qi.j.da.call(a2, Si(a2));
  }
  function Si(a2) {
    var b2 = a2.R, c2 = b2.lat, d = a2.wa, e = 0, f2 = new L();
    if (90 === Dd(c2))
      for (c2 = b2.zg(0, d, true).lat; 360 > e; e += 120)
        f2.gi(c2, e - 180, B);
    else
      for (a2 = a2.D, a2 = 360 / a2; 360 > e; e += a2)
        f2.qd(b2.zg(e, d, true));
    b2 = new O(f2);
    0 > c2 && b2.Sk(Di.SOUTH);
    return b2;
  }
  ;
  function Ti(a2, b2) {
    if (!C(a2, Element)) {
      Ui.innerHTML = a2;
      a2 = Ui.firstElementChild;
      if (!a2)
        throw new D(Ti, 0, "No element data");
      Ui.removeChild(a2);
      var c2 = true;
      Ui.innerHTML = "";
    }
    this.a = 0 !== kf(a2).length;
    this.f = c2 ? a2 : lf(a2, x.document, this.a);
    b2 && (c2 = "onAttach", c2 in b2 && zc(a2 = b2[c2], "Function", Ti, 1, c2) && (this.Vh = a2), c2 = "onDetach", c2 in b2 && zc(a2 = b2[c2], "Function", Ti, 1, c2) && (this.b = a2));
  }
  t("H.map.DomIcon", Ti);
  var Ui = document.createElement("DIV");
  Ti.prototype.Vh = null;
  Ti.prototype.b = null;
  Ti.prototype.uj = function(a2) {
    return lf(this.f, a2, this.a);
  };
  Ti.prototype.a = false;
  function Vi(a2) {
    Vi.j.constructor.call(this, a2);
  }
  u(Vi, gh);
  t("H.geo.MultiPoint", Vi);
  Vi.prototype.b = function(a2) {
    return lg(a2);
  };
  Vi.prototype.c = function(a2) {
    return C(a2, kg) ? a2 : ng(a2);
  };
  Vi.prototype.rb = "Multi" + kg.prototype.rb;
  Vi.prototype.Hb = "Multi" + kg.prototype.Hb;
  function Wi(a2, b2) {
    this.w = +a2;
    this.h = +b2;
  }
  t("H.math.Size", Wi);
  function Xi(a2, b2) {
    var c2;
    var d = a2;
    var e = b2 || [];
    if (a2 !== Yi.NONE) {
      b2 = c2 = e.length;
      if (-1 === Zi.indexOf(d))
        throw new D(Xi, 0, a2);
      if (!e)
        throw new D(Xi, 1, e);
      for (; c2--; )
        if (E(e[c2]))
          throw new D(Xi, 1, e);
      d === Yi.RECT && 3 < b2 && (e = [e[0], e[1], e[2], e[1], e[2], e[3], e[0], e[3]], d = Yi.POLYGON);
      if (d === Yi.CIRCLE && 2 < b2 && (a2 = e[2], 0 < a2)) {
        d = e[0];
        var f2 = e[1];
        c2 = yd(2 * Cd(a2), 40);
        var g = 360 / c2;
        for (e = []; c2--; ) {
          var h = g * c2 * Ud;
          e.push(d + Id(h) * a2, f2 + Kd(h) * a2);
        }
        d = Yi.POLYGON;
      }
      if (d !== Yi.POLYGON || !b2 || e.length % 2)
        throw new D(Xi, 1, e);
      this.a = e;
    }
  }
  t("H.map.HitArea", Xi);
  var Yi = { NONE: 0, RECT: 1, CIRCLE: 2, POLYGON: 3 };
  Xi.ShapeType = Yi;
  var Zi = [Yi.RECT, Yi.CIRCLE, Yi.POLYGON];
  Xi.prototype.Of = function(a2, b2, c2) {
    return this.a ? ee(a2, b2, this.a, c2, true) : de.NONE;
  };
  Xi.prototype.hitTest = Xi.prototype.Of;
  function rh(a2, b2) {
    var c2;
    xc(this, rh);
    rh.j.constructor.call(this, b2);
    this.da(a2);
    b2 && "icon" in b2 && (c2 = b2.icon);
    this.Ic(c2 || $i(this));
  }
  u(rh, M);
  t("H.map.AbstractMarker", rh);
  rh.prototype.ga = function() {
    return this.a;
  };
  rh.prototype.getGeometry = rh.prototype.ga;
  rh.prototype.da = function(a2) {
    var b2 = this.a;
    C(a2, kg) || C(a2, Vi) ? this.a = a2 : (lg(a2, this.da, 0), this.a = ng(a2));
    b2 && this.ra(kh.SPATIAL);
    return this;
  };
  rh.prototype.setGeometry = rh.prototype.da;
  rh.prototype.K = function() {
    return this.a.K();
  };
  rh.prototype.xb = function() {
    return this.icon;
  };
  rh.prototype.getIcon = rh.prototype.xb;
  rh.prototype.Ic = function(a2) {
    var b2 = this.icon, c2 = !b2;
    if (b2 !== a2) {
      if (!this.Uj(a2)) {
        if (c2)
          throw new D(this.constructor, 1, a2);
        throw new D(this.Ic, 0, a2);
      }
      this.icon = a2;
      c2 || this.ra(kh.VISUAL);
    }
    return this;
  };
  rh.prototype.setIcon = rh.prototype.Ic;
  function $i(a2) {
    var b2 = a2.c;
    b2 || (b2 = a2.constructor.prototype.c = a2.b(aj));
    return b2;
  }
  var aj = { svg: '<svg xmlns="http://www.w3.org/2000/svg" width="38" height="47" viewBox="0 0 38 47"><g fill="none"><path fill="#0F1621" fill-opacity=".4" d="M15 46c0 .317 1.79.574 4 .574s4-.257 4-.574c0-.317-1.79-.574-4-.574s-4 .257-4 .574z"></path><path fill="#01b6b2" d="M33.25 31.652A19.015 19.015 0 0 0 38 19.06C38 8.549 29.478 0 19 0S0 8.55 0 19.059c0 4.823 1.795 9.233 4.75 12.593L18.975 46 33.25 31.652z"></path><path fill="#6A6D74" fill-opacity=".5" d="M26.862 37.5l4.714-4.77c3.822-3.576 5.924-8.411 5.924-13.62C37.5 8.847 29.2.5 19 .5S.5 8.848.5 19.11c0 5.209 2.102 10.044 5.919 13.614l4.719 4.776h15.724zM19 0c10.493 0 19 8.525 19 19.041 0 5.507-2.348 10.454-6.079 13.932L19 46 6.079 32.973C2.348 29.495 0 24.548 0 19.04 0 8.525 8.507 0 19 0z"></path></g></svg>', size: new Wi(
    38,
    47
  ), anchor: new J(19, 45), hitArea: new Xi(Yi.POLYGON, [19, 46, 2, 27, 0, 18, 5, 6, 19, 0, 32, 5, 38, 15, 36, 27, 19, 47]) };
  rh.prototype.Y = function() {
    var a2 = rh.j.Y.call(this), b2 = this.xb(), c2 = b2.yb(), d = b2.kd();
    a2.geometry = this.ga().Y();
    c2 && (b2 = a2.properties.icon = { id: b2.uid }, b2.size = { w: c2.w, h: c2.h }, b2.offset = [c2.w / 2 - (d ? d.x : 0), c2.h / 2 - (d ? d.y : 0)]);
    return a2;
  };
  rh.prototype.forWorkerMessage = rh.prototype.Y;
  function bj(a2, b2) {
    bj.j.constructor.call(this, a2, b2);
  }
  u(bj, rh);
  t("H.map.DomMarker", bj);
  bj.prototype.type = nh.DOM_MARKER;
  bj.prototype.T = 2;
  bj.prototype.b = function(a2) {
    var b2 = new Ti(a2.svg, a2);
    a2 = a2.anchor;
    b2.f.style.margin = -a2.y + "px 0 0 -" + a2.x + "px";
    return b2;
  };
  bj.prototype.Uj = function(a2) {
    return C(a2, Ti);
  };
  function cj(a2, b2, c2) {
    cj.j.constructor.call(this, a2);
    this.oldValue = c2;
    this.newValue = b2;
  }
  u(cj, ud);
  t("H.util.ChangeEvent", cj);
  function dj(a2, b2, c2, d) {
    dj.j.constructor.call(this, a2, b2, c2);
    this.modifiers = d;
  }
  u(dj, cj);
  t("H.map.ChangeEvent", dj);
  var ej = { SIZE: 1, POSITION: 2, HEADING: 4, TILT: 8, INCLINE: 16, ZOOM: 32, BOUNDS: 64 };
  dj.Type = ej;
  dj.prototype.ll = ej.SIZE;
  dj.prototype.SIZE = dj.prototype.ll;
  dj.prototype.Ui = ej.POSITION;
  dj.prototype.POSITION = dj.prototype.Ui;
  dj.prototype.Oi = ej.HEADING;
  dj.prototype.HEADING = dj.prototype.Oi;
  dj.prototype.Wi = ej.TILT;
  dj.prototype.TILT = dj.prototype.Wi;
  dj.prototype.Pi = ej.INCLINE;
  dj.prototype.INCLINE = dj.prototype.Pi;
  dj.prototype.Xi = ej.ZOOM;
  dj.prototype.ZOOM = dj.prototype.Xi;
  dj.prototype.Mi = ej.BOUNDS;
  dj.prototype.BOUNDS = dj.prototype.Mi;
  function fj() {
    this.a = [];
    fj.j.constructor.call(this);
  }
  u(fj, F);
  t("H.util.OList", fj);
  function gj(a2, b2, c2) {
    a2 = a2.a.length;
    if (c2)
      var d = a2;
    else if (E(d = 0 > (d = +b2) ? zd(0, a2 + d) : yd(a2, d)))
      throw new ne(fj, b2, [0, a2 - 1]);
    return d;
  }
  fj.prototype.add = function(a2, b2) {
    b2 = gj(this, b2, E(b2));
    this.a.splice(b2, 0, a2);
    this.dispatchEvent(new hj(this, this.A.he, b2, a2, null, null));
  };
  fj.prototype.add = fj.prototype.add;
  function ij(a2, b2) {
    var c2 = a2.a.splice(b2, 1)[0];
    a2.dispatchEvent(new hj(a2, a2.A.je, b2, null, c2, null));
    return c2;
  }
  fj.prototype.hc = function(a2) {
    this.get(a2);
    return ij(this, a2);
  };
  fj.prototype.removeAt = fj.prototype.hc;
  fj.prototype.remove = function(a2) {
    a2 = this.indexOf(a2);
    return 0 <= a2 ? (ij(this, a2), true) : false;
  };
  fj.prototype.remove = fj.prototype.remove;
  fj.prototype.set = function(a2, b2) {
    if (0 !== this.a.length || 0 !== a2) {
      this.get(a2);
      a2 = gj(this, a2, false);
      var c2 = this.a[a2];
    }
    this.a[a2] = b2;
    this.dispatchEvent(new hj(this, this.A.ke, a2, b2, c2, null));
    return c2;
  };
  fj.prototype.set = fj.prototype.set;
  fj.prototype.indexOf = function(a2) {
    return this.a.indexOf(a2);
  };
  fj.prototype.indexOf = fj.prototype.indexOf;
  fj.prototype.get = function(a2) {
    var b2 = gj(this, a2, false), c2 = this.a;
    if (b2 >= c2.length)
      throw new ne(this.get, a2, [0, c2.length - 1]);
    return c2[b2];
  };
  fj.prototype.get = fj.prototype.get;
  fj.prototype.ym = function() {
    return this.a.length;
  };
  fj.prototype.getLength = fj.prototype.ym;
  fj.prototype.La = function() {
    return this.a.concat();
  };
  fj.prototype.asArray = fj.prototype.La;
  fj.prototype.flush = function() {
    for (var a2 = this.a.length; a2--; )
      ij(this, a2);
  };
  fj.prototype.flush = fj.prototype.flush;
  fj.prototype.o = function() {
    this.flush();
    fj.j.o.call(this);
  };
  fj.prototype.A = { he: "add", je: "remove", ke: "set", Xo: "move" };
  function hj(a2, b2, c2, d, e, f2) {
    hj.j.constructor.call(this, b2, a2);
    this.idx = c2;
    this.added = d;
    this.removed = e;
    this.moved = f2;
  }
  u(hj, ud);
  fj.Event = hj;
  function jj() {
  }
  function kj(a2) {
    return yd(1, zd(0, 0.5 - Ed(Ld(Rd + Qd * a2 / 180)) / Pd / 2));
  }
  jj.prototype.Tf = function(a2, b2, c2) {
    c2 ? (c2.x = b2 / 360 + 0.5, c2.y = kj(a2)) : c2 = new J(b2 / 360 + 0.5, kj(a2));
    return c2;
  };
  jj.prototype.latLngToPoint = jj.prototype.Tf;
  jj.prototype.Pc = function(a2, b2) {
    return this.Tf(a2.lat, a2.lng, b2);
  };
  jj.prototype.geoToPoint = jj.prototype.Pc;
  function lj(a2) {
    return 0 >= a2 ? 90 : 1 <= a2 ? -90 : Vd * (2 * Md(Hd(Pd * (1 - 2 * a2))) - Qd);
  }
  jj.prototype.Ra = function(a2, b2, c2) {
    c2 ? (c2.lat = lj(b2), c2.lng = 360 * (1 === a2 ? 1 : Zd(a2, 1)) - 180) : c2 = new kg(lj(b2), 360 * (1 === a2 ? 1 : Zd(a2, 1)) - 180);
    return c2;
  };
  jj.prototype.xyToGeo = jj.prototype.Ra;
  jj.prototype.dg = function(a2, b2) {
    return this.Ra(a2.x, a2.y, b2);
  };
  jj.prototype.pointToGeo = jj.prototype.dg;
  var mj = new jj();
  t("H.geo.mercator", mj);
  t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL", 0);
  t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL", 22);
  function nj(a2, b2) {
    this.projection = a2 || mj;
    this.b = 0;
    this.a = this.exp = Ed(b2 || 256) / Od;
    oj(this);
    this.y = this.x = 0;
  }
  t("H.geo.PixelProjection", nj);
  var pj = Dd(24) + Dd(-8);
  nj.prototype.eg = mj;
  nj.prototype.projection = nj.prototype.eg;
  nj.prototype.x = 0;
  nj.prototype.x = nj.prototype.x;
  nj.prototype.y = 0;
  nj.prototype.y = nj.prototype.y;
  nj.prototype.Oo = Gd(2, pj);
  nj.prototype.w = nj.prototype.Oo;
  nj.prototype.ln = Gd(2, pj);
  nj.prototype.h = nj.prototype.ln;
  nj.prototype.Oa = function(a2) {
    if (E(a2))
      throw new D(this.Oa, 0, a2);
    var b2 = this.x / this.w;
    var c2 = this.y / this.h;
    this.b = a2;
    this.a = this.exp + a2;
    oj(this);
    this.x = b2 * this.w;
    this.y = c2 * this.h;
  };
  nj.prototype.rescale = nj.prototype.Oa;
  function oj(a2) {
    a2.a > pj && (a2.a = pj);
    a2.w = Gd(2, a2.a);
    a2.h = Gd(2, a2.a);
  }
  nj.prototype.Jj = function() {
    return this.b || 0;
  };
  nj.prototype.getZoomScale = nj.prototype.Jj;
  nj.prototype.ib = function(a2, b2) {
    a2 = this.projection.Tf(a2.lat, a2.lng, b2);
    a2.x = a2.x * this.w - this.x;
    a2.y = a2.y * this.h - this.y;
    return a2;
  };
  nj.prototype.geoToPixel = nj.prototype.ib;
  nj.prototype.Re = function(a2, b2) {
    return this.projection.Ra((a2.x + this.x) / this.w, (a2.y + this.y) / this.h, b2);
  };
  nj.prototype.pixelToGeo = nj.prototype.Re;
  nj.prototype.Ra = function(a2, b2, c2) {
    return this.projection.Ra((a2 + this.x) / this.w, (b2 + this.y) / this.h, c2);
  };
  nj.prototype.xyToGeo = nj.prototype.Ra;
  nj.prototype.Ah = function(a2, b2, c2) {
    a2 = this.projection.Tf(a2, b2, c2);
    a2.x = a2.x * this.w - this.x;
    a2.y = a2.y * this.h - this.y;
    return a2;
  };
  nj.prototype.latLngToPixel = nj.prototype.Ah;
  nj.prototype.Zd = function(a2) {
    return new J(a2.x * this.w - this.x, a2.y * this.h - this.y);
  };
  nj.prototype.pointToPixel = nj.prototype.Zd;
  function qj(a2) {
    a2 = a2 || {};
    qj.j.constructor.call(this);
    this.min = 0;
    this.max = 22;
    this.yl = this.dark = !!a2.dark;
    a2.min && this.ui(a2.min);
    a2.max && this.si(a2.max);
    this.pixelProjection = new nj(a2.projection, a2.minWorldSize);
    a2.provider && (this.ma = a2.provider, this.Va = A(this.Va, this), this.ma.addEventListener(P.prototype.A.za, this.Va, false, this), this.hb = A(this.hb, this), this.ma.addEventListener(P.prototype.A.ie, this.hb, false, this));
  }
  u(qj, F);
  t("H.map.layer.Layer", qj);
  qj.prototype.min = 0;
  qj.prototype.min = qj.prototype.min;
  qj.prototype.max = 22;
  qj.prototype.max = qj.prototype.max;
  qj.prototype.A = { za: "update", ie: "configchange", Ti: "minchange", Si: "maxchange" };
  qj.prototype.ca = function() {
    return this.ma;
  };
  qj.prototype.getProvider = qj.prototype.ca;
  qj.prototype.un = function(a2) {
    return this.min <= a2 && a2 <= this.max;
  };
  qj.prototype.isValid = qj.prototype.un;
  function rj(a2, b2, c2) {
    var d = a2[b2], e = "min" === b2, f2 = e ? a2.ui : a2.si;
    if (c2 !== d)
      if (e ? c2 <= a2.max : c2 >= a2.min)
        a2[b2] = c2, a2.Va(), a2.hb(), a2.dispatchEvent(new cj(e ? a2.A.Ti : a2.A.Si, c2, d));
      else
        throw new D(f2, 0, "Invalid condition min <= max");
    return a2;
  }
  qj.prototype.ui = function(a2) {
    return rj(this, "min", +a2);
  };
  qj.prototype.setMin = qj.prototype.ui;
  qj.prototype.si = function(a2) {
    return rj(this, "max", +a2);
  };
  qj.prototype.setMax = qj.prototype.si;
  qj.prototype.Va = function() {
    this.dispatchEvent(this.A.za);
  };
  qj.prototype.hb = function(a2) {
    a2 = new cj(this.A.ie, a2 && a2.newValue, a2 && a2.oldValue);
    this.dispatchEvent(a2);
  };
  qj.prototype.o = function() {
    qj.j.o.call(this);
  };
  qj.prototype.ba = function() {
    return null;
  };
  qj.prototype.getCopyrights = qj.prototype.ba;
  function sj(a2) {
    var b2;
    sj.j.constructor.call(this);
    this.dispatchEvent = A(this.dispatchEvent, this);
    if (a2) {
      var c2 = a2.length;
      for (b2 = 0; b2 < c2; b2++)
        this.add(a2[b2]);
    }
  }
  u(sj, fj);
  t("H.map.DataModel", sj);
  function tj(a2, b2) {
    var c2 = b2.getProvider && b2.getProvider();
    c2 && (uj[c2.uid] = c2);
    b2.ka(a2);
  }
  function vj(a2) {
    var b2 = a2.getProvider && a2.getProvider();
    b2 && delete uj[b2.uid];
    a2.ka(null);
  }
  sj.prototype.add = function(a2, b2) {
    C(a2, qj, this.add, 0);
    tj(this, a2);
    sj.j.add.call(this, a2, b2);
  };
  sj.prototype.add = sj.prototype.add;
  sj.prototype.set = function(a2, b2) {
    C(b2, qj, this.set, 0);
    tj(this, b2);
    (a2 = sj.j.set.call(this, a2, b2)) && vj(a2);
    return a2;
  };
  sj.prototype.set = sj.prototype.set;
  sj.prototype.hc = function(a2) {
    var b2;
    (b2 = sj.j.hc.call(this, a2)) && vj(b2);
    return b2;
  };
  sj.prototype.removeAt = sj.prototype.hc;
  sj.prototype.remove = function(a2) {
    var b2;
    (b2 = sj.j.remove.call(this, a2)) && vj(a2);
    return b2;
  };
  sj.prototype.remove = sj.prototype.remove;
  sj.prototype.flush = function() {
    for (var a2 = this.a.length; a2--; )
      this.hc(a2);
    sj.j.flush.call(this);
  };
  sj.prototype.flush = sj.prototype.flush;
  var uj = {};
  Ic(uj);
  function wj(a2, b2, c2) {
    if (a2 = uj[a2])
      return C(a2[b2], Function, wj, 1, "invalid method"), a2[b2].apply(a2, c2);
  }
  sj.invoke = wj;
  function xj(a2, b2) {
    Da(a2) && (this.i = a2);
    Fc(b2) && (this.a = b2);
  }
  t("H.util.Request", xj);
  xj.State = { PENDING: 0, PROCESSING: 1, COMPLETE: 2, CANCELLED: 3, ERROR: 4 };
  var yj = [0, 1, 2, 3, 4];
  xj.prototype.C = 0;
  xj.prototype.getState = function() {
    return this.C;
  };
  xj.prototype.getState = xj.prototype.getState;
  xj.prototype.O = function(a2) {
    if (0 > yj.indexOf(a2))
      throw new D(this.O, 0, a2);
    if (this.C !== a2 || 1 === a2 && 1 < this.a)
      this.C = a2, this.i && this.i(this);
  };
  xj.prototype.a = 1;
  xj.prototype.cn = function() {
    return this.a;
  };
  xj.prototype.getTotal = xj.prototype.cn;
  xj.prototype.b = 0;
  xj.prototype.Om = function() {
    return this.b;
  };
  xj.prototype.getProcessed = xj.prototype.Om;
  xj.prototype.g = 0;
  xj.prototype.hm = function() {
    return this.g;
  };
  xj.prototype.getFailed = xj.prototype.hm;
  function zj(a2, b2) {
    a2.b < a2.a && (vc(b2) || (b2 = 2), 0 === b2 || 1 === b2 || 0 !== a2.C && 1 !== a2.C || (a2.b++, 2 !== b2 && a2.g++, a2.O(a2.b < a2.a ? 1 : 2)));
  }
  xj.prototype.oe = function() {
  };
  xj.prototype.cancel = function() {
    3 !== this.C && (this.oe(), this.O(3));
  };
  xj.prototype.cancel = xj.prototype.cancel;
  function Aj() {
  }
  t("H.util.ICapturable", Aj);
  Aj.prototype.capture = function() {
  };
  Aj.prototype.capture = Aj.prototype.capture;
  t("H.util.Disposable", qd);
  qd.prototype.tb = qd.prototype.tb;
  qd.prototype.addOnDisposeCallback = qd.prototype.tb;
  t("H.util.dispose", td);
  qd.prototype.F = qd.prototype.F;
  qd.prototype.dispose = qd.prototype.F;
  qd.prototype.o = qd.prototype.o;
  qd.prototype.disposeInternal = qd.prototype.o;
  function Bj(a2, b2) {
    var c2 = a2.N(), d = c2.ownerDocument;
    Bj.j.constructor.call(this);
    this.a = a2;
    this.S = c2 = c2.appendChild(Cj(d, "DIV", "position:absolute;bottom:0;right:0;left:0px;z-index:1;direction:ltr;pointer-events:none;height:40px-webkit-touch-callout: none;-webkit-user-select:none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select:none;", null, "H_imprint"));
    this.qf = Cj(
      d,
      "DIV",
      "margin: 0 0 16px 16px;display:inline-block;",
      '<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>',
      "H_logo"
    );
    c2.appendChild(this.qf);
    c2 = c2.appendChild(Cj(d, "DIV", "right:0;bottom:0;position:absolute;background-color:rgba(255,255,255,.8);color:#0F1621;padding:2px 16px", null, "H_copyright"));
    this.i = c2.appendChild(Cj(d, "A", "color:inherit; margin:0px 8px; text-decoration:none; pointer-events:all;", "Terms of use"));
    this.i.target = "_blank";
    this.g = c2.appendChild(Cj(d, "SPAN", "margin:0px 8px"));
    this.c = c2.appendChild(Cj(d, "SPAN"));
    this.s = Wa(Dj);
    this.vi(b2);
    this.f = A(this.f, this);
    this.b = A(this.b, this);
    this.a.addEventListener(
      this.a.A.Ri,
      this.f
    );
    this.a.a.addEventListener("add", this.b);
    this.a.a.addEventListener("remove", this.b);
    this.a.a.addEventListener("set", this.b);
    this.b();
  }
  var Ej;
  u(Bj, qd);
  t("H.map.Imprint", Bj);
  var Dj = { font: '11px "Lucida Grande", Arial, Helvetica, sans-serif', href: "https://legal.here.com/{LN}/terms/serviceterms/{CN}", invert: false, reportHref: "https://wego.here.com/", locale: "en-US", mark: "" };
  Bj.prototype.vi = function(a2) {
    var b2, c2 = this.qf.firstElementChild.firstElementChild.children;
    a2 || (this.s = Wa(Dj));
    var d = this.s;
    for (b2 in d)
      a2 && b2 in a2 && (d[b2] = a2[b2]);
    a2 = (this.wh = a2 = d.invert) ? Fj : Gj;
    c2[0].style.fill = a2.Wk;
    c2[0].style.fillOpacity = "" + a2.Xk;
    c2[1].style.fill = a2.al;
    c2[1].style.fillOpacity = "" + a2.bl;
    a2 = d.locale;
    Hj[a2] || (a2 = "en-US", d.locale = a2);
    this.i.innerHTML = Hj[a2];
    a2 = a2.split("-");
    this.i.href = d.href.replace("{LN}", a2[0]).replace("{CN}", a2[1].toLowerCase());
    d.mark ? (this.c.innerHTML = d.mark, this.c.style.margin = "0px 8px") : (this.c.innerHTML = "", this.c.style.margin = "0px");
    this.S.style.font = d.font;
  };
  Bj.prototype.setOptions = Bj.prototype.vi;
  function Cj(a2, b2, c2, d, e) {
    a2 = a2.createElement(b2);
    c2 && (a2.style.cssText = c2);
    d && (a2.innerHTML = d);
    e && (a2.className = e);
    return a2;
  }
  Bj.prototype.N = function() {
    return this.S;
  };
  Bj.prototype.f = function() {
    this.g.innerHTML = this.l + " " + this.ba();
  };
  Bj.prototype.b = function() {
    this.f();
    setTimeout(this.f, 5e3);
  };
  var Gj = { al: "#0F1621", bl: 0.3, Wk: "#fff", Xk: 0.6 }, Fj = { al: "#fff", bl: 1, Wk: "#0F1621", Xk: 0.7 }, Ij = "1987&ndash;" + zd(2015, (/* @__PURE__ */ new Date()).getFullYear()) + " HERE";
  Bj.prototype.ba = function() {
    var a2 = this.a, b2 = a2.pb(), c2 = a2.c.jb().bounds;
    a2 = a2.a;
    var d = a2.a.length, e = {}, f2 = 0, g, h, k, l = [Ij];
    if (c2) {
      for (; f2 < d; f2++)
        if (h = a2.get(f2).getCopyrights(c2.K(), b2))
          for (g = 0; g < h.length; g++)
            e[k = h[g].label] || (l.push(k), e[k] = 1);
    }
    return l.join(", ");
  };
  Bj.prototype.getCopyrights = Bj.prototype.ba;
  Bj.prototype.V = function() {
    return this.S.style;
  };
  Bj.prototype.l = String.fromCharCode(169);
  Bj.prototype.o = function() {
    this.a.removeEventListener(this.a.A.Ri, this.f);
    this.a.a.removeEventListener("add", this.b);
    this.a.a.removeEventListener("remove", this.b);
    this.a.a.removeEventListener("set", this.b);
    if (this.S.parentNode) {
      var a2 = this.S;
      a2.parentNode.removeChild(a2);
    }
  };
  Bj.prototype.disposeInternal = Bj.prototype.o;
  Bj.prototype.capture = function(a2, b2, c2, d) {
    var e = a2.getContext("2d"), f2 = window.getComputedStyle(this.g.parentElement), g = 2 * Dc(f2.paddingLeft, 10), h = (this.g.offsetWidth + 2 * g) * b2, k = this.g.offsetHeight * b2, l = 0 !== this.c.innerHTML.length ? this.c.offsetWidth * b2 : 0, m = Ec(f2.getPropertyValue("font-size")), n = this.S.ownerDocument, q = +a2.width, r = +a2.height, v = 16 * b2, w = this.qf.childNodes[0].getBoundingClientRect(), y = w.width * b2, G = w.height * b2, I = ld;
    Da(d) && (I = function() {
      d("capture_error");
    });
    e.fillStyle = f2.backgroundColor;
    e.fillRect(
      q - h - l,
      r - k,
      h + l,
      k
    );
    h = this.c.innerHTML;
    h = this.l + " " + function(Q) {
      Q = Cj(n, "div", null, Q);
      return Q.textContent || Q.innerText || "";
    }(this.ba()) + (h ? " " + h : "");
    e.font = m * b2 + "px " + f2.getPropertyValue("font-family");
    e.fillStyle = f2.getPropertyValue("color");
    e.textBaseline = "bottom";
    e.textAlign = "right";
    e.fillText(h, q - g * b2, r);
    Jj(this, e.font, function(Q) {
      new tf("image", Q).then(function(V) {
        e.drawImage(V, v, r - (G + v), y, G);
        c2(a2);
      }, I);
    }, I);
  };
  Bj.prototype.capture = Bj.prototype.capture;
  function Jj(a2, b2, c2, d) {
    Kj(A(function(e) {
      e ? this.wh ? c2("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAADNklEQVRYR82XW6hVVRSGv7+rmJfSMKSnSkMEfY7EogcJC7tilGRopBAiSaI+SBARQSCIIqgFISih2YW0oAgLCsKXojA0RB+81VugZEFZv/yHuWTt7d7Hfc4+6+h4OWefNfcc3xlj/v+YS1zjoab5bE8DZgGngB8keSg5GwO0PQ54F3i2BnQIWCLpx14hGwG0fT3wOfBwB5DzwOOSDvQC2RTgM8Ae4D/gaeA3YDdwN5AWvyxp+6gD2r4OmAq8AbwInAMmA/OAT4CbgBWStvYClzUjWkHbrwHLgF8LVHJ8DDxah7P9JHCil7M40oA/A7OBC8ANtSqlrQOVs30/8CWQat8r6cxg1RwRQNvPA88Bk4D7gJzBV4A5teSp5MlS4VuA/ZIeu1Kr+wa0/QTwIRDlRhT5eTswBvi2CKOd42AULilndNAYCcA7gK+BmbVMiyXtsh3Qt4FFBTgW8w6wXtLfV4LrSyS2FwAvAWOBX+JtwF0laUDmS/oun23fDNwJnJb0Ty9g1ZphVdB2qrK2LdFfBbb685/AIxXkUKDqa4cMaDs2kjalRe8Fola57J3qRQSJviGHA3gMuAdYI2lDUfDOArQLWAd8VTuTOW9vjUoFy6TIGYpS9wKfAjuK5wVuSfn91iKcvZJeHy5ci0hsZwzNk5Qh3xIFbLyks7aPAtPLgv+L4VZwDwLvA6uKz6XdfcVAi22PBz4q4+lVSRurXW2vKYKIZfwEHCmmXC35HngAyITYD0ys2t8XWflyBfhmvKm24QCk7aVFCPVc7WMszzKucknI+NoHPCUppt13VICZm2nNwjoksByY0SXL72Vi3FieZ97mgrpyqF432H9xScW2O0H+W6oSE/4D2FYuA9kzlUzVTwO3Ad9IOtx3ydo2aLGZLpABm5KW2Z4AfAbMLfsEcpGkKLqRuMwHu0CukrSpCCrvGlF6hBEVL5MUw24kOhp1B8gc+FTqgxpkFLuzSbjk6jpJOkC2tDPeKCkVbDRkO67fDTTC2VK7vgfyBUlfNEpV2zyAK4HNXRLmZfshScdHC6g9T+WDGU2XpkdZdNXhWs6g7dXAhmsJ7jKR2M77bG4kV7Wt9TZfBLgYEC7PSpcIAAAAAElFTkSuQmCC") : c2("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIMSURBVFiFzdZPiE1RGADwXzPTTPIMQoodVpbKgpoUG5qExUi8DSVJQv4slJJsbNjYWFhNETWLUUosRDRLUVLCYhIiojFojHkW997uvefNGIuZc99Xp/fOO6/Or++c75xDi0d7hDlWYQNqeB9hvv+OGq6jUWjPsKZKVBbtuKOMy9p3bKqOlsROCWYc27AWr9PfJnCgKlgbluNqivmGDmzBrxR3sCocnMEw7sqXdEAzboeK9uLTFPVbed8VcesxglFJtqNEHbcxlIL68ChADuCSpEgauBULt11SDI3C5yJJdrLCCNsQumMBl+J5AKinY4slBfNTfsRcxJwYsK0YxD3J0r1RPut6Cv/twgp0xoDBBc3LNhr0RwJktNifAn7gsnLmsuxVinyVTn4i7dcLoH4sU96Tp2Pi2uSVehN75Gdev+QO7pIXztmZnLwTvf+AzU+/v5Rn50+A24gP2IW5M4mbJ7+ejgVjJ/EpHXuCa8p77nGK68FX5eWfsTgfTJoh92qu1vAaa+CtPJuDZuEh3CHZUyHyxSSYrL3DWKE/gStm8aybDDkmKYperJM/BrJMnsJuHMLq2YJNh/wsX7JuPAyQfTFg0yGPFMZreCCv4n2xgTQjxyXP+CxquK8iXBYhMlzOtliQBVg4RVuCG/iSto/YHAuWxWFTHyXDWBkbNFkc1cK4LI5rYVwW57QY7i/pZeJv8QQJRQAAAABJRU5ErkJggg==") : (e = this.qf.cloneNode(true), e.firstChild.setAttribute("style", "font:" + b2), c2(bf(e.innerHTML)));
    }, a2), d);
  }
  Bj.prototype.wh = false;
  function Kj(a2, b2) {
    var c2 = "data:image/svg+xml;charset=utf-8," + encodeURIComponent('<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>'), d = Ej;
    vc(d) ? a2(d) : new tf("image", c2).then(function(e) {
      Ye.drawImage(e, 0, 0);
      try {
        Ye.getImageData(0, 0, 1, 1), d = false;
      } catch (f2) {
        d = 18 === f2.code;
      } finally {
        Ej = d, a2(d);
      }
    }, b2);
  }
  Bj.prototype.nl = function(a2, b2) {
    Hj[a2] = b2;
  };
  Bj.prototype.addL11NString = Bj.prototype.nl;
  var Hj = {
    "de-DE": "Nutzungsbedingungen",
    "en-US": "Terms of use",
    "en-GB": "Terms of use",
    "es-ES": "Condiciones de uso",
    "fi-FI": "Palveluehdot",
    "fr-FR": "Conditions d'utilisation",
    "it-IT": "Condizioni di utilizzo",
    "nl-NL": "Dienstvoorwaarden",
    "pl-PL": "Warunki wiadczenia usugi",
    "pt-BR": "Termos de servio",
    "pt-PT": "Termos do servio",
    "ru-RU": " ",
    "tr-TR": "Servis Koullar",
    "zh-CN": ""
  };
  function R(a2) {
    var b2 = {};
    this.f = b2.previousSibling = b2.nextSibling = b2;
    this.g = new cf();
    R.j.constructor.call(this, a2);
    a2 && "objects" in a2 && this.Xb(a2.objects);
  }
  u(R, M);
  t("H.map.Group", R);
  R.prototype.type = nh.GROUP;
  R.prototype.ee = function(a2, b2) {
    this.b = true;
    a2 = R.j.ee.call(this, a2, b2);
    this.b = false;
    a2 && this.forEach(Lj, true);
    return a2;
  };
  R.prototype.setProvider = R.prototype.ee;
  function Lj(a2, b2, c2) {
    a2.ee(c2.ma);
  }
  R.prototype.contains = function(a2) {
    var b2 = this === a2;
    if (!b2 && this.a && C(a2, M))
      for (; !b2 && a2; )
        a2 === this ? b2 = true : a2 = a2.Fa;
    return b2;
  };
  R.prototype.contains = R.prototype.contains;
  R.prototype.Ye = function() {
    this.L = B;
    this.forEach(Mj, true);
  };
  R.prototype.resetZInfo = R.prototype.Ye;
  function Mj(a2) {
    a2.Ye();
  }
  R.prototype.b = false;
  R.prototype.ra = function(a2) {
    var b2 = R.j.ra.call(this, a2);
    b2 && !this.b && (this.c = a2, this.forEach(Nj, true), delete this.c);
    return b2;
  };
  R.prototype.invalidate = R.prototype.ra;
  function Nj(a2, b2, c2) {
    a2.ra(c2.c);
  }
  R.prototype.forEach = function(a2, b2, c2) {
    var d;
    if (this.a) {
      var e = this.f;
      var f2 = e.nextSibling;
      for (d = 0; f2 !== e; ) {
        var g = f2.nextSibling;
        a2.call(c2, f2, d++, this);
        b2 && C(f2, R) && f2.forEach(a2, b2, c2);
        f2 = g;
      }
    }
  };
  R.prototype.forEach = R.prototype.forEach;
  R.prototype.Ua = function(a2) {
    var b2 = [];
    this.forEach(Oj, a2, b2);
    return b2;
  };
  R.prototype.getObjects = R.prototype.Ua;
  R.prototype.K = function() {
    var a2 = null;
    this.a && this.forEach(function(b2) {
      b2.K && (b2 = b2.K()) && (a2 ? a2 = a2.ec(b2) : a2 = b2);
    });
    return a2;
  };
  R.prototype.getBoundingBox = R.prototype.K;
  function Oj(a2) {
    this.push(a2);
  }
  R.prototype.a = 0;
  R.prototype.Rl = function() {
    return this.a;
  };
  R.prototype.getChildCount = R.prototype.Rl;
  R.prototype.fa = function(a2) {
    var b2 = this.f, c2 = b2.previousSibling;
    C(a2, M, this.fa, 0);
    if (a2.contains(this))
      throw new $c(this.fa, "The new object contains the parent group");
    var d = a2.Lf(true);
    var e = a2.Fa;
    if (e !== this) {
      if (e) {
        e = a2.previousSibling;
        var f2 = a2.nextSibling;
        e.nextSibling = f2;
        f2.previousSibling = e;
      }
      a2.Fa = this;
      M.j.ka.call(a2, this);
      c2.nextSibling = a2;
      a2.previousSibling = c2;
      a2.nextSibling = b2;
      b2.previousSibling = a2;
      this.a++;
    }
    a2.Di = this.g.next();
    a2.Ye();
    b2 = a2.ee(this.ma, this.fa);
    a2.Lf(true) !== d && a2.ra(kh.VOLATILITY);
    b2 || a2.ra(kh.Z_ORDER);
    return a2;
  };
  R.prototype.addObject = R.prototype.fa;
  R.prototype.Xb = function(a2) {
    var b2;
    Bc(a2, this.Xb, 0);
    var c2 = a2.length;
    for (b2 = 0; b2 < c2; b2++)
      this.fa(a2[b2]);
  };
  R.prototype.addObjects = R.prototype.Xb;
  R.prototype.Ga = function(a2) {
    if (!a2 || a2.Fa !== this)
      throw new $c(this.Ga, "object not found");
    var b2 = a2.previousSibling, c2 = a2.nextSibling;
    b2.nextSibling = c2;
    c2.previousSibling = b2;
    a2.Fa = null;
    M.j.ka.call(a2, null);
    delete a2.previousSibling;
    delete a2.nextSibling;
    C(a2.ma, N) && a2.ee(null, this.Ga);
    this.a--;
    return a2;
  };
  R.prototype.removeObject = R.prototype.Ga;
  R.prototype.rd = function(a2) {
    var b2;
    Bc(a2, this.rd, 0);
    var c2 = a2.length;
    for (b2 = 0; b2 < c2; b2++)
      this.Ga(a2[b2]);
  };
  R.prototype.removeObjects = R.prototype.rd;
  R.prototype.na = function() {
    var a2 = this.Ua();
    this.rd(a2);
  };
  R.prototype.removeAll = R.prototype.na;
  R.prototype.Kc = function(a2) {
    for (var b2 = this.Ua(), c2 = 0, d = b2.length, e = [], f2, g, h; c2 < d; c2++)
      h = b2[c2], h instanceof R ? (f2 = a2 ? a2(h.getData()) : h.getData(), g = qh(this, f2, !!a2), f2 = { type: "Feature" }, f2.properties = g, h.i && (f2.id = h.i), f2.geometry = {}, f2.geometry.type = "GeometryCollection", f2.geometry.geometries = Pj(this, h.Ua()), e.push(f2)) : e.push(h.Kc(a2));
    return { type: "FeatureCollection", features: e };
  };
  R.prototype.toGeoJSON = R.prototype.Kc;
  function Pj(a2, b2) {
    for (var c2 = 0, d = b2.length, e, f2, g = []; c2 < d; c2++)
      e = b2[c2], e instanceof R ? f2 = { type: "GeometryCollection", geometries: Pj(a2, e.Ua()) } : e instanceof rh || e instanceof sh || e instanceof th || e instanceof uh ? f2 = e.ga().Kc() : f2 = { type: "FeatureCollection", features: hf }, g.push(f2);
    return g;
  }
  R.prototype.Y = function() {
    var a2 = R.j.Y.call(this);
    a2.type = "Group";
    return a2;
  };
  R.prototype.forWorkerMessage = R.prototype.Y;
  var Qj = { PROVIDES_BY_VIEWPORT: 1, PROVIDES_RASTERS: 2, PROVIDES_SPATIALS: 4, PROVIDES_OVERLAYS: 8, PROVIDES_MARKERS: 16, PROVIDES_DOM_MARKERS: 32, PROVIDES_GEOJSON: 64, PROVIDES_OMV: 128, CROP_LINES_BY_TILE: 256, CROP_POLYGONS_BY_TILE: 512, HAS_VOLATILE_DATA: 1024 };
  t("H.map.provider.Capabilities", Qj);
  Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS = Qj.PROVIDES_SPATIALS | Qj.PROVIDES_OVERLAYS | Qj.PROVIDES_MARKERS;
  function Rj(a2, b2, c2, d, e) {
    b2 && (this.f = b2);
    vc(c2) && (this.c = !!c2);
    this.c && d && (this.Lg = new Wi(d.w, d.h));
    vc(e) && (this.g = { crossOrigin: e });
    switch (Sj[Ac(a2)]) {
      case 2:
        this.a = a2;
        Tj(this, 1);
        break;
      case 1:
        if (nf(a2)) {
          this.a = a2;
          Uj(this);
          Tj(this, 1);
          break;
        }
        a2 = a2.src;
      case 0:
        if (a2) {
          a2 = bf(a2);
          this.b = new tf("image", a2, B, this.g);
          this.b.then(A(this.$n, this), A(this.Zn, this));
          break;
        }
      default:
        throw Tj(this, -1), new D(Rj, 0, "No image data");
    }
  }
  Rj.prototype.C = 0;
  Rj.prototype.getState = function() {
    return this.C;
  };
  function Tj(a2, b2) {
    a2.C = b2;
    delete a2.b;
    a2.f && a2.f(b2, a2);
  }
  Rj.prototype.c = true;
  function Uj(a2) {
    if (a2.c) {
      var b2 = a2.a, c2 = Vj(a2), d = c2 && c2.w || +b2.width, e = c2 && c2.h || +b2.height, f2 = Ue();
      if (C(b2, x.HTMLCanvasElement))
        c2 = b2;
      else {
        c2 = b2.ownerDocument.createElement("canvas");
        c2.width = Cd(d * f2);
        c2.height = Cd(e * f2);
        var g = c2.getContext("2d");
        g.scale(f2, f2);
        g.drawImage(b2, 0, 0, d, e);
        cd && (g.clearRect(0, 0, d, e), g.drawImage(b2, 0, 0, d, e));
      }
      a2.a = c2;
    }
  }
  Rj.prototype.getData = function() {
    return this.a || z;
  };
  var Sj = { String: 0, HTMLImageElement: 1, HTMLCanvasElement: 2 };
  p = Rj.prototype;
  p.Lg = z;
  p.yb = function() {
    return 1 === this.C ? Vj(this) : z;
  };
  function Vj(a2) {
    var b2 = a2.Lg, c2;
    if (!b2) {
      var d = a2.a;
      b2 = d.naturalWidth || d.width;
      if (0 === b2 && $e && 1 === Sj[Ac(d)]) {
        var e = true;
        if (c2 = d.parentNode)
          var f2 = d.nextSibling;
        document.body.appendChild(d);
      }
      a2.Lg = b2 = new Wi(d.naturalWidth || d.width, d.naturalHeight || d.height);
      e && (c2 ? c2.insertBefore(d, f2) : document.body.removeChild(d));
    }
    return b2;
  }
  p.$n = function(a2) {
    this.a = a2;
    Uj(this);
    Tj(this, 1);
  };
  p.Zn = function() {
    Tj(this, -1);
  };
  p.cancel = function() {
    this.b && this.b.cancel();
  };
  function Wj(a2, b2) {
    var c2, d = "anonymous";
    this.uid = Xj.next();
    Wj.j.constructor.call(this);
    if (b2) {
      var e = "size";
      if (e in b2) {
        var f2 = b2[e];
        if (!f2 || isNaN(f2.w) || isNaN(f2.h))
          throw new D(Wj, 1, e);
        this.g = new Wi(f2.w, f2.h);
      }
      e = "anchor";
      if (e in b2) {
        f2 = b2[e];
        if (!f2 || isNaN(f2.x) || isNaN(f2.y))
          throw new D(Wj, 1, e);
        this.f = new J(f2.x, f2.y);
      }
      e = "hitArea";
      e in b2 && (f2 = b2[e], C(f2, Xi, Wj, 1), this.c = b2[e]);
      e = "asCanvas";
      e in b2 && (c2 = b2[e]);
      e = "crossOrigin";
      e in b2 && (d = b2[e]);
      f2 = b2.stickHeight;
      f2 === +f2 && 0 < f2 && (this.Fo = f2);
      e = "stickColor";
      f2 = b2[e];
      e in b2 && Cc(f2) && (this.Eo = f2);
    }
    a2 = new Rj(a2, A(this.i, this), c2, this.g, d);
    b2 = this.C = a2.getState();
    0 !== b2 ? this.i(b2, a2) : this.b = a2;
  }
  u(Wj, F);
  t("H.map.Icon", Wj);
  var Xj = new cf();
  Wj.State = { ERROR: -1, LOADING: 0, READY: 1 };
  Wj.prototype.getState = function() {
    return this.C;
  };
  Wj.prototype.getState = Wj.prototype.getState;
  Wj.prototype.i = function(a2, b2) {
    this.a = b2.getData();
    if (1 === a2) {
      var c2 = this.g;
      c2 || (c2 = this.g = b2.yb());
      this.f || (this.f = new J(c2.w / 2 | 0, c2.h));
    }
    this.b && (this.C = a2, delete this.b, this.dispatchEvent("statechange"));
  };
  Wj.prototype.a = z;
  Wj.prototype.Qc = function() {
    return this.a;
  };
  Wj.prototype.getBitmap = Wj.prototype.Qc;
  Wj.prototype.yb = function() {
    return this.g || z;
  };
  Wj.prototype.getSize = Wj.prototype.yb;
  Wj.prototype.f = z;
  Wj.prototype.kd = function() {
    return this.f;
  };
  Wj.prototype.getAnchor = Wj.prototype.kd;
  Wj.prototype.c = z;
  Wj.prototype.nm = function() {
    return this.c;
  };
  Wj.prototype.getHitArea = Wj.prototype.nm;
  Wj.prototype.o = function() {
    Wj.j.o.call(this);
    this.a ? (this.a.removeAttribute("src"), delete this.a) : (this.b.cancel(), delete this.b);
  };
  function Yj(a2, b2, c2, d, e, f2) {
    Yj.j.constructor.call(this, isNaN(a2) ? 15 : a2, b2, c2, d, e, f2);
  }
  u(Yj, wg);
  Yj.prototype.s = function(a2) {
    for (var b2, c2, d = this.head, e = a2; e; ) {
      if (a2 = e.entries) {
        if (b2 = a2.length) {
          if (2 > b2 && (c2 = e.parent) && 1 === c2.a) {
            c2.removeChild(e);
            d === e && (d = c2);
            c2.entries = a2;
            e = a2[0].node = c2;
            continue;
          }
        } else if (delete e.entries, c2 = e.parent) {
          if (c2.removeChild(e), d === e && (d = c2), 1 === c2.a) {
            e = c2.a ? c2[0] || c2[1] || c2[2] || c2[3] : null;
            continue;
          }
        }
      }
      break;
    }
    this.head !== d && (this.head = d, Bg(this));
  };
  Yj.prototype.yc = function(a2, b2) {
    if (Gg(this.a, a2, b2, a2, b2))
      return Zj(this, this.a, a2, b2, this.c);
    throw Error("Coordinates out of bounds");
  };
  function Zj(a2, b2, c2, d, e) {
    var f2 = b2.entries;
    if (e)
      if (b2.a)
        f2 = ak(a2, b2, c2, d, e);
      else if (f2) {
        f2 = f2[0];
        var g = Eg(b2, +(f2[1] >= b2[8]) | +(f2[0] >= b2[9]) << 1);
        g.entries = b2.entries;
        delete b2.entries;
        f2.node = g;
        Bg(a2, g);
        f2 = ak(a2, b2, c2, d, e);
      } else
        Fg(b2, f2 = new bk(c2, d)), Bg(a2, b2), zg(a2, f2, true);
    else
      f2 || Bg(a2, b2), Fg(b2, f2 = new bk(c2, d)), zg(a2, f2, true);
    return f2;
  }
  function ak(a2, b2, c2, d, e) {
    return Zj(a2, Eg(b2, +(c2 >= b2[8]) | +(d >= b2[9]) << 1), c2, d, e - 1);
  }
  function bk(a2, b2) {
    this.id = Dg++;
    this[0] = b2;
    this[1] = a2;
  }
  bk.prototype.a = function(a2) {
    return this[a2 % 2];
  };
  function ck() {
    this.a = new Yj(10, 180, 90, 0, 0, true);
  }
  p = ck.prototype;
  p.Dh = 0;
  p.Rc = function() {
    return this.Dh;
  };
  p.Uf = null;
  p.K = function() {
    var a2 = this.Uf, b2;
    !a2 && (b2 = xg(this.a)) && (this.Uf = a2 = new K(-b2[0], b2[3], -b2[2], b2[1]));
    return a2;
  };
  p.yc = function(a2) {
    ++this.Dh;
    this.Uf = null;
    return this.a.yc(a2.lng, -a2.lat);
  };
  p.remove = function(a2) {
    if (a2 = this.a.remove(a2))
      --this.Dh, this.Uf = null;
    return a2;
  };
  p.Pf = function(a2, b2, c2) {
    var d = this.a, e = a2.Nb(), f2 = a2.Jb(), g = -e.lat;
    e = e.lng;
    var h = -f2.lat;
    f2 = f2.lng;
    var k;
    a2.Bb() ? k = d.Za(-180, g, f2, h, c2, b2).concat(d.Za(e, g, 180, h, c2, b2)) : k = d.Za(e, g, f2, h, c2, b2);
    return k;
  };
  function dk(a2) {
    this.a = a2;
  }
  ;
  function ek(a2, b2, c2) {
    this.c = a2;
    this.a = b2;
    this.g = c2;
    this.f = this.c & Qj.PROVIDES_BY_VIEWPORT ? "function(){return sources[$source].isInMinMaxRange(feature, $zoom) && feature.ref.effectiveVisibility;}" : B;
    this.b = {};
  }
  ;
  function fk(a2, b2, c2, d) {
    this.a = a2;
    this.b = b2;
    this.c = c2;
    this.kf = d;
  }
  function gk(a2, b2, c2, d) {
    a2 = { type: b2, uid: a2.b, tiled: c2, max_zoom: a2.c };
    d && Ya(a2, d);
    return a2;
  }
  ;
  function hk(a2, b2, c2, d, e) {
    this.a = a2;
    this.b = b2;
    this.c = c2;
    this.f = d;
    this.kf = e;
  }
  function ik(a2) {
    if (a2.a & Qj.PROVIDES_DOM_MARKERS && !(a2.a & Qj.PROVIDES_MARKERS))
      return {};
    var b2 = new fk(a2.a, a2.b, a2.c, a2.kf);
    var c2 = new dk(a2.a);
    a2 = new ek(a2.a, a2.b, a2.f);
    var d = {}, e = b2.b;
    b2 = b2.a & Qj.PROVIDES_BY_VIEWPORT ? gk(b2, "ObjectSource", false, { progressiveUpdate: true, has_volatile_data: !!(b2.a & Qj.HAS_VOLATILE_DATA) }) : b2.a & Qj.PROVIDES_RASTERS ? gk(b2, "RemoteRasterTileSource", true, { url: "" }) : gk(b2, "ObjectTileSource", true, { tile_size: b2.kf });
    d[e] = b2;
    b2 = {};
    c2.a & Qj.PROVIDES_RASTERS && (b2 = { "translucent-raster": qi("raster", "inlay", 1) });
    if (c2.a & Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS) {
      e = !!(c2.a & Qj.CROP_LINES_BY_TILE);
      var f2 = { "translucent-polygons": qi("polygons", "inlay", 2), "translucent-extruded-polygons": qi("polygons", "translucent", 3), "translucent-pattern-lines": qi("pattern-lines", "translucent", 4), "translucent-overlays": qi("overlays", "inlay", 5), markers: qi("custom_icons", "overlay", 6, false) };
      f2["translucent-polygons"].crop_by_tile = !!(c2.a & Qj.CROP_POLYGONS_BY_TILE);
      f2["translucent-pattern-lines"].crop_by_tile = e;
      f2.markers.suppress_fade = true;
      f2.markers.stick = true;
      Ya(b2, f2);
    }
    a2.c & Qj.PROVIDES_RASTERS && (a2.b["tile_layer_" + a2.a] = si(a2.a, "_default", { "translucent-raster": { color: [1, 1, 1, a2.g], order: 0 } }));
    if (a2.c & Qj.PROVIDES_SPATIALS) {
      c2 = { "translucent-pattern-lines": { color: pi("strokeColor"), width: pi("lineWidth * $meters_per_pixel"), join: pi("lineJoin"), cap: pi("lineCap"), tail_cap: pi("lineTailCap"), head_cap: pi("lineHeadCap"), miter_limit: pi("miterLimit"), order: "function() { return 2 + feature.effectiveZIdx / 2; }", interactive: true, dash: pi("lineDash"), extrude: true, dash_phase: pi("lineDashOffset") } };
      e = a2.b;
      f2 = "polygon_layer_" + a2.a;
      var g = si(
        a2.a,
        "polygons",
        void 0,
        a2.f
      );
      g.flat = { filter: "function(){return !feature.height && !feature.min_height;}", draw: ri(false) };
      g.extruded = { filter: "function(){return feature.height || feature.min_height;}", draw: ri(true) };
      e[f2] = g;
      a2.b["outline_layer_" + a2.a] = si(a2.a, "outlines", c2, a2.f);
      a2.b["polyline_layer_" + a2.a] = si(a2.a, "polylines", c2, a2.f);
    }
    a2.c & Qj.PROVIDES_OVERLAYS && (a2.b["overlay_layer_" + a2.a] = si(a2.a, "overlays", { "translucent-overlays": { color: [1, 1, 1, a2.g], order: 8190, interactive: true } }));
    a2.c & Qj.PROVIDES_MARKERS && (a2.b["marker_layer_" + a2.a] = si(a2.a, "markers", { markers: { sprite: oi("icon.id"), offset: oi("icon.offset"), collide: false, priority: 8191, elevate_by_altitude: true, interactive: true, stick: { color: oi("icon.stick_color"), height: oi("icon.stick_height") } } }, a2.f));
    return { sources: d, styles: b2, layers: a2.b };
  }
  ;
  function P(a2) {
    var b2 = "" + ef(), c2;
    P.j.constructor.call(this);
    a2 = a2 || {};
    this.min = a2.min || 0;
    this.max = a2.max || 22;
    if (c2 = a2.uri) {
      if (/_/.test(c2))
        throw new D(P, 0, "uri " + c2);
    } else
      c2 = b2;
    this.uri = c2 || b2;
    this.uid = b2;
    a2.getCopyrights && zc(a2.getCopyrights, "Function", P) && (this.getCopyrights = a2.getCopyrights);
    this.hb = this.hb.bind(this);
    this.ta = true;
    this.b = a2.engineType || jk;
    if (this.b === kk.HARP && !H.map.render.harp)
      throw new D(P, 0, "HARP engine is not supported, module not found");
  }
  u(P, F);
  t("H.map.provider.Provider", P);
  p = P.prototype;
  p.A = { ie: "configchange", za: "update" };
  p.Va = function(a2, b2) {
    this.dispatchEvent(new vd(this.A.za, b2, a2));
  };
  p.hb = function(a2) {
    a2 = new cj(this.A.ie, a2 && a2.newValue, a2 && a2.oldValue);
    this.dispatchEvent(a2);
  };
  p.o = function() {
    F.prototype.o.call(this);
    this.a && (this.a.removeEventListener("change", this.hb), this.a.F(), delete this.a);
  };
  p.ba = function() {
    return null;
  };
  P.prototype.getCopyrights = P.prototype.ba;
  P.prototype.getCapabilities = function() {
    var a2 = 0;
    this.di() && (a2 |= Qj.PROVIDES_BY_VIEWPORT);
    this.providesRasters() && (a2 |= Qj.PROVIDES_RASTERS);
    this.providesSpatials() && (a2 |= Qj.PROVIDES_SPATIALS);
    this.providesOverlays() && (a2 |= Qj.PROVIDES_OVERLAYS);
    this.providesMarkers() && (a2 |= Qj.PROVIDES_MARKERS);
    this.providesDomMarkers() && (a2 |= Qj.PROVIDES_DOM_MARKERS);
    this.providesGeoJSON() && (a2 |= Qj.PROVIDES_GEOJSON);
    this.providesOMV() && (a2 |= Qj.PROVIDES_OMV);
    return a2;
  };
  P.prototype.getCapabilities = P.prototype.getCapabilities;
  P.prototype.di = gf;
  P.prototype.Ve = gf;
  P.prototype.providesRasters = P.prototype.Ve;
  P.prototype.Cc = gf;
  P.prototype.providesSpatials = P.prototype.Cc;
  P.prototype.fi = gf;
  P.prototype.providesOverlays = P.prototype.fi;
  P.prototype.Rb = gf;
  P.prototype.providesMarkers = P.prototype.Rb;
  P.prototype.Qb = gf;
  P.prototype.providesDomMarkers = P.prototype.Qb;
  P.prototype.ei = gf;
  P.prototype.providesGeoJSON = P.prototype.ei;
  P.prototype.Sb = gf;
  P.prototype.providesOMV = P.prototype.Sb;
  P.prototype.dm = function() {
    return this.b;
  };
  P.prototype.getEngineType = P.prototype.dm;
  P.prototype.wo = function(a2) {
    this.b = a2;
  };
  P.prototype.setEngineType = P.prototype.wo;
  P.prototype.Ue = ld;
  P.prototype.preprocessData = P.prototype.Ue;
  P.prototype.g = 1;
  function lk(a2, b2) {
    b2 = ae(b2, 0, 1);
    E(b2) && (b2 = 1);
    a2.g !== b2 && (a2.g = b2, a2.ta && mk(a2), a2.hb(), a2.Va());
  }
  P.prototype.Em = function() {
    return this.g;
  };
  P.prototype.getOpacityInternal = P.prototype.Em;
  P.prototype.Qa = function(a2, b2) {
    var c2 = this;
    if (this.b === kk.WEBGL && !C(a2, ti) || this.b === kk.HARP && !C(a2, H.map.render.harp.Style))
      throw a2 = Object.entries(kk).find(function(d) {
        return d[1] === c2.b;
      }), new D(this.Qa, 0, "Invalid style for engineType " + a2);
    this.a && (this.a.removeEventListener("change", this.hb), this.a.removeEventListener(Yh, this.hb), this.a.F());
    this.a = a2;
    this.a.addEventListener("change", this.hb);
    this.a.addEventListener(Yh, this.hb);
    b2 || this.hb();
    this.ta = false;
  };
  P.prototype.setStyleInternal = P.prototype.Qa;
  P.prototype.Ya = function() {
    this.a || mk(this);
    return this.a;
  };
  P.prototype.getStyleInternal = P.prototype.Ya;
  function mk(a2) {
    if (a2.b === kk.WEBGL) {
      var b2 = new hk(a2.getCapabilities(), a2.uid, a2.max, a2.g, a2.tileSize);
      a2.a = new ti(ik(b2));
    } else
      a2.b === kk.HARP && H.map.render.harp && (a2.a = new H.map.render.harp.Style({}));
    a2.ta = true;
  }
  P.prototype.Ej = function() {
    var a2 = this.getCapabilities(), b2 = nk.FEATURE;
    a2 & Qj.PROVIDES_BY_VIEWPORT ? b2 = nk.SOURCE : a2 & Qj.PROVIDES_RASTERS ? b2 = null : a2 & Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS && (b2 = nk.PROVIDER);
    return b2;
  };
  P.prototype.getPickingMode = P.prototype.Ej;
  P.prototype.im = function() {
    return false;
  };
  P.prototype.getFeatureProxy = P.prototype.im;
  function ok(a2) {
    var b2;
    xc(this, ok);
    ok.j.constructor.call(this, a2);
    this.wa = a2 = [];
    for (b2 in nh)
      a2[nh[b2]] = new jh();
  }
  u(ok, P);
  t("H.map.provider.ObjectProvider", ok);
  ok.prototype.di = ff;
  ok.prototype.providesByViewport = ok.prototype.di;
  ok.prototype.Kb = function(a2) {
    return this.wa[a2 || nh.ANY];
  };
  ok.prototype.getInvalidations = ok.prototype.Kb;
  ok.prototype.Td = function(a2, b2) {
    if (b2 !== kh.NONE) {
      var c2 = this.wa[nh.ANY];
      var d = c2.a + 1;
      c2.update(d, b2);
      c2 = this.wa[a2.type];
      c2.update(d, b2);
      a2.Kb().update(d, b2);
      this.Va(a2);
    }
  };
  ok.prototype.invalidateObject = ok.prototype.Td;
  ok.prototype.requestOverlays = ok.prototype.sd;
  ok.prototype.requestSpatials = ok.prototype.kg;
  ok.prototype.requestSpatialsByTile = ok.prototype.mg;
  ok.prototype.qa = false;
  ok.prototype.requestMarkers = ok.prototype.Ec;
  ok.prototype.requestDomMarkers = ok.prototype.Dc;
  function N(a2) {
    a2 = a2 || {};
    N.j.constructor.call(this, a2);
    this.f = a2 = new R({ min: a2.min, max: a2.max });
    a2.ma = this;
    a2.ka(this);
    a2.ra(kh.ADD);
    this.J = new Lg();
    this.i = new Lg();
    this.m = new ck();
    this.u = new Lg();
    this.P = new ck();
    this.T = new Lg();
  }
  u(N, ok);
  t("H.map.provider.LocalObjectProvider", N);
  N.prototype.getCapabilities = function() {
    return Qj.PROVIDES_BY_VIEWPORT | Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS | Qj.PROVIDES_DOM_MARKERS | Qj.CROP_LINES_BY_TILE;
  };
  N.prototype.Ya = function() {
    if (!this.l && (this.l = N.j.Ya.call(this), this.l instanceof ti)) {
      var a2 = new hk(this.getCapabilities() | Qj.HAS_VOLATILE_DATA, this.uid + "_vol", this.max, this.g, this.tileSize);
      this.l.Oe(ik(a2));
    }
    return this.l;
  };
  N.prototype.getStyleInternal = N.prototype.Ya;
  N.prototype.Qa = function(a2, b2) {
    N.j.Qa.call(this, a2, b2);
    this.l = null;
  };
  N.prototype.setStyleInternal = N.prototype.Qa;
  N.prototype.bc = function() {
    return this.f;
  };
  N.prototype.getRootGroup = N.prototype.bc;
  N.prototype.Td = function(a2, b2) {
    b2 & kh.SPATIAL && this.fa(a2);
    N.j.Td.call(this, a2, b2);
  };
  N.prototype.invalidateObject = N.prototype.Td;
  N.prototype.fa = function(a2) {
    var b2;
    C(a2, M, this.fa, 0);
    if (a2.ma !== this)
      throw new $c(this.fa, "foreign object");
    this.Ga(a2);
    var c2 = a2.type;
    if (c2 === nh.MARKER)
      if ((b2 = a2.ga()) instanceof kg) {
        var d = true;
        c2 = this.m;
      } else
        c2 = this.u;
    else
      c2 === nh.DOM_MARKER ? (b2 = a2.ga()) instanceof kg ? (d = true, c2 = this.P) : c2 = this.T : c2 = c2 === nh.OVERLAY ? this.J : this.i;
    d = d ? c2.yc(b2) : c2.Pj(a2.K());
    d.c = a2;
    a2.qa = d;
  };
  N.prototype.Ga = function(a2) {
    var b2;
    if (a2) {
      if (a2.ma !== this) {
        if (C(a2, M))
          throw new $c(this.Ga, "foreign object");
      } else if (b2 = a2.qa) {
        var c2 = a2.type;
        c2 === nh.MARKER ? this.m.remove(b2) || this.u.remove(b2) : c2 === nh.DOM_MARKER ? this.P.remove(b2) || this.T.remove(b2) : c2 === nh.OVERLAY ? this.J.remove(b2) : this.i.remove(b2);
        delete b2.c;
        delete a2.qa;
      }
    }
  };
  N.prototype.removeObject = N.prototype.Ga;
  function pk(a2, b2, c2, d, e, f2, g) {
    g = g || [];
    if (b2.Rc())
      for (a2 = b2 !== a2.m && b2 !== a2.u, e = !e, b2 = b2.Pf(c2, f2, f2), c2 = b2.length, f2 = 0; f2 < c2; f2++) {
        var h = b2[f2].c;
        var k;
        if (k = void 0 !== d) {
          for (var l = Bd(d), m = h; (k = m.m <= l && m.s >= l) && (m = m.Fa); )
            ;
          k = !k;
        }
        k || !e && !h.wc(true) || (a2 || 1 === h.xb().getState()) && g.push(h);
      }
    return g;
  }
  N.prototype.fi = function() {
    return 0 < this.J.Rc();
  };
  N.prototype.providesOverlays = N.prototype.fi;
  N.prototype.sd = function(a2, b2, c2) {
    return pk(this, this.J, a2, b2, c2, false).filter(function(d) {
      return d.Qc();
    });
  };
  N.prototype.requestOverlays = N.prototype.sd;
  N.prototype.Cc = function() {
    return 0 < this.i.Rc();
  };
  N.prototype.providesSpatials = N.prototype.Cc;
  N.prototype.kg = function(a2, b2, c2) {
    return pk(this, this.i, a2, b2, c2, false);
  };
  N.prototype.requestSpatials = N.prototype.kg;
  N.prototype.mg = function(a2, b2) {
    return pk(this, this.i, a2.Hf(), a2.zL, b2, false);
  };
  N.prototype.requestSpatialsByTile = N.prototype.mg;
  N.prototype.Rb = function() {
    return 0 < this.m.Rc() + this.u.Rc();
  };
  N.prototype.providesMarkers = N.prototype.Rb;
  N.prototype.Ec = function(a2, b2, c2) {
    return qk(this, a2, b2, c2, false);
  };
  N.prototype.requestMarkers = N.prototype.Ec;
  function qk(a2, b2, c2, d, e) {
    var f2 = pk(a2, a2.m, b2, c2, d, e);
    pk(a2, a2.u, b2, c2, d, e, f2);
    return f2;
  }
  N.prototype.Qb = function() {
    return 0 < this.P.Rc() + this.T.Rc();
  };
  N.prototype.providesDomMarkers = N.prototype.Qb;
  N.prototype.Dc = function(a2, b2, c2) {
    return rk(this, a2, b2, c2, false);
  };
  N.prototype.requestDomMarkers = N.prototype.Dc;
  function rk(a2, b2, c2, d, e) {
    var f2 = pk(a2, a2.P, b2, c2, d, e);
    pk(a2, a2.T, b2, c2, d, e, f2);
    return f2;
  }
  function sk(a2, b2, c2) {
    var d = c2.ga(), e, f2 = tk.bind(null, a2);
    a2 = uk.bind(null, a2);
    C(c2, th) ? e = C(d, L) ? f2(d) : d.la.some(f2) : C(c2, uh) ? e = C(d, O) ? a2(d) : d.la.some(a2) : C(c2, sh) && (e = a2(Ci(d)));
    e && b2.push(c2);
  }
  function tk(a2, b2) {
    a: {
      var c2 = b2.$;
      var d = Hi(a2, b2);
      if (!d) {
        b2 = b2.$.length;
        for (var e = 0; e < b2; e += 3)
          if (Fi(a2, c2[e], c2[e + 1])) {
            a2 = true;
            break a;
          }
      }
      a2 = d;
    }
    return a2;
  }
  function uk(a2, b2) {
    return Ii(a2, b2);
  }
  function vk(a2, b2, c2) {
    for (var d = a2.length; d--; ) {
      var e = a2[d], f2 = e.ga();
      if (C(f2, Vi)) {
        f2 = f2.la;
        for (var g = f2.length, h; g--; )
          if (h = f2[g], Fi(b2, h.lat, h.lng)) {
            c2.push(e);
            break;
          }
      } else
        Fi(b2, f2.lat, f2.lng) && c2.push(e);
    }
  }
  N.prototype.Ua = function(a2, b2, c2, d, e) {
    var f2 = this, g = a2.K(), h = [], k = Zb(), l = 1;
    if (g)
      for (; l & nh.ANY; ) {
        if (l & d)
          switch (l) {
            case nh.MARKER:
              k = k.then(function() {
                return qk(f2, g, c2, b2, true);
              }).then(function(m) {
                return vk(m, a2, h);
              });
              break;
            case nh.DOM_MARKER:
              k = k.then(function() {
                return rk(f2, g, c2, b2, true);
              }).then(function(m) {
                return vk(m, a2, h);
              });
              break;
            case nh.SPATIAL:
              k = k.then(function() {
                return pk(f2, f2.i, g, c2, b2, true);
              }).then(function(m) {
                m.forEach(sk.bind(null, a2, h));
              });
              break;
            case nh.OVERLAY:
              k = k.then(function() {
                return pk(f2, f2.J, g, c2, b2, true);
              }).then(function(m) {
                m.forEach(sk.bind(
                  null,
                  a2,
                  h
                ));
              });
          }
        l <<= 1;
      }
    k.then(function() {
      return e(h);
    });
  };
  N.prototype.ld = function(a2, b2, c2) {
    c2 = c2 || jf;
    var d = c2.zoom, e = c2.visiblesOnly;
    c2 = c2.types;
    var f2 = nh.ANY;
    C(a2, O, this.ld, 0, "area");
    zc(b2, "Function", this.ld, 1, "callback");
    zc(d, "Number", this.ld, 2, "options");
    this.Ua(a2, vc(e) ? !!e : true, d, vc(c2) ? c2 & f2 : f2, b2);
  };
  N.prototype.getObjectsWithin = N.prototype.ld;
  N.prototype.o = function() {
    N.j.o.call(this);
    this.f.na();
  };
  var wk = { PENDING: 0, ACTIVE: 1, DONE: 2 };
  t("H.map.render.RenderState", wk);
  function xk(a2, b2) {
    b2 = b2 || {};
    var c2;
    if (!C(a2, Element))
      throw new D(xk, 0, a2);
    var d = a2.ownerDocument.createElement("div");
    this.S = a2;
    xk.j.constructor.call(this);
    this.padding = new yk(0, 0, 0, 0);
    this.center = new J(0, 0);
    this.margin = 0;
    this.element = d;
    d.style.zIndex = 0;
    d.style.height = d.style.width = "100%";
    d.style.direction = "ltr";
    d.style.position = "relative" === a2.style.position ? "absolute" : "relative";
    this.resize();
    a2.appendChild(d);
    (c2 = b2.padding) !== B && this.wi(c2.top, c2.right, c2.bottom, c2.left);
    this.ri((c2 = b2.margin) !== B ? c2 : 0);
  }
  u(xk, F);
  t("H.map.ViewPort", xk);
  xk.prototype.A = { za: "update", le: "sync" };
  xk.prototype.ri = function(a2) {
    if (this.margin !== +a2) {
      if (E(this.margin = +a2))
        throw new D(this.ri, 0, a2);
      zk(this);
      this.dispatchEvent(this.A.za);
    }
  };
  xk.prototype.setMargin = xk.prototype.ri;
  xk.prototype.wi = function(a2, b2, c2, d) {
    var e = this.padding;
    if (e.top !== a2 || e.right !== b2 || e.bottom !== c2 || e.left !== d) {
      if (E(a2 + b2 + c2 + d))
        throw new D(this.wi);
      e.top = a2;
      e.right = b2;
      e.bottom = c2;
      e.left = d;
      zk(this);
      this.dispatchEvent(this.A.za);
    }
  };
  xk.prototype.setPadding = xk.prototype.wi;
  function zk(a2) {
    var b2 = a2.padding;
    a2.center.set((a2.width + b2.left - b2.right) / 2 << 0, (a2.height + b2.top - b2.bottom) / 2 << 0);
  }
  xk.prototype.resize = function() {
    var a2 = this.S.offsetWidth, b2 = this.S.offsetHeight;
    if (this.width !== a2 || this.height !== b2)
      this.a = new Wi(this.width, this.height), this.width = a2, this.height = b2, zk(this), this.dispatchEvent(this.A.za);
  };
  xk.prototype.resize = xk.prototype.resize;
  xk.prototype.$a = function(a2) {
    this.dispatchEvent(new dj(this.A.le, this.a, a2, ej.SIZE));
  };
  xk.prototype.synchronize = xk.prototype.$a;
  xk.prototype.o = function() {
    this.S.removeChild(this.element);
    delete this.S;
    delete this.element;
    xk.j.o.call(this);
  };
  xk.prototype.lc = Qc;
  xk.prototype.startInteraction = xk.prototype.lc;
  xk.prototype.cc = Qc;
  xk.prototype.interaction = xk.prototype.cc;
  xk.prototype.wb = Qc;
  xk.prototype.endInteraction = xk.prototype.wb;
  function Ak(a2, b2, c2, d, e, f2) {
    var g;
    for (g = []; d <= e; d++)
      g = g.concat(Bk(a2, c2, d));
    a2 = g.length;
    xj.call(this, f2, a2);
    this.l = c2 = [];
    this.f = A(this.f, this);
    this.c = A(this.c, this);
    for (this.O(1); a2--; )
      f2 = g[a2], c2.push(Ck(b2, f2[0], f2[1], f2[2], this.f, this.c));
  }
  u(Ak, xj);
  Ak.prototype.f = function() {
    zj(this, 2);
  };
  Ak.prototype.c = function() {
    zj(this, 4);
  };
  Ak.prototype.oe = function() {
    for (var a2 = this.l, b2 = a2.length; b2--; )
      a2[b2].cancel();
    delete this.l;
  };
  function Dk(a2, b2) {
    var c2 = this;
    if (!Da(b2))
      throw new D(Ek, 1, b2);
    if (!Da(a2.next || Da(a2.cycle)))
      throw new D(Dk, 2, 'Argument "mode" must implement H.util.AsyncQueue.Mode');
    this.b = [];
    this.c = [];
    this.g = a2;
    this.i = b2;
    this.l = function() {
      Fk(c2);
    };
    this.a = null;
    this.f = function() {
      c2.a || (c2.a = x.setTimeout(c2.l, 1));
    };
  }
  t("H.util.AsyncQueue", Dk);
  Dk.prototype.push = function(a2, b2) {
    if (!Da(b2))
      throw new D(this.push, 1, b2);
    a2 = Gk(new Hk(), a2, this.f, b2);
    this.b.push(a2);
    this.f();
    return a2;
  };
  Dk.prototype.push = Dk.prototype.push;
  function Fk(a2) {
    var b2 = a2.c, c2 = 0, d = a2.g;
    d.a();
    for (a2.a = null; c2 < b2.length; ) {
      var e = b2[c2];
      e.Tj ? b2.splice(c2, 1) : c2++;
    }
    for (; e = d.next(a2.b, a2.c); )
      e.cancelled ? e.done(null, "cancelled") : (b2.push(e), a2.i(e, e.data));
  }
  function Hk() {
    Gk(this, null, null, null);
  }
  Dk.Task = Hk;
  function Gk(a2, b2, c2, d) {
    a2.data = b2;
    a2.cancelled = false;
    a2.Tj = false;
    a2.b = c2;
    a2.c = d;
    a2.a = null;
    return a2;
  }
  Hk.prototype.done = function(a2, b2) {
    this.Tj = true;
    this.b();
    this.c(this, a2, b2);
  };
  Hk.prototype.done = Hk.prototype.done;
  Hk.prototype.cancel = function() {
    this.a && this.a();
    this.cancelled = true;
  };
  Hk.prototype.cancel = Hk.prototype.cancel;
  Hk.prototype.vo = function(a2) {
    this.a = a2;
    return this;
  };
  Hk.prototype.setCancelFn = Hk.prototype.vo;
  function Ik() {
  }
  Dk.Mode = Ik;
  Ik.prototype.next = function() {
  };
  Ik.prototype.a = function() {
  };
  var Jk, Kk = function() {
    function a2() {
    }
    for (var b2, c2, d, e = tc("o ms moz webkit "), f2 = 5; f2-- && !b2; )
      b2 = e[f2], b2 = (c2 = x[b2 + (b2 ? "R" : "r") + "equestAnimationFrame"]) && !E(c2.call(window, a2)) && (d = x[b2 + (b2 ? "C" : "c") + "ancelAnimationFrame"]);
    Jk = b2 ? function(g) {
      return c2.call(x, g);
    } : function(g) {
      return x.setTimeout(g, 25);
    };
    return b2 ? function(g) {
      return d.call(x, g);
    } : function(g) {
      return x.clearTimeout(g);
    };
  }(), Lk = x.performance && x.performance.now ? function() {
    return x.performance.now();
  } : function() {
    return x.Date.now();
  };
  function Mk(a2, b2) {
    Mk.j.constructor.call(this, new Nk(a2), b2);
  }
  u(Mk, Dk);
  t("H.util.SequentialQueue", Mk);
  function Nk(a2) {
    if (isNaN(a2) || 0 > a2)
      throw new D(Mk, 1, 'Argument "maxTime" must be a positive number');
    this.c = a2;
    this.b = Lk();
  }
  Nk.prototype.next = function(a2) {
    return a2.length && Lk() - this.b < this.c ? a2 = a2.shift() : null;
  };
  Nk.prototype.a = function() {
    this.b = Lk();
  };
  function Ok(a2) {
    xc(this, Ok);
    Ok.j.constructor.call(this, a2);
    if (a2 && "tileSize" in a2) {
      var b2 = Ed(+a2.tileSize) / Od;
      if (isNaN(b2) || b2 % 1 || 0 > b2 || 30 < b2)
        throw new D(Ok, 0, "tileSize: " + a2.tileSize);
      this.tileSize = +a2.tileSize;
    }
  }
  u(Ok, P);
  t("H.map.provider.TileProvider", Ok);
  function Pk(a2, b2) {
    return Yd(a2) - 8 - Ad(Yd(b2));
  }
  Ok.getZoomLevelOffset = Pk;
  Ok.prototype.requestTile = Ok.prototype.Ha;
  Ok.prototype.cancelTile = Ok.prototype.mc;
  Ok.prototype.cancelTileByKey = Ok.prototype.pe;
  Ok.prototype.createTileInternal = Ok.prototype.ac;
  Ok.prototype.uc = function(a2, b2, c2) {
    return this.uri.concat("_", a2, "_", b2, "_", c2);
  };
  Ok.prototype.getTileKey = Ok.prototype.uc;
  Ok.prototype.kf = 256;
  Ok.prototype.tileSize = Ok.prototype.kf;
  function Qk() {
  }
  t("H.util.ICache", Qk);
  Qk.prototype.add = function() {
  };
  Qk.prototype.add = Qk.prototype.add;
  Qk.prototype.get = function() {
  };
  Qk.prototype.get = Qk.prototype.get;
  Qk.prototype.zf = function() {
  };
  Qk.prototype.drop = Qk.prototype.zf;
  Qk.prototype.forEach = function() {
  };
  Qk.prototype.forEach = Qk.prototype.forEach;
  Qk.prototype.na = function() {
  };
  Qk.prototype.removeAll = Qk.prototype.na;
  Qk.prototype.$d = function() {
  };
  Qk.prototype.registerOnDrop = Qk.prototype.$d;
  Qk.prototype.Ug = function() {
  };
  Qk.prototype.deRegisterOnDrop = Qk.prototype.Ug;
  function Rk(a2, b2, c2) {
    this.g = [];
    b2 && this.$d(b2);
    if (c2 && !Da(c2))
      throw new D(Rk, 2, c2);
    this.b = 0;
    this.filter = c2;
    this.a = {};
    this.f = this.c = null;
    this.ti(a2);
  }
  t("H.util.Cache", Rk);
  Rk.prototype.add = function(a2, b2, c2) {
    var d, e;
    c2 = +c2;
    if (!Fc(c2) || 0 > c2)
      throw new D(this.add, 2, c2);
    a2 = String(a2);
    if (e = this.filter ? this.filter(a2, b2, c2) : true)
      (d = this.a[a2]) ? (d.data !== b2 && Sk(this, d), this.b += c2 - d.size, d.size = c2, d.data = b2, Tk(this, d)) : this.a[a2] = Uk(this, { id: a2, data: b2, size: c2, fc: null, Zc: null }, this.c), Vk(this);
    return e;
  };
  Rk.prototype.add = Rk.prototype.add;
  Rk.prototype.$d = function(a2) {
    if (!Da(a2))
      throw new D(this.$d, 0, a2);
    this.g.push(a2);
  };
  Rk.prototype.registerOnDrop = Rk.prototype.$d;
  Rk.prototype.Ug = function(a2) {
    this.g = this.g.filter(function(b2) {
      return b2 !== a2;
    });
  };
  Rk.prototype.deRegisterOnDrop = Rk.prototype.Ug;
  Rk.prototype.get = function(a2, b2) {
    return (a2 = b2 ? this.a[a2] : Tk(this, this.a[a2])) && a2.data;
  };
  Rk.prototype.get = Rk.prototype.get;
  Rk.prototype.zf = function(a2) {
    var b2;
    (b2 = this.a[a2]) && Wk(this, b2, true);
  };
  Rk.prototype.drop = Rk.prototype.zf;
  Rk.prototype.forEach = function(a2, b2, c2) {
    var d;
    for (d in this.a) {
      var e = this.a[d];
      (c2 ? c2(d, e.data, e.size) : 1) && a2.call(b2, d, e.data, e.size);
    }
  };
  Rk.prototype.forEach = Rk.prototype.forEach;
  Rk.prototype.na = function(a2) {
    var b2;
    for (b2 in this.a) {
      var c2 = this.a[b2];
      (a2 ? a2(b2, c2.data, c2.size) : 1) && Wk(this, this.a[b2], true);
    }
  };
  Rk.prototype.removeAll = Rk.prototype.na;
  Rk.prototype.ti = function(a2) {
    if (!(0 < +a2))
      throw new D(Rk.prototype.ti, 0, a2);
    this.i = +a2;
    Vk(this);
    return this;
  };
  Rk.prototype.setMaxSize = Rk.prototype.ti;
  Rk.prototype.Cm = function() {
    return this.i;
  };
  Rk.prototype.getMaxSize = Rk.prototype.Cm;
  Rk.prototype.Xl = function() {
    return this.b;
  };
  Rk.prototype.getCurrentSize = Rk.prototype.Xl;
  function Tk(a2, b2) {
    b2 && (a2.c = Uk(a2, b2, a2.c));
    return b2;
  }
  function Vk(a2) {
    for (; a2.b > a2.i && a2.f; )
      Wk(a2, a2.f, true);
  }
  function Uk(a2, b2, c2) {
    if (c2 !== b2) {
      (b2.fc || b2.Zc) && Wk(a2, b2, false);
      if (b2.fc = c2)
        b2.Zc = c2.Zc, c2.Zc = b2;
      b2.Zc || (a2.c = b2);
      b2.fc || (a2.f = b2);
      a2.b += b2.size;
    }
    return b2;
  }
  function Wk(a2, b2, c2) {
    var d = b2.Zc, e = b2.fc;
    if (d || e || b2 == a2.c && b2 == a2.f)
      d ? d.fc = e : a2.c = e, e ? e.Zc = d : a2.f = d, a2.b -= b2.size, c2 && (delete a2.a[b2.id], Sk(a2, b2));
    b2.fc = b2.Zc = null;
  }
  function Sk(a2, b2) {
    for (var c2 = a2.g.length; c2--; )
      a2.g[c2].call(a2, b2.id, b2.data, b2.size);
  }
  ;
  function Xk(a2, b2, c2, d) {
    this.key = "";
    this.x = a2;
    this.y = b2;
    this.z = c2;
    this.data = d;
    this.valid = true;
  }
  t("H.map.provider.Tile", Xk);
  function Yk(a2, b2, c2, d) {
    a2 -= c2;
    b2 -= d;
    return a2 * a2 + b2 * b2;
  }
  function Zk(a2, b2, c2) {
    return $k(a2, b2 * b2, c2 || 0, 0, a2.length - 1);
  }
  t("H.math.simplifyDP", Zk);
  function $k(a2, b2, c2, d, e) {
    var f2 = 0, g = d, h = a2[d].x, k = a2[d].y, l = a2[e].x, m = a2[e].y, n = d + 1, q = Yk(h, k, l, m);
    if (q)
      for (; n < e; ) {
        var r = a2[n++];
        var v = r.x;
        r = r.y;
        var w = ((v - h) * (l - h) + (r - k) * (m - k)) / q;
        v = 0 > w ? Yk(v, r, h, k) : 1 < w ? Yk(v, r, l, m) : Yk(v, r, h + w * (l - h), k + w * (m - k));
        v > f2 && (f2 = v, g = n - 1);
      }
    else
      for (; n < e; )
        r = a2[n++], v = r.x, r = r.y, v = Yk(v, r, h, k), v > f2 && (f2 = v, g = n - 1);
    f2 >= b2 || 0 < c2 && g - d ? (--c2, 1 < g - d ? (d = $k(a2, b2, c2, d, g), d.splice(d.length - 1, 1)) : d = [a2[d]], d = 1 < e - g ? d.concat($k(a2, b2, c2, g, e)) : d.concat(a2.slice(g, e + 1))) : d = [a2[d], a2[e]];
    return d;
  }
  ;
  function al(a2, b2, c2, d, e, f2, g, h) {
    al.j.constructor.call(this, b2, c2, d, null);
    this.key = a2;
    this.U = h;
    this.a = e;
    this.g = f2;
    this.i = {};
    this.zL = g;
    this.m = Cd(wh.MAX_LINE_WIDTH / 2 * this.g + 1);
  }
  u(al, Xk);
  t("H.map.provider.SpatialTile", al);
  al.prototype.c = Xd;
  al.prototype.u = Xd;
  al.prototype.b = Xd;
  function bl(a2) {
    return a2.U.getInvalidations(nh.SPATIAL);
  }
  function cl(a2) {
    var b2 = bl(a2), c2 = b2.a, d = a2.c, e = d === c2, f2;
    if (!(e || b2.Rj(d) || b2.yh(d))) {
      e = a2.f;
      var g = a2.i;
      if (b2.Sf(d))
        for (f2 = e.length; f2--; ) {
          var h = e[f2];
          if (h.Kb().Sf(d)) {
            e.splice(f2, 1);
            var k = k || dl(a2, h.cb());
          }
        }
      if (b2.zh(d)) {
        for (f2 = e.length; f2--; )
          if (h = e[f2], h.Kb().zh(d)) {
            var l = 1;
            if ((h = g[h.cb()]) && h.a) {
              k = 1;
              break;
            }
          }
        l && e.sort(el);
      }
      if (!k && b2.Vd(d)) {
        for (f2 = e.length; f2--; )
          if (e[f2].Kb().Vd(d)) {
            var m = 1;
            break;
          }
      }
      a2.u !== d || m || (a2.u = c2, a2.b !== d || k || (a2.b = c2));
      a2.c = c2;
      e = true;
    }
    return e;
  }
  al.prototype.Ud = function() {
    var a2 = bl(this), b2 = a2.a, c2 = this.b, d = c2 === b2;
    d || (this.U.qa && !a2.Vd(c2) ? d = true : cl(this) && (d = this.b === b2));
    return d;
  };
  al.prototype.isCanvasValid = al.prototype.Ud;
  Object.defineProperty(al.prototype, "valid", { get: function() {
    return this.Ud();
  }, set: ld, configurable: true });
  function fl(a2, b2) {
    this.b = a2;
    this.a = b2;
  }
  function dl(a2, b2) {
    a2 = a2.i;
    var c2 = a2[b2];
    if (c2)
      return delete a2[b2], c2.a;
  }
  al.prototype.f = hf;
  function gl(a2) {
    var b2 = bl(a2), c2 = a2.c, d = a2.f, e;
    if (!cl(a2)) {
      for (e = d.length; e--; ) {
        var f2 = d[e];
        var g = f2.Kb();
        (g.Sf(c2) || g.yh(c2)) && dl(a2, f2.cb());
      }
      a2.f = a2.U.requestSpatialsByTile(a2, false, false).sort(el);
      a2.c = b2.a;
    }
  }
  function el(a2, b2) {
    return oh(a2.Uc(), b2.Uc(), false);
  }
  al.prototype.Ua = function() {
    return this.f;
  };
  al.prototype.getObjects = al.prototype.Ua;
  al.prototype.$m = function() {
    return this.a;
  };
  al.prototype.getTileSize = al.prototype.$m;
  var hl = {};
  al.prototype.Le = function() {
    var a2 = this.a + "_" + this.g, b2 = hl[a2];
    if (!b2) {
      b2 = -this.m;
      var c2 = this.a - b2;
      b2 = hl[a2] = new yk(b2, b2, c2, c2);
    }
    return b2;
  };
  al.prototype.getPxClipRect = al.prototype.Le;
  al.prototype.Hf = function() {
    var a2 = this.mb;
    if (!a2) {
      var b2 = this.Jf();
      a2 = 0;
      var c2 = this.a;
      this.z && (c2 -= a2 += this.Le().top);
      a2 = this.mb = sg(b2.Re(new J(a2, a2)), b2.Re(new J(c2, c2)));
    }
    return a2;
  };
  al.prototype.getGeoClipRect = al.prototype.Hf;
  al.prototype.Jf = function() {
    var a2 = this.J;
    if (!a2) {
      var b2 = this.a;
      a2 = this.J = new nj(B, b2);
      a2.Oa(this.z);
      a2.x = this.x * b2;
      a2.y = this.y * b2;
    }
    return a2;
  };
  al.prototype.getPxProj = al.prototype.Jf;
  al.prototype.Xa = function() {
    return this.g;
  };
  al.prototype.getPixelRatio = al.prototype.Xa;
  al.prototype.gg = function() {
    var a2 = this.data;
    a2 && (this.data = null, this.b = Xd);
    return a2;
  };
  al.prototype.releaseCanvas = al.prototype.gg;
  al.prototype.hg = function() {
    this.i = {};
    delete this.f;
    this.c = Xd;
  };
  al.prototype.releaseData = al.prototype.hg;
  al.prototype.W = function(a2) {
    var b2 = a2.getContext("2d"), c2, d, e, f2, g = 0;
    gl(this);
    if (this.b < this.c) {
      var h = this.f;
      if (c2 = h.length) {
        a2.width = a2.height = this.a;
        b2.clearRect(0, 0, this.a, this.a);
        var k = this.i;
        for (d = 0; d < c2; d++) {
          var l = h[d];
          var m = l.cb();
          if (f2 = (e = k[m]) ? e.b : l.getGeometriesForTile(this)) {
            if (e)
              l.Kb().Vd(this.b) && (e.a = Ih(l, f2)), e = e.a;
            else {
              e = Ih(l, f2);
              var n;
              var q = f2;
              for (var r = l.g ? 2 : 0, v = q.length; v--; ) {
                var w = q[v];
                if (w !== Jh) {
                  var y = w.a;
                  for (n = y.length; n--; )
                    w = y[n], 4 < w.length && (y[n] = Zk(w, 0.6, r));
                }
              }
              this.i[m] = new fl(f2, e);
            }
            if (e) {
              b2.save();
              q = l.g ? this.D : this.P;
              for (m = 0; m < f2.length; m++)
                q.call(this, l, f2[m], l.V(), b2);
              if (f2 = l.getLabels(this))
                for (l = b2, m = f2.length; m--; )
                  for (r = f2[m], q = r.size, l.font = q + "px " + r.font, l.fillStyle = r.color, l.textAlign = "center", l.translate(r.x, r.y), l.rotate(r.angle), q = r.lineHeight || 1.375 * q, v = r.lines, r = v.length; r--; )
                    l.fillText(v[r], 0, r * q);
              b2.restore();
            }
            g |= +e;
          }
        }
      }
      this.data = g ? a2 : null;
      this.u = this.b = this.c;
    } else
      this.data && (g = 1);
    return 0 < g;
  };
  al.prototype.render = al.prototype.W;
  al.prototype.data = null;
  al.prototype.P = function(a2, b2, c2, d) {
    var e;
    c2.b && (il(d, c2, this.g), jl(b2, d, false, true, false, this.a, this.m));
    c2.a && (e = a2.c) && e.Ob && (kl(d, e), ll(this, d, b2, e, c2.lineWidth));
  };
  al.prototype.D = function(a2, b2, c2, d) {
    var e = c2.Ob, f2 = c2.b, g, h = this.a, k = this.m;
    if (b2 === Jh)
      e && (kl(d, c2), d.fillRect(0, 0, h, h));
    else {
      f2 && il(d, c2, this.g);
      if (c2.a && (g = a2.c)) {
        var l = c2.lineWidth;
        g.Ob || (g = null);
      }
      a2 = b2.c;
      if (a2 === Wd) {
        if (f2 || e)
          kl(d, c2), jl(b2, d, true, f2, e, h, this.m);
        g && (kl(d, g), ll(this, d, b2, g, l, 0));
      } else
        e && (kl(d, c2), jl(b2, d, true, false, e, h, k, 0, a2)), f2 && jl(b2, d, false, f2, false, h, k, a2), g && (kl(d, g), ll(this, d, b2, g, l, a2));
    }
  };
  function jl(a2, b2, c2, d, e, f2, g, h, k) {
    var l = a2.a, m = -g;
    g = f2 + g;
    h = h || 0;
    k === B && (k = l.length);
    if (e && a2 === Jh)
      b2.fillRect(0, 0, f2, f2);
    else if (k > h) {
      b2.beginPath();
      for (f2 = h; f2 < k; f2++) {
        var n = l[f2];
        var q = n.length;
        if (n === Qh)
          b2.moveTo(m, m), b2.lineTo(m, g), b2.lineTo(g, g), b2.lineTo(g, m);
        else {
          var r = n[0];
          b2.moveTo(r.x, r.y);
          for (h = 1; h < q; h++)
            r = n[h], b2.lineTo(r.x, r.y);
        }
        c2 && b2.closePath();
      }
      c2 && e && b2.fill(a2.b !== Wd ? "evenodd" : "nonzero");
      d && b2.stroke();
    }
  }
  function il(a2, b2, c2) {
    var d;
    a2.strokeStyle = b2.strokeColor;
    a2.lineWidth = b2.lineWidth * c2;
    a2.lineCap = b2.lineCap;
    a2.lineJoin = b2.lineJoin;
    a2.miterLimit = b2.miterLimit;
    a2.setLineDash && (d = b2.lineDash) !== hf && (a2.setLineDash(d), a2.lineDashOffset = b2.lineDashOffset);
  }
  function kl(a2, b2) {
    a2.fillStyle = b2.fillColor;
  }
  function ll(a2, b2, c2, d, e, f2) {
    var g = e * d.width / 2;
    e = e * d.length / 2;
    var h = e / 2;
    d = 2 * e * d.frequency;
    var k = Fd(Gd(e, 2) + Gd(g, 2));
    a2 = a2.a - k;
    a2 = new yk(k, k, a2, a2);
    c2 = c2.a;
    var l, m, n, q, r, v, w, y = Pd / 2;
    f2 = f2 || 0;
    for (k = c2.length; k-- > f2; ) {
      var G = 0;
      var I = c2[k];
      if (m = l = I.length) {
        var Q = I;
        m = Q.length;
        for (n = 0; --m; )
          n += Q[m].Wa(Q[m - 1]);
        m = (Q = n) >= d;
      }
      if (m)
        for (m = yd(Bd(Q / d), 1e3), m = Q / (m + 1), n = m / 2; --l; ) {
          for (q = (r = I[l]).Wa(v = I[l - 1]); n <= G + q; ) {
            var V = r.x + (v.x - r.x) * (w = (n - G) / q);
            w = r.y + (v.y - r.y) * w;
            a2.vf(V, w) && (b2.save(), b2.translate(V, w), b2.rotate(-Md((v.y - r.y) / (r.x - v.x)) + (r.x < v.x ? y : -y)), b2.beginPath(), b2.moveTo(-g, -e), b2.lineTo(0, e), b2.lineTo(g, -e), b2.lineTo(0, -h), b2.closePath(), b2.fill(), b2.restore());
            n += m;
          }
          G += q;
        }
    }
  }
  var ml = [];
  al.prototype.Ea = function(a2, b2, c2) {
    for (var d = this.f, e = d.length, f2, g, h, k, l, m, n = hf, q, r = this.g; e--; )
      if (g = d[e], g.wc(true) && (h = this.i[g.cb()]) && (k = h.b)) {
        f2 = g.V();
        m = "none" !== f2.fillColor && g.g;
        q = "none" === f2.strokeColor ? 0 : f2.lineWidth * r;
        for (f2 = k.length; f2--; ) {
          l = k[f2];
          var v;
          if (!(v = m && l === Jh) && (v = m || q)) {
            var w;
            v = a2;
            var y = b2, G = m, I = q, Q = l.b, V = l.c, Ba = V !== Wd, ha = l.a, rb = ha.length, Fa = 0, bc = 0, ad = false;
            for (l = 0; l < rb; l++) {
              var wc = ha[l];
              var Jb = l >= V;
              var mg = !Jb && l >= Q;
              if (wc === Qh && G)
                mg ? Fa++ : bc++;
              else {
                var pd = wc.length;
                ml.length = 2 * pd;
                for (w = 0; w < pd; w++) {
                  var Cq = wc[w];
                  ml[2 * w] = Cq.x;
                  ml[2 * w + 1] = Cq.y;
                }
                w = G && !Jb;
                Jb = Ba && !Jb ? 0 : I;
                if (w || Jb) {
                  if (Jb = ee(v, y, ml, Jb, w), Jb === de.EDGE || Jb === de.VERTEX) {
                    ad = true;
                    break;
                  } else if (Jb === de.SURFACE) {
                    if (mg)
                      Fa++;
                    else if (bc++, Q === Wd)
                      break;
                  }
                }
              }
            }
            v = ad || 0 < bc && !(Fa % 2);
          }
          if (v) {
            n === hf && (n = []);
            n.push(g);
            break;
          }
        }
        if (c2 && n.length)
          break;
      }
    return n;
  };
  function nl(a2, b2) {
    var c2;
    nl.j.constructor.call(this, b2);
    this.D = a2;
    this.P = a2 = b2.pixelRatio;
    this.tileSize = c2 = 1 << Ad(Yd((b2.tileSize || 256) * a2));
    this.L = Pk(c2, a2);
    this.Gh = A(this.Gh, this);
    this.Wh = A(this.Wh, this);
    this.Hh = A(this.Hh, this);
    this.Fh = A(this.Fh, this);
    this.m = A(this.m, this);
    this.D.addEventListener(P.prototype.A.za, this.m, false, this);
    this.f = [];
    this.i = new Rk(b2.tileCacheSize || 256, this.Gh);
    this.l = new Rk(b2.dataCacheSize || 512, this.Wh);
    this.J = new Mk(20, this.Hh);
    this.c = {};
    this.u = Lk();
  }
  u(nl, Ok);
  nl.prototype.m = function(a2) {
    a2 = a2.target;
    a2.type === nh.SPATIAL && this.Va(a2);
  };
  nl.prototype.Ha = function(a2, b2, c2, d) {
    var e = this.getTileKey(a2, b2, c2), f2;
    if (f2 = this.i.get(e, d)) {
      if (d || f2.Ud())
        return f2;
      d || this.i.zf(e);
    }
    if ((f2 = this.l.get(e, d)) && (d || cl(f2)))
      return a2 = this.f.pop() || document.createElement("canvas"), f2.W(a2) || this.f.push(a2), this.i.add(e, f2, 1), f2;
    d || ((f2 = this.c[e]) ? f2.count++ : (f2 = this.J.push([e, a2, b2, c2], this.Fh), f2.count = 1, this.c[e] = f2));
  };
  nl.prototype.requestTile = nl.prototype.Ha;
  nl.prototype.ac = function() {
  };
  nl.prototype.createTileInternal = nl.prototype.ac;
  nl.prototype.mc = function(a2, b2, c2) {
    this.pe(this.getTileKey(a2, b2, c2));
  };
  nl.prototype.cancelTile = nl.prototype.mc;
  nl.prototype.pe = function(a2) {
    var b2;
    if (b2 = this.c[a2])
      b2.count--, b2.count || (b2.cancel(), delete this.c[a2]);
  };
  nl.prototype.cancelTileByKey = nl.prototype.pe;
  p = nl.prototype;
  p.Hh = function(a2, b2) {
    var c2 = b2[0], d = b2[1], e = b2[2], f2 = b2[3];
    c2 = this.i.get(c2) || new al(c2, d, e, f2, this.tileSize, this.P, f2 + this.L, this.D);
    d = c2.data || this.f.pop() || document.createElement("canvas");
    c2.W(d) || this.f.push(d);
    b2.push(c2);
    a2.done(c2);
  };
  p.Fh = function(a2, b2) {
    a2 = a2.data[0];
    b2 && this.i.add(a2, b2, 1);
    delete this.c[a2];
    this.Va();
  };
  p.Gh = function(a2, b2) {
    b2.data && this.f.push(b2.gg());
    this.l.add(a2, b2, 1);
  };
  p.Wh = function(a2, b2) {
    b2.hg();
  };
  p.o = function() {
    for (var a2 in this.c)
      this.c[a2].cancel();
    this.i.na();
    this.l.na();
    this.f.length = 0;
    nl.j.o.call(this);
  };
  function yk(a2, b2, c2, d) {
    this.left = +a2;
    this.top = +b2;
    this.right = +c2;
    this.bottom = +d;
  }
  t("H.math.Rect", yk);
  yk.prototype.set = yk;
  yk.prototype.set = yk.prototype.set;
  yk.prototype.Nb = function() {
    return this.b || (this.b = new J(this.left, this.top));
  };
  yk.prototype.getTopLeft = yk.prototype.Nb;
  yk.prototype.Jb = function() {
    return this.a || (this.a = new J(this.right, this.bottom));
  };
  yk.prototype.getBottomRight = yk.prototype.Jb;
  yk.prototype.vf = function(a2, b2) {
    return this.left <= a2 && this.right >= a2 && this.top <= b2 && this.bottom >= b2;
  };
  yk.prototype.containsXY = yk.prototype.vf;
  function ol(a2, b2) {
    return new yk(a2.x, a2.y, b2.x, b2.y);
  }
  yk.fromPoints = ol;
  yk.prototype.clone = function() {
    return new yk(this.left, this.top, this.right, this.bottom);
  };
  yk.prototype.clone = yk.prototype.clone;
  function pl(a2, b2) {
    b2 = b2 || {};
    if (!a2)
      throw new D(pl, 0, a2);
    this.tileSize = a2.tileSize;
    this.a = {};
    qj.call(this, { min: void 0 !== b2.min ? b2.min : a2.min, max: void 0 !== b2.max ? b2.max : a2.max, minWorldSize: this.tileSize, projection: b2.eg, dark: b2.dark, provider: a2 });
  }
  u(pl, qj);
  t("H.map.layer.BaseTileLayer", pl);
  pl.prototype.Ae = function(a2, b2) {
    var c2 = this.pixelProjection;
    if (!C(a2, K))
      throw new D(this.Ae, 0, a2);
    if (!E(b2)) {
      var d = c2.Jj();
      c2.Oa(b2);
    }
    a2 = ol(c2.ib(a2.Nb()), c2.ib(a2.Jb()));
    !E(d) && c2.Oa(d);
    return a2;
  };
  pl.prototype.geoRectToRect = pl.prototype.Ae;
  pl.prototype.Sd = function(a2, b2) {
    var c2 = Gd(2, Bd(b2)), d = this.tileSize;
    if (!C(a2, yk))
      throw new D(this.Sd, 0, a2);
    if (E(b2 = +b2))
      throw new D(this.Sd, 1, b2);
    b2 = Bd(a2.left / d);
    b2 === c2 && --b2;
    var e = Bd(a2.right / d);
    e === c2 && --e;
    return new yk(b2, ae(Bd(a2.top / d), 0, c2 - 1), e, ae(Bd(a2.bottom / d), 0, c2 - 1));
  };
  pl.prototype.getTileBounds = pl.prototype.Sd;
  pl.prototype.Ha = function(a2, b2, c2, d) {
    return this.ma.requestTile(a2, b2, c2, d);
  };
  pl.prototype.requestTile = pl.prototype.Ha;
  pl.prototype.mc = function(a2, b2, c2) {
    this.ma.cancelTile(a2, b2, c2);
  };
  pl.prototype.cancelTile = pl.prototype.mc;
  pl.prototype.ba = function(a2, b2) {
    return this.ma.getCopyrights ? this.ma.getCopyrights(a2, b2) : null;
  };
  pl.prototype.getCopyrights = pl.prototype.ba;
  function ql(a2, b2, c2, d, e) {
    d = Bd(d);
    var f2 = Gd(2, d), g = b2.left, h = b2.top, k = b2.right;
    c2 = k + (c2 ? f2 + (k === b2.left ? 0 : 1) : 1);
    var l = b2.bottom, m = [];
    if (e) {
      var n = g + (1 + k - g) / 2 + e.x / a2.tileSize - 0.5;
      var q = h + (1 + l - h) / 2 + e.y / a2.tileSize - 0.5;
    }
    for (; g < c2; ) {
      for (h = b2.top; h <= l; )
        a2 = g % f2, m.push([a2, h, d, e ? Dd(n - g) + Dd(q - h) : 0]), h++;
      g++;
    }
    return m;
  }
  function Bk(a2, b2, c2) {
    c2 = Bd(c2);
    a2.pixelProjection.Oa(c2);
    b2 = a2.Ae(b2);
    var d = a2.Sd(b2, c2);
    return ql(a2, d, b2.left > b2.right, c2);
  }
  pl.prototype.Ke = function(a2, b2, c2, d, e, f2) {
    var g, h = [], k, l = this.ma;
    f2 = null != f2 ? f2 : "__default__";
    var m = l.requestTile;
    if (!C(a2, yk))
      throw new D(this.Ke, 0, a2);
    if (E(c2 = +c2))
      throw new D(this.Ke, 1, c2);
    d || (g = {});
    b2 = ql(this, a2, b2, c2, e);
    if (a2 = b2.length)
      for (d || b2.sort(rl), c2 = a2; c2--; )
        e = b2[c2], d || (g[l.uc.apply(l, e)] = true), e[3] = +d, (k = m.apply(l, e)) && h.push(k);
    if (!d) {
      d = g;
      var n;
      g = this.a[f2] || {};
      for (n in g)
        g.hasOwnProperty(n) && g[n] && !d[n] && this.ma.cancelTileByKey(n);
      this.a[f2] = d;
    }
    return { total: a2, tiles: h };
  };
  pl.prototype.getProviderTiles = pl.prototype.Ke;
  function rl(a2, b2) {
    return b2[3] - a2[3];
  }
  ;
  function sl(a2, b2) {
    pl.call(this, a2, b2);
  }
  u(sl, pl);
  t("H.map.layer.TileLayer", sl);
  sl.prototype.td = function(a2, b2, c2, d, e) {
    if (!C(a2, K))
      throw new D(this.td, 0, a2);
    if (E(b2 = +b2))
      throw new D(this.td, 1, b2);
    b2 = Bd(b2);
    this.pixelProjection.Oa(b2);
    a2 = this.Ae(a2);
    var f2 = this.Sd(a2, b2);
    return this.Ke(f2, a2.left > a2.right, b2, c2, d, e);
  };
  sl.prototype.requestTiles = sl.prototype.td;
  function tl(a2, b2) {
    b2 = b2 ? Wa(b2) : {};
    b2.tileSize = b2.tileSize || 256;
    b2.pixelRatio = b2.pixelRatio || Ue();
    b2.max = 24;
    this.a = new nl(a2, b2);
    this.b = new sl(this.a);
    b2.minWorldSize = this.a.tileSize;
    b2.provider = a2;
    tl.j.constructor.call(this, b2);
    this.tileSize = this.b.tileSize;
    this.c = A(this.c, this);
    this.a.addEventListener(this.a.A.za, this.c);
    a2.addEventListener(a2.A.za, this.c);
  }
  u(tl, qj);
  t("H.map.layer.ObjectLayer", tl);
  tl.prototype.c = function(a2) {
    a2.currentTarget !== this.a && a2.target.type === nh.SPATIAL || this.Va();
  };
  var ul = { markers: hf, total: 0 };
  tl.prototype.Ec = function(a2, b2, c2) {
    var d = this.ma, e;
    return d.providesMarkers() && (e = d.requestMarkers(a2, b2, true, c2)).length ? { markers: e, total: e.length } : ul;
  };
  tl.prototype.requestMarkers = tl.prototype.Ec;
  tl.prototype.Dc = function(a2, b2, c2) {
    var d = this.ma, e;
    return d.providesDomMarkers() && (e = d.requestDomMarkers(a2, b2, true, c2)).length ? { markers: e, total: e.length } : ul;
  };
  tl.prototype.requestDomMarkers = tl.prototype.Dc;
  var vl = { tiles: hf, total: 0 };
  tl.prototype.td = function(a2, b2, c2, d) {
    if (this.ma.providesSpatials()) {
      var e = this.b.td(a2, b2, c2, d);
      c2 || (c2 = this.a, e = Lk(), 33 < e - c2.u && (Fk(c2.J), c2.u = e), e = this.b.td(a2, b2, true, d));
    } else
      e = vl;
    return e;
  };
  tl.prototype.requestTiles = tl.prototype.td;
  tl.prototype.Ha = function(a2, b2, c2, d) {
    return this.b.Ha(a2, b2, c2, d);
  };
  tl.prototype.requestTile = tl.prototype.Ha;
  tl.prototype.mc = function(a2, b2, c2) {
    this.b.mc(a2, b2, c2);
  };
  tl.prototype.cancelTile = tl.prototype.mc;
  var wl = { overlays: hf, total: 0 };
  tl.prototype.sd = function(a2, b2, c2) {
    var d = this.ma, e = wl;
    d.providesOverlays && d.providesOverlays() && (a2 = d.requestOverlays(a2, b2, true, c2), b2 = a2.length) && (e = { overlays: a2, total: b2 });
    return e;
  };
  tl.prototype.requestOverlays = tl.prototype.sd;
  tl.prototype.o = function() {
    this.a.F();
    this.b.F();
    this.ma.dispose();
    tl.j.o.call(this);
  };
  function S(a2) {
    xc(this, S);
    S.j.constructor.call(this, a2);
    this.sb = new xl();
    this.ub = A(this.ub, this);
    this.P = yl;
    this.createTileInternal = this.ac.bind(this);
  }
  u(S, Ok);
  t("H.map.provider.RemoteTileProvider", S);
  S.prototype.em = function() {
    return 1;
  };
  S.prototype.getEntryWeight = S.prototype.em;
  var yl, zl = screen.width, Al = screen.height, Bl = Ue();
  Bl = zd(Bl, 1);
  var Cl = Cd(zl * Bl * Al * Bl / 1e6);
  yl = new Rk(Gd(2, zd(8, yd(12, 7 + Cl))));
  var Dl = {}, El = {};
  S.prototype.nb = function() {
    return this.P;
  };
  S.prototype.getCache = S.prototype.nb;
  S.prototype.J = ba(3);
  S.prototype.ub = function(a2) {
    var b2 = this.uri;
    return !a2.indexOf(b2) && "_" === a2.charAt(b2.length);
  };
  S.prototype.cacheFilter = S.prototype.ub;
  S.prototype.wa = function(a2, b2) {
    b2.valid = false;
  };
  S.prototype.reload = function(a2) {
    var b2 = this.getCache();
    a2 ? b2.na(this.ub) : b2.forEach(this.wa, this, this.ub);
    Fl(this);
    this.Va(this, { isReload: true });
  };
  S.prototype.reload = S.prototype.reload;
  S.prototype.l = function() {
    return false;
  };
  S.prototype.MAX_STORE_TIME = Infinity;
  S.prototype.c = function() {
    return this.sb;
  };
  S.prototype.ea = function(a2, b2) {
    b2(a2);
  };
  function Ck(a2, b2, c2, d, e, f2) {
    d = ~~d;
    return a2.requestInternal(b2, c2, d, function(g, h) {
      a2.c().put(a2.uc(b2, c2, d), { raw: h && h.raw || g, timestamp: x.Date.now() }, e, f2);
    }, f2, 0);
  }
  S.prototype.requestInternal = S.prototype.B;
  S.prototype.Ha = function(a2, b2, c2, d) {
    var e = this;
    var f2 = this.getCache();
    if (E(a2 = +a2))
      throw new D(this.Ha, 0, a2);
    if (E(b2 = +b2))
      throw new D(this.Ha, 0, b2);
    if (E(c2 = +c2))
      throw new D(this.Ha, 0, c2);
    c2 = ~~c2;
    var g = this.getTileKey(a2, b2, c2);
    f2 = f2.get(g);
    f2 && f2.valid || d || Dl[g] || (f2 = B, this.requestTileAsPromise(a2, b2, c2, d).then(function(h) {
      e.Va(h);
    }, ld));
    return f2;
  };
  S.prototype.requestTile = S.prototype.Ha;
  S.prototype.Gk = function(a2, b2, c2, d) {
    var e = this, f2 = this.getCache(), g = this.getTileKey(a2, b2, c2), h, k, l = this.c();
    if (El[g])
      return El[g];
    El[g] = h = new Rb(function(m, n) {
      function q(r) {
        var v = 0, w;
        var y = function(G, I) {
          w = e.createTileInternal(a2, b2, c2, G, I);
          w.key = g;
          f2.add(g, w, 1);
          m(w);
          Gl(g);
        };
        r && (v = x.Date.now() - r.timestamp);
        r && v < e.MAX_STORE_TIME ? e.ea(r.raw, y) : (0 < v && l.remove(g), (w = f2.get(g)) && w.valid || d ? m(w || null) : Dl[g] = e.requestInternal(a2, b2, c2, y, n));
      }
      k = l.get(g, q, q);
    });
    Dl[g] || (Dl[g] = k);
    h.then(function() {
      Gl(g);
    }, function() {
      Gl(g);
    });
    return h;
  };
  S.prototype.requestTileAsPromise = S.prototype.Gk;
  S.prototype.Fk = function(a2, b2) {
    var c2 = this, d = a2.id, e = a2.tile.coords;
    return new Rb(function(f2, g) {
      c2.Gk(e.x, e.y, e.z, b2).then(function(h) {
        var k = z;
        h = h.Ua ? h.Ua() : h.data;
        for (var l = h.length, m; l--; )
          if (m = h[l], m.cb() === d) {
            k = m;
            break;
          }
        f2(k);
      }, g);
    });
  };
  S.prototype.requestObjectAsPromise = S.prototype.Fk;
  function Gl(a2) {
    delete Dl[a2];
    delete El[a2];
  }
  function Fl(a2) {
    for (var b2 in Dl)
      a2.ub(b2) && a2.cancelTileByKey(b2);
  }
  var Hl = { cancel: ld };
  S.prototype.ac = function(a2, b2, c2, d) {
    return new Xk(a2, b2, c2, d);
  };
  S.prototype.createTileInternal = S.prototype.ac;
  S.prototype.pe = function(a2) {
    var b2 = Dl[a2];
    b2 && (b2.cancel(), Gl(a2));
  };
  S.prototype.cancelTileByKey = S.prototype.pe;
  S.prototype.mc = function(a2, b2, c2) {
    this.cancelTileByKey(this.getTileKey(a2, b2, c2));
  };
  S.prototype.cancelTile = S.prototype.mc;
  S.prototype.o = function() {
    S.j.o.call(this);
    this.getCache().na(this.ub);
    Fl(this);
  };
  function xl() {
  }
  S.NullStorage = xl;
  xl.prototype.get = function(a2, b2) {
    b2();
    return Hl;
  };
  xl.prototype.get = xl.prototype.get;
  xl.prototype.put = function(a2, b2, c2) {
    c2 && c2();
  };
  xl.prototype.put = xl.prototype.put;
  xl.prototype.clear = function(a2) {
    a2 && a2();
  };
  xl.prototype.clear = xl.prototype.clear;
  xl.prototype.remove = function(a2, b2) {
    b2 && b2();
  };
  xl.prototype.remove = xl.prototype.remove;
  function Ek(a2) {
    Ek.j.constructor.call(this, a2);
    a2 && (this.u = { crossOrigin: a2.crossOrigin || "anonymous", headers: a2.headers || {} }, this.m = a2.getURL);
    if (this.b === kk.HARP && H.map.render.harp) {
      var b2;
      a2 && a2.style && a2.style instanceof H.map.render.harp.Style ? b2 = a2.style : b2 = new H.map.render.harp.Style({ styles: [{ technique: "raster", attr: { gamma: 1, brightness: 1 } }] });
      this.Qa(b2);
    }
    if (!Da(this.m))
      throw new D(Ek, 0, "getURL");
    lk(this, a2.opacity);
    this.f = x.URL || x.webkitURL;
    a2 = this.u.crossOrigin;
    if (!(a2 = "anonymous" === a2 || "use-credentials" === a2)) {
      a2 = this.m(0, 0, 0);
      b2 = window.location;
      var c2 = document.createElement("a");
      c2.href = a2;
      a2 = c2.hostname === b2.hostname && c2.port === b2.port && c2.protocol === b2.protocol;
    }
    (this.T = a2 && !!uf.arraybuffer && !!this.f) && this.nb().$d(A(this.aa, this));
  }
  u(Ek, S);
  t("H.map.provider.ImageTileProvider", Ek);
  Ek.prototype.ic = function(a2) {
    lk(this, a2);
  };
  Ek.prototype.setOpacity = Ek.prototype.ic;
  Ek.prototype.Tc = function() {
    return this.g;
  };
  Ek.prototype.getOpacity = Ek.prototype.Tc;
  Ek.prototype.Ve = ff;
  Ek.prototype.providesRasters = Ek.prototype.Ve;
  Ek.prototype.B = function(a2, b2, c2, d, e, f2) {
    var g = this, h = this.m(a2, b2, c2), k;
    a2 = Hl;
    if (h) {
      var l = x.setTimeout(function() {
        g.T ? (k = new tf("arraybuffer", h, f2, g.u), k.then(function(m) {
          return m.blob();
        }).then(function(m) {
          var n = new Image();
          n.onload = A(d, null, n, { raw: m });
          n.onerror = A(e, null, "bad url");
          try {
            n.src = g.f.createObjectURL(m);
          } catch (q) {
          }
        }, e)) : (k = new tf("image", h, f2, g.u), k.then(d, e));
      }, 150);
      a2 = { cancel: function() {
        k ? k.cancel() : x.clearTimeout(l);
      } };
    } else
      d(null);
    return a2;
  };
  Ek.prototype.requestInternal = Ek.prototype.B;
  Ek.prototype.ea = function(a2, b2) {
    var c2 = new Image();
    c2.onload = function() {
      b2(this);
    };
    c2.src = this.f.createObjectURL(a2);
  };
  Ek.prototype.aa = function(a2, b2) {
    (a2 = b2.data) && a2 instanceof HTMLImageElement && this.f.revokeObjectURL(a2.src);
  };
  Ek.prototype.V = function() {
    return this.Ya();
  };
  Ek.prototype.getStyle = Ek.prototype.V;
  Ek.prototype.gb = function(a2) {
    H.map.render.harp && this.b === kk.HARP && a2 instanceof H.map.render.harp.Style && this.Qa(a2);
  };
  Ek.prototype.setStyle = Ek.prototype.gb;
  t("H.util.events.listenOnce", Fe);
  t("H.util.events.dispatchEvent", function(a2, b2) {
    return a2.dispatchEvent(b2);
  });
  t("H.util.events.fireListeners", function(a2, b2, c2, d) {
    return pe(a2) ? a2.jd(b2, c2, d) : Oe(a2, b2, c2, d);
  });
  t("H.util.events.listen", Ee);
  t("H.util.events.unlisten", Me);
  var Il = Pe;
  Pe = function(a2, b2) {
    var c2, d, e = true;
    var f2 = b2[b2.currentTarget === b2.target ? "AT_TARGET" : a2.capture ? "CAPTURING_PHASE" : (c2 = true, "BUBBLING_PHASE")];
    if (!c2 || "pointerenter" !== (d = b2.type) && "pointerleave" !== d)
      b2.eventPhase = f2, e = Il(a2, b2), c2 && a2.src && a2.src.Mb && null === a2.src.Mb() && delete b2.eventPhase;
    return e;
  };
  function Jl(a2, b2, c2, d) {
    var e = new yk(0, 0, 0, 0);
    Jl.j.constructor.call(this);
    if (!a2)
      throw new D(Jl, 0, a2);
    if (!b2)
      throw new D(Jl, 1, b2);
    if (!c2)
      throw new D(Jl, 2, c2);
    if ("object" !== typeof d)
      throw new D(Jl, 3, d + " is not an object");
    if ("number" !== typeof d.pixelRatio)
      throw new D(Jl, 3, d.pixelRatio + " is not a number");
    this.oa = d.pixelRatio;
    this.zoom = 0;
    this.fb = Ed(this.oa) / Od;
    this.b = new nj();
    this.wa = { 1: e.clone(), 2: e.clone(), 4: e.clone() };
    this.s = new J(0.5, 0.5);
    this.f = a2;
    Kl(this, this.oa);
    this.lc = A(this.lc, this);
    this.cc = A(this.cc, this);
    this.wb = A(this.wb, this);
    a2.startInteraction = this.lc;
    a2.interaction = this.cc;
    a2.endInteraction = this.wb;
    a2.addEventListener(a2.A.za, this.T, false, this);
    this.getCapabilities = this.getCapabilities;
    this.capture = this.capture;
    this.zoomAt = this.xd;
    this.relaunch = this.ha;
    this.dispose = this.F;
    this.screenToGeo = this.Pa;
    this.geoToScreen = this.Da;
    this.screenToLookAtData = this.qg;
    this.J = b2;
    this.kc = A(this.kc, this);
    this.control = A(this.control, this);
    this.vb = A(this.vb, this);
    b2.startControl = this.kc;
    b2.control = this.control;
    b2.endControl = this.vb;
    b2.addEventListener(b2.A.za, this.Kg, false, this);
    this.c = c2;
    this.Zf = A(this.Zf, this);
    this.Me = A(this.Me, this);
    this.Ne = A(this.Ne, this);
    this.Yf = A(this.Yf, this);
    c2.addEventListener(qj.prototype.A.za, this.Zf, false, this);
    c2.addEventListener(c2.A.he, this.Me, false, this);
    c2.addEventListener(c2.A.je, this.Ne, false, this);
    c2.addEventListener(c2.A.ke, this.Yf, false, this);
  }
  u(Jl, F);
  t("H.map.render.RenderEngine", Jl);
  Jl.prototype.xd = function() {
  };
  function Kl(a2, b2) {
    var c2 = a2.f, d = c2.width, e = c2.height, f2 = c2.padding, g = f2.top, h = f2.left, k = f2.bottom;
    f2 = f2.right;
    c2 = c2.margin;
    var l = -(d + h - f2) / 2 << 0, m = -(e + g - k) / 2 << 0;
    d += l;
    e += m;
    a2 = a2.wa;
    a2[1].set((l - c2) * b2, (m - c2) * b2, (d + c2) * b2, (e + c2) * b2);
    a2[2].set(l * b2, m * b2, d * b2, e * b2);
    a2[4].set((l + h) * b2, (m + g) * b2, (d - f2) * b2, (e - k) * b2);
  }
  Jl.prototype.T = function() {
    Kl(this, this.oa);
  };
  Jl.prototype.o = function() {
    var a2 = this.f, b2 = this.J, c2 = this.c;
    a2.removeEventListener(a2.A.za, this.T, false, this);
    a2.startInteraction === this.lc && (a2.startInteraction = xk.prototype.lc);
    a2.interaction === this.cc && (a2.interaction = xk.prototype.cc);
    a2.endInteraction === this.wb && (a2.endInteraction = xk.prototype.wb);
    b2.removeEventListener(b2.A.za, this.Kg, false, this);
    b2.startControl === this.kc && (b2.startControl = Ll.prototype.kc);
    b2.control === this.control && (b2.control = Ll.prototype.control);
    b2.endControl === this.vb && (b2.endControl = Ll.prototype.vb);
    c2.removeEventListener(qj.prototype.A.za, this.Zf, false, this);
    c2.removeEventListener(c2.A.he, this.Me, false, this);
    c2.removeEventListener(c2.A.je, this.Ne, false, this);
    c2.removeEventListener(c2.A.ke, this.Yf, false, this);
  };
  Jl.prototype.mi = function(a2) {
    this.me = a2;
  };
  Jl.prototype.setAnimationCallback = Jl.prototype.mi;
  Jl.prototype.hi = function() {
    this.me = void 0;
  };
  Jl.prototype.resetAnimationCallback = Jl.prototype.hi;
  Jl.prototype.control = function() {
  };
  Jl.prototype.capture = function() {
    return $b(Error("not implemented"));
  };
  function Ml(a2, b2) {
    a2.style.transition = "opacity 1.5s";
    Fe(a2, "transitionend", b2, false);
    a2.style.opacity = 0;
  }
  var Nl = { ZOOM: 1, HEADING: 2, TILT: 4, INCLINE: 8, COORD: 16 };
  Jl.InteractionModifiers = Nl;
  p = Jl.prototype;
  p.A = { Vi: "render" };
  p.Zf = function(a2) {
    this.nk(a2);
    this.ha();
  };
  p.Me = function(a2) {
    this.Pe(a2.idx, a2.added);
  };
  p.Ne = function(a2) {
    this.Xh(a2.idx, a2.removed, a2.type === this.c.A.ke);
  };
  p.Yf = function(a2) {
    a2.removed && this.Ne(a2);
    this.Me(a2);
  };
  p.nk = ld;
  p.Pe = function(a2, b2) {
    this.th(a2, b2);
    0 === a2 && this.Eb();
    C(b2, qj) && Ol(this, b2, true);
    this.ce();
    this.ha();
  };
  p.Eb = function() {
    var a2 = this.c.La();
    if (0 < a2.length) {
      var b2 = a2[0].max;
      this.Eg = a2[0].min;
      this.Dg = b2;
    } else
      a2 = this.getCapabilities().lookAt.zoom, b2 = a2.max, this.Eg = a2.min, this.Dg = b2;
    a2 = Pl(this, this.zoom);
    a2 !== this.zoom && (this.zoom = a2, this.b.Oa(a2), this.$a());
  };
  p.$a = function(a2) {
    this.P = this.jb();
    a2 && (this.P.position = a2);
    this.P.zoom = this.zoom - this.fb;
    this.P.position.alt = 0;
  };
  p.dl = 0;
  p.heading = 180;
  p.jb = function() {
    return Ql(this, { position: this.b.projection.dg(this.s), zoom: this.zoom, tilt: this.dl, heading: this.heading });
  };
  function Ql(a2, b2) {
    b2.tilt = Rl(a2, b2.tilt);
    b2.heading = Sl(a2, b2.heading);
    b2.incline = a2.getCapabilities().lookAt.incline.min;
    return b2;
  }
  function Pl(a2, b2) {
    var c2 = a2.getCapabilities().lookAt.zoom;
    return ae(b2, zd(c2.min, a2.Eg), yd(c2.max, a2.Dg));
  }
  function Rl(a2, b2) {
    a2 = a2.getCapabilities().lookAt.tilt;
    return ae(b2, a2.min, a2.max);
  }
  function Sl(a2, b2) {
    a2 = a2.getCapabilities().lookAt.heading;
    return ae((b2 % 360 + 360) % 360, a2.min, a2.max);
  }
  function Ol(a2, b2, c2) {
    c2 = c2 ? b2.addEventListener : b2.removeEventListener;
    c2.call(b2, b2.A.Ti, a2.Yh, false, a2);
    c2.call(b2, b2.A.Si, a2.Yh, false, a2);
  }
  p.th = ld;
  p.Xh = ld;
  p.xo = function(a2, b2) {
    this.D = { before: a2, after: b2 };
  };
  Jl.prototype.setOnRenderCallbacks = Jl.prototype.xo;
  var Tl = { P2D: 0, WEBGL: 1, HARP: 2 };
  Jl.EngineType = Tl;
  var Ul = { lookAt: { zoom: { min: -8, max: 24 }, tilt: { min: 0, max: 85 }, incline: { min: 0, max: 0 }, heading: { min: 0, max: 360 } }, interaction: { ZOOM: Nl.ZOOM, COORD: Nl.COORD }, capture: true };
  t("H.map.render.webgl.capabilities", Ul);
  function Vl(a2) {
    var b2, c2 = this, d = x.H.gl;
    Vl.j.constructor.call(this);
    this.a = b2 = d.Scene.create(x.URL.createObjectURL(pf(JSON.stringify(Wl))), { viewport: a2.viewport, container: a2.Zb, disableRenderLoop: true, devicePixelRatio: a2.devicePixelRatio, logLevel: "error" });
    a2.ao && b2.subscribe({ load: a2.ao });
    b2.subscribe({ view_complete: function() {
      c2.ji = true;
      a2.qk();
    } });
    var e = b2.requestRedraw;
    b2.requestRedraw = function() {
      e.apply(b2);
      a2.qk();
    };
    this.ki = A(this.ki, this);
    this.jg = A(this.jg, this);
    this.f = 0;
    this.c = {};
    this.b = {};
  }
  u(Vl, qd);
  p = Vl.prototype;
  p.ji = false;
  function Xl(a2) {
    a2 = a2.a.sources;
    var b2;
    for (b2 in a2) {
      var c2 = a2[b2];
      if (c2.hasPendingCommands && c2.hasPendingCommands())
        return true;
    }
    return x.H.gl.Task.hasPendingTasks();
  }
  p.W = function() {
    var a2 = x.H.gl.Task;
    this.a.immediateRedraw();
    a2.setState({ user_moving_view: this.a.view.user_input_active });
    a2.processAll();
    return this.ji && !this.a.dirty && !this.a.building && !Xl(this) && !Object.keys(this.b).length;
  };
  function Yl(a2) {
    a2.ji = false;
    a2.a.resetViewComplete();
  }
  function Zl(a2) {
    return a2.a.view;
  }
  function $l(a2, b2) {
    function c2() {
      var e = b2.La(), f2 = {}, g = {}, h, k, l, m = ++a2.f, n, q;
      $h(g, Wl);
      for (k = 0; k < e.length; k++) {
        var r = e[k];
        if (h = r.ca()) {
          var v = h.Ya();
          if (v.getState() === Xh.READY) {
            var w = v.qc();
            if (!Va(w)) {
              delete w.cameras;
              delete w.camera;
              f2[k] = w = li(w, k);
              !C(r, tl) && w.sources && mi(w, h.uid);
              for (l in w.sources) {
                var y = w.sources[l];
                y.max_zoom = yd(h.max, Ul.lookAt.zoom.max);
                y.max_display_zoom = r.max;
                y.min_display_zoom = r.min;
                if (q = h.tileSize)
                  2 <= d && 256 < q && h instanceof Ek && (q /= 2), y.tile_size = q;
              }
              (n = v.Ib()) && ni(w, n);
              $h(g, w);
            }
          }
        }
      }
      $h(
        g.layers.skybox.draw.skybox.color,
        g.scene.sky
      );
      a2.a.config = g;
      return a2.a.updateConfig().then(function() {
        var G = {}, I, Q;
        if (m !== a2.f)
          return false;
        a2.f = 0;
        for (Q in f2) {
          r = e[+Q];
          var V = f2[Q].sources;
          for (I in V)
            if (V = a2.a.sources[I])
              G[I] = V, V.initialize && r.getProvider() && V.initialize(r.getProvider(), a2.ki, a2.a.getWorkers().length, V.tiled ? B : a2.a.tile_manager.getWorkerForTile(z, V));
        }
        for (I in a2.c)
          !G[I] && a2.c[I].dispose && a2.c[I].dispose();
        a2.c = G;
        return true;
      });
    }
    var d = a2.a.pixelRatio();
    a2.a.initialized ? c2() : a2.a.load(z, { blocking: false }).then(c2);
  }
  p.ki = function(a2, b2, c2) {
    var d = this, e = this.a.sources[a2], f2 = c2 && c2.isReload;
    b2 ? true !== this.b[a2] && (this.b[a2] || (this.b[a2] = { cl: {}, aj: [] }), C(b2, Xk) ? this.b[a2].cl[b2.x + "/" + b2.y + "/" + b2.z] = true : (b2 = b2.boundingBox, this.b[a2].aj.push(new K(b2[0], b2[1], b2[2], b2[3])))) : this.b[a2] = true;
    e && e.has_volatile_data ? am(this, f2) : (x.clearTimeout(this.g), this.g = x.setTimeout(function() {
      return am(d, f2);
    }, 100));
  };
  p.jg = function(a2) {
    var b2 = false, c2 = this.b[a2.source.name], d = x.H.gl;
    if (c2)
      if (true === c2)
        b2 = true;
      else {
        var e = d.Tile.coord(d.Geo.wrapTile(a2.coords));
        b2 = !!c2.cl[e.key];
        if (!b2) {
          var f2 = d.Geo.getTileBoundingBox(e, a2.source.tile_size, wh.MAX_LINE_WIDTH / 2);
          f2 = sg(f2.getTopLeft(), f2.getBottomRight());
          b2 = c2.aj.some(function(g) {
            return g.nd(f2, true) || f2.gd(g.bb(), true);
          });
        }
      }
    return b2;
  };
  function am(a2, b2) {
    var c2 = a2.a.tile_manager;
    c2.removeTiles(a2.jg);
    c2.updateTilesForView();
    b2 && c2.removeCachedTiles(a2.jg);
    Yl(a2);
    a2.b = {};
  }
  p.qc = function() {
    return this.a.config;
  };
  function bm(a2, b2, c2, d) {
    a2.a.getFeatureAt(b2, c2, d);
    a2.a.update();
  }
  function cm(a2) {
    return a2.a.screenshot(void 0).then(function(b2) {
      return new Rb(function(c2, d) {
        new Rj(URL.createObjectURL(b2.blob), function(e, f2) {
          1 === e ? c2(f2.getData()) : d();
        }, false);
      });
    });
  }
  p.Xa = function() {
    return this.a.pixelRatio();
  };
  p.o = function() {
    var a2 = this.c;
    Vl.j.o.call(this);
    this.a.destroy();
    this.b = {};
    a2 && Object.keys(a2).forEach(function(b2) {
      a2[b2].dispose();
    });
    x.clearTimeout(this.g);
    delete this.c;
    delete this.a;
  };
  Vl.prototype.disposeInternal = Vl.prototype.o;
  var Wl = { scene: { background: { color: "#FFFFFF" }, sky: { zenith: "#347BC0", horizon: "#EDF2F9", fog: "#FFFFFF" } }, lights: { default_light: { type: "directional", name: "default_light", visible: true } }, camera: { type: "perspective" }, styles: {}, fonts: {}, sources: { skybox: { type: "SkyBox" } }, layers: { skybox: { data: { source: "skybox" }, draw: { skybox: { color: {} } } } }, global: {} };
  var nk = { FEATURE: 1, SOURCE: 2, PROVIDER: 3 };
  t("H.map.provider.PickingMode", nk);
  function dm(a2) {
    return a2;
  }
  t("H.util.animation.ease.LINEAR", dm);
  t("H.util.animation.ease.EASE_IN_QUAD", function(a2) {
    return a2 * a2;
  });
  function em(a2) {
    return -a2 * (a2 - 2);
  }
  t("H.util.animation.ease.EASE_OUT_QUAD", em);
  t("H.util.animation.ease.EASE_IN_OUT_QUINT", function(a2) {
    a2 *= 2;
    return 1 > a2 ? Gd(a2, 5) / 2 : (a2 -= 2, Gd(a2, 5) / 2 + 1);
  });
  function fm(a2) {
    return 1 - Math.sqrt(1 - a2 * a2);
  }
  function gm(a2) {
    return Fd(2 * a2 - a2 * a2);
  }
  t("H.util.animation.ease.EASE_OUT_CIRC", gm);
  function hm(a2) {
    return 1 - Math.cos(a2 * Math.PI / 2);
  }
  function im(a2) {
    return Math.sin(a2 * Math.PI / 2);
  }
  ;
  function jm(a2, b2) {
    this.a = { tilt: km(a2.tilt, b2.tilt), heading: km(a2.heading, b2.heading), zoom: b2.zoom - a2.zoom };
    var c2 = this.b = ng(a2.position), d = b2.position;
    a2 = d.lat * Ud;
    var e = c2.lat * Ud;
    d = d.lng * Ud - c2.lng * Ud;
    c2 = Id(d) * Kd(a2);
    a2 = Kd(e) * Id(a2) - Id(e) * Kd(a2) * Kd(d);
    a2 = Math.atan2(c2, a2);
    this.i = (0 <= a2 ? a2 : Sd + a2) * Vd;
    this.c = this.b.Wa(b2.position);
    b2 = this.a.zoom;
    this.g = 0 === b2 ? lm : Object.assign({}, lm, { zoom: 0 > b2 ? gm : fm, position: 0 > b2 ? hm : im });
    this.f = Object.assign({}, { tilt: 0, heading: 0, zoom: 0 });
  }
  function km(a2, b2) {
    a2 = b2 - a2;
    return -180 < a2 && 180 >= a2 ? a2 : 180 < a2 ? a2 - 360 : a2 + 360;
  }
  var lm = { tilt: dm, heading: dm, zoom: dm, position: dm };
  function mm(a2, b2) {
    if (E(this.x = +a2))
      throw new D(mm, 0, a2);
    if (E(this.y = +b2))
      throw new D(mm, 1, b2);
  }
  mm.prototype.add = function(a2) {
    return new mm(this.x + a2.x, this.y + a2.y);
  };
  mm.prototype.a = function(a2) {
    if (!C(a2, mm))
      throw new D(this.a, 0, a2);
    a2 = this.b(a2);
    return a2.x + a2.y;
  };
  mm.prototype.b = function(a2) {
    if (!C(a2, mm))
      throw new D(this.b, 0, a2);
    return new mm(this.x * a2.x, this.y * a2.y);
  };
  mm.prototype.Oa = function(a2) {
    return new mm(this.x * a2, this.y * a2);
  };
  function nm(a2) {
    return Fd(a2.a(a2));
  }
  ;
  function om(a2) {
    a2 = a2 || jf;
    this.mb = vc(a2.Wn) ? a2.Wn : 3;
    this.U = vc(a2.Un) ? a2.Un : 300;
    this.u = vc(a2.No) ? a2.No : 3;
    this.J = vc(a2.Io) ? a2.Io : 50;
    this.c = [];
    this.clear();
  }
  t("H.map.render.InteractionUtils", om);
  om.prototype.tn = function() {
    return this.b;
  };
  om.prototype.isGestureDetected = om.prototype.tn;
  om.prototype.start = function(a2, b2) {
    var c2 = Nl.HEADING, d = Nl.TILT;
    this.s && this.clear();
    this.g = a2;
    this.l = !!b2;
    this.s = true;
    this.b = !(a2 & (c2 | d)) || a2 === c2 || a2 === d;
  };
  om.prototype.start = om.prototype.start;
  om.prototype.store = function(a2, b2, c2, d, e) {
    var f2 = false;
    if (this.s) {
      a2 = new pm(a2, b2, c2, d, e);
      f2 = a2.c;
      this.m = this.a;
      this.a = a2;
      if (this.f) {
        if (this.i = true, f2) {
          b2 = this.g;
          var g = this.b;
          if (!g && this.i) {
            e = Nl.HEADING;
            var h = Nl.TILT;
            c2 = Nl.COORD;
            d = Nl.ZOOM;
            var k = b2 & (c2 | h) ? this.Nd(true) : qm;
            var l = b2 & d ? this.Cf(true) : 1;
            var m = b2 & e ? Dd(this.bh(true)) : 0;
            var n = Dd(k.x);
            var q = Dd(k.y);
            k = 10 < n || 10 < q;
            n = 10 < q && q > 3 * n;
            l = 0.8 > l || 1.2 < l;
            m = 7 < m;
            b2 & h && (m || l || k && !n ? rm(this, h) : n && (rm(this, ~h >>> 0), g = true));
            !g && b2 & e && b2 & (c2 | d) && (l || k ? (rm(this, e), g = true) : m && (rm(this, h), g = true));
            this.b = g;
          }
        }
      } else
        this.f = a2, f2 || (this.b = true);
      this.l && this.c.push(a2);
    }
    return f2;
  };
  om.prototype.store = om.prototype.store;
  om.prototype.clear = function() {
    this.c.length = 0;
    this.s = this.l = this.i = this.b = false;
    this.f = this.m = this.a = void 0;
  };
  om.prototype.clear = om.prototype.clear;
  om.prototype.Ac = function(a2) {
    return 0 < (this.g & a2);
  };
  om.prototype.isModifierEnabled = om.prototype.Ac;
  function rm(a2, b2) {
    a2.g ^= a2.g & b2;
  }
  om.prototype.sa = function() {
    return this.s;
  };
  om.prototype.isRunning = om.prototype.sa;
  var qm = qc(new mm(0, 0));
  om.prototype.rc = function() {
    var a2;
    if (this.l) {
      var b2 = this.c;
      var c2 = b2.length;
      var d = 0;
      for (a2 = new mm(0, 0); --c2 && d < this.u; )
        a2 = a2.add(sm(b2[c2 - 1], b2[c2])), d++;
    } else
      a2 = this.Nd();
    b2 = a2;
    c2 = nm(b2);
    return 0 !== c2 ? new mm(b2.x / c2, b2.y / c2) : b2;
  };
  om.prototype.getDirection = om.prototype.rc;
  om.prototype.zb = function(a2) {
    a2 = a2 || Lk();
    var b2, c2;
    if (this.l) {
      var d = this.c;
      var e = this.c.length;
      var f2 = this.c[e - 1];
      for (c2 = b2 = 0; --e && b2 < this.u; )
        c2 += nm(sm(d[e], d[e - 1])), b2++;
      d = c2 / b2;
    } else
      f2 = this.a, d = nm(this.Nd());
    return d = d >= this.mb && a2 - f2.timestamp <= this.J ? d > this.U ? this.U : d : 0;
  };
  om.prototype.getSpeed = om.prototype.zb;
  om.prototype.Bf = function() {
    return this.a ? tm(this.a) : B;
  };
  om.prototype.getBifocalCenter = om.prototype.Bf;
  om.prototype.Nd = function(a2) {
    return (a2 = a2 ? this.f : this.m) ? sm(a2, this.a) : new mm(0, 0);
  };
  om.prototype.getMoveVector = om.prototype.Nd;
  om.prototype.Cf = function(a2) {
    var b2 = 1;
    if (this.i) {
      var c2 = this.a;
      a2 = a2 ? this.f : this.m;
      if (a2 = um(a2)) {
        if (c2 = um(c2))
          b2 = c2 / a2;
      }
    }
    return b2;
  };
  om.prototype.getBifocalScaling = om.prototype.Cf;
  om.prototype.bh = function(a2) {
    if (this.i) {
      var b2 = a2 ? this.f : this.m, c2 = this.a;
      a2 = b2.b;
      var d = c2.b, e = 0;
      a2 && d && (b2 = b2.a, c2 = c2.a, e -= Nd(d.y - c2.y, d.x - c2.x) * Vd - Nd(a2.y - b2.y, a2.x - b2.x) * Vd);
      a2 = e;
    } else
      a2 = 0;
    return a2;
  };
  om.prototype.getBifocalRotation = om.prototype.bh;
  function pm(a2, b2, c2, d, e) {
    this.a = new J(a2, b2);
    c2 !== B && (this.b = new J(c2, d), this.c = true);
    this.timestamp = e !== B ? e : Lk();
  }
  pm.prototype.c = false;
  function tm(a2) {
    var b2 = a2.a;
    return (a2 = a2.b) ? new J(b2.x - (b2.x - a2.x) / 2, b2.y - (b2.y - a2.y) / 2) : B;
  }
  function vm(a2, b2) {
    var c2 = a2.a;
    return (a2 = a2.b) && a2.Wa(b2) < c2.Wa(b2) ? a2 : c2;
  }
  function sm(a2, b2) {
    var c2 = a2.b, d = b2.b;
    d && c2 ? (b2 = tm(b2), a2 = tm(a2)) : c2 ? (b2 = b2.a, a2 = vm(a2, b2)) : d ? (a2 = a2.a, b2 = vm(b2, a2)) : (b2 = b2.a, a2 = a2.a);
    return new mm(b2.x - a2.x, b2.y - a2.y);
  }
  function um(a2) {
    var b2 = a2.b;
    return b2 ? a2.a.Wa(b2) : 0;
  }
  ;
  function wm() {
    F.call(this);
    this.reset();
  }
  u(wm, F);
  wm.prototype.start = function(a2, b2) {
    this.c && this.reset();
    E(a2 - b2) || (this.a = +a2, this.b = +b2);
    this.c = true;
  };
  wm.prototype.reset = function() {
    this.c = false;
    this.a = this.b = B;
    this.f = new xm(0, 0, 0, 0, 0, 0);
  };
  wm.prototype.sa = function() {
    return this.c;
  };
  wm.prototype.A = { Cg: "animationupdate" };
  function ym(a2) {
    ym.j.constructor.call(this, wm.prototype.A.Cg);
    this.b = a2;
  }
  u(ym, ud);
  wm.prototype.set = function(a2, b2, c2, d, e, f2) {
    var g = this.f;
    this.c && (a2 = new xm(a2 / 1e3, b2 / 1e3, c2 / 1e3, d / 1e3, e / 1e3, f2 / 1e3), g.ia(a2) || (this.f = a2, this.dispatchEvent(new ym(zm(this)))));
  };
  function zm(a2) {
    return x.Object.create(a2.f);
  }
  wm.prototype.zb = function() {
    return zm(this).zb();
  };
  wm.prototype.rc = function() {
    var a2 = zm(this), b2 = this.zb() || 1;
    return new xm(a2.a / b2, a2.b / b2, a2.c / b2, a2.f, a2.g, a2.i);
  };
  wm.prototype.o = function() {
    this.reset();
    wm.j.o.call(this);
  };
  function xm(a2, b2, c2, d, e, f2) {
    this.a = a2;
    this.b = b2;
    this.c = c2;
    this.f = d;
    this.g = e;
    this.i = f2;
  }
  xm.prototype.zb = function() {
    return Fd(this.a * this.a + this.b * this.b + this.c * this.c);
  };
  xm.prototype.rc = function() {
    var a2 = this.zb() || 1;
    return new xm(this.a / a2, this.b / a2, this.c / a2, this.f, this.g, this.i);
  };
  xm.prototype.ia = function(a2) {
    var b2 = a2 === this;
    !b2 && (b2 = C(a2, xm)) && (b2 = this.a === a2.a && this.b === a2.b && this.c === a2.c && this.f === a2.f && this.g === a2.g && this.i === a2.i);
    return b2;
  };
  function Am(a2, b2, c2, d) {
    Am.j.constructor.call(this);
    this.Zb = a2;
    this.oa = d;
    this.a = a2.appendChild(this.createElement(a2.ownerDocument));
    this.cf(b2, c2);
  }
  u(Am, qd);
  Am.prototype.N = function() {
    return this.a;
  };
  Am.prototype.cf = function(a2, b2) {
    this.size ? (this.size.w = a2, this.size.h = b2) : this.size = new Wi(a2, b2);
    this.Uk(this.a, this.a.style, a2, b2, this.oa);
  };
  Am.prototype.setSize = Am.prototype.cf;
  p = Am.prototype;
  p.yb = function() {
    return this.size;
  };
  p.Xa = function() {
    return this.oa;
  };
  p.Vj = true;
  p.qb = function(a2) {
    a2 !== this.Vj && (this.a.style.display = a2 ? "block" : "none", this.Vj = a2);
  };
  p.Ih = 1;
  p.ic = function(a2) {
    this.Ih !== a2 && (this.Yj(a2), this.Ih = a2);
  };
  p.Tc = function() {
    return this.Ih;
  };
  p.fe = function(a2) {
    this.a.style.zIndex = a2;
  };
  Am.prototype.setZIndex = Am.prototype.fe;
  Am.prototype.Ij = function() {
    return +this.a.style.zIndex;
  };
  Am.prototype.Oc = function() {
  };
  Am.prototype.clear = function() {
  };
  Am.prototype.o = function() {
    this.clear();
    this.Zb.removeChild(this.a);
    this.cf(0, 0);
    delete this.a;
    delete this.Zb;
    Am.j.o.call(this);
  };
  Am.prototype.disposeInternal = Am.prototype.o;
  Am.prototype.f = 0;
  Am.prototype.pg = function() {
    ++this.f;
  };
  Am.prototype.release = function() {
    --this.f || this.F();
  };
  function Bm(a2, b2, c2, d, e, f2) {
    var g = e || "2d";
    Bm.j.constructor.apply(this, arguments);
    this.b = this.a.getContext(g, f2);
    this.c = "2d" === g;
    this.g = g;
    this.In = f2;
  }
  u(Bm, Am);
  p = Bm.prototype;
  p.createElement = function(a2) {
    a2 = a2.createElement("canvas");
    var b2 = a2.style;
    b2.position = "absolute";
    b2.top = b2.left = "0";
    return a2;
  };
  p.Uk = function(a2, b2, c2, d, e) {
    a2.width = zd(c2, 1);
    a2.height = zd(d, 1);
    b2.width = Ad(c2 / e) + "px";
    b2.height = Ad(d / e) + "px";
  };
  p.Yj = function(a2) {
    this.b.globalAlpha = a2;
  };
  p.Oc = function(a2, b2, c2, d, e) {
    this.c && this.b.drawImage(a2, b2, c2, d, e);
  };
  p.Id = function() {
    return this.g;
  };
  p.clear = function(a2) {
    var b2, c2;
    this.c && (a2 ? this.b.clearRect(b2 = a2.left, c2 = a2.top, a2.right - b2, a2.bottom - c2) : this.a.width = this.size.w);
  };
  p.o = function() {
    var a2 = this.a;
    a2.width = a2.height = 0;
    delete this.b;
    Bm.j.o.call(this);
  };
  Bm.prototype.disposeInternal = Bm.prototype.o;
  function Cm(a2) {
    this.eb = a2;
  }
  u(Cm, qd);
  Cm.prototype.ob = function() {
    return this.eb;
  };
  Cm.prototype.getLayer = Cm.prototype.ob;
  Cm.prototype.Ym = function() {
    return this.lb;
  };
  Cm.prototype.getSurface = Cm.prototype.Ym;
  Cm.prototype.ad = function(a2) {
    var b2 = this.lb;
    a2 !== b2 && (this.lb = a2, a2.pg(), b2 && b2.release());
  };
  Cm.prototype.setSurface = Cm.prototype.ad;
  Cm.prototype.o = function() {
    this.lb.release();
  };
  Cm.prototype.disposeInternal = Cm.prototype.o;
  Cm.prototype.Rd = function() {
  };
  Cm.prototype.render = Cm.prototype.W;
  function Dm(a2) {
    var b2 = "dom";
    Dm.j.constructor.call(this, a2);
    C(this.eb, Em) && (b2 = "2d" === a2.Id() ? "2d" : "webgl");
    this.a = b2;
  }
  u(Dm, Cm);
  Dm.prototype.W = function(a2, b2, c2, d, e, f2, g, h) {
    g = this.eb;
    var k = this.lb, l = !(C(k, Bm) && "2d" === k.Id());
    if (d >= g.min && d <= g.max)
      return l && k.qb(true), g.W(k.N(), { boundingBox: a2, zoom: d, screenCenter: b2, priorityCenter: f2, projection: c2, cacheOnly: e, size: k.yb(), pixelRatio: k.Xa(), cameraMatrix: h });
    l && k.qb(false);
    return wk.DONE;
  };
  Dm.prototype.Rd = function() {
    return this.a;
  };
  function Fm(a2, b2, c2, d, e) {
    if (!Da(a2.mi) || !Da(a2.hi))
      throw new D(Fm, 0, a2);
    this.b = a2;
    if (!Da(this.l = b2))
      throw new D(Fm, 1, b2);
    if (E(this.i = +c2))
      throw new D(Fm, 2, c2);
    if (!Da(this.g = d) && null != d)
      throw new D(Fm, 3, d);
    if (!Da(this.c = e) && null != e)
      throw new D(Fm, 4, e);
    this.id = new cf().next();
    this.a = false;
  }
  t("H.util.animation.Animation", Fm);
  Fm.prototype.start = function() {
    var a2 = this;
    this.f = Lk();
    this.a = true;
    var b2 = this.f;
    this.b.mi(function() {
      if (a2.a) {
        var c2 = Lk(), d = c2 - a2.f, e = d / a2.i, f2 = false;
        1 <= e && (e = 1, f2 = true);
        a2.l(a2.c ? a2.c(e) : e, d, c2 - b2, c2);
        b2 = c2;
        f2 && a2.stop();
      } else
        a2.stop();
    });
  };
  Fm.prototype.start = Fm.prototype.start;
  Fm.prototype.stop = function(a2) {
    this.a = false;
    this.b.hi();
    a2 || this.g && this.g(this);
  };
  Fm.prototype.stop = Fm.prototype.stop;
  Fm.prototype.sa = function() {
    return this.a;
  };
  Fm.prototype.isRunning = Fm.prototype.sa;
  function Gm(a2, b2) {
    Gm.j.constructor.call(this, a2);
    this.oc = !(!b2 || !b2.oc);
    this.f = {};
  }
  u(Gm, Cm);
  Gm.prototype.ad = function(a2) {
    Gm.j.ad.call(this, a2);
    this.l = a2.Zb.ownerDocument;
  };
  Gm.prototype.setSurface = Gm.prototype.ad;
  var Hm = (function(a2, b2) {
    b2 = b2.ga();
    return C(b2, gh) ? b2.la : (a2[0] = b2, a2);
  }).bind(null, []);
  Gm.prototype.W = function(a2, b2, c2, d, e, f2, g) {
    var h = this.eb, k, l, m, n;
    this.s = b2 = this.f;
    this.f = c2 = {};
    if (d >= h.min && d <= h.max) {
      var q = this.rj(a2, d, e, f2);
      var r = q.markers;
      if (a2 = r.length) {
        d = [];
        e = this.lb;
        for (f2 = 0; f2 < a2; f2++) {
          h = r[f2];
          var v = Hm(h);
          for (k = v.length; k--; )
            if (l = g(v[k]))
              (n = b2[m = h.cb() + "_" + k]) ? delete b2[m] : n = { ik: h }, c2[m] = n, d.push([n, h, h.xb(), e, l.x, l.y]);
        }
        d.sort(Im);
        a2 = d.length;
        for (f2 = 0; f2 < a2; f2++)
          this.Ek.apply(this, d[f2]);
      }
    }
    return !q || q.requested && q.requested === q.total || !q.requested && r.length === q.total ? wk.DONE : wk.PENDING;
  };
  Gm.prototype.render = Gm.prototype.W;
  function Im(a2, b2) {
    var c2 = a2[1].Uc(), d = b2[1].Uc();
    return oh(c2, d, true) || a2[5] - b2[5] || oh(c2, d, false);
  }
  Gm.prototype.Ea = function() {
  };
  Gm.prototype.getObjectsAt = Gm.prototype.Ea;
  function Jm(a2, b2) {
    Jm.j.constructor.apply(this, arguments);
    this.c = 0;
    this.a = [];
    this.b = A(this.b, this);
  }
  u(Jm, Gm);
  t("H.map.render.dom.MarkerRenderer", Jm);
  Jm.prototype.rj = function() {
    return this.eb.Dc.apply(this.eb, arguments);
  };
  Jm.prototype.W = function(a2, b2, c2, d, e, f2, g) {
    this.b();
    this.i = 0;
    var h = Jm.j.W.apply(this, arguments);
    var k = this.lb, l = this.s, m;
    for (m in l)
      Km(this, k, l[m]);
    return 0 === this.a.length && h ? wk.DONE : wk.PENDING;
  };
  Jm.prototype.render = Jm.prototype.W;
  Jm.prototype.ad = function(a2) {
    Jm.j.ad.call(this, a2);
    this.g = a2.Xa();
  };
  Jm.prototype.setSurface = Jm.prototype.ad;
  Jm.prototype.b = function() {
    for (var a2 = this.a.length, b2, c2, d; a2--; )
      d = this.a[a2], b2 = d.Ag, c2 = b2.xb(), c2.Vh(d, c2, b2);
    this.a.length = 0;
  };
  Jm.prototype.Ek = function(a2, b2, c2, d, e, f2) {
    var g;
    var h = d.Xa();
    var k = b2.Kb();
    e *= h;
    f2 *= h;
    this.oc || (e = Ad(e), f2 = Ad(f2));
    a2.detail && (k.Vd(a2.qn) ? Km(this, d, a2) : g = a2.detail);
    g || (a2.detail = g = c2.uj(this.l), this.c++, Da(c2.Vh) && this.a.push(g));
    a2.qn = k.a;
    g.style.zIndex = this.i++;
    g.Ag = b2;
    d.Oc(g, e, f2, 0, 0);
  };
  var Lm, Mm = "pointer-events", Nm;
  if ($e) {
    var Om;
    $e && bd !== z && (bd = (Om = /(MSIE\s+|rv:)([^\);]+)(\)|;)/.exec(navigator.userAgent)) ? +Om[2] : z);
    Nm = bd;
    9 === Nm ? Mm = "display" : 10 === Nm && (Mm = "visibility");
  }
  Lm = Mm;
  Jm.prototype.Ea = function(a2, b2, c2) {
    var d = this.g, e = hf, f2, g, h, k, l;
    if (this.c) {
      a2 /= d;
      b2 /= d;
      d = this.lb.Zb.getRootNode();
      var m = d.documentElement;
      var n = this.lb.N();
      var q = n.getBoundingClientRect();
      a2 += q.left;
      for (b2 += q.top; (g = h = d.elementFromPoint(a2, b2)) && g !== n && g !== m && g !== d.host && h !== r; ) {
        for (; (k = g.parentNode) && (!Da(k.contains) || !k.contains(n)); )
          g = k;
        if (k === n && (g !== h || "svg" !== g.nodeName) && 0 > e.indexOf(l = g.Ag) && (e === hf && (e = []), e.push(l), c2))
          break;
        f2 || (f2 = []);
        var r = g.style;
        f2.push({
          fj: r.getPropertyValue(Lm),
          pn: r.getPropertyPriority(Lm),
          style: r
        });
        r.setProperty(Lm, "visibility" === Lm ? "hidden" : "none", "important");
        r = h;
      }
      if (f2)
        for (b2 = f2.length; b2--; )
          a2 = f2[b2], a2.style.removeProperty(Lm), Cc(a2.fj) && a2.style.setProperty(Lm, a2.fj, a2.pn);
    }
    return e;
  };
  Jm.prototype.getObjectsAt = Jm.prototype.Ea;
  Jm.prototype.Rd = function() {
    return "dom";
  };
  function Km(a2, b2, c2) {
    b2.clear(b2 = c2.detail);
    delete b2.Ag;
    a2.c--;
    c2 = (a2 = c2.ik).xb();
    c2.b && c2.b(b2, c2, a2);
  }
  Jm.prototype.o = function() {
    this.a.length = 0;
    var a2 = this.lb, b2 = this.f, c2;
    for (c2 in b2)
      Km(this, a2, b2[c2]);
    this.lb.F();
    Jm.j.o.call(this);
  };
  Jm.prototype.disposeInternal = Jm.prototype.o;
  function Em(a2, b2) {
    var c2 = b2 || {}, d = c2.contextType;
    c2 = c2.contextAttributes;
    Em.j.constructor.call(this, b2);
    zc(a2, "Function", Em, 0, "invalid render callback");
    if (d) {
      if (-1 === Pm.indexOf(d))
        throw new D(Em, 1, "invalid context type");
      this.b = d;
    }
    c2 && (this.c = c2);
    this.f = a2;
  }
  u(Em, qj);
  t("H.map.layer.CanvasLayer", Em);
  var Pm = ["2d", "webgl", "webgl2", "experimental-webgl"];
  Em.prototype.b = "2d";
  Em.prototype.Id = function() {
    return this.b;
  };
  Em.prototype.W = function(a2, b2) {
    this.a && this.a.canvas === a2 || (this.a = a2.getContext(this.b, this.c));
    return this.f(this.a, b2);
  };
  Em.prototype.o = function() {
    Em.j.o.call(this);
    delete this.a;
  };
  function Qm(a2, b2) {
    Qm.j.constructor.call(this, b2);
    zc(a2, "Function", Qm, 0, "invalid render callback");
    this.a = a2;
  }
  u(Qm, qj);
  t("H.map.layer.DomLayer", Qm);
  Qm.prototype.W = function(a2, b2) {
    return this.a(a2, b2);
  };
  function Rm(a2, b2) {
    if (E(this.b = +a2))
      throw new D(Rm, 0, a2);
    this.a = 0;
    b2 && this.Qk(b2);
  }
  t("H.util.kinetics.KineticMove", Rm);
  Rm.prototype.Qk = function(a2) {
    this.a = a2;
    return this;
  };
  Rm.prototype.setInitialSpeed = Rm.prototype.Qk;
  Rm.prototype.am = function() {
    return Math.abs(this.a / this.b);
  };
  Rm.prototype.getDuration = Rm.prototype.am;
  Rm.prototype.De = function(a2) {
    return this.a + this.b * a2;
  };
  Rm.prototype.getCurrentSpeed = Rm.prototype.De;
  Rm.prototype.Wl = function(a2) {
    return this.a * a2 + this.b * a2 * a2 / 2;
  };
  Rm.prototype.getCurrentPath = Rm.prototype.Wl;
  function Sm(a2, b2, c2, d) {
    Sm.j.constructor.apply(this, arguments);
  }
  u(Sm, Am);
  t("H.map.render.dom.Surface", Sm);
  p = Sm.prototype;
  p.Id = function() {
    return "dom";
  };
  p.createElement = function(a2) {
    a2 = a2.createElement("DIV");
    a2.style.position = "absolute";
    a2.style.pointerEvents = "none";
    return a2;
  };
  p.Uk = function(a2, b2, c2, d) {
    b2.width = c2 + "px";
    b2.height = d + "px";
  };
  p.Yj = function(a2) {
    this.a.style.opacity = a2;
  };
  p.Oc = function(a2, b2, c2) {
    var d = this.oa, e = a2.style;
    e[Af("transform")] = "matrix(1,0,0,1," + b2 / d + "," + c2 / d + ")";
    a2.parentNode !== this.a && (e.position = "absolute", this.a.appendChild(a2), this.a.style.pointerEvents = "auto", "auto" === getComputedStyle(a2).pointerEvents && (a2.style.pointerEvents = "all"), this.a.style.pointerEvents = "none");
  };
  p.clear = function(a2) {
    a2 ? this.a.removeChild(a2) : this.a.innerHTML = "";
  };
  function Tm(a2, b2) {
    this.a = a2;
    this.b = b2;
  }
  function Um(a2, b2, c2) {
    var d = [], e = { Zb: a2.a, width: b2.w, height: b2.h, oa: a2.b };
    for (a2 = 0; a2 < c2.length; a2++) {
      b2 = c2[a2];
      var f2 = b2.Rd();
      var g = {};
      Ya(g, e);
      var h = b2.lb;
      switch (f2) {
        case "2d":
          C(b2.ob(), Em) && (g.Rg = b2.ob().c);
          if (f2 = m && "2d" === m.Id()) {
            f2 = g.Rg;
            var k = m.In;
            f2 = k === f2 ? true : k && !f2 ? !k.alpha && !k.willReadFrequently : f2 && !k ? !f2.alpha && !f2.willReadFrequently : !f2.alpha === !f2.alpha && !k.willReadFrequently === !f2.willReadFrequently;
          }
          if (f2)
            var l = false;
          else if (h && !l) {
            var m = h;
            l = false;
          } else
            m = new Bm(g.Zb, g.width, g.height, g.oa, "2d", g.Rg), l = true;
          break;
        case "dom":
          m = h || new Sm(g.Zb, g.width, g.height, g.oa);
          l = !h;
          break;
        default:
          m = h || new Bm(g.Zb, g.width, g.height, g.oa, b2.ob().Id(), g.Rg), l = !h;
      }
      d[d.length - 1] !== m && (m.fe(d.length), d.push(m));
      b2.ad(m);
    }
    return d;
  }
  ;
  function Ll() {
    Ll.j.constructor.call(this);
    this.b = {};
    this.a = { position: new kg(0, 0), zoom: 0, heading: 180, incline: 0, tilt: 0, bounds: new O(ch([90, -180, 90, 0, 90, 180, -90, 180, -90, -180])) };
  }
  u(Ll, F);
  t("H.map.ViewModel", Ll);
  Ll.prototype.A = { za: "update", le: "sync" };
  Ll.prototype.Wb = function(a2, b2) {
    if (!a2)
      throw new D(this.Wb, 0, a2);
    var c2 = a2[Vm];
    if (vc(c2) && !lg(c2))
      throw new D(this.Wb, 0, Vm);
    c2 = a2[Wm];
    if (vc(c2) && E(+c2))
      throw new D(this.Wb, 0, Wm);
    c2 = a2[Xm];
    if (vc(c2) && !C(c2, jg))
      throw new D(this.Wb, 0, Xm);
    a2 = x.Object.assign({}, a2);
    c2 = Ym(a2, this.b, this.a);
    Zm(this, this.b, a2);
    this.dispatchEvent(new $m(this.b, c2, b2));
    return this;
  };
  Ll.prototype.setLookAtData = Ll.prototype.Wb;
  Ll.prototype.jb = function() {
    var a2 = {};
    a2[Vm] = ng(this.a[Vm]);
    Zm(this, a2, this.a, true);
    return a2;
  };
  Ll.prototype.getLookAtData = Ll.prototype.jb;
  var Vm = "position", Wm = "zoom", Xm = "bounds", an = { Ui: Vm, Xi: Wm, Oi: "heading", Wi: "tilt", Pi: "incline", Mi: Xm }, bn = Object.keys(an).map(function(a2) {
    return an[a2];
  });
  function Zm(a2, b2, c2, d) {
    a2.g = {};
    a2.f = {};
    a2.c = [];
    for (var e = a2.l, f2 = a2.i, g = bn.length, h, k, l; g--; )
      if (h = bn[g], l = c2[h], k = b2[h], null == k || !d)
        if (null != l) {
          vc(e) && e.call(a2, h, k, l);
          var m = h, n;
          (n = "position" !== h) || (n = l, n = !n || E(n.lat) || E(n.lng) ? false : true);
          b2[m] = n ? l : ng(l);
          if (vc(f2)) {
            switch (h) {
              case "position":
                k = l && k && (l.lat !== k.lat || l.lng !== k.lng);
                break;
              case "bounds":
                k = l && k && !l.ia(k);
                break;
              default:
                k = l !== k;
            }
            k && f2.call(a2, h);
          }
        } else
          delete b2[h];
  }
  Ll.prototype.l = function(a2, b2, c2) {
    this.g[a2] = b2;
    this.f[a2] = c2;
  };
  Ll.prototype.i = function(a2) {
    this.c.push(cn[a2]);
  };
  var cn = bn.reduce(function(a2, b2) {
    a2[b2] = ej[b2.toUpperCase()];
    return a2;
  }, {});
  function Ym(a2, b2, c2) {
    var d = 0;
    ["tilt", "incline", "heading", Wm].forEach(function(e) {
      if (E(a2[e])) {
        var f2 = E(b2[e]) ? c2[e] : b2[e];
        a2[e] = f2;
      } else
        d |= cn[e];
    });
    [Vm, Xm].forEach(function(e) {
      a2[e] ? d |= cn[e] : a2[e] = b2[e] || c2[e];
    });
    return d;
  }
  Ll.prototype.$a = function(a2) {
    var b2 = {}, c2 = {};
    Zm(this, this.a, a2);
    this.b = {};
    b2.lookAt = this.f;
    c2.lookAt = this.g;
    a2 = this.c;
    a2 = a2.length ? a2.reduce(dn) : 0;
    this.dispatchEvent(new dj(this.A.le, b2, c2, a2));
  };
  Ll.prototype.synchronize = Ll.prototype.$a;
  function dn(a2, b2) {
    return a2 | b2;
  }
  Ll.prototype.df = function(a2, b2) {
    if (E(a2 = +a2))
      throw new D(this.df, 0, Wm);
    this.Wb({ zoom: a2 }, b2);
  };
  Ll.prototype.pb = function() {
    return this.a.zoom;
  };
  Ll.prototype.kc = Qc;
  Ll.prototype.startControl = Ll.prototype.kc;
  Ll.prototype.control = Qc;
  Ll.prototype.control = Ll.prototype.control;
  Ll.prototype.vb = Qc;
  Ll.prototype.endControl = Ll.prototype.vb;
  function $m(a2, b2, c2) {
    $m.j.constructor.call(this, Ll.prototype.A.za, a2, null, b2);
    this.b = this.animate = Fc(c2) && 0 < c2 && Infinity > c2 ? c2 : !!c2;
  }
  u($m, dj);
  function T(a2, b2, c2, d) {
    T.j.constructor.call(this, a2, b2, c2, d);
    this.qa = new Rk(100);
    this.R = new J(0, 0);
    this.Af = !!d.enableSubpixelRendering;
    this.ab = en;
    this.m = new om();
    this.g = d = new wm();
    this.sb = A(this.sb, this);
    d.addEventListener(d.A.Cg, this.sb);
    d = a2.element;
    this.L = a2 = d.ownerDocument.createElement("div");
    a2.style.position = "absolute";
    a2.style.width = a2.style.height = "100%";
    a2.style.zIndex = 0;
    d.insertBefore(a2, d.firstChild);
    this.Ad = new Tm(this.L, this.oa);
    this.ta = b2.jb().position;
    b2 = x.H.gl;
    if (!b2)
      throw new $c(T, '"H-webgl" module is missing');
    this.a = new Vl({ viewport: this.f, Zb: this.L, devicePixelRatio: this.oa, qk: A(this.ha, this) });
    b2.WorkerBroker.addTarget("model", sj);
    b2 = this.c.La();
    a2 = 0;
    d = b2.length;
    this.l = { Nc: [], ja: [] };
    for (this.xa = b2; a2 < d; a2++) {
      var e = b2[a2];
      this.Pe(a2, e);
      Ol(this, e, true);
    }
    this.Eb();
    this.fd = A(this.fd, this);
    this.Kh = A(this.Kh, this);
    this.Da = A(this.Da, this);
    c2.addEventListener(qj.prototype.A.ie, this.fd);
    this.C = fn;
    this.zoom = Pl(this, this.J.pb());
    this.Eb();
    this.T();
  }
  u(T, Jl);
  t("H.map.render.webgl.RenderEngine", T);
  T.prototype.jb = function() {
    var a2 = this.ta;
    return Ql(this, { position: { An: a2.An, Fn: a2.Fn }, zoom: this.zoom, tilt: this.dl, heading: this.heading });
  };
  T.prototype.fd = function(a2) {
    a2 = (a2 = a2.target.ca()) && a2.Ya();
    (a2 && a2.getState()) === Xh.INIT ? a2.load() : (Yl(this.a), $l(this.a, this.c), this.ha());
  };
  T.prototype.type = Tl.WEBGL;
  var fn = 2;
  T.prototype.getState = function() {
    return this.C;
  };
  T.prototype.getState = T.prototype.getState;
  function gn(a2, b2, c2) {
    b2 = c2 - b2;
    a2 = Gd(2, 8 + a2.zoom);
    return b2 < a2 / 2 ? b2 : b2 - a2 * c2 / Dd(c2);
  }
  function hn(a2, b2, c2) {
    function d(h) {
      return e[h] + km(e[h], b2[h]) / 2;
    }
    if (!(c2 & ej.POSITION || c2 & ej.BOUNDS))
      return null;
    var e = Zl(a2.a).getLookAtData();
    c2 = e.position;
    var f2 = b2.position, g = b2.bounds;
    if (Fi(e.bounds, f2.lat, f2.lng, false) || g && Fi(g, c2.lat, c2.lng, false))
      return null;
    c2 = jn(a2, { tilt: d("tilt"), heading: d("heading"), incline: 0, bounds: tg([c2, f2]) });
    c2.zoom = Pl(a2, c2.zoom - 0.5);
    delete c2.bounds;
    return c2;
  }
  T.prototype.dd = false;
  function kn(a2, b2, c2, d) {
    a2 = a2.getCapabilities().lookAt[d];
    a2 = a2.max - a2.min;
    return Dd("zoom" === d ? c2[d] - b2[d] : km(b2[d], c2[d])) / a2 || 0;
  }
  function ln(a2, b2, c2) {
    a2 = zd(8 * kn(a2, b2, c2, "zoom"), kn(a2, b2, c2, "heading"), kn(a2, b2, c2, "tilt") / 2);
    return ae(3e3 * a2, 300, 4e3);
  }
  T.prototype.Kg = function(a2) {
    var b2 = this, c2 = a2.newValue, d = a2.modifiers, e = Zl(this.a);
    mn(this);
    this.R.set(0, 0);
    var f2 = nn(this, c2);
    bn.forEach(function(m) {
      d & a2[m.toUpperCase()] || delete f2[m];
    });
    if (a2.b) {
      e = Zl(this.a).getLookAtData();
      var g = jn(this, f2);
      c2 = hn(this, g, d);
      var h = 1;
      Fc(a2.b) && (h = 1 / a2.b);
      var k = function() {
        return b2.dd = false;
      };
      delete g.bounds;
      this.dd = true;
      if (c2) {
        e = ln(this, e, c2);
        var l = ln(this, c2, g);
        on(this, c2, e * h, function() {
          return on(b2, g, l * h, k);
        });
      } else
        c2 = ln(this, e, g), on(this, g, c2 * h, k);
    } else
      pn(f2), e.setLookAtData(f2);
    qn(this);
    Yl(this.a);
    this.ha();
  };
  function jn(a2, b2) {
    pn(b2);
    return Zl(a2.a).getBestLookAtData(b2);
  }
  function pn(a2) {
    var b2 = a2.bounds;
    !b2 || b2 instanceof O || (a2.bounds = Ci(b2.K()));
  }
  function rn(a2, b2, c2) {
    Zl(a2.a).setLookAtData(b2);
    Yl(a2.a);
    qn(a2);
    a2.ha();
    c2 && setTimeout(c2, 0);
  }
  function on(a2, b2, c2, d) {
    var e = Zl(a2.a).getLookAtData(), f2 = new jm(e, b2);
    0 !== f2.a.tilt + f2.a.heading + f2.a.zoom + f2.c ? sn(a2, function(g) {
      for (var h in f2.a)
        if (0 !== f2.a[h]) {
          var k = f2.g[h](g);
          e[h] += f2.a[h] * (k - f2.f[h]);
          f2.f[h] = k;
        }
      0 !== f2.c && (e.position = f2.b.zg(f2.i, f2.c * f2.g.position(g), true));
      return rn(a2, e);
    }, c2, function() {
      return rn(a2, b2, d);
    }) : rn(a2, b2, d);
  }
  T.prototype.rg = function() {
  };
  T.prototype.setAnimationDuration = T.prototype.rg;
  T.prototype.$g = function() {
  };
  T.prototype.getAnimationDuration = T.prototype.$g;
  T.prototype.sg = function() {
  };
  T.prototype.setAnimationEase = T.prototype.sg;
  T.prototype.ah = function() {
  };
  T.prototype.getAnimationEase = T.prototype.ah;
  T.prototype.ng = function() {
  };
  T.prototype.resetAnimationDefaults = T.prototype.ng;
  function tn(a2, b2) {
    a2.qa.na(function(c2, d) {
      return d.Mb() === b2;
    });
  }
  p = T.prototype;
  p.nk = function(a2) {
    tn(this, a2.target.ca());
    Yl(this.a);
    this.ha();
  };
  p.Pe = function(a2, b2) {
    T.j.Pe.call(this, a2, b2);
    un(b2) && (Yl(this.a), (a2 = (a2 = b2.ca()) && a2.Ya()) && a2.getState() === Xh.INIT && a2.load());
  };
  p.Xh = function(a2, b2, c2) {
    var d;
    this.ve = Lk();
    tn(this, b2.ca());
    if (b2.requestDomMarkers || C(b2, Em) || C(b2, Qm)) {
      var e = this.l.ja;
      for (d = e.length; d--; ) {
        var f2 = e[d];
        if (f2.ob() === b2) {
          e.splice(d, 1);
          f2.F();
          break;
        }
      }
    }
    un(b2) && $l(this.a, this.c);
    this.xa = this.c.La();
    0 === a2 && (Ol(this, b2, false), this.Eb());
    Um(this.Ad, vn(this), this.l.ja.filter(vc));
    this.ce();
    c2 || this.ha();
  };
  function un(a2) {
    return !(C(a2, Qm) || C(a2, Em));
  }
  p.Yh = function() {
    this.Eb();
  };
  p.Eb = function() {
    T.j.Eb.call(this);
    var a2 = this.getCapabilities().lookAt.zoom;
    Zl(this.a).setZoomConstraints(zd(a2.min, this.Eg), yd(a2.max, this.Dg));
  };
  p.th = function(a2, b2) {
    var c2;
    if (b2) {
      a2 = { oc: this.Af, fb: this.fb };
      b2.W ? C(b2, Em) ? c2 = new Dm(b2) : C(b2, Qm) && (c2 = new Dm(b2)) : b2.requestDomMarkers && (c2 = new Jm(b2, a2));
      if (c2) {
        this.l.ja.push(c2);
        var d = this.c.La();
        this.l.ja.sort(function(e, f2) {
          return d.indexOf(e.eb) - d.indexOf(f2.eb);
        });
        Um(this.Ad, vn(this), this.l.ja.filter(vc));
      }
      un(b2) && $l(this.a, this.c);
    }
    this.xa = this.c.La();
  };
  function nn(a2, b2) {
    var c2 = b2.position;
    return Ql(a2, { zoom: Pl(a2, b2.zoom), position: new kg(c2.lat, c2.lng), tilt: b2.tilt, heading: b2.heading, bounds: b2.bounds });
  }
  function qn(a2) {
    var b2 = Zl(a2.a).getLookAtData();
    a2.zoom = b2.zoom;
    a2.ta = b2.position;
  }
  function wn(a2, b2) {
    a2 = Zl(a2.a).geoToMeters(b2);
    return new J(a2.x / 4007501668557849e-8 + 0.5, 1 - (a2.y / 4007501668557849e-8 + 0.5));
  }
  function xn(a2, b2) {
    return b2.sub(wn(a2, a2.ta)).scale(Gd(2, 8 + a2.zoom));
  }
  p.Da = function(a2) {
    return Zl(this.a).geoToPixel(a2);
  };
  T.prototype.geoToScreen = T.prototype.Da;
  T.prototype.Pa = function(a2, b2) {
    return Zl(this.a).xyToGeo(a2, b2);
  };
  T.prototype.screenToGeo = T.prototype.Pa;
  T.prototype.qg = function(a2, b2) {
    a2 = this.Pa(a2, b2);
    b2 = this.J.jb();
    b2.position = a2;
    return b2;
  };
  function yn(a2, b2, c2, d, e, f2, g, h) {
    var k, l, m = 0, n;
    var q = function() {
      0 === --m && f2(e);
    };
    if (h && h.features)
      for (m = l = h.features.length, n = 0; n < l; n++) {
        var r = h.features[n];
        var v = r.id;
        if (k = a2.a.a.sources[r.source_name]) {
          var w = k.provider;
          var y = w.Ej();
          if (y === nk.SOURCE) {
            var G = r.source_layer;
            if ("overlays" === G)
              zn(a2, b2, c2, d, e, k, r.properties.overlays_config);
            else if (k = k.getMapObjectById(v)) {
              if ("markers" !== G)
                e.push(k);
              else if (An(a2, b2, c2, k))
                e.push(k);
              else if (d && !g) {
                var I = true;
                bm(a2.a, { x: b2, y: c2 }, { radius: 3.5, top_most_only: false }, function(Q) {
                  yn(
                    a2,
                    b2,
                    c2,
                    d,
                    e,
                    f2,
                    true,
                    Q
                  );
                });
              }
            }
            m--;
          } else
            y === nk.FEATURE ? (G = r.tile.coords, I = w.getFeatureProxy(r.properties, G, function(Q) {
              Q && (Q.Tk(w), e.push(Q));
              q();
            }), I || (k = a2.qa.get(v), k || (k = new lh(r), k.ka(w), a2.qa.add(v, k, 1)), e.push(k), m--)) : y === nk.PROVIDER && (I = true, w.Fk(r, false).then(function(Q) {
              Q && (Q instanceof rh ? An(this, b2, c2, Q) : 1) && e.push(Q);
              q();
            }, function() {
              q();
            }, a2));
        }
      }
    y && (I || 0 !== m) || f2(e);
  }
  function zn(a2, b2, c2, d, e, f2, g) {
    var h;
    a2 = a2.Pa(b2, c2);
    for (b2 = g.length; b2-- && (!(h = f2.getMapObjectById(g[b2].id)) || 0 <= e.indexOf(h) || !h.ga().gd(a2) || (e.push(h), !d)); )
      ;
  }
  function An(a2, b2, c2, d) {
    var e = d.xb(), f2 = e.c, g, h = !f2;
    if (f2)
      if (e = e.kd(), b2 += e.x, c2 += e.y, e = d.ga(), C(e, Vi))
        for (d = e.la, g = d.length; g-- && !h; )
          e = a2.Da(d[g]), h = f2.Of(b2 - e.x, c2 - e.y, 0) !== de.NONE;
      else
        e = a2.Da(e), h = f2.Of(b2 - e.x, c2 - e.y, 0) !== de.NONE;
    return h;
  }
  T.prototype.Ea = function(a2, b2, c2, d) {
    var e = this, f2 = [];
    f2 = Bn(f2, this.l.ja, a2 * this.oa, b2 * this.oa, c2);
    c2 && f2.length ? d(f2) : this.a.a.initialized ? bm(this.a, { x: a2, y: b2 }, { radius: 3.5, top_most_only: c2 }, function(g) {
      yn(e, a2, b2, c2, f2, d, false, g);
    }) : d(f2);
  };
  T.prototype.getObjectsAt = T.prototype.Ea;
  function Bn(a2, b2, c2, d, e) {
    for (var f2 = b2.length, g; f2-- && !((g = b2[f2]) && g.Ea && (a2 = a2.concat(g.Ea(c2, d, e)), a2.length && e)); )
      ;
    return a2;
  }
  T.prototype.aa = z;
  function vn(a2) {
    a2 = a2.wa[2];
    return { w: a2.right - a2.left, h: a2.bottom - a2.top };
  }
  T.prototype.T = function() {
    var a2 = this.l.ja.length;
    Kl(this, this.oa);
    this.R.set(0, 0);
    var b2 = vn(this);
    var c2 = b2.w;
    var d = b2.h;
    for (this.a.a.handleViewportUpdate(); a2--; ) {
      b2 = this.l.ja[a2].lb;
      var e = b2.yb();
      e.w === c2 && e.h === d || b2.cf(c2, d);
    }
    this.aa = new Wi(c2, d);
    Yl(this.a);
    this.ha();
  };
  T.prototype.getCapabilities = function() {
    return Ul;
  };
  T.prototype.getCapabilities = T.prototype.getCapabilities;
  function Cn(a2) {
    a2.i && a2.i.sa() || (Xl(a2.a) || Lk() - a2.ve < a2.ab) && !a2.ea ? a2.Vf || (a2.Vf = Jk(a2.Kh)) : (a2.ea && (a2.ce(), Dn(a2)), a2.C = fn);
  }
  p = T.prototype;
  p.Vf = 0;
  p.ce = function() {
    this.l.Nc.length = 0;
  };
  p.Kh = function() {
    this.Vf = 0;
    this.D && this.D.before();
    var a2 = Zl(this.a);
    var b2 = a2.getLookAtData(false);
    var c2 = a2.getLookAtData(true);
    a2 = this.f.center.clone();
    c2 = c2.bounds.K();
    var d = this.zoom;
    var e = this.R;
    var f2 = this.xa;
    var g = f2.length;
    for (this.ab = en; g--; ) {
      var h = f2[g];
      C(h, qj) && h.ca() && h.ca().Ue(c2, d);
    }
    this.ea = this.a.W();
    this.J.$a(b2);
    b2 = this.l;
    f2 = b2.ja.length;
    var k = true, l;
    for (l = 0; l < f2; l++) {
      g = b2.ja[l];
      var m = b2.Nc;
      g && (h = g.W(c2, a2, void 0, d, false, e, this.Da, this.a.a.getCameraMatrix()), h === wk.ACTIVE && (this.ab = Infinity), h !== wk.DONE || m[l] || (Dn(this, g.ob()), m[l] = true), m[l] || (k = false));
    }
    this.ea = k && this.ea;
    this.aa && (this.f.$a(this.aa), this.aa = z);
    this.i && this.i.sa() && this.me();
    this.D && this.D.after();
    Cn(this);
  };
  function Dn(a2, b2) {
    a2.dd || setTimeout(A(a2.dispatchEvent, a2, { type: a2.A.Vi, target: b2 || a2 }), 1);
  }
  p.o = function() {
    var a2 = this.c.La()[0], b2 = this.f;
    Kk(this.Vf);
    En(this);
    a2 && Ol(this, a2, false);
    this.l.ja.filter(vc).forEach(function(c2) {
      c2.F();
    });
    b2.element && b2.element.removeChild(this.L);
    delete this.L;
    this.C = 3;
    this.a.F();
    T.j.o.call(this);
  };
  p.ha = function() {
    this.ve = Lk();
    this.C === fn && (this.ea = false, this.C = 1, Cn(this));
  };
  function Fn(a2, b2, c2) {
    Zl(a2.a).applyPxOffset([b2, c2]);
    qn(a2);
    a2.R.set(0, 0);
    Yl(a2.a);
    a2.ha();
  }
  p.xd = function(a2, b2, c2) {
    a2 = Pl(this, Pl(this, a2));
    Gn(this, a2, b2, c2);
  };
  T.prototype.zoomAt = T.prototype.xd;
  function Gn(a2, b2, c2, d) {
    Zl(a2.a).setLookAtData({ zoom: b2 }, Fc(c2) && Fc(c2) ? [c2, d] : B);
    qn(a2);
    Yl(a2.a);
    a2.ha();
  }
  function mn(a2) {
    En(a2);
    a2.g.sa() && a2.vb(true);
    a2.m.sa() && a2.wb(true);
  }
  function Hn(a2, b2) {
    if (b2) {
      var c2 = {};
      c2.Te = b2.power;
      c2.we = b2.ease;
      c2.duration = b2.duration;
      a2.u = c2;
    }
  }
  T.prototype.lc = function(a2, b2) {
    var c2 = !!(b2 || a2 & (Nl.HEADING | Nl.TILT));
    mn(this);
    Hn(this, b2);
    this.m.start(a2, c2);
    Zl(this.a).setPanning(true);
  };
  T.prototype.startInteraction = T.prototype.lc;
  T.prototype.cc = function(a2, b2, c2, d, e) {
    var f2 = this.m;
    var g = false;
    if (f2.sa()) {
      var h = Zl(this.a);
      var k = h.getLookAtData();
      var l = this.f.center;
      l = [l.x, l.y];
      b2 = f2.store(a2, b2, c2, d, e);
      c2 = f2.Bf();
      a2 = f2.Nd();
      e = this.m.Cf();
      d = this.m.bh();
      f2.b && (f2.Ac(Nl.TILT) && (h.setLookAtData({ tilt: Rl(this, k.tilt + a2.y / this.f.height * -180) }, l), g = true), b2 && 1 !== e && f2.Ac(Nl.ZOOM) && (g = f2.Bf(), e = Ed(Gd(2, this.zoom) * e) / Od, Gn(this, Pl(this, e), g.x, g.y), g = true), f2.Ac(Nl.COORD) && 0 < nm(a2) && (Fn(this, -a2.x, -a2.y), g = true), f2.Ac(Nl.HEADING) && (b2 ? h.setLookAtData({ heading: k.heading + Sl(this, d) }, [c2.x, c2.y]) : a2.x && h.setLookAtData({ heading: Sl(this, k.heading + a2.x / this.f.width * 360) }, l), g = true), g && (Yl(this.a), this.ha()));
    }
  };
  T.prototype.interaction = T.prototype.cc;
  T.prototype.wb = function(a2) {
    var b2 = this;
    if (this.m.sa() && !a2) {
      if (this.u) {
        a2 = this.m.zb();
        var c2 = this.m.rc();
        var d = this.u.duration;
        var e = (this.u.Te || 1) * a2;
        var f2 = new Rm(-e / (0 < d ? d : 1), e);
        !E(c2.x) && !E(c2.y) && 0 < e && b2.m.Ac(Nl.COORD) && sn(this, function(g) {
          e = f2.De(g * d);
          E(e) || Fn(b2, Ad(-c2.x * e), Ad(-c2.y * e));
        }, d, void 0, this.u.we);
      }
      delete this.u;
      this.m.clear();
    }
    Zl(this.a).setPanning(false);
    this.ha();
  };
  T.prototype.endInteraction = T.prototype.wb;
  T.prototype.kc = function(a2, b2, c2) {
    mn(this);
    this.g.start(b2, c2);
    Hn(this, a2);
    Zl(this.a).setPanning(true);
  };
  T.prototype.startControl = T.prototype.kc;
  T.prototype.control = function(a2, b2, c2, d, e, f2) {
    for (var g = 0, h; g < arguments.length; g++)
      if (h = +arguments[g], h !== h)
        throw new D(this.control, g, h);
    this.g.sa() && this.g.set(a2, b2, c2, d, e, f2);
  };
  T.prototype.control = T.prototype.control;
  T.prototype.vb = function(a2, b2) {
    var c2 = this, d;
    if (this.g.sa()) {
      En(this);
      var e = Lk();
      var f2 = e - this.Ed;
      if (1 <= f2) {
        var g = zm(this.g);
        In(this, g, f2);
      }
      if (!this.u || a2 || b2)
        "function" === typeof b2 && (a2 = Zl(this.a), a2 = a2.getLookAtData(), b2(a2), Jn(this, a2));
      else {
        b2 = this.g.zb();
        var h = this.g.rc();
        var k = this.u.duration;
        var l = (this.u.Te || 1) * b2;
        var m = new Rm(-l / (0 < k ? k : 1), l);
        !E(h.a) && !E(h.b) && 0 < l && sn(
          this,
          function(n, q, r, v) {
            e && (r = v - e, e = 0);
            l = m.De(n * k) * r;
            E(l) || ((d = h.c * l) && Gn(c2, Pl(c2, c2.zoom + d), c2.g.a, c2.g.b), Fn(c2, Ad(h.a * l), Ad(h.b * l)));
          },
          k,
          void 0,
          this.u.we
        );
      }
      this.g.reset();
      Zl(this.a).setPanning(false);
      this.ha();
    }
  };
  T.prototype.endControl = T.prototype.vb;
  function Jn(a2, b2) {
    var c2 = xn(a2, wn(a2, b2.position)), d = c2.y;
    c2 = c2.x;
    var e = b2.zoom, f2 = xn(a2, wn(a2, a2.ta));
    b2 = f2.y;
    var g = f2.x;
    f2 = a2.zoom;
    var h = a2.g.zb(), k = a2.g.a, l = a2.g.b, m = 0;
    c2 = gn(a2, g, c2);
    c2 -= g;
    d -= b2;
    f2 = e - f2;
    b2 = Fd(c2 * c2 + d * d + f2 * f2);
    if (0 !== h && 0 !== b2) {
      var n = c2 / b2;
      var q = d / b2;
      var r = f2 / b2;
      var v = h * h / (2 * b2);
      sn(a2, function(w, y) {
        var G;
        if (1 !== w) {
          w = h * y - v * y * y / 2;
          y = w - m;
          if (G = r * y)
            G = Pl(a2, a2.zoom + G), Gn(a2, G, k, l);
          Fn(a2, Ad(n * y), Ad(q * y));
          m = w;
        } else
          Gn(a2, Pl(a2, e), k, l), a2.ha();
      }, 2 * b2 / h);
    }
  }
  T.prototype.sb = function(a2) {
    var b2 = this, c2 = a2.b;
    this.R.set(0, 0);
    c2.a || c2.b || c2.c || c2.f || c2.g || c2.i ? (this.Ed = Lk(), sn(this, function(d, e, f2, g) {
      b2.Ed = g;
      In(b2, c2, f2);
    }, Wd), this.ha()) : En(this);
  };
  function In(a2, b2, c2) {
    c2 = c2 || 0;
    var d = a2.g, e = Zl(a2.a), f2 = e.getLookAtData();
    b2.c && Gn(a2, Pl(a2, f2.zoom + b2.c * c2), d.a, d.b);
    e.setLookAtData({ heading: Sl(a2, f2.heading + b2.g * c2), tilt: Rl(a2, f2.tilt + b2.f * c2) });
    qn(a2);
    Fn(a2, b2.a * c2, b2.b * c2);
  }
  function sn(a2, b2, c2, d, e) {
    a2.i && a2.i.sa() && a2.i.stop(true);
    a2.i = new Fm(a2, b2, c2, d, e);
    a2.i.start();
  }
  function En(a2) {
    a2.i && a2.i.sa() && a2.i.stop(true);
  }
  T.prototype.Wg = function() {
  };
  T.prototype.enter = T.prototype.Wg;
  T.prototype.Xg = function(a2) {
    Ml(this.L, a2);
  };
  T.prototype.exit = T.prototype.Xg;
  T.prototype.capture = function(a2, b2, c2, d) {
    var e = this;
    return cm(e.a).then(function(f2) {
      var g = e.L.ownerDocument.createElement("canvas"), h = e.oa, k = g.getContext("2d"), l = e.a.Xa() / h, m = (c2 - a2) * h;
      h *= d - b2;
      g.width = m;
      g.height = h;
      k.drawImage(f2, a2 * l, b2 * l, m * l, h * l, 0, 0, m, h);
      return g;
    });
  };
  T.prototype.Il = function(a2) {
    return Zl(this.a).geoToMeters(a2);
  };
  T.prototype.geoToMeters = T.prototype.Il;
  T.prototype.Vn = function(a2) {
    return Zl(this.a).metersToGeo(a2);
  };
  T.prototype.metersToGeo = T.prototype.Vn;
  var en = 5e3;
  function U(a2, b2, c2) {
    var d = {};
    if (!(a2 instanceof HTMLElement))
      throw new D(U, 0);
    U.j.constructor.call(this);
    this.i = Kn(c2, U);
    this.c = c2 = new Ll();
    this.D = false;
    c2.addEventListener(c2.A.le, this.R, false, this);
    if (!C(a2, Element))
      throw new D(U, 0, a2);
    c2 = this.S = a2.ownerDocument.createElement("div");
    var e = c2.style;
    e.position = "relative";
    e.height = c2.style.width = "100%";
    e.overflow = "hidden";
    e.webkitTapHighlightColor = "transparent";
    "transparent" !== e.webkitTapHighlightColor && (e.webkitTapHighlightColor = "rgba(0,0,0,0)");
    a2.appendChild(c2);
    this.b = new xk(this.S, this.i);
    this.b.addEventListener(this.b.A.le, this.R, false, this);
    a2 = this.a = new sj(this.i.layers);
    a2.addEventListener(a2.A.ke, this.P, false, this);
    a2.addEventListener(a2.A.he, this.P, false, this);
    a2.addEventListener(a2.A.je, this.P, false, this);
    !this.l && Ln(this);
    this.g = null;
    this.a.add(b2, 0);
    this.f = this.u(null != this.i.engineType ? this.i.engineType : jk, this.i);
    this.J = A(this.J, this);
    b2 = this.i.imprint;
    if (b2 !== B && "object" !== typeof b2)
      throw new D(U, 1, "imprint");
    Mn && (b2 || (b2 = {}), b2.mark = b2.mark || "GS (2022) 5659");
    this.s = null === b2 ? b2 : new Bj(this, b2);
    b2 = this.i.autoColor;
    this.L = b2 === B || !!b2;
    Nn(this);
    (b2 = this.i.zoom) && (d.zoom = b2);
    (b2 = this.i.bounds) && (d.bounds = b2);
    (b2 = this.i.center) && (d.position = b2);
    this.c.Wb(d);
  }
  u(U, F);
  t("H.Map", U);
  U.prototype.draggable = false;
  function Kn(a2, b2) {
    if (a2) {
      var c2 = a2.pixelRatio;
      if (c2 === B)
        a2.pixelRatio = Ue();
      else if (!(0 < c2))
        throw new D(b2, 0, "pixelRatio: " + c2);
    } else
      a2 = {}, a2.pixelRatio = Ue();
    a2.renderBaseBackground || (a2.renderBaseBackground = { lower: 3, higher: 2 });
    return a2;
  }
  U.prototype.o = function() {
    this.L = false;
    this.s && this.s.F();
    this.f.dispose();
    this.c.F();
    this.b.F();
    this.l.F();
    this.m.F();
    this.a.F();
    var a2 = this.S;
    a2.parentNode.removeChild(a2);
    delete this.S;
    F.prototype.o.call(this);
  };
  U.prototype.N = function() {
    return this.S;
  };
  U.prototype.getElement = U.prototype.N;
  U.prototype.Xa = function() {
    return this.i.pixelRatio;
  };
  U.prototype.getPixelRatio = U.prototype.Xa;
  function Nn(a2) {
    a2.s && a2.L && a2.s.vi({ invert: a2.g && a2.g.yl });
  }
  U.prototype.P = function(a2) {
    var b2 = a2.added, c2 = a2.removed;
    b2 && b2.ca() && b2.ca().ka(this);
    c2 && c2.ca() && c2.ca().ka(null);
    c2 === this.l && (delete this.l, delete this.m);
    c2 === this.g && (this.g = null);
    0 === a2.idx && (this.dispatchEvent(new cj(this.A.lf, this.g = a2.type !== this.a.A.je ? b2 : 0 < this.a.a.length ? this.a.get(0) : z, a2.type !== this.a.A.he ? c2 : 1 < this.a.a.length ? this.a.get(1) : z)), Nn(this));
  };
  U.prototype.R = function(a2) {
    a2.modifiers && (this.D || (On(this, "start"), this.D = true), On(this, "", a2), this.T && x.clearTimeout(this.T), this.T = x.setTimeout(this.J, 333));
  };
  function On(a2, b2, c2) {
    a2.dispatchEvent(c2 ? new dj(a2.A.Qi, c2.newValue, c2.oldValue, c2.modifiers) : a2.A.Qi + b2);
  }
  U.prototype.J = function() {
    On(this, "end");
    this.D = false;
  };
  U.prototype.tg = function(a2, b2) {
    this.f.getCapabilities().lookAt && this.c.Wb({ position: a2 }, !!b2);
    return this;
  };
  U.prototype.setCenter = U.prototype.tg;
  U.prototype.bb = function() {
    var a2 = this.c.jb();
    return a2 ? a2.position : z;
  };
  U.prototype.getCenter = U.prototype.bb;
  U.prototype.df = function(a2, b2) {
    this.c.df(a2, !!b2);
    return this;
  };
  U.prototype.setZoom = U.prototype.df;
  U.prototype.pb = function() {
    return this.c.pb();
  };
  U.prototype.getZoom = U.prototype.pb;
  U.prototype.xd = function(a2, b2, c2) {
    this.f.zoomAt(a2, b2, c2);
  };
  U.prototype.zoomAt = U.prototype.xd;
  U.prototype.hn = function() {
    return this.b;
  };
  U.prototype.getViewPort = U.prototype.hn;
  U.prototype.gn = function() {
    return this.c;
  };
  U.prototype.getViewModel = U.prototype.gn;
  U.prototype.wm = function() {
    return this.a;
  };
  U.prototype.getLayers = U.prototype.wm;
  U.prototype.qm = function() {
    return this.s;
  };
  U.prototype.getImprint = U.prototype.qm;
  U.prototype.capture = function(a2, b2, c2, d, e, f2) {
    function g(I, Q) {
      q ? I.cancel() : (w.save(), Q.capture(v, m, function(V) {
        w.restore();
        I.done(V);
      }, function(V) {
        I.done(null, V);
        h(null);
      }));
    }
    function h(I) {
      q || (q = true, a2(I));
    }
    var k = this.f, l = k.getCapabilities(), m = this.i.pixelRatio, n = this.b, q = false, r = this, v, w;
    if (!Da(a2))
      throw new D(this.capture, 0, a2);
    c2 = c2 || 0;
    d = d || 0;
    e = e || n.width;
    f2 = f2 || n.height;
    var y = zd(0, yd(c2, e));
    var G = zd(0, yd(d, f2));
    c2 = yd(n.width, zd(c2, e));
    d = yd(n.height, zd(d, f2));
    l.capture ? k.capture(y, G, c2, d).then(function(I) {
      var Q = r.s, V = b2 || [];
      v = I;
      w = v.getContext("2d");
      v.style.width = v.width / m + "px";
      v.style.height = v.height / m + "px";
      var Ba = new Mk(10, g);
      V = V.concat(Q).filter(function(ha) {
        return Da(ha && ha.capture);
      });
      V.length ? (I = V.pop(), V.forEach(function(ha) {
        Ba.push(ha, ld);
      }), Ba.push(I, A(h, r, v)), Fk(Ba)) : h(v);
    }, function() {
      h(z);
    }) : a2(null);
  };
  U.prototype.capture = U.prototype.capture;
  U.prototype.cm = function() {
    return this.f;
  };
  U.prototype.getEngine = U.prototype.cm;
  U.prototype.u = function(a2, b2) {
    b2 = b2 ? Kn(b2, this.u) : this.i;
    Nn(this);
    if (a2 === kk.P2D)
      return new x.H.map.render.p2d.RenderEngine(this.b, this.c, this.a, b2);
    if (a2 === kk.WEBGL)
      return new T(this.b, this.c, this.a, b2);
    if (a2 === kk.HARP)
      return new x.H.map.render.harp.RenderEngine(this.b, this.c, this.a, b2);
    throw new D(this.u, 0, a2);
  };
  U.prototype.gf = function(a2, b2, c2, d, e) {
    b2 = vc(b2) ? C(b2, K, this.gf, 1, b2) && b2 : this.c.jb().bounds.K();
    e = e || this.g;
    if (!C(e, pl))
      throw new D(this.gf, 4);
    var f2 = e.ca(), g = this.Xa(), h = e.tileSize;
    2 <= g && 256 < h && f2 instanceof Ek && (h /= 2);
    g = this.pb();
    h = Math.log2(h) - 8;
    c2 = vc(c2) ? +c2 : g;
    d = vc(d) ? +d : g;
    if (!(c2 <= d))
      throw new D(this.gf, B, "!(min <= max)");
    g = f2.min;
    var k = f2.max, l = this.f.type === kk.WEBGL ? Bd : Ad;
    c2 = ae(l(c2) - h, g, k);
    d = ae(l(d) - h, g, k);
    if (!(f2 && C(f2, S) && od() && f2.l()))
      throw new $c(this.gf, "Storing is not supported");
    return new Ak(
      e,
      f2,
      b2,
      c2,
      d,
      a2
    );
  };
  U.prototype.storeContent = U.prototype.gf;
  function Pn(a2) {
    xj.call(this, a2);
  }
  u(Pn, xj);
  Pn.prototype.f = function() {
    zj(this, 2);
  };
  Pn.prototype.c = function() {
    zj(this, 4);
  };
  U.prototype.xl = function(a2) {
    a2 = new Pn(a2);
    nd().clear(A(a2.f, a2), A(a2.c, a2));
    return a2;
  };
  U.prototype.clearContent = U.prototype.xl;
  U.prototype.nf = function(a2, b2) {
    var c2 = this.a, d = c2.indexOf(a2), e = b2 !== +b2;
    b2 = e ? c2.a.length - 1 : b2;
    0 > d ? c2.add(a2, b2) : d - b2 && (c2.hc(d), c2.add(a2, e ? b2 - 1 : b2));
    return this;
  };
  U.prototype.addLayer = U.prototype.nf;
  U.prototype.ae = function(a2) {
    var b2 = this.a.indexOf(a2);
    a2 !== this.g && a2 !== this.l && -1 !== b2 && this.a.hc(b2);
    return this;
  };
  U.prototype.removeLayer = U.prototype.ae;
  U.prototype.ud = function(a2) {
    this.g !== a2 && (this.a.a.length && this.a.get(0) !== this.l ? this.a.set(0, a2) : this.a.add(a2, 0), this.g = a2);
    return this;
  };
  U.prototype.setBaseLayer = U.prototype.ud;
  U.prototype.Ol = function() {
    return this.g;
  };
  U.prototype.getBaseLayer = U.prototype.Ol;
  U.prototype.Da = function(a2) {
    if (!lg(a2))
      throw new D(this.Da, 0, a2);
    return (a2 = this.f.geoToScreen(a2)) ? zf(a2) : z;
  };
  U.prototype.geoToScreen = U.prototype.Da;
  U.prototype.Pa = function(a2, b2) {
    var c2;
    if (c2 = +E(a2) || 2 * +E(b2))
      throw new D(this.Pa, c2 - 1, arguments[c2 - 1]);
    return (c2 = this.f.screenToGeo(a2, b2)) ? ng(c2) : z;
  };
  U.prototype.screenToGeo = U.prototype.Pa;
  U.prototype.qg = function(a2, b2) {
    return this.f.screenToLookAtData(a2, b2);
  };
  U.prototype.screenToLookAtData = U.prototype.qg;
  U.prototype.fa = function(a2) {
    if (!C(a2, M))
      throw new D(this.fa, 0, a2);
    !this.l && Ln(this);
    this.m.bc().fa(a2);
    return a2;
  };
  U.prototype.addObject = U.prototype.fa;
  U.prototype.Ga = function(a2) {
    if (!C(a2, M))
      throw new D(this.Ga, 0, a2);
    !this.l && Ln(this);
    this.m.bc().Ga(a2);
    return a2;
  };
  U.prototype.removeObject = U.prototype.Ga;
  U.prototype.Ua = function(a2) {
    !this.l && Ln(this);
    return this.m.bc().Ua(a2);
  };
  U.prototype.getObjects = U.prototype.Ua;
  U.prototype.Xb = function(a2) {
    var b2;
    Bc(a2, this.Xb, 0, a2);
    !this.l && Ln(this);
    var c2 = a2.length;
    for (b2 = 0; b2 < c2; b2++)
      this.fa(a2[b2]);
    return this;
  };
  U.prototype.addObjects = U.prototype.Xb;
  U.prototype.rd = function(a2) {
    var b2;
    Bc(a2, this.rd, 0, a2);
    !this.l && Ln(this);
    var c2 = a2.length;
    for (b2 = 0; b2 < c2; b2++)
      this.Ga(a2[b2]);
    return this;
  };
  U.prototype.removeObjects = U.prototype.rd;
  U.prototype.Od = function(a2, b2, c2) {
    var d;
    if (d = +E(a2) || 2 * +E(b2))
      throw new D(this.Od, d - 1, arguments[d - 1]);
    this.f.getObjectsAt(a2, b2, true, function(e) {
      c2(e[0]);
    });
  };
  U.prototype.getObjectAt = U.prototype.Od;
  U.prototype.Ea = function(a2, b2, c2, d) {
    var e;
    if (e = +E(a2) || 2 * +E(b2))
      throw new D(this.Od, e - 1, arguments[e - 1]);
    this.f.getObjectsAt(a2, b2, false, c2, !!d);
  };
  U.prototype.getObjectsAt = U.prototype.Ea;
  U.prototype.ld = function(a2, b2, c2) {
    c2 = c2 || {};
    var d = c2.zoom;
    c2.zoom = vc(d) ? d : this.c.pb();
    this.m.ld(a2, b2, c2);
  };
  U.prototype.getObjectsWithin = U.prototype.ld;
  function Ln(a2) {
    a2.m = new N({ max: 24, engineType: a2.i.engineType });
    a2.l = new tl(a2.m, a2.i);
    a2.a.add(a2.l);
  }
  var Qn = Tl.HARP, kk = { P2D: Tl.P2D, WEBGL: Tl.WEBGL, HARP: Qn };
  U.EngineType = kk;
  U.prototype.A = { Wo: "mapviewchangestart", Qi: "mapviewchange", Ri: "mapviewchangeend", lf: "baselayerchange" };
  function Rn(a2, b2) {
    Rn.j.constructor.call(this, a2, b2);
  }
  u(Rn, rh);
  t("H.map.Marker", Rn);
  Rn.prototype.type = nh.MARKER;
  Rn.prototype.T = 1;
  Rn.prototype.ra = function(a2) {
    if (a2 !== kh.VISUAL || 1 === this.zk || 1 === this.icon.getState())
      var b2 = Rn.j.ra.call(this, a2);
    return b2 || false;
  };
  Rn.prototype.invalidate = Rn.prototype.ra;
  p = Rn.prototype;
  p.zk = 0;
  p.Uj = function(a2) {
    return C(a2, Wj);
  };
  p.xh = false;
  p.mk = function() {
    this.ra(kh.VISUAL);
  };
  p.Ic = function(a2) {
    var b2 = this.icon;
    this.xh && (b2.removeEventListener("statechange", this.mk, false, this), delete this.xh);
    b2 && (this.zk = b2.getState());
    Rn.j.Ic.call(this, a2);
    0 === a2.getState() && (this.xh = true, Fe(a2, "statechange", this.mk, false, this));
    return this;
  };
  Rn.prototype.setIcon = Rn.prototype.Ic;
  Rn.prototype.b = function(a2) {
    return new Wj(a2.svg, a2);
  };
  Rn.prototype.Y = function() {
    var a2 = this.getIcon(), b2 = a2.Fo || 0, c2 = Rn.j.forWorkerMessage.call(this), d = c2.properties.icon;
    d && 0 < b2 && Ya(d, { stick_color: a2.Eo, stick_height: b2 });
    return c2;
  };
  Rn.prototype.forWorkerMessage = Rn.prototype.Y;
  function sh(a2, b2, c2) {
    var d = "anonymous", e = 1;
    this.c = A(this.c, this);
    M.call(this, c2);
    this.da(a2);
    c2 && (a2 = "crossOrigin", a2 in c2 && (d = c2[a2]), a2 = "opacity", a2 in c2 && (e = c2[a2]));
    this.Ok(b2, d);
    this.ic(e);
  }
  u(sh, M);
  t("H.map.Overlay", sh);
  sh.prototype.type = nh.OVERLAY;
  sh.prototype.K = function() {
    return this.a;
  };
  sh.prototype.getBoundingBox = sh.prototype.K;
  sh.prototype.de = function(a2) {
    C(a2, K, this.de, 0, a2);
    return this.da(a2);
  };
  sh.prototype.setBoundingBox = sh.prototype.de;
  sh.prototype.ga = function() {
    return this.a;
  };
  sh.prototype.getGeometry = sh.prototype.ga;
  sh.prototype.da = function(a2) {
    var b2 = this.a, c2 = !b2;
    C(a2, K, this.da, 0, a2);
    if (c2 || !b2.ia(a2))
      this.a = a2, c2 || this.ra(kh.SPATIAL);
    return this;
  };
  sh.prototype.setGeometry = sh.prototype.da;
  sh.prototype.Qc = function() {
    return this.b.getData();
  };
  sh.prototype.getBitmap = sh.prototype.Qc;
  sh.prototype.Ok = function(a2, b2) {
    var c2 = this.b;
    c2 && 1 !== c2.getState() && c2.cancel();
    this.b = new Rj(a2, this.c, true, B, b2);
    return this;
  };
  sh.prototype.setBitmap = sh.prototype.Ok;
  sh.prototype.c = function(a2, b2) {
    this.b = b2;
    1 === a2 && this.ra(kh.VISUAL);
  };
  sh.prototype.Tc = function() {
    return this.f;
  };
  sh.prototype.getOpacity = sh.prototype.Tc;
  sh.prototype.ic = function(a2) {
    var b2 = this.f, c2 = 2 > b2;
    if (0 <= a2 && 1 >= a2)
      a2 !== b2 && (this.f = a2, c2 && this.ra(kh.VISUAL));
    else
      throw new D(this.ic, 0);
    return this;
  };
  sh.prototype.setOpacity = sh.prototype.ic;
  sh.prototype.Y = function() {
    var a2 = sh.j.Y.call(this);
    a2.geometry = Ci(this.a).Y();
    a2.properties.overlay = true;
    return a2;
  };
  sh.prototype.forWorkerMessage = sh.prototype.Y;
  function Sn(a2, b2) {
    Sn.j.constructor.call(this, a2, b2);
  }
  u(Sn, pl);
  t("H.map.layer.MarkerTileLayer", Sn);
  var Tn = { markers: [], total: 0, requested: 0 };
  function Un(a2, b2, c2, d, e) {
    var f2 = Bd(c2);
    a2.pixelProjection.Oa(f2);
    b2 = a2.Sd(a2.Ae(b2), f2);
    c2 = a2.Ke(b2, b2.left > b2.right, ~~c2, d, e);
    a2 = c2.tiles;
    c2 = c2.total;
    d = a2.length;
    e = [];
    var g;
    for (g = 0; g < d; g++)
      for (b2 = a2[g], f2 = b2.data.length; f2--; )
        e.push(b2.data[f2]);
    return { markers: e, total: a2.length, requested: c2 };
  }
  Sn.prototype.Ec = function(a2, b2, c2, d) {
    return this.ma.providesDomMarkers() ? Tn : Un(this, a2, b2, c2, d);
  };
  Sn.prototype.requestMarkers = Sn.prototype.Ec;
  Sn.prototype.Dc = function(a2, b2, c2, d) {
    return this.ma.providesDomMarkers() ? Un(this, a2, b2, c2, d) : Tn;
  };
  Sn.prototype.requestDomMarkers = Sn.prototype.Dc;
  function Vn(a2, b2, c2) {
    var d, e = 6;
    if (b2) {
      for (d = ' expected close to: "' + b2; e--; )
        b2 = a2.a.next(), -1 !== b2 && (d += String.fromCharCode(b2));
      d += '"';
    }
    throw new D(Wn, 0, "- Malformed WKT: " + (d ? c2 + d : "unexpected end of stream"));
  }
  function Xn(a2, b2) {
    var c2 = a2.next();
    b2 = b2 ? ")" : "(";
    c2 !== b2 && Vn(a2, c2, '"' + b2 + '"');
  }
  function Yn(a2) {
    return "," === Zn(a2) ? (a2.next(), true) : false;
  }
  function $n(a2, b2, c2, d, e) {
    var f2, g, h = 2 + b2 + c2;
    for (g = 1; g <= h; g++)
      (c2 = a2.next()) ? (f2 = +c2) !== f2 ? Vn(a2, c2, "number") : 1 === g ? d[e + 1] = f2 : 2 === g ? d[e] = f2 : 3 === g && (d[e + 2] = f2) : Vn(a2, c2);
    b2 || (d[e + 2] = 0);
  }
  var ao = [];
  function bo(a2, b2, c2, d) {
    d || Xn(a2, 0);
    $n(a2, b2, c2, ao, 0);
    d || Xn(a2, 1);
    return new kg(ao[0], ao[1], b2 ? ao[2] : B);
  }
  function co(a2, b2, c2) {
    var d = [];
    Xn(a2, 0);
    do
      $n(a2, b2, c2, d, d.length);
    while (Yn(a2));
    Xn(a2, 1);
    return new L(d);
  }
  function eo(a2, b2, c2) {
    Xn(a2, 0);
    var d = co(a2, b2, c2);
    if (Yn(a2)) {
      var e = [];
      do
        e.push(co(a2, b2, c2));
      while (Yn(a2));
    }
    Xn(a2, 1);
    return new O(d, e);
  }
  var fo = [], go = [eo], ho = [bo], io = { POINT: ho, LINESTRING: [co], POLYGON: go, MULTIPOINT: [bo, Vi], MULTILINESTRING: [co, ih], MULTIPOLYGON: [eo, Ji], GEOMETRY: fo, GEOMETRYCOLLECTION: fo, CIRCULARSTRING: fo, COMPOUNDCURVE: fo, CURVEPOLYGON: fo, MULTICURVE: fo, MULTISURFACE: fo, CURVE: fo, SURFACE: fo, POLYHEDRALSURFACE: fo, TIN: fo, TRIANGLE: fo }, jo = { Z: 1, M: 2, ZM: 3 };
  function Wn(a2) {
    a2 = new ko(a2);
    var b2;
    var c2 = a2.next();
    (b2 = io[c2.toUpperCase()]) || Vn(a2, c2, "type name");
    if (b2 !== fo) {
      c2 = Zn(a2);
      c2 = jo[c2.toUpperCase()];
      var d = c2 & 1;
      var e = c2 >> 1;
      d | e && a2.next();
      c2 = Zn(a2);
      if ("EMPTY" === c2)
        if (a2.next(), d = b2[1])
          var f2 = new d([]);
        else
          b2 !== ho && (f2 = new L([]), b2 === go && (f2 = new O(f2)));
      else if ("(" === c2) {
        f2 = b2[0];
        b2 = b2[1];
        if (b2) {
          var g = [];
          Xn(a2, 0);
          if (f2 === bo) {
            var h = "(" !== Zn(a2);
            do
              g.push(f2(a2, d, e, h));
            while (Yn(a2));
          } else {
            do
              g.push(f2(a2, d, e));
            while (Yn(a2));
          }
          Xn(a2, 1);
          d = new b2(g);
        } else
          d = f2(a2, d, e);
        f2 = d;
      } else
        Vn(a2, c2, '"Z", "M", "ZM", "(" or "EMPTY"');
      a2.next() && Vn(a2, c2, "end of stream");
    }
    return f2 || z;
  }
  function ko(a2) {
    this.a = a2;
  }
  function Zn(a2) {
    var b2 = a2.b;
    if (b2 === B) {
      for (b2 = a2.a; b2.Pb() === lo; )
        b2.next();
      if (mo[b2.Pb()])
        b2 = b2.next(), b2 = b2 === no ? "" : String.fromCharCode(b2);
      else {
        b2.ge();
        do
          b2.next();
        while (!mo[b2.Pb()]);
        b2 = String.fromCharCode.apply(null, b2.Gd());
      }
      a2.b = b2;
    }
    return b2;
  }
  ko.prototype.next = function() {
    var a2 = Zn(this);
    "" !== a2 && delete this.b;
    return a2;
  };
  var lo = 32, no = -1, oo = { $o: lo, Uo: 40, Zo: 41, Ro: 44, So: no }, mo = Object.keys(oo).reduce(function(a2, b2) {
    a2[oo[b2]] = true;
    return a2;
  }, oc());
  function po() {
  }
  t("H.util.ICharStream", po);
  po.prototype.next = function() {
  };
  po.prototype.ge = function() {
  };
  po.prototype.Gd = function() {
  };
  po.prototype.Pb = function() {
  };
  function qo(a2) {
    this.c = String(a2);
    this.f = 0;
    this.a = [];
    this.b = false;
  }
  t("H.util.CharStream", qo);
  qo.prototype.next = function() {
    var a2 = this.c.charCodeAt(this.f++);
    a2 = isNaN(a2) ? -1 : a2;
    this.b && this.a.push(a2);
    return a2;
  };
  qo.prototype.ge = function() {
    this.b = true;
    this.a = [];
  };
  qo.prototype.Gd = function() {
    var a2 = this.a.slice();
    this.b = false;
    this.a = [];
    return a2;
  };
  qo.prototype.Pb = function() {
    var a2 = this.c.charCodeAt(this.f);
    return isNaN(a2) ? -1 : a2;
  };
  t("H.util.wkt.toGeometry", function(a2) {
    return Wn(new qo(a2));
  });
  function ro(a2, b2) {
    ro.j.constructor.call(this, Ki, b2);
    this.de(a2);
  }
  u(ro, uh);
  t("H.map.Rect", ro);
  ro.prototype.de = function(a2) {
    if (!C(a2, K))
      throw new D(this.de, 0, a2);
    a2.ia(this.aa) || (this.aa = this.D = a2, this.a !== z && ro.j.da.call(this, Ci(a2)));
  };
  ro.prototype.setBoundingBox = ro.prototype.de;
  ro.prototype.K = function() {
    return this.D;
  };
  ro.prototype.getBoundingBox = ro.prototype.K;
  ro.prototype.da = function() {
    return this;
  };
  ro.prototype.setGeometry = ro.prototype.da;
  ro.prototype.ga = function() {
    this.a === Ki && ro.j.da.call(this, Ci(this.aa));
    return this.a;
  };
  ro.prototype.getGeometry = ro.prototype.ga;
  function so() {
    return Hf("H-core", "1.49.1", "74e5afb", { region: "row" });
  }
  t("H.buildInfo", so);
  var Mn = "cn" === so().region, jk = kk[Mn ? "HARP" : "WEBGL"], to, uo = "maps".concat("js-"), vo, wo, xo, yo, zo;
  vo = x.document.querySelector('script[src*="' + uo + '"]');
  if (!vo) {
    for (wo = x.document.getElementsByTagName("script"), yo = new RegExp("^.*" + uo), zo = 0, xo = wo.length; zo < xo; zo++)
      if (yo.test(wo[zo].src)) {
        vo = wo[zo];
        break;
      }
  }
  to = vo ? vo.src.replace(/\/[^\/]*$/, "/") : "";
  t("H.getScriptPath", function() {
    return to;
  });
  function Ao() {
    var a2 = decodeURIComponent(to);
    if (a2) {
      a2 = "/" === a2[a2.length - 1] ? a2.substring(0, a2.length - 1) : a2;
      var b2 = x.document, c2 = "";
      b2 ? (b2 = b2.createElement("a"), b2.href = a2, c2 = b2.href) : /[\w]+:\/\//.test(a2) && (c2 = a2);
      a2 = new URL(c2);
      a2.pathname += "/" === a2.pathname[a2.pathname.length - 1] ? "styles" : "/styles";
      a2 = a2.toString();
    } else
      a2 = "https://js.api.here.com/v3/3.1.49.1/styles";
    return a2;
  }
  t("H.getStylePath", Ao);
  function Bo(a2) {
    var b2 = a2.ownerDocument;
    b2 = b2.documentElement || b2.body.parentNode || b2.body;
    try {
      var c2 = a2.getBoundingClientRect();
    } catch (d) {
      c2 = { top: 0, right: 0, bottom: 0, left: 0, height: 0, width: 0 };
    }
    return { x: c2.left + ("number" === typeof window.pageXOffset ? window.pageXOffset : b2.scrollLeft), y: c2.top + ("number" === typeof window.pageYOffset ? window.pageYOffset : b2.scrollTop) };
  }
  var Co = (function() {
    return this;
  }).apply(null);
  function Do(a2, b2, c2, d, e, f2) {
    if (isNaN(a2))
      throw Error("x needs to be a number");
    if (isNaN(b2))
      throw Error("y needs to be a number");
    if (isNaN(c2))
      throw Error("pointer must have an id");
    this.viewportX = a2;
    this.viewportY = b2;
    this.target = null;
    this.id = c2;
    this.type = d;
    this.dragTarget = null;
    this.button = vc(e) ? e : -1;
    this.buttons = vc(f2) ? f2 : 0;
    this.a = this.button;
  }
  t("H.mapevents.Pointer", Do);
  function Eo(a2, b2, c2) {
    if (isNaN(b2))
      throw Error("x needs to be a number");
    if (isNaN(c2))
      throw Error("y needs to be a number");
    a2.viewportX = b2;
    a2.viewportY = c2;
  }
  Do.prototype.tm = function() {
    return this.a;
  };
  Do.prototype.getLastChangedButton = Do.prototype.tm;
  function Fo(a2, b2) {
    a2.a = b2;
    a2.buttons |= Go[+b2] || 0;
  }
  function Ho(a2, b2) {
    a2.a = b2;
    a2.buttons &= ~(Go[+b2] || 0);
  }
  var Go = [1, 4, 2], Io = { NONE: -1, LEFT: 0, MIDDLE: 1, RIGHT: 2 };
  Do.Button = Io;
  function Jo(a2, b2, c2, d, e, f2, g) {
    Jo.j.constructor.call(this, a2);
    this.pointers = b2;
    this.changedPointers = c2;
    this.targetPointers = d;
    this.currentPointer = e;
    this.originalEvent = g;
    this.target = f2;
  }
  u(Jo, ud);
  t("H.mapevents.Event", Jo);
  function Ko(a2) {
    this.a = a2 instanceof Array ? a2.slice(0) : [];
  }
  p = Ko.prototype;
  p.clear = function() {
    this.a.splice(0, this.a.length);
  };
  p.length = function() {
    return this.a.length;
  };
  p.indexOf = function(a2) {
    for (var b2 = this.a.length; b2--; )
      if (this.a[b2].id === a2)
        return b2;
    return -1;
  };
  function Lo(a2, b2) {
    b2 = a2.indexOf(b2);
    return -1 !== b2 ? a2.a[b2] : null;
  }
  p.remove = function(a2) {
    a2 = this.indexOf(a2);
    return -1 !== a2 ? this.a.splice(a2, 1)[0] : null;
  };
  function Mo(a2, b2) {
    for (var c2 = a2.a.length, d = []; c2--; )
      a2.a[c2].type !== b2 && d.push(a2.a[c2]);
    a2.a = d;
  }
  function No(a2, b2) {
    for (var c2 = a2.a.length; c2--; )
      if (a2.a[c2].dragTarget === b2)
        return true;
    return false;
  }
  p.push = function(a2) {
    if (a2 instanceof Do)
      return this.a.push(a2);
    throw Error("list needs a pointer");
  };
  p.La = function() {
    return this.a;
  };
  p.clone = function() {
    return new Ko(this.a);
  };
  function Oo(a2, b2, c2) {
    c2 = c2 || {};
    if (!(a2 instanceof U))
      throw Error("events: map instance required");
    if (!(b2 instanceof Array))
      throw Error("events: map array required");
    qd.call(this);
    this.Tg = c2.Tg || 300;
    this.gj = c2.gj || 50;
    this.Zk = c2.Zk || 50;
    this.$k = c2.$k || 500;
    this.Ch = c2.Ch || 900;
    this.Bh = c2.Bh || 8;
    this.map = a2;
    this.m = this.map.b;
    this.f = this.m.element;
    this.D = b2;
    this.a = new Ko();
    this.b = new Ko();
    this.l = {};
    this.c = null;
    this.u = true;
    this.U = {};
    this.g = {};
    this.s = null;
    this.te = A(this.te, this);
    this.P = {
      pointerdown: this.Bl,
      pointermove: this.Cl,
      pointerup: this.Dl,
      pointercancel: this.Al
    };
    Po(this);
  }
  u(Oo, qd);
  function Po(a2, b2) {
    var c2, d = a2.D.length;
    for (c2 = 0; c2 < d; c2++) {
      var e = a2.D[c2];
      var f2 = e.listener;
      "function" === typeof f2 && (b2 ? (e.target || a2.f).removeEventListener(e.Sa, f2) : (e.target || a2.f).addEventListener(e.Sa, f2));
    }
  }
  function Qo(a2, b2, c2) {
    var d;
    if ("function" === typeof a2.P[b2]) {
      "pointermove" !== b2 && (a2.u = true);
      var e = 0;
      for (d = a2.b.length(); e < d; e++) {
        var f2 = a2.b.a[e] || null;
        a2.f.contains(c2.composedPath()[0]) ? Ro(a2, f2, a2.nj.bind(a2, c2, b2, f2)) : a2.nj(c2, b2, f2, null);
      }
    }
    a2.b.clear();
  }
  p = Oo.prototype;
  p.nj = function(a2, b2, c2, d) {
    So(c2.id, this.U);
    this.P[b2].call(this, c2, d, a2);
  };
  function Ro(a2, b2, c2) {
    if (a2.c === b2)
      c2(b2.target);
    else {
      var d = a2.m;
      var e = b2.viewportX;
      b2 = b2.viewportY;
      if (0 > e || 0 > b2 || e >= d.width || b2 >= d.height)
        c2(z);
      else {
        var f2 = a2.map;
        f2.Od(e, b2, function(g) {
          c2(g || f2);
        });
      }
    }
  }
  p.Dl = function(a2, b2, c2) {
    var d = a2.id;
    a2.target = b2;
    To(this, a2, c2);
    Uo(this, b2, "pointerup", c2, a2);
    "mouse" !== a2.type && Uo(this, b2, "pointerleave", c2, a2);
    b2 = this.l[a2.id];
    var e = { x: a2.viewportX, y: a2.viewportY }, f2 = c2.timeStamp, g = a2.target, h = this.s;
    b2 && b2.target === g && b2.Se.Wa(e) < this.Zk && f2 - b2.Hi < this.$k ? (Uo(this, g, "tap", c2, a2), h && h.target === g && f2 - h.Hi < this.Tg ? h.Se.Wa({ x: a2.viewportX, y: a2.viewportY }) < this.gj && (Uo(this, g, "dbltap", c2, a2), this.s = null) : this.s = { target: g, Se: new J(a2.viewportX, a2.viewportY), Hi: c2.timeStamp }) : this.s = null;
    this.l = {};
    So(
      d,
      this.g
    );
  };
  function To(a2, b2, c2) {
    b2 === a2.c && (Uo(a2, b2.dragTarget, "dragend", c2, b2), a2.c = null, So(b2.id, a2.U));
    b2.dragTarget = null;
  }
  p.te = function(a2, b2) {
    var c2 = this;
    Uo(this, a2.dragTarget, "drag", b2, a2);
    So(a2.id, this.U);
    this.U[a2.id] = setTimeout(function() {
      c2.te(a2, b2);
    }, 150);
  };
  function So(a2, b2) {
    b2[a2] && (b2[a2].timeout ? clearTimeout(b2[a2].timeout) : clearTimeout(b2[a2]), delete b2[a2]);
  }
  function Vo(a2, b2, c2) {
    var d = b2.target, e = new J(b2.viewportX, b2.viewportY), f2 = b2.id;
    So(f2, a2.g);
    var g = setTimeout(function() {
      d && d === b2.target && e.Wa({ x: b2.viewportX, y: b2.viewportY }) < a2.Bh && (Uo(a2, d, "longpress", c2, b2), delete a2.l[b2.id]);
    }, a2.Ch);
    a2.g[f2] = { timeout: g, Se: e };
  }
  p.Cl = function(a2, b2, c2) {
    var d = a2.dragTarget, e = a2.id;
    var f2 = a2.target;
    a2.target = b2;
    f2 !== b2 && (Uo(this, f2, "pointerleave", c2, a2), Uo(this, b2, "pointerenter", c2, a2));
    d ? this.c ? (this.te(a2, c2), this.g[e] && this.g[e].Se.Wa({ x: a2.viewportX, y: a2.viewportY }) > this.Bh && So(e, this.g)) : this.u ? this.u = false : (this.c = a2, Uo(this, d, "dragstart", c2, a2), this.te(a2, c2), delete this.l[e], this.u = true) : (!this.c || this.c && this.c.dragTarget !== b2 && this.c.dragTarget !== this.map) && Uo(this, b2, "pointermove", c2, a2);
  };
  p.Bl = function(a2, b2, c2) {
    var d = !(/^(?:mouse|pen)$/.test(a2.type) && 0 !== c2.button);
    if (b2) {
      a2.target = b2;
      this.l[a2.id] = { Se: new J(a2.viewportX, a2.viewportY), target: a2.target, Hi: c2.timeStamp };
      "mouse" !== a2.type && Uo(this, b2, "pointerenter", c2, a2);
      var e = Uo(this, b2, "pointerdown", c2, a2);
      !this.c && d && (b2.draggable && !No(this.a, b2) ? a2.dragTarget = b2 : !this.map.draggable || e.defaultPrevented || No(this.a, this.map) || (a2.dragTarget = this.map));
      Vo(this, a2, c2);
    }
  };
  p.Al = function(a2, b2, c2) {
    var d = a2.id;
    a2.target = null;
    b2 ? (Uo(this, b2, "pointerleave", c2, a2), Uo(this, b2, "pointercancel", c2, a2)) : Uo(this, this.map, "pointercancel", c2, a2);
    To(this, a2, c2);
    this.l = {};
    So(d, this.g);
  };
  function Uo(a2, b2, c2, d, e) {
    if (b2 && "function" === typeof b2.dispatchEvent) {
      var f2 = Jo;
      var g = a2.a.La(), h = a2.b.La();
      a2 = a2.a;
      var k, l = a2.a.length, m = [];
      for (k = 0; k < l; k++)
        a2.a[k].target === b2 && m.push(a2.a[k]);
      f2 = new f2(c2, g, h, m, e, b2, d);
      e.button = /^(?:longpress|(?:dbl)?tap|pointer(?:down|up))$/.test(c2) ? e.a : Io.NONE;
      b2.dispatchEvent(f2);
    }
    return f2;
  }
  p.o = function() {
    Po(this, true);
    this.a.clear();
    this.b.clear();
    var a2 = this.U, b2;
    for (b2 in a2)
      So(b2, a2);
    a2 = this.g;
    for (var c2 in a2)
      So(c2, a2);
    delete this.f;
    delete this.D;
    delete this.a;
    delete this.b;
    delete this.map;
    this.s = null;
    delete this.l;
    this.c = null;
    qd.prototype.o.call(this);
  };
  function Wo(a2) {
    this.i = A(this.i, this);
    Oo.call(this, a2, [{ Sa: "touchstart", listener: this.i }, { Sa: "touchmove", listener: this.i }, { Sa: "touchend", listener: this.i }, { Sa: "touchcancel", listener: this.i }]);
    this.L = { touchstart: "pointerdown", touchmove: "pointermove", touchend: "pointerup", touchcancel: "pointercancel" };
    this.J = (a2 = (a2 = a2.s) ? a2.N() : null) ? Array.prototype.slice.call(a2.querySelectorAll("a"), 0) : [];
  }
  u(Wo, Oo);
  Wo.prototype.i = function(a2) {
    var b2 = a2.touches, c2 = this.a.length(), d;
    if ("touchstart" === a2.type && c2 >= b2.length) {
      c2 = this.a.clone();
      for (d = b2.length; d--; )
        c2.remove(b2[d].identifier);
      for (d = c2.length(); d--; )
        this.a.remove((c2.a[d] || null).id);
      this.b = c2;
      Qo(this, "pointercancel", a2);
      this.b.clear();
    }
    if (this.L[a2.type]) {
      b2 = Bo(this.m.element);
      c2 = a2.type;
      d = a2.changedTouches;
      var e = d.length, f2;
      this.b.clear();
      for (f2 = 0; f2 < e; f2++) {
        var g = d[f2];
        var h = Lo(this.a, g.identifier);
        var k = g.pageX - b2.x;
        var l = g.pageY - b2.y;
        if (h)
          if ("touchmove" === c2) {
            g = Math.abs(h.viewportX - k);
            var m = Math.abs(h.viewportY - l);
            if (1 < g || 1 < m || 1 === g && 1 === m)
              Eo(h, k, l), this.b.push(h);
          } else
            "touchend" === c2 && (this.a.remove(h.id), this.b.push(h), Ho(h, Io.LEFT));
        else
          h = new Do(k, l, g.identifier, "touch", Io.LEFT, 1), this.a.push(h), this.b.push(h);
      }
      Qo(this, this.L[a2.type], a2);
      -1 === this.J.indexOf(a2.target) && a2.preventDefault();
    }
  };
  Wo.prototype.o = function() {
    this.J = null;
    Oo.prototype.o.call(this);
  };
  function Xo(a2) {
    var b2 = Yo(this);
    (window.PointerEvent || window.MSPointerEvent) && b2.push({ Sa: "MSHoldVisual", listener: "prevent" });
    Oo.call(this, a2, b2);
  }
  u(Xo, Oo);
  function Yo(a2) {
    var b2 = !!window.PointerEvent, c2, d, e = [];
    a2.i = A(a2.i, a2);
    "MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach(function(f2) {
      c2 = f2.toLowerCase().replace(/ms/g, "");
      d = b2 ? c2 : f2;
      e.push({ Sa: d, listener: a2.i, target: /^pointer(up|move)$/.test(c2) ? window : null });
    });
    return e;
  }
  var Zo = { 2: "touch", 3: "pen", 4: "mouse" };
  Xo.prototype.i = function(a2) {
    var b2 = window.PointerEvent ? a2.type : a2.type.toLowerCase().replace(/ms/g, ""), c2 = Bo(this.f), d = Lo(this.a, a2.pointerId), e = a2.pageX - c2.x;
    c2 = a2.pageY - c2.y;
    var f2 = Zo[a2.pointerType] || a2.pointerType;
    cd && "rtl" === x.getComputedStyle(this.m.element).direction && (e -= (x.devicePixelRatio - 1) * this.m.width);
    if (!(d || /^pointer(up|out|cancel)$/.test(b2) || "touch" === f2 && "pointerdown" !== b2)) {
      d = { x: e, y: c2 };
      var g = a2.pointerType;
      "number" === typeof g && (g = Zo[g]);
      d = new Do(d.x, d.y, a2.pointerId, g, a2.button, a2.buttons);
      this.a.push(d);
    }
    if (d) {
      if (/^pointer(up|cancel)$/.test(b2) ? ("touch" === f2 && this.a.remove(d.id), Ho(d, a2.button)) : "pointerdown" === b2 && ("touch" === a2.pointerType && (Mo(this.a, "mouse"), Mo(this.a, "pen")), Fo(d, a2.button)), this.b.push(d), "pointermove" !== b2)
        Eo(d, e, c2), Qo(this, /^pointer(over|out)$/.test(b2) ? "pointermove" : b2, a2);
      else if (d.viewportX !== e || d.viewportY !== c2)
        Eo(d, e, c2), Qo(this, b2, a2);
    }
    this.b.clear();
  };
  function $o(a2, b2, c2, d) {
    $o.j.constructor.call(this, "contextmenu");
    this.items = [];
    this.viewportX = a2;
    this.viewportY = b2;
    this.target = c2;
    this.originalEvent = d;
  }
  u($o, ud);
  t("H.mapevents.ContextMenuEvent", $o);
  function ap(a2) {
    this.ph = A(this.ph, this);
    this.rh = A(this.rh, this);
    this.qh = A(this.qh, this);
    this.J = false;
    this.i = -1;
    this.L = 0;
    ap.j.constructor.call(this, a2, [{ Sa: "contextmenu", listener: this.ph }, { target: a2, Sa: "longpress", listener: this.rh }, { target: a2, Sa: "dbltap", listener: this.qh }]);
  }
  u(ap, Oo);
  p = ap.prototype;
  p.rh = function(a2) {
    var b2 = a2.currentPointer;
    "touch" === b2.type && 1 === a2.pointers.length && bp(this, b2.viewportX, b2.viewportY, a2.originalEvent, a2.target);
  };
  p.qh = function(a2) {
    "touch" === a2.currentPointer.type && (this.L = Date.now());
  };
  p.ph = function(a2) {
    var b2 = this;
    -1 === this.i ? this.i = setTimeout(function() {
      var c2 = Bo(b2.f), d = a2.pageX - c2.x;
      c2 = a2.pageY - c2.y;
      b2.i = -1;
      bp(b2, d, c2, a2);
    }, this.Tg) : (clearInterval(this.i), this.i = -1);
    a2.preventDefault();
  };
  function bp(a2, b2, c2, d, e) {
    var f2 = a2.map, g = Date.now() - a2.L;
    e ? !a2.J && g > a2.Ch && (a2.J = true, e.dispatchEvent(new $o(b2, c2, e, d)), Fe(f2.N(), cp, a2.mj, false, a2)) : f2.Od(b2, c2, a2.Jn.bind(a2, b2, c2, d));
  }
  p.Jn = function(a2, b2, c2, d) {
    d = d && Da(d.dispatchEvent) ? d : this.map;
    bp(this, a2, b2, c2, d);
  };
  p.mj = function() {
    this.J && (this.J = false, this.map.dispatchEvent(new ud("contextmenuclose", this.map)));
  };
  p.o = function() {
    var a2 = this.map.N();
    clearInterval(this.i);
    a2 && Me(a2, cp, this.mj, false, this);
    Oo.prototype.o.call(this);
  };
  var cp = ["mousedown", "touchstart", "pointerdown", "wheel"];
  function dp(a2, b2, c2, d, e) {
    dp.j.constructor.call(this, "wheel");
    this.delta = a2;
    this.viewportX = b2;
    this.viewportY = c2;
    this.target = d;
    this.originalEvent = e;
  }
  u(dp, ud);
  t("H.mapevents.WheelEvent", dp);
  function ep(a2) {
    var b2 = "onwheel" in document;
    this.T = b2;
    this.L = (b2 ? "d" : "wheelD") + "elta";
    this.i = A(this.i, this);
    ep.j.constructor.call(this, a2, [{ Sa: (b2 ? "" : "mouse") + "wheel", listener: this.i }]);
    this.J = this.map.b;
  }
  u(ep, Oo);
  ep.prototype.i = function(a2) {
    if (!a2.kl) {
      var b2 = Bo(this.f);
      var c2 = a2.pageX - b2.x;
      b2 = a2.pageY - b2.y;
      var d = this.L, e = a2[d + (d + "Y" in a2 ? "Y" : "")], f2;
      cd && "rtl" === x.getComputedStyle(this.J.element).direction && (c2 -= (x.devicePixelRatio - 1) * this.J.width);
      if (e) {
        var g = Math.abs;
        var h = g(e);
        e = (!(f2 = a2[d + "X"]) || 3 <= h / g(f2)) && (!(f2 = a2[d + "Z"]) || 3 <= h / g(f2)) ? (+(0 < e) - +(0 > e)) * (this.T ? 1 : -1) : 0;
      }
      c2 = new dp(e, c2, b2, null, a2);
      c2.delta && (a2.stopImmediatePropagation(), a2.preventDefault(), this.map.Od(c2.viewportX, c2.viewportY, this.R.bind(this, c2)));
    }
  };
  ep.prototype.R = function(a2, b2) {
    var c2 = a2.target = b2 || this.map, d, e;
    setTimeout(function() {
      c2.dispatchEvent(a2);
      a2.c || (d = a2.originalEvent, e = new x.WheelEvent("wheel", d), e.kl = true, d.target.dispatchEvent(e));
    }, 0);
  };
  function fp(a2) {
    this.i = A(this.i, this);
    Oo.call(this, a2, [{ Sa: "mousedown", listener: this.i }, { Sa: "mousemove", listener: this.i, target: window }, { Sa: "mouseup", listener: this.i, target: window }, { Sa: "mouseover", listener: this.i }, { Sa: "mouseout", listener: this.i }, { Sa: "dragstart", listener: this.J }]);
  }
  u(fp, Oo);
  fp.prototype.i = function(a2) {
    var b2 = a2.type, c2 = Bo(this.f);
    c2 = { x: a2.pageX - c2.x, y: a2.pageY - c2.y };
    var d;
    (d = this.a.a[0] || null) || (d = new Do(c2.x, c2.y, 1, "mouse"), this.a.push(d));
    this.b.push(d);
    Eo(d, c2.x, c2.y);
    /^mouse(?:move|over|out)$/.test(b2) ? Qo(this, "pointermove", a2) : (/^mouse(down|up)$/.test(b2) && (c2 = a2.which - 1, "up" === Co.RegExp.$1 ? Ho(d, c2) : Fo(d, c2)), Qo(this, b2.replace("mouse", "pointer"), a2));
    this.b.clear();
  };
  fp.prototype.J = function(a2) {
    a2.preventDefault();
  };
  function gp(a2) {
    var b2 = a2.b.element.style;
    if (-1 !== hp.indexOf(a2))
      throw Error("InvalidArgument: map is already in use");
    this.a = a2;
    hp.push(a2);
    b2.msTouchAction = b2.touchAction = "none";
    dd || !window.PointerEvent && !window.MSPointerEvent ? (this.c = new Wo(this.a), this.b = new fp(this.a)) : this.c = new Xo(this.a);
    this.g = new ep(this.a);
    this.f = new ap(this.a);
    this.a.tb(this.F, this);
    qd.call(this);
  }
  u(gp, qd);
  t("H.mapevents.MapEvents", gp);
  var hp = [];
  Ic(hp);
  gp.prototype.F = function() {
    delete this.a;
    this.c.F();
    this.g.F();
    this.f.F();
    this.b && this.b.F();
    hp.splice(hp.indexOf(this.a), 1);
    qd.prototype.F.call(this);
  };
  gp.prototype.dispose = gp.prototype.F;
  gp.prototype.Nl = function() {
    return this.a;
  };
  gp.prototype.getAttachedMap = gp.prototype.Nl;
  function ip(a2, b2) {
    b2 = void 0 === b2 ? {} : b2;
    var c2;
    ip.j.constructor.call(this);
    if (-1 !== jp.indexOf(a2))
      throw new D(ip, 0, "events are already used");
    this.b = c2 = a2.a;
    this.l = a2;
    jp.push(a2);
    c2.draggable = true;
    this.i = b2.kinetics || { duration: 600, ease: em };
    this.s = b2.modifierKey || "Alt";
    this.enable(b2.enabled);
    this.c = c2.b;
    this.f = this.c.element;
    this.g = 0;
    c2.addEventListener("dragstart", this.Mh, false, this);
    c2.addEventListener("drag", this.bk, false, this);
    c2.addEventListener("dragend", this.Lh, true, this);
    c2.addEventListener("wheel", this.rk, false, this);
    c2.addEventListener(
      "dbltap",
      this.lk,
      false,
      this
    );
    c2.addEventListener("pointermove", this.ck, false, this);
    Ee(this.f, "contextmenu", this.ak, false, this);
    a2.tb(this.F, this);
  }
  u(ip, qd);
  t("H.mapevents.Behavior", ip);
  var jp = [];
  Ic(jp);
  ip.prototype.a = 0;
  var kp = { PANNING: 1, PINCH_ZOOM: 2, WHEEL_ZOOM: 4, DBL_TAP_ZOOM: 8, FRACTIONAL_ZOOM: 16, TILT: 32, HEADING: 64 };
  ip.Feature = kp;
  var lp = kp.PANNING, mp = kp.PINCH_ZOOM, np = kp.WHEEL_ZOOM, op = kp.DBL_TAP_ZOOM, pp = kp.FRACTIONAL_ZOOM, qp = kp.TILT, rp = kp.HEADING, sp = lp | mp | np | op | pp | qp | rp;
  ip.DRAGGING = lp;
  ip.WHEELZOOM = np;
  ip.DBLTAPZOOM = op;
  ip.FRACTIONALZOOM = pp;
  function tp(a2, b2) {
    if (a2 !== +a2 || a2 % 1 || 0 > a2 || 2147483647 < a2)
      throw new D(b2, 0, "integer in range [0...0x7FFFFFFF] required");
  }
  ip.prototype.disable = function(a2) {
    var b2 = this.a;
    a2 !== B ? (tp(a2, this.disable), b2 ^= b2 & a2) : b2 = 0;
    this.c.endInteraction(true);
    this.a = b2;
    this.b.draggable = 0 < (b2 & (lp | qp | rp | mp));
  };
  ip.prototype.disable = ip.prototype.disable;
  ip.prototype.enable = function(a2) {
    var b2 = this.a;
    a2 !== B ? (tp(a2, this.enable), b2 |= a2 & sp) : b2 = sp;
    this.a = b2;
    this.b.draggable = 0 < (b2 & (lp | qp | rp | mp));
  };
  ip.prototype.enable = ip.prototype.enable;
  ip.prototype.isEnabled = function(a2) {
    tp(a2, this.isEnabled);
    return a2 === (this.a & a2);
  };
  ip.prototype.isEnabled = ip.prototype.isEnabled;
  function up(a2, b2, c2) {
    var d = "touch" === b2.currentPointer.type, e = 0, f2;
    if (f2 = !d) {
      f2 = a2.s;
      var g, h = b2.originalEvent;
      h.getModifierState ? g = h.getModifierState(f2) : g = !!h[f2.replace(/^Control$/, "ctrl").toLowerCase() + "Key"];
      f2 = g;
    }
    f2 ? e |= qp | rp : (e |= lp, d && (b2 = b2.pointers, 2 === b2.length && (e |= mp | rp, c2 ? 55 > Dd(b2[0].viewportY - b2[1].viewportY) && (e |= qp) : a2.uh & Nl.TILT && (e |= qp))));
    e &= a2.a;
    return (e & qp ? Nl.TILT : 0) | (e & rp ? Nl.HEADING : 0) | (e & mp ? Nl.ZOOM : 0) | (e & lp ? Nl.COORD : 0);
  }
  function vp(a2) {
    var b2 = a2.pointers;
    a2 = b2[0];
    b2 = b2[1];
    a2 = [a2.viewportX, a2.viewportY];
    b2 && a2.push(b2.viewportX, b2.viewportY);
    return a2;
  }
  p = ip.prototype;
  p.uh = 0;
  p.Mh = function(a2) {
    var b2 = up(this, a2, true);
    if (this.uh = b2) {
      var c2 = this.c;
      a2 = vp(a2);
      c2.startInteraction(b2, this.i);
      c2.interaction.apply(c2, a2);
      if (this.a & np && !(this.a & pp) && (b2 = a2[0], c2 = a2[1], this.g)) {
        a2 = this.b.pb();
        var d = (0 > this.g ? Cd : Bd)(a2);
        a2 !== d && (this.g = 0, wp(this, a2, d, b2, c2));
      }
    }
  };
  p.bk = function(a2) {
    var b2 = up(this, a2, false);
    if (b2 !== this.uh)
      "pointerout" !== a2.originalEvent.type && "pointerover" !== a2.originalEvent.type && (this.Lh(a2), this.Mh(a2));
    else if (b2) {
      b2 = this.c;
      var c2 = vp(a2);
      b2.interaction.apply(b2, c2);
      a2.originalEvent.preventDefault();
    }
  };
  p.Lh = function(a2) {
    up(this, a2, false) && this.c.endInteraction(!this.i);
  };
  function wp(a2, b2, c2, d, e) {
    var f2 = +c2 - +b2;
    a2 = a2.b.c;
    if (isNaN(+b2))
      throw Error("start zoom needs to be a number");
    if (isNaN(+c2))
      throw Error("to zoom needs to be a number");
    0 !== f2 && (a2.startControl(null, d, e), a2.control(0, 0, 6, 0, 0, 0), a2.endControl(true, function(g) {
      g.zoom = c2;
    }));
  }
  p.rk = function(a2) {
    if (!a2.defaultPrevented && this.a & np) {
      var b2 = a2.delta;
      var c2 = this.b.pb();
      var d = this.b;
      var e = d.f.type;
      d = this.a & pp ? c2 - b2 : (0 > -b2 ? Cd : Bd)(c2) - b2;
      if (e === kk.P2D || e === kk.WEBGL || e === kk.HARP)
        wp(this, c2, d, a2.viewportX, a2.viewportY), this.g = b2;
      a2.preventDefault();
    }
  };
  p.ck = function() {
  };
  p.lk = function(a2) {
    var b2 = a2.currentPointer, c2 = this.b.pb(), d = a2.currentPointer.type, e = this.b.f.type;
    (e === kk.P2D || e === kk.WEBGL || e === kk.HARP) && this.a & op && (a2 = "mouse" === d ? 0 === a2.originalEvent.button ? -1 : 1 : 0 < a2.pointers.length ? 1 : -1, a2 = this.a & pp ? c2 - a2 : (0 > -a2 ? Cd : Bd)(c2) - a2, wp(this, c2, a2, b2.viewportX, b2.viewportY));
  };
  p.ak = function(a2) {
    return this.a & op ? (a2.preventDefault(), false) : true;
  };
  p.F = function() {
    var a2 = this.b;
    a2 && (a2.draggable = false, a2.removeEventListener("dragstart", this.Mh, false, this), a2.removeEventListener("drag", this.bk, false, this), a2.removeEventListener("dragend", this.Lh, true, this), a2.removeEventListener("wheel", this.rk, false, this), a2.removeEventListener("dbltap", this.lk, false, this), a2.removeEventListener("pointermove", this.ck, false, this), delete this.b);
    this.f && (this.f.style.msTouchAction = "", Me(this.f, "contextmenu", this.ak, false, this), delete this.f);
    delete this.c;
    delete this.i;
    jp.splice(
      jp.indexOf(this.l),
      1
    );
    delete this.l;
    qd.prototype.F.call(this);
  };
  ip.prototype.dispose = ip.prototype.F;
  t("H.mapevents.buildInfo", function() {
    return Hf("H-mapevents", "1.49.1", "74e5afb", { region: "row" });
  });
  S.prototype.J = ca(3, function(a2) {
    var b2 = this.getCache(), c2 = this;
    if (a2 !== z) {
      C(a2, Rk, S.prototype.J, 0);
      var d = a2;
    } else
      d = yl;
    d !== b2 && b2.na(function(e, f2, g) {
      return c2.ub(e) ? (d.add(e, f2, g), true) : false;
    });
    this.P = d;
  });
  ti.prototype.a = ca(2, function(a2) {
    this.f = a2;
    a2 = this.getState();
    a2 !== Xh.INIT && a2 !== Xh.LOADING && Ai(this);
  });
  function xp(a2) {
    a2 = a2.uc("_#-;,:", "_#-;,:", "_#-;,:");
    return new RegExp("^" + a2.replace(/[.*+?^${}()|[\]\\\/]/g, "\\$&").replace(/_#-;,:/g, "\\d+") + "$");
  }
  function yp(a2, b2) {
    Ya.apply(null, arguments);
    return a2;
  }
  function zp(a2, b2) {
    var c2 = x.console;
    c2 && c2.warn && (a2 = yc(a2) + " is deprecated and will be removed soon. ", b2 && (a2 += b2), c2.warn(a2));
  }
  var Ap = globalThis;
  tc("monospace serif");
  function Bp() {
  }
  Bp.prototype.pop = function(a2) {
    this[a2] || (this[a2] = []);
    return this[a2].pop() || document.createElement("canvas");
  };
  Bp.prototype.push = function(a2, b2) {
    this[b2] || (this[b2] = []);
    this[b2].push(a2);
  };
  var Cp = new Bp();
  t("H.service.util.eval", function(a) {
    return eval(a);
  });
  function W(a2, b2, c2, d, e, f2) {
    if (a2 && b2)
      this.Bi(a2), this.af(b2), this.wd(c2), this.xi(e), this.Lk(f2), this.bf(d);
    else
      throw new D(W, B, 'Parameters "scheme" and "host" must be specified');
  }
  t("H.service.Url", W);
  function Dp(a2, b2) {
    var c2 = x.document, d;
    var e = "";
    if (c2) {
      e = c2.createElement("a");
      if (b2) {
        var f2 = (d = c2.getElementsByTagName("base")[0]) && d.href;
        var g = c2.head;
        var h = d || g.appendChild(c2.createElement("base"));
        h.href = b2;
      }
      e.href = a2;
      e = e.href;
      b2 && (d ? d.href = f2 : g.removeChild(h));
    } else
      /[\w]+:\/\//.test(a2) && (e = a2);
    f2 = /(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(e);
    a2 = f2[1];
    g = f2[4];
    b2 = f2[5];
    h = f2[6];
    c2 = f2[7];
    d = f2[8];
    !f2[2] && g && /@/.test(g) && (g = g.split("@")[1]);
    f2 = W;
    h = h && 0 < h.length ? h.substr(1) : "";
    e = {};
    var k, l;
    if (c2)
      for (k = /([?&]?([^=&+]+))(=([^&]+))?/g; l = k.exec(c2); )
        e[decodeURIComponent(l[2])] = l[4] ? decodeURIComponent(l[4]) : void 0;
    return new f2(a2, g, h, e, isNaN(+b2) ? void 0 : +b2, d && 0 < d.length ? d.substr(1) : "");
  }
  W.parse = Dp;
  W.prototype.clone = function() {
    var a2 = {}, b2;
    for (b2 in this.a)
      a2[b2] = this.a[b2];
    return new W(this.i, this.c, this.b, a2, this.g, this.f);
  };
  W.prototype.clone = W.prototype.clone;
  W.prototype.Bi = function(a2) {
    if (!a2 || "string" !== typeof a2)
      throw new D(this.Bi, 0, 'The "scheme" parameter must be a non-empty string.');
    this.i = a2;
    return this;
  };
  W.prototype.setScheme = W.prototype.Bi;
  W.prototype.Vm = function() {
    return this.i;
  };
  W.prototype.getScheme = W.prototype.Vm;
  W.prototype.af = function(a2) {
    if (!a2 || "string" !== typeof a2 || "-" === a2.charAt(0) || "." === a2.charAt(0) || "." === a2.charAt(a2.length - 1))
      throw new D(this.af, 0, 'The "host" parameter is not a valid host name.');
    this.c = a2;
    return this;
  };
  W.prototype.setHost = W.prototype.af;
  W.prototype.om = function() {
    return this.c;
  };
  W.prototype.getHost = W.prototype.om;
  W.prototype.wd = function(a2) {
    this.b = a2 || void 0;
    return this;
  };
  W.prototype.setPath = W.prototype.wd;
  W.prototype.Hm = function() {
    return this.b;
  };
  W.prototype.getPath = W.prototype.Hm;
  W.prototype.bf = function(a2) {
    if (a2)
      if ("object" == typeof a2)
        this.a = a2;
      else
        throw new D(this.bf, 0, 'Parameter "params" must be an object.');
    else
      this.a = {};
    return this;
  };
  W.prototype.setQuery = W.prototype.bf;
  W.prototype.Mj = function() {
    return !Ep(this);
  };
  W.prototype.hasQuery = W.prototype.Mj;
  W.prototype.getQuery = function() {
    return this.a;
  };
  W.prototype.getQuery = W.prototype.getQuery;
  W.prototype.xi = function(a2) {
    if (void 0 === a2)
      this.g = a2;
    else {
      var b2 = ae(+a2 << 0, 0, 65535);
      if (b2 != a2)
        throw new D(this.xi, 0, 'Parameter "port" must be an integer in range [0...65535]');
      this.g = b2;
    }
    return this;
  };
  W.prototype.setPort = W.prototype.xi;
  W.prototype.Mm = function() {
    return this.g;
  };
  W.prototype.getPort = W.prototype.Mm;
  W.prototype.Lk = function(a2) {
    this.f = a2 || void 0;
    return this;
  };
  W.prototype.setAnchor = W.prototype.Lk;
  W.prototype.kd = function() {
    return this.f;
  };
  W.prototype.getAnchor = W.prototype.kd;
  W.prototype.I = function(a2) {
    if ("object" !== typeof a2)
      throw new D(this.I, 0, 'Parameter "other" must be an object.');
    var b2 = this.a, c2;
    for (c2 in a2)
      a2.hasOwnProperty(c2) && "function" !== typeof a2[c2] && (b2[c2] = a2[c2]);
    return this;
  };
  W.prototype.mergeQuery = W.prototype.I;
  W.prototype.Ba = function(a2) {
    if (!a2 || "string" !== typeof a2)
      throw new D(this.Ba, 0, 'Parameter "subDomain" must be a non-empty string');
    "." === a2.substr(a2.length - 1) && (a2 = a2.substr(0, a2.length - 1));
    return this.af(a2 + "." + this.c);
  };
  W.prototype.addSubDomain = W.prototype.Ba;
  W.prototype.G = function(a2) {
    if (!a2 || "string" !== typeof a2)
      throw new D(this.G, 0, 'Parameter "subPath" must be a non-empty string');
    return this.wd((this.b ? this.b + "/" : "") + a2);
  };
  W.prototype.addSubPath = W.prototype.G;
  W.prototype.toString = function() {
    return [this.i + "://", this.c, this.g ? ":" + this.g : "", this.b || !Ep(this) || this.f ? "/" : "", this.b ? encodeURI(this.b) : "", Fp(this), this.f ? "#" + encodeURIComponent(this.f) : ""].join("");
  };
  W.prototype.toString = W.prototype.toString;
  function Gp(a2) {
    return encodeURIComponent(a2).replace(/[!'()*]/g, function(b2) {
      return "%" + b2.charCodeAt(0).toString(16);
    });
  }
  function Fp(a2) {
    var b2 = [], c2 = a2.a, d = {}, e;
    for (e in c2) {
      if (c2.hasOwnProperty(e) && "function" !== typeof c2[e]) {
        var f2 = a2.a[e];
        d.yd = Gp(e);
        C(f2, Hp) ? f2.a.forEach(function(g) {
          return function(h) {
            b2.push(g.yd + "=" + Gp(h));
          };
        }(d)) : C(f2, Ip) ? b2.push(d.yd + "=" + f2.b.map(function(g) {
          return Gp(g);
        }).join(f2.a)) : b2.push(void 0 === f2 ? d.yd : d.yd + "=" + Gp(f2));
      }
      d = { yd: d.yd };
    }
    return 0 < b2.length ? "?" + b2.join("&") : "";
  }
  function Jp(a2) {
    var b2 = Hf("H-service", "1.49.1", "74e5afb", { region: "row" });
    a2.a.xnlp = "CL_JSMv3." + b2.version;
    return a2;
  }
  function Ep(a2) {
    var b2, c2 = 0;
    for (b2 in a2.a)
      if (a2.a.hasOwnProperty(b2) && "function" !== typeof a2.a[b2] && (c2++, 0 < c2))
        break;
    return !c2;
  }
  function Kp(a2, b2) {
    if (Bc(a2))
      for (var c2 = 0; c2 < a2.length; c2++) {
        var d = a2[c2];
        if (!Cc(d) && !Fc(d)) {
          var e = "The Array does not contain only strings and numbers";
          break;
        }
      }
    else
      e = "Not an Array";
    if (e)
      throw new D(b2, 0, a2);
    return a2;
  }
  function Hp(a2) {
    this.a = Kp(a2, Hp);
  }
  W.MultiValueQueryParameter = Hp;
  Hp.prototype.fn = function() {
    return this.a;
  };
  Hp.prototype.getValues = Hp.prototype.fn;
  function Ip(a2, b2) {
    this.b = Kp(a2, Ip);
    if (!/^[!\$\(\)\*\+,;]$/.test(b2))
      throw new D(Ip, 1, 'Invalid delimiter "' + b2 + '"');
    this.a = b2;
  }
  W.DelimitedQuerySubValues = Ip;
  function Lp(a2, b2) {
    C(a2, Mp, Lp, 0);
    var c2 = {};
    Object.assign(c2, b2);
    c2.min = c2.min || 0;
    c2.max = c2.max || 20;
    c2.tileSize = c2.tileSize || 512;
    c2.getURL = function(d, e, f2) {
      return a2.v().clone().G(a2.b.og + "/" + (a2.b.eg + "/") + (f2 + "/" + d + "/" + e + "/") + a2.b.format).I(a2.f).clone().I({ size: c2.tileSize });
    };
    Ek.call(this, c2);
    this.i = a2;
  }
  u(Lp, Ek);
  t("H.service.rasterTile.Provider", Lp);
  Lp.prototype.ba = function(a2, b2) {
    var c2 = this.i;
    return Np(c2.ba(), c2.b.og + "." + c2.V(), b2, a2);
  };
  Lp.prototype.getCopyrights = Lp.prototype.ba;
  Lp.prototype.l = function() {
    return od();
  };
  Lp.prototype.c = function() {
    return od() ? nd() : Lp.j.c.call(this);
  };
  function X(a2) {
    a2 = yp({}, this.b, a2);
    var b2 = a2.apikey || a2.apiKey, c2 = a2.baseUrl;
    if (c2 = b2 ? c2 ? 0 : "baseUrl" : "apikey")
      throw new D(X, 0, '"' + c2 + '" must be specified');
    this.Nk(a2.baseUrl);
    this.a = b2;
    this.Yb.I({ apikey: b2 });
    this.c = a2.headers || {};
    this.f = Wa(a2.servicesConfig || {});
  }
  t("H.service.Platform", X);
  X.prototype.b = { apikey: null, baseUrl: new W("https", "hereapi" + (Mn ? ".cn" : ".com")) };
  X.prototype.Nk = function(a2) {
    this.Yb = Jp(a2.clone());
    this.a = a2 = this.a;
    this.Yb.I({ apikey: a2 });
  };
  X.prototype.setBaseUrl = X.prototype.Nk;
  X.prototype.Ib = function() {
    return this.Yb;
  };
  X.prototype.getBaseUrl = X.prototype.Ib;
  X.prototype.Ma = function(a2, b2) {
    try {
      return a2.Qf = true, new a2(yp({ platformBaseUrl: this.Ib(), headers: this.c }, this.f[a2.CONFIG_KEY] || {}, b2 || {}));
    } finally {
      a2.Qf = false;
    }
  };
  X.prototype.createService = X.prototype.Ma;
  X.prototype.xf = function(a2, b2, c2) {
    var d = this;
    if (!H.map.render.harp)
      throw Error("HARP engine module not found");
    if (!Ea(a2) && !Cc(a2))
      throw new D(this.xf, 0, "is invalid: must be either a configuration object or a URL");
    if (!Da(b2))
      throw new D(this.xf, 1, "is invalid: must be a Function");
    if (!Da(c2))
      throw new D(this.xf, 2, "is invalid: must be a Function");
    var e = new H.map.render.harp.Style(a2);
    e.addEventListener("change", function() {
      var f2 = e.getState();
      if (-1 === f2)
        c2(Error("H.service.platform#createHybridLayers method failed to load style configuration"));
      else if (2 === f2) {
        f2 = { dark: true };
        var g = d.lh({ resource: "background", queryParams: { style: "satellite.day" } }), h = e.qc(), k = { styles: [{ technique: "raster", attr: { gamma: 1, brightness: 1 } }] };
        h.definitions && (void 0 !== h.definitions["Satellite.Texture.Gamma"] && (k.styles[0].attr.gamma = h.definitions["Satellite.Texture.Gamma"]), void 0 !== h.definitions["Satellite.Texture.Brightness"] && (k.styles[0].attr.brightness = h.definitions["Satellite.Texture.Brightness"]));
        g = new Lp(g, { engineType: Qn, style: new H.map.render.harp.Style(k) });
        b2({ raster: new sl(g, f2), vector: d.He().$b(e, { engineType: Qn }, f2), traffic: d.oh().$b(e, { engineType: Qn }, f2) });
      }
    });
    e.load();
  };
  X.prototype.createHybridLayers = X.prototype.xf;
  X.prototype.wf = function(a2, b2, c2, d, e, f2) {
    function g(rb, Fa, bc) {
      Fa = rb.f(Fa);
      Fa = r ? new ti(Fa) : new H.map.render.harp.Style(Fa);
      var ad = { engineType: l };
      n && n.politicalView && (ad.politicalView = n.politicalView);
      c2 && (ad.lg = c2);
      d && (ad.lg2 = d);
      f2 && (ad.pois = f2);
      var wc;
      bc && (wc = { dark: bc });
      return rb.$b(Fa, ad, wc);
    }
    function h(rb, Fa, bc, ad, wc) {
      return rb.nc(Fa, bc, v, ad, w, 1, wc, m);
    }
    var k = this, l = jk, m = { crossOrigin: "anonymous" };
    if (Ea(a2)) {
      var n = a2;
      "crossOrigin" in n && (m.crossOrigin = n.crossOrigin);
      a2 = n.tileSize;
      b2 = n.ppi;
      c2 = n.lg;
      d = n.lg2;
      e = n.style;
      f2 = n.pois;
      void 0 !== n.engineType && (l = n.engineType, m.engineType = l);
    }
    var q = l === kk.HARP, r = l === kk.WEBGL, v = a2 || 512, w = {};
    if (0 > [72, 250, 320, 500].indexOf(+b2)) {
      if (b2 !== B)
        throw new D(this.wf, 1, b2);
    } else
      w.ppi = +b2;
    c2 && (w.lg = c2);
    d && (w.lg2 = d);
    e && (w.style = e);
    f2 && (w.pois = !!f2);
    if (q && !H.map.render.harp)
      throw new D(this.wf, 0, "HARP engine is not supported, module not found");
    a2 = {};
    if (Mn)
      yp(a2, { vector: { normal: { map: g(this.He(), "harp/oslo/normal.day.json") } } });
    else {
      e = this.ih();
      var y = this.ih({ type: "aerial" }), G = this.nh(), I = G.ej(w.lg ? { lg: w.lg, i18n: true, engineType: l } : { engineType: l });
      yp(a2, { raster: { normal: { xbase: h(e, "xbasetile", "normal.day", "png8", false), xbasenight: h(e, "xbasetile", "normal.night", "png8", true), base: h(e, "basetile", "normal.day", "png8", false), basenight: h(e, "basetile", "normal.night", "png8", true), map: h(e, "maptile", "normal.day", "png8", false), mapnight: h(e, "maptile", "normal.night", "png8", true), trafficincidents: I, transit: h(e, "maptile", "normal.day.transit", "png8", false), labels: h(e, "labeltile", "normal.day", "png", false) }, satellite: { xbase: h(
        y,
        "xbasetile",
        "hybrid.day",
        "jpg",
        true
      ), base: h(y, "basetile", "hybrid.day", "jpg", true), map: h(y, "maptile", "hybrid.day", "jpg", true), labels: h(y, "labeltile", "hybrid.day", "png", true) }, terrain: { xbase: h(y, "xbasetile", "terrain.day", "jpg", false), base: h(y, "basetile", "terrain.day", "jpg", false), map: h(y, "maptile", "terrain.day", "jpg", false), labels: h(y, "labeltile", "terrain.day", "png", false) } } });
      if (q || r) {
        yp(a2, { vector: { normal: { traffic: G.dj(void 0, l), trafficincidents: I } } });
        e = this.He();
        r ? (a2.vector.normal.map = g(e, "omv/miami/normal.day.yaml"), a2.vector.normal.truck = g(e, "omv/miami/truck.day.yaml")) : q && (a2.vector.normal.map = g(e, "harp/oslo/normal.day.json"), a2.vector.normal.truck = g(e, "harp/oslo/normal.day.json"));
        e = this.oh();
        if (q) {
          var Q = { ppi: 72 < b2 ? 400 : 100, size: 256 < v ? 512 : 256, features: "pois:" + (true === f2 || Cc(f2) && /[^0]/.test(f2) ? "all" : "disabled") };
          c2 && (Q.lang = c2);
          d && (Q.lang2 = d);
          n && n.politicalView && (Q.pview = n.politicalView);
          b2 = { dark: true };
          y = function(rb, Fa, bc, ad, wc) {
            var Jb = yp({}, Q);
            /^explore\./.test(bc) || delete Jb.features;
            rb = k.lh({ format: Fa, resource: rb, queryParams: yp(
              { style: bc },
              Jb
            ) });
            wc = new Lp(rb, { engineType: l, style: wc });
            return new sl(wc, ad);
          };
          yp(a2.raster.normal, { base: y("background", "png8", "explore.day"), basenight: y("background", "png8", "explore.night", b2), map: y("base", "png8", "explore.day"), mapnight: y("base", "png8", "explore.night", b2), labels: y("label", "png", "explore.day") });
          yp(a2.raster.satellite, { xbase: y("background", "jpeg", "satellite.day", b2), base: y("background", "jpeg", "explore.satellite.day", b2), map: y("base", "jpeg", "explore.satellite.day", b2), labels: y("label", "png", "explore.satellite.day") });
          G = this.He();
          yp(a2.vector.normal, { mapnight: g(G, "harp/oslo/normal.night.json", true), lite: g(G, "harp/oslo/lite.day.json"), litenight: g(G, "harp/oslo/lite.night.json", true), ism: g(G, "harp/oslo/ism.day.json"), ismnight: g(G, "harp/oslo/ism.night.json", true) });
          I = { styles: [{ technique: "raster", attr: { gamma: ["interpolate", ["linear"], ["zoom"], 0, 1, 13, 1.2, 17, 1.3], brightness: ["interpolate", ["linear"], ["zoom"], 0, 0.7, 13, 0.9, 17, 1] } }] };
          for (var V = [], Ba = 0; 4 > Ba; Ba++) {
            var ha = new H.map.render.harp.Style(JSON.parse(JSON.stringify(I)));
            ha = y("background", "jpeg", "satellite.day", b2, ha);
            V.push(ha);
          }
          a2.hybrid = { day: { raster: V[0], vector: g(G, "harp/oslo/hybrid.day.json", true), traffic: g(e, "harp/oslo/hybrid.day.json", true) }, night: { raster: V[1], vector: g(G, "harp/oslo/hybrid.night.json", true), traffic: g(e, "harp/oslo/hybrid.night.json", true) }, liteday: { raster: V[2], vector: g(G, "harp/oslo/lite.hybrid.day.json", true), traffic: g(e, "harp/oslo/lite.hybrid.day.json", true) }, litenight: { raster: V[3], vector: g(G, "harp/oslo/lite.hybrid.night.json", true), traffic: g(
            e,
            "harp/oslo/lite.hybrid.night.json",
            true
          ) } };
        }
        b2 = { traffic: {} };
        b2.traffic.map = g(e, r ? "traffic/vector.tile.yaml" : "harp/oslo/normal.day.json");
        q && (b2.traffic.mapnight = g(e, "harp/oslo/normal.night.json"), b2.traffic.lite = g(e, "harp/oslo/lite.day.json"), b2.traffic.litenight = g(e, "harp/oslo/lite.night.json"));
        yp(a2.vector, b2);
      }
    }
    return a2;
  };
  X.prototype.createDefaultLayers = X.prototype.wf;
  function Op(a2, b2) {
    b2 = void 0 === b2 ? {} : b2;
    if (!a2.Qf)
      throw new $c(a2);
    Op.j.constructor.call(this);
    var c2 = Pp(this, b2);
    if (!c2.baseUrl && !c2.platformBaseUrl)
      throw new D(a2, 0, 'either "baseUrl" or "platformBaseUrl" must be specified');
    this.i = (c2.baseUrl ? c2.baseUrl : c2.platformBaseUrl).clone();
    a2 = c2.baseUrl ? b2 : c2;
    a2.host && this.i.af(a2.host);
    a2.subDomain && this.i.Ba(a2.subDomain);
    a2.path && this.i.wd(a2.path);
    Jp(this.i);
    this.g = c2.headers || {};
  }
  u(Op, F);
  t("H.service.Service", Op);
  function Pp(a2, b2) {
    a2 = a2.Aa();
    return b2 ? yp({}, a2, b2) : a2;
  }
  Op.prototype.Aa = function() {
    return {};
  };
  Op.prototype.v = function() {
    return this.i;
  };
  Op.prototype.getUrl = Op.prototype.v;
  Op.prototype.B = function(a2, b2, c2, d) {
    d = new tf(void 0 === d ? "application/json" : d, a2.toString(), je, { headers: this.g });
    d.then(b2, Qp(this, a2, c2));
    return d;
  };
  function Qp(a2, b2, c2) {
    return function(d) {
      return "function" !== typeof d.json ? Promise.reject(c2(Rp(b2, d))) : d.json().then(function(e) {
        return c2(a2.a(e));
      }, function() {
        return c2(Rp(b2, d));
      });
    };
  }
  Op.prototype.a = function(a2) {
    return Error(a2.message);
  };
  function Rp(a2, b2) {
    return Error((b2.statusText ? "[" + b2.statusText + "] " : "") + a2 + " request failed");
  }
  ;
  function Sp(a2) {
    Sp.j.constructor.call(this, Sp, a2);
  }
  u(Sp, Op);
  t("H.service.traffic.Service7", Sp);
  Sp.prototype.Aa = function() {
    return { subDomain: "data.traffic", path: "v7" };
  };
  Sp.CONFIG_KEY = "traffic_v7";
  Sp.prototype.qo = function(a2, b2, c2, d) {
    a2 = this.v().clone().G(["incidents", a2].join("/")).I(b2 || {});
    return this.B(a2, c2, d);
  };
  Sp.prototype.requestIncidentById = Sp.prototype.qo;
  Sp.prototype.oo = function(a2, b2, c2) {
    a2 = this.v().clone().G("flow").I(a2 || {});
    return this.B(a2, b2, c2);
  };
  Sp.prototype.requestFlowByArea = Sp.prototype.oo;
  Sp.prototype.so = function(a2, b2, c2) {
    a2 = this.v().clone().G("incidents").I(a2 || {});
    return this.B(a2, b2, c2);
  };
  Sp.prototype.requestIncidentsByArea = Sp.prototype.so;
  function Tp(a2) {
    if (!a2 || !Da(a2.requestData))
      throw new D(Tp, 0, "options.requestData");
    Tp.j.constructor.call(this, a2);
    this.L = a2.requestData;
    this.D = !!a2.providesDomMarkers;
  }
  u(Tp, S);
  t("H.map.provider.MarkerTileProvider", Tp);
  Tp.prototype.B = function(a2, b2, c2, d, e) {
    var f2 = this;
    return this.L(a2, b2, c2, function(g) {
      for (var h = [], k, l, m = g.length; m--; )
        l = g[m], l.Ho = f2.getTileKey(a2, b2, c2), l.ka(f2), k = l.xb(), (C(l, bj) || 1 === k.getState()) && h.push(g[m]);
      d(h);
    }, e);
  };
  Tp.prototype.requestInternal = Tp.prototype.B;
  Tp.prototype.Td = function(a2, b2) {
    b2 === kh.VISUAL && (a2 = this.nb().get(a2.Ho)) && (a2.valid = false, this.Va(a2));
  };
  Tp.prototype.invalidateObject = Tp.prototype.Td;
  Tp.prototype.Qb = function() {
    return this.D;
  };
  Tp.prototype.providesDomMarkers = Tp.prototype.Qb;
  Tp.prototype.Rb = ff;
  Tp.prototype.providesMarkers = Tp.prototype.Rb;
  function Up() {
    this.a = {};
  }
  Up.prototype.xb = function(a2, b2) {
    var c2 = a2 + b2, d;
    if (d = this.a[c2])
      return d;
    a2 = Vp.MARKER.replace("{{icon}}", Wp[a2] || Wp.OTHER);
    a2 = a2.replace("{{color}}", Xp[b2] || Xp.BLOCKING);
    b2 = { size: { w: 26, h: 33 }, anchor: { x: 13, y: 30 }, hitArea: new Xi(Yi.POLYGON, Yp.MARKER) };
    return this.a[c2] = d = new Wj(a2, b2);
  };
  var Vp = { MARKER: '<svg width="26" height="33" enable-background="new 0 0 26 33" viewBox="0 0 26 33" xmlns="http://www.w3.org/2000/svg"><path d="m26 33h-26v-33h26z" fill="#8c8c8c" opacity="0"/><path d="m17 29.566c0 1.116-1.791 2.022-4 2.022s-4-.906-4-2.022c0-1.118 1.791-2.026 4-2.026s4 .908 4 2.026" fill="#878787" opacity=".6"/><path d="m1.795 17.971c-1.562-1.555-1.574-3.828-.028-5.655l8.343-10.021c.769-.895 1.795-1.384 2.894-1.384 1.117 0 2.197.521 2.889 1.394l8.338 10.014c1.588 1.854 1.578 4.022-.029 5.65l-11.202 11.202z" fill="{{color}}"/>{{icon}}</svg>' }, Wp = {
    CONGESTION: '<path style="fill:#FFFFFF;" d="M12.966,1.177c0.965,0,1.894,0.442,2.496,1.204l8.378,10.258c1.362,1.592,1.482,3.477,0,4.979L12.994,28.464L2.143,17.618c-1.381-1.375-1.38-3.348,0-4.979l8.314-10.258C11.174,1.547,12.085,1.177,12.966,1.177 M12.967,0.177L12.967,0.177c-1.247,0-2.408,0.551-3.269,1.552l-8.332,10.28c-1.711,2.022-1.688,4.567,0.07,6.317l10.85,10.845l0.707,0.707l0.707-0.707l10.847-10.846c1.784-1.807,1.803-4.292,0.053-6.337L16.237,1.748C15.462,0.769,14.236,0.177,12.967,0.177L12.967,0.177z M16.645,10.405l-2.025-2.22c-0.48-0.51-1.15-0.8-1.84-0.8H9.53c-0.69,0-1.36,0.29-1.84,0.8l-1.94,2.22c-0.39,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.44l0.255-0.539c0.204-0.431,0.456-0.837,0.753-1.21l0.962-1.211l0.83-0.9c0.32-0.35,0.72-0.63,1.15-0.82H8.23c-0.28,0-0.55-0.07-0.79-0.22l-0.28-0.17l1.27-1.45c0.28-0.31,0.68-0.48,1.1-0.48h3.25c0.42,0,0.82,0.17,1.1,0.48l1.354,1.54H16.645z M18.31,12.205c-0.35-0.37-0.81-0.63-1.3-0.74c-0.18-0.04-0.36-0.06-0.54-0.06h-3.24c-0.7,0-1.37,0.29-1.84,0.8l-1.13,1.22l-0.82,1c-0.38,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.75v-1h5.99v1h1.75c0.69,0,1.25-0.56,1.25-1.25v-1.64c0-0.74-0.2-1.46-0.59-2.09L18.31,12.205z M12.1,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C12.35,16.993,12.238,17.105,12.1,17.105z M18.59,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C18.84,16.993,18.728,17.105,18.59,17.105z M18.56,14.505c-0.24,0.15-0.51,0.22-0.79,0.22h-5.85c-0.28,0-0.55-0.07-0.78-0.22l-0.29-0.17l1.27-1.45c0.15-0.16,0.33-0.28,0.53-0.37c0.18-0.07,0.38-0.11,0.58-0.11h3.24c0.24,0,0.48,0.06,0.68,0.16c0.16,0.08,0.3,0.19,0.42,0.32l1.27,1.45L18.56,14.505z M8.42,13.03h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C8.67,12.918,8.559,13.03,8.42,13.03z"/>',
    ROADWORKS: '<path d="m13.004 1.411c.964 0 1.894.441 2.496 1.204l8.346 10.023c1.363 1.592 1.482 3.477 0 4.979l-10.846 10.847-10.852-10.846c-1.381-1.375-1.379-3.348 0-4.979l8.346-10.023c.717-.835 1.628-1.205 2.51-1.205m0-1c-1.248 0-2.408.551-3.268 1.552l-8.356 10.035c-1.718 2.033-1.695 4.578.064 6.328l10.85 10.845.706.707.707-.707 10.846-10.846c1.784-1.808 1.803-4.293.053-6.337l-8.337-10.012c-.769-.973-1.996-1.565-3.265-1.565zm-.575 15.264c.018-.332-.13-.651-.394-.851l-2.945-2.235-.21.36c-.22.39-.41.78-.58 1.19l-.677 2.129-1.364 3.051h1.314l2.109-4.672 1.317 1.212.138 3.46h1.092zm6.16-1.327c-.401-.54-1.209-.539-1.609.001l-1.17 1.58-2.29-1.74-.139-4.054c-.011-.276-.134-.535-.342-.716l-.7-.61c-.185-.161-.422-.25-.667-.25h-1.885c-.335 0-.648.168-.833.447l-1.144 1.723 7.58 5.76-1.86 2.51c-.098.132-.004.32.161.32h6.648l1.142-1.077zm-8.79-2.989-.876-.665.841-1.018.965.043zm1.63 1.24.969-1.781.118 2.61zm2.76-5.79c-.64 0-1.16.52-1.16 1.16 0 .65.52 1.17 1.16 1.17s1.16-.52 1.16-1.17c0-.64-.52-1.16-1.16-1.16z" fill="#fff"/>',
    ACCIDENT: '<path style="fill:#FFFFFF;" d="M12.998,1.091c0.964,0,1.894,0.442,2.496,1.204l8.346,10.344c1.363,1.592,1.482,3.477,0,4.979L12.994,28.465L2.143,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.344C11.205,1.462,12.115,1.091,12.998,1.091 M12.998,0.091L12.998,0.091c-1.248,0-2.408,0.551-3.269,1.552L1.364,12.011c-1.708,2.021-1.685,4.566,0.073,6.316l10.85,10.845l0.707,0.707l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337l-8.327-10.32C15.494,0.684,14.268,0.091,12.998,0.091L12.998,0.091z M7.83,18.982l-3.309-1.855l0.945,1.855H7.83z M16.111,19h3.942l1.596-2L16.111,19z M10.512,20.064l1.021-1.021l1.632,0.076c0.329,0.018,0.651-0.022,0.963-0.123c0.626-0.206,1.122-0.76,1.288-1.44l0.264-1.089l2.066-0.93c0.373-0.17,0.673-0.42,0.861-0.731c0.275-0.449,0.405-0.97,0.369-1.498L18.9,11.676l1.021-1.021l-0.724-0.724l-0.427,0.427l-0.121-0.364c-0.201-0.603-0.54-1.151-0.989-1.6l-1.159-1.159c-0.5-0.5-1.31-0.5-1.809,0l-1.267,1.267l0.724,0.724l-5.066,5.066l-0.724-0.724l-1.267,1.267c-0.5,0.5-0.5,1.31,0,1.809l1.159,1.159c0.449,0.449,0.997,0.788,1.6,0.989l0.364,0.121l-0.427,0.427L10.512,20.064z M14.901,10.349l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0l-0.732-0.732C14.803,10.604,14.803,10.446,14.901,10.349z M9.472,15.777l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0L9.472,16.13C9.375,16.033,9.375,15.874,9.472,15.777z M11.391,17.615c0.069-0.271,0.206-0.518,0.405-0.717l4.961-4.961c0.195-0.195,0.445-0.337,0.717-0.405l0.344-0.083l0.137,1.925c0.022,0.318-0.058,0.63-0.221,0.901c-0.101,0.166-0.279,0.271-0.409,0.329L14.8,15.74l-0.38,1.574c-0.083,0.344-0.318,0.615-0.612,0.713c-0.188,0.058-0.38,0.083-0.579,0.072l-1.925-0.138L11.391,17.615z"/>',
    OTHER: '<path style="fill:#FFFFFF;" d="M13.004,1.411c0.964,0,1.894,0.441,2.496,1.204l8.346,10.023c1.363,1.592,1.482,3.477,0,4.979L13,28.465L2.148,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.023C11.211,1.781,12.122,1.411,13.004,1.411 M13.004,0.411L13.004,0.411c-1.248,0-2.408,0.551-3.268,1.552L1.38,11.998c-1.718,2.033-1.694,4.579,0.064,6.328l10.85,10.845L13,29.878l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337L16.269,1.976C15.5,1.003,14.273,0.411,13.004,0.411L13.004,0.411z M14.716,20.139c0,0.947-0.758,1.724-1.724,1.724c-0.947,0-1.704-0.777-1.704-1.724c0-0.928,0.757-1.704,1.704-1.704C13.958,18.435,14.716,19.211,14.716,20.139z M14.204,16.33H11.78l-0.537-8.533h3.5L14.204,16.33z"/>'
  }, Xp = { BLOCKING: "#323232", VERYHIGH: "#d5232f", HIGH: "#ffa100" }, Yp = { MARKER: [24.1, 17.8, 14.2, 28.42, 16.8, 29.4, 12.8, 31.4, 8.79, 29.4, 11.23, 28.42, 1.7, 17.8, 1.7, 12.1, 10, 1.9, 12.9, 0.498, 15.8, 1.9, 24.1, 12.1, 24.1, 17.8] };
  function Zp(a2, b2, c2) {
    c2 = c2 ? c2 : {};
    c2.criticality || (c2.criticality = "major,critical");
    C(a2, $p, Zp, 0);
    Tp.call(this, { max: 20, min: 8, requestData: A(this.T, this), engineType: c2.engineType });
    this.f = new Up();
    this.u = a2;
    this.i = c2;
    this.reload = A(this.reload, this);
    this.m = setInterval(this.reload, b2 || 18e4);
  }
  u(Zp, Tp);
  t("H.service.traffic.incidents.Provider", Zp);
  var aq = { minor: "HIGH", "low impact": "HIGH", major: "VERYHIGH", critical: "BLOCKING" };
  Zp.prototype.T = function(a2, b2, c2, d, e) {
    var f2 = this, g = this.f;
    return this.u.requestIncidentsByTile(
      a2,
      b2,
      c2,
      function(h) {
        var k = [];
        h = h.TRAFFIC_ITEMS;
        var l;
        if (h)
          for (h = h.TRAFFIC_ITEM, l = h.length; l--; ) {
            var m = h[l];
            var n = m.TRAFFIC_ITEM_TYPE_DESC;
            switch (n) {
              case "ACCIDENT":
              case "CONGESTION":
                var q = n;
                break;
              case "CONSTRUCTION":
                q = "ROADWORKS";
                break;
              default:
                q = "OTHER";
            }
            q = g.xb(q, aq[m.CRITICALITY.DESCRIPTION]);
            n = m.LOCATION.GEOLOC.ORIGIN;
            n = new Rn({ lat: n.LATITUDE, lng: n.LONGITUDE }, { provider: f2, icon: q });
            n.setData(m);
            k.push(n);
          }
        d(k);
      },
      e,
      this.i
    );
  };
  Zp.prototype.F = function() {
    Tp.prototype.F.call(this);
    clearInterval(this.m);
  };
  Zp.prototype.dispose = Zp.prototype.F;
  var bq = "A21 A22 F01 F02 F08 F04 F05 F07 F03 F06 A2F F13 A25 A2C F12 D1B F1B A27 E12 A3A A24 A3D A3F F1F F25 F2C E32 A33 F29 D26 D36 F26 D0F F0F F2B E0C D3A A45 D23 D11 F2E F19 F14 F39 A4A A4B A5C D38 F2A F1A D0A F1C A48 D25 D1D F32 A46 A3E D24 E1C E32 A5F D2E D22 D0A".split(" ");
  function cq(a2, b2, c2, d) {
    cq.j.constructor.call(this, { min: 10, max: 21, engineType: d });
    C(a2, $p, cq, 0);
    this.m = a2;
    this.f = c2 || dq;
    this.f.responseattributes = "sh,fc";
    this.i = setInterval(A(this.reload, this), b2 || 18e4);
    this.b === kk.WEBGL ? this.Qa(new ti(Ao() + "/traffic/flow.yaml"), true) : this.Qa(new H.map.render.harp.Style({ styles: [{ when: ["==", ["geometry-type"], "LineString"], technique: "solid-line", renderOrder: 10002, attr: {
      color: ["case", [">=", ["get", "JF"], 10], "black", [">=", ["get", "JF"], 8], "red", [">=", ["get", "JF"], 4], "yellow", "green"],
      lineWidth: 3,
      metricUnit: "Pixel"
    } }] }));
  }
  u(cq, S);
  t("H.service.traffic.flow.Provider", cq);
  cq.prototype.ei = ff;
  cq.prototype.providesGeoJSON = cq.prototype.ei;
  cq.prototype.V = function() {
    return this.Ya();
  };
  cq.prototype.getStyle = cq.prototype.V;
  cq.prototype.gb = function(a2) {
    a2.a && a2.a("GeoJSONTileSource");
    this.Qa(a2);
  };
  cq.prototype.setStyle = cq.prototype.gb;
  var dq = { locationreferences: "tmc,shp" };
  cq.prototype.o = function() {
    cq.j.o.call(this);
    clearInterval(this.i);
  };
  cq.prototype.B = function(a2, b2, c2, d, e) {
    return this.m.requestFlowByTile(a2, b2, c2, function(f2) {
      f2.type && -1 !== f2.type.indexOf("Error") ? e(f2.Details) : d(f2);
    }, e, this.f);
  };
  cq.prototype.requestInternal = cq.prototype.B;
  cq.prototype.ac = function(a2, b2, c2, d, e) {
    var f2, g, h, k, l = { type: "FeatureCollection", features: [] }, m;
    var n = d.RWS.length;
    for (f2 = 0; f2 < n; f2++) {
      var q = d.RWS[f2];
      var r = q.RW;
      var v = r.length;
      var w = -1 !== bq.indexOf(q.EXTENDED_COUNTRY_CODE + q.EBU_COUNTRY_CODE);
      for (q = 0; q < v; q++) {
        var y = r[q].FIS;
        var G = y.length;
        for (y = 0; y < G; y++) {
          var I = r[q].FIS[y].FI;
          var Q = I.length;
          for (g = 0; g < Q; g++) {
            var V = I[g];
            var Ba = [];
            var ha = V.CF[0];
            var rb = !!ha.SSS;
            var Fa = { type: "Feature", properties: ha, geometry: { type: "MultiLineString", coordinates: Ba } };
            Fa.properties.LHT = w;
            V.SHP.length && (Fa.properties.FC = V.SHP[0].FC);
            rb && (m = []);
            for (ha = 0; ha < V.SHP.length; ha++) {
              var bc = V.SHP[ha].value;
              var ad = bc.length;
              for (h = 0; h < ad; h++) {
                var wc = rb ? m : void 0, Jb = new qo(bc[h].trim()), mg = [], pd = {};
                for (Jb.ge(); -1 !== (k = Jb.Pb()); )
                  k === eq ? (pd.lat = +String.fromCharCode.apply(cq, Jb.Gd()), Jb.next(), Jb.ge()) : k === fq ? (pd.lng = +String.fromCharCode.apply(cq, Jb.Gd()), mg.push([pd.lng, pd.lat]), wc && wc.push(ng(pd)), pd = [], Jb.next(), Jb.ge()) : Jb.next();
                pd.lng = +String.fromCharCode.apply(cq, Jb.Gd());
                mg.push([
                  pd.lng,
                  pd.lat
                ]);
                wc && wc.push(ng(pd));
                k = mg;
                Ba.push(k);
              }
            }
            l.features.push(Fa);
          }
        }
      }
    }
    return cq.j.ac.call(this, a2, b2, c2, l, e);
  };
  cq.prototype.createTileInternal = cq.prototype.ac;
  var fq = 32, eq = 44;
  function gq(a2) {
    function b2(m) {
      d.contains(e) && d.removeChild(e);
      l && clearTimeout(l);
      delete gq.a[f2];
      m && a2.pj && a2.pj.call(k, m);
    }
    if (!a2.url || !a2.Og)
      throw Error('Parameter "options" must specify at least a URL and a callback.');
    if ("function" !== typeof a2.Og)
      throw Error("Parameters options.callback must be a function");
    var c2 = a2.cp || document;
    var d = c2.getElementsByTagName("head")[0];
    var e = c2.createElement("script");
    c2 = a2.url instanceof W ? a2.url : Dp(a2.url, a2.bp);
    var f2 = gq.b++;
    var g = a2.vl || "callback";
    var h = a2.Og;
    var k = {};
    var l = null;
    k.id = f2;
    k.cancel = function() {
      b2("cancelled");
    };
    0 !== a2.timeout && (l = x.setTimeout(function() {
      b2("timeout");
    }, a2.timeout || 3e4));
    gq.a[f2] = function(m) {
      b2();
      h.call(k, m);
    };
    e.type = "text/javascript";
    e.src = c2.toString() + (c2.Mj() ? "&" : "?") + g + "=" + (a2.ep ? "H.service.jsonp.handleResponse(" + f2 + ")" : encodeURI("H.service.jsonp.handleResponse(" + f2 + ")"));
    d.appendChild(e);
    return k;
  }
  t("H.service.jsonp", gq);
  gq.mn = function(a2) {
    return (a2 = gq.a[a2]) ? a2 : function() {
    };
  };
  gq.handleResponse = gq.mn;
  gq.b = 0;
  gq.a = {};
  function $p(a2) {
    $p.j.constructor.call(this, $p, a2);
    this.c = Pp(this, a2).callbackKey;
    this.b = false;
  }
  u($p, Op);
  t("H.service.traffic.Service", $p);
  $p.prototype.Aa = function() {
    return { subDomain: "traffic.ls", path: "traffic/6.1", callbackKey: "jsoncallback" };
  };
  $p.CONFIG_KEY = "traffic";
  $p.prototype.dj = function(a2, b2) {
    return new sl(new cq(this, void 0, a2, b2), { max: 22 });
  };
  $p.prototype.createFlowLayer = $p.prototype.dj;
  $p.prototype.ej = function(a2) {
    return new Sn(new Zp(this, void 0, a2));
  };
  $p.prototype.createIncidentsLayer = $p.prototype.ej;
  function hq(a2, b2, c2, d) {
    a2.b || (zp($p, "Use HERE Traffic API v7 instead."), a2.b = true);
    return gq({ url: b2, Og: c2, pj: function(e) {
      d(Error("[" + e + "] " + b2 + " request failed"));
    }, vl: a2.c });
  }
  $p.prototype.ro = function(a2, b2, c2) {
    a2 = this.v().clone().G("incidents.json").I(a2);
    return hq(this, a2, b2, c2);
  };
  $p.prototype.requestIncidents = $p.prototype.ro;
  $p.prototype.po = function(a2, b2, c2, d, e, f2) {
    a2 = this.v().clone().G(["flow/json", c2, a2, b2].join("/")).I(f2 || {});
    return hq(this, a2, d, e);
  };
  $p.prototype.requestFlowByTile = $p.prototype.po;
  $p.prototype.to = function(a2, b2, c2, d, e, f2) {
    a2 = this.v().clone().G(["incidents/json", c2, a2, b2].join("/")).I(f2 || {});
    return hq(this, a2, d, e);
  };
  $p.prototype.requestIncidentsByTile = $p.prototype.to;
  X.prototype.nh = function(a2, b2) {
    b2 = b2 || 6;
    if (6 === b2)
      b2 = $p;
    else if (7 === b2)
      b2 = Sp;
    else
      throw new D(this.nh, 1, "allowed values are 6 and 7");
    return this.Ma(b2, a2);
  };
  X.prototype.getTrafficService = X.prototype.nh;
  function iq(a2) {
    iq.j.constructor.call(this, iq, a2);
    this.b = Pp(this, a2).reverseSubDomain;
    zp(iq, "Use HERE Geocoding and Search API v7 instead.");
  }
  u(iq, Op);
  t("H.service.GeocodingService", iq);
  iq.prototype.Aa = function() {
    return { subDomain: "geocoder.ls", reverseSubDomain: "reverse", path: "6.2" };
  };
  iq.CONFIG_KEY = "geocoding";
  iq.prototype.a = function(a2) {
    return Error(a2.Details || a2.message || a2.error);
  };
  iq.prototype.Zg = function(a2, b2, c2) {
    a2 = this.v().clone().G("geocode.json").I(a2);
    return this.B(a2, b2, c2);
  };
  iq.prototype.geocode = iq.prototype.Zg;
  iq.prototype.ii = function(a2, b2, c2) {
    a2 = this.v().clone().G("reversegeocode.json").I(a2);
    this.b && a2.Ba(this.b);
    return this.B(a2, b2, c2);
  };
  iq.prototype.reverseGeocode = iq.prototype.ii;
  iq.prototype.search = function(a2, b2, c2) {
    a2 = this.v().clone().G("search.json").I(a2);
    return this.B(a2, b2, c2);
  };
  iq.prototype.search = iq.prototype.search;
  X.prototype.km = function(a2) {
    return this.Ma(iq, a2);
  };
  X.prototype.getGeocodingService = X.prototype.km;
  function jq(a2) {
    zp(jq, "Use HERE Geocoding and Search API v7 instead.");
    jq.j.constructor.call(this, jq, a2);
  }
  u(jq, Op);
  t("H.service.PlacesService", jq);
  jq.prototype.Aa = function() {
    return { subDomain: "places.ls", path: "places/v1" };
  };
  jq.CONFIG_KEY = "places";
  jq.EntryPoint = { SEARCH: "discover/search", SUGGEST: "suggest", EXPLORE: "discover/explore", AROUND: "discover/around", HERE: "discover/here", CATEGORIES: "categories/places" };
  jq.prototype.request = function(a2, b2, c2, d) {
    return kq(this, a2, b2, c2, d);
  };
  jq.prototype.request = jq.prototype.request;
  function kq(a2, b2, c2, d, e) {
    b2 = a2.v().clone().G(b2).I(c2 || {});
    return a2.B(b2, d, e);
  }
  jq.prototype.search = function(a2, b2, c2) {
    return kq(this, "discover/search", a2, b2, c2);
  };
  jq.prototype.search = jq.prototype.search;
  jq.prototype.Go = function(a2, b2, c2) {
    return kq(this, "suggest", a2, b2, c2);
  };
  jq.prototype.suggest = jq.prototype.Go;
  jq.prototype.Fl = function(a2, b2, c2) {
    return kq(this, "discover/explore", a2, b2, c2);
  };
  jq.prototype.explore = jq.prototype.Fl;
  jq.prototype.rl = function(a2, b2, c2) {
    return kq(this, "discover/around", a2, b2, c2);
  };
  jq.prototype.around = jq.prototype.rl;
  jq.prototype.on = function(a2, b2, c2) {
    return kq(this, "discover/here", a2, b2, c2);
  };
  jq.prototype.here = jq.prototype.on;
  jq.prototype.wl = function(a2, b2, c2) {
    return kq(this, "categories/places", a2, b2, c2);
  };
  jq.prototype.categories = jq.prototype.wl;
  jq.prototype.Gl = function(a2, b2, c2, d) {
    a2 = Dp(a2).I(this.v().getQuery()).I(d || {});
    return this.B(a2, b2, c2);
  };
  jq.prototype.follow = jq.prototype.Gl;
  X.prototype.Im = function(a2) {
    return this.Ma(jq, a2);
  };
  X.prototype.getPlacesService = X.prototype.Im;
  function lq() {
    this.a = {};
  }
  function mq(a2, b2) {
    for (var c2 in b2)
      if (b2.hasOwnProperty(c2)) {
        var d, e = b2[c2], f2 = a2.a[c2] || (a2.a[c2] = []), g = e.length;
        for (d = 0; d < g; d++)
          f2.push(new nq(e[d]));
      }
  }
  function Np(a2, b2, c2, d) {
    var e = (a2 = a2.a[b2]) ? a2.length : 0, f2 = [];
    for (b2 = 0; b2 < e; b2++)
      a2[b2].nd(c2, d) && f2.push(a2[b2]);
    return f2;
  }
  function nq(a2) {
    var b2, c2 = a2.boxes;
    this.label = a2.label;
    this.min = a2.minLevel;
    this.max = a2.maxLevel;
    this.b = [];
    if (c2 && (b2 = c2.length)) {
      var d = c2[0];
      var e = new K(d[0], d[1], d[2], d[3]);
      this.b.push(e);
      this.a = new K(d[0], d[1], d[2], d[3]);
      for (a2 = 1; a2 < b2; a2++)
        d = c2[a2], e = new K(d[0], d[1], d[2], d[3]), this.b.push(e), this.a.ec(e, false, this.a);
    }
  }
  nq.prototype.nd = function(a2, b2) {
    if (a2 >= this.min && a2 <= this.max)
      if ((a2 = this.b.length) && this.a) {
        if (this.a.nd(b2)) {
          for (; a2--; )
            if (this.b[a2].nd(b2))
              return true;
        }
      } else
        return true;
    return false;
  };
  function oq(a2, b2, c2) {
    var d = this, e = c2 || {}, f2 = +e.min, g = +e.max;
    e.tileSize = e.tileSize || 512;
    e.min = f2 ? ae(f2, 1, 17) : 1;
    e.min += Pk(e.tileSize, 1);
    e.max = g ? ae(g, 1, 17) : 17;
    oq.j.constructor.call(this, e);
    C(a2, pq, oq, 0);
    C(b2, Wh, oq, 1);
    this.i = a2;
    b2.a && b2.a("OMV");
    this.Qa(b2, true);
    this.m = false;
    c2 && (c2.politicalView && (this.u = c2.politicalView), qq(this, c2.lg, c2.lg2), this.m = !!c2.pois);
    this.aa = function() {
      d.T = xp(d);
      d.reload(false);
    };
    a2.addEventListener("versionupdate", this.aa);
    this.T = xp(this);
    oq.prototype.qa = function() {
      var h = /^v2\/vectortiles\/(.+)\/mc$/.exec(a2.v().b);
      return h ? h[1] : B + "";
    }();
  }
  u(oq, S);
  t("H.service.omv.Provider", oq);
  oq.prototype.Sb = ff;
  oq.prototype.providesOMV = oq.prototype.Sb;
  oq.prototype.ub = function(a2) {
    return this.T.test(a2);
  };
  oq.prototype.cacheFilter = oq.prototype.ub;
  oq.prototype.uc = function(a2, b2, c2) {
    return rq(this.i, a2, b2, c2).toString();
  };
  oq.prototype.getTileKey = oq.prototype.uc;
  oq.prototype.nb = function() {
    return this.xa;
  };
  oq.prototype.getCache = oq.prototype.nb;
  oq.prototype.Lm = function() {
    return this.u;
  };
  oq.prototype.getPoliticalView = oq.prototype.Lm;
  oq.prototype.yo = function(a2) {
    var b2 = this.u;
    this.u = a2;
    this.dispatchEvent(new cj("politicalviewchange", this.u, b2));
  };
  oq.prototype.setPoliticalView = oq.prototype.yo;
  oq.prototype.MAX_STORE_TIME = 2592e6;
  oq.prototype.l = function() {
    return od();
  };
  oq.prototype.c = function() {
    return od() ? nd() : oq.j.c.call(this);
  };
  oq.prototype.s = function() {
    return this.i;
  };
  oq.prototype.B = function(a2, b2, c2, d, e) {
    return this.i.Ha(a2, b2, c2, d, e);
  };
  oq.prototype.requestInternal = oq.prototype.B;
  oq.prototype.gb = function(a2) {
    a2.a && a2.a("OMV");
    this.Qa(a2);
  };
  oq.prototype.setStyle = oq.prototype.gb;
  oq.prototype.V = function() {
    return oq.j.Ya.apply(this);
  };
  oq.prototype.getStyle = oq.prototype.V;
  oq.prototype.Ya = function() {
    var a2 = oq.j.Ya.apply(this), b2 = a2.getState() === Xh.READY, c2 = a2.qc();
    b2 && c2 && c2.global && (this.D && (this.R && (c2.global.ux_language = this.R), this.L && (c2.global.ux_language_fallback = this.L)), this.m && c2.global.poi && c2.global.poi["default"] && (c2.global.poi["default"].visible = this.m), this.D || this.m) && (a2 = new ti(c2, a2.Ib()));
    return a2;
  };
  oq.prototype.getStyleInternal = oq.prototype.Ya;
  function qq(a2, b2, c2) {
    var d = Cc(b2), e = Cc(c2);
    d && (a2.R = b2);
    e && (a2.L = c2);
    if (d || e)
      a2.f = [], d = /^([a-zA-Z]{2})(-|$)/, (e = d.exec(b2)) && ("zh" === e[1] ? a2.f.push(b2) : a2.f.push(e[1])), (e = d.exec(c2)) && ("zh" === e[1] ? a2.f.push(c2) : a2.f.push(e[1])), a2.D = true;
  }
  oq.prototype.D = false;
  var sq = ["en"];
  oq.prototype.hh = function() {
    return this.f || sq;
  };
  oq.prototype.getLanguages = oq.prototype.hh;
  oq.prototype.o = function() {
    oq.j.o.call(this);
    this.i.removeEventListener("versionupdate", this.aa);
  };
  oq.prototype.xa = new Rk(256);
  oq.prototype.ba = function(a2, b2) {
    return Np(this.i.ba(), this.qa, b2, a2);
  };
  oq.prototype.getCopyrights = oq.prototype.ba;
  function pq(a2) {
    pq.j.constructor.call(this, pq, a2);
    var b2 = Pp(this, a2).mapVersion;
    this.l = a2.queryParams || {};
    this.b = vc(b2) ? b2 : tq[this.v().toString()];
    vc(this.b) || uq(this);
  }
  u(pq, Op);
  t("H.service.omv.Service", pq);
  pq.prototype.Aa = function() {
    return { subDomain: "vector", path: "v2/vectortiles/base/mc" };
  };
  pq.CONFIG_KEY = "omv";
  var tq = {};
  Ic(tq);
  pq.prototype.Am = function() {
    return this.b;
  };
  pq.prototype.getMapVersion = pq.prototype.Am;
  function uq(a2) {
    a2.B(a2.v().clone().G("../../info"), function(b2) {
      b2 = b2.mapVersion;
      var c2 = a2.v().toString();
      a2.b = b2;
      b2 !== tq[c2] && (tq[c2] = b2, a2.dispatchEvent("versionupdate"));
    }, function() {
    });
  }
  pq.prototype.$b = function(a2, b2, c2) {
    b2 = b2 || {};
    var d = { min: 0, max: 22 };
    Ea(c2) && yp(d, c2);
    Mn && (b2.min = d.min = 4);
    return new sl(new oq(this, a2, b2), d);
  };
  pq.prototype.createLayer = pq.prototype.$b;
  pq.prototype.Ha = function(a2, b2, c2, d, e) {
    return this.B(rq(this, a2, b2, c2), function(f2) {
      return f2.arrayBuffer().then(d, e);
    }, e, "arraybuffer");
  };
  function rq(a2, b2, c2, d) {
    b2 = a2.v().clone().G(d + "/" + b2 + "/" + c2 + "/omv");
    vc(a2.b) && b2.I({ mv: a2.b }).I(a2.l);
    return b2;
  }
  pq.prototype.f = function(a2) {
    return Ao() + "/" + a2;
  };
  pq.prototype.Je = function(a2, b2) {
    if (!Da(a2))
      throw new D(this.Je, 0, '"onResult" must be a function');
    if (!Da(b2))
      throw new D(this.Je, 1, '"onError" must be a function');
    return this.B(this.v().clone().wd("v2/vectortiles/pviews"), a2, b2);
  };
  pq.prototype.getPoliticalViews = pq.prototype.Je;
  X.prototype.He = function(a2) {
    return this.Ma(pq, a2);
  };
  X.prototype.getOMVService = X.prototype.He;
  pq.prototype.s = function(a2) {
    mq(this.c, a2);
    this.dispatchEvent("copyrightupdate");
  };
  pq.prototype.ba = function() {
    this.c || (this.c = new lq(), this.B(this.v().clone().G("../../copyrights"), A(this.s, this), ld));
    return this.c;
  };
  pq.prototype.getCopyrights = pq.prototype.ba;
  function vq(a2) {
    vq.j.constructor.call(this, vq, a2);
    this.b = a2.getToken;
  }
  u(vq, Op);
  t("H.service.iml.Service", vq);
  vq.prototype.Aa = function() {
    return { host: "interactive.data.api.platform.here.com", path: "interactive/v1/catalogs" };
  };
  vq.prototype.a = function(a2) {
    function b2() {
      for (var d = ea(c2), e = d.next(); !e.done; e = d.next()) {
        e = e.value;
        var f2 = e.format;
        if (e.keys.every(function(g) {
          return a2[g];
        }))
          return f2();
      }
      return JSON.stringify(a2);
    }
    var c2 = [{ keys: ["code", "title", "cause", "action"], format: function() {
      return a2.code + ": " + a2.title + "; cause: " + a2.cause + "; action: " + a2.action;
    } }, { keys: ["error", "error_description"], format: function() {
      return a2.error + ": " + a2.error_description;
    } }, { keys: ["error", "errorMessage"], format: function() {
      return a2.error + ": " + a2.errorMessage;
    } }];
    return Error(Ea(a2) ? b2() : a2);
  };
  vq.prototype.Qd = function(a2, b2, c2, d, e) {
    var f2 = this.Qd;
    wq(f2, 0, a2, b2);
    xq(f2, 2, c2, d);
    a2 = this.v().clone().G(a2 + "/layers/" + b2 + "/statistics").I(e || {});
    return yq(this, a2, "GET", c2, d);
  };
  vq.prototype.getStatistics = vq.prototype.Qd;
  vq.prototype.Ff = function(a2, b2, c2, d, e, f2, g, h, k) {
    var l = k ? "" : ".mvtf";
    a2 = this.v().clone().G(d + "/layers/" + e + "/tile/web/" + c2 + "_" + a2 + "_" + b2 + l).I(Object.assign({ clip: true }, h));
    return yq(this, a2, "GET", k ? f2 : function(m) {
      return m.arrayBuffer().then(f2);
    }, g, void 0, k ? "application/json" : "arraybuffer");
  };
  vq.prototype.getFeaturesByTile = vq.prototype.Ff;
  vq.prototype.wj = function(a2, b2, c2, d, e, f2) {
    var g = this.wj;
    zq(g, a2);
    wq(g, 1, b2, c2);
    xq(g, 3, d, e);
    a2 = Aq(this, a2, b2, c2, f2);
    return yq(this, a2, "GET", d, e);
  };
  vq.prototype.getFeatureById = vq.prototype.wj;
  vq.prototype.Sc = function(a2, b2, c2, d, e, f2) {
    var g = this.Sc;
    Bq(g, a2);
    wq(g, 1, b2, c2);
    xq(g, 3, d, e);
    a2 = Dq(this, a2, b2, c2, f2);
    return yq(this, a2, "GET", d, e);
  };
  vq.prototype.getFeaturesById = vq.prototype.Sc;
  vq.prototype.Jd = function(a2, b2, c2, d, e) {
    var f2 = this.Jd;
    if (!Ea(a2) || !(a2.bbox || a2.north && a2.east && a2.south && a2.west))
      throw new D(f2, 0, 'must be an object with either "bbox" or a full set of "north", "east", "south" and "west"');
    wq(f2, 1, b2, c2);
    xq(f2, 3, d, e);
    a2 = this.v().clone().G(b2 + "/layers/" + c2 + "/bbox").I(a2);
    return yq(this, a2, "GET", d, e);
  };
  vq.prototype.getFeaturesByBoundingBox = vq.prototype.Jd;
  vq.prototype.yj = function(a2, b2, c2, d, e) {
    var f2 = this.yj;
    if (!(Ea(a2) && a2.radius && (a2.lat && (a2.lng || a2.lon) || a2.refCatalogHrn && a2.refLayerId && a2.refFeatureId)))
      throw new D(f2, 0, 'must be an object with "radius" and a combination of either "lat"+"lng" or "refCatalogHrn"+"refLayerId"+"refFeatureId"');
    wq(f2, 1, b2, c2);
    xq(f2, 3, d, e);
    a2 = this.v().clone().G(b2 + "/layers/" + c2 + "/spatial").I(a2);
    return yq(this, a2, "GET", d, e);
  };
  vq.prototype.getFeaturesByPointAndRadius = vq.prototype.yj;
  vq.prototype.xj = function(a2, b2, c2, d, e, f2) {
    var g = this.xj;
    if (!Ea(a2) || !a2.radius)
      throw new D(g, 0, 'must be an object with "radius"');
    Eq(g, 1, b2);
    wq(g, 2, c2, d);
    xq(g, 4, e, f2);
    a2 = this.v().clone().G(c2 + "/layers/" + d + "/spatial").I(a2);
    return yq(this, a2, "POST", e, f2, b2);
  };
  vq.prototype.getFeaturesByGeometryAndRadius = vq.prototype.xj;
  vq.prototype.Jk = function(a2, b2, c2, d, e) {
    var f2 = this.Jk;
    wq(f2, 0, a2, b2);
    xq(f2, 2, c2, d);
    a2 = this.v().clone().G(a2 + "/layers/" + b2 + "/search").I(e || {});
    return yq(this, a2, "GET", c2, d);
  };
  vq.prototype.searchFeatures = vq.prototype.Jk;
  vq.prototype.Wj = function(a2, b2, c2, d, e) {
    var f2 = this.Wj;
    wq(f2, 0, a2, b2);
    xq(f2, 2, c2, d);
    a2 = this.v().clone().G(a2 + "/layers/" + b2 + "/iterate").I(e || {});
    return yq(this, a2, "GET", c2, d);
  };
  vq.prototype.iterateFeatures = vq.prototype.Wj;
  vq.prototype.$c = function(a2, b2, c2, d, e, f2) {
    var g = this.$c;
    Eq(g, 0, a2);
    wq(g, 1, b2, c2);
    xq(g, 3, d, e);
    b2 = Fq(this, b2, c2, f2);
    return yq(this, b2, "PUT", d, e, a2);
  };
  vq.prototype.putFeatures = vq.prototype.$c;
  vq.prototype.Yc = function(a2, b2, c2, d, e, f2) {
    var g = this.Yc;
    Eq(g, 0, a2);
    wq(g, 1, b2, c2);
    xq(g, 3, d, e);
    b2 = Fq(this, b2, c2, f2);
    return yq(this, b2, "POST", d, e, a2);
  };
  vq.prototype.postFeatures = vq.prototype.Yc;
  vq.prototype.hd = function(a2, b2, c2, d, e) {
    var f2 = this.hd;
    Bq(f2, a2);
    wq(f2, 1, b2, c2);
    xq(f2, 3, d, e);
    a2 = Dq(this, a2, b2, c2);
    return yq(this, a2, "DELETE", d, e);
  };
  vq.prototype.deleteFeatures = vq.prototype.hd;
  vq.prototype.Ck = function(a2, b2, c2, d, e, f2, g) {
    var h = this.Ck;
    zq(h, a2);
    Eq(h, 1, b2);
    wq(h, 2, c2, d);
    xq(h, 4, e, f2);
    a2 = Aq(this, a2, c2, d, g);
    return yq(this, a2, "PUT", e, f2, b2);
  };
  vq.prototype.putFeature = vq.prototype.Ck;
  vq.prototype.wk = function(a2, b2, c2, d, e, f2, g) {
    var h = this.wk;
    zq(h, a2);
    Eq(h, 1, b2);
    wq(h, 2, c2, d);
    xq(h, 4, e, f2);
    a2 = Aq(this, a2, c2, d, g);
    return yq(this, a2, "PATCH", e, f2, b2);
  };
  vq.prototype.patchFeature = vq.prototype.wk;
  vq.prototype.ij = function(a2, b2, c2, d, e) {
    var f2 = this.ij;
    zq(f2, a2);
    wq(f2, 1, b2, c2);
    xq(f2, 3, d, e);
    a2 = Aq(this, a2, b2, c2);
    return yq(this, a2, "DELETE", d, e, void 0, "text/plain");
  };
  vq.prototype.deleteFeature = vq.prototype.ij;
  function Fq(a2, b2, c2, d) {
    return a2.v().clone().G(b2 + "/layers/" + c2 + "/features").I(d || {});
  }
  function Dq(a2, b2, c2, d, e) {
    b2 = Object.assign({}, e, { id: new Hp(b2) });
    return Fq(a2, c2, d, b2);
  }
  function Aq(a2, b2, c2, d, e) {
    return a2.v().clone().G(c2 + "/layers/" + d + "/features/" + b2).I(e || {});
  }
  function yq(a2, b2, c2, d, e, f2, g) {
    g = void 0 === g ? "application/json" : g;
    c2 = { method: c2, headers: Object.assign({}, f2 ? { "Content-Type": "application/geo+json" } : void 0, "function" === typeof a2.b ? { Authorization: "Bearer " + a2.b() } : void 0, a2.g) };
    f2 && (c2.data = JSON.stringify(f2));
    f2 = new tf(g, b2.toString(), je, c2);
    f2.then(d, Qp(a2, b2, e));
    return f2;
  }
  vq.CONFIG_KEY = "iml";
  function wq(a2, b2, c2, d) {
    zc(c2, "String", a2, b2, "must be a string");
    zc(d, "String", a2, b2 + 1, "must be a string");
  }
  function zq(a2, b2) {
    zc(b2, "String", a2, 0, "must be a string");
  }
  function Bq(a2, b2) {
    if (!Array.isArray(b2) || 0 === b2.length || b2.some(function(c2) {
      return "string" !== typeof c2;
    }))
      throw new D(a2, 0, "must be a non-empty array of strings");
  }
  function Eq(a2, b2, c2) {
    if (!Ea(c2))
      throw new D(a2, b2, "must be a GeoJSON object");
  }
  function xq(a2, b2, c2, d) {
    if (!Da(c2))
      throw new D(a2, b2, "must be a function");
    if (!Da(d))
      throw new D(a2, b2 + 1, "must be a function");
  }
  X.prototype.pm = function(a2) {
    return this.Ma(vq, a2);
  };
  X.prototype.getIMLService = X.prototype.pm;
  function Gq(a2, b2, c2, d) {
    Gq.j.constructor.call(this, d ? { min: d.min, max: d.max, engineType: d.engineType } : void 0);
    C(a2, vq, Gq, 0);
    if (!Cc(b2))
      throw new D(Gq, 1, '"catalogHrn" must be a string');
    if (!Cc(c2))
      throw new D(Gq, 2, '"layerId" must be a string');
    this.u = a2;
    this.f = b2;
    this.i = c2;
    this.m = Ea(d) && Ea(d.parameters) ? d.parameters : {};
    this.Qa(this.b === kk.WEBGL ? new ti({ sources: { iml: { type: "MVT" } }, layers: { iml: { data: { source: "iml", layer: this.f + ":" + this.i }, points: { filter: { $geometry: "point" }, draw: { points: {
      collide: false,
      order: 200,
      color: "#92CF48",
      size: [[10, "8px"], [14, "12px"], [18, "16px"]]
    } } }, polygons: { filter: { $geometry: "polygon" }, draw: { polygons: { order: 201, color: "#E39E3C" }, lines: { order: 202, color: "#755DA5", width: "1px" } } }, lines: { filter: { $geometry: "line" }, draw: { lines: { order: 203, color: "#0258AE", width: "2px", join: "round", cap: "round" } } } } } }) : new H.map.render.harp.Style({ styles: [
      { layer: this.f + ":" + this.i, when: ["==", ["geometry-type"], "Point"], technique: "circles", renderOrder: 200, color: "#92CF48", size: ["interpolate", ["linear"], ["zoom"], 10, 8, 14, 12, 18, 16] },
      { layer: this.f + ":" + this.i, when: ["==", ["geometry-type"], "Polygon"], technique: "fill", color: "#E39E3C", renderOrder: 201 },
      { layer: this.f + ":" + this.i, when: ["==", ["geometry-type"], "Polygon"], technique: "solid-line", color: "#755DA5", lineWidth: "1px", renderOrder: 202 },
      { layer: this.f + ":" + this.i, when: ["==", ["geometry-type"], "LineString"], technique: "solid-line", color: "#0258AE", lineWidth: "2px", renderOrder: 203 }
    ] }));
  }
  u(Gq, S);
  t("H.service.iml.Provider", Gq);
  Gq.prototype.B = function(a2, b2, c2, d, e) {
    return this.u.Ff(a2, b2, c2, this.f, this.i, d, e, this.m);
  };
  Gq.prototype.requestInternal = Gq.prototype.B;
  Gq.prototype.Sb = ff;
  Gq.prototype.providesOMV = Gq.prototype.Sb;
  Gq.prototype.V = function() {
    return this.Ya();
  };
  Gq.prototype.getStyle = Gq.prototype.V;
  Gq.prototype.gb = function(a2) {
    C(a2, ti) && a2.a("MVT");
    this.Qa(a2);
  };
  Gq.prototype.setStyle = Gq.prototype.gb;
  function Mp(a2) {
    a2 = void 0 === a2 ? {} : a2;
    Mp.j.constructor.call(this, Mp, a2);
    this.b = { og: a2.resource || "base", eg: a2.projection || "mc", format: a2.format || "png8" };
    this.f = a2.queryParams || {};
  }
  u(Mp, Op);
  t("H.service.rasterTile.Service", Mp);
  p = Mp.prototype;
  p.V = function() {
    return this.f.style || "explore.day";
  };
  p.Aa = function() {
    return { subDomain: "maps", path: "v3" };
  };
  p.ba = function() {
    this.c || (this.c = new lq(), this.B(this.v().clone().G("copyright"), A(this.Kn, this), ld));
    return this.c;
  };
  p.Kn = function(a2) {
    var b2 = a2.copyrights;
    a2 = a2.resources;
    var c2 = {}, d = this.b.og + "." + this.V();
    c2[d] = [];
    a2[this.b.og].styles[this.V()].forEach(function(e) {
      b2[e].forEach(function(f2) {
        var g = [];
        f2.boundingBoxes.forEach(function(h) {
          g.push([h.north, h.west, h.south, h.east]);
        });
        c2[d].push({ boxes: g, label: f2.label, alt: f2.alt, minLevel: f2.minLevel, maxLevel: f2.maxLevel });
      });
    });
    mq(this.c, c2);
  };
  p.Fe = function(a2, b2) {
    return this.B(this.v().clone().G("info"), a2, b2);
  };
  Mp.prototype.getInfo = Mp.prototype.Fe;
  Mp.prototype.Je = function(a2, b2) {
    return this.B(this.v().clone().G("politicalViews"), a2, b2);
  };
  Mp.prototype.getPoliticalViews = Mp.prototype.Je;
  Mp.prototype.jm = function(a2, b2) {
    return this.B(this.v().clone().G("features"), a2, b2);
  };
  Mp.prototype.getFeatures = Mp.prototype.jm;
  Mp.prototype.hh = function(a2, b2) {
    return this.B(this.v().clone().G("languages"), a2, b2);
  };
  Mp.prototype.getLanguages = Mp.prototype.hh;
  Mp.CONFIG_KEY = "rasterTile";
  X.prototype.lh = function(a2) {
    return this.Ma(Mp, a2);
  };
  X.prototype.getRasterTileService = X.prototype.lh;
  function Hq(a2, b2, c2, d, e, f2, g) {
    var h = this;
    g = g || {};
    f2 = f2 ? f2 : {};
    var k = a2.v().clone().G(b2 + "/" + a2.vc() + "/" + c2).I(f2), l = a2.c;
    this.D = a2;
    this.R = k;
    Ek.call(this, { tileSize: d, max: 512 === d ? 19 : 20, min: 512 === d ? 2 : 0, getURL: function(m, n, q) {
      var r = h.R.clone();
      l && r.Ba(l[(q + n + m) % l.length]);
      r.G(q + "/" + m + "/" + n + "/" + d + "/" + e);
      return r.toString();
    }, crossOrigin: g.crossOrigin, headers: g.headers, uri: k.toString().replace(/_/g, "") + d, engineType: g.engineType });
    this.me = b2;
    this.ab = c2;
    this.xa = f2;
    this.qa = c2.split(".")[0];
    this.i = A(this.i, this);
    this.getCopyrights = this.ba;
    this.L = false;
    a2.addEventListener("versionupdate", this.i);
  }
  u(Hq, Ek);
  Hq.prototype.MAX_STORE_TIME = 2592e6;
  Hq.prototype.B = function(a2, b2, c2, d, e, f2) {
    this.L || (zp(Iq, "Use HERE Vector Tile API or Raster Tile API v3 instead."), this.L = true);
    return Hq.j.B.call(this, a2, b2, c2, d, e, f2);
  };
  Hq.prototype.requestInternal = Hq.prototype.B;
  Hq.prototype.o = function() {
    Ek.prototype.o.call(this);
    this.D.removeEventListener("versionupdate", this.i);
  };
  Hq.prototype.ba = function(a2, b2) {
    return Np(this.D.ba(), this.qa, b2, a2);
  };
  Hq.prototype.getCopyrights = Hq.prototype.ba;
  Hq.prototype.i = function() {
    var a2 = this.D;
    this.R = a2.v().clone().G(this.me + "/" + a2.vc() + "/" + this.ab).I(this.xa);
    this.reload(false);
  };
  Hq.prototype.l = function() {
    return od();
  };
  Hq.prototype.c = function() {
    return od() ? nd() : Hq.j.c.call(this);
  };
  function Iq(a2) {
    Iq.j.constructor.call(this, Iq, a2);
    a2 = Pp(this, a2);
    this.c = a2.shards;
    (this.f = a2.ignoreTypes ? null : a2.type) && this.v().Ba(this.f);
    this.b = a2.version;
    this.s = new lq();
    this.m = {};
    this.l = 0;
    "newest" === this.b && Jq(this);
  }
  u(Iq, Op);
  t("H.service.MapTileService", Iq);
  Iq.prototype.Aa = function() {
    return { subDomain: "maps.ls", path: "maptile/2.1", type: "base", version: "newest", shards: ["1", "2", "3", "4"] };
  };
  Iq.CONFIG_KEY = "maptile";
  function Kq(a2, b2) {
    for (var c2 = {}, d = a2[b2 + "s"][b2], e = d.length; e--; )
      c2[d[e].id] = d[e];
    a2[b2 + "s"] = c2;
  }
  Iq.prototype.Hj = function() {
    return this.f;
  };
  Iq.prototype.getType = Iq.prototype.Hj;
  Iq.prototype.vc = function() {
    return this.b;
  };
  Iq.prototype.getVersion = Iq.prototype.vc;
  Iq.prototype.ba = function() {
    this.l || (this.b && "newest" !== this.b || "traffic" === this.f) && Lq(this);
    return this.s;
  };
  Iq.prototype.getCopyrights = Iq.prototype.ba;
  function Jq(a2) {
    var b2 = a2.v().clone().G("info").I({ output: "json" });
    a2.c && b2.Ba(a2.c[0]);
    a2.B(b2, function(c2) {
      c2 = c2.response;
      var d;
      Kq(c2, "map");
      Kq(c2, "scheme");
      Kq(c2, "tiletype");
      Kq(c2, "format");
      Kq(c2, "resolution");
      Kq(c2, "language");
      if ("newest" === a2.b && "traffic" !== a2.f)
        for (d in c2.maps)
          c2.maps[d].hash && c2.maps[d].newest && (a2.b = c2.maps[d].hash, a2.dispatchEvent("versionupdate"));
      a2.u = c2;
      a2.dispatchEvent("infoupdate");
    }, function(c2) {
      throw c2;
    });
  }
  function Lq(a2) {
    var b2 = a2.v().clone().G("copyright").G(a2.vc()).I({ output: "json" });
    a2.c && b2.Ba(a2.c[0]);
    a2.l = 1;
    a2.B(b2, function(c2) {
      a2.l = 2;
      mq(a2.s, c2);
      a2.dispatchEvent("copyrightupdate");
    }, function(c2) {
      a2.l = -1;
      throw c2;
    });
  }
  Iq.prototype.Fe = function() {
    return this.u;
  };
  Iq.prototype.getInfo = Iq.prototype.Fe;
  Iq.prototype.ue = function(a2, b2, c2, d, e, f2) {
    var g = this.v().clone().G(a2 + "/" + this.vc() + "/" + b2 + "/" + c2 + "/" + d).I(e ? e : {}).toString();
    var h = 0, k, l = g.length;
    if (0 !== l)
      for (k = 0; k < l; k++) {
        var m = g.charCodeAt(k);
        h = (h << 5) - h + m;
        h |= 0;
      }
    g = h;
    h = this.m[g];
    h || (h = new Hq(this, a2, b2, c2, d, e, yp({ headers: this.g }, f2 || {})), this.m[g] = h);
    return h;
  };
  Iq.prototype.createTileProvider = Iq.prototype.ue;
  Iq.prototype.nc = function(a2, b2, c2, d, e, f2, g, h) {
    a2 = this.ue(a2, b2, c2, d, e, h);
    return new sl(a2, { opacity: f2, dark: !!g });
  };
  Iq.prototype.createTileLayer = Iq.prototype.nc;
  X.prototype.ih = function(a2) {
    return this.Ma(Iq, a2);
  };
  X.prototype.getMapTileService = X.prototype.ih;
  function Mq(a2) {
    Mq.j.constructor.call(this, Mq, a2);
  }
  u(Mq, Op);
  t("H.service.publicTransit.Service", Mq);
  Mq.prototype.Aa = function() {
    return { subDomain: "transit.router", path: "v8" };
  };
  Mq.CONFIG_KEY = "publicTransit";
  Mq.prototype.Tm = function(a2, b2, c2) {
    a2 = this.v().clone().G("routes").I(a2);
    return this.B(a2, b2, c2);
  };
  Mq.prototype.getRoutes = Mq.prototype.Tm;
  Mq.prototype.$l = function(a2, b2, c2) {
    a2 = this.v().clone().G("departures").I(a2);
    return this.B(a2, b2, c2);
  };
  Mq.prototype.getDepartures = Mq.prototype.$l;
  Mq.prototype.Xm = function(a2, b2, c2) {
    a2 = this.v().clone().G("stations").I(a2);
    return this.B(a2, b2, c2);
  };
  Mq.prototype.getStations = Mq.prototype.Xm;
  Mq.prototype.a = function(a2) {
    return Error(JSON.stringify(a2));
  };
  X.prototype.Pm = function(a2) {
    return this.Ma(Mq, a2);
  };
  X.prototype.getPublicTransitService = X.prototype.Pm;
  function Nq(a2) {
    Nq.j.constructor.call(this, Nq, a2);
    zp(Nq, "Use HERE Routing API v8 instead.");
  }
  u(Nq, Op);
  t("H.service.RoutingService", Nq);
  Nq.prototype.Aa = function() {
    return { subDomain: "route.ls", path: "routing/7.2" };
  };
  Nq.prototype.a = function(a2) {
    return Error(a2.details);
  };
  Nq.CONFIG_KEY = "routing";
  Nq.prototype.Cd = function(a2, b2, c2) {
    a2 = this.v().clone().G("calculateroute.json").I(a2);
    return this.B(a2, b2, c2);
  };
  Nq.prototype.calculateRoute = Nq.prototype.Cd;
  Nq.prototype.Ng = function(a2, b2, c2) {
    a2 = this.v().clone().Ba("isoline").G("calculateisoline.json").I(a2);
    return this.B(a2, b2, c2);
  };
  Nq.prototype.calculateIsoline = Nq.prototype.Ng;
  function Oq(a2) {
    Oq.j.constructor.call(this, Oq, a2);
  }
  u(Oq, Op);
  t("H.service.RoutingService8", Oq);
  Oq.CONFIG_KEY = "routing_v8";
  Oq.prototype.Aa = function() {
    return { subDomain: "router", path: "v8/routes" };
  };
  Oq.prototype.a = function(a2) {
    return Error(a2.error);
  };
  Oq.prototype.Cd = function(a2, b2, c2) {
    a2 = this.v().clone().I(a2);
    return this.B(a2, b2, c2);
  };
  Oq.prototype.calculateRoute = Oq.prototype.Cd;
  Oq.prototype.Ng = function(a2, b2, c2) {
    a2 = this.v().clone().Ba("isoline").wd("v8/isolines").I(a2);
    return this.B(a2, b2, c2);
  };
  Oq.prototype.calculateIsoline = Oq.prototype.Ng;
  X.prototype.Fj = function(a2, b2) {
    b2 = Mn ? 8 : +b2 || 7;
    if (7 === b2)
      b2 = Nq;
    else if (8 === b2)
      b2 = Oq;
    else
      throw new D(this.Fj, 1, "allowed values are 7 and 8");
    return this.Ma(b2, a2);
  };
  X.prototype.getRoutingService = X.prototype.Fj;
  function Pq() {
  }
  t("H.service.extension.dataView.ITable", Pq);
  Pq.prototype.Md = function() {
  };
  Pq.prototype.getMeta = Pq.prototype.Md;
  Pq.prototype.Pd = function() {
  };
  Pq.prototype.getRowCount = Pq.prototype.Pd;
  Pq.prototype.tc = function() {
  };
  Pq.prototype.getRow = Pq.prototype.tc;
  Pq.prototype.Ta = function() {
  };
  Pq.prototype.getColumnNames = Pq.prototype.Ta;
  Pq.prototype.Be = function() {
  };
  Pq.prototype.getColumn = Pq.prototype.Be;
  Pq.prototype.ua = function() {
  };
  Pq.prototype.getCell = Pq.prototype.ua;
  Pq.prototype.concat = function() {
  };
  Pq.prototype.concat = Pq.prototype.concat;
  function Qq() {
  }
  t("H.service.extension.dataView.IRow", Qq);
  Qq.prototype.Ta = function() {
  };
  Qq.prototype.getColumnNames = Qq.prototype.Ta;
  Qq.prototype.ua = function() {
  };
  Qq.prototype.getCell = Qq.prototype.ua;
  Qq.prototype.md = function() {
  };
  Qq.prototype.getTable = Qq.prototype.md;
  function Rq(a2, b2) {
    this.a = a2;
    this.b = b2;
  }
  t("H.service.extension.dataView.ObjRow", Rq);
  Rq.prototype.Ta = function() {
    return this.a.Ta();
  };
  Rq.prototype.getColumnNames = Rq.prototype.Ta;
  Rq.prototype.ua = function(a2) {
    return this.a.ua(this.b, a2);
  };
  Rq.prototype.getCell = Rq.prototype.ua;
  Rq.prototype.md = function() {
    return this.a;
  };
  Rq.prototype.getTable = Rq.prototype.md;
  function Sq() {
  }
  t("H.service.extension.dataView.IColumn", Sq);
  Sq.prototype.ua = function() {
  };
  Sq.prototype.getCell = Sq.prototype.ua;
  function Tq(a2, b2) {
    this.b = a2;
    this.a = b2;
  }
  t("H.service.extension.dataView.ObjColumn", Tq);
  Tq.prototype.ua = function(a2) {
    return this.b.ua(a2, this.a);
  };
  Tq.prototype.getCell = Tq.prototype.ua;
  function Uq(a2, b2, c2) {
    var d;
    b2 = b2 || (a2 && a2.length ? Object.keys(a2[0]) : B);
    this.Cb = a2;
    if (b2)
      for (this.Dd = b2, this.Pg = a2 = oc(), d = b2.length; d--; )
        a2[b2[d]] = true;
    c2 !== B && (this.Sh = c2);
  }
  t("H.service.extension.dataView.ObjTable", Uq);
  p = Uq.prototype;
  p.Sh = B;
  p.Cb = B;
  p.Dd = B;
  p.Pg = B;
  p.Md = function() {
    return this.Sh;
  };
  Uq.prototype.getMeta = Uq.prototype.Md;
  Uq.prototype.Pd = function() {
    return this.Cb ? this.Cb.length : 0;
  };
  Uq.prototype.getRowCount = Uq.prototype.Pd;
  Uq.prototype.tc = function(a2) {
    var b2 = this.Cb;
    return b2 && b2[a2] ? new Rq(this, a2) : B;
  };
  Uq.prototype.getRow = Uq.prototype.tc;
  Uq.prototype.Ta = function() {
    return this.Dd || hf;
  };
  Uq.prototype.getColumnNames = Uq.prototype.Ta;
  Uq.prototype.Be = function(a2) {
    return this.Pg[a2] ? new Tq(this, a2) : B;
  };
  Uq.prototype.getColumn = Uq.prototype.Be;
  Uq.prototype.ua = function(a2, b2) {
    var c2 = this.Cb;
    return (a2 = c2 && this.Pg[b2] && c2[a2]) && a2[b2];
  };
  Uq.prototype.getCell = Uq.prototype.ua;
  Uq.prototype.concat = function() {
    var a2 = arguments.length, b2, c2 = this.Dd, d = "" + this.Dd, e = (this.Cb || []).slice();
    for (b2 = 0; b2 < a2; b2++) {
      var f2 = arguments[b2];
      if (!(f2 instanceof Uq))
        throw new D(this.concat, b2);
      if (f2.Cb) {
        if (c2 && "" + f2.Dd !== d)
          throw new D(this.concat, b2, "Incompatible columns!");
        e = e.concat(f2.Cb);
      }
    }
    return new Uq(e, this.Dd, this.Sh);
  };
  Uq.prototype.concat = Uq.prototype.concat;
  function Vq(a2, b2) {
    a2.Cb ? a2.Cb.push(b2) : a2.Cb = [b2];
    return a2.Cb.length - 1;
  }
  ;
  function Wq(a2) {
    var b2 = Xq;
    if (!a2 || !Cc(af(a2.layerId, a2.layer)) || !Fc(a2.level) || vc(a2.rowFilter) && !Da(a2.rowFilter) || vc(a2.rowFilterContext) && !Ea(a2.rowFilterContext))
      throw new D(b2, 1, vc("invalid layer config") ? "invalid layer config" : a2);
  }
  ;
  function Yq(a2, b2, c2, d) {
    d = d || Zq;
    this.a = {};
    d.provider = a2;
    this.invalidate = gf;
    Yq.j.constructor.call(this, b2, d);
    delete this.invalidate;
    c2 && (this.b = c2);
    this.ra(kh.ADD);
  }
  u(Yq, Hh);
  t("H.service.remote.Spatial", Yq);
  var Zq = {};
  Yq.prototype.cb = function() {
    return this.b || Hh.prototype.cb.call(this);
  };
  Yq.prototype.getId = Yq.prototype.cb;
  Yq.prototype.pg = ld;
  Yq.prototype.retain = Yq.prototype.pg;
  Yq.prototype.release = ff;
  Yq.prototype.release = Yq.prototype.release;
  function $q(a2, b2) {
    this.a = a2;
    b2 && (this.b = b2);
  }
  var ar = new $q(hf);
  Yq.prototype.Kd = function(a2) {
    return (this.a[a2.key] || ar).a;
  };
  Yq.prototype.getGeometriesForTile = Yq.prototype.Kd;
  Yq.prototype.gh = function(a2) {
    return (this.a[a2.key] || ar).b;
  };
  Yq.prototype.getLabels = Yq.prototype.gh;
  function br(a2, b2, c2) {
    a2.a[b2.key] = new $q(c2, void 0);
  }
  ;
  function cr(a2, b2, c2, d) {
    if (!Da(c2))
      throw new D(a2, b2, "has invalid type");
    if (!Da(d))
      throw new D(a2, b2 + 1, "has invalid type");
  }
  ;
  function dr(a2, b2, c2) {
    var d = 8 === a2;
    this.b = b2;
    this.c = c2 || ld;
    (this.a = 4 === a2 || d) ? this.l = d : this.g = 1 === a2;
    this.f = this.a ? "$HProjGeometry" : "geometry";
  }
  dr.prototype.parse = function(a2, b2, c2) {
    var d, e, f2 = {}, g = [], h, k;
    var l = 0;
    for (h = c2.length; l < h; l++) {
      var m = c2[l];
      var n = m.Rows;
      if (m = n.length) {
        var q = Object.keys(n[0]).filter(function(v) {
          return "geometry" !== v && "$HProjGeometry" !== v;
        });
        q = new Uq(n, q);
        for (k = 0; k < m; k++) {
          var r = n[k];
          if (e = r[this.f]) {
            if (delete r[this.f], r = q.tc(k))
              try {
                this.a ? d = er(this, a2, b2, r, e) : d = fr(this, a2, r, e.path), d.ka(a2), g.push(d);
              } catch (v) {
                this.c(v.message);
              }
          } else
            this.c("Layer must contain geometries");
        }
      }
    }
    f2[this.a ? "spatials" : this.g ? "markers" : "domMarkers"] = g;
    return f2;
  };
  function er(a2, b2, c2, d, e) {
    var f2 = [], g = e.paths, h = g.length, k = 0, l = a2.b && a2.b(d);
    for (a2 = new Yq(b2, a2.l, B, { style: l || a2.i, data: d }); k !== h; )
      f2.push(gr(g[k++]));
    br(a2, c2, [new Ph(f2, e.interiorsIndex, e.outlinesIndex)]);
    return a2;
  }
  function fr(a2, b2, c2, d) {
    d = new kg(d[0], d[1]);
    var e = a2.b && a2.b(c2);
    a2.g ? (a2 = { icon: e, data: c2, provider: b2 }, a2 = new Rn(d, a2)) : (a2 = { icon: e, data: c2, provider: b2 }, a2 = new bj(d, a2));
    return a2;
  }
  function gr(a2) {
    for (var b2 = 0, c2 = a2.length, d = []; b2 < c2; )
      d.push(new J(a2[b2++], a2[b2++]));
    return d;
  }
  ;
  function hr(a2, b2) {
    var c2 = {};
    this.c = a2;
    Ya(c2, b2 || c2);
    ok.call(this, c2);
    this.ig = {};
    a2 = this.Kb(nh.SPATIAL);
    a2.update(a2.a + 1, kh.ADD);
  }
  u(hr, ok);
  t("H.service.remote.ObjectProvider", hr);
  hr.prototype.F = function() {
    ok.prototype.F.call(this);
  };
  hr.prototype.dispose = hr.prototype.F;
  hr.prototype.Ec = function() {
    return hf;
  };
  hr.prototype.requestMarkers = hr.prototype.Ec;
  hr.prototype.Dc = function() {
    return hf;
  };
  hr.prototype.requestDomMarkers = hr.prototype.Dc;
  hr.prototype.sd = function() {
    return hf;
  };
  hr.prototype.requestOverlays = hr.prototype.sd;
  hr.prototype.Rb = ff;
  hr.prototype.providesMarkers = hr.prototype.Rb;
  hr.prototype.Qb = ff;
  hr.prototype.providesDomMarkers = hr.prototype.Qb;
  hr.prototype.Cc = ff;
  hr.prototype.providesSpatials = hr.prototype.Cc;
  hr.prototype.kg = function() {
    return hf;
  };
  hr.prototype.requestSpatials = hr.prototype.kg;
  function ir(a2) {
    return a2.wc(true);
  }
  hr.prototype.mg = function(a2, b2) {
    a2 = jr(this, a2, kr);
    b2 && (a2 = a2.filter(ir));
    return a2;
  };
  hr.prototype.requestSpatialsByTile = hr.prototype.mg;
  function jr(a2, b2, c2) {
    var d = b2.l && b2.l[c2], e;
    !d && (e = b2.s) && (delete b2.s, (b2.l = a2 = a2.c.parse(a2, b2, e)) && (d = a2[c2]));
    return d || hf;
  }
  hr.prototype.fa = function(a2) {
    var b2 = a2.cb();
    if (this.ig[b2])
      throw new $c(this.fa, "Remote object " + b2 + " already added");
    return this.ig[b2] = a2;
  };
  hr.prototype.Ga = function(a2) {
    delete this.ig[a2.cb()];
  };
  var kr = "spatials";
  function lr(a2) {
    a2 = a2 || {};
    var b2 = a2.tileCacheSize || 1024, c2 = a2.resultType, d = a2.styleCallback;
    vc(a2.min) || (a2.min = 12);
    lr.j.constructor.call(this, a2);
    if (-1 === mr.indexOf(c2))
      throw new D(lr, 2, "invalid resultType");
    this.f = c2;
    if (d && !Da(d))
      throw new D(lr, 2, "invalid style callback");
    this.aa = d;
    this.R = a2.pixelRatio || Ue();
    this.Gb = A(this.Gb, this);
    this.J(new Rk(b2, A(this.ab, this)));
    this.createTileInternal = 4 === c2 || 8 === c2 ? A(this.T, this) : A(this.L, this);
  }
  u(lr, S);
  t("H.service.extension.TileProvider", lr);
  lr.prototype.i = false;
  lr.prototype.getCapabilities = function() {
    return lr.j.getCapabilities.call(this) | Qj.CROP_LINES_BY_TILE | Qj.CROP_POLYGONS_BY_TILE;
  };
  lr.prototype.Ha = function(a2, b2, c2, d) {
    return this.i ? lr.j.Ha.call(this, a2, b2, c2, d) : B;
  };
  lr.prototype.requestTile = lr.prototype.Ha;
  lr.prototype.Gb = function(a2) {
    this.dispatchEvent(new wd("error", Cc(a2) ? a2 : a2 + "", this));
  };
  lr.prototype.Rb = function() {
    return 1 === this.f;
  };
  lr.prototype.providesMarkers = lr.prototype.Rb;
  lr.prototype.Qb = function() {
    return 2 === this.f;
  };
  lr.prototype.providesDomMarkers = lr.prototype.Qb;
  lr.prototype.Cc = function() {
    return 4 === this.f || 8 === this.f;
  };
  lr.prototype.providesSpatials = lr.prototype.Cc;
  function nr(a2) {
    var b2 = a2.qa;
    b2 || (a2.u || (a2.u = a2.m(a2.f, a2.aa, a2.Gb)), b2 = a2.qa = new hr(a2.u), b2.ka(a2), b2.addEventListener(a2.A.za, A(a2.xa, a2)), b2.qa = true);
    return b2;
  }
  lr.prototype.L = function(a2, b2, c2, d) {
    var e = this.getTileKey(a2, b2, c2);
    e = this.nb().get(e);
    var f2 = 2 == this.f, g = [], h = nr(this);
    e ? e.valid = true : (a2 = e = new Xk(a2, b2, c2, z), delete a2.l, a2.s = d);
    d = f2 ? jr(h, e, "domMarkers") : jr(h, e, "markers");
    for (b2 = d.length; b2--; )
      a2 = d[b2], a2.Ii = e, (f2 || 1 === a2.xb().getState()) && g.push(a2);
    e.data = g;
    return e;
  };
  lr.prototype.xa = function(a2) {
    if (a2 = a2.target.Ii)
      a2.valid = false;
  };
  lr.prototype.Ao = function(a2) {
    this.D = !!a2;
  };
  lr.prototype.setTileCanvasRendering = lr.prototype.Ao;
  lr.prototype.D = true;
  lr.prototype.T = function(a2, b2, c2, d) {
    var e = nr(this), f2 = this.getTileKey(a2, b2, c2), g = this.tileSize, h = this.nb().get(f2);
    h || (a2 = h = new al(f2, a2, b2, c2, g, this.R, c2, e), delete a2.l, a2.s = d);
    this.D ? (d = Cp.pop(g), h.W(d) || Cp.push(d, g)) : gl(h);
    return h;
  };
  lr.prototype.ab = function(a2, b2) {
    var c2;
    if (4 === this.f || 8 === this.f) {
      a2 = b2.Ua();
      for (c2 = a2.length; c2--; )
        delete a2[c2].a[b2.key];
      if (a2 = b2.gg())
        Cp.push(a2, this.tileSize), b2.hg();
    } else
      for (a2 = b2.data, c2 = a2.length; c2--; )
        delete a2[c2].Ii;
  };
  lr.prototype.o = function() {
    lr.j.o.call(this);
    nr(this).F();
  };
  var or = { MARKER: 1, DOM_MARKER: 2, POLYLINE: 4, POLYGON: 8 };
  lr.ResultType = or;
  var mr = [1, 2, 4, 8];
  function Xq(a2, b2, c2) {
    var d = this, e = b2 && b2.rowFilter, f2 = c2.resultType;
    Xq.j.constructor.call(this, c2);
    C(a2, pr, Xq, 0);
    Wq(b2);
    e ? (c2 = Wa(b2), c2.rowFilter = e.toString()) : c2 = Wa(b2);
    delete c2.layer;
    c2.layerId = af(b2.layerId, b2.layer);
    new Pf().a("pde", "H.service.extension.worker.processor");
    a2 = a2.v().clone().G(qr + "." + rr).I({ meta: 1 });
    new Sf("pde", { message: [this.uid, 0, { tileSize: this.tileSize, projected: true, onlyOutline: 4 === f2, serverUrl: a2.toString(), layerConfigs: [c2], horizontalMargin: 1 }] }).then(function() {
      d.i = true;
      d.Va();
    }, this.Gb);
  }
  u(Xq, lr);
  t("H.service.extension.platformData.TileProvider", Xq);
  Xq.prototype.m = function(a2, b2, c2) {
    a2 = new dr(a2, b2, c2);
    a2.i = sr;
    return a2;
  };
  var sr = new wh({ strokeColor: "transparent", fillColor: "transparent", lineWidth: 0, lineJoin: "round", lineCap: "round" });
  Xq.prototype.B = function(a2, b2, c2, d, e) {
    var f2 = this, g = this.getTileKey(a2, b2, c2), h;
    g = this.nb().get(g);
    var k = { cancel: ld }, l = true, m = this.f;
    g && (4 === m || 8 === m ? g.Ud() || (d(Cp.pop(this.tileSize), null), l = false) : (d(z), l = false));
    if (l) {
      var n = Ap.setTimeout(function() {
        h = new Sf("pde", { message: [f2.uid, 1, [a2, b2, c2]] });
        h.then(d, e);
      }, 500);
      k.cancel = function() {
        h ? h.cancel() : Ap.clearTimeout(n);
      };
    }
    return k;
  };
  Xq.prototype.requestInternal = Xq.prototype.B;
  Xq.prototype.o = function() {
    Xq.j.o.call(this);
    new Sf("pde", { message: [this.uid, 3] });
  };
  Xq.ResultType = or;
  function tr(a2, b2, c2, d, e, f2) {
    cr(tr, 1, b2, c2);
    cr(tr, 2, d, e);
    (this.f = a2.length) ? (this.U = a2, this.m = b2, this.i = c2, this.b = 0, this.c = A(this.c, this), this.s = d, this.l = e, this.a = oc(), Ya(this.a, ur, f2 || {}), this.g = {}, x.setTimeout(this.c, 0)) : b2(hf, true);
  }
  var ur = { duration: 100, Kl: "geometry", Jl: "WKT", uo: "searchAttributes", hj: B };
  tr.prototype.c = function() {
    var a2 = [];
    var b2 = false;
    for (var c2 = Lk(), d; this.b < this.f; ) {
      var e = this.U[this.b];
      b2 = e.attributes;
      d = e.layerId || this.a.hj;
      e.distance && (b2[this.a.uo] = { nearest: new kg(e.nearestLat, e.nearestLon), distance: e.distance });
      if (e = e[this.a.Kl]) {
        try {
          var f2 = Wn(new qo(e));
        } catch (g) {
          this.i(new x.Error(g.message));
          b2 = true;
          break;
        }
        b2[this.a.Jl] = f2;
      }
      (e = this.g[d]) || (e = this.g[d] = this.s({ layerId: d, columnNames: Object.keys(b2) }));
      b2 = this.l(e, b2);
      a2.push(b2);
      this.b++;
      if ((b2 = this.b === this.f) || Lk() - c2 >= this.a.duration) {
        this.m(
          a2,
          b2
        );
        break;
      }
    }
    b2 ? this.g = {} : this.u = x.setTimeout(this.c, 0);
  };
  tr.prototype.cancel = function() {
    x.clearTimeout(this.u);
    this.b < this.f && this.i(new x.Error("parsing canceled"));
  };
  tr.prototype.cancel = tr.prototype.cancel;
  function vr(a2) {
    this.a = a2;
  }
  vr.prototype.cancel = function() {
    for (var a2 = this.a, b2 = a2.length; b2--; )
      a2[b2].cancel();
    a2.length = 0;
  };
  vr.prototype.cancel = vr.prototype.cancel;
  function pr(a2) {
    pr.j.constructor.call(this, pr, a2);
    zp(pr);
  }
  u(pr, Op);
  t("H.service.extension.platformData.Service", pr);
  pr.prototype.Aa = function() {
    return { subDomain: "s.fleet.ls", path: "1" };
  };
  pr.CONFIG_KEY = "platformData";
  pr.prototype.request = function(a2, b2, c2, d, e) {
    var f2 = "text/plain";
    if (!a2)
      throw new D(this.request, 0, a2);
    if (!b2)
      throw new D(this.request, 1, b2);
    if (!d)
      throw new D(this.request, 3, d);
    if (!e)
      throw new D(this.request, 4, e);
    a2 = this.v().clone().G(a2 + "." + b2).I(c2);
    b2 === wr.JSON && (f2 = "application/json");
    return this.B(a2, d, e, f2);
  };
  pr.prototype.request = pr.prototype.request;
  var qr = "tiles";
  pr.EntryPoint = { DOC_ATTRIBUTES: "doc/attributes", DOC_LAYER: "doc/layer", DOC_LAYERS: "doc/layers", DOC_MAPS: "doc/maps", DOC_INDEXES: "doc/indexes", SEARCH_BBOX: "search/bbox", SEARCH_CORRIDOR: "search/corridor", SEARCH_PROXIMITY: "search/proximity", SEARCH_QUADKEY: "search/quadkey", SERVICE_CONFIGURATION: "serviceconfiguration", STATIC: "static", TILE: "tile", TILES: qr, FILE: "file", INDEX: "index" };
  var rr = "json", wr = { TXT: "txt", JSON: rr, HTML: "html", BIN: "bin" };
  pr.EntryPointType = wr;
  pr.prototype.nc = function(a2, b2) {
    var c2 = b2 && b2.resultType;
    a2 = new Xq(this, a2, b2);
    var d;
    1 == c2 || 2 === c2 ? d = new Sn(a2) : d = new sl(a2);
    return d;
  };
  pr.prototype.createTileLayer = pr.prototype.nc;
  function xr(a2, b2, c2, d, e) {
    var f2 = [], g, h = c2.layer_id || c2.layer_ids;
    a2 = a2.request(b2, rr, c2, function(k) {
      g = new tr(k.geometries, d, e, function(l) {
        return new Uq([], l.columnNames, l);
      }, function(l, m) {
        return l.tc(Vq(l, m));
      }, { hj: h });
      f2.push(g);
    }, function(k) {
      e(new x.Error(k));
    });
    f2.push(a2);
    return new vr(f2);
  }
  function yr(a2, b2, c2) {
    if (!Bc(a2))
      throw new D(c2, 0, "has invalid type");
    if (!Bc(b2))
      throw new D(c2, 1, "has invalid type");
    if (a2.length !== b2.length || !a2.length)
      throw new D(c2, 1, "specify one key attribute for each given layer id in the same order");
  }
  pr.prototype.Fc = function(a2, b2, c2, d, e, f2) {
    function g(l, m) {
      m && h--;
      d(l, !h);
    }
    var h, k = [];
    yr(a2, b2, this.Fc);
    cr(this.Fc, 3, d, e);
    C(c2, K, this.Fc, 2);
    c2 = { bbox: c2.c + "," + c2.a + ";" + c2.f + "," + c2.b };
    f2 && Ya(c2, f2);
    a2 = c2.layer_id ? [c2.layer_id] : a2;
    f2 = 0;
    for (h = a2.length; f2 < h; f2++)
      c2.layer_id = a2[f2], c2.key_attribute = b2[f2], k.push(xr(this, "search/bbox", c2, g, e));
    return new vr(k);
  };
  pr.prototype.searchByBoundingBox = pr.prototype.Fc;
  pr.prototype.Ub = function(a2, b2, c2, d, e, f2, g) {
    yr(a2, b2, this.Ub);
    C(c2, kg, this.Ub, 2, "has invalid type");
    if (!Fc(d))
      throw new D(this.Ub, 3, "has invalid type");
    cr(this.Ub, 4, e, f2);
    a2 = { layer_ids: a2.join(","), key_attributes: b2.join(","), proximity: c2.lat + "," + c2.lng + "," + d };
    g && Ya(a2, g);
    return xr(this, "search/proximity", a2, e, f2);
  };
  pr.prototype.searchByProximity = pr.prototype.Ub;
  pr.prototype.Tb = function(a2, b2, c2, d, e, f2, g) {
    var h = "";
    yr(a2, b2, this.Tb);
    if (!Cc(c2) && !C(c2, L))
      throw new D(this.Tb, 1, "has invalid type");
    if (!Fc(d))
      throw new D(this.Tb, 2, "has invalid type");
    cr(this.Tb, 4, e, f2);
    a2 = { layer_ids: a2.join(","), key_attributes: b2.join(","), radius: d };
    if (Cc(c2))
      a2.route_id = c2;
    else {
      d = c2.$;
      c2 = 0;
      for (b2 = d.length; c2 < b2; c2 += 3)
        h += d[c2] + "," + d[c2 + 1], c2 < b2 - 3 && (h += ";");
      a2.corridor = h;
    }
    g && Ya(a2, g);
    return xr(this, "search/corridor", a2, e, f2);
  };
  pr.prototype.searchByCorridor = pr.prototype.Tb;
  X.prototype.Jm = function(a2) {
    return this.Ma(pr, a2);
  };
  X.prototype.getPlatformDataService = X.prototype.Jm;
  function zr(a2) {
    zr.j.constructor.call(this, zr, a2);
    zp(zr);
  }
  u(zr, Op);
  t("H.service.extension.geofencing.Service", zr);
  zr.prototype.Aa = function() {
    return { subDomain: "fleet.ls", path: "2" };
  };
  zr.CONFIG_KEY = "geofencing";
  zr.prototype.request = function(a2, b2, c2, d) {
    if (!a2)
      throw new D(this.request, 0, a2);
    if (!Da(c2))
      throw new TypeError("onResult must be a function");
    if (!Da(d))
      throw new TypeError("onError must be a function");
    a2 = this.v().clone().G(a2 + ".json").I(b2);
    return this.B(a2, c2, d);
  };
  zr.prototype.request = zr.prototype.request;
  zr.prototype.a = function(a2) {
    return Error(a2.issues && a2.issues.length ? a2.issues.map(function(b2) {
      return b2.message;
    }).join(". ") : a2.message || a2.response_code);
  };
  zr.EntryPoint = { SEARCH_PROXIMITY: "search/proximity" };
  X.prototype.lm = function(a2) {
    return this.Ma(zr, a2);
  };
  X.prototype.getGeofencingService = X.prototype.lm;
  t("H.service.extension.customLocation.Permission", { READ: "read", WRITE: "write", EXPORT: "export" });
  t("H.service.extension.customLocation.Storage", { READONLY: "readonly", UPDATABLE: "updatable" });
  function Ar(a2) {
    var b2 = Br;
    if (!a2 || !Cc(a2.layerId) || vc(a2.rowFilter) && !Da(a2.rowFilter) || vc(a2.rowFilterContext) && !Ea(a2.rowFilterContext))
      throw new D(b2, 1, vc("invalid layer config") ? "invalid layer config" : a2);
  }
  function Cr(a2) {
    return Cc(a2) && /^[A-Z][A-Z0-9_]*$/.test(a2);
  }
  function Dr(a2) {
    for (var b2 = a2 && a2.length, c2 = 2 <= b2 && "WKT" === a2[--b2] && "GEOMETRY_ID" === a2[--b2]; c2 && b2--; )
      c2 = Cr(a2[b2]);
    return c2;
  }
  function Er(a2, b2) {
    var c2 = "", d = [];
    if (b2) {
      var e = a2.geometries;
      if (e && e.length) {
        var f2 = Object.keys(e[0].attributes);
        c2 = c2 + ("Meta:	" + b2 + "\n") + f2.join("	");
        c2 += "	WKT\n";
        for (a2 = 0; a2 < e.length; a2++) {
          var g = e[a2].attributes;
          var h = e[a2].geometry;
          for (b2 = 0; b2 < f2.length; b2++)
            d.push(g[f2[b2]]);
          c2 += d.join("	");
          c2 += "	" + h + "\n";
          d = [];
        }
      }
    } else {
      h = {};
      d = [];
      if (a2.geometries)
        for (e = 0; e < a2.geometries.length; e++)
          b2 = a2.geometries[e], h[b2.layerId] || (h[b2.layerId] = []), h[b2.layerId].push(b2);
      for (f2 in h)
        d.push({ layerId: f2, geometries: h[f2] });
      for (a2 = 0; a2 < d.length; a2++)
        c2 += Er(d[a2], d[a2].layerId);
    }
    return c2;
  }
  ;
  function Br(a2, b2, c2) {
    var d = this, e = b2 && b2.rowFilter, f2;
    Br.j.constructor.call(this, c2);
    C(a2, Fr, Br, 0);
    var g = c2.resultType;
    Ar(b2);
    if (e) {
      var h = Wa(b2);
      h.rowFilter = e.toString();
    } else
      h = b2;
    new Pf().a("cle", "H.service.extension.worker.processor");
    var k = b2.layerId;
    a2.request(Gr, Hr, { detail_level: "all", layer_id: k }, function(l) {
      l = l.layers;
      var m;
      for (m = 0; m < l.length; m++)
        if (l[m].layerId === k) {
          h.level = l[m].level;
          break;
        }
      f2 = a2.v().clone().G(Ir + "." + Hr).I({ meta: 1 });
      new Sf("cle", { message: [d.uid, 0, { tileSize: d.tileSize, projected: true, onlyOutline: 4 === g, serverUrl: f2.toString(), layerConfigs: [h], batchTiles: false, horizontalMargin: 1 }] }).then(function() {
        d.i = true;
        d.Va();
      }, d.Gb);
    }, function(l) {
      d.Gb(l.message);
    });
  }
  u(Br, lr);
  t("H.service.extension.customLocation.TileProvider", Br);
  Br.prototype.m = function(a2, b2, c2) {
    return new dr(a2, b2, c2);
  };
  Br.prototype.B = function(a2, b2, c2, d, e) {
    var f2 = this, g = this.getTileKey(a2, b2, c2), h;
    g = this.nb().get(g);
    var k = { cancel: ld }, l = true, m = this.f;
    g && (4 === m || 8 === m ? g.Ud() || (d(Cp.pop(this.tileSize), null), l = false) : (d(z), l = false));
    if (l) {
      var n = Ap.setTimeout(function() {
        h = new Sf("cle", { message: [f2.uid, 1, [a2, b2, c2]] });
        h.then(d, e);
      }, 500);
      k.cancel = function() {
        h ? h.cancel() : Ap.clearTimeout(n);
      };
    }
    return k;
  };
  Br.prototype.requestInternal = Br.prototype.B;
  Br.prototype.o = function() {
    Br.j.o.call(this);
    new Sf("cle", { message: [this.uid, 3] });
  };
  function Jr() {
    if (Kr)
      throw new $c(Jr);
  }
  t("H.service.extension.customLocation.Table", Jr);
  var Kr = true;
  function Lr(a2, b2) {
    var c2;
    Kr = false;
    var d = new Jr();
    Kr = true;
    d.c = rc(x.JSON.parse(x.JSON.stringify(a2)));
    a2 = a2.columnNames;
    var e = oc();
    for (c2 = a2.length; c2--; )
      e[a2[c2]] = c2;
    d.f = e;
    d.b = a2.length;
    if (b2) {
      if (b2.length % a2.length)
        throw new D(Lr, 1, "Invalid number of cells");
    } else
      b2 = [];
    d.a = b2;
    return d;
  }
  Jr.prototype.Md = function() {
    return this.c;
  };
  Jr.prototype.getMeta = Jr.prototype.Md;
  Jr.prototype.Pd = function() {
    return this.a.length / this.b;
  };
  Jr.prototype.getRowCount = Jr.prototype.Pd;
  Jr.prototype.tc = function(a2) {
    return a2 < this.a.length / this.b ? new Mr(this, a2) : B;
  };
  Jr.prototype.getRow = Jr.prototype.tc;
  Jr.prototype.Um = function() {
    var a2 = this.a.length / this.b, b2, c2 = new x.Array(a2);
    for (b2 = 0; b2 < a2; b2++)
      c2[b2] = new Mr(this, b2);
    return c2;
  };
  Jr.prototype.getRows = Jr.prototype.Um;
  Jr.prototype.Hg = function(a2) {
    var b2 = this.b, c2 = this.a, d = c2.length / this.b;
    if (!a2 || a2.length % b2)
      throw new D(this.Hg, 0, "Invalid number of cells");
    this.a = c2.concat(a2);
    return d;
  };
  Jr.prototype.addCells = Jr.prototype.Hg;
  Jr.prototype.ol = function() {
    for (var a2 = this.b, b2 = this.a, c2 = this.a.length / this.b; a2--; )
      b2.push(z);
    return this.tc(c2);
  };
  Jr.prototype.addRow = Jr.prototype.ol;
  Jr.prototype.Ta = function() {
    return this.c.columnNames;
  };
  Jr.prototype.getColumnNames = Jr.prototype.Ta;
  Jr.prototype.Be = function(a2) {
    return this.f[a2] === B ? B : new Nr(this, a2);
  };
  Jr.prototype.getColumn = Jr.prototype.Be;
  Jr.prototype.ua = function(a2, b2) {
    return this.a[a2 * this.b + this.f[b2]];
  };
  Jr.prototype.getCell = Jr.prototype.ua;
  Jr.prototype.Gc = function(a2, b2, c2) {
    b2 = this.f[b2];
    if (a2 >= this.a.length / this.b)
      throw new D(this.Gc, 0, "Row index out of bounds");
    if (b2 === B)
      throw new D(this.Gc, 0, "Column unknown");
    this.a[a2 * this.b + b2] = c2;
  };
  Jr.prototype.setCell = Jr.prototype.Gc;
  Jr.prototype.concat = function(a2) {
    var b2 = arguments.length, c2, d = "" + this.Ta(), e = this.a ? this.a.slice() : [];
    for (c2 = 0; c2 < b2; c2++) {
      var f2 = arguments[c2];
      if (!(f2 instanceof Jr))
        throw new D(this.concat, c2);
      if ("" + f2.Ta() !== d)
        throw new D(this.concat, c2, "Incompatible columns!");
      f2.a && (e = e.concat(f2.a));
    }
    return Lr(this.c, e);
  };
  Jr.prototype.concat = Jr.prototype.concat;
  var Or = /(\n|\t|\r|")/;
  Jr.prototype.Gi = function(a2, b2) {
    var c2, d = this.b, e = this.Ta(), f2 = [], g = [], h = this.a, k = -1;
    for (c2 = 0; c2 < d; c2++)
      if (!a2 || a2.test(e[c2]))
        "WKT" === e[c2] && (k = f2.length), f2.push(c2);
    if (!(a2 = f2.length))
      throw new D(this.Gi, 1, "No columns filtered");
    Pr(this, g, e, 0, d, f2, a2, k);
    if (b2) {
      var l = b2.length;
      for (c2 = 0; c2 < l; c2++)
        g.push("\n"), e = b2[c2], Pr(this, g, h, e, d, f2, a2, k);
    } else
      for (l = this.Pd(), e = 0; e < l; e++)
        g.push("\n"), Pr(this, g, h, e, d, f2, a2, k);
    return g.join("");
  };
  function Pr(a2, b2, c2, d, e, f2, g, h) {
    var k;
    for (k = 0; k < g; k++) {
      k && b2.push("	");
      var l = c2[d * e + f2[k]];
      if (k !== h) {
        if (l !== z) {
          l = String(l);
          if (Or.test(l))
            throw new D(a2.Gi, 0, 'Invalid character (\\n, \\r, \\t, or ") in row ' + d + " column " + a2.c.columnNames[f2[k]]);
          b2.push(l);
        }
      } else
        b2.push(l);
    }
  }
  function Nr(a2, b2) {
    this.b = a2;
    this.a = b2;
  }
  Jr.Column = Nr;
  Nr.prototype.ua = function(a2) {
    return this.b.ua(a2, this.a);
  };
  Nr.prototype.getCell = Nr.prototype.ua;
  Nr.prototype.Gc = function(a2, b2) {
    this.b.Gc(a2, this.a, b2);
  };
  Nr.prototype.setCell = Nr.prototype.Gc;
  function Mr(a2, b2) {
    this.a = a2;
    this.Nh = b2;
  }
  Jr.Row = Mr;
  Mr.prototype.Ta = function() {
    return this.a.Ta();
  };
  Mr.prototype.getColumnNames = Mr.prototype.Ta;
  Mr.prototype.ua = function(a2) {
    return this.a.ua(this.Nh, a2);
  };
  Mr.prototype.getCell = Mr.prototype.ua;
  Mr.prototype.Gc = function(a2, b2) {
    this.a.Gc(this.Nh, a2, b2);
  };
  Mr.prototype.setCell = Mr.prototype.Gc;
  Mr.prototype.md = function() {
    return this.a;
  };
  Mr.prototype.getTable = Mr.prototype.md;
  function Qr(a2) {
    if (a2 === B)
      a2 = "	";
    else if (!/^[^"\r\n]$/.test(a2))
      throw new D(Qr, 0);
    this.b = String(a2).charCodeAt(0);
    this.Oh = A(this.Oh, this);
    this.C = Rr;
  }
  var Rr = 0;
  p = Qr.prototype;
  p.getState = function() {
    return this.C;
  };
  function Sr(a2, b2, c2) {
    var d = a2.C;
    if (d !== b2)
      throw 1 === d && (a2.C = Rr), new $c(c2, "Requires state: " + ["READY", "PARSE", "PAUSE"][b2] + " but found " + ["READY", "PARSE", "PAUSE"][d]);
  }
  p.abort = function() {
    Sr(this, 2, Qr.prototype.abort);
    this.C = Rr;
  };
  p.Oh = function(a2) {
    this.C = Rr;
    throw new D(Qr.prototype.parse, 0, "Malformed DSV at row " + this.a.l + " column " + this.a.b + ": " + a2);
  };
  function Tr(a2, b2) {
    var c2 = [];
    a2.parse(b2, function(d, e, f2) {
      1 > d && (c2[e] = f2);
      return 0 < d;
    });
    a2.C = Rr;
    return c2;
  }
  p.parse = function(a2, b2, c2) {
    Sr(this, Rr, Qr.prototype.parse);
    a2 = a2.trim();
    this.a = new Ur(a2, this.b, this.Oh);
    this.c = b2;
    this.kk = c2 || gf;
    this.C = 2;
    this.Ph();
  };
  p.kk = gf;
  p.Ph = function() {
    var a2 = this.a, b2 = [];
    Sr(this, 2, Qr.prototype.Ph);
    this.C = 1;
    do {
      if (!a2.g) {
        this.C = Rr;
        break;
      }
      if (e > a2.b) {
        if (void 0 !== c2 && c2 !== e) {
          this.a.a("The number of columns must be the same for all rows");
          return;
        }
        var c2 = e;
      }
      var d = a2.l;
      var e = a2.b;
      var f2 = a2.tf;
      var g = this.kk(d, e, a2);
      if (a2.tf > f2)
        for (; -1 !== a2.next(); )
          ;
      else {
        for (; -1 !== (f2 = a2.next()); )
          b2.push(f2);
        g = String.fromCharCode.apply(z, b2);
        b2.length = 0;
      }
      Vr(a2);
      this.c(d, e, g) && (this.C = a2.g ? 2 : Rr);
    } while (1 === this.C);
    2 != this.C && void 0 !== c2 && 0 < e && c2 !== e && this.a.a("The number of columns must be the same for all rows");
  };
  function Ur(a2, b2, c2) {
    this.c = new qo(a2);
    this.s = b2;
    this.g = true;
    this.tf = this.l = this.b = 0;
    Vr(this);
    this.a = c2;
    this.f = [];
    this.i = false;
  }
  p = Ur.prototype;
  p.tf = 0;
  function Vr(a2) {
    var b2 = a2.c.Pb();
    a2.m = false;
    (a2.U = 34 === b2) && a2.c.next();
  }
  function Wr(a2, b2) {
    var c2 = a2.c;
    a2.m = true;
    switch (b2) {
      case a2.s:
        a2.b++;
        break;
      case 13:
        c2.next(), 10 !== c2.Pb() && a2.a("CR without LF");
      case 10:
        a2.b = 0;
        a2.l++;
        break;
      case -1:
        a2.g = false;
        break;
      default:
        a2.a("End of field expected");
    }
    c2.next();
    return -1;
  }
  p.Pb = function() {
    if (this.m)
      var a2 = -1;
    else {
      var b2 = this.c;
      a2 = b2.Pb();
      if (this.U)
        switch (a2) {
          case 34:
            b2.next();
            a2 = b2.Pb();
            34 !== a2 && (a2 = Wr(this, a2));
            break;
          case -1:
            this.a("Closing quotation mark expected");
        }
      else
        switch (a2) {
          case 34:
            this.a("Unexpected quotation mark");
          case this.s:
          case 13:
          case 10:
          case -1:
            a2 = Wr(this, a2);
        }
    }
    return a2;
  };
  p.ge = function() {
    this.i = true;
    this.f = [];
  };
  p.Gd = function() {
    var a2 = this.f.slice();
    this.i = false;
    this.f = [];
    return a2;
  };
  p.next = function() {
    var a2 = this.Pb();
    -1 !== a2 && this.c.next();
    this.i && this.f.push(a2);
    this.tf++;
    return a2;
  };
  function Xr(a2, b2, c2, d) {
    d = d || {};
    if (!b2)
      throw new D(Xr, 1, "has to be a function");
    if (!c2)
      throw new D(Xr, 2, "has to be a function");
    this.s = b2;
    this.u = c2;
    this.a = [];
    this.g = {};
    this.f = [];
    this.b = {};
    this.i = {};
    this.l = {};
    this.m = {};
    this.U = d.duration || 100;
    this.c = A(this.c, this);
    a2 = a2.split("Meta:	").slice(1);
    for (b2 = 0; b2 < a2.length; b2++) {
      d = a2[b2].split("\n");
      c2 = d[0].split("	")[0];
      d = d.slice(1).join("\n");
      this.b[c2] = new Qr();
      this.g[c2] = Tr(this.b[c2], d);
      var e = { layerId: c2, columnNames: this.g[c2] };
      this.f.push(c2);
      this.m[c2] = Lr(e);
      this.i[c2] = Lk();
      Yr(this, d, c2);
      this.c(c2);
    }
  }
  function Yr(a2, b2, c2) {
    var d = [], e = a2.g[c2].length - 1, f2 = a2.m[c2];
    try {
      a2.b[c2].parse(b2, function(g, h, k) {
        var l = false;
        0 < g && (d[h] = k, h === e && (a2.a.push(f2.tc(f2.Hg(d))), Lk() - a2.i[c2] > a2.U && (l = true)));
        return l;
      }, function(g, h, k) {
        if (0 < g && h === e)
          return Wn(k);
      });
    } catch (g) {
      a2.u(g);
    }
  }
  Xr.prototype.cancel = function() {
    for (var a2 in this.l)
      x.clearTimeout(this.l[a2]);
  };
  Xr.prototype.cancel = Xr.prototype.cancel;
  Xr.prototype.c = function(a2) {
    var b2 = this, c2, d;
    this.l[a2] = x.setTimeout(function() {
      if (2 === b2.b[a2].getState())
        b2.i[a2] = Lk(), b2.s(b2.a, false), b2.a = [], b2.b[a2].Ph(), b2.c(a2);
      else {
        c2 = true;
        for (d = 0; d < b2.f.length; d++)
          if (b2.b[b2.f[d]].getState() !== Rr) {
            c2 = false;
            break;
          }
        c2 && (0 < b2.a.length && b2.s(b2.a, true), b2.a = []);
      }
    }, 0);
  };
  function Fr(a2) {
    Fr.j.constructor.call(this, Fr, a2);
    zp(Fr);
  }
  u(Fr, Op);
  t("H.service.extension.customLocation.Service", Fr);
  Fr.prototype.Aa = function() {
    return { subDomain: "fleet.ls", path: "2" };
  };
  Fr.CONFIG_KEY = "customLocation";
  Fr.prototype.nc = function(a2, b2) {
    var c2 = b2 && b2.resultType;
    a2 = new Br(this, a2, b2);
    var d;
    1 === c2 || 2 === c2 ? d = new Sn(a2) : d = new sl(a2);
    return d;
  };
  Fr.prototype.createTileLayer = Fr.prototype.nc;
  function Zr(a2, b2, c2, d) {
    var e;
    a2 = a2 === $r ? "changes" : "file";
    var f2 = b2[a2], g = Cc(f2), h = !g && C(f2, Blob);
    if (!g && !h)
      throw new D(d, 0, "Invalid " + a2 + " parameter");
    if (as)
      h ? e = f2 : e = pf(f2, "text/plain"), d = new x.FormData(), d.append(a2, e, e.name || a2 + ".wkt"), c2.method = "POST", c2.data = d, delete b2[a2];
    else if (h)
      throw new D(d, 0, "Sending Blob data is not supported by the browser");
  }
  var as = x.FormData && !!x.FormData.prototype.append;
  Fr.prototype.request = function(a2, b2, c2, d, e) {
    return bs(this, a2, b2, c2, d, e);
  };
  Fr.prototype.request = Fr.prototype.request;
  function bs(a2, b2, c2, d, e, f2) {
    var g = "text/plain", h = b2 === cs.LAYERS_UPLOAD || b2 === cs.LAYERS_MODIFY || b2 === cs.LAYERS_IMPORT, k = d, l = { data: B, method: "GET", headers: a2.g };
    if (!b2)
      throw new D(a2.request, 0, b2);
    if (!c2)
      throw new D(a2.request, 1, c2);
    cr(a2.request, 3, e, f2);
    h && (C(d, Object, a2.request, 2, "Invalid request parameters"), k = Wa(d), Zr(b2, k, l, a2.request));
    var m = a2.v().clone().G(b2 + "." + c2).I(k);
    c2 === ds.JSON && (g = "application/json");
    a2 = new tf(g, m.toString(), je, l);
    a2.then(function(n) {
      var q = n.issues;
      q && n.error_id && n.response_code ? f2(Error(q[0].message)) : e(n);
    }, function(n) {
      "error" === n.type || 404 === n.status ? f2(Error(n.statusText || "Unable to load data")) : n.json().then(function(q) {
        f2(Error("[" + q.issues[0].message + "] " + m + " request failed"));
      }, function() {
        f2(Error("[" + n.statusText + "] " + m + " request failed"));
      });
    });
    return a2;
  }
  var Gr = "layers/list", $r = "layers/modify", Ir = "tiled/tile", cs = { LAYERS_DELETE: "layers/delete", LAYERS_GRANT: "layers/access/grant", LAYERS_LIST: Gr, LAYERS_MODIFY: $r, LAYERS_UPLOAD: "layers/upload", LAYERS_IMPORT: "layers/import", SEARCH_ALL: "search/all", SEARCH_BBOX: "search/bbox", SEARCH_CORRIDOR: "search/corridor", SEARCH_PROXIMITY: "search/proximity", SEARCH_QUADKEY: "search/quadkey", SEARCH_TILE: Ir };
  Fr.EntryPoint = cs;
  var Hr = "json", ds = { TXT: "txt", JSON: Hr };
  Fr.EntryPointType = ds;
  Fr.prototype.ob = function(a2, b2, c2) {
    var d = this;
    return this.request("search/all", "txt", { filter: 'WKT==""', layer_id: a2 }, function(e) {
      var f2 = String(e).replace(/[\r\n]+$/g, "").split("	");
      d.request(Gr, Hr, { layer_id: a2, detail_level: "all" }, function(g) {
        g = g.layers[0];
        g.columnNames = f2;
        b2(Lr(g));
      }, c2);
    }, c2);
  };
  Fr.prototype.getLayer = Fr.prototype.ob;
  Fr.prototype.Kj = function(a2, b2, c2, d) {
    function e() {
      return ++g < f2 ? h.request("layers/access/grant", Hr, { layer_id: a2, granted_app_id: b2[g].grantedAppId, permissions: b2[g].permissions.join(",") }, e, d) : h.ob(a2, c2, d);
    }
    var f2 = b2 && b2.length, g = -1, h = this;
    return e();
  };
  Fr.prototype.grantAccess = Fr.prototype.Kj;
  Fr.prototype.jj = function(a2, b2, c2) {
    return this.request("layers/delete", Hr, { layer_ids: a2 }, b2, c2);
  };
  Fr.prototype.deleteLayer = Fr.prototype.jj;
  Fr.prototype.$b = function(a2, b2, c2) {
    function d() {
      setTimeout(function() {
        k.ob(g, function(q) {
          setTimeout(e.bind(null, q), m);
        }, function() {
          64e3 > l ? (l += m, d()) : c2(x.Error("Timeout"));
        });
      }, m);
      m *= 2;
    }
    function e(q) {
      var r = JSON.stringify(q.Ta()), v = a2.grants;
      if (r !== JSON.stringify(h)) {
        var w = "Results into different column names on the backend: " + r;
        setTimeout(function() {
          k.jj(g, function() {
            c2(x.Error(w));
          }, function(y) {
            c2(x.Error(w + ". " + y.message));
          });
        }, m);
      } else
        v && v.length ? k.Kj(g, v, b2, c2) : b2(q);
    }
    var f2, g, h, k = this, l = 0, m = 1e3;
    var n = !a2 || !Cr(g = a2.layerId) && (f2 = "layerId") || !Dr(h = a2.columnNames) && (f2 = "columnNames") ? 0 : Da(b2) ? Da(c2) ? -1 : 2 : 1;
    if (0 <= n)
      throw new D(k.$b, n, f2 || arguments[n]);
    return k.ob(g, function() {
      c2(x.Error("Layer exists already"));
    }, function() {
      var q = { layer_id: g, file: h.join("	") }, r = a2.level, v = a2.storage;
      r !== B && (q.level = r);
      v !== B && (q.storage = v);
      k.request("layers/upload", Hr, q, d, c2);
    });
  };
  Fr.prototype.createLayer = Fr.prototype.$b;
  function es(a2, b2, c2, d, e) {
    var f2 = [], g;
    a2 = a2.request(b2, Hr, c2, function(h) {
      h.geometries.length ? (h = Er(h, c2.layer_id), g = new Xr(h, d, e), f2.push(g)) : d(hf, true);
    }, e);
    f2.push(a2);
    return new vr(f2);
  }
  Fr.prototype.Ub = function(a2, b2, c2, d, e, f2) {
    if (!Bc(a2))
      throw new D(this.Ub, 0, "has invalid type");
    C(b2, kg, this.Ub, 1, "has invalid type");
    if (!Fc(c2))
      throw new D(this.Ub, 2, "has invalid type");
    cr(this.Ub, 3, d, e);
    a2 = { layer_ids: a2.join(","), proximity: b2.lat + "," + b2.lng + "," + c2 };
    f2 && Ya(a2, f2);
    return es(this, "search/proximity", a2, d, e);
  };
  Fr.prototype.searchByProximity = Fr.prototype.Ub;
  Fr.prototype.Tb = function(a2, b2, c2, d, e, f2) {
    var g = "";
    if (!Bc(a2))
      throw new D(this.Tb, 0, "has invalid type");
    if (!Cc(b2) && !C(b2, L))
      throw new D(this.Tb, 1, "has invalid type");
    if (!Fc(c2))
      throw new D(this.Tb, 2, "has invalid type");
    cr(this.Tb, 3, d, e);
    a2 = { layer_ids: a2.join(","), radius: c2 };
    if (Cc(b2))
      a2.route_id = b2;
    else {
      var h = b2.$;
      b2 = 0;
      for (c2 = h.length; b2 < c2; b2 += 3)
        g += h[b2] + "," + h[b2 + 1], b2 < c2 - 3 && (g += ",");
      a2.corridor = g;
    }
    f2 && Ya(a2, f2);
    return es(this, "search/corridor", a2, d, e);
  };
  Fr.prototype.searchByCorridor = Fr.prototype.Tb;
  Fr.prototype.Fc = function(a2, b2, c2, d, e) {
    function f2(k, l) {
      l && h--;
      c2(k, !h);
    }
    var g = [], h;
    if (!Bc(a2))
      throw new D(this.Fc, 0, "has invalid type");
    C(b2, K, this.Fc, 1, "has invalid type");
    cr(this.Fc, 2, c2, d);
    b2 = { bbox: b2.c + "," + b2.a + ";" + b2.f + "," + b2.b };
    e && Ya(b2, e);
    a2 = b2.layer_id ? [b2.layer_id] : a2;
    e = 0;
    for (h = a2.length; e < h; e++)
      b2.layer_id = a2[e], g.push(es(this, "search/bbox", b2, f2, d));
    return new vr(g);
  };
  Fr.prototype.searchByBoundingBox = Fr.prototype.Fc;
  Fr.prototype.li = function(a2, b2, c2, d) {
    var e, f2 = [];
    if (!Cc(a2))
      throw new D(this.li, 0, "has invalid type");
    cr(this.li, 1, b2, c2);
    var g = { layer_id: a2 };
    d && Ya(g, d);
    d = this.request("search/all", Hr, g, function(h) {
      h.geometries.length ? (h = Er(h, a2), e = new Xr(h, b2, c2), f2.push(e)) : b2(hf, true);
    }, c2);
    f2.push(d);
    return new vr(f2);
  };
  Fr.prototype.searchAll = Fr.prototype.li;
  var fs = { "delete": /^GEOMETRY_ID$/, append: /^(?!GEOMETRY_ID$)/ };
  function gs(a2, b2, c2, d, e, f2) {
    function g() {
      v++;
      d(this, v === q);
    }
    function h(Q) {
      v++;
      e(Q, this, v === q);
    }
    var k = "append" !== b2, l, m = {}, n = oc(), q = 0, r = [], v = 0;
    if (!Bc(c2))
      throw new D(f2, 0, c2);
    cr(f2, 1, d, e);
    for (l = c2.length; l--; ) {
      var w = c2[l];
      if (C(w, Mr)) {
        var y = w.md().Md().layerId;
        var G = w.ua("GEOMETRY_ID");
        if (k) {
          if (G === z || "" === String(G))
            var I = 'GEOMETRY_ID must not be null or ""';
          m[G = y + "_" + G] && (I = "same GEOMETRY_ID for multiple rows");
          m[G] = w;
        } else
          G !== z && "" !== String(G) && (I = 'GEOMETRY_ID must be null or ""');
      } else
        I = "Invalid type";
      if (I)
        throw new D(
          f2,
          0,
          "- Invalid row at index " + l + ", " + I
        );
      G = n[y];
      G || (G = n[y] = [], q++);
      G.push(w);
    }
    for (y in n) {
      G = n[y];
      c2 = [];
      for (l = G.length; l--; )
        c2.push(G[l].Nh);
      r.push(a2.request($r, Hr, { layer_id: y, action: b2, changes: G[0].md().Gi(fs[b2] || null, c2) }, A(g, G), A(h, G)));
    }
    return new vr(r);
  }
  Fr.prototype.$i = function(a2, b2, c2) {
    return gs(this, "append", a2, b2, c2, this.$i);
  };
  Fr.prototype.appendRows = Fr.prototype.$i;
  Fr.prototype.il = function(a2, b2, c2) {
    return gs(this, "update", a2, b2, c2, this.il);
  };
  Fr.prototype.updateRows = Fr.prototype.il;
  Fr.prototype.kj = function(a2, b2, c2) {
    return gs(this, "delete", a2, b2, c2, this.kj);
  };
  Fr.prototype.deleteRows = Fr.prototype.kj;
  X.prototype.Yl = function(a2) {
    return this.Ma(Fr, a2);
  };
  X.prototype.getCustomLocationService = X.prototype.Yl;
  function hs(a2) {
    jq.j.constructor.call(this, hs, a2);
    zp(hs);
  }
  u(hs, Op);
  t("H.service.extension.customRoute.Service", hs);
  hs.prototype.Aa = function() {
    return { subDomain: "s.fleet.ls", path: "2" };
  };
  hs.CONFIG_KEY = "customRoute";
  hs.prototype.a = function(a2) {
    return Error(a2.issues && a2.issues.length ? a2.issues.map(function(b2) {
      return b2.message;
    }).join(". ") : a2);
  };
  hs.prototype.Cd = function(a2, b2, c2) {
    cr(this.Cd, 1, b2, c2);
    a2 = this.v().clone().G("calculateroute.json").I(a2);
    return this.B(a2, b2, c2);
  };
  hs.prototype.calculateRoute = hs.prototype.Cd;
  X.prototype.Zl = function(a2) {
    return this.Ma(hs, a2);
  };
  X.prototype.getCustomRoutingService = X.prototype.Zl;
  function is(a2, b2, c2) {
    c2 = c2 || {};
    var d = +c2.min, e = +c2.max;
    c2.min = d ? ae(d, 1, 17) : 1;
    c2.max = e ? ae(e, 1, 17) : 17;
    is.j.constructor.call(this, c2);
    C(a2, js, is, 0);
    C(b2, Wh, is, 1);
    this.f = a2;
    b2.a && b2.a("OMV");
    this.Qa(b2, true);
    this.i = xp(this);
  }
  u(is, S);
  t("H.service.trafficVectorTile.Provider", is);
  is.prototype.Sb = ff;
  is.prototype.providesOMV = is.prototype.Sb;
  is.prototype.ub = function(a2) {
    return this.i.test(a2);
  };
  is.prototype.cacheFilter = is.prototype.ub;
  is.prototype.uc = function(a2, b2, c2) {
    return ks(this.f, a2, b2, c2).toString();
  };
  is.prototype.getTileKey = is.prototype.uc;
  is.prototype.nb = function() {
    return this.m;
  };
  is.prototype.getCache = is.prototype.nb;
  is.prototype.MAX_STORE_TIME = 2592e6;
  is.prototype.l = function() {
    return od();
  };
  is.prototype.c = function() {
    return od() ? nd() : is.j.c.call(this);
  };
  is.prototype.s = function() {
    return this.f;
  };
  is.prototype.B = function(a2, b2, c2, d, e) {
    return this.f.Ha(a2, b2, c2, d, e);
  };
  is.prototype.requestInternal = is.prototype.B;
  is.prototype.gb = function(a2) {
    a2.a && a2.a("OMV");
    this.Qa(a2);
  };
  is.prototype.setStyle = is.prototype.gb;
  is.prototype.V = function() {
    return is.j.Ya.apply(this);
  };
  is.prototype.getStyle = is.prototype.V;
  is.prototype.m = new Rk(256);
  is.prototype.ba = function() {
    return null;
  };
  is.prototype.getCopyrights = is.prototype.ba;
  function js(a2) {
    js.j.constructor.call(this, js, a2);
    this.b = (a2 || jf).layer || "traffic";
  }
  u(js, Op);
  t("H.service.trafficVectorTile.Service", js);
  js.prototype.Aa = function() {
    return { subDomain: "traffic.vector", path: "v2" };
  };
  js.CONFIG_KEY = "trafficVectorTile";
  js.prototype.$b = function(a2, b2, c2) {
    b2 = b2 || {};
    var d = { min: 0, max: 22 };
    Ea(c2) && yp(d, c2);
    return new sl(new is(this, a2, b2), d);
  };
  js.prototype.createLayer = js.prototype.$b;
  js.prototype.Ha = function(a2, b2, c2, d, e) {
    return this.B(ks(this, a2, b2, c2), function(f2) {
      return f2.arrayBuffer().then(d, e);
    }, e, "arraybuffer");
  };
  function ks(a2, b2, c2, d) {
    return a2.v().clone().G("traffictiles/" + a2.b + "/mc/" + d + "/" + b2 + "/" + c2 + "/omv");
  }
  js.prototype.f = function(a2) {
    return Ao() + "/" + a2;
  };
  js.prototype.vm = function() {
    return this.b;
  };
  js.prototype.getLayerName = js.prototype.vm;
  X.prototype.oh = function(a2) {
    return this.Ma(js, a2);
  };
  X.prototype.getTrafficVectorTileService = X.prototype.oh;
  function ls(a2) {
    ls.j.constructor.call(this, ls, a2);
  }
  u(ls, Op);
  t("H.service.SearchService", ls);
  ls.CONFIG_KEY = "search";
  ls.prototype.Aa = function() {
    return { subDomain: "search", path: "v1" };
  };
  ls.prototype.a = function(a2) {
    a2 = [a2.title, a2.action, a2.cause].filter(function(b2) {
      return b2;
    });
    return Error(a2.join(". "));
  };
  ls.prototype.Zg = function(a2, b2, c2) {
    a2 = this.v().clone().Ba("geocode").G("geocode").I(a2);
    return this.B(a2, b2, c2);
  };
  ls.prototype.geocode = ls.prototype.Zg;
  ls.prototype.ii = function(a2, b2, c2) {
    a2 = this.v().clone().Ba("revgeocode").G("revgeocode").I(a2);
    return this.B(a2, b2, c2);
  };
  ls.prototype.reverseGeocode = ls.prototype.ii;
  ls.prototype.sl = function(a2, b2, c2) {
    a2 = this.v().clone().Ba("autosuggest").G("autosuggest").I(a2);
    return this.B(a2, b2, c2);
  };
  ls.prototype.autosuggest = ls.prototype.sl;
  ls.prototype.zl = function(a2, b2, c2) {
    a2 = this.v().clone().Ba("discover").G("discover").I(a2);
    return this.B(a2, b2, c2);
  };
  ls.prototype.discover = ls.prototype.zl;
  ls.prototype.Gn = function(a2, b2, c2) {
    a2 = this.v().clone().Ba("lookup").G("lookup").I(a2);
    return this.B(a2, b2, c2);
  };
  ls.prototype.lookup = ls.prototype.Gn;
  ls.prototype.ul = function(a2, b2, c2) {
    a2 = this.v().clone().Ba("browse").G("browse").I(a2);
    return this.B(a2, b2, c2);
  };
  ls.prototype.browse = ls.prototype.ul;
  X.prototype.Wm = function(a2) {
    return this.Ma(ls, a2);
  };
  X.prototype.getSearchService = X.prototype.Wm;
  function ms(a2) {
    this.c = !!a2.toBypassToken;
    if (!this.c && !a2.token)
      throw new D(ms, 0, '"token" must be specified');
    zp(ms, "Use HERE IML service instead.");
    ms.j.constructor.call(this, ms, a2);
    this.l = a2.token;
    this.f = {};
    this.b = {};
  }
  u(ms, Op);
  t("H.service.xyz.Service", ms);
  ms.prototype.Aa = function() {
    return { host: "xyz.api.here.com", path: "hub/spaces" };
  };
  ms.prototype.a = function(a2) {
    return Error(a2.errorMessage || a2.message);
  };
  ms.prototype.jh = function(a2, b2, c2) {
    zc(a2, "String", this.jh, 0, '"projectId" must be a string');
    ns(this.jh, 1, b2, c2);
    a2 = os(this.v().clone().wd("project-api/projects/" + a2));
    return this.B(a2, b2, c2);
  };
  ms.prototype.getProject = ms.prototype.jh;
  ms.prototype.Gj = function(a2, b2, c2) {
    ns(this.Gj, 0, a2, b2);
    c2 = ps(this, this.v().clone().I(c2 || {}));
    return this.B(c2, a2, b2);
  };
  ms.prototype.getSpaces = ms.prototype.Gj;
  ms.prototype.Kf = function(a2, b2, c2) {
    zc(a2, "String", this.Kf, 0, '"spaceId" must be a string');
    ns(this.Kf, 1, b2, c2);
    a2 = ps(this, this.v().clone().G(a2));
    return this.B(a2, b2, c2);
  };
  ms.prototype.getSpace = ms.prototype.Kf;
  ms.prototype.Qd = function(a2, b2, c2) {
    zc(a2, "String", this.Qd, 0, '"spaceId" must be a string');
    ns(this.Qd, 1, b2, c2);
    a2 = ps(this, this.v().clone().G(a2 + "/statistics"));
    return this.B(a2, b2, c2);
  };
  ms.prototype.getStatistics = ms.prototype.Qd;
  ms.prototype.Ff = function(a2, b2, c2, d, e, f2, g) {
    a2 = ps(this, this.v().clone().G(d + "/tile/web/" + c2 + "_" + a2 + "_" + b2 + ".mvtf").I(Object.assign({ clip: true }, g)));
    return this.B(a2, function(h) {
      return h.arrayBuffer().then(e);
    }, f2, "arraybuffer");
  };
  ms.prototype.search = function(a2, b2, c2, d) {
    zc(a2, "String", this.search, 0, '"spaceId" must be a string');
    ns(this.search, 1, b2, c2);
    a2 = ps(this, this.v().clone().G(a2 + "/search").I(d || {}));
    return this.B(a2, b2, c2);
  };
  ms.prototype.search = ms.prototype.search;
  ms.prototype.Sc = function(a2, b2, c2, d) {
    zc(a2, "String", this.Sc, 0, '"spaceId" must be a string');
    if (!Ea(b2))
      throw new D(this.Sc, 1, '"params" must be an object');
    ns(this.Sc, 2, c2, d);
    a2 = ps(this, this.v().clone().G(a2 + "/features").I(b2));
    return this.B(a2, c2, d);
  };
  ms.prototype.getFeaturesById = ms.prototype.Sc;
  ms.prototype.Jd = function(a2, b2, c2, d) {
    zc(a2, "String", this.Jd, 0, '"spaceId" must be a string');
    if (!Ea(b2))
      throw new D(this.Sc, 1, '"params" must be an object');
    ns(this.Jd, 2, c2, d);
    a2 = ps(this, this.v().clone().G(a2 + "/bbox").I(b2));
    return this.B(a2, c2, d);
  };
  ms.prototype.getFeaturesByBoundingBox = ms.prototype.Jd;
  ms.prototype.ba = function(a2) {
    var b2 = this.f[a2];
    if (b2)
      return b2;
    this.b[a2] || qs(this, a2);
    return null;
  };
  ms.prototype.$c = function(a2, b2, c2, d, e) {
    zc(a2, "String", this.$c, 0, '"spaceId" must be a string');
    if (!Ea(b2))
      throw new D(this.$c, 1, '"geojsonObject" must be an object');
    ns(this.$c, 2, c2, d);
    if (e && !Ea(e))
      throw new D(this.$c, 4, '"opt_params" must be an object');
    return rs(this, a2, c2, d, "PUT", b2, e);
  };
  ms.prototype.putFeatures = ms.prototype.$c;
  ms.prototype.Yc = function(a2, b2, c2, d, e) {
    zc(a2, "String", this.Yc, 0, '"spaceId" must be a string');
    if (!Ea(b2))
      throw new D(this.Yc, 1, '"featureCollection" must be an object');
    ns(this.Yc, 2, c2, d);
    if (e && !Ea(e))
      throw new D(this.Yc, 4, '"opt_params" must be an object');
    return rs(this, a2, c2, d, "POST", b2, e);
  };
  ms.prototype.postFeatures = ms.prototype.Yc;
  ms.prototype.hd = function(a2, b2, c2, d) {
    zc(a2, "String", this.hd, 0, '"spaceId" must be a string');
    if (!Ea(b2))
      throw new D(this.hd, 1, '"params" must be an object');
    ns(this.hd, 2, c2, d);
    return rs(this, a2, c2, d, "DELETE", B, b2);
  };
  ms.prototype.deleteFeatures = ms.prototype.hd;
  function rs(a2, b2, c2, d, e, f2, g) {
    var h = Object.assign(a2.c ? {} : { authorization: "Bearer " + a2.l }, { "Content-Type": "application/geo+json" }, a2.g);
    e = { method: e, headers: h };
    f2 && (e.data = JSON.stringify(f2));
    b2 = os(a2.v().clone().G(b2 + "/features").I(g || {}));
    f2 = new tf("application/json", b2.toString(), je, e);
    f2.then(c2, Qp(a2, b2, d));
    return f2;
  }
  function qs(a2, b2) {
    a2.b[b2] = ss;
    a2.Kf(b2, function(c2) {
      a2.b[b2] = ts;
      a2.f[b2] = c2.copyright;
      a2.dispatchEvent("copyrightupdate");
    }, function(c2) {
      a2.b[b2] = us;
      throw c2;
    });
  }
  function ps(a2, b2) {
    return a2.c ? b2 : os(b2).I({ access_token: a2.l });
  }
  function os(a2) {
    var b2 = Object.assign({}, a2.getQuery());
    delete b2.apikey;
    return a2.bf(b2);
  }
  ms.CONFIG_KEY = "xyz";
  var ss = 1, ts = 2, us = -1;
  function ns(a2, b2, c2, d) {
    if (!Da(c2))
      throw new D(a2, b2, '"onResult" must be a function');
    if (!Da(d))
      throw new D(a2, b2 + 1, '"onError" must be a function');
  }
  X.prototype.jn = function(a2) {
    return this.Ma(ms, a2);
  };
  X.prototype.getXYZService = X.prototype.jn;
  function vs(a2, b2, c2) {
    var d;
    vs.j.constructor.call(this, c2 ? { min: c2.min, max: c2.max, engineType: c2.engineType } : void 0);
    C(a2, ms, vs, 0);
    if (!Cc(b2))
      throw new D(vs, 1, '"spaceId" must be a string');
    this.m = a2;
    this.f = b2;
    this.i = {};
    if (c2 && (["limit", "simplificationLevel", "tags"].forEach(function(e) {
      e in c2 && (this.i[e] = c2[e]);
    }, this), a2 = c2.parameters))
      for (d in a2)
        this.i[d] = a2[d];
    this.Qa(this.b === kk.WEBGL ? new ti({ sources: { xyz: { type: "MVT" } }, layers: { xyz: { data: { source: "xyz", layer: this.f }, points: { filter: { $geometry: "point" }, draw: { points: {
      collide: false,
      order: 200,
      color: "#92CF48",
      size: [[10, "8px"], [14, "12px"], [18, "16px"]]
    } } }, polygons: { filter: { $geometry: "polygon" }, draw: { polygons: { order: 201, color: "#E39E3C" }, lines: { order: 202, color: "#755DA5", width: "1px" } } }, lines: { filter: { $geometry: "line" }, draw: { lines: { order: 203, color: "#000000", width: "2px", join: "round", cap: "round" } } } } } }) : new H.map.render.harp.Style({ styles: [{ layer: this.f, when: ["==", ["geometry-type"], "Point"], technique: "circles", renderOrder: 200, color: "#92CF48", size: [
      "interpolate",
      ["linear"],
      ["zoom"],
      10,
      8,
      14,
      12,
      18,
      16
    ] }, { layer: this.f, when: ["==", ["geometry-type"], "Polygon"], technique: "fill", color: "#E39E3C", renderOrder: 201 }, { layer: this.f, when: ["==", ["geometry-type"], "Polygon"], technique: "solid-line", color: "#755DA5", lineWidth: "1px", renderOrder: 202 }, { layer: this.f, when: ["==", ["geometry-type"], "LineString"], technique: "solid-line", color: "#000000", lineWidth: "2px", renderOrder: 203 }] }));
  }
  u(vs, S);
  t("H.service.xyz.Provider", vs);
  vs.prototype.B = function(a2, b2, c2, d, e) {
    return this.m.Ff(a2, b2, c2, this.f, d, e, this.i);
  };
  vs.prototype.requestInternal = vs.prototype.B;
  vs.prototype.ba = function() {
    return this.m.ba(this.f);
  };
  vs.prototype.getCopyrights = vs.prototype.ba;
  vs.prototype.Sb = ff;
  vs.prototype.providesOMV = vs.prototype.Sb;
  vs.prototype.V = function() {
    return this.Ya();
  };
  vs.prototype.getStyle = vs.prototype.V;
  vs.prototype.gb = function(a2) {
    C(a2, ti) && a2.a("MVT");
    this.Qa(a2);
  };
  vs.prototype.setStyle = vs.prototype.gb;
  t("H.service.buildInfo", function() {
    return Hf("H-service", "1.49.1", "74e5afb", { region: "row" });
  });
  function ws(a2, b2, c2, d, e) {
    e & 1 && xs(a2, a2, b2, c2, d, 0);
    e & 2 && xs(a2, a2, b2, c2, d, 1);
    e & 4 && xs(a2, a2, b2, c2, d, 2);
    e & 8 && xs(a2, a2, b2, c2, d, 3);
  }
  function xs(a2, b2, c2, d, e, f2) {
    var g = (c2 + 1) * (c2 + 1), h, k = 4 * d, l = c2 + 1, m, n = [{ r: 0, Hl: 0, tl: 0, Fg: 0, next: null }];
    var q = 1;
    var r = ["r", "g", "b", "a"][f2];
    var v = 2 * c2 + 1;
    for (var w, y; q < v; q++)
      n[q] = { r: 0, Hl: 0, tl: 0, Fg: 0, next: null }, n[q - 1].next = n[q];
    n[2 * c2].next = n[0];
    var G = 4 * (d - 1);
    for (h = 0; h < e; h++) {
      var I = h * k;
      var Q = a2[I + f2];
      var V = Q * l * (c2 + 2) / 2;
      v = Q * l;
      for (q = 0; q <= c2; q++)
        n[q][r] = Q;
      var Ba = 0;
      for (q = 1; q <= c2; q++) {
        var ha = q < d ? I + 4 * q : I + G;
        ha = a2[ha + f2];
        V += ha * (l - q);
        Ba += ha;
        n[c2 + q][r] = ha;
      }
      ha = n[0];
      w = n[l];
      q = I;
      y = 4 * l;
      var rb = I + G;
      for (Q = 0; Q < d; Q++) {
        b2[q + f2] = V / g;
        V -= v;
        var Fa = Q + l < d ? q + y : rb;
        Fa = a2[Fa + f2];
        Ba += Fa;
        V += Ba;
        v -= ha[r];
        v += w[r];
        Ba -= w[r];
        ha[r] = Fa;
        ha = ha.next;
        w = w.next;
        q += 4;
        if (!V)
          for (; (m = 4 * (Q + l)) < k && 0 === a2[I + f2 + m]; )
            Q++, q += 4;
      }
    }
    I = (e - 1) * k;
    for (Q = 0; Q < d; Q++) {
      a2 = 4 * Q;
      h = b2[a2 + f2];
      V = h * l * (c2 + 2) / 2;
      v = h * l;
      for (q = 0; q <= c2; q++)
        n[q][r] = h;
      Ba = 0;
      for (q = 1; q <= c2; q++)
        ha = q < e ? a2 + q * k : a2 + I, ha = b2[ha + f2], V += ha * (c2 - q + 1), Ba += ha, n[c2 + q][r] = ha;
      ha = n[0];
      w = n[l];
      q = a2;
      rb = l * k;
      G = a2 + I;
      for (h = 0; h < e; h++)
        if (b2[q + f2] = V / g, V -= v, Fa = h + l < e ? q + rb : G, Fa = b2[Fa + f2], Ba += Fa, V += Ba, v -= ha[r], v += w[r], Ba -= w[r], ha[r] = Fa, ha = ha.next, w = w.next, q += k, !V)
          for (; (m = h + l) < e && 0 === b2[m * k + f2 + a2]; )
            h++, q += k;
    }
  }
  ;
  function ys(a2, b2, c2) {
    this.f = b2 = a2 >> b2;
    this.l = Math.log(b2) * Math.LOG2E;
    this.i = a2 = document.createElement("CANVAS");
    this.a = a2.getContext("2d");
    this.b = a2.width = a2.height = 3 * b2;
    var d = document.createElement("canvas");
    a2 = c2.a;
    var e = c2.b;
    b2 = [];
    var f2;
    d.width = 256;
    d.height = 1;
    d = d.getContext("2d");
    for (g in e)
      e.hasOwnProperty(g) && b2.push({ stop: parseFloat(g), value: e[g] });
    e = b2.length;
    b2.sort(this.s);
    0 < b2[0].stop && b2.unshift({ stop: 0, value: b2[0].value });
    1 > b2[e - 1].stop && b2.push({ stop: 1, value: b2[e - 1].value });
    e = b2.length;
    var g = d.createLinearGradient(
      0,
      0,
      256,
      0
    );
    for (f2 = 0; f2 < e; f2++) {
      if (!a2 && k) {
        var h = k.stop + (b2[f2].stop - k.stop) / 2;
        g.addColorStop(h, k.value);
        g.addColorStop(h, b2[f2].value);
      }
      g.addColorStop(b2[f2].stop, b2[f2].value);
      var k = b2[f2];
    }
    d.fillStyle = g;
    d.fillRect(0, 0, 256, 1);
    this.c = d.getImageData(0, 0, 256, 1).data;
    this.g = c2.a;
  }
  ys.prototype.s = function(a2, b2) {
    return a2.stop - b2.stop;
  };
  function zs(a2, b2) {
    this.a = a2;
    this.size = b2;
  }
  ;
  function As(a2, b2) {
    var c2, d = 0;
    if (!Ea(a2) || Va(a2))
      throw new D(As, 0, a2);
    for (c2 in a2) {
      var e = +c2;
      d++;
      if (!(Fc(e) && 0 <= e && 1 >= e && Cc(a2[c2])))
        throw new D(As, 0, a2);
    }
    if (2 > d)
      throw new D(As, 0, "Specify at least 2 stops");
    this.b = a2;
    this.a = !!b2;
  }
  t("H.data.heatmap.Colors", As);
  var Bs = new As({ 0: "#008", "0.2": "#0b0", "0.5": "#ff0", "0.7": "#f00" }, true);
  As.DEFAULT = Bs;
  function Cs(a2, b2, c2) {
    this.a = a2 = ae(a2, 0, 30);
    this.u = b2;
    this.i = c2;
    this.s = [];
    this.b = [];
    do
      this.b[a2] = [], this.s[a2] = new Ds();
    while (a2--);
    b2 === Es ? (this.m = Fs, this.l = Gs) : (this.m = Hs, this.l = Is);
    this.c = 1 / 0;
    this.f = -1 / 0;
  }
  var Js = Math.log(0.5);
  function Gs(a2) {
    return this.g ? Math.round((a2 - this.c) / this.g * 255) : 127;
  }
  function Is(a2) {
    return void 0 === this.U ? 127 : Math.round(255 * Math.pow(a2, this.U));
  }
  Cs.prototype.Db = function(a2) {
    var b2, c2;
    var d = a2.value;
    void 0 === d && (d = 1);
    d > this.f && (this.f = d, this.g = this.f - this.c);
    d < this.c && (this.c = d, this.g = this.f - this.c);
    var e = mj.Pc(a2).scale(1073741823).floor();
    d = this.a;
    var f2 = e.x >> 30 - d;
    e = e.y >> 30 - d;
    for (c2 = this.m; -1 < d; ) {
      this.b[d][e] || (this.b[d][e] = []);
      (b2 = this.b[d][e][f2]) || (b2 = this.b[d][e][f2] = new c2(f2, e, d));
      b2.Db(a2, d);
      var g = this.s[d];
      g.f > b2.b && (g.f = b2.b);
      g.a < b2.b && (g.a = b2.b);
      g.c > b2.a && (g.c = b2.a);
      g.b < b2.a && (g.b = b2.a);
      d--;
      f2 >>= 1;
      e >>= 1;
    }
  };
  function Ks(a2, b2, c2, d, e) {
    var f2 = 1 << b2, g, h;
    d = $d(d, f2);
    f2 = 0 <= c2 && c2 < f2 && (g = a2.b[b2]) && (h = g[c2]) && (f2 = h[d]) || null;
    !f2 && e && 0 <= b2 && (f2 = Ks(a2, b2 - 1, c2 >> 1, d >> 1, e));
    return f2;
  }
  function Ls(a2, b2, c2, d, e, f2) {
    for (var g, h = []; c2 <= d; c2++)
      for (g = e; g <= f2; g++)
        h.push(Ks(a2, b2, c2, g, false));
    return h;
  }
  function Ms(a2, b2) {
    var c2 = 0, d = 0, e = Ks(a2, 0, 0, 0, false), f2;
    if (b2.f)
      return b2.c;
    b2.z === a2.a ? b2.c = b2.a : (Ns(a2, b2, function(g) {
      var h = Os(a2, g), k = 4 - h.length;
      if (g.z !== a2.a) {
        for (f2 = 0; f2 < h.length; f2++)
          c2 += h[f2].a, d++;
        c2 += k * e.a;
        d += k;
      }
    }), b2.c = c2 / d);
    b2.f = true;
    return b2.c;
  }
  function Ns(a2, b2, c2) {
    b2 = [b2];
    for (var d, e; 0 < b2.length; )
      e = b2.shift(), d = Os(a2, e), c2(e), b2.push.apply(b2, d);
  }
  function Os(a2, b2) {
    var c2 = [], d, e, f2;
    for (e = 0; 1 >= e; e++)
      for (f2 = 0; 1 >= f2; f2++)
        (d = Ks(a2, b2.z + 1, 2 * b2.x + e, 2 * b2.y + f2, false)) && c2.push(d);
    return c2;
  }
  Cs.prototype.clear = function() {
    Cs.call(this, this.a, this.u, this.i);
  };
  function Hs(a2, b2, c2) {
    this.x = a2;
    this.y = b2;
    this.z = c2;
    this.a = this.b = this.g = 0;
    this.f = false;
    this.c = 0;
  }
  Hs.prototype.Db = function(a2, b2) {
    this.g++;
    this.b += a2.value || 1;
    this.a = this.b / Math.pow(2, 2 * (30 - b2));
  };
  function Fs(a2, b2, c2) {
    this.x = a2;
    this.y = b2;
    this.z = c2;
    this.a = this.b = this.g = 0;
    this.f = false;
    this.c = 0;
  }
  Fs.prototype.Db = function(a2) {
    a2 = a2.value;
    this.b += void 0 !== a2 ? a2 : 1;
    this.a = this.b / ++this.g;
    this.f = false;
  };
  function Ds() {
    this.f = this.c = 1 / 0;
    this.a = this.b = -1 / 0;
  }
  ;
  function Ps(a2) {
    var b2 = a2 || {}, c2 = +b2.sampleDepth, d = b2.pointSize;
    a2 = +b2.coarseness;
    var e = b2.colors, f2 = { min: b2.min, max: b2.max, engineType: b2.engineType }, g = b2.tileSize, h = +b2.dataMax;
    b2.tileSize && (f2.tileSize = g);
    S.call(this, f2);
    lk(this, b2.opacity);
    this.i = "value" === b2.type ? Es : Qs;
    this.sampleDepth_ = Fc(c2) ? ae(Math.round(c2), 1, 8) : 4;
    this.L = this.i === Qs ? Fc(d) ? ae(Math.round(7 - d), 0, 6) : 2 : 1;
    this.D = !!b2.assumeValues;
    b2 = this.max;
    this.T = Fc(h) ? ae(Math.round(h), this.min, b2 + this.sampleDepth_) : b2;
    a2 = Fc(a2) ? ae(Math.round(a2), 0, 3) : 1;
    if (e && !C(e, As))
      throw new D(
        Ps,
        0,
        "colors"
      );
    this.f = new Cs(b2 + this.sampleDepth_ + this.L, this.i, this.T);
    this.aa = new ys(this.tileSize, a2, e || Bs);
    this.u = A(this.u, this);
    this.m = A(this.m, this);
    this.R = new Mk(20, this.u);
  }
  u(Ps, S);
  t("H.data.heatmap.Provider", Ps);
  Ps.prototype.ic = function(a2) {
    lk(this, a2);
  };
  Ps.prototype.setOpacity = Ps.prototype.ic;
  Ps.prototype.Tc = function() {
    return this.g;
  };
  Ps.prototype.getOpacity = Ps.prototype.Tc;
  Ps.prototype.Ve = ff;
  Ps.prototype.providesRasters = Ps.prototype.Ve;
  Ps.prototype.B = function(a2, b2, c2, d, e) {
    var f2 = this.D, g, h;
    if (Ks(this.f, 0, 0, 0, false)) {
      if (!f2) {
        var k = Ls(this.f, c2, b2 - 1, b2 + 1, a2 - 1, a2 + 1);
        for (g = k.length; g-- && !f2; )
          if (null !== k[g]) {
            f2 = true;
            break;
          }
      }
      f2 && (h = this.R.push([a2, b2, c2, d, e], this.m));
    }
    f2 || d(null);
    return h || Hl;
  };
  Ps.prototype.requestInternal = Ps.prototype.B;
  function Rs(a2, b2, c2, d) {
    var e = document.createElement("canvas"), f2 = a2.tileSize, g = e.getContext("2d");
    e.width = e.height = f2;
    var h = a2.aa;
    var k = a2.f, l = a2.D, m = a2.i, n = a2.L;
    var q = h.f;
    var r = h.a, v, w, y = m === Qs ? void 0 === n ? 2 : n : 1;
    n = y;
    a2 = Math.min(a2.sampleDepth_ + y, h.l);
    y = h.b;
    var G = k.a;
    if (l && m === Es) {
      for (w = -1; 1 >= w; w++)
        for (l = -1; 1 >= l; l++) {
          var I = (I = Ks(k, d, c2 + w, b2 + l, true)) ? k.l(Ms(k, I)) : 128;
          r.fillStyle = "rgba(" + I + ",128,0,1)";
          r.fillRect((l + 1) * q, (w + 1) * q, q, q);
        }
      l = q - Math.floor(q / 10);
      w = 3;
      I = r.getImageData(0, 0, y, y);
      ws(I.data, l, y, y, w);
      r.putImageData(
        I,
        0,
        0
      );
    } else
      r.fillStyle = l ? "#080" : "#000", r.fillRect(0, 0, y, y);
    for (; n <= a2 && d + n <= G; n++) {
      l = q >> n;
      w = q - l;
      var Q = m === Qs ? 127 + Math.floor(128 / (1 << a2 - n)) : 255;
      I = (1 << n) + 2;
      var V = 1 << n;
      var Ba = b2 << n;
      var ha = c2 << n;
      V = Ls(k, d + n, ha - 1, ha + V, Ba - 1, Ba + V);
      for (Ba = V.length; Ba--; ) {
        ha = Ba % I;
        var rb = Ba / I << 0;
        if (v = V[Ba])
          v = k.l(v.a), r.fillStyle = "rgba(" + v + "," + Q + ",0,1)", r.fillRect(ha * l + w, rb * l + w, l, l);
      }
      I = r;
      Q = l;
      V = w;
      Ba = q + 2 * l;
      l = q + 2 * l;
      ha = ha = 3;
      rb = r.getImageData(V, w, Ba, l);
      ws(rb.data, Q, Ba, l, ha);
      I.putImageData(rb, V, w);
    }
    b2 = r.getImageData(0, 0, y, y);
    c2 = h.c;
    d = h.g;
    k = b2.data;
    a2 = 0;
    for (y = k.length; a2 < y; a2 += 4)
      m = k[a2], n = k[a2 + 1], 4 === c2.length && (m = 0), k[a2] = c2[4 * m], k[a2 + 1] = c2[4 * m + 1], k[a2 + 2] = c2[4 * m + 2], k[a2 + 3] = c2[4 * m + 3] * (d ? n / 255 : 10 > n ? 0 : 1);
    r.putImageData(b2, 0, 0);
    h = new zs(h.i, q);
    q = h.size;
    g.drawImage(h.a, q, q, q, q, 0, 0, f2, f2);
    return e;
  }
  Ps.prototype.u = function(a2, b2) {
    a2.done(Rs(this, b2[0], b2[1], b2[2]));
  };
  Ps.prototype.m = function(a2, b2, c2) {
    var d = a2.data;
    a2 = d[3];
    d = d[4];
    c2 ? d() : a2(b2);
  };
  Ps.prototype.Zi = function(a2, b2) {
    var c2;
    if (!Bc(a2))
      throw new D(this.Zi, 0, a2);
    if (c2 = a2.length) {
      for (; c2--; )
        this.f.Db(a2[c2]);
      a2 = this.f;
      var d;
      c2 = a2.s;
      var e = a2.a, f2 = 0;
      if (a2.u === Qs) {
        var g = c2[a2.a].a;
        for (d = a2.a; 0 <= d; d--)
          if (c2[d].a === g)
            f2 = d;
          else
            break;
        g = c2[0].a;
        for (d = 0; d <= f2; d++)
          if (g === c2[d].a)
            e = d;
          else
            break;
        f2 > a2.i && (f2 = a2.i);
        g = Math.round(e + (f2 - e) / 2);
        a2.U = Js / Math.log(c2[g].b);
      }
      this.reload(!!b2);
    }
  };
  Ps.prototype.addData = Ps.prototype.Zi;
  Ps.prototype.clear = function() {
    this.f.clear();
    this.reload(true);
  };
  Ps.prototype.clear = Ps.prototype.clear;
  var Qs = 0, Es = 1;
  function Ss() {
  }
  t("H.data.utils.Dom", Ss);
  Ss.prototype.Hd = function(a2) {
    return !!a2 && /^\s*(1|true)\s*$/i.test(this.Na(a2));
  };
  Ss.prototype.getBoolean = Ss.prototype.Hd;
  Ss.prototype.Na = function(a2) {
    var b2;
    try {
      if (a2.nodeType === Node.ATTRIBUTE_NODE)
        return a2.value;
      var c2 = "";
      var d = 0;
      var e = a2.childNodes;
      for (b2 = e.length; d < b2; d++)
        e[d].nodeType !== Node.COMMENT_NODE && (c2 += e[d].nodeValue.replace(/^\s+|\s+$/g, ""));
    } catch (f2) {
    }
    return c2 || "";
  };
  Ss.prototype.getString = Ss.prototype.Na;
  Ss.prototype.Gf = function(a2) {
    return parseFloat(this.Na(a2)) || 0;
  };
  Ss.prototype.getFloat = Ss.prototype.Gf;
  Ss.prototype.vk = function(a2) {
    var b2 = a2.split(/\s+/), c2 = b2.length, d = !(b2 && 1 == c2), e = d ? 1 : 3, f2 = [], g;
    d || (b2 = a2.split(","), c2 = b2.length);
    for (g = 0; g < c2; g += e)
      if (a2 = this.$h(d ? b2[g] : g + 3 > b2.length ? null : b2.slice(g, g + 3)))
        f2.push(a2);
      else
        return [];
    return f2;
  };
  Ss.prototype.parseCoords = Ss.prototype.vk;
  Ss.prototype.$h = function(a2) {
    if (!a2)
      return null;
    var b2 = a2 instanceof Array && 0 < a2.length && 4 > a2.length ? a2 : a2.split(",");
    a2 = parseFloat(b2[0]);
    var c2 = parseFloat(b2[1]);
    b2 = parseFloat(b2[2]);
    return isNaN(c2) || isNaN(a2) ? null : new kg(c2, a2, isNaN(b2) ? void 0 : b2);
  };
  Ss.prototype.parseCoord = Ss.prototype.$h;
  Ss.prototype.Ef = function(a2) {
    a2 = this.Na(a2);
    return /^[0-9a-fA-F]{8}$/.test(a2) ? "#" + a2.substr(6, 2) + a2.substr(4, 2) + a2.substr(2, 2) + a2.substr(0, 2) : "#000000ff";
  };
  Ss.prototype.getColor = Ss.prototype.Ef;
  function Ts(a2) {
    a2 = a2.attributes;
    for (var b2, c2 = a2.length; c2--; )
      switch (b2 = a2[c2], b2.name) {
        case "x":
          this.x = parseFloat(b2.value);
          break;
        case "y":
          this.y = parseFloat(b2.value);
          break;
        case "xunits":
          this.Vc = "fraction" === Ss.prototype.Na(b2);
          break;
        case "yunits":
          this.zc = "fraction" === Ss.prototype.Na(b2);
      }
  }
  t("H.data.kml.HotSpot", Ts);
  function Us(a2) {
    var b2 = a2.childNodes, c2 = new Ss();
    for (a2 = b2.length; a2--; ) {
      var d = b2[a2];
      switch (d.nodeName) {
        case "href":
          this.href = c2.Na(d);
      }
    }
  }
  t("H.data.kml.Icon", Us);
  function Vs(a2) {
    var b2;
    if (a2) {
      a2 = a2.childNodes;
      var c2 = a2.length;
      for (b2 = new Ss(); c2--; ) {
        var d = a2[c2];
        switch (d.nodeName) {
          case "scale":
            this.scale = b2.Gf(d);
            break;
          case "Icon":
            this.icon = d = new Us(d);
            break;
          case "hotSpot":
            this.a = d = new Ts(d);
        }
      }
    }
  }
  t("H.data.kml.IconStyle", Vs);
  function Ws() {
    this.a = { 4: function(a2) {
      return ["#", a2.charAt(1), a2.charAt(1), a2.charAt(2), a2.charAt(2), a2.charAt(3), a2.charAt(3), "ff"].join("");
    }, 5: function(a2) {
      return ["#", a2.charAt(1), a2.charAt(1), a2.charAt(2), a2.charAt(2), a2.charAt(3), a2.charAt(3), a2.charAt(4), a2.charAt(4)].join("");
    }, 7: function(a2) {
      return a2 + "ff";
    }, 9: function(a2) {
      return a2;
    } };
    this.b = { 4: function(a2) {
      return [Xs(a2.charAt(1)), Xs(a2.charAt(2)), Xs(a2.charAt(3)), 255];
    }, 5: function(a2) {
      return [Xs(a2.charAt(1)), Xs(a2.charAt(2)), Xs(a2.charAt(3)), Xs(a2.charAt(4))];
    }, 7: function(a2) {
      a2 = parseInt(a2.substring(1), 16);
      return [a2 >> 16 & 255, a2 >> 8 & 255, a2 & 255, 255];
    }, 9: function(a2) {
      a2 = parseInt(a2.substring(1), 16);
      return [a2 >> 24 & 255, a2 >> 16 & 255, a2 >> 8 & 255, a2 & 255];
    } };
  }
  t("H.data.utils.ColorHelper", Ws);
  function Xs(a2) {
    a2 = parseInt(a2, 16);
    return (a2 << 4) + a2;
  }
  function Ys(a2) {
    return 16 > a2 ? "0" + Math.round(a2).toString(16) : Math.round(a2).toString(16);
  }
  function Zs(a2, b2, c2) {
    if (!/^(#|rgb).*/.test(b2))
      return [0, 0, 0, 255];
    c2 || (c2 = "", "#" === b2.charAt(0) ? c2 = a2.a[b2.length] ? b2 : "" : "rgb" === b2.substr(0, 3) && (b2 = b2.match(/\d+(\.\d+)?/g), c2 = b2.length, c2 = 2 < c2 && 5 > c2 ? ["#", Ys(+b2[0]), Ys(+b2[1]), Ys(+b2[2]), 3 < c2 ? Ys(255 * +b2[3]) : "ff"].join("") : ""), b2 = c2);
    a2 = a2.b[b2.length](b2);
    a2[3] = Math.round(a2[3] / 255 * 100) / 100;
    return a2;
  }
  Ws.prototype.el = function(a2, b2) {
    var c2 = "";
    if (!/^(#|rgb).*/.test(a2)) {
      c2 = "";
      var d;
      for (d = 0; 6 > d; d++)
        c2 += "ABCDEF0123456789".charAt(Math.floor(16 * Math.random()));
      return c2 + "ff";
    }
    a2 = Zs(this, a2, b2);
    for (b2 = 0; 4 > b2; b2++)
      3 > b2 ? d = Math.floor(Math.random() * (a2[b2] + 1)) : d = 255 * a2[b2], c2 += Ys(d);
    return c2;
  };
  Ws.prototype.toRandomRGBA = Ws.prototype.el;
  function $s(a2) {
    a2 = a2.childNodes;
    for (var b2, c2 = a2.length, d = new Ss(), e = new Ws(); c2--; )
      switch (b2 = a2[c2], b2.nodeName) {
        case "color":
          this.a = d.Ef(b2);
          break;
        case "colorMode":
          this.b = d.Na(b2);
      }
    "random" === this.b && (this.a = "#" + e.el(this.a, false));
  }
  t("H.data.kml.ColorStyle", $s);
  function at(a2) {
    var b2 = a2.childNodes, c2 = b2.length, d = new Ss();
    this.a = this.fill = true;
    for (this.b = new $s(a2); c2--; )
      switch (a2 = b2[c2], a2.nodeName) {
        case "fill":
          this.fill = d.Hd(a2);
          break;
        case "outline":
          this.a = d.Hd(a2);
      }
  }
  t("H.data.kml.PolyStyle", at);
  function bt(a2) {
    var b2 = a2.childNodes, c2 = b2.length, d = new Ss();
    for (this.a = new $s(a2); c2--; )
      a2 = b2[c2], "width" === a2.nodeName && (this.width = d.Gf(a2));
  }
  t("H.data.kml.LineStyle", bt);
  function ct(a2) {
    a2 = a2.childNodes;
    for (var b2, c2 = a2.length, d = new Ss(); c2--; )
      switch (b2 = a2[c2], b2.nodeName) {
        case "bgColor":
          this.bgColor = d.Ef(b2);
          break;
        case "textColor":
          this.textColor = d.Ef(b2);
          break;
        case "text":
          this.text = d.Na(b2);
          break;
        case "displayMode":
          this.displayMode = d.Na(b2);
      }
  }
  t("H.data.kml.BalloonStyle", ct);
  function dt(a2) {
    var b2 = a2.childNodes, c2 = b2.length;
    for (this.id = a2.getAttribute("id"); c2--; )
      switch (a2 = b2[c2], a2.nodeName) {
        case "IconStyle":
          this.Oj = a2 = new Vs(a2);
          break;
        case "LineStyle":
          this.Wd = a2 = new bt(a2);
          break;
        case "PolyStyle":
          this.yk = a2 = new at(a2);
          break;
        case "BalloonStyle":
          this.pf = a2 = new ct(a2);
      }
  }
  t("H.data.kml.Style", dt);
  function et(a2, b2) {
    a2 = a2.childNodes;
    var c2 = a2.length, d = new Ss();
    for (this.b = b2; c2--; )
      switch (b2 = a2[c2], b2.nodeName) {
        case "key":
          this.key = d.Na(b2);
          break;
        case "styleUrl":
          this.a = d.Na(b2);
      }
  }
  t("H.data.kml.Pair", et);
  et.prototype.V = function() {
    if (this.a) {
      var a2 = "highlight" === this.key ? true : false;
      a2 = this.b.mh(this.a.substr(1), a2);
    }
    return a2;
  };
  et.prototype.getStyle = et.prototype.V;
  function ft(a2, b2) {
    var c2 = a2.childNodes, d = c2.length;
    this.b = b2;
    this.id = a2.getAttribute("id");
    for (this.a = []; d--; )
      a2 = c2[d], "Pair" === a2.nodeName && (a2 = new et(a2, this.b), this.a.push(a2));
  }
  t("H.data.kml.StyleMap", ft);
  ft.prototype.V = function(a2) {
    var b2 = null;
    a2 = a2 ? "highlight" : "normal";
    for (var c2 = this.a.length; c2--; )
      this.a[c2].key === a2 && (b2 = this.a[c2].V());
    return b2;
  };
  ft.prototype.getStyle = ft.prototype.V;
  function gt() {
    this.a = {};
  }
  t("H.data.kml.StyleContainer", gt);
  gt.prototype.Ig = function(a2) {
    a2 && a2.id && (this.a["style_" + a2.id] = a2);
  };
  gt.prototype.addStyle = gt.prototype.Ig;
  gt.prototype.mh = function(a2, b2) {
    a2 = this.a["style_" + a2];
    a2 instanceof ft && (a2 = a2.V(b2));
    return a2;
  };
  gt.prototype.getStyleById = gt.prototype.mh;
  function ht(a2) {
    a2 = a2.childNodes;
    for (var b2, c2 = a2.length, d = null, e = new Ss(); c2--; )
      b2 = a2[c2], "coordinates" === b2.nodeName && (d = e.Na(b2));
    this.a = null;
    d && (this.a = e.$h(d) || null);
  }
  t("H.data.kml.Point", ht);
  function it(a2, b2) {
    var c2 = a2 && a2.childNodes || [], d = new Ss();
    if (!a2 || !b2)
      throw Error("Node or stylesContainer is not defined");
    this.visibility = true;
    this.f = a2;
    for (a2 = c2.length; a2--; ) {
      var e = c2[a2];
      switch (e.nodeName) {
        case "name":
          this.name = d.Na(e);
          break;
        case "description":
          this.description = d.Na(e);
          break;
        case "visibility":
          this.visibility = d.Hd(e);
          break;
        case "open":
          this.open = d.Hd(e);
          break;
        case "styleUrl":
          if (this.b = d.Na(e))
            e = this.b.substr(1), this.c = b2.mh(e, false);
          break;
        case "Style":
          this.a = e = new dt(e);
      }
    }
  }
  t("H.data.kml.Feature", it);
  function jt(a2) {
    a2 = a2.childNodes;
    for (var b2, c2 = a2.length, d = new Ss(); c2--; )
      if (b2 = a2[c2], "coordinates" === b2.nodeName) {
        var e = [], f2 = new Ss();
        try {
          e = f2.vk(d.Na(b2));
        } catch (g) {
          e = [];
        }
        this.a = 2 > e.length ? [] : e;
      }
  }
  t("H.data.kml.Line", jt);
  function kt(a2) {
    for (var b2 = new L(), c2 = a2.a ? a2.a.length : 0; c2--; )
      b2.qd(a2.a[c2]);
    return b2;
  }
  ;
  function lt() {
  }
  lt.prototype.f = 0;
  lt.prototype.b = 0;
  function mt(a2) {
    var b2 = a2.childNodes, c2 = b2.length;
    this.a = new L();
    for (this.c = []; c2--; ) {
      var d = b2[c2];
      var e = d.nodeName;
      if ("outerBoundaryIs" === e || "innerBoundaryIs" === e) {
        var f2 = d.childNodes;
        for (d = f2.length; d--; ) {
          var g = f2[d];
          if ("LinearRing" === g.nodeName) {
            var h = new jt(g);
            if ("outerBoundaryIs" === e) {
              this.a = kt(h);
              var k = void 0, l = a2, m = h.a;
              h = new Ss();
              var n = l.querySelector("altitudeMode");
              if (n && n.parentNode === l && !/^\s*clampTo/.test(h.Na(n)) && m) {
                n = m.length;
                for (var q = 0; q < n && 0 !== k; q++) {
                  var r = m[q].alt;
                  r ? k ? r !== k && (k = 0) : k = r : k = 0;
                }
                (m = l.querySelector("*|altitudeOffset")) && m.parentNode === g && "http://www.google.com/kml/ext/2.2" === m.namespaceURI && (g = h.Gf(m)) && (k += g);
                k && (k = yd(2047, k), (g = l.querySelector("extrude")) && g.parentNode === l && h.Hd(g) ? this.b = k : this.f = k);
              }
            } else
              this.c.push(kt(h));
          }
        }
      }
    }
  }
  u(mt, lt);
  t("H.data.kml.Polygon", mt);
  function nt(a2, b2) {
    var c2 = document.createElement("CANVAS");
    c2.width = 1;
    c2.height = 1;
    this.g = a2;
    this.b = {};
    this.c = {};
    this.f = new Wj(c2);
    this.Yb = b2 || "";
  }
  nt.prototype.create = function(a2) {
    this.a = new it(a2, this.g);
    return ot(this, a2);
  };
  function ot(a2, b2, c2) {
    b2 = b2.childNodes;
    for (var d = b2.length, e, f2 = {}, g; d--; ) {
      var h = b2[d];
      switch (h.nodeName) {
        case "Point":
          h = new ht(h);
          g = pt(a2, "Marker");
          if (h = h.a)
            e = new Rn(h, g), g.ai && Fe(g.ai, "statechange", A(a2.i, a2, g.ai, e, g), false);
          break;
        case "LineString":
          h = new jt(h);
          g = pt(a2, "Polyline");
          e = new th(kt(h), g);
          break;
        case "LinearRing":
          h = new jt(h);
          g = pt(a2, "Polyline");
          e = new th(kt(h), g);
          break;
        case "Polygon":
          h = new mt(h);
          g = pt(a2, "Polygon");
          g.elevation = h.f;
          g.extrusion = h.b;
          e = new uh(new O(h.a, h.c), g);
          break;
        case "MultiGeometry":
          e = ot(
            a2,
            h,
            new R()
          );
      }
      e && (a2.a.name && (f2.name = a2.a.name), a2.a.description && (f2.description = a2.a.description), g && g.pf && (f2.balloonStyle = g.pf), f2.kmlNode = a2.a.f, e.setData(f2), c2 && c2.fa(e));
    }
    return c2 || e;
  }
  nt.prototype.i = function(a2, b2, c2) {
    var d = c2.anchor, e = c2.scale;
    c2 = e + "_" + d.x + d.y + d.Vc + d.zc + "_" + c2.href;
    var f2 = {};
    if (1 === a2.getState()) {
      var g = this.b[c2];
      if (!g) {
        var h = d.x;
        var k = d.y;
        if (g = a2.yb())
          g = { w: g.w * e, h: g.h * e }, f2.size = g;
        h = d.Vc && g ? g.w * h : h * e;
        k = d.zc && g ? g.h * (1 - k) : !d.zc && g ? g.h - k * e : k * e;
        f2.anchor = { x: h, y: k };
        g = new Wj(a2.Qc(), f2);
        this.b[c2] = g;
      }
      b2.Ic(g);
    }
    delete this.c[c2];
  };
  function pt(a2, b2) {
    var c2 = a2.a, d = { visibility: c2.visibility };
    var e = new Ws();
    var f2 = 1;
    var g = { x: 0, y: 0, Vc: false, zc: false };
    var h = qt(a2, c2.c);
    c2.a && (h = qt(a2, c2.a, h));
    switch (b2) {
      case "Marker":
        if (h && h.Oj) {
          e = h.Oj;
          e.scale && (f2 = e.scale);
          if (e.a) {
            var k = e.a;
            g = { x: k.x, y: k.y, Vc: k.Vc, zc: k.zc };
          }
          e.icon && e.icon.href ? (b2 = e.icon.href, rt.test(b2) || (b2 = a2.Yb + b2), e = f2 + "_" + g.x + g.y + g.Vc + g.zc + "_" + b2, k = a2.b[e] || a2.c[e], k || (k = new Wj(b2), a2.c[e] = k), 0 === k.getState() ? (d.icon = a2.f, d.ai = k, d.href = b2, d.anchor = g, d.scale = f2) : 1 === k.getState() && (d.icon = k)) : 1 !== f2 && (k || (g = {
            x: 14,
            y: 4,
            Vc: false,
            zc: false
          }), a2 = { w: 28 * f2, h: 36 * f2 }, f2 = { size: new Wi(a2.w, a2.h), anchor: new J(g.Vc ? a2.w * g.x : g.x * f2, g.zc ? a2.h * (1 - g.y) : a2.h - g.y * f2), hitArea: new Xi(Yi.POLYGON, [0 * f2, 16 * f2, 0 * f2, 7 * f2, 8 * f2, 0 * f2, 18 * f2, 0 * f2, 26 * f2, 7 * f2, 26 * f2, 16 * f2, 18 * f2, 34 * f2, 8 * f2, 34 * f2]) }, d.icon = new Wj(
            '<svg xmlns="http://www.w3.org/2000/svg" width="28px" height="36px"><path d="M 19 31 C 19 32.7 16.3 34 13 34 C 9.7 34 7 32.7 7 31 C 7 29.3 9.7 28 13 28 C 16.3 28 19 29.3 19 31 Z" fill="#000" fill-opacity=".2"/><path d="M 13 0 C 9.5 0 6.3 1.3 3.8 3.8 C 1.4 7.8 0 9.4 0 12.8 C 0 16.3 1.4 19.5 3.8 21.9 L 13 31 L 22.2 21.9 C 24.6 19.5 25.9 16.3 25.9 12.8 C 25.9 9.4 24.6 6.1 22.1 3.8 C 19.7 1.3 16.5 0 13 0 Z" fill="#fff"/><path d="M 13 2.2 C 6 2.2 2.3 7.2 2.1 12.8 C 2.1 16.1 3.1 18.4 5.2 20.5 L 13 28.2 L 20.8 20.5 C 22.9 18.4 23.8 16.2 23.8 12.8 C 23.6 7.07 20 2.2 13 2.2 Z" fill="#18d"/></svg>',
            f2
          ));
        }
        break;
      case "Polyline":
        d.style = {};
        h && h.Wd && (f2 = h.Wd, d.style.strokeColor = "rgba(" + Zs(e, f2.a.a, true) + ")", 0 <= f2.width && (d.style.lineWidth = f2.width));
        break;
      case "Polygon":
        d.style = {}, h && (h.Wd && (f2 = h.Wd, d.style.strokeColor = "rgba(" + Zs(e, f2.a.a, true) + ")", 0 <= f2.width && (d.style.lineWidth = f2.width)), h.yk && (f2 = h.yk, d.style.fillColor = f2.fill ? "rgba(" + Zs(e, f2.b.a, true) + ")" : "rgba(0,0,0,0)", f2.a || (d.style.lineWidth = 0)));
    }
    d.pf = h.pf;
    return d;
  }
  function qt(a2, b2, c2) {
    c2 = c2 || {};
    for (var d in b2)
      b2.hasOwnProperty(d) && (c2[d] = "object" === typeof b2[d] ? qt(a2, b2[d], c2[d]) : b2[d]);
    return c2;
  }
  var rt = /^[^:\/]+:/;
  function st(a2) {
    xc(this, st);
    this.url = a2;
    this.b = [];
    this.a = z;
    this.c = A(this.c, this);
    F.call(this);
  }
  u(st, F);
  t("H.data.AbstractReader", st);
  var tt = { ERROR: -1, LOADING: 0, VISIT: 1, READY: 2 };
  st.State = tt;
  st.prototype.f = tt.READY;
  st.prototype.A = { ml: "statechange" };
  st.prototype.ob = function() {
    if (!this.a) {
      this.a = new N();
      var a2 = this.a.bc();
      a2.Xb(this.b);
    }
    return new tl(this.a);
  };
  st.prototype.getLayer = st.prototype.ob;
  st.prototype.Gm = function() {
    return this.b.concat([]);
  };
  st.prototype.getParsedObjects = st.prototype.Gm;
  st.prototype.v = function() {
    return this.url;
  };
  st.prototype.getUrl = st.prototype.v;
  st.prototype.Co = function(a2) {
    if (this.f === tt.LOADING || this.f === tt.VISIT)
      throw Error("InvalidState: state " + this.f);
    this.b = [];
    this.a = z;
    this.url = a2;
    return this;
  };
  st.prototype.setUrl = st.prototype.Co;
  st.prototype.getState = function() {
    return this.f;
  };
  st.prototype.getState = st.prototype.getState;
  st.prototype.O = function(a2, b2, c2) {
    this.f = a2;
    this.dispatchEvent(new ut(b2 || this, this.A.ml, a2, c2 || ""));
  };
  st.prototype.parse = function() {
    var a2 = this;
    vc(this.url) ? (this.O(tt.LOADING), new tf("text/plain", this.url).then(function(b2) {
      try {
        a2.c(b2);
      } catch (c2) {
        a2.O(tt.ERROR, z, c2.message);
      }
    }, function() {
      a2.O(tt.ERROR, z, "Error loading file");
    })) : a2.O(tt.ERROR, z, "File url was not set");
  };
  st.prototype.parse = st.prototype.parse;
  function ut(a2, b2, c2, d) {
    ut.j.constructor.call(this, b2, a2);
    this.state = c2;
    this.message = d;
  }
  u(ut, ud);
  st.Event = ut;
  function vt(a2) {
    var b2 = a2 ? a2.lastIndexOf("/") : -1;
    this.g = [];
    st.call(this, a2);
    0 <= b2 && (this.i = a2.substr(0, b2) + "/");
  }
  u(vt, st);
  t("H.data.kml.Reader", vt);
  vt.prototype.c = function(a2) {
    var b2, c2 = null;
    if (Cc(a2) && "" != a2.trim()) {
      try {
        var d = new DOMParser().parseFromString(a2, "text/xml");
      } catch (h) {
        this.O(tt.ERROR, z, "Error parsing KML document");
        return;
      }
      if (d.getElementsByTagName("parsererror").length)
        this.O(tt.ERROR, z, "Error parsing KML document");
      else if ((a2 = d.childNodes && "kml" === d.childNodes[0].nodeName ? d.childNodes[0] : void 0) && (b2 = wt(a2.childNodes, "Document")[0]), b2 = b2 || a2) {
        d = new gt();
        for (var e = wt(b2.childNodes, "Style"), f2 = wt(b2.childNodes, "StyleMap"), g = e.length; g--; )
          a2 = new dt(e[g]), d.Ig(a2);
        for (g = f2.length; g--; )
          a2 = new ft(f2[g], d), d.Ig(a2);
        this.l = new nt(d, this.i);
        a2 = b2.childNodes;
        for (b2 = a2.length; b2--; )
          if (e = a2[b2], d = c2, "Placemark" === e.nodeName ? (e = this.l.create(e)) && xt(this, e, d) : "Folder" === e.nodeName && (e = { group: new R(), node: e }, xt(this, e.group, d), this.g.push(e)), !b2 && (d = this.g.shift()))
            a2 = d.node.childNodes, c2 = d.group, b2 = a2.length;
        this.O(tt.READY);
      } else
        this.O(tt.ERROR, z, "Invalid KML document");
    } else
      this.O(tt.ERROR, z, "Unable to create objects from the empty data");
  };
  function xt(a2, b2, c2) {
    c2 ? c2.fa(b2) : (a2.a && a2.a.bc().fa(b2), a2.b.push(b2), a2.O(tt.VISIT, b2));
  }
  function wt(a2, b2) {
    for (var c2 = a2.length, d, e = []; c2--; )
      d = a2[c2], d.nodeName === b2 && e.push(d);
    return e;
  }
  ;
  function yt(a2, b2) {
    this.b = a2;
    this.a = b2;
  }
  yt.prototype.create = function(a2, b2) {
    var c2 = a2.coordinates;
    switch (a2.type) {
      case "Point":
        var d = new Rn(zt(c2));
        break;
      case "LineString":
        d = new th(At(c2));
        break;
      case "Polygon":
        d = new uh(Bt(c2));
        break;
      case "MultiPoint":
        var e = 0;
        var f2 = c2.length;
        d = [];
        if (this.a) {
          for (; e < f2; e++)
            d.push(zt(c2[e]));
          c2 = new Rn(new Vi(d));
        } else {
          for (; e < f2; e++)
            d.push(new Rn(zt(c2[e])));
          c2 = new R();
          c2.Xb(d);
        }
        d = c2;
        f2 = "multiPoint";
        break;
      case "MultiLineString":
        e = 0;
        f2 = c2.length;
        d = [];
        if (this.a) {
          for (; e < f2; e++)
            d.push(At(c2[e]));
          c2 = new th(new ih(d));
        } else {
          for (; e < f2; e++)
            d.push(new th(At(c2[e])));
          c2 = new R();
          c2.Xb(d);
        }
        d = c2;
        f2 = "multiLineString";
        break;
      case "MultiPolygon":
        d = [];
        e = 0;
        f2 = c2.length;
        if (this.a) {
          for (; e < f2; e++)
            d.push(Bt(c2[e]));
          c2 = new uh(new Ji(d));
        } else {
          for (; e < f2; e++)
            d.push(new uh(Bt(c2[e])));
          c2 = new R();
          c2.Xb(d);
        }
        d = c2;
        f2 = "multiPolygon";
        break;
      case "GeometryCollection":
        c2 = d = new R();
        e = a2.geometries;
        f2 = 0;
        for (var g = e.length; f2 < g; f2++)
          this.create(e[f2], c2);
        f2 = "geometryCollection";
    }
    d && (c2 = d, e = a2.properties, a2 = a2.id, g = {}, e && (this.a ? g = e : g.properties = e), f2 && !this.a && (g[f2] = true), a2 && c2.Ai(a2), c2.setData(g), this.b(d));
    b2 && d && b2.fa(d);
    return d;
  };
  yt.prototype.create = yt.prototype.create;
  function zt(a2) {
    return new kg(a2[1], a2[0]);
  }
  function Bt(a2) {
    for (var b2 = At(a2[0]), c2 = [], d, e = 1, f2 = a2.length; e < f2; e++)
      d = At(a2[e]), c2.push(d);
    return new O(b2, c2);
  }
  function At(a2) {
    for (var b2 = 0, c2 = a2.length, d = new L(); b2 < c2; b2++)
      d.qd(zt(a2[b2]));
    return d;
  }
  ;
  function Ct(a2, b2) {
    b2 = b2 || {};
    this.i = b2.style || this.Fd;
    (this.g = !!b2.disableLegacyMode) || window.console.warn("H.data.geojson.Reader: Legacy parser is enabled in GeoJSON Reader. Features like Multi-Geometries, Polygon interiors and GeoJSON feature properties might not work as expected. To maximise compatibility with the remote services it is recommended to set the `disableLegacyMode` flag to true.");
    st.call(this, a2);
  }
  u(Ct, st);
  t("H.data.geojson.Reader", Ct);
  Ct.prototype.c = function(a2) {
    var b2, c2;
    try {
      var d = "string" === typeof a2 ? JSON.parse(a2) : a2;
      if ("object" === typeof d) {
        var e = new yt(this.i, this.g);
        switch (d.type) {
          case "FeatureCollection":
            if (b2 = d.features) {
              var f2 = new R();
              Dt(this, f2);
              for (c2 = 0; c2 < b2.length; c2++) {
                var g = Et(b2[c2]);
                (g = e.create(g)) && f2.fa(g);
              }
            }
            break;
          case "Feature":
            g = Et(d);
            (g = e.create(g)) && Dt(this, g);
            break;
          default:
            (g = e.create(d)) && Dt(this, g);
        }
        this.O(tt.READY);
      } else
        this.O(tt.ERROR, z, "Invalid syntax");
    } catch (h) {
      this.O(tt.ERROR, z, "Parse error. " + h.message);
    }
  };
  Ct.prototype.io = function(a2) {
    this.O(tt.LOADING);
    this.c(a2);
  };
  Ct.prototype.parseData = Ct.prototype.io;
  Ct.prototype.Fd = function() {
  };
  function Et(a2) {
    var b2 = {};
    if (a2.geometry) {
      var c2 = a2.geometry;
      b2.type = c2.type;
      b2.properties = a2.properties;
      c2.coordinates && (b2.coordinates = c2.coordinates);
      c2.geometries && (b2.geometries = c2.geometries);
      a2.id && (b2.id = a2.id);
    }
    return b2;
  }
  function Dt(a2, b2) {
    a2.a && a2.a.bc().fa(b2);
    a2.b.push(b2);
    a2.O(tt.VISIT, b2);
  }
  ;
  t("H.data.buildInfo", function() {
    return Hf("H-data", "1.49.1", "74e5afb", { region: "row" });
  });
  wg.prototype.Lc = ca(1, function(a2, b2) {
    this.a.Lc(a2, Fc(b2) ? b2 : this.c);
  });
  Ag.prototype.Lc = ca(0, function(a2, b2) {
    var c2 = 0, d;
    if (!a2(this) && b2--)
      for (; 3 >= c2; c2++)
        (d = this[c2]) && d.Lc(a2, b2);
  });
  function Ft(a2, b2) {
    this.a = a2;
    this.b = b2;
  }
  t("H.clustering.grid.NoisePoint", Ft);
  Ft.prototype.ya = function() {
    return ng(this.a);
  };
  Ft.prototype.getPosition = Ft.prototype.ya;
  Ft.prototype.xc = function() {
    return this.a.wt;
  };
  Ft.prototype.getWeight = Ft.prototype.xc;
  Ft.prototype.od = gf;
  Ft.prototype.isCluster = Ft.prototype.od;
  Ft.prototype.sc = function() {
    return this.b;
  };
  Ft.prototype.getMinZoom = Ft.prototype.sc;
  Ft.prototype.getData = function() {
    return this.a.data;
  };
  Ft.prototype.getData = Ft.prototype.getData;
  function Gt(a2, b2, c2) {
    this.g = this.b = c2;
    this.bi = [];
    this.a = 0;
    this.f = sg(a2, b2, true);
  }
  t("H.clustering.grid.Cluster", Gt);
  Gt.prototype.ne = function(a2) {
    this.c || (this.c = ng(a2));
    this.a += a2.wt || 1;
    this.bi.push(a2);
  };
  Gt.prototype.ya = function() {
    return this.c;
  };
  Gt.prototype.getPosition = Gt.prototype.ya;
  Gt.prototype.xc = function() {
    return this.a;
  };
  Gt.prototype.getWeight = Gt.prototype.xc;
  Gt.prototype.od = ff;
  Gt.prototype.isCluster = Gt.prototype.od;
  Gt.prototype.sc = function() {
    return this.b;
  };
  Gt.prototype.getMinZoom = Gt.prototype.sc;
  Gt.prototype.If = function() {
    return this.g;
  };
  Gt.prototype.getMaxZoom = Gt.prototype.If;
  Gt.prototype.K = function() {
    return this.f;
  };
  Gt.prototype.getBoundingBox = Gt.prototype.K;
  Gt.prototype.Yg = function(a2) {
    this.ze(a2);
  };
  Gt.prototype.forEachEntry = Gt.prototype.Yg;
  Gt.prototype.ze = function(a2) {
    var b2 = this;
    if (!Da(a2))
      throw new D(this.ze, 0, a2);
    this.bi.forEach(function(c2) {
      a2(new Ft(c2, b2.b + 1));
    });
  };
  Gt.prototype.forEachDataPoint = Gt.prototype.ze;
  function Ht(a2) {
    qd.call(this);
    this.a = [];
    var b2;
    a2 ? Ya(b2 = {}, It, a2) : b2 = It;
    this.g = b2;
    qd.call(this);
  }
  u(Ht, qd);
  var Jt = { clusters: [], noisePoints: [] }, It = { projection: mj, min: 0, max: 22, eps: 32, minWeight: 2 };
  p = Ht.prototype;
  p.Hc = function(a2) {
    this.a = a2;
    this.b = true;
  };
  p.Db = function(a2) {
    this.a.push(a2);
    this.b = true;
  };
  p.mf = function(a2) {
    this.a = this.a.concat(a2);
    this.b = true;
  };
  p.We = function(a2) {
    this.a = this.a.filter(function(b2) {
      return b2 !== a2;
    });
    this.b = true;
  };
  p.o = function() {
    Ht.j.o.call(this);
    delete this.a;
  };
  Ht.prototype.disposeInternal = Ht.prototype.o;
  Ht.prototype.U = ld;
  function Kt(a2) {
    Ht.call(this, a2);
  }
  u(Kt, Ht);
  Kt.prototype.Ei = function(a2) {
    var b2 = this.g, c2 = b2.min, d = b2.max, e = [], f2 = [], g;
    if (this.b) {
      for (g = this.a; c2 <= d; c2++) {
        for (var h, k = void 0, l, m, n, q, r, v, w, y = c2, G = g, I = e, Q = f2, V = b2.eps, Ba = b2.projection, ha = b2.minWeight, rb = G.length, Fa = Math.pow(2, y + 8), bc = []; w = G[--rb]; )
          if (!w.Ki) {
            m = Ba.Pc(w).scale(Fa).floor();
            v = Fa;
            r = m.x;
            q = m.y;
            for (l = bc.length; l--; )
              h = bc[l], n = h.ya(), h.Ji || (h.Ji = Ba.Pc(n).scale(Fa).floor()), n = h.Ji, n = n.Wa(m), n < v && (v = n, k = h);
            k && k.K().gd(w) || (k = new Gt(Ba.dg({ x: (r - V) / Fa, y: (q - V) / Fa }), Ba.dg({ x: (r + V) / Fa, y: (q + V) / Fa }), y), bc.push(k));
            k.ne(w);
            k = null;
          }
        for (rb = bc.length; rb--; )
          if (h = bc[rb], l = h.xc(), l < ha)
            for (h = h.bi, l = h.length; w = h[--l]; )
              Q.push(new Ft(w, y)), w.Ki = true;
          else
            I.push(h);
      }
      c2 = 0;
      for (d = g.length; c2 < d; c2++)
        delete g[c2].Ki;
      this.b = false;
      a2({ clusters: e, noisePoints: f2 });
    }
  };
  function Lt(a2) {
    this.a = a2;
    a2 = document.createElement("canvas");
    var b2 = a2.getContext("2d"), c2 = this.a, d = 14 * c2;
    a2.width = d;
    a2.height = d;
    b2.scale(c2, c2);
    b2.beginPath();
    b2.strokeStyle = "#FFFFFF";
    b2.fillStyle = "#1080DD";
    b2.arc(7, 7, 6, 0, 2 * Math.PI, false);
    b2.fill();
    b2.lineWidth = 1;
    b2.stroke();
    this.f = new Wj(a2, { size: { w: 14, h: 14 }, anchor: { x: 7, y: 7 } });
    this.b = {};
    this.c = {};
  }
  t("H.clustering.theme.Circular", Lt);
  function Mt(a2, b2, c2) {
    var d, e = document.createElement("canvas"), f2 = e.getContext("2d");
    var g = a2.a;
    var h = b2 * g;
    e.width = h;
    e.height = h;
    f2.scale(g, g);
    g = b2 + ":" + c2;
    (d = a2.b[g]) ? f2.putImageData(d, 0, 0) : (b2 /= 2, f2.beginPath(), f2.strokeStyle = "rgba(" + c2 + ",0.2)", f2.fillStyle = "rgba(" + c2 + ",1)", f2.arc(b2, b2, b2 / 5 * 3, 0, 2 * Math.PI, false), f2.fill(), f2.lineWidth = b2 / 5 * 4, f2.stroke(), a2.b[g] = f2.getImageData(0, 0, h, h));
    return e;
  }
  Lt.prototype.Sl = function(a2) {
    var b2 = a2.xc();
    var c2 = this.c[b2];
    if (!c2) {
      if (10 > b2) {
        c2 = Mt(this, 28, "118,209,0");
        var d = { x: 11, y: 18 };
      } else
        25 > b2 ? (c2 = Mt(this, 38, "255,105,0"), d = { x: 13, y: 23 }) : 50 > b2 ? (c2 = Mt(this, 38, "240,60,0"), d = { x: 13, y: 23 }) : 100 > b2 ? (c2 = Mt(this, 38, "181,0,21"), d = { x: 13, y: 23 }) : 1e3 > b2 ? (c2 = Mt(this, 48, "181,0,21"), d = { x: 15, y: 28 }) : (c2 = Mt(this, 66, "181,0,21"), d = { x: 20, y: 38 });
      var e = c2.getContext("2d");
      e.fillStyle = "#FFFFFF";
      e.font = "bold 11px Arial";
      e.fillText(String(b2), d.x, d.y);
      d = c2.width / this.a;
      c2 = new Wj(c2, { size: { w: d, h: d }, anchor: { x: d / 2, y: d / 2 } });
      this.c[b2] = c2;
    }
    b2 = new Rn(a2.ya(), { icon: c2, min: a2.sc(), max: a2.If() });
    b2.setData(a2);
    return b2;
  };
  Lt.prototype.getClusterPresentation = Lt.prototype.Sl;
  Lt.prototype.Dm = function(a2) {
    var b2 = new Rn(a2.ya(), { icon: this.f, min: a2.sc() });
    b2.setData(a2);
    return b2;
  };
  Lt.prototype.getNoisePresentation = Lt.prototype.Dm;
  function Nt(a2) {
    Ht.call(this, a2);
    a2 = this.g;
    if (a2.projection !== mj)
      throw new D(Nt, 0, "Other projection than mercator not supported yet");
    this.s = a2.projection;
    this.f = a2.eps;
    this.D = a2.minWeight;
    this.m = new nj(this.s);
    new Pf().a("cluster", "H.clustering.dynamicgrid.worker");
    this.i = A(this.i, this);
    this.l = A(this.l, this);
  }
  u(Nt, Ht);
  Nt.prototype.U = function(a2, b2) {
    this.u = a2;
    this.J = Bd(b2);
  };
  Nt.prototype.Ei = function(a2, b2) {
    var c2 = this.c;
    var d = this.u, e = this.J || 0;
    var f2 = !c2 || !(c2.zoom === e && c2.b.ia(d));
    if (d && (this.b || f2)) {
      c2 && 3 > c2.Yd && c2.cancel();
      this.b = false;
      c2 = this.f;
      if (c2 >= 128 * Gd(2, e))
        var g = Ot;
      else {
        f2 = this.m;
        f2.Oa(e);
        var h = f2.ib(d.Nb());
        g = f2.ib(d.Jb());
        h.y -= c2;
        g.y += c2;
        h = f2.Re(h);
        var k = f2.Re(g);
        g = new K(h.lat, h.lng, k.lat, k.lng);
        c2 = f2.Ra(c2, 0).lng + 180;
        g = g.Bc(h.lat, h.lng - c2, k.lat, h.lng).Bc(h.lat, k.lng, k.lat, k.lng + c2);
      }
      c2 = g;
      h = this.a;
      g = [];
      for (f2 = h.length; f2--; )
        c2.gd(h[f2]) && g.push(h[f2]);
      0 < g.length ? (this.c = new Pt(
        d,
        e,
        g,
        this.f,
        this.D,
        this.s !== mj,
        a2,
        b2
      ), this.c.then(this.i, this.l)) : a2(Jt);
    }
  };
  Nt.prototype.i = function(a2) {
    Ca(a2) || (a2 = new x.Uint32Array(a2));
    this.c.g(Qt(this, a2));
  };
  Nt.prototype.l = function(a2) {
    Cc(a2) && this.c.f(a2);
  };
  var Ot = new K(90, -180, -90, 180);
  function Qt(a2, b2) {
    for (var c2 = 0, d = b2[c2++], e = Array(d), f2 = 0, g = [], h = b2.length, k = a2.c.a, l = a2.c.zoom; d--; )
      e[f2++] = new Ft(k[b2[c2++]], l);
    for (; c2 < h; ) {
      d = b2[c2++];
      f2 = k[b2[c2]];
      var m = a2.m;
      var n = a2.f;
      m.Oa(a2.c.zoom);
      var q = m.ib(f2);
      f2 = m.Ra(q.x - n, q.y - n);
      m = m.Ra(q.x + n, q.y + n);
      f2 = new K(f2.lat, f2.lng, m.lat, m.lng);
      for (f2 = new Gt(f2.Nb(), f2.Jb(), l); d--; )
        f2.ne(k[b2[c2++]]);
      g.push(f2);
    }
    return { clusters: g, noisePoints: e };
  }
  Nt.prototype.o = function() {
    Nt.j.o.call(this);
  };
  Nt.prototype.disposeInternal = Nt.prototype.o;
  function Pt(a2, b2, c2, d, e, f2, g, h) {
    this.b = a2;
    this.zoom = b2;
    this.a = c2;
    this.g = g;
    this.f = h;
    a2 = c2.length;
    g = 3 * a2;
    h = new (x.Float64Array || Array)(g);
    for (var k; a2--; )
      k = c2[a2], h[--g] = k.lat, h[--g] = k.lng, h[--g] = k.wt;
    ie.call(this, "cluster", { message: [h, d, e, b2, f2] }, void 0);
  }
  u(Pt, Sf);
  function Rt(a2, b2, c2) {
    this.b = a2;
    this.a = b2;
    this.f = c2;
  }
  t("H.clustering.fastgrid.NoisePoint", Rt);
  Rt.prototype.ya = function() {
    this.c || (this.c = this.b.Ra(this.a[1], this.a[0], 1));
    return this.c;
  };
  Rt.prototype.getPosition = Rt.prototype.ya;
  Rt.prototype.xc = function() {
    return this.a.a;
  };
  Rt.prototype.getWeight = Rt.prototype.xc;
  Rt.prototype.od = gf;
  Rt.prototype.isCluster = Rt.prototype.od;
  Rt.prototype.sc = function() {
    return this.f - this.b.c;
  };
  Rt.prototype.getMinZoom = Rt.prototype.sc;
  Rt.prototype.getData = function() {
    return this.a.data;
  };
  Rt.prototype.getData = Rt.prototype.getData;
  function St(a2, b2, c2, d) {
    this.b = a2;
    this.a = b2;
    this.l = c2;
    this.U = d;
    this.f = Ka(this.f, this);
    this.c = Ka(this.c, this);
  }
  t("H.clustering.fastgrid.Cluster", St);
  St.prototype.ya = function() {
    this.s || (this.s = this.b.Ra(this.a.qe, this.a.re, this.a.Fb));
    return this.s;
  };
  St.prototype.getPosition = St.prototype.ya;
  St.prototype.xc = function() {
    return this.a.Fb;
  };
  St.prototype.getWeight = St.prototype.xc;
  St.prototype.od = ff;
  St.prototype.isCluster = St.prototype.od;
  St.prototype.sc = function() {
    return this.l ? this.l - this.b.c : -1 / 0;
  };
  St.prototype.getMinZoom = St.prototype.sc;
  St.prototype.If = function() {
    return this.U - this.b.c;
  };
  St.prototype.getMaxZoom = St.prototype.If;
  St.prototype.K = function() {
    this.i || (this.i = sg(this.b.Ra(this.a.a, this.a.f, 1), this.b.Ra(this.a.b, this.a.c, 1), true));
    return this.i;
  };
  St.prototype.getBoundingBox = St.prototype.K;
  St.prototype.Yg = function(a2) {
    this.g = a2;
    this.a.Lc(this.f, Wd);
  };
  St.prototype.forEachEntry = St.prototype.Yg;
  St.prototype.f = function(a2, b2) {
    var c2 = false, d, e;
    a2.Fb >= this.b.s && a2 !== this.a && a2.Fb !== this.a.Fb && (this.g(new St(this.b, a2, 0, b2)), c2 = true);
    if (!c2 && (d = a2.entries))
      for (a2 = d.length, e = 0; e < a2; e++)
        this.g(new Rt(this.b, d[e], b2));
    return c2;
  };
  St.prototype.ze = function(a2) {
    this.m = a2;
    this.a.Lc(this.c, Wd);
  };
  St.prototype.forEachDataPoint = St.prototype.ze;
  St.prototype.c = function(a2, b2) {
    var c2;
    if (a2 = a2.entries) {
      var d = a2.length;
      for (c2 = 0; c2 < d; c2++)
        this.m(new Rt(this.b, a2[c2], b2));
    }
    return false;
  };
  function Tt(a2, b2, c2, d, e, f2) {
    this.g = b2;
    a2 && (this.parent = a2, b2 & 1 ? (c2 = a2[8], e = a2[5]) : (c2 = a2[7], e = a2[8]), b2 & 2 ? (d = a2[9], f2 = a2[6]) : (d = a2[4], f2 = a2[9]));
    this[7] = c2;
    this[5] = e;
    this[8] = (c2 + e) / 2;
    this[4] = d;
    this[6] = f2;
    this[9] = (d + f2) / 2;
  }
  p = Tt.prototype;
  p.Xd = 0;
  function Ut(a2, b2) {
    return a2[b2] || (++a2.Xd, a2[b2] = new Tt(a2, b2));
  }
  p.removeChild = function(a2) {
    var b2 = a2.g;
    this[b2] === a2 && (delete this[b2], delete a2.parent, --this.Xd);
  };
  p.Lc = function(a2, b2) {
    for (var c2 = 0, d = this; d = d.parent; )
      ++c2;
    Vt(this, a2, b2, c2);
  };
  function Vt(a2, b2, c2, d) {
    var e, f2;
    if (!b2(a2, d) && c2--)
      for (++d, e = 0; 4 > e; e++)
        (f2 = a2[e]) && Vt(f2, b2, c2, d);
  }
  p.qe = 0;
  p.re = 0;
  p.Fb = 0;
  function Wt(a2) {
    this.b = a2 || 10;
    Xt(this);
  }
  function Xt(a2) {
    a2.head = a2.a = new Tt(null, NaN, 0, 0, 4294967296, 4294967296);
  }
  function Yt(a2, b2) {
    var c2, d;
    for (c2 = 0; 4 > c2; c2++)
      if (d = b2[c2])
        Yt(a2, d), delete b2[c2];
    delete b2.parent;
    delete b2.entries;
  }
  function Zt(a2, b2) {
    var c2 = a2.head, d;
    if (b2) {
      var e = b2;
      if (e !== c2) {
        for (c2 = e; e = e.parent; )
          if (e.entries || 1 < e.Xd)
            c2 = e;
      }
    } else
      for (; !c2.entries && 2 > (d = c2.Xd); )
        if (d)
          c2 = e;
        else
          break;
    a2.head = c2;
  }
  Wt.prototype.yc = function(a2, b2, c2, d) {
    var e = this.a;
    if (!(a2 >= e[7] && b2 >= e[4] && a2 <= e[5] && b2 <= e[6]))
      throw Error("Coordinates out of bounds");
    return $t(this, this.a, a2, b2, c2, this.b, d);
  };
  function $t(a2, b2, c2, d, e, f2, g) {
    var h = b2.entries;
    f2 ? b2.Xd ? h = $t(a2, Ut(b2, +(c2 >= b2[8]) | +(d >= b2[9]) << 1), c2, d, e, f2 - 1, g) : h ? (h = h[0], h = Ut(b2, +(h[1] >= b2[8]) | +(h[0] >= b2[9]) << 1), h.entries = b2.entries, h.qe = b2.qe, h.re = b2.re, h.Fb = b2.Fb, h.a = b2.a, h.f = b2.f, h.b = b2.b, h.c = b2.c, delete b2.entries, Zt(a2, h), h = $t(a2, Ut(b2, +(c2 >= b2[8]) | +(d >= b2[9]) << 1), c2, d, e, f2 - 1, g)) : (f2 = h = new au(c2, d, e, g), (b2.entries || (b2.entries = [])).push(f2), Zt(a2, b2)) : (h || Zt(a2, b2), a2 = h = new au(c2, d, e, g), (b2.entries || (b2.entries = [])).push(a2));
    b2.qe += c2 * e;
    b2.re += d * e;
    b2.Fb += e;
    b2.a === B ? (b2.a = b2.b = c2, b2.f = b2.c = d) : (c2 < b2.a ? b2.a = c2 : c2 > b2.b && (b2.b = c2), d < b2.f ? b2.f = d : d > b2.c && (b2.c = d));
    return h;
  }
  Wt.prototype.Lc = function(a2, b2) {
    Vt(this.a, a2, b2 === +b2 ? b2 : this.b, 0);
  };
  function au(a2, b2, c2, d) {
    this[0] = b2;
    this[1] = a2;
    this.a = c2;
    this.data = d;
  }
  ;
  function bu(a2) {
    Ht.call(this, a2);
    a2 = this.g;
    this.l = a2.projection;
    this.m = a2.min;
    this.f = a2.max;
    this.s = a2.minWeight;
    this.c = 7 - Ad(Ed(zd(1, a2.eps)) / Od);
    this.i = new Wt(zd(this.m, this.f + this.c));
  }
  u(bu, Ht);
  p = bu.prototype;
  p.Hc = function(a2) {
    var b2 = 0, c2 = a2.length, d, e = new J(0, 0), f2 = this.l, g = this.i;
    bu.j.Hc.call(this, a2);
    Yt(g, g.a);
    for (Xt(g); b2 < c2; b2++)
      f2.Pc(d = a2[b2], e).scale(4294967296).floor(), g.yc(e.x, e.y, d.wt, d.data);
    this.b = true;
  };
  p.Db = function(a2) {
    bu.j.Db.call(this, a2);
    this.Hc(this.a);
  };
  p.mf = function(a2) {
    for (var b2 = a2.length, c2 = bu.j.Db; b2--; )
      c2.call(this, a2[b2]);
    this.Hc(this.a);
  };
  p.We = function(a2) {
    bu.j.We.call(this, a2);
    this.Hc(this.a);
  };
  p.Ra = function(a2, b2, c2, d) {
    return this.l.Ra(a2 / c2 / 4294967296, b2 / c2 / 4294967296, d);
  };
  p.Ei = function(a2) {
    if (this.b) {
      var b2 = { clusters: [], noisePoints: [] };
      cu(this, this.i.a, 0, this.f + this.c, -1 / 0, b2, null);
      this.b = false;
      a2(b2);
    }
  };
  function cu(a2, b2, c2, d, e, f2, g) {
    var h = b2.Fb, k;
    g && (g.node.Fb !== h ? (f2.clusters.push(new St(a2, g.node, g.depth, c2 - 1)), g = null) : e++);
    g || (h >= a2.s ? (g = { node: b2, depth: c2 }, e = c2) : du(a2, b2, e + 1, f2));
    if (b2.Xd && d--) {
      for (c2++, h = 0; 4 > h; h++)
        if (k = b2[h])
          cu(a2, k, c2, d, e, f2, g), g = null;
    }
    g && f2.clusters.push(new St(a2, g.node, g.depth, a2.f + a2.c));
  }
  function du(a2, b2, c2, d) {
    b2 = b2.entries;
    var e;
    if (b2) {
      var f2 = b2.length;
      d = d.noisePoints;
      for (e = 0; e < f2; e++)
        d.push(new Rt(a2, b2[e], c2));
    } else
      for (e = 0; 4 > e; e++)
        (f2 = a2[e]) && du(a2, f2, c2, d);
  }
  p.o = function() {
    bu.j.o.call(this);
    this.i = null;
  };
  bu.prototype.disposeInternal = bu.prototype.o;
  t("H.clustering.DataPoint", function(a2, b2, c2, d) {
    this.lat = a2;
    this.lng = b2;
    this.wt = c2 === +c2 ? c2 : 1;
    this.data = d;
  });
  function eu(a2, b2) {
    b2 = b2 || {};
    var c2 = {}, d = b2.min || 0, e = zd(d, b2.max || 22);
    d = { min: d, max: e };
    eu.j.constructor.call(this, d);
    this.xa = b2.pixelRatio || Ue();
    Ya(c2, It, d, b2.clusteringOptions || {});
    c2.minWeight = zd(It.minWeight, c2.minWeight);
    switch (c2.strategy) {
      case fu.DYNAMICGRID:
        if (c2.projection !== mj)
          throw new D(eu, 1, "Unsupported projection");
        this.c = new Nt(c2);
        break;
      case fu.GRID:
        this.c = new Kt(c2);
        break;
      default:
        this.c = new bu(c2);
    }
    this.c.Hc(a2);
    this.D = b2.theme || new Lt(this.xa);
    this.R = A(this.R, this);
    this.aa = A(this.aa, this);
    gu(this);
  }
  u(eu, N);
  t("H.clustering.Provider", eu);
  eu.prototype.o = function() {
    eu.j.o.call(this);
    this.f.na();
    this.c.F();
    delete this.c;
    delete this.L;
    delete this.D;
    x.clearTimeout(this.ea);
  };
  var fu = { FASTGRID: 0, GRID: 1, DYNAMICGRID: 2 };
  eu.Strategy = fu;
  eu.prototype.R = function() {
    this.dispatchEvent("start");
    this.c.Ei(this.aa, ld);
  };
  function gu(a2, b2, c2) {
    a2.ea && x.clearTimeout(a2.ea);
    b2 && a2.c.U(b2, c2);
    a2.ea = x.setTimeout(a2.R, 150);
  }
  eu.prototype.aa = function(a2) {
    this.L = a2;
    hu(this);
    this.dispatchEvent("end");
  };
  eu.prototype.Hc = function(a2) {
    this.c.Hc(a2);
    gu(this);
  };
  eu.prototype.setDataPoints = eu.prototype.Hc;
  eu.prototype.Db = function(a2) {
    this.c.Db(a2);
    gu(this);
  };
  eu.prototype.addDataPoint = eu.prototype.Db;
  eu.prototype.mf = function(a2) {
    this.c.mf(a2);
    gu(this);
  };
  eu.prototype.addDataPoints = eu.prototype.mf;
  eu.prototype.We = function(a2) {
    this.c.We(a2);
    gu(this);
  };
  eu.prototype.removeDataPoint = eu.prototype.We;
  eu.prototype.Zm = function() {
    return this.D;
  };
  eu.prototype.getTheme = eu.prototype.Zm;
  eu.prototype.zo = function(a2) {
    this.D = a2;
    this.L && (this.f.na(), hu(this));
  };
  eu.prototype.setTheme = eu.prototype.zo;
  function hu(a2) {
    var b2 = a2.L.clusters, c2 = a2.L.noisePoints, d = b2.length, e = c2.length, f2 = 0 < d + e;
    for (a2.f.na(); e--; ) {
      var g = c2[e];
      a2.f.fa(a2.D.getNoisePresentation(g));
    }
    for (; d--; )
      c2 = b2[d], a2.f.fa(a2.D.getClusterPresentation(c2));
    f2 && a2.Va();
  }
  eu.prototype.Qb = function() {
    return true;
  };
  eu.prototype.providesDomMarkers = eu.prototype.Qb;
  eu.prototype.Rb = function() {
    return true;
  };
  eu.prototype.providesMarkers = eu.prototype.Rb;
  eu.prototype.Cc = function() {
    return true;
  };
  eu.prototype.providesSpatials = eu.prototype.Cc;
  eu.prototype.Ue = function(a2, b2) {
    gu(this, a2, b2);
  };
  eu.prototype.preprocessData = eu.prototype.Ue;
  t("H.clustering.buildInfo", function() {
    return Hf("H-clustering", "1.49.1", "74e5afb", { region: "row" });
  });
  function iu(a2, b2) {
    a: {
      for (var c2 = a2.length, d = "string" === typeof a2 ? a2.split("") : a2, e = 0; e < c2; e++)
        if (e in d && b2.call(void 0, d[e], e, a2)) {
          b2 = e;
          break a;
        }
      b2 = -1;
    }
    return 0 > b2 ? null : "string" === typeof a2 ? a2.charAt(b2) : a2[b2];
  }
  var ju = {};
  function ku(a2) {
    var b2 = a2.ownerDocument, c2 = b2.documentElement;
    b2 = b2.defaultView;
    var d = a2.getBoundingClientRect();
    a2 = d.left;
    d = d.top;
    isNaN(b2.pageXOffset) ? (a2 += c2.scrollLeft, d += c2.scrollTop) : (a2 += b2.pageXOffset, d += b2.pageYOffset);
    return new J(a2, d);
  }
  function lu(a2, b2, c2) {
    b2 = Fc(b2) ? b2 + "px" : b2;
    c2 = Fc(c2) ? c2 + "px" : c2;
    a2.style[Af("transform")] = "translate(" + b2 + "," + c2 + ")";
  }
  var mu, nu = navigator.userAgent, ou = -1 < nu.indexOf("Android") && -1 < nu.indexOf("Mozilla/5.0") && -1 < nu.indexOf("AppleWebKit"), pu = /AppleWebKit\/([\d.]+)/, qu = null === pu.exec(nu) ? null : parseFloat(pu.exec(nu)[1]);
  mu = ou && null !== qu && 537 > qu;
  var ru = globalThis, su = document.createElement("T");
  function tu() {
    this.a = this.lj();
  }
  tu.prototype.lj = function() {
    var a2 = navigator, b2 = [];
    a2 && (a2.msPointerEnabled ? b2.push(uu) : a2.pointerEnabled && b2.push(vu));
    1 > b2.length && ("TouchEvent" in ru && b2.push(wu), b2.push(xu));
    return b2;
  };
  tu.prototype.detectEventSets = tu.prototype.lj;
  tu.prototype.addEventListener = function(a2, b2, c2, d) {
    for (var e = this.a, f2, g = e.length, h = false; g--; )
      if (f2 = e[g][b2])
        h = true, a2.addEventListener(f2, c2, d || false);
    h || a2.addEventListener(b2, c2, d || false);
  };
  tu.prototype.removeEventListener = function(a2, b2, c2, d) {
    for (var e = this.a, f2, g = e.length, h = false; g--; )
      if (f2 = e[g][b2])
        h = true, a2.removeEventListener(f2, c2, d || false);
    h || a2.removeEventListener(b2, c2, d || false);
  };
  var vu = { start: "pointerdown", end: "pointerup", move: "pointermove", cancel: "pointercancel", over: "pointerover", out: "pointerout", hover: "pointerhover" }, uu = { start: "MSPointerDown", end: "MSPointerUp", move: "MSPointerMove", cancel: "MSPointerCancel", over: "MSPointerOver", out: "MSPointerOut", hover: "MSPointerHover" }, wu = { start: "touchstart", end: "touchend", move: "touchmove", cancel: "touchcancel" }, xu = { start: "mousedown", end: "mouseup", move: "mousemove", over: "mouseover", out: "mouseout", hover: "mousehover" };
  function yu(a2, b2, c2, d) {
    a2 = a2.createElement(b2);
    c2 && (a2.className = c2);
    d && (a2.innerHTML = d);
    return a2;
  }
  function zu(a2, b2) {
    for (var c2 = 1, d = arguments.length; c2 < d; c2++)
      a2.appendChild(arguments[c2]);
  }
  var Au = new tu();
  function Bu(a2, b2, c2) {
    Au.addEventListener(a2, b2, c2, void 0);
  }
  function Cu(a2, b2, c2) {
    Au.removeEventListener(a2, b2, c2, void 0);
  }
  ;
  function Y(a2, b2) {
    F.call(this);
    this.ab = a2 || "div";
    this.f = b2 ? b2.split(" ") : [];
    this.L = false;
    this.f.push("H_el");
  }
  u(Y, F);
  t("H.ui.base.Element", Y);
  Y.prototype.W = function(a2) {
    if (!a2)
      throw Error("Wrong document object");
    this.S = yu(a2, this.ab, this.f.join(" "));
    this.renderInternal(this.S, a2);
    this.va(this.dc(), true);
    this.jc(this.aa);
    this.qb(this.R);
    return this.S;
  };
  Y.prototype.ta = function() {
  };
  Y.prototype.T = function() {
  };
  Y.prototype.X = function() {
  };
  Y.prototype.renderInternal = Y.prototype.X;
  Y.prototype.dc = function() {
    return this.L;
  };
  Y.prototype.isDisabled = Y.prototype.dc;
  Y.prototype.va = function(a2, b2) {
    a2 = !!a2;
    if (a2 !== this.L || b2)
      (this.L = a2) ? this.Ka("H_disabled") : this.kb("H_disabled");
    return this;
  };
  Y.prototype.setDisabled = Y.prototype.va;
  Y.prototype.J = null;
  Y.prototype.getData = function() {
    return this.J;
  };
  Y.prototype.getData = Y.prototype.getData;
  Y.prototype.setData = function(a2) {
    this.J = a2;
  };
  Y.prototype.setData = Y.prototype.setData;
  Y.prototype.jc = function(a2) {
    var b2 = this.N();
    this.aa = a2;
    b2 && (a2 ? b2.setAttribute("title", a2) : b2.removeAttribute("title"));
  };
  Y.prototype.setTooltip = Y.prototype.jc;
  Y.prototype.S = null;
  Y.prototype.N = function() {
    return this.S;
  };
  Y.prototype.getElement = Y.prototype.N;
  Y.prototype.R = true;
  Y.prototype.qb = function(a2) {
    var b2 = this.N();
    this.R = a2;
    b2 && (b2.style.display = a2 ? "" : "none");
  };
  Y.prototype.setVisibility = Y.prototype.qb;
  Y.prototype.wc = function() {
    return this.R;
  };
  Y.prototype.getVisibility = Y.prototype.wc;
  Y.prototype.Ka = function(a2) {
    var b2 = this.N();
    0 > this.f.indexOf(a2) && this.f.push(a2);
    b2 && (b2.className = this.f.join(" "));
    return this;
  };
  Y.prototype.addClass = Y.prototype.Ka;
  Y.prototype.kb = function(a2) {
    a2 = this.f.indexOf(a2);
    var b2 = this.N();
    -1 < a2 && this.f.splice(a2, 1);
    b2 && (b2.className = this.f.join(" "));
    return this;
  };
  Y.prototype.removeClass = Y.prototype.kb;
  function Du(a2) {
    (a2 = a2.N()) && a2.parentNode && a2.parentNode.removeChild(a2);
  }
  Y.prototype.o = function() {
    Y.j.o.call(this);
    Du(this);
    this.J = this.S = null;
    delete this.aa;
  };
  function Eu(a2) {
    a2 = a2 || {};
    Y.call(this, "div", "H_btn");
    this.Jc(a2.label || " ");
    this.jc(a2.tooltip || "");
    this.setData(a2.data);
    this.va(!!a2.disabled);
    this.O(Fu.UP, true);
    a2.onStateChange && this.addEventListener("statechange", a2.onStateChange);
    this.b = A(this.b, this);
    this.a = A(this.a, this);
  }
  u(Eu, Y);
  t("H.ui.base.Button", Eu);
  Eu.prototype.va = function(a2, b2) {
    a2 && this.kb("H_active");
    return Eu.j.va.call(this, a2, b2);
  };
  Eu.prototype.setDisabled = Eu.prototype.va;
  Eu.prototype.X = function(a2) {
    Bu(a2, "start", this.b);
    Bu(a2, "end", this.a);
    Bu(a2, "out", this.a);
    this.Jc(this.Ge(), true);
  };
  Eu.prototype.renderInternal = Eu.prototype.X;
  Eu.prototype.getState = function() {
    return this.C;
  };
  Eu.prototype.getState = Eu.prototype.getState;
  Eu.prototype.O = function(a2, b2) {
    a2 !== this.C && (this.C = a2, a2 === Fu.DOWN ? this.Ka("H_active") : this.kb("H_active"), b2 || this.dispatchEvent("statechange"));
    return this;
  };
  Eu.prototype.setState = Eu.prototype.O;
  Eu.prototype.Ge = function() {
    return this.c;
  };
  Eu.prototype.getLabel = Eu.prototype.Ge;
  Eu.prototype.Jc = function(a2, b2) {
    if (b2 || a2 !== this.c) {
      if (this.c = a2, b2 = this.N())
        b2.innerHTML = a2;
    }
    return this;
  };
  Eu.prototype.setLabel = Eu.prototype.Jc;
  Eu.prototype.b = function(a2) {
    this.dc() || this.O(Fu.DOWN);
    a2.preventDefault();
  };
  Eu.prototype.a = function(a2) {
    this.dc() || this.O(Fu.UP);
    a2.preventDefault();
  };
  Eu.prototype.o = function() {
    var a2 = this.N();
    a2 && (Cu(a2, "start", this.b), Cu(a2, "end", this.a), Cu(a2, "out", this.a));
    Y.prototype.o.call(this);
  };
  var Fu = { UP: "up", DOWN: "down" };
  Eu.State = Fu;
  var Gu = { "in": '<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g><path d="m5 10.6h5.6v-5.6h2.8v5.6h5.6v2.8h-5.6v5.6h-2.8v-5.6h-5.6v-2.8z"></path></g></svg>', out: '<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><path d="m5 10.6h14v2.8h-14z"/></svg>' };
  function Hu(a2) {
    a2 = a2 || {};
    var b2;
    this.b = !!a2.vertical;
    this.ea = a2.length || "16em";
    this.a = Fc(b2 = a2.min) ? b2 : 0;
    this.i = zd(this.a, Fc(b2 = a2.max) ? b2 : 100);
    this.wa = E(b2 = a2.step) ? 1 : b2;
    this.l = Iu(this, Fc(b2 = a2.value) ? b2 : (this.a + this.i) / 2);
    this.ag = A(this.ag, this);
    this.Wf = A(this.Wf, this);
    this.cg = A(this.cg, this);
    this.bg = A(this.bg, this);
    this.s = a2.pointerArea;
    Y.call(this, "div", "H_slider" + (this.b ? "" : " H_l_horizontal"));
  }
  u(Hu, Y);
  t("H.ui.base.Slider", Hu);
  Hu.prototype.wg = function(a2, b2) {
    var c2 = this.b, d = c2 ? "top" : "left";
    if (!this.c || b2)
      a2 = ae(a2, this.a, this.i), this.g && (b2 = 100 * (a2 - this.a) / (this.i - this.a), c2 = (c2 ? -1 : 1) * b2, this.g.style[d] = c2 + "%", this.qa.style[d] = 100 + c2 + "%"), this.l = Iu(this, a2);
    return this.l;
  };
  Hu.prototype.setValue = Hu.prototype.wg;
  Hu.prototype.en = function() {
    return this.l;
  };
  Hu.prototype.getValue = Hu.prototype.en;
  function Ju(a2) {
    if (!a2.m) {
      Bu(a2.N(), "start", a2.ag);
      var b2 = a2.s;
      Bu(b2, "move", a2.Wf);
      Bu(b2, "end", a2.cg);
      Bu(b2, "out", a2.bg);
      a2.m = true;
    }
  }
  function Ku(a2) {
    if (a2.m) {
      Cu(a2.N(), "start", a2.ag);
      var b2 = a2.s;
      Cu(b2, "move", a2.Wf);
      Cu(b2, "end", a2.cg);
      Cu(b2, "out", a2.bg);
      a2.m = false;
    }
  }
  function Iu(a2, b2) {
    var c2 = a2.wa;
    b2 = ae(b2, a2.a, a2.i);
    return c2 ? a2.a + Ad((b2 - a2.a) / c2) * c2 : b2;
  }
  function Lu(a2, b2) {
    var c2 = a2.D, d = a2.b;
    a2.u || (a2.u = c2["offset" + (d ? "Height" : "Width")]);
    b2 -= ku(c2)[d ? "y" : "x"];
    0 > b2 && (b2 = 0);
    b2 = (a2.i - a2.a) * b2 / a2.u;
    b2 = Iu(a2, d ? a2.i - b2 : a2.a + b2);
    a2.l !== b2 && (a2.wg(b2, true), a2.dispatchEvent(new cj(a2.A.ed, b2, a2.l)));
  }
  function Mu(a2, b2) {
    return (b2.touches ? b2.targetTouches[0] : b2)["page" + (a2.b ? "Y" : "X")];
  }
  function Nu(a2) {
    var b2 = false, c2 = a2.type;
    -1 !== c2.indexOf("pointer") || -1 !== c2.indexOf("touch") ? b2 = true : C(a2, MouseEvent) && (b2 = 1 === a2.which || 1 === a2.buttons);
    return b2;
  }
  function Ou(a2) {
    var b2 = a2.touches;
    return b2 && 1 === b2.length || C(a2, MouseEvent);
  }
  p = Hu.prototype;
  p.ag = function(a2) {
    var b2 = this.b;
    if (Nu(a2) && Ou(a2)) {
      var c2 = Mu(this, a2);
      var d = a2.target;
      d === this.g || d.parentElement === this.g ? (this.P = c2 - ku(this.g)[b2 ? "y" : "x"] - this.g.offsetWidth / 2, this.N().className = "H_slider H_slider_active" + (this.b ? "" : " H_l_horizontal"), this.c = true) : Lu(this, c2);
      a2.preventDefault();
    }
  };
  p.cg = function() {
    this.c && (this.N().className = "H_slider " + (this.b ? "" : " H_l_horizontal"), this.c = false);
  };
  p.bg = function(a2) {
    this.c && a2.target === this.s && (this.c = false);
  };
  p.Wf = function(a2) {
    this.c && Ou(a2) && (Nu(a2) ? (Lu(this, Mu(this, a2) - this.P), a2.preventDefault()) : this.c = false);
  };
  p.A = { ed: "change" };
  p.X = function(a2, b2) {
    var c2 = yu(b2, "div", "H_slider_cont"), d = yu(b2, "div", "H_slider_knob_cont"), e = yu(b2, "div", "H_slider_knob"), f2 = yu(b2, "div", "H_slider_knob_halo"), g = yu(b2, "div", "H_slider_track");
    b2 = yu(b2, "div", "H_slider_track H_slider_track_active");
    a2.appendChild(c2);
    c2.appendChild(g);
    g.appendChild(b2);
    c2.appendChild(d);
    d.appendChild(e);
    d.appendChild(f2);
    this.D = g;
    this.qa = b2;
    this.g = d;
    this.s || (this.s = a2.ownerDocument.body);
    c2.style[this.b ? "height" : "width"] = this.ea;
    this.wg(this.l);
    Ju(this);
  };
  Hu.prototype.renderInternal = Hu.prototype.X;
  Hu.prototype.o = function() {
    Ku(this);
  };
  Hu.prototype.va = function(a2, b2) {
    a2 ? Ku(this) : this.D && Ju(this);
    return Y.prototype.va.call(this, a2, b2);
  };
  Hu.prototype.setDisabled = Hu.prototype.va;
  var Pu = { TOP_LEFT: "top-left", TOP_CENTER: "top-center", TOP_RIGHT: "top-right", LEFT_TOP: "left-top", LEFT_MIDDLE: "left-middle", LEFT_BOTTOM: "left-bottom", RIGHT_TOP: "right-top", RIGHT_MIDDLE: "right-middle", RIGHT_BOTTOM: "right-bottom", BOTTOM_LEFT: "bottom-left", BOTTOM_CENTER: "bottom-center", BOTTOM_RIGHT: "bottom-right" };
  t("H.ui.LayoutAlignment", Pu);
  function Qu(a2, b2, c2) {
    Y.call(this, a2, b2);
    this.a = c2 ? c2.concat() : [];
  }
  u(Qu, Y);
  t("H.ui.base.Container", Qu);
  Qu.prototype.va = function(a2, b2) {
    var c2 = this.a ? this.a.length : 0;
    for (Y.prototype.va.call(this, a2, b2); c2--; )
      this.a[c2].va(a2, b2);
    return this;
  };
  Qu.prototype.setDisabled = Qu.prototype.va;
  Qu.prototype.Ja = function(a2) {
    var b2 = this.N();
    this.a.push(a2);
    b2 && (a2.W(b2.ownerDocument), b2.appendChild(a2.N()));
    return this;
  };
  Qu.prototype.addChild = Qu.prototype.Ja;
  Qu.prototype.dh = function() {
    return this.a.concat();
  };
  Qu.prototype.getChildren = Qu.prototype.dh;
  Qu.prototype.removeChild = function(a2) {
    var b2 = this.a.indexOf(a2), c2 = this.N();
    0 <= b2 && (this.a.splice(b2, 1), c2 && c2.removeChild(a2.N()));
  };
  Qu.prototype.removeChild = Qu.prototype.removeChild;
  Qu.prototype.na = function() {
    var a2 = this.N();
    a2 && this.a.forEach(function(b2) {
      a2.removeChild(b2.N());
    });
    this.a = [];
  };
  Qu.prototype.X = function(a2, b2) {
    for (var c2 = 0, d = this.a.length; c2 < d; c2++)
      a2.appendChild(this.a[c2].W(b2));
  };
  Qu.prototype.renderInternal = Qu.prototype.X;
  Qu.prototype.o = function() {
    this.na();
    this.a.forEach(this.qa, this);
    Y.prototype.o.call(this);
  };
  Qu.prototype.qa = function(a2) {
    a2.F();
  };
  function Ru() {
    Qu.call(this, "div", "H_ctl");
    this.map = null;
    this.Mc = "top-left";
  }
  u(Ru, Qu);
  t("H.ui.Control", Ru);
  Ru.prototype.Ia = function(a2) {
    this.map = a2;
  };
  Ru.prototype.W = function(a2) {
    return Qu.prototype.W.call(this, a2);
  };
  Ru.prototype.X = function(a2, b2) {
    Qu.prototype.renderInternal.call(this, a2, b2);
    this.Vb(this.Mc);
  };
  Ru.prototype.renderInternal = Ru.prototype.X;
  Ru.prototype.Qe = function() {
  };
  Ru.prototype.onUnitSystemChange = Ru.prototype.Qe;
  Ru.prototype.Lb = function() {
    return this.map;
  };
  Ru.prototype.getMap = Ru.prototype.Lb;
  Ru.prototype.pa = function() {
    return this.xa;
  };
  Ru.prototype.getLocalization = Ru.prototype.pa;
  Ru.prototype.Ll = function() {
    return this.Mc;
  };
  Ru.prototype.getAlignment = Ru.prototype.Ll;
  Ru.prototype.Vb = function(a2) {
    "string" === typeof a2 && Pu[a2.replace("-", "_").toUpperCase()] === a2 && (this.Mc = a2, this.dispatchEvent("alignmentchange"));
    return this;
  };
  Ru.prototype.setAlignment = Ru.prototype.Vb;
  function Su(a2) {
    a2 = a2 || {};
    var b2 = a2.slider;
    Ru.call(this);
    this.s = A(this.s, this);
    this.g = A(this.g, this);
    this.b = A(this.b, this);
    b2 && (this.u = A(this.u, this), this.D = b2, this.wa = a2.sliderSnaps, this.Ka("H_zoom_slider"));
    this.i = new Eu({ label: Gu["in"], onStateChange: this.s });
    this.m = new Eu({ label: Gu.out, onStateChange: this.s });
    this.Ka("H_zoom");
    this.Ka("H_grp");
    this.ea = false !== a2.fractionalZoom;
    this.setZoomSpeed(a2.zoomSpeed || 4);
    this.Vb(a2.alignment || "right-middle");
  }
  u(Su, Ru);
  t("H.ui.ZoomControl", Su);
  Su.prototype.kn = function() {
    return this.P;
  };
  Su.prototype.getZoomSpeed = Su.prototype.kn;
  Su.prototype.Do = function(a2) {
    this.P = a2;
  };
  Su.prototype.setZoomSpeed = Su.prototype.Do;
  Su.prototype.Ia = function(a2) {
    this.map !== a2 && (this.map && this.map.removeEventListener("mapviewchange", this.g), Tu(this));
    Ru.prototype.Ia.apply(this, arguments);
    this.map && (this.b(), a2.addEventListener("mapviewchange", this.g), a2.addEventListener("baselayerchange", this.b));
  };
  Su.prototype.setMap = Su.prototype.Ia;
  Su.prototype.o = function() {
    Ru.prototype.o.apply(this, arguments);
    this.map.removeEventListener("baselayerchange", this.b);
    Tu(this);
  };
  Su.prototype.X = function(a2, b2) {
    Ru.prototype.renderInternal.call(this, a2, b2);
    this.i.jc(this.pa().translate("zoom.in"));
    this.m.jc(this.pa().translate("zoom.out"));
  };
  Su.prototype.renderInternal = Su.prototype.X;
  Su.prototype.Vb = function(a2) {
    var b2 = this.Mc;
    Ru.prototype.Vb.call(this, a2);
    b2 !== a2 && this.b();
    return this;
  };
  Su.prototype.setAlignment = Su.prototype.Vb;
  Su.prototype.g = function() {
    var a2 = this.map, b2 = a2.pb(), c2 = a2.Xa() - 1;
    a2 = a2.g || a2.f.getCapabilities().lookAt.zoom;
    this.D && this.c.wg(b2);
    this.dc() || (this.i.va(b2 + c2 >= a2.max), this.m.va(b2 <= a2.min));
  };
  Su.prototype.va = function(a2, b2) {
    Su.j.va.call(this, a2, b2);
    this.g();
    return this;
  };
  Su.prototype.setDisabled = Su.prototype.va;
  function Tu(a2) {
    a2.removeChild(a2.c);
    a2.c = null;
    a2.l && (a2.l.removeEventListener("minchange", a2.b), a2.l.removeEventListener("maxchange", a2.b), a2.l = null);
  }
  Su.prototype.s = function(a2) {
    a2 = a2.target;
    var b2 = a2 === this.i ? 1 : -1, c2 = 0 < b2 ? Math.ceil : Math.floor, d = this.map, e, f2 = this;
    d && ("down" === a2.getState() ? (d.c.startControl(), d.c.control(0, 0, b2 * this.P, 0, 0, 0)) : d.c.endControl(true, function(g) {
      e = f2.ea ? g.zoom : c2(g.zoom);
      g.zoom = e;
    }));
  };
  Su.prototype.u = function(a2) {
    this.map && this.map.df(a2.newValue);
  };
  Su.prototype.b = function() {
    var a2 = this.Mc, b2 = this.Lb();
    if (/^top/g.test(a2) || /^bottom/g.test(a2)) {
      var c2 = this.m;
      a2 = this.i;
      var d = false;
    } else
      c2 = this.i, a2 = this.m, d = true;
    this.removeChild(c2);
    this.removeChild(a2);
    this.Ja(c2);
    if (this.D && b2) {
      Tu(this);
      b2 = d;
      var e = (d = (c2 = this.map) && c2.g) || c2.f.getCapabilities().lookAt.zoom;
      if (this.l = d)
        d.addEventListener("minchange", this.b), d.addEventListener("maxchange", this.b);
      this.c = new Hu({ step: this.wa ? 1 : 0, vertical: b2, min: e.min, max: e.max, value: c2.pb(), pointerArea: c2.N() });
      this.c.addEventListener(
        this.c.A.ed,
        this.u
      );
      this.Ja(this.c);
    }
    this.Ja(a2);
  };
  function Uu(a2, b2) {
    var c2 = {}, d = {};
    c2["top-left"] = yu(b2, "div", [Vu, Wu].join(" "));
    c2["top-center"] = yu(b2, "div", [Vu, Xu, Yu, Wu].join(" "));
    c2["top-right"] = yu(b2, "div", [Vu, Wu].join(" "));
    c2["left-top"] = yu(b2, "div", [Vu, Zu].join(" "));
    c2["left-middle"] = yu(b2, "div", [Vu, $u, av, Zu].join(" "));
    c2["left-bottom"] = yu(b2, "div", [Vu, Zu].join(" "));
    c2["right-top"] = yu(b2, "div", [Vu, Zu].join(" "));
    c2["right-middle"] = yu(b2, "div", [Vu, bv, av, Zu].join(" "));
    c2["right-bottom"] = yu(b2, "div", [Vu, Zu].join(" "));
    c2["bottom-left"] = yu(b2, "div", [Vu, Wu].join(" "));
    c2["bottom-center"] = yu(b2, "div", [Vu, cv, Yu, Wu].join(" "));
    c2["bottom-right"] = yu(b2, "div", [Vu, Wu].join(" "));
    d["top-left"] = yu(b2, "div", [Xu, $u].join(" "));
    d["top-right"] = yu(b2, "div", [Xu, bv].join(" "));
    d["bottom-left"] = yu(b2, "div", [cv, $u].join(" "));
    d["bottom-right"] = yu(b2, "div", [cv, bv].join(" "));
    zu(d["top-left"], c2["top-left"], c2["left-top"]);
    zu(d["top-right"], c2["top-right"], c2["right-top"]);
    zu(d["bottom-left"], c2["left-bottom"], c2["bottom-left"]);
    zu(d["bottom-right"], c2["right-bottom"], c2["bottom-right"]);
    zu(
      a2,
      d["top-left"],
      d["top-right"],
      d["bottom-left"],
      d["bottom-right"],
      c2["top-center"],
      c2["left-middle"],
      c2["right-middle"],
      c2["bottom-center"]
    );
    this.a = c2;
  }
  var Xu = "H_l_top", cv = "H_l_bottom", $u = "H_l_left", bv = "H_l_right", Yu = "H_l_center", av = "H_l_middle", Wu = "H_l_horizontal", Zu = "H_l_vertical", Vu = "H_l_anchor";
  Uu.prototype.update = function() {
    var a2 = this.a;
    dv(a2["top-center"], true);
    dv(a2["bottom-center"], true);
    dv(a2["left-middle"], false);
    dv(a2["right-middle"], false);
  };
  function dv(a2, b2) {
    b2 ? (b2 = a2.offsetWidth, a2.style.marginLeft = -Math.round(0.5 * b2) + "px") : (b2 = a2.offsetHeight, a2.style.marginTop = -Math.round(0.5 * b2) + "px");
  }
  Uu.prototype.put = function(a2, b2) {
    a2 = a2 ? a2.N() : null;
    var c2 = b2 ? this.a[b2] : null;
    a2 && c2 && (a2.parentElement && a2.parentElement.removeChild(a2), c2.insertBefore(a2, /(bottom|right)$/.test(b2) || /(center|middle)/.test(b2) && c2.childNodes.length % 2 ? c2.firstChild : null));
    this.update();
  };
  var ev = { IMPERIAL: "imperial", METRIC: "metric" };
  t("H.ui.UnitSystem", ev);
  var fv = {
    btn: '<svg class="H_icon" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><g transform="translate(3 2)"><path d="m18 13v7h-18v-7h2v5h2v-2h2v2h2v-3h2v3h2v-2h2v2h2v-5z"></path><path d="m2.3.3c.7 0 1.3.1 1.8.4s.9.6 1.1 1 .4.9.4 1.4c0 .5-.1 1-.3 1.4s-.57 1-1 1.6-1.3 1.3-2.3 2.2h3.9l-.2 1.7h-6.16v-1.6c1.1-1.1 2-2 2.5-2.6s.9-1 1-1.4.3-.8.3-1.2c0-.4-.1-.7-.3-.9s-.5-.3-.9-.3c-.3 0-.6 0-.9.2s-.5.4-.8.7l-1.3-1c.4-.5.9-.9 1.4-1.2s1.2-.4 1.8-.4zm14.4 9.7h-2.3l-.2-3.8c 0-.9-.1-1.7-.1-2.4 0-.5 0-1 0-1.5l-1.5 6.7h-2.2l-1.6-6.7c.1.8.1 1.6.1 2.3 0 .5 0 1.1 0 1.7l-.2 3.8h-2.2l.7-9.7h2.9l1.5 6.6 1.4-6.6h2.9z"></path></g></g></svg>',
    point: '<svg height="22" viewBox="0 0 12 12" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m6 12c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6z" fill="#fff"></path><path d="m6 10c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z" fill="#2ed5c9" stroke="#272c36" stroke-width="2"></path></g></svg>'
  };
  function gv(a2) {
    Eu.call(this, a2);
    this.i = function(b2) {
      b2.preventDefault();
    };
    this.g = A(function(b2) {
      this.dc() || this.toggleState();
      b2.preventDefault();
    }, this);
  }
  u(gv, Eu);
  t("H.ui.base.PushButton", gv);
  gv.prototype.X = function(a2) {
    Bu(a2, "start", this.g);
    Bu(a2, "end", this.i);
    this.Jc(this.Ge(), true);
  };
  gv.prototype.renderInternal = gv.prototype.X;
  gv.prototype.Lo = function() {
    var a2 = Fu.DOWN;
    this.O(this.getState() === a2 ? Fu.UP : a2);
    return this;
  };
  gv.prototype.toggleState = gv.prototype.Lo;
  gv.prototype.o = function() {
    var a2 = this.N();
    a2 && Cu(a2, "start", this.g);
    Eu.prototype.o.call(this);
  };
  function hv(a2, b2, c2) {
    bj.call(this, a2, { icon: iv, visibility: c2 });
    jv(this, b2);
  }
  u(hv, bj);
  function jv(a2, b2) {
    a2.zn = b2;
    a2.S && (a2.S.textContent = b2);
  }
  var iv = new Ti(yu(ru.document, "span", "H_dm_label"), { onAttach: function(a2, b2, c2) {
    c2.S = a2;
    jv(c2, c2.zn);
  }, onDetach: function(a2, b2, c2) {
    delete c2.S;
  } });
  function kv(a2, b2) {
    F.call(this);
    this.b = a2;
    this.f = new hv(this.Jo, "");
    b2.push(this.f);
    this.a = new R({ objects: b2, data: this });
    this.ug = this.ug.bind(this);
  }
  u(kv, F);
  p = kv.prototype;
  p.Wc = false;
  p.Jo = { lat: 0, lng: 0 };
  p.Jc = function(a2, b2) {
    jv(this.f, a2);
    this.f.da(b2);
  };
  p.Rh = 0;
  p.ug = function() {
    this.f.qb(this.m);
  };
  function lv(a2, b2) {
    b2 && (a2.nextSibling = b2, b2.previousSibling = a2);
  }
  ;
  function mv(a2, b2, c2, d) {
    var e = new L(), f2 = [];
    lv(a2, this);
    lv(this, b2);
    e.qd(a2.ya());
    e.qd(b2.ya());
    this.c = new th(e, { style: c2.Wd });
    this.i = new th(e, { style: { strokeColor: "transparent", lineWidth: Math.min(100, this.c.V().lineWidth + 2 * (d || 5)) } });
    c2.c && (this.g = new th(e, { style: c2.c }), f2.push(this.g));
    f2.push(this.c, this.i);
    kv.call(this, c2, f2);
    this.s = this.l = -1;
    a2 = this.a;
    a2.addEventListener("pointermove", this.J, true, this);
    a2.addEventListener("pointerleave", this.u, true, this);
  }
  u(mv, kv);
  mv.prototype.Ee = function() {
    var a2 = this.c.ga();
    return a2.ye(0).Wa(a2.ye(1));
  };
  function nv(a2, b2, c2) {
    var d = a2.c.ga();
    d.ff(3 * +c2, 3, [b2.lat, b2.lng, 0]);
    a2.g && a2.g.da(d);
    a2.i.da(d);
    a2.c.da(d);
  }
  mv.prototype.J = function(a2) {
    var b2 = a2.currentPointer;
    a2 = this.previousSibling.ya();
    var c2 = this.nextSibling.ya(), d = this.b.f, e = b2.viewportX;
    b2 = b2.viewportY;
    if (this.l !== e || this.s !== b2)
      this.l = e, this.s = b2, d.da(this.b.g(a2, c2, { x: e, y: b2 })), d.qb(true);
  };
  mv.prototype.u = function() {
    this.b.f.qb();
  };
  mv.prototype.ni = function() {
    this.Jc(this.b.a(this.Ee()), this.c.K().bb());
  };
  function ov(a2, b2, c2) {
    c2 = b2.b(c2 || 0);
    this.c = new Rn(a2, { icon: c2, zIndex: 0 });
    this.c.draggable = true;
    kv.call(this, b2, [this.c]);
    a2 = this.a;
    a2.addEventListener("dragstart", this.Qn, true, this);
    a2.addEventListener("drag", this.Rn, true, this);
    a2.addEventListener("dragend", this.Pn, true, this);
  }
  u(ov, kv);
  p = ov.prototype;
  p.hk = 0;
  p.A = { ed: "change" };
  p.Ee = function() {
    return this.hk;
  };
  p.ya = function() {
    return this.c.ga();
  };
  function pv(a2) {
    var b2 = 0;
    a2.nextSibling && a2.previousSibling && (a2.nextSibling.Wc || a2.previousSibling.Wc ? a2.nextSibling.Wc && !a2.previousSibling.Wc && (b2 = 2) : b2 = 1);
    b2 = a2.b.b(b2);
    a2.c.Ic(b2);
  }
  p.Rn = function(a2) {
    var b2 = a2.currentPointer;
    a2 = b2.viewportX;
    b2 = b2.viewportY;
    if (this.i !== a2 || this.l !== b2)
      this.i = a2, this.l = b2, this.c.da(this.b.map.Pa(a2 - this.g.x, b2 - this.g.y)), this.dispatchEvent(new ud(this.A.ed, this));
  };
  p.Qn = function(a2) {
    var b2 = a2.currentPointer, c2 = b2.viewportX;
    b2 = b2.viewportY;
    var d = this.b.map.Da(this.ya());
    this.c.fe(1);
    this.g = { x: c2 - d.x, y: b2 - d.y };
    a2.stopPropagation();
  };
  p.Pn = function() {
    this.c.fe(0);
  };
  p.ni = function(a2) {
    this.hk = a2;
    this.Jc(this.b.a(a2), this.ya());
  };
  function qv(a2, b2) {
    this.Ca = b2;
    this.b = a2;
    this.a = { Wc: true };
    rv(this, this.a);
    this.$f = A(this.$f, this);
  }
  t("H.ui.distanceMeasurement.Model", qv);
  p = qv.prototype;
  p.Rf = function() {
    return this.a.nextSibling === this.a;
  };
  function sv(a2, b2) {
    a2 = a2.a;
    for (var c2 = a2.nextSibling; c2 !== a2; ) {
      var d = c2, e = c2.previousSibling === a2 ? false : b2;
      (d.m = e) ? d.ug() : (d.Rh && x.clearTimeout(d.Rh), d.Rh = x.setTimeout(d.ug, 100));
      c2 = c2.nextSibling;
    }
  }
  function tv(a2, b2) {
    var c2 = b2 || a2.a.nextSibling, d = 0, e = 0;
    if (b2 && !uv(a2, b2))
      throw new D(a2.Xe, 0, b2);
    c2 instanceof ov ? d = c2.Ee() : c2 instanceof mv && (d = c2.previousSibling.Ee());
    for (b2 = c2; b2 && b2 !== a2.a; b2 = b2.nextSibling, e++)
      b2.ni(d), 1 === e % 2 && (d += b2.Ee());
  }
  p.ne = function(a2) {
    var b2 = this.a.previousSibling, c2 = this.Rf();
    a2 = new ov(a2, this.Ca, c2 ? 0 : 2);
    this.b.fa(a2.a);
    lv(a2, this.a);
    a2.addEventListener(a2.A.ed, this.$f);
    c2 ? rv(this, a2) : (vv(this, b2, a2), pv(b2), tv(this, b2));
    return a2;
  };
  p.insertBefore = function(a2, b2) {
    var c2;
    var d = 1;
    if (b2) {
      if (!uv(this, b2))
        throw new D(this.insertBefore, 1, b2);
      if (c2 = b2.previousSibling.Wc)
        d = 0;
      a2 = new ov(a2, this.Ca, d);
      a2.addEventListener(a2.A.ed, this.$f);
      this.b.fa(a2.a);
      c2 ? (c2 = this.a.nextSibling, vv(this, a2, c2), rv(this, a2), b2 = a2, pv(c2)) : (c2 = b2.previousSibling, b2 = c2.previousSibling, d = c2.nextSibling, this.b.Ga(c2.a), vv(this, b2, a2), vv(this, a2, d));
      tv(this, b2);
    } else
      a2 = this.ne(a2);
    return a2;
  };
  p.na = function() {
    rv(this, this.a);
    this.b.na();
  };
  p.Xe = function(a2) {
    var b2 = this.a, c2 = a2.previousSibling, d = a2.nextSibling;
    if (!uv(this, a2))
      throw new D(this.Xe, 0, a2);
    this.b.Ga(a2.a);
    if (c2 === b2) {
      var e = d;
      e !== b2 ? (a2 = e.nextSibling, rv(this, a2), a2.ni(0), pv(a2), tv(this, a2)) : rv(this, this.a);
    } else
      d === b2 ? (e = c2, a2 = e.previousSibling, lv(a2, b2), pv(a2)) : c2 && d && (vv(this, c2.previousSibling, d.nextSibling), this.b.rd([d.a, c2.a]), tv(this, c2.previousSibling));
    e && e !== b2 && this.b.Ga(e.a);
  };
  function uv(a2, b2) {
    for (var c2 = a2.a.nextSibling, d = false; c2 !== a2.a; ) {
      if (c2 === b2) {
        d = true;
        break;
      }
      c2 = c2.nextSibling;
    }
    return d;
  }
  function vv(a2, b2, c2) {
    b2 = new mv(b2, c2, a2.Ca);
    a2.b.fa(b2.a);
  }
  function rv(a2, b2) {
    a2.a.nextSibling = b2;
    b2.previousSibling = a2.a;
  }
  p.$f = function(a2) {
    a2 = a2.target;
    var b2 = a2.previousSibling, c2 = a2.nextSibling, d = a2.ya();
    if (!c2.Wc) {
      nv(c2, d, false);
      var e = a2;
    }
    b2.Wc || (nv(b2, d, true), e = b2.previousSibling);
    tv(this, e);
  };
  function wv(a2) {
    a2 = a2 || {};
    var b2, c2 = a2.lineStyle;
    Ru.call(this);
    this.s = new gv({ label: fv.btn, onStateChange: A(this.Nn, this) });
    this.Ja(this.s);
    if (b2 = a2.distanceFormatter)
      this.oj = b2;
    c2 && (this.Xj = c2, this.sk = B);
    this.Vb(a2.alignment || "right-bottom");
    this.g = {};
    this.g[0] = a2.startIcon;
    this.g[2] = a2.endIcon;
    this.g[1] = a2.stopoverIcon;
    this.g[3] = a2.splitIcon;
  }
  u(wv, Ru);
  t("H.ui.DistanceMeasurement", wv);
  p = wv.prototype;
  p.Qh = ev.METRIC;
  p.Xj = { strokeColor: "rgb(39,44,54)", lineWidth: 5 };
  p.sk = { strokeColor: "white", lineWidth: 7 };
  function xv(a2) {
    var b2 = a2.map, c2, d = {};
    a2.c || (a2.l = new N(), a2.m = new tl(a2.l, { pixelRatio: a2.map.Xa() }), a2.u = c2 = a2.l.bc(), a2.u.Vk(true), c2.addEventListener("dragstart", a2.Ln, true, a2), c2.addEventListener("dragend", a2.ef, true, a2), c2.addEventListener("pointerenter", a2.ef, true, a2), c2.addEventListener("pointerleave", a2.Mn, true, a2), c2.addEventListener("tap", a2.co, true, a2), a2.i = yv(a2), d.a = A(a2.oj, a2), d.b = A(a2.dk, a2), d.g = A(a2.Dj, a2), d.map = a2.map, d.f = a2.i, d.Wd = a2.Xj, d.c = a2.sk, a2.b = new qv(a2.u, d), a2.c = true);
    a2.i && a2.u.fa(a2.i);
    b2.addEventListener("tap", a2.pk, true, a2);
    b2.a.add(a2.m);
  }
  function zv(a2) {
    var b2 = a2.map;
    a2.c && (b2.removeEventListener("tap", a2.pk, true, a2), b2.ae(a2.m), a2.b.na());
  }
  function yv(a2) {
    function b2() {
      var h = c2.yb();
      h = { anchor: c2.kd().clone().scale(f2).floor(), size: new Wi(Bd(h.w * f2), Bd(h.h * f2)), hitArea: d };
      return new Wj(c2.Qc(), h);
    }
    var c2 = a2.dk(3), d = new Xi(Yi.NONE, []), e, f2 = c2 === a2.D ? 0.5 : 1;
    if (1 === c2.getState())
      var g = b2();
    else
      g = new Wj("<svg/>", { hitArea: d }), c2.addEventListener("statechange", function() {
        1 === c2.getState() && e.Ic(b2());
      });
    return e = new Rn(a2.map.bb(), { visibility: false, icon: g });
  }
  p.oj = function(a2) {
    var b2 = "m", c2 = 0;
    "metric" === this.Qh ? 1e3 <= a2 && (a2 /= 1e3, b2 = "km", c2 = 1) : (a2 /= 0.3048, b2 = "ft", 5280 <= a2 && (a2 /= 5280, b2 = "mi", c2 = 1));
    return a2.toFixed(c2) + " " + this.pa().translate("scale." + b2);
  };
  p.Dj = function(a2, b2, c2) {
    var d = this.map.Da(a2);
    b2 = this.map.Da(b2);
    c2 = new J(c2.x, c2.y).Cj(d, b2);
    return this.map.Pa(c2.x, c2.y) || ng(a2);
  };
  p.X = function(a2, b2) {
    var c2 = 22 * (this.map.f.type === kk.P2D ? this.map.Xa() : 1), d = c2 / 2;
    Ru.prototype.renderInternal.call(this, a2, b2);
    this.Qh = ev.METRIC;
    this.D = new Wj(fv.point, { anchor: { x: d, y: d }, size: { w: c2, h: c2 }, hitArea: new Xi(Yi.CIRCLE, [d, d, d]) });
    this.s.jc(this.pa().translate("distance.measurement"));
  };
  wv.prototype.renderInternal = wv.prototype.X;
  p = wv.prototype;
  p.dk = function(a2) {
    return this.g[a2] || this.D;
  };
  p.ef = function() {
    sv(this.b, true);
  };
  p.Ln = function() {
    sv(this.b);
  };
  p.Mn = function(a2) {
    "touch" !== a2.currentPointer.type && sv(this.b);
  };
  p.co = function(a2) {
    var b2 = a2.currentPointer;
    var c2 = a2.target.Fa;
    var d;
    c2 && (c2 = c2.getData()) instanceof kv && (d = c2);
    c2 = d;
    a2 = a2.originalEvent;
    a2 = a2.metaKey || a2.altKey;
    c2 && (a2 && c2 instanceof ov ? this.b.Xe(c2) : c2 instanceof mv && (a2 = c2.previousSibling.ya(), d = c2.nextSibling.ya(), b2 = { x: b2.viewportX, y: b2.viewportY }, this.b.insertBefore(this.Dj(a2, d, b2), c2.nextSibling), this.i.qb()), this.ef());
  };
  p.pk = function(a2) {
    var b2 = a2.currentPointer;
    a2 = a2.target;
    a2 !== this.map && a2.getProvider && a2.getProvider() === this.l || (this.b.ne(this.map.Pa(b2.viewportX, b2.viewportY)), this.i.qb(), this.ef());
  };
  p.Nn = function(a2) {
    "down" === a2.target.getState() ? xv(this) : zv(this);
  };
  p.Qe = function(a2) {
    this.Qh = a2;
    this.c && (tv(this.b), this.ef());
  };
  wv.prototype.onUnitSystemChange = wv.prototype.Qe;
  wv.prototype.o = function() {
    zv(this);
    this.c && (this.l.F(), this.m.F());
    wv.j.o.call(this);
  };
  wv.prototype.Ia = function(a2) {
    a2 ? this.s.getState() === Fu.DOWN && (this.map = a2, xv(this)) : (zv(this), this.c = false);
    Ru.prototype.Ia.apply(this, arguments);
  };
  wv.prototype.setMap = wv.prototype.Ia;
  function Av() {
    this.C = Bv.CLOSED;
    Qu.call(this, "div", "H_overlay");
  }
  u(Av, Qu);
  t("H.ui.base.OverlayPanel", Av);
  Av.prototype.O = function(a2, b2) {
    if (a2 !== this.C || b2)
      this.C = a2, a2 === Bv.OPEN ? this.Ka("H_open") : this.kb("H_open");
    return this;
  };
  Av.prototype.setState = Av.prototype.O;
  Av.prototype.getState = function() {
    return this.C;
  };
  Av.prototype.getState = Av.prototype.getState;
  Av.prototype.xk = function(a2) {
    var b2 = a2.Mc;
    a2 = a2.N();
    var c2 = this.N(), d = c2.style;
    this.kb("H_top");
    this.kb("H_middle");
    this.kb("H_bottom");
    this.kb("H_left");
    this.kb("H_center");
    this.kb("H_right");
    d.bottom = d.top = d.left = d.right = d.margin = "";
    if (/top/g.test(b2)) {
      this.Ka("H_top");
      d.top = "0";
      d.margin = "0 12px";
      var e = -1;
    } else
      /bottom/g.test(b2) ? (this.Ka("H_bottom"), d.bottom = "0", d.margin = "0 12px", e = 1) : (this.Ka("H_middle"), d.top = "50%", d.margin = "0 12px", d.marginTop = -Math.round(0.5 * c2.offsetHeight) + "px", e = 0);
    /left/g.test(b2) ? (this.Ka("H_left"), d.left = a2.offsetWidth + "px", d.marginLeft = "12px") : /right/g.test(b2) ? (this.Ka("H_right"), d.right = a2.offsetWidth + "px", d.marginRight = "12px") : (this.Ka("H_center"), d.left = "50%", 0 > e ? (d.top = a2.offsetHeight + "px", d.marginTop = "12px") : 0 < e && (d.bottom = a2.offsetHeight + "px", d.marginBottom = "12px"), d.marginLeft = -Math.round(0.5 * c2.offsetWidth) + "px", a2.appendChild(c2));
  };
  Av.prototype.pointToControl = Av.prototype.xk;
  var Bv = { OPEN: "open", CLOSED: "closed" };
  Av.State = Bv;
  function Cv(a2) {
    a2 = a2 || {};
    Qu.call(this, "div", "H_rdo");
    this.g = new Y("div", "H_rdo_title");
    this.b = new Qu("div", "H_rdo_buttons");
    this.Ja(this.g);
    this.Ja(this.b);
    this.i = A(function(b2) {
      b2.target.getState() === Fu.DOWN ? (this.Kk(b2.target, true), this.dispatchEvent(Dv)) : b2.target.O(Fu.DOWN, true);
    }, this);
    this.addEventListener("statechange", this.i);
    this.Ci(a2.title || "");
    a2.onActiveButtonChange && this.addEventListener(Dv, a2.onActiveButtonChange);
    a2.buttonsOptions && a2.buttonsOptions.forEach(
      function(b2) {
        this.Gg(new gv(b2));
      },
      this
    );
  }
  u(Cv, Qu);
  t("H.ui.base.RadioGroup", Cv);
  var Dv = "activebuttonchange";
  Cv.prototype.X = function(a2, b2) {
    Qu.prototype.renderInternal.call(this, a2, b2);
    this.Ci(this.c, true);
  };
  Cv.prototype.renderInternal = Cv.prototype.X;
  Cv.prototype.na = function() {
    this.b.na();
  };
  Cv.prototype.Ci = function(a2, b2) {
    if (a2 !== this.c || b2)
      this.c = a2, this.g.N() && (this.g.N().innerHTML = this.c);
    return this;
  };
  Cv.prototype.setTitle = Cv.prototype.Ci;
  Cv.prototype.an = function() {
    return this.c;
  };
  Cv.prototype.getTitle = Cv.prototype.an;
  Cv.prototype.Gg = function(a2) {
    if (!(a2 instanceof gv))
      throw Error("PushButton expected");
    a2.ka(this);
    this.b.Ja(a2);
    return this;
  };
  Cv.prototype.addButton = Cv.prototype.Gg;
  Cv.prototype.ko = function(a2) {
    this.b.removeChild(a2);
    a2.ka(null);
    return this;
  };
  Cv.prototype.removeButton = Cv.prototype.ko;
  Cv.prototype.Df = function() {
    return this.b.dh();
  };
  Cv.prototype.getButtons = Cv.prototype.Df;
  Cv.prototype.Kk = function(a2, b2) {
    for (var c2 = this.Df(), d = c2.length; d--; )
      c2[d].O(c2[d] === a2 ? Fu.DOWN : Fu.UP, b2);
  };
  Cv.prototype.setActiveButton = Cv.prototype.Kk;
  Cv.prototype.o = function() {
    this.removeEventListener("statechange", this.i);
    this.na();
    Qu.prototype.o.call(this);
  };
  function Ev(a2) {
    a2 = a2 || {};
    Ru.call(this);
    this.i = new Av();
    this.b = this.b.bind(this);
    this.s = this.s.bind(this);
    this.m = this.m.bind(this);
    this.Vb(a2.alignment || "bottom-right");
    Fv(this, a2.baseLayers, a2.layers);
  }
  u(Ev, Ru);
  t("H.ui.MapSettingsControl", Ev);
  function Gv(a2, b2) {
    var c2 = [];
    a2.concat(b2).forEach(function(d) {
      c2 = c2.concat(d.layer);
    });
    return c2;
  }
  function Hv(a2, b2, c2) {
    var d = a2.Lb();
    if (d) {
      a2 = Gv(a2.c, a2.g);
      var e = Gv(b2, c2);
      a2.forEach(function(f2) {
        e.includes(f2) || d.ae(f2);
      });
    }
  }
  function Fv(a2, b2, c2) {
    Hv(a2, b2, c2);
    a2.D = NaN;
    a2.c = Bc(b2) ? b2 : [];
    a2.g = Bc(c2) ? c2 : [];
    a2.l && (a2.l.na(), a2.u.na(), Iv(a2));
  }
  Ev.prototype.ta = function() {
    var a2 = this.Lb();
    a2 && (a2.addEventListener("tap", this.s), a2 = a2.a, a2.addEventListener("add", this.b), a2.addEventListener("remove", this.b), a2.addEventListener("set", this.b));
  };
  Ev.prototype.T = function() {
    var a2 = this.Lb();
    a2 && (a2.removeEventListener("tap", this.s), a2 = a2.a, a2.removeEventListener("add", this.b), a2.removeEventListener("remove", this.b), a2.removeEventListener("set", this.b));
  };
  Ev.prototype.X = function(a2, b2) {
    var c2 = this.pa().translate("layers.choose");
    Ru.prototype.renderInternal.call(this, a2, b2);
    this.ta();
    this.P = new gv({ tooltip: c2, label: '<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M6.7,14.6 L4.5,16 L12,20.6 L19.5,16 L17.3,14.6 L19.1,13.5 L23,16 L12,23 L1,16 L4.9,13.5 L6.7,14.6 Z M12,2 L23,9 L12,16 L1,9 L12,2 Z"></path></svg>', onStateChange: A(function(d) {
      d.target.getState() === Fu.DOWN ? (this.i.O(Bv.OPEN), this.i.xk(this)) : this.i.O(Bv.CLOSED);
    }, this) });
    Ev.prototype.wa = function(d) {
      if (this.map.f.type === Qn) {
        var e = H.map.render.harp.Style;
        d = [].concat(d);
        for (var f2 = 0; !h && f2 < d.length; f2++) {
          var g = d[f2].ca();
          if (g.Sb() && g.V) {
            g = g.V();
            var h = g.getConfig() || g.getUrl();
          }
        }
        if (h) {
          var k = function(l) {
            l = l.ca();
            l.Sb() && l.V && l.V() instanceof e && l.gb(new e(h));
          };
          this.g.forEach(function(l) {
            l = l.layer;
            Bc(l) ? l.forEach(k) : l && k(l);
          });
        }
      }
    };
    this.l = new Cv({ title: c2, onActiveButtonChange: (function() {
      var d = this.D;
      a: {
        var e = this.l.Df();
        for (var f2 = e.length; f2--; )
          if (e[f2].getState() === Fu.DOWN) {
            e = e[f2];
            break a;
          }
        e = null;
      }
      e = e.getData();
      e = this.c[e].layer;
      f2 = Bc(e);
      this.map.ud(f2 ? e[0] : e);
      if (d = this.c[d]) {
        if (d = d.layer, Bc(d))
          for (var g = d.length; 1 < g--; )
            this.map.ae(d[g]);
      }
      if (f2)
        for (d = e.length; 1 < d--; )
          this.map.nf(e[d], 1);
      this.wa(e);
      this.m();
    }).bind(this) });
    this.u = new Qu("div", "H_grp");
    this.ea = new Y("div", "H_separator");
    this.Ja(this.P);
    this.Ja(this.i);
    this.i.Ja(this.l);
    this.i.Ja(this.ea);
    this.i.Ja(this.u);
    Iv(this);
  };
  Ev.prototype.renderInternal = Ev.prototype.X;
  function Iv(a2) {
    var b2 = a2.pa();
    a2.c.forEach(function(c2, d) {
      var e = c2.layer;
      this.l.Gg(new gv({ label: Jv(b2, c2.label), data: d, disabled: !e || Bc(e) && !e.length }));
    }, a2);
    a2.g.forEach(function(c2, d) {
      var e = c2.layer;
      this.u.Ja(new gv({ label: Jv(b2, c2.label), onStateChange: this.sb.bind(this, c2.layer), data: d, disabled: !e || Bc(e) && !e.length }));
    }, a2);
    a2.ea.qb(!(!a2.g.length || !a2.c.length));
    x.setTimeout((function() {
      this.map && (this.b(), this.P.va(!(this.c && this.c.length || this.g && this.g.length)));
    }).bind(a2));
  }
  Ev.prototype.b = function() {
    var a2 = this.map.g, b2 = this.map.a;
    this.D = NaN;
    this.c.forEach(function(c2, d) {
      c2 = c2.layer;
      c2 = a2 === (Bc(c2) ? c2[0] : c2);
      this.l.Df()[d].O(Fu[c2 ? "DOWN" : "UP"], true);
      c2 && (this.D = d);
    }, this);
    this.g.forEach(function(c2, d) {
      c2 = c2.layer;
      var e = Bc(c2);
      d = this.u.dh()[d];
      !c2 || e && !c2.length ? d.va(true) : d.O(Fu[-1 !== b2.indexOf(e ? c2[0] : c2) ? "DOWN" : "UP"], true);
    }, this);
  };
  Ev.prototype.sb = function(a2, b2) {
    a2 = Bc(a2) ? a2 : [a2];
    b2 = b2.target.getState() === Fu.DOWN;
    for (var c2 = 0; c2 < a2.length; c2++)
      b2 ? this.map.nf(a2[c2]) : this.map.ae(a2[c2]);
    this.m();
  };
  Ev.prototype.m = function() {
    var a2 = Kv(this);
    a2 && (a2.Bg.ca().V().Oe(a2.ca().V().qc()), this.map.ae(a2), a2.F(), delete a2.Bg);
    Lv(this) && Mv(this, this.map.g);
  };
  function Mv(a2, b2) {
    var c2 = window.H.service && window.H.service.omv.Provider, d = b2.ca();
    if (c2 && b2.ca() instanceof c2 && d.V().xe) {
      var e = d.V(), f2 = (function() {
        var g = Nv.ground.filter(function(l) {
          return !!e.kh("layers." + l);
        }), h = Nv.water.filter(function(l) {
          return !!e.kh("layers." + l);
        });
        if (g.concat(h).length) {
          var k = {};
          $h(k, e.xe(g));
          $h(k, e.xe(h, false, true));
          delete k.global;
          g = new ti(k, e.Ib());
          g = d.s().$b(g);
          g.Bg = b2;
          this.map.nf(g);
        }
        e.removeEventListener(Zh.CHANGE, f2);
      }).bind(a2);
      e.getState() !== Xh.READY ? e.addEventListener(
        Zh.CHANGE,
        f2
      ) : f2();
    }
  }
  function Kv(a2) {
    return iu(a2.map.a.La(), function(b2) {
      return !!b2.Bg;
    });
  }
  function Lv(a2) {
    a2 = a2.map.a.La();
    var b2 = window.H.service && window.H.service.traffic.flow.Provider;
    return !!b2 && a2.some(function(c2) {
      return c2.ca() instanceof b2;
    });
  }
  var Nv = { water: ["water.water-labels"], ground: "road_labels continent_label island_label roads.shields roads.directions truck-restriction.signs places landuse.label".split(" ") };
  function Jv(a2, b2) {
    return /^layers?/.test(b2) && a2.Nf(b2) ? a2.translate(b2) : b2;
  }
  Ev.prototype.s = function() {
    this.P.O(Fu.UP);
  };
  Ev.prototype.o = function() {
    Ev.j.o.call(this);
    this.T();
  };
  var Ov = [];
  t("H.ui.i18n.defaultLocales", Ov);
  var Pv = {}, Qv = [];
  function Rv(a2, b2) {
    Pv[a2] = b2;
    -1 === Ov.indexOf(a2) && Ov.push(a2);
    Qv.length ? Sv(a2, b2) : Qv = Object.keys(b2);
  }
  function Sv(a2, b2) {
    for (var c2 = Qv, d = c2.length, e; d--; )
      if (e = c2[d], !b2[e])
        throw Error("'" + e + "' key missing in translation map for " + a2);
  }
  ;
  function Tv(a2) {
    a2 = a2 || {};
    Ru.call(this);
    this.c = new gv({
      label: '<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><g transform="translate(1 3)"><path fill-rule="nonzero" d="M5,0 L5,2 L2,2 L2,16 L5,16 L5,18 L2,18 C0.9,18 0,17 0,15.75 L0,2.25 C0,1 0.9,0 2,0 L5,0 Z M17,0 L20,0 C21.1,0 22,1 22,2.25 L22,15.75 C22,17 21.1,18 20,18 L17,18 L17,16 L20,16 L20,2 L17,2 L17,0 Z"></path><rect width="10" height="2" x="6" y="8"></rect><rect width="2" height="10" x="10" y="4"></rect></g></svg>',
      onStateChange: A(this.On, this)
    });
    this.Ja(this.c);
    this.Vb(a2.alignment || "right-bottom");
  }
  u(Tv, Ru);
  t("H.ui.ZoomRectangle", Tv);
  p = Tv.prototype;
  p.On = function(a2) {
    var b2 = this.map, c2 = b2.b.element;
    a2.target.getState() === Fu.DOWN ? (b2.addEventListener("dragstart", this.fk, true, this), b2.addEventListener("drag", this.gk, true, this), b2.addEventListener("dragend", this.ek, true, this), a2 = c2.ownerDocument.createElement("div"), a2.className = "H_zoom_lasso", c2.appendChild(a2), this.b = a2) : (b2.removeEventListener("dragstart", this.fk, true, this), b2.removeEventListener("drag", this.gk, true, this), b2.removeEventListener("dragend", this.ek, true, this), c2.removeChild(this.b));
  };
  p.fk = function(a2) {
    var b2 = this.b.style, c2 = a2.currentPointer, d = c2.viewportX;
    c2 = c2.viewportY;
    a2.target === this.map && (a2.stopPropagation(), b2.width = "0px", b2.height = "0px", b2.top = c2 + "px", b2.left = d + "px", b2.display = "block", this.i = c2, this.g = d);
  };
  p.gk = function(a2) {
    var b2 = a2.currentPointer, c2 = b2.viewportX, d = b2.viewportY;
    b2 = this.g;
    var e = this.i, f2 = this.b.style;
    a2.target === this.map && (a2.stopPropagation(), a2 = c2 - b2, c2 = d - e, f2.left = b2 + (0 > a2 ? a2 : 0) + "px", f2.top = e + (0 > c2 ? c2 : 0) + "px", f2.width = Math.abs(a2) + "px", f2.height = Math.abs(c2) + "px");
  };
  p.ek = function(a2) {
    var b2 = this.map, c2 = a2.currentPointer;
    a2.target === this.map && (a2.stopPropagation(), this.b.style.display = "none", b2.c.Wb({ bounds: tg([b2.Pa(this.g, this.i), b2.Pa(c2.viewportX, c2.viewportY)]) }, true));
  };
  p.X = function(a2, b2) {
    Ru.prototype.renderInternal.call(this, a2, b2);
    this.c.jc(this.pa().translate("zoom.rectangle"));
  };
  Tv.prototype.renderInternal = Tv.prototype.X;
  Rv("nl-NL", {
    "layers.normal": "Kaartweergave",
    "layers.satellite": "Satelliet",
    "layers.terrain": "Terrein",
    "layer.transit": "Openbaar vervoer",
    "layer.traffic": "Verkeerssituatie",
    "layer.incidents": "Toon verkeersincidenten",
    "layers.choose": "Weergave kiezen",
    minimap: "Minimap",
    "scale.switchToImperial": "Overgaan naar mijlen",
    "scale.switchToMetric": "Wijzigen naar km",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mi",
    "scale.ft": "ft",
    "zoom.out": "Uitzoomen",
    "zoom.in": "Inzoomen",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Openbaar vervoer",
    "traffic.MISCELLANEOUS": "Diversen",
    "traffic.ACCIDENT": "Ongeval",
    "traffic.OTHER_NEWS": "Meer informatie",
    "traffic.OTHER": "Meer informatie",
    "traffic.PLANNED_EVENT": "Geplande afzetting",
    "traffic.ROAD_HAZARD": "Gevaar op de weg",
    "traffic.ROAD_CLOSURE": "Rijbaan afgesloten",
    "traffic.WEATHER": "Weer",
    "traffic.CONGESTION": "Verkeersopstopping",
    "traffic.CONSTRUCTION": "Wegwerkzaamheden",
    "traffic.DISABLED_VEHICLE": "Voertuig met pech",
    "traffic.LANE_RESTRICTION": "Rijstrookbeperking",
    "traffic.from": "Begintijd:",
    "traffic.until": "Geschatte eindtijd:",
    "distance.measurement": "Measure distance"
  });
  Rv("pt-PT", {
    "layers.normal": "Vista do mapa",
    "layers.satellite": "Satlite",
    "layers.terrain": "Terreno",
    "layer.transit": "Transportes pblicos",
    "layer.traffic": "Condies de trnsito",
    "layer.incidents": "Mostrar incidentes de trnsito",
    "layers.choose": "Escolher vista",
    minimap: "Minimap",
    "scale.switchToImperial": "Mudar para milhas",
    "scale.switchToMetric": "Mudar para km",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mi",
    "scale.ft": "ft",
    "zoom.out": "Diminuir",
    "zoom.in": "Aumentar",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Transportes pblicos",
    "traffic.MISCELLANEOUS": "Diversos",
    "traffic.ACCIDENT": "Acidente",
    "traffic.OTHER_NEWS": "Outras notcias",
    "traffic.OTHER": "Outras notcias",
    "traffic.PLANNED_EVENT": "Evento planeado",
    "traffic.ROAD_HAZARD": "Perigo na estrada",
    "traffic.ROAD_CLOSURE": "Estrada fechada",
    "traffic.WEATHER": "Meteorologia",
    "traffic.CONGESTION": "Congestionamento",
    "traffic.CONSTRUCTION": "Construo",
    "traffic.DISABLED_VEHICLE": "Veculo avariado",
    "traffic.LANE_RESTRICTION": "Limitao da faixa de rodagem",
    "traffic.from": "Hora de incio:",
    "traffic.until": "Hora de fim prevista:",
    "distance.measurement": "Measure distance"
  });
  Rv("ru-RU", {
    "layers.normal": " ",
    "layers.satellite": "",
    "layers.terrain": "",
    "layer.transit": " ",
    "layer.traffic": " ",
    "layer.incidents": "  ",
    "layers.choose": " ",
    minimap: "Minimap",
    "scale.switchToImperial": " ",
    "scale.switchToMetric": " ",
    "scale.km": "",
    "scale.m": "",
    "scale.mi": "",
    "scale.ft": "",
    "zoom.out": "",
    "zoom.in": "",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": " ",
    "traffic.MISCELLANEOUS": " ",
    "traffic.ACCIDENT": "",
    "traffic.OTHER_NEWS": " ",
    "traffic.OTHER": " ",
    "traffic.PLANNED_EVENT": " ",
    "traffic.ROAD_HAZARD": " ",
    "traffic.ROAD_CLOSURE": " ",
    "traffic.WEATHER": "",
    "traffic.CONGESTION": "",
    "traffic.CONSTRUCTION": "",
    "traffic.DISABLED_VEHICLE": " ",
    "traffic.LANE_RESTRICTION": "  ",
    "traffic.from": " :",
    "traffic.until": "  :",
    "distance.measurement": " "
  });
  Rv("fi-FI", {
    "layers.normal": "Karttankym",
    "layers.satellite": "Satelliitti",
    "layers.terrain": "Maasto",
    "layer.transit": "Julkinen liikenne",
    "layer.traffic": "Liikenneolosuhteet",
    "layer.incidents": "Nyt liikennetapahtumat",
    "layers.choose": "Valitse nkym",
    minimap: "Minimap",
    "scale.switchToImperial": "Vaihda maileihin",
    "scale.switchToMetric": "Vaihda kilometreihin",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mi",
    "scale.ft": "ft",
    "zoom.out": "Loitonna",
    "zoom.in": "Lhenn",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Julkinen liikenne",
    "traffic.MISCELLANEOUS": "Erittelemtn syy",
    "traffic.ACCIDENT": "Onnettomuus",
    "traffic.OTHER_NEWS": "Muu tapahtuma",
    "traffic.OTHER": "Muu tapahtuma",
    "traffic.PLANNED_EVENT": "Suunniteltu tapahtuma",
    "traffic.ROAD_HAZARD": "Vaara tiell",
    "traffic.ROAD_CLOSURE": "Tie suljettu",
    "traffic.WEATHER": "S",
    "traffic.CONGESTION": "Ruuhka",
    "traffic.CONSTRUCTION": "Rakennusty",
    "traffic.DISABLED_VEHICLE": "Pyshtynyt ajoneuvo",
    "traffic.LANE_RESTRICTION": "Kaista rajoitus",
    "traffic.from": "Alkamisaika:",
    "traffic.until": "Arvioitu pttymisaika:",
    "distance.measurement": "Measure distance"
  });
  Rv("pt-BR", {
    "layers.normal": "Exibio do mapa",
    "layers.satellite": "Satlite",
    "layers.terrain": "Terreno",
    "layer.transit": "Transporte pblico",
    "layer.traffic": "Condies do trnsito",
    "layer.incidents": "Mostrar incidentes no trnsito",
    "layers.choose": "Escolher exibio",
    minimap: "Minimap",
    "scale.switchToImperial": "Mudar para milhas",
    "scale.switchToMetric": "Mudar para km",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "milhas",
    "scale.ft": "ps",
    "zoom.out": "Menos zoom",
    "zoom.in": "Mais zoom",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Transporte pblico",
    "traffic.MISCELLANEOUS": "Miscelnea",
    "traffic.ACCIDENT": "Acidente",
    "traffic.OTHER_NEWS": "Outras notcias",
    "traffic.OTHER": "Outras notcias",
    "traffic.PLANNED_EVENT": "Evento planejado",
    "traffic.ROAD_HAZARD": "Risco na estrada",
    "traffic.ROAD_CLOSURE": "Estrada fechada",
    "traffic.WEATHER": "Clima",
    "traffic.CONGESTION": "Congestionamento",
    "traffic.CONSTRUCTION": "Construo",
    "traffic.DISABLED_VEHICLE": "Veculo incapacitado",
    "traffic.LANE_RESTRICTION": "Restrio de pista",
    "traffic.from": "Hora de incio:",
    "traffic.until": "Tempo final estimado:",
    "distance.measurement": "Measure distance"
  });
  Rv("zh-CN", {
    "layers.normal": "",
    "layers.satellite": "",
    "layers.terrain": "",
    "layer.transit": "",
    "layer.traffic": "",
    "layer.incidents": "",
    "layers.choose": "",
    minimap: "Minimap",
    "scale.switchToImperial": "",
    "scale.switchToMetric": "",
    "scale.km": "",
    "scale.m": "",
    "scale.mi": "",
    "scale.ft": "",
    "zoom.out": "",
    "zoom.in": "",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "",
    "traffic.MISCELLANEOUS": "",
    "traffic.ACCIDENT": "",
    "traffic.OTHER_NEWS": "",
    "traffic.OTHER": "",
    "traffic.PLANNED_EVENT": "",
    "traffic.ROAD_HAZARD": "",
    "traffic.ROAD_CLOSURE": "",
    "traffic.WEATHER": "",
    "traffic.CONGESTION": "",
    "traffic.CONSTRUCTION": "",
    "traffic.DISABLED_VEHICLE": "",
    "traffic.LANE_RESTRICTION": "",
    "traffic.from": "",
    "traffic.until": "",
    "distance.measurement": "Measure distance"
  });
  Rv("es-ES", {
    "layers.normal": "Mapa",
    "layers.satellite": "Satlite",
    "layers.terrain": "Terreno",
    "layer.transit": "Transporte pblico",
    "layer.traffic": "Estado del trfico",
    "layer.incidents": "Mostrar incidentes de trfico",
    "layers.choose": "Elija una vista",
    minimap: "Minimap",
    "scale.switchToImperial": "Cambiar a millas",
    "scale.switchToMetric": "Cambiar a km",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mi",
    "scale.ft": "ft",
    "zoom.out": "Alejar",
    "zoom.in": "Acercar",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Transporte pblico",
    "traffic.MISCELLANEOUS": "Varios",
    "traffic.ACCIDENT": "Accidente",
    "traffic.OTHER_NEWS": "Ms noticias",
    "traffic.OTHER": "Ms noticias",
    "traffic.PLANNED_EVENT": "Acto programado",
    "traffic.ROAD_HAZARD": "Riesgo en carretera",
    "traffic.ROAD_CLOSURE": "Carretera cerrada",
    "traffic.WEATHER": "Tiempo",
    "traffic.CONGESTION": "Atasco",
    "traffic.CONSTRUCTION": "Construccin",
    "traffic.DISABLED_VEHICLE": "Vehculo averiado",
    "traffic.LANE_RESTRICTION": "Restriccin de carril",
    "traffic.from": "Inicio:",
    "traffic.until": "Finalizacin estimada:",
    "distance.measurement": "Measure distance"
  });
  Rv("fr-FR", {
    "layers.normal": "Carte",
    "layers.satellite": "Satellite",
    "layers.terrain": "Terrain",
    "layer.transit": "Transports publics",
    "layer.traffic": "Conditions de circulation",
    "layer.incidents": "Afficher les incidents de circulation",
    "layers.choose": "Choisir la vue",
    minimap: "Minimap",
    "scale.switchToImperial": "Passer en miles",
    "scale.switchToMetric": "Passer en km",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mi",
    "scale.ft": "ft",
    "zoom.out": "Zoom arrire",
    "zoom.in": "Zoom avant",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Transports publics",
    "traffic.MISCELLANEOUS": "Divers",
    "traffic.ACCIDENT": "Accident",
    "traffic.OTHER_NEWS": "Autre",
    "traffic.OTHER": "Autre",
    "traffic.PLANNED_EVENT": "vnement prvu",
    "traffic.ROAD_HAZARD": "Danger routier",
    "traffic.ROAD_CLOSURE": "Chausse ferme",
    "traffic.WEATHER": "Mto",
    "traffic.CONGESTION": "Embouteillage",
    "traffic.CONSTRUCTION": "Travaux",
    "traffic.DISABLED_VEHICLE": "Vhicule en panne",
    "traffic.LANE_RESTRICTION": "Restriction de voie",
    "traffic.from": "Date ou heure de dbut:",
    "traffic.until": "Date et heure de fin estimes:",
    "distance.measurement": "Measure distance"
  });
  Rv("pl-PL", {
    "layers.normal": "Widok mapy",
    "layers.satellite": "Satelita",
    "layers.terrain": "Teren",
    "layer.transit": "Transport publiczny",
    "layer.traffic": "Warunki drogowe",
    "layer.incidents": "Poka zdarzenia drogowe",
    "layers.choose": "Wybierz widok",
    minimap: "Minimap",
    "scale.switchToImperial": "Zmie na mile",
    "scale.switchToMetric": "Zmie na km",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mi",
    "scale.ft": "ft",
    "zoom.out": "Oddal",
    "zoom.in": "Przybli",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Transport publiczny",
    "traffic.MISCELLANEOUS": "Inne zdarzenie",
    "traffic.ACCIDENT": "Wypadek",
    "traffic.OTHER_NEWS": "Inne wiadomoci",
    "traffic.OTHER": "Inne wiadomoci",
    "traffic.PLANNED_EVENT": "Zdarzenie planowane",
    "traffic.ROAD_HAZARD": "Niebezpieczestwo na drodze",
    "traffic.ROAD_CLOSURE": "Jezdnia zamknita",
    "traffic.WEATHER": "Pogoda",
    "traffic.CONGESTION": "Korek",
    "traffic.CONSTRUCTION": "Budowa",
    "traffic.DISABLED_VEHICLE": "Uszkodzony pojazd",
    "traffic.LANE_RESTRICTION": "Ograniczenie pasa ruchu",
    "traffic.from": "Data rozpoczcia:",
    "traffic.until": "Przybliona data zakoczenia:",
    "distance.measurement": "Measure distance"
  });
  Rv("de-DE", {
    "layers.normal": "Kartenansicht",
    "layers.satellite": "Satellit",
    "layers.terrain": "Gelnde",
    "layer.transit": "ffentliche Verkehrsmittel",
    "layer.traffic": "Verkehrslage",
    "layer.incidents": "Verkehrsstrungen anzeigen",
    "layers.choose": "Ansicht auswhlen",
    minimap: "Minimap",
    "scale.switchToImperial": "Umrechnung in Meilen",
    "scale.switchToMetric": "Umrechnung in Kilometer",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mi",
    "scale.ft": "ft",
    "zoom.out": "Verkleinern",
    "zoom.in": "Vergrern",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "ffentliche Verkehrsmittel",
    "traffic.MISCELLANEOUS": "Diverse",
    "traffic.ACCIDENT": "Unfall",
    "traffic.OTHER_NEWS": "Anderes Ereignis",
    "traffic.OTHER": "Anderes Ereignis",
    "traffic.PLANNED_EVENT": "Geplantes Ereignis",
    "traffic.ROAD_HAZARD": "Verkehrshindernis",
    "traffic.ROAD_CLOSURE": "Fahrbahn gesperrt",
    "traffic.WEATHER": "Wetter",
    "traffic.CONGESTION": "Verkehrsstau",
    "traffic.CONSTRUCTION": "Baustelle",
    "traffic.DISABLED_VEHICLE": "Liegengebliebenes Fahrzeug",
    "traffic.LANE_RESTRICTION": "Fahrstreifensperrung",
    "traffic.from": "Beginn:",
    "traffic.until": "Voraussichtliches Ende:",
    "distance.measurement": "Measure distance"
  });
  Rv("tr-TR", {
    "layers.normal": "Harita grnm",
    "layers.satellite": "Uydu",
    "layers.terrain": "Arazi",
    "layer.transit": "Toplu ulam",
    "layer.traffic": "Trafik durumlar",
    "layer.incidents": "Trafik olaylarn gster",
    "layers.choose": "Grnm se",
    minimap: "Minimap",
    "scale.switchToImperial": "Mile dntr",
    "scale.switchToMetric": "Kilometreye dntr",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mil",
    "scale.ft": "ft",
    "zoom.out": "Uzaklatr",
    "zoom.in": "Yaknlatr",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Toplu ulam",
    "traffic.MISCELLANEOUS": "eitli",
    "traffic.ACCIDENT": "Kaza",
    "traffic.OTHER_NEWS": "Dier haberler",
    "traffic.OTHER": "Dier haberler",
    "traffic.PLANNED_EVENT": "Planl etkinlik",
    "traffic.ROAD_HAZARD": "Yol tehlikesi",
    "traffic.ROAD_CLOSURE": "Yol kapal",
    "traffic.WEATHER": "Hava durumu",
    "traffic.CONGESTION": "Younluk",
    "traffic.CONSTRUCTION": "Yol almas",
    "traffic.DISABLED_VEHICLE": "Ara arzas",
    "traffic.LANE_RESTRICTION": "erit kstlamas",
    "traffic.from": "Balang zaman:",
    "traffic.until": "Tahmini biti zaman:",
    "distance.measurement": "Measure distance"
  });
  Rv("it-IT", {
    "layers.normal": "Vista mappa",
    "layers.satellite": "Satellite",
    "layers.terrain": "Terreno",
    "layer.transit": "Mezzi pubblici",
    "layer.traffic": "Condizioni del traffico",
    "layer.incidents": "Mostra incidenti stradali",
    "layers.choose": "Scegli vista",
    minimap: "Minimap",
    "scale.switchToImperial": "Passa a miglia",
    "scale.switchToMetric": "Passa a km",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mi",
    "scale.ft": "ft",
    "zoom.out": "Zoom indietro",
    "zoom.in": "Zoom avanti",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Mezzi pubblici",
    "traffic.MISCELLANEOUS": "Varie",
    "traffic.ACCIDENT": "Incidente",
    "traffic.OTHER_NEWS": "Altre notizie",
    "traffic.OTHER": "Altre notizie",
    "traffic.PLANNED_EVENT": "Evento pianificato",
    "traffic.ROAD_HAZARD": "Strada dissestata",
    "traffic.ROAD_CLOSURE": "Strada chiusa",
    "traffic.WEATHER": "Maltempo",
    "traffic.CONGESTION": "Ingorgo",
    "traffic.CONSTRUCTION": "Lavori in corso",
    "traffic.DISABLED_VEHICLE": "Veicolo in panne",
    "traffic.LANE_RESTRICTION": "Restrizione di corsia",
    "traffic.from": "Ora di inizio:",
    "traffic.until": "Ora di fine stimata:",
    "distance.measurement": "Measure distance"
  });
  Rv("en-US", {
    "layers.normal": "Map view",
    "layers.satellite": "Satellite",
    "layers.terrain": "Terrain",
    "layer.transit": "Public transport",
    "layer.traffic": "Traffic conditions",
    "layer.incidents": "Show traffic incidents",
    "layers.choose": "Choose view",
    minimap: "Minimap",
    "scale.switchToImperial": "Change to miles",
    "scale.switchToMetric": "Change to km",
    "scale.km": "km",
    "scale.m": "m",
    "scale.mi": "mi",
    "scale.ft": "ft",
    "zoom.out": "Zoom out",
    "zoom.in": "Zoom in",
    "zoom.rectangle": "Zoom rectangle",
    "traffic.MASS_TRANSIT": "Public transport",
    "traffic.MISCELLANEOUS": "Miscellaneous",
    "traffic.ACCIDENT": "Accident",
    "traffic.OTHER_NEWS": "Other news",
    "traffic.OTHER": "Other news",
    "traffic.PLANNED_EVENT": "Planned event",
    "traffic.ROAD_HAZARD": "Road hazard",
    "traffic.ROAD_CLOSURE": "Roadway closed",
    "traffic.WEATHER": "Weather",
    "traffic.CONGESTION": "Congestion",
    "traffic.CONSTRUCTION": "Construction",
    "traffic.DISABLED_VEHICLE": "Disabled vehicle",
    "traffic.LANE_RESTRICTION": "Lane restriction",
    "traffic.from": "Start time:",
    "traffic.until": "Estimated end time:",
    "distance.measurement": "Measure distance"
  });
  function Uv(a2, b2) {
    if (!Cc(a2))
      throw new TypeError("string locale code required");
    if (Ea(b2))
      Sv(a2, b2);
    else {
      if (-1 === Ov.indexOf(a2))
        throw Error("Default locale '" + a2 + "' does nto exist.");
      b2 = Pv[a2];
    }
    this.b = b2 || {};
    this.a = a2;
  }
  t("H.ui.i18n.Localization", Uv);
  Uv.prototype.zm = function() {
    return this.a;
  };
  Uv.prototype.getLocale = Uv.prototype.zm;
  Uv.prototype.sm = function() {
    return Object.keys(this.b);
  };
  Uv.prototype.getKeys = Uv.prototype.sm;
  Uv.prototype.Nf = function(a2) {
    return !(!this.b || !this.b[a2]);
  };
  Uv.prototype.hasKey = Uv.prototype.Nf;
  Uv.prototype.translate = function(a2) {
    var b2 = this.b[a2];
    if (!Cc(b2))
      throw Error("Translation missing for key '" + a2 + "'.");
    return b2;
  };
  Uv.prototype.translate = Uv.prototype.translate;
  function Vv(a2) {
    a2 = a2 || {};
    Ru.call(this);
    this.Ka("H_scalebar");
    this.Vb(a2.alignment || "right-bottom");
    this.m = 150;
    this.update = A(this.update, this);
    this.i = this.g = this.b = this.c = null;
  }
  u(Vv, Ru);
  t("H.ui.ScaleBar", Vv);
  Vv.prototype.X = function(a2, b2) {
    Ru.prototype.renderInternal.call(this, a2, b2);
    a2.innerHTML = '<svg height="12" version="1.1" xmlns="http://www.w3.org/2000/svg"><polyline style="fill:none; stroke:white; stroke-width:4" points="2,2 2,10 98,10 98,2"/><polyline style="fill:none; stroke:black; stroke-width:2" points="2,2 2,10 98,10 98,2"/></svg><div style="padding: 0 0 0 10px"></div>';
    a2.style.direction = "ltr";
    this.c = a2.firstChild;
    b2 = this.c.childNodes;
    this.b = b2[0];
    this.g = b2[1];
    this.i = a2.lastChild;
    this.l = ev.METRIC;
    this.s = A(function(c2) {
      this.dc() || (this.dispatchEvent("toggleunitsystem"), c2.preventDefault());
    }, this);
    this.u = A(function(c2) {
      c2.preventDefault();
    }, this);
    Bu(a2, "start", this.u);
    Bu(a2, "end", this.s);
    this.jc(this.pa().translate("scale.switchToImperial"));
    this.update();
  };
  Vv.prototype.renderInternal = Vv.prototype.X;
  Vv.prototype.Ia = function(a2) {
    this.map && this.map.removeEventListener("mapviewchange", this.update);
    a2 && a2.addEventListener("mapviewchange", this.update);
    Ru.prototype.Ia.apply(this, arguments);
  };
  Vv.prototype.setMap = Vv.prototype.Ia;
  Vv.prototype.capture = function(a2, b2, c2) {
    var d = this.N();
    var e = d.ownerDocument, f2 = e.createElement("canvas"), g = f2.getContext("2d"), h = e.createElementNS("http://www.w3.org/2000/svg", "svg"), k = e.createElementNS("http://www.w3.org/2000/svg", "foreignObject"), l = lf(d, e, false);
    e = parseFloat(d.offsetWidth) + 1;
    var m = parseFloat(d.offsetHeight), n = e * a2;
    a2 *= m;
    f2.width = n;
    f2.height = a2;
    h.setAttribute("xmlns", "http://www.w3.org/2000/svg");
    h.setAttribute("width", n);
    h.setAttribute("height", a2);
    h.setAttribute("viewBox", "0 0 " + e + " " + m);
    k.setAttribute(
      "width",
      "100%"
    );
    k.setAttribute("height", "100%");
    h.appendChild(k);
    l.setAttribute("width", "100%");
    l.setAttribute("height", "100%");
    l.setAttribute("xmlns", "http://www.w3.org/1999/xhtml");
    var q = window.getComputedStyle(d);
    "box-shadow display align-items font font-family font-size height text-shadow direction".split(" ").forEach(function(r) {
      l.style.setProperty(r, q.getPropertyValue(r));
    });
    k.appendChild(l);
    d = bf(h.outerHTML);
    new tf("image", d).then(function(r) {
      g.drawImage(r, 0, 0);
      b2(f2);
    }, c2);
  };
  Vv.prototype.capture = Vv.prototype.capture;
  Vv.prototype.Qe = function(a2) {
    this.l = a2;
    this.jc("imperial" === a2 ? this.pa().translate("scale.switchToMetric") : this.pa().translate("scale.switchToImperial"));
    this.update();
  };
  Vv.prototype.onUnitSystemChange = Vv.prototype.Qe;
  Vv.prototype.update = function() {
    var a2;
    if (this.N()) {
      this.c = this.c;
      this.b = this.b;
      var b2 = this.m;
      var c2 = 0;
      var d = this.map;
      if (d) {
        var e = Math.round(0.5 * d.b.width);
        var f2 = Math.round(0.5 * d.b.height);
        (a2 = d.Pa(e, f2)) && (d = d.Pa(e + 1, f2)) && (c2 = 100 * a2.Wa(d));
      }
      c2 && (this.l === ev.IMPERIAL ? 1609.344 > c2 ? (d = c2 / 0.3048006, a2 = this.pa().translate("scale.ft")) : (d = c2 / 1609.344, a2 = this.pa().translate("scale.mi")) : 1e3 > c2 ? (d = c2, a2 = this.pa().translate("scale.m")) : (d = c2 / 1e3, a2 = this.pa().translate("scale.km")), c2 = Math.pow(10, Math.floor(Math.log(d) / Math.LN10)), d = c2 / d * 100, d < b2 / 5 ? (c2 *= 5, d *= 5) : d < b2 / 2 ? (c2 *= 2, d *= 2) : d > b2 && (c2 /= 2, d /= 2), d = Math.round(d), this.c.setAttribute("width", d), this.i.textContent = c2 + " " + a2, this.b.points.getItem(2).x = this.g.points.getItem(2).x = this.b.points.getItem(3).x = this.g.points.getItem(3).x = d - 2);
    }
  };
  function Wv(a2) {
    C(a2, Re, Wv, 1);
    Y.call(this, "div", "H_context_menu_item");
    this.b = a2;
    this.c = A(this.c, this);
    this.a = A(this.a, this);
    this.b.addEventListener("update", this.a);
  }
  u(Wv, Y);
  t("H.ui.context.Item", Wv);
  Wv.prototype.c = function(a2) {
    var b2 = this.b, c2 = b2.callback;
    c2 && !b2.isDisabled() && (this.dispatchEvent("click"), c2(a2));
  };
  Wv.prototype.X = function() {
    var a2 = this, b2 = this.N();
    Ee(b2, "click", this.c);
    b2.addEventListener("keyup", function(c2) {
      13 == c2.keyCode && a2.c(c2);
    });
    this.a();
  };
  Wv.prototype.renderInternal = Wv.prototype.X;
  Wv.prototype.a = function() {
    var a2 = this.N(), b2 = this.b;
    b2.callback ? (this.Ka("clickable"), a2.setAttribute("tabindex", "0")) : (this.kb("clickable"), a2.removeAttribute("tabindex"));
    b2.isDisabled() ? this.Ka("disabled") : this.kb("disabled");
    b2 = b2.getLabel();
    su.textContent = b2;
    a2.innerHTML = su.innerHTML.split("\n").join("<br/>");
  };
  Wv.prototype.o = function() {
    Y.prototype.o.call(this);
    this.b.removeEventListener("update", this.a);
  };
  function Xv(a2) {
    C(a2, Array, Xv, 1);
    Qu.call(this, "div", "H_context_menu");
    this.c = a2;
    this.b = null;
  }
  u(Xv, Qu);
  t("H.ui.context.Menu", Xv);
  Xv.prototype.X = function() {
    Qu.prototype.X.apply(this, arguments);
    this.c.forEach(function(a2) {
      a2 === Se ? a2 = new Y("div", "H_context_menu_item_separator") : (a2 = new Wv(a2), a2.addEventListener("click", this.g.bind(this)));
      this.Ja(a2);
    }, this);
    Ee(this.N(), ["mousedown", "touchstart", "pointerdown", "wheel"], function(a2) {
      a2.stopPropagation();
    });
  };
  Xv.prototype.renderInternal = Xv.prototype.X;
  Xv.prototype.setPosition = function(a2, b2) {
    if (this.b) {
      var c2 = this.N();
      var d = c2.offsetWidth;
      var e = c2.offsetHeight;
      var f2 = this.b;
      var g = f2.b.width;
      f2 = f2.b.height;
      a2 + d > g && a2 > g / 2 && (a2 -= d);
      b2 + e > f2 && b2 > f2 / 2 && (b2 -= e);
      lu(c2, a2, b2);
    }
  };
  Xv.prototype.setPosition = Xv.prototype.setPosition;
  Xv.prototype.g = function() {
    this.b && this.b.dispatchEvent(new ud("contextmenuclose", this.b));
  };
  Xv.prototype.Ia = function(a2) {
    this.b = a2;
  };
  Xv.prototype.setMap = Xv.prototype.Ia;
  function Yv(a2, b2) {
    b2 = b2 || {};
    var c2 = this;
    Y.call(this, "div", "H_ib H_ib_top");
    this.u = A(function(d) {
      c2.dc() || (c2.close(), d.preventDefault());
    }, this);
    this.update = A(this.update, this);
    this.i = A(this.i, this);
    this.setPosition(a2);
    this.$e(b2.content);
    b2.onStateChange && this.addEventListener("statechange", b2.onStateChange);
    this.O(Zv.OPEN);
  }
  u(Yv, Y);
  t("H.ui.InfoBubble", Yv);
  Yv.prototype.a = null;
  Yv.prototype.ya = function() {
    return this.m;
  };
  Yv.prototype.setPosition = function(a2) {
    this.m = ng(a2);
    this.update();
  };
  Yv.prototype.setPosition = Yv.prototype.setPosition;
  Yv.prototype.Ia = function(a2) {
    this.a = a2;
  };
  Yv.prototype.X = function(a2, b2) {
    this.l = yu(b2, "div", "H_ib_body");
    this.tailEl_ = yu(b2, "div", "H_ib_tail");
    this.c = yu(b2, "div", "H_ib_close H_btn", '<svg version="1.1" class="H_icon" viewBox="0 0 12 12"><path d="m8.12 6 3.66-3.66c.29-.29.29-.76 0-1.05l-1.06-1.06c-.29-.29-.76-.29-1.05 0l-3.66 3.66-3.66-3.66c-.29-.29-.76-.29-1.05 0l-1.06 1.06c-.29.29-.3.76 0 1.05l3.66 3.66-3.66 3.66c-.29.29-.29.76 0 1.05l1.06 1.06c.29.29.76.29 1.05 0l3.66-3.66 3.66 3.66c.29.29.76.29 1.05 0l1.06-1.06c.29-.29.3-.76 0-1.05z"></path></svg>');
    this.b = yu(b2, "div", "H_ib_content", "&nbsp;");
    this.l.appendChild(this.c);
    this.l.appendChild(this.b);
    Bu(this.c, "start", this.u);
    this.a.c.addEventListener("sync", this.update);
    this.a.b.addEventListener("sync", this.update);
    a2.appendChild(this.l);
    a2.appendChild(this.tailEl_);
    this.$e(this.g);
  };
  Yv.prototype.renderInternal = Yv.prototype.X;
  Yv.prototype.i = function() {
    this.s || (this.s = setTimeout(this.update, 0));
  };
  Yv.prototype.update = function() {
    var a2 = this.N(), b2 = this.a, c2, d = "none";
    this.s = 0;
    if (b2 && a2 && this.getState() === Zv.OPEN) {
      if (c2 = b2.Da(this.m)) {
        var e = c2.x;
        c2 = c2.y;
        b2 = b2.b.width;
        if (e >= -b2 || e <= 2 * b2 || c2 >= -b2 || c2 <= 2 * b2)
          d = "", mu ? (a2.style.left = e - b2 + "px", a2.style.top = c2 + "px") : lu(a2, e, c2);
      }
      a2.style.display = d;
      "" === d && (a2.style.visibility = "visible");
    }
  };
  var Zv = { OPEN: "open", CLOSED: "closed" };
  Yv.State = Zv;
  Yv.prototype.C = Zv.OPEN;
  Yv.prototype.getState = function() {
    return this.C;
  };
  Yv.prototype.getState = Yv.prototype.getState;
  Yv.prototype.O = function(a2) {
    a2 !== this.C && (this.C = a2, this.dispatchEvent("statechange"));
    if (a2 = this.N())
      this.C === Zv.OPEN ? (a2.style.display = "block", a2.style.visibility = "hidden", this.i()) : a2.style.display = "none";
  };
  Yv.prototype.setState = Yv.prototype.O;
  Yv.prototype.close = function() {
    this.O(Zv.CLOSED);
  };
  Yv.prototype.close = Yv.prototype.close;
  Yv.prototype.open = function() {
    this.O(Zv.OPEN);
  };
  Yv.prototype.open = Yv.prototype.open;
  Yv.prototype.Ul = function() {
    return this.b || null;
  };
  Yv.prototype.getContentElement = Yv.prototype.Ul;
  Yv.prototype.$e = function(a2) {
    if (a2)
      if ("string" === typeof a2 || "number" === typeof a2.nodeType && "string" === typeof a2.nodeName)
        this.g = a2;
      else
        throw Error("InfoBubble content must be a string or HTML node.");
    else
      this.g = "";
    this.N() && (this.g ? (this.b.innerHTML = "", "string" === typeof this.g ? this.b.innerHTML = a2 : "number" === typeof a2.nodeType && "string" === typeof a2.nodeName && this.b.appendChild(a2)) : this.b.innerHTML = "&nbsp;", this.i());
  };
  Yv.prototype.setContent = Yv.prototype.$e;
  Yv.prototype.o = function() {
    this.close();
    this.$e("");
    this.c && Cu(this.c, "end", this.u);
    this.a && (this.a.c.removeEventListener("sync", this.update), this.a.b.removeEventListener("sync", this.update));
    Y.prototype.o.call(this);
  };
  function $v(a2, b2) {
    this.b = a2;
    this.a = null;
    this.f = 0;
    this.c = 22;
    this.i = b2;
    this.Xf = A(this.Xf, this);
    this.Sg = A(this.Sg, this);
    a2 = this.b.Lb();
    a2.addEventListener("mapviewchange", this.bo, false, this);
    this.g = a2.f.type;
    a2 = a2.a;
    a2.addEventListener("add", this.Sn, false, this);
    a2.addEventListener("remove", this.Tn, false, this);
  }
  function aw(a2, b2, c2) {
    var d = b2.ca();
    d && (void 0 === c2 ? 0 : c2) && d.removeEventListener("tap", a2.Xf);
    b2 ? (d.addEventListener("tap", a2.Xf), a2.f = d.min, a2.c = d.max) : (a2.f = 0, a2.c = 22);
  }
  p = $v.prototype;
  p.bo = function(a2) {
    var b2 = a2.newValue.zoom;
    this.a && a2.modifiers & a2.ZOOM && (b2 < this.f || b2 > this.c) && this.a.close();
  };
  p.Sn = function(a2) {
    a2 = a2.added;
    bw(a2) && aw(this, a2);
  };
  p.Tn = function(a2) {
    a2 = a2.removed;
    bw(a2) && (this.a && this.a.close(), aw(this, a2, true));
  };
  function bw(a2) {
    return window.H.service && (a2.ca() instanceof window.H.service.traffic.incidents.Provider || a2.ca() instanceof window.H.service.trafficVectorTile.Provider && "incident" === a2.ca().s().b);
  }
  p.Xf = function(a2) {
    var b2, c2 = this.g === kk.HARP;
    a2.target && (b2 = a2.target.getData()) && 0 === a2.currentPointer.button && (c2 ? (b2 = this.b.Lb().Pa(a2.currentPointer.viewportX, a2.currentPointer.viewportY), (c2 = a2.target.getData() ? a2.target.getData().properties.id : null) && this.i.requestIncidentById(c2, { locationReferencing: "none", lang: this.b.pa().a }, this.hl.bind(this, b2), console.error)) : (c2 = a2.target.ga(), this.hl(c2, b2)), a2.stopPropagation());
  };
  p.hl = function(a2, b2) {
    if (this.g === kk.HARP) {
      b2 = b2.incidentDetails;
      var c2 = this.b.pa().a, d = b2.type, e = d.split(/(?=[A-Z])/).join("_").toUpperCase();
      this.b.pa().Nf("traffic." + e) && (d = this.b.pa().translate("traffic." + e));
      a2 = { position: a2, title: d, description: b2.description.value, startTime: new Date(b2.startTime).toLocaleString(c2).split(",").join(" "), endTime: new Date(b2.endTime).toLocaleString(c2).split(",").join(" ") };
    } else
      c2 = b2.TRAFFIC_ITEM_TYPE_DESC.replace(" ", "_"), this.b.pa().Nf("traffic." + c2) ? c2 = this.b.pa().translate("traffic." + c2) : c2 = b2.TRAFFIC_ITEM_DESCRIPTION[b2.TRAFFIC_ITEM_DESCRIPTION.length - 1].value, a2 = { position: a2, title: c2, description: b2.TRAFFIC_ITEM_DESCRIPTION[0].value, startTime: b2.START_TIME, endTime: b2.END_TIME };
    this.Sg(a2);
  };
  p.Sg = function(a2) {
    var b2 = a2.position, c2 = a2.title, d = a2.description, e = a2.startTime;
    a2 = a2.endTime;
    this.a || (this.a = new Yv(b2), this.a.Ka("H_tib"), this.b.Yi(this.a));
    this.a.setPosition(b2);
    this.a.$e('<div class="H_tib_content"><div class="H_rdo_title" dir="auto">{{title}}</div><div class="H_tib_desc" dir="auto"><span>{{desc}}</span><div class="H_tib_time"><span class="H_tib_left">{{traffic.from}}</span><span class="H_tib_right">{{from}}</span><br/><span class="H_tib_left">{{traffic.until}}</span><span class="H_tib_right">{{until}}</span></div></div>'.replace("{{title}}", c2).replace(
      "{{desc}}",
      d
    ).replace("{{traffic.from}}", this.b.pa().translate("traffic.from")).replace("{{traffic.until}}", this.b.pa().translate("traffic.until")).replace("{{from}}", e).replace("{{until}}", a2));
    this.a.open();
  };
  function cw(a2, b2) {
    try {
      return a2.Qf = true, new a2(b2);
    } finally {
      a2.Qf = false;
    }
  }
  function dw(a2, b2) {
    var c2 = a2.N(), d = this;
    F.call(this);
    this.c = a2;
    this.i = c2.ownerDocument;
    this.f = {};
    this.b = [];
    this.S = yu(this.i, "div", "H_ui");
    this.setDirection();
    this.P = A(function(e) {
      this.m.put(e.target, e.target.Mc);
    }, this);
    this.addEventListener("alignmentchange", this.P);
    this.L = A(function() {
      this.fl();
    }, this);
    this.addEventListener("toggleunitsystem", this.L);
    this.S.addEventListener("contextmenu", this.J, false);
    this.S.addEventListener("MSHoldVisual", this.J, false);
    this.c.addEventListener("contextmenu", this.D, false, this);
    this.c.addEventListener("contextmenuclose", this.u, false, this);
    this.c.tb(this.F.bind(this));
    this.a = null;
    this.s = -1;
    this.m = new Uu(this.S, this.i);
    this.g = ev.METRIC;
    ew(this, "en-US");
    b2 && fw(this, b2);
    c2.appendChild(this.S);
    x.setTimeout(function() {
      d.m.update();
    }, 1);
  }
  u(dw, F);
  t("H.ui.UI", dw);
  dw.prototype.J = function(a2) {
    for (var b2 = a2.target; b2 && !/\bH_ib_content\b/.test(b2.className); )
      b2 = b2.parentNode;
    b2 || a2.preventDefault();
  };
  dw.prototype.N = function() {
    return this.S;
  };
  dw.prototype.getElement = dw.prototype.N;
  dw.prototype.Lb = function() {
    return this.c;
  };
  dw.prototype.getMap = dw.prototype.Lb;
  dw.prototype.dn = function() {
    return this.g;
  };
  dw.prototype.getUnitSystem = dw.prototype.dn;
  dw.prototype.vg = function(a2) {
    var b2 = this.f, c2;
    if (a2 !== this.g) {
      for (c2 in this.g = a2, b2)
        if (b2[c2] instanceof Ru)
          b2[c2].onUnitSystemChange(this.g);
    }
  };
  dw.prototype.setUnitSystem = dw.prototype.vg;
  dw.prototype.setDirection = function(a2) {
    this.S.setAttribute("dir", a2 || getComputedStyle(this.Lb().N()).direction);
  };
  dw.prototype.setDirection = dw.prototype.setDirection;
  function ew(a2, b2) {
    if (Cc(b2))
      var c2 = b2;
    else if (b2 instanceof Uv) {
      c2 = b2.a;
      var d = b2;
    } else
      throw Error("The locale parameter must be a string or a H.ui.i18n.Localization object.");
    if (c2)
      if (d)
        a2.l = d;
      else if (0 <= Ov.indexOf(c2))
        a2.l = new Uv(c2);
      else
        throw Error("Locale [" + c2 + "] is not supported.");
    else
      throw Error("No locale was defined.");
  }
  dw.prototype.pa = function() {
    return this.l;
  };
  dw.prototype.fl = function() {
    this.g === ev.METRIC ? this.vg(ev.IMPERIAL) : this.vg(ev.METRIC);
  };
  dw.prototype.toggleUnitSystem = dw.prototype.fl;
  dw.prototype.Yi = function(a2) {
    var b2 = this.b.length, c2 = this.S;
    if (0 > this.b.indexOf(a2)) {
      a2.ka(this);
      a2.Ia(this.c);
      var d = a2.W(this.i);
      b2 = 0 < b2 ? this.b[b2 - 1].N().nextSibling : this.S.firstChild;
      c2.insertBefore(d, b2);
      this.b.push(a2);
    }
  };
  dw.prototype.addBubble = dw.prototype.Yi;
  dw.prototype.D = function(a2) {
    var b2 = a2.items;
    this.a && this.u();
    clearTimeout(this.s);
    this.s = x.setTimeout((function() {
      b2.length && (this.a = new Xv(b2), this.S.insertBefore(this.a.W(this.i), this.S.firstChild), this.a.ka(this), this.a.Ia(this.c), this.a.setPosition(a2.viewportX, a2.viewportY));
    }).bind(this), 0);
  };
  dw.prototype.u = function() {
    this.a && (this.a.F(), this.a = null);
  };
  dw.prototype.jo = function(a2) {
    var b2 = this.b.indexOf(a2);
    -1 < b2 && (a2.ka(null), a2.Ia(null), this.b.splice(b2, 1), this.S.removeChild(a2.N()));
  };
  dw.prototype.removeBubble = dw.prototype.jo;
  dw.prototype.Ql = function() {
    return this.b;
  };
  dw.prototype.getBubbles = dw.prototype.Ql;
  dw.prototype.Bd = function(a2, b2) {
    if (this.Ce(a2))
      throw Error("A control with name [" + a2 + "] is already registered.");
    b2.ka(this);
    b2.Ia(this.c);
    b2.xa = this.l;
    b2.W(this.i);
    b2.onUnitSystemChange(this.g);
    this.f[a2] = b2;
  };
  dw.prototype.addControl = dw.prototype.Bd;
  dw.prototype.lo = function(a2) {
    var b2 = this.Ce(a2);
    if (b2)
      b2.T(), b2.ka(null), b2.Ia(null), Du(b2), delete this.f[a2];
    else
      throw Error("Control [" + a2 + "] not found in this UI's controls.");
    return b2;
  };
  dw.prototype.removeControl = dw.prototype.lo;
  dw.prototype.Ce = function(a2) {
    return this.f[a2];
  };
  dw.prototype.getControl = dw.prototype.Ce;
  dw.prototype.o = function() {
    for (var a2 in this.f)
      ju.hasOwnProperty.call(this.f, a2) && this.f[a2].F();
    this.b.forEach(function(b2) {
      b2.F();
    });
    (a2 = this.S.parentNode) && a2.removeChild(this.S);
    F.prototype.o.call(this);
    delete this.S;
  };
  function fw(a2, b2) {
    var c2, d;
    b2.unitSystem && a2.vg(b2.unitSystem);
    (d = b2.locale) && ew(a2, d);
    (c2 = b2.zoom) && a2.Bd("zoom", new Su(Ea(c2) ? c2 : null));
    (c2 = b2.zoomrectangle) && a2.Bd("zoomrectangle", new Tv(Ea(c2) ? c2 : null));
    (c2 = b2.mapsettings) && a2.Bd("mapsettings", new Ev(Ea(c2) ? c2 : null));
    (c2 = b2.scalebar) && a2.Bd("scalebar", new Vv(Ea(c2) ? c2 : null));
    (c2 = b2.distancemeasurement) && a2.Bd("distancemeasurement", new wv(Ea(c2) ? c2 : null));
  }
  dw.prototype.capture = function(a2, b2, c2, d) {
    var e = this.Ce("scalebar"), f2 = a2.getContext("2d"), g = a2.width, h = a2.height, k = this.c.s, l = 5 + (k ? k.N().childNodes[1].offsetHeight : 0);
    e && e.wc() ? e.capture(b2, function(m) {
      f2.drawImage(m, g - m.width - 5 * b2, h - m.height - l * b2);
      c2(a2);
    }, d) : c2(a2);
  };
  dw.prototype.capture = dw.prototype.capture;
  dw.createDefault = function(a2, b2, c2) {
    var d = a2.f.type;
    c2 = new dw(a2, { unitSystem: ev.METRIC, zoom: { alignment: "right-bottom" }, mapsettings: gw(d, b2, a2.g), scalebar: { alignment: "bottom-right" }, locale: c2 || "en-US" });
    if (d === kk.P2D) {
      var e = c2.Ce("mapsettings");
      var f2 = function() {
        if (e.Lb()) {
          var l = gw(d, b2, a2.g);
          Fv(e, l.baseLayers, l.layers);
        }
      };
      a2.addEventListener(a2.A.lf, f2);
      c2.tb(function() {
        a2.removeEventListener(a2.A.lf, f2);
      });
      e.tb(function() {
        a2.removeEventListener(a2.A.lf, f2);
      });
    }
    if (d === kk.HARP) {
      if (window.H.service) {
        var g = b2.vector.traffic.map.ca().s().v(), h = new window.H.service.Url(g.i, g.c.split(".").slice(-2).join("."));
        h = cw(window.H.service.traffic.Service7, { platformBaseUrl: h });
        var k = h.v().getQuery();
        k.apikey = g.getQuery().apikey;
        h.v().bf(k);
        new $v(c2, h);
      }
    } else
      new $v(c2);
    return c2;
  };
  dw.prototype.Bo = function() {
  };
  dw.prototype.setTrafficIncidentsHandle = dw.prototype.Bo;
  function hw(a2, b2, c2, d) {
    for (var e = a2, f2 = 0; e && f2 < b2.length; f2++)
      e = e[b2[f2]];
    if (e && e !== a2)
      return a2 = { label: c2, layer: e }, d.push(a2), a2;
  }
  function gw(a2, b2, c2) {
    var d = [], e = [], f2 = b2.raster;
    if (a2 === kk.P2D && f2) {
      hw(b2, ["raster", "normal", "map"], "layers.normal", d);
      hw(b2, ["raster", "satellite", "map"], "layers.satellite", d);
      hw(b2, ["raster", "terrain", "map"], "layers.terrain", d);
      if (c2) {
        for (var g in f2)
          if (f2[g] && f2[g].map === c2) {
            var h = g;
            break;
          }
      }
      hw(b2, ["raster", "normal", "trafficincidents"], "layer.incidents", e);
      hw(b2, ["raster", h, "transit"], "layer.transit", e);
    } else
      hw(b2, ["vector", "normal", "map"], "layers.normal", d), a2 === kk.WEBGL ? (hw(
        b2,
        ["raster", "satellite", "map"],
        "layers.satellite",
        d
      ), hw(b2, ["vector", "normal", "traffic"], "layer.traffic", e), hw(b2, ["vector", "normal", "trafficincidents"], "layer.incidents", e)) : (c2 = hw(b2, ["hybrid", "day", "vector"], "", []), f2 = hw(b2, ["hybrid", "day", "raster"], "layers.satellite", d), f2.layer = [f2.layer, c2.layer], window.H.service && (c2 = b2.vector.traffic.map.ca().s().v(), b2 = cw(window.H.service.trafficVectorTile.Service, { baseUrl: c2, layer: "flow" }), c2 = cw(window.H.service.trafficVectorTile.Service, { baseUrl: c2, layer: "incident" }), h = Ao() + "/harp/oslo/normal.day.json", f2 = new H.map.render.harp.Style(h), h = new H.map.render.harp.Style(h), b2 = b2.createLayer(f2, { engineType: a2 }), a2 = c2.createLayer(h, { engineType: a2 }), e.push({ label: "layer.traffic", layer: b2 }, { label: "layer.incidents", layer: a2 })));
    return { alignment: "bottom-right", baseLayers: d, layers: e };
  }
  ;
  function iw(a2, b2) {
    b2 = b2 || {};
    if (!(a2 && a2 instanceof sl))
      throw Error("Base layer is mandatory for overview UI element");
    Ru.call(this);
    this.c = new gv({ label: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="H_icon"><g fill-rule="evenodd" transform="translate(2 2)"><rect width="9" height="9" x="10" y="10"/><rect class="H_icon_stroke" width="18" height="18" x="1" y="1" fill="none" stroke="#000" stroke-width="2" rx="2"/></g></svg>', onStateChange: A(this.g, this) });
    this.Ja(this.c);
    this.b = new jw(a2, b2.zoomDelta, b2.scaleX, b2.scaleY);
    this.Vb(b2.alignment || "right-bottom");
    this.Ja(this.b);
  }
  u(iw, Ru);
  t("H.ui.Overview", iw);
  iw.prototype.ud = function(a2) {
    this.b.ud(a2);
    return this;
  };
  iw.prototype.setBaseLayer = iw.prototype.ud;
  iw.prototype.g = function(a2) {
    a2.target.getState() === Fu.DOWN ? (a2 = this.b, kw(a2, true), a2.Fi(), a2.Ka("H_overview_active"), a2.b.addEventListener("mapviewchange", a2.Fi, false, a2)) : lw(this.b);
  };
  iw.prototype.X = function(a2, b2) {
    Ru.prototype.renderInternal.call(this, a2, b2);
    this.c.N().style["float"] = this.Mc.match("right") ? "right" : "left";
    this.b.Ia(this.map);
    this.c.jc(this.pa().translate("minimap"));
  };
  iw.prototype.renderInternal = iw.prototype.X;
  iw.prototype.o = function() {
    this.b.F();
    Y.prototype.o.call(this);
  };
  function jw(a2, b2, c2, d) {
    this.l = a2;
    "number" === typeof b2 && (this.jl = b2);
    "number" === typeof c2 && (this.tk = c2);
    "number" === typeof d && (this.uk = d);
    Qu.call(this, "div", "H_overview");
  }
  u(jw, Ru);
  jw.prototype.ud = function(a2) {
    this.c.ud(a2);
  };
  jw.prototype.X = function(a2, b2) {
    b2 = yu(b2, "div", "H_overview_map");
    zu(a2, b2);
    this.g = b2;
  };
  jw.prototype.renderInternal = jw.prototype.X;
  jw.prototype.renderInternal = jw.prototype.X;
  p = jw.prototype;
  p.jl = 3;
  p.tk = 5;
  p.uk = 5;
  p.Ia = function(a2) {
    this.b = a2;
    this.c = new U(this.g, this.l, { pixelRatio: this.b.Xa(), engineType: this.b.f.type });
    this.c.s.N().style.display = "none";
    this.s = this.c.c;
    this.i = this.b.c;
  };
  function lw(a2) {
    !a2.zd && kw(a2);
    a2.kb("H_overview_active");
    a2.b.removeEventListener("mapviewchange", a2.Fi, false, a2);
  }
  p.Fi = function(a2) {
    a2 && a2.modifiers & a2.SIZE && kw(this, true);
    a2 = this.i.jb();
    a2.zoom -= this.jl;
    this.s.Wb(a2);
  };
  function kw(a2, b2) {
    var c2 = a2.b.b.element, d = a2.N().style, e = c2.offsetWidth / a2.tk / 10;
    c2 = c2.offsetHeight / a2.uk / 10;
    var f2 = a2.g.style;
    b2 ? (d.width = e + "em", d.height = c2 + "em", f2.width = e + "em", f2.height = c2 + "em") : d.width = d.height = "0em";
    a2.c.b.resize();
  }
  p.o = function() {
    jw.j.o.call(this);
    lw(this);
    this.c.F();
    this.c = this.s = this.i = this.b = this.l = this.g = null;
  };
  t("H.ui.buildInfo", function() {
    return Hf("H-ui", "1.49.1", "74e5afb", { region: "row" });
  });
  function mw(a2, b2) {
    if (!a2)
      throw new D(mw, 0, a2);
    mw.j.constructor.call(this, a2);
    this.b = {};
    this.c = !(!b2 || !b2.oc);
    this.f = nw++;
  }
  u(mw, Cm);
  var nw = 0;
  mw.prototype.W = function(a2, b2, c2, d, e, f2) {
    var g = Ad(d), h = this.eb, k = g + (c2.exp - h.pixelProjection.exp), l = h.min, m = h.max;
    d = h.tileSize;
    var n = h.ca().g, q = this.lb, r = q.Tc();
    var v = q.yb().w;
    var w = c2.w, y = c2.x, G = c2.y, I = {};
    if (g < l || g > m)
      return wk.DONE;
    e = h.requestTiles(a2, k, e, f2, this.f);
    a2 = e.total;
    e = e.tiles;
    f2 = e.length;
    this.g = c2;
    this.l = b2;
    this.a = k;
    r !== n && q.ic(n);
    c2 = d = d * w / (Gd(2, k) * d);
    this.c || (d % 1 && (d = Bd(d), w = c2 / d, y /= w, G /= w, w = Gd(2, k) * d), y = Bd(y), G = Bd(G));
    this.i = c2;
    k = -d;
    g = v + d;
    for (h = 0; h < f2; h++) {
      v = e[h];
      if ((l = v.data) && l.tagName) {
        c2 = b2.x - (y - v.x * d);
        n = b2.y - (G - v.y * d);
        q.Oc(l, c2, n, d, d);
        for (r = c2; (r -= w) > k; )
          q.Oc(l, r, n, d, d);
        for (r = c2; (r += w) < g; )
          q.Oc(l, r, n, d, d);
      }
      I[this.a + "_" + v.x + "_" + v.y] = v;
    }
    this.b = I;
    return f2 === a2 ? wk.DONE : wk.PENDING;
  };
  mw.prototype.Ea = function(a2, b2, c2) {
    var d = this.i, e = d / this.eb.tileSize, f2 = this.g, g = this.l, h;
    if (vc(this.a) && f2) {
      a2 = f2.x + (a2 - g.x);
      b2 = f2.y + (b2 - g.y);
      var k = Bd(f2.w / d);
      var l = f2 = Bd(a2 / d);
      g = Bd(b2 / d);
      Dd(l) >= k && (l %= k);
      0 > l && (l = k + l);
      (k = this.b[this.a + "_" + l + "_" + g]) && k.Ea && (h = k.Ea((a2 - d * f2) / e, (b2 - d * g) / e, c2));
    }
    return h || hf;
  };
  mw.prototype.Rd = function() {
    return "2d";
  };
  function ow(a2, b2) {
    b2 = b2 || {};
    C(a2, tl, ow, 0);
    ow.j.constructor.call(this, a2);
    this.oc = !!b2.oc;
    this.c = b2.fb || 0;
    this.a = [];
    this.b = {};
  }
  u(ow, Cm);
  ow.prototype.W = function(a2, b2, c2, d, e, f2) {
    var g, h = this.eb, k;
    d -= this.c;
    this.a.length = 0;
    var l = this.b;
    this.b = g = {};
    if (d >= h.min && d <= h.max) {
      var m = h.sd(a2, d, e, f2);
      var n = m.overlays;
      if (a2 = n.length)
        for (n.sort(ph), d = this.lb, e = this.oc, f2 = 0; f2 < a2; f2++) {
          h = n[f2];
          var q = h.K();
          var r = c2.ib(q.Nb());
          var v = c2.ib(q.Jb());
          q = c2.w;
          r.x >= v.x && (r.x -= q);
          q = -((r.x + v.x) / q >> 1) * q;
          r.x += q;
          r.add(b2);
          v.x += q;
          v.add(b2);
          e || (r.round(), v.round());
          (q = l[k = h.cb()]) ? delete l[k] : q = { ho: h };
          g[k] = q;
          var w = r.x;
          r = r.y;
          var y = v.x;
          v = v.y;
          var G = y - w;
          var I = v - r;
          d.ic(h.Tc());
          d.Oc(
            h.Qc(),
            w,
            r,
            G,
            I
          );
          q.Vg ? q.Vg.set(w, r, y, v) : q.Vg = new yk(w, r, y, v);
          this.a.push(q);
        }
    }
    return !m || m.requested && m.requested === m.total || !m.requested && n.length === m.total ? wk.DONE : wk.PENDING;
  };
  ow.prototype.Ea = function(a2, b2, c2) {
    for (var d = this.a, e = d.length, f2, g, h; e--; )
      if (f2 = d[e], g = f2.Vg, g.vf(a2, b2)) {
        if (f2 = f2.ho, h)
          h.push(f2);
        else if (h = [f2], c2)
          break;
      }
    return h || hf;
  };
  ow.prototype.Rd = function() {
    return "2d";
  };
  ow.prototype.o = function() {
    delete this.a;
    ow.j.o.call(this);
  };
  ow.prototype.disposeInternal = ow.prototype.o;
  var pw = { lookAt: { zoom: { min: -8, max: 24 }, tilt: { min: 0, max: 0 }, incline: { min: 0, max: 0 }, heading: { min: 180, max: 180 } }, interaction: { ZOOM: Nl.ZOOM, COORD: Nl.COORD }, capture: true };
  t("H.map.render.p2d.capabilities", pw);
  function qw(a2, b2) {
    this.a = [];
    qw.j.constructor.apply(this, arguments);
  }
  u(qw, Gm);
  p = qw.prototype;
  p.rj = function() {
    return this.eb.Ec.apply(this.eb, arguments);
  };
  p.W = function(a2, b2, c2, d, e, f2, g) {
    this.a = [];
    return qw.j.W.apply(this, arguments);
  };
  p.$j = 1;
  p.Ek = function(a2, b2, c2, d, e, f2) {
    var g = this.$j = d.Xa();
    e *= g;
    f2 *= g;
    var h = c2.yb();
    b2 = h.w * g;
    h = h.h * g;
    var k = c2.kd();
    this.oc ? (e -= k.x * g, f2 -= k.y * g) : (e = Ad(e - k.x * g), f2 = Ad(f2 - k.y * g));
    d.Oc(c2.Qc(), e, f2, b2, h);
    a2.detail ? a2.detail.set(e, f2, e + b2, f2 + h) : a2.detail = new yk(e, f2, e + b2, f2 + h);
    this.a.push(a2);
  };
  p.Ea = function(a2, b2, c2) {
    for (var d = this.a, e = d.length, f2, g, h, k = hf, l = this.$j; e-- && !(f2 = d[e], g = f2.detail, g.vf(a2, b2) && (f2 = f2.ik, (!(h = f2.xb().c) || h.Of((a2 - g.left) / l, (b2 - g.top) / l, 0)) && 0 > k.indexOf(f2) && (k === hf && (k = []), k.push(f2), c2))); )
      ;
    return k;
  };
  p.Rd = function() {
    return "2d";
  };
  p.o = function() {
    this.a = [];
    qw.j.o.call(this);
  };
  qw.prototype.disposeInternal = qw.prototype.o;
  function Z(a2, b2, c2, d) {
    Z.j.constructor.call(this, a2, b2, c2, d);
    this.L = new J(0, 0);
    if (c2 = d.renderBaseBackground)
      this.Xn = c2.lower, this.Hn = c2.higher;
    this.yn = !!d.enableSubpixelRendering;
    this.fd = rw;
    this.Af = 0;
    this.Ed = this.ve = false;
    this.g = new om();
    this.a = d = new wm();
    this.dd = A(this.dd, this);
    d.addEventListener(d.A.Cg, this.dd);
    this.Da = A(this.Da, this);
    d = a2.element;
    this.aa = a2 = d.ownerDocument.createElement("div");
    a2.style.position = "absolute";
    a2.style.width = a2.style.height = "100%";
    a2.style.zIndex = 0;
    d.insertBefore(a2, d.firstChild);
    this.sj = new Tm(this.aa, this.oa);
    this.m = [];
    sw(this);
    this.Jh = A(Z.prototype.Jh, this);
    this.C = tw;
    this.ng();
    this.zoom = uw(this, this.J.pb() + this.fb);
    this.Eb();
    vw(this, b2.jb().position, this.zoom);
    this.$a();
    this.T();
  }
  u(Z, Jl);
  t("H.map.render.p2d.RenderEngine", Z);
  Z.prototype.type = Tl.P2D;
  var tw = 2;
  Z.prototype.getState = function() {
    return this.C;
  };
  Z.prototype.getState = Z.prototype.getState;
  function ww(a2, b2, c2) {
    b2 = c2 - b2;
    return Dd(b2) < a2.b.w / 2 ? b2 : b2 - a2.b.w * c2 / Dd(c2);
  }
  Z.prototype.Kg = function(a2) {
    var b2 = this, c2 = a2.b, d = a2.newValue, e = a2.modifiers;
    a2 = d.position;
    var f2 = d.bounds, g, h = this.zoom, k = this.s, l = 0;
    e & ej.POSITION && (g = b2.b.ib(a2));
    if (e & ej.BOUNDS)
      d = xw(this, f2.K(), e & ej.ZOOM ? d.zoom : B, e & ej.POSITION ? a2 : B), this.J.Wb(d, c2);
    else {
      e & ej.POSITION || (g = b2.b.ib(d.position));
      var m = g.x;
      var n = g.y;
      yw(this);
      this.L.set(0, 0);
      d = zw(this, d);
      var q = d.zoom;
      var r = d.position;
      if (c2) {
        var v = q - h;
        var w = { x: k.x, y: k.y };
        c2 = this.b.Zd(w).x;
        var y = this.b.projection.Pc(a2);
        if (y.x !== this.s.x || y.y !== this.s.y || q !== this.zoom)
          m = ww(this, c2, m), Aw(this, function(G) {
            var I = G - l;
            if (q !== h) {
              g = b2.b.Zd(y);
              var Q = b2.b.Zd(w);
              m = ww(b2, Q.x, g.x);
              n = g.y - Q.y;
            }
            l = G;
            Bw(b2, m * I, n * I);
            h += v * I;
            Cw(b2, h);
            b2.$a();
            b2.ha();
          }, this.qa, function() {
            vw(b2, r, q);
            Cw(b2, q);
            b2.$a(r);
            b2.ha();
          }, this.xa);
      } else
        Dw(this), vw(this, r, q), Cw(this, q), this.$a(r);
      this.ha();
    }
  };
  Z.prototype.qa = 300;
  Z.prototype.rg = function(a2) {
    var b2 = Fc(a2);
    if (!b2 || b2 && 0 > a2)
      throw new D(this.rg, 1, "positive number required");
    this.qa = a2;
  };
  Z.prototype.setAnimationDuration = Z.prototype.rg;
  Z.prototype.$g = function() {
    return this.qa;
  };
  Z.prototype.getAnimationDuration = Z.prototype.$g;
  Z.prototype.xa = em;
  Z.prototype.sg = function(a2) {
    if (!Da(a2))
      throw new D(this.sg, 1, "function required");
    this.xa = a2;
  };
  Z.prototype.setAnimationEase = Z.prototype.sg;
  Z.prototype.ah = function() {
    return this.xa;
  };
  Z.prototype.getAnimationEase = Z.prototype.ah;
  Z.prototype.ng = function() {
    this.xa = em;
    this.qa = 300;
  };
  Z.prototype.resetAnimationDefaults = Z.prototype.ng;
  Z.prototype.Xh = function(a2, b2, c2) {
    var d;
    this.Nj = Lk();
    (d = this.R.ja.splice(a2, 1)[0]) && d.F && d.F();
    (d = this.u.ja.splice(a2, 1)[0]) && d.F && d.F();
    (d = this.ta.ja.splice(a2, 1)[0]) && d.F && d.F();
    (d = this.ea.ja.splice(a2, 1)[0]) && d.F && d.F();
    this.ab = this.c.La();
    0 === a2 && (Ol(this, b2, false), this.Eb());
    this.m = Um(this.sj, Ew(this), Fw(this));
    this.ce();
    c2 || this.ha();
  };
  function sw(a2) {
    var b2 = a2.c.La(), c2 = 0, d = b2.length;
    [a2.R = {}, a2.u = {}, a2.ta = {}, a2.ea = {}].forEach(function(e) {
      e.Nc = [];
      e.ja = [];
    });
    for (a2.ab = a2.c.La(); c2 < d; c2++)
      a2.Pe(c2, b2[c2]);
    a2.Eb();
  }
  Z.prototype.Yh = function() {
    this.Eb();
    this.ha();
  };
  Z.prototype.th = function(a2, b2, c2) {
    var d, e, f2, g;
    if (b2) {
      var h = { oc: this.yn, fb: this.fb };
      b2.W ? C(b2, Em) ? e = new Dm(b2) : C(b2, Qm) && (g = new Dm(b2)) : (b2.requestOverlays && (d = new ow(b2, h)), b2.requestTiles && (e = new mw(b2, h)), b2.requestMarkers && (f2 = new qw(b2, h)), b2.requestDomMarkers && (g = new Jm(b2, h)));
    }
    c2 = c2 || 0;
    this.R.ja.splice(a2, c2, d);
    this.u.ja.splice(a2, c2, e);
    this.ta.ja.splice(a2, c2, f2);
    this.ea.ja.splice(a2, c2, g);
    this.ab = this.c.La();
    this.m = Um(this.sj, Ew(this), Fw(this));
  };
  function Fw(a2) {
    var b2 = [];
    b2 = b2.concat(a2.u.ja);
    b2 = b2.concat(a2.R.ja);
    b2 = b2.concat(a2.ta.ja);
    b2 = b2.concat(a2.ea.ja);
    return b2 = b2.filter(vc);
  }
  function zw(a2, b2) {
    var c2 = Pl(a2, Pl(a2, b2.zoom) + a2.fb);
    a2 = Ql(a2, b2);
    a2.zoom = c2;
    return a2;
  }
  function vw(a2, b2, c2) {
    var d = a2.b;
    d.Oa(c2);
    a2.s = d.projection.Pc(b2);
    d.x = d.w * a2.s.x;
    d.y = d.h * a2.s.y;
  }
  Z.prototype.Pa = function(a2, b2) {
    var c2 = this.f.center, d = this.oa;
    return this.b.Ra((a2 - c2.x) * d, (b2 - c2.y) * d);
  };
  Z.prototype.screenToGeo = Z.prototype.Pa;
  Z.prototype.qg = function(a2, b2) {
    a2 = this.Pa(a2, b2);
    b2 = this.J.jb();
    b2.position = a2;
    return b2;
  };
  Z.prototype.Da = function(a2) {
    var b2 = this.oa, c2 = this.f.center, d = c2.x * b2;
    c2 = c2.y * b2;
    a2 = this.b.ib(a2);
    var e = this.b.w;
    return new J(Ad((a2.x - Ad(a2.x / e) * e + d) / b2), Ad((a2.y + c2) / b2));
  };
  Z.prototype.geoToScreen = Z.prototype.Da;
  Z.prototype.K = function(a2, b2) {
    var c2 = this.wa[a2 || 4];
    a2 = this.b;
    var d = c2.left - b2, e = a2.Ra(d, c2.top - b2), f2 = c2.right + b2;
    b2 = a2.Ra(f2, c2.bottom + b2);
    f2 - d >= a2.w && (e.lng = -(b2.lng = 180));
    return sg(e, b2);
  };
  Z.prototype.Ea = function(a2, b2, c2, d) {
    var e = [], f2 = this.oa, g;
    a2 *= f2;
    b2 *= f2;
    f2 = [this.R, this.u, this.ta, this.ea];
    for (g = f2.length; g-- && (!c2 || !e.length); ) {
      for (var h = e, k = f2[g].ja, l = a2, m = b2, n = c2, q = k.length; q-- && !((e = k[q]) && e.Ea && (h = h.concat(e.Ea(l, m, n)), h.length && n)); )
        ;
      e = h;
    }
    d(e);
  };
  Z.prototype.getObjectsAt = Z.prototype.Ea;
  Z.prototype.sb = z;
  function Ew(a2) {
    a2 = a2.wa[2];
    return { w: a2.right - a2.left, h: a2.bottom - a2.top };
  }
  Z.prototype.T = function() {
    var a2 = this.m.length, b2;
    Z.j.T.call(this);
    var c2 = Ew(this);
    this.L.set(0, 0);
    var d = c2.w;
    for (b2 = c2.h; a2--; ) {
      c2 = this.m[a2];
      var e = c2.yb();
      e.w === d && e.h === b2 || c2.cf(d, b2);
    }
    this.sb = new Wi(d, b2);
    this.ha();
  };
  Z.prototype.getCapabilities = function() {
    return pw;
  };
  Z.prototype.getCapabilities = Z.prototype.getCapabilities;
  function Gw(a2) {
    a2.i && a2.i.sa() || Lk() - a2.Nj < a2.fd && !a2.Ad ? a2.Yn = Jk(a2.Jh) : (a2.Ad && (a2.ce(), Hw(a2)), a2.C = tw);
  }
  p = Z.prototype;
  p.ce = function() {
    this.R.Nc.length = 0;
    this.u.Nc.length = 0;
    this.ta.Nc.length = 0;
    this.ea.Nc.length = 0;
  };
  p.Jh = function() {
    var a2;
    this.D && this.D.before();
    var b2 = this.u.ja;
    var c2 = this.f.center.clone().scale(this.oa).round();
    var d = this.K(1, 0);
    var e = this.K(1, Iw);
    var f2 = this.zoom;
    var g = f2 - this.fb;
    var h = this.b;
    var k = this.Xn;
    var l = this.Hn;
    var m = b2[0];
    b2 = this.L;
    var n = this.m.length;
    var q = this.ab;
    for (a2 = q.length; n--; ) {
      var r = this.m[n];
      C(r, Bm) && r.clear();
    }
    if (m) {
      if (k)
        for (; k; )
          n = f2 - k, m.W(d, c2, h, n, true, b2), --k;
      if (l && this.Ed)
        for (r = 1; r <= l && (n = f2 + r, h.Oa(n), k = this.K(2, 0), h.Oa(f2), !m.W(k, c2, h, n, true, b2)); r++)
          ;
    }
    for (this.fd = rw; a2--; )
      h = q[a2], C(
        h,
        qj
      ) && h.ca() && h.ca().Ue(e, g);
    d = this.Zj(d, c2, f2, false, b2, Jw, this.u, this.R);
    c2 = this.Zj(e, c2, g, false, b2, Kw, this.ta, this.ea);
    this.Ad = d && c2;
    this.i && this.i.sa() && this.me();
    this.P || (this.P = this.J.jb());
    this.P.bounds = this.K(4, 0);
    this.J.$a(this.P);
    this.P = null;
    this.sb && (this.f.$a(this.sb), this.sb = z);
    f2 < this.Af ? this.Ed = true : this.ve && (this.Ed = false);
    this.Af = f2;
    this.ve = d;
    this.D && this.D.after();
    Gw(this);
  };
  p.Zj = function(a2, b2, c2, d, e, f2, g) {
    var h = Array.prototype.slice.call(arguments, 6), k = h.length, l = h[0].ja.length, m = k * l, n = !!m, q;
    for (q = 0; q < m; q++) {
      if (f2 === Jw) {
        var r = q % k;
        var v = Math.floor(q / k);
      } else
        r = Math.floor(q / l), v = q % l;
      var w = h[r].ja[v];
      r = h[r].Nc;
      w && (w = w.W(a2, b2, this.b, c2, d, e, this.Da), w === wk.ACTIVE && (this.fd = Infinity), w !== wk.DONE || r[v] || (Hw(this, this.ab[v]), r[v] = true), r[v] || (n = false));
    }
    return n;
  };
  function Hw(a2, b2) {
    a2.dispatchEvent({ type: a2.A.Vi, target: b2 || a2 });
  }
  p.o = function() {
    var a2 = this.c.La()[0], b2 = this.f;
    Kk(this.Yn);
    Dw(this, true);
    a2 && Ol(this, a2, false);
    Fw(this).forEach(function(c2) {
      c2.F();
    });
    b2.element && b2.element.removeChild(this.aa);
    this.aa = null;
    this.C = 3;
    Z.j.o.call(this);
  };
  p.ha = function() {
    this.Nj = Lk();
    this.C === tw && (this.Ad = false, this.C = 1, Gw(this));
  };
  function Lw(a2, b2, c2) {
    Bw(a2, b2 * a2.oa, c2 * a2.oa);
    a2.L.set(0, 0);
    a2.$a();
    a2.ha();
  }
  function Bw(a2, b2, c2) {
    var d = a2.b;
    a2 = a2.s;
    d.x = Zd(d.x + b2, d.w);
    d.y = zd(0, yd(d.w, d.y + c2));
    a2.x = d.x / d.w;
    a2.y = d.y / d.h;
  }
  p.xd = function(a2, b2, c2) {
    a2 = Pl(this, Pl(this, a2) + this.fb);
    Cw(this, a2, b2, c2);
  };
  Z.prototype.zoomAt = Z.prototype.xd;
  function Cw(a2, b2, c2, d) {
    var e = a2.oa, f2 = a2.f.center;
    c2 === +c2 && d === +d ? (c2 = (c2 - f2.x) * e, d = (d - f2.y) * e, a2.L.set(c2, d), Bw(a2, c2, d), a2.b.Oa(b2), Bw(a2, -c2, -d)) : (a2.L.set(0, 0), a2.b.Oa(b2));
    a2.zoom = b2;
    a2.$a();
    a2.ha();
  }
  function xw(a2, b2, c2, d) {
    var e = a2.getCapabilities().lookAt.zoom.max, f2 = b2.bb(), g = d || f2;
    if (b2.Rf() || c2 && d)
      c2 = c2 === B ? e : c2;
    else {
      var h = new nj(a2.b.projection);
      h.Oa(e);
      var k = h.ib(b2.Nb()).round();
      var l = h.ib(b2.Jb()).round();
      e = h.w;
      b2.Bb() && (k.x -= e);
      d ? (f2 = h.ib(g), b2 = 2 * zd(f2.x - k.x, l.x - f2.x), k = 2 * zd(f2.y - k.y, l.y - f2.y)) : (b2 = l.x - k.x, k = l.y - k.y, g = f2);
      c2 === B && (f2 = a2.wa[4], c2 = f2.right - f2.left, f2 = f2.bottom - f2.top, c2 = -8 + yd(Ed(c2 / b2 * e) / Od, Ed(f2 / k * e) / Od) - a2.fb, c2 = Pl(a2, c2));
    }
    return { zoom: Bd(c2), position: g };
  }
  function yw(a2) {
    Dw(a2, true);
    a2.a.sa() && a2.vb(true);
    a2.g.sa() && a2.wb(true);
    Dw(a2, true);
  }
  Z.prototype.lc = function(a2, b2) {
    yw(this);
    Mw(this, b2);
    this.g.start(a2, !!b2);
  };
  Z.prototype.startInteraction = Z.prototype.lc;
  function Mw(a2, b2) {
    if (b2) {
      var c2 = {};
      c2.Te = b2.power;
      c2.we = b2.ease;
      c2.duration = b2.duration;
      a2.l = c2;
    }
  }
  function uw(a2, b2) {
    return Pl(a2, Pl(a2, b2 - a2.fb) + a2.fb);
  }
  Z.prototype.cc = function(a2, b2, c2, d, e) {
    var f2 = false;
    this.g.sa() && (b2 = this.g.store(a2, b2, c2, d, e), this.g.Ac(Nl.COORD) && (a2 = this.g.Nd(), 0 < nm(a2) && (Lw(this, -a2.x, -a2.y), f2 = true)), b2 && this.g.Ac(Nl.ZOOM) && (a2 = this.g.Bf(), b2 = this.g.Cf(), b2 = Ed(Gd(2, this.zoom) * b2) / Od, b2 !== this.zoom && (b2 = uw(this, b2), Cw(this, b2, a2.x, a2.y), f2 = true)), f2 && this.ha());
  };
  Z.prototype.interaction = Z.prototype.cc;
  Z.prototype.wb = function(a2) {
    var b2 = this;
    if (this.g.sa() && !a2) {
      if (this.l) {
        a2 = this.g.zb();
        var c2 = this.g.rc();
        var d = this.l.duration;
        var e = (this.l.Te || 1) * a2;
        var f2 = new Rm(-e / (0 < d ? d : 1), e);
        !E(c2.x) && !E(c2.y) && 0 < e && b2.g.Ac(Nl.COORD) && Aw(this, function(g) {
          e = f2.De(g * d);
          E(e) || Lw(b2, Ad(-c2.x * e), Ad(-c2.y * e));
        }, d, void 0, this.l.we);
      }
      this.l = null;
      this.g.clear();
    }
  };
  Z.prototype.endInteraction = Z.prototype.wb;
  Z.prototype.kc = function(a2, b2, c2) {
    yw(this);
    this.a.start(b2, c2);
    Mw(this, a2);
  };
  Z.prototype.startControl = Z.prototype.kc;
  Z.prototype.control = function(a2, b2, c2) {
    if (E(+c2))
      throw new D(this.control, 2, c2);
    if (E(a2))
      throw new D(this.control, 0, a2);
    if (E(b2))
      throw new D(this.control, 1, b2);
    this.a.sa() && this.a.set(a2, b2, c2, 0, 0, 0);
  };
  Z.prototype.control = Z.prototype.control;
  Z.prototype.vb = function(a2, b2) {
    var c2 = this, d;
    if (this.a.sa()) {
      Dw(this, true);
      var e = Lk();
      var f2 = e - this.Lj;
      if (1 <= f2) {
        var g = zm(this.a);
        Nw(this, g, f2);
      }
      if (!this.l || a2 || b2)
        "function" === typeof b2 && (a2 = this.jb(), a2.zoom = this.zoom - this.fb, b2(a2), a2.zoom += this.fb, Ow(this, a2));
      else {
        b2 = this.a.zb();
        var h = this.a.rc();
        var k = this.l.duration;
        var l = (this.l.Te || 1) * b2;
        var m = new Rm(-l / (0 < k ? k : 1), l);
        !E(h.a) && !E(h.b) && 0 < l && Aw(this, function(n, q, r, v) {
          e && (r = v - e, e = 0);
          l = m.De(n * k) * r;
          E(l) || ((d = h.c * l) && Cw(c2, uw(c2, c2.zoom + d), c2.a.a, c2.a.b), Lw(
            c2,
            Ad(h.a * l),
            Ad(h.b * l)
          ));
        }, k, void 0, this.l.we);
      }
      this.a.reset();
    }
  };
  Z.prototype.endControl = Z.prototype.vb;
  function Ow(a2, b2) {
    var c2 = a2.s, d = a2.b.projection.Pc(b2.position), e = a2.b.Zd(d), f2 = e.y;
    e = e.x;
    var g = b2.zoom;
    c2 = a2.b.Zd(c2);
    b2 = c2.y;
    var h = c2.x;
    c2 = a2.zoom;
    var k = a2.a.zb(), l = a2.a.a, m = a2.a.b, n = 0;
    e = ww(a2, h, e);
    e -= h;
    f2 -= b2;
    c2 = g - c2;
    b2 = Fd(e * e + f2 * f2 + c2 * c2);
    if (0 !== k && 0 !== b2) {
      var q = e / b2;
      var r = f2 / b2;
      var v = c2 / b2;
      var w = k * k / (2 * b2);
      Aw(a2, function(y, G) {
        var I;
        if (1 !== y) {
          y = k * G - w * G * G / 2;
          G = y - n;
          if (I = v * G)
            I = uw(a2, a2.zoom + I), Cw(a2, uw(a2, I), l, m);
          Lw(a2, Ad(q * G), Ad(r * G));
          n = y;
        } else
          a2.s = d, Cw(a2, uw(a2, g), l, m), a2.$a(), a2.ha();
      }, 2 * b2 / k);
    }
  }
  Z.prototype.dd = function(a2) {
    var b2 = this, c2 = a2.b;
    this.L.set(0, 0);
    c2.a || c2.b || c2.c ? (this.Lj = Lk(), Aw(this, function(d, e, f2, g) {
      b2.Lj = g;
      Nw(b2, c2, f2);
    }, Number.POSITIVE_INFINITY), this.ha()) : Dw(this, true);
  };
  function Nw(a2, b2, c2) {
    c2 = c2 || 0;
    b2.c && Cw(a2, uw(a2, a2.zoom + b2.c * c2), a2.a.atX, a2.a.atY);
    Lw(a2, b2.a * c2, b2.b * c2);
  }
  function Aw(a2, b2, c2, d, e) {
    a2.i && a2.i.sa() && a2.i.stop(true);
    a2.i = new Fm(a2, b2, c2, d, e);
    a2.i.start();
  }
  function Dw(a2, b2) {
    a2.i && a2.i.sa() && a2.i.stop(b2);
  }
  Z.prototype.Wg = function() {
  };
  Z.prototype.enter = Z.prototype.Wg;
  Z.prototype.Xg = function(a2) {
    Ml(this.aa, a2);
  };
  Z.prototype.exit = Z.prototype.Xg;
  Z.prototype.capture = function(a2, b2, c2, d) {
    var e = this.aa.ownerDocument.createElement("canvas"), f2 = e.getContext("2d"), g = this.oa;
    e.width = (c2 - a2) * g;
    e.height = (d - b2) * g;
    for (c2 = 0; c2 < this.m.length; c2++)
      d = this.m[c2], C(d, Bm) && f2.drawImage(d.N(), -a2 * g, -b2 * g);
    return Zb(e);
  };
  var Kw = 0, Jw = 1, rw = 1e3, Iw = 256;
  function Pw(a2) {
    var b2;
    if (a2)
      for (Qw = {}, b2 = a2.length; b2--; )
        Qw[a2[b2]] = true;
    this.Yk = {};
  }
  var Rw, Qw = {};
  Pw.prototype.parse = function(a2, b2, c2) {
    var d, e, f2, g, h;
    Rw = false;
    try {
      c2 = JSON.parse(c2);
    } catch (m) {
      Rw = true;
    }
    if (c2 && (d = c2.metadata)) {
      var k = { spatials: [] };
      for (e in d) {
        if (c2 = !Qw[e] && (f2 = Sw[e]))
          (g = d[e]) || (Rw = true, g = void 0), c2 = g;
        if (c2)
          for (c2 = g.length; c2--; ) {
            var l;
            (l = g[c2]) || (Rw = true, l = void 0);
            (h = l) && f2(b2, a2, this, e, h, k);
          }
      }
    } else
      Rw = true;
    return Rw ? void 0 : k;
  };
  Pw.prototype.parse = Pw.prototype.parse;
  var Sw = { "street labels": function(a2, b2, c2, d, e, f2) {
    var g;
    (g = e.vertices) || (Rw = true, g = void 0);
    if (g) {
      var h, k = g.length, l;
      (l = 0 < k) || (Rw = true, l = void 0);
      if (l)
        for (h = Array(k / 2); k; ) {
          var m = g[--k];
          l = g[--k];
          h[k / 2] = new J(l, m);
        }
      h = h ? { a: [h] } : B;
      k = +e["font size"] / a2.Xa();
      g = c2.Yk[k];
      g || (Tw.lineWidth = k, g = c2.Yk[k] = c2.Fd.vj(Tw));
      Uw(a2, b2, h, false, g, e, d, f2);
    }
    delete e.vertices;
  }, "city center labels": function(a2, b2, c2, d, e, f2) {
    Uw(a2, b2, Vw(e, new Ph([])), true, c2.Fd, e, d, f2);
  }, labels: function(a2, b2, c2, d, e, f2) {
    var g;
    (g = e["bounding boxes"]) || (Rw = true, g = void 0);
    if (g) {
      for (var h = g.length, k = new Ph([]), l; h--; ) {
        var m;
        (m = g[h]) || (Rw = true, m = void 0);
        (l = m) && Vw(l, k);
      }
      Uw(a2, b2, k, true, c2.Fd, e, d, f2);
    }
    delete e["bounding boxes"];
  }, buildings: function(a2, b2, c2, d, e, f2) {
    var g = e.id, h = b2.ig[g], k, l, m, n = [], q = [];
    (k = e) || (Rw = true, k = void 0);
    if (k && ((l = k.vertices) || (Rw = true, l = void 0), l)) {
      var r;
      (r = k.polygons) || (Rw = true, r = void 0);
      (m = r) && n.push.apply(n, Ww(l, m));
      (k = k.outlines) || (Rw = true, k = void 0);
      (m = k) && q.push.apply(q, Ww(l, m));
    }
    m = n.length;
    n.push.apply(n, q);
    q = new Ph(n, Wd, m);
    (n = n.length) || (Rw = true, n = void 0);
    n && (h ? (br(h, a2, [q]), f2.spatials.push(h)) : (h = Uw(a2, b2, q, true, c2.Fd, e, d, f2, g), b2.fa(h)));
  } };
  Sw["transit stops"] = Sw.POIs = Sw.labels;
  var Xw = ["box 2", "box 1", "annotation box", "icon box"];
  function Vw(a2, b2) {
    for (var c2 = Xw.length, d, e; c2--; )
      if (d = Xw[c2], e = a2[d]) {
        var f2 = e[0], g = e[1], h = e[2];
        e = e[3];
        b2.a.push([new J(f2, g), new J(f2 + h, g), new J(f2 + h, g + e), new J(f2, g + e)]);
        delete a2[d];
      }
    return b2;
  }
  function Ww(a2, b2) {
    var c2 = b2.length, d, e, f2;
    if (0 < c2) {
      for (e = Array(c2); c2--; )
        if ((d = b2[c2]) || (Rw = true, d = void 0), d) {
          var g = d.length;
          if (0 < g)
            for (e[c2] = f2 = Array(g); g--; ) {
              var h = 2 * d[g];
              f2[g] = new J(a2[h], a2[h + 1]);
            }
        }
    }
    return e || [];
  }
  var Yw = {};
  function Uw(a2, b2, c2, d, e, f2, g, h, k) {
    Yw.style = e;
    d = new Yq(b2, d, k, Yw);
    c2 && br(d, a2, [c2]);
    Zw(f2);
    f2.category = g;
    d.setData(f2);
    h.spatials.push(d);
    d.ka(b2);
    return d;
  }
  Pw.prototype.Fd = new wh({ strokeColor: "transparent", fillColor: "transparent", lineWidth: 0 });
  var Tw = {};
  function Zw(a2) {
    var b2, c2 = false;
    switch (typeof a2) {
      case "object":
        if (a2 instanceof Array)
          for (b2 = a2.length; b2--; )
            Zw(a2[b2]) ? c2 = true : delete a2[b2];
        else if (a2)
          for (b2 in a2)
            Zw(a2[b2]) ? c2 = true : delete a2[b2];
        break;
      case "number":
        c2 = true;
        break;
      default:
        c2 = !!a2;
    }
    return c2;
  }
  ;
  function $w(a2, b2, c2) {
    c2 = c2 || {};
    b2 = b2 || {};
    var d = c2.tileType || "maptile", e = c2.scheme || "normal.day";
    S.call(this, { min: 0, max: 20 });
    true === b2.pois && (b2.pois = "!F");
    this.L = b2;
    if (!(a2 && a2 instanceof ax))
      throw Error("InvalidArgument: service required");
    this.m = a2;
    this.i = A(this.i, this);
    this.m.addEventListener("versionupdate", this.i);
    this.Yb = a2.v().clone().G(d + "/" + a2.vc() + "/" + e).I(bx).I(b2);
    this.R = a2.f || null;
    this.T = c2.pixelRatio || c2.pixelratio || Ue();
    this.tileSize = c2.tileSize || 256;
    this.tileType = d;
    this.scheme = e;
    this.f = new hr(new Pw(c2.categoryFilter));
    this.f.ka(this);
    this.u = A(this.u, this);
    this.f.addEventListener("update", this.u);
    this.D = false;
    S.call(this, { min: 0, max: 20 });
    this.J(new Rk(c2.tileCacheSize || 256, A(this.aa, this)));
  }
  u($w, S);
  t("H.service.metaInfo.TileProvider", $w);
  $w.prototype.aa = function(a2, b2) {
    a2 = b2.Ua();
    for (var c2 = a2.length, d; c2--; )
      d = a2[c2], delete d.a[b2.key], d.release();
    b2.data && (Cp.push(b2.gg(), this.tileSize), b2.hg());
  };
  $w.prototype.u = function() {
    this.dispatchEvent("update");
  };
  $w.prototype.B = function(a2, b2, c2, d, e) {
    var f2 = this.Yb.clone(), g = this.R, h = this.tileSize, k = this.getTileKey(a2, b2, c2);
    k = this.nb().get(k);
    var l;
    if (k && !k.Ud()) {
      d(Cp.pop(this.tileSize), null);
      var m = { cancel: function() {
      } };
    } else {
      g && f2.Ba(g[(c2 + b2 + a2) % g.length]);
      f2.G(c2 + "/" + a2 + "/" + b2 + "/" + h + "/png8");
      var n = Ap.setTimeout(function() {
        l = new tf("text/plain", f2.toString());
        l.then(function(q) {
          d(null, q);
        }, e);
      }, 500);
    }
    this.D || (zp($w, "Use HERE Vector Tile API or Raster Tile API v3 instead."), this.D = true);
    return m || { cancel: function() {
      l ? l.cancel() : Ap.clearTimeout(n);
    } };
  };
  $w.prototype.requestInternal = $w.prototype.B;
  $w.prototype.ac = function(a2, b2, c2, d, e) {
    var f2 = this.f;
    var g = d || Cp.pop(this.tileSize);
    if (d)
      a2 = this.nb().get(this.getTileKey(a2, b2, c2)), a2.W(d);
    else if (d = a2 = new al(this.uc(a2, b2, c2), a2, b2, c2, this.tileSize, this.T, c2, f2), delete d.l, d.s = e, a2.W(g))
      for (e = a2.Ua(), g = e.length; g--; )
        e[g].pg();
    else
      Cp.push(g, this.tileSize);
    return a2;
  };
  $w.prototype.createTileInternal = $w.prototype.ac;
  $w.prototype.F = function() {
    this.f.F();
    this.m.removeEventListener("versionupdate", this.i);
    S.prototype.F.call(this);
  };
  $w.prototype.dispose = $w.prototype.F;
  $w.prototype.i = function() {
    var a2 = this.m;
    this.Yb = a2.v().clone().G(this.tileType + "/" + a2.vc() + "/" + this.scheme).I(bx).I(this.L);
    this.reload(false);
  };
  var bx = { metadata: "metaonly", mgen: "2" };
  function ax(a2) {
    ax.j.constructor.call(this, ax, a2);
    a2 = Pp(this, a2);
    this.f = a2.shards;
    (this.b = a2.ignoreTypes ? null : a2.type) && this.v().Ba(this.b);
    this.c = a2.version;
    this.l = new lq();
    "newest" === this.c && cx(this);
  }
  u(ax, Op);
  t("H.service.metaInfo.Service", ax);
  ax.prototype.Aa = function() {
    return { type: "base", version: "newest", subDomain: "maps.ls", path: "maptile/2.1", shards: ["1", "2", "3", "4"] };
  };
  ax.CONFIG_KEY = "metaInfo";
  function dx(a2, b2) {
    for (var c2 = {}, d = a2[b2 + "s"][b2], e = d.length; e--; )
      c2[d[e].id] = d[e];
    a2[b2 + "s"] = c2;
  }
  ax.prototype.Hj = function() {
    return this.b;
  };
  ax.prototype.vc = function() {
    return this.c;
  };
  ax.prototype.getVersion = ax.prototype.vc;
  ax.prototype.ba = function() {
    return this.l;
  };
  ax.prototype.getCopyrights = ax.prototype.ba;
  function cx(a2) {
    var b2 = a2.v().clone().G("info").I({ output: "json" });
    a2.f && b2.Ba(a2.f[0]);
    a2.B(b2, function(c2) {
      c2 = c2.response;
      var d;
      dx(c2, "map");
      dx(c2, "scheme");
      dx(c2, "tiletype");
      dx(c2, "format");
      dx(c2, "resolution");
      dx(c2, "language");
      if ("newest" === a2.c && "traffic" !== a2.b)
        for (d in c2.maps)
          c2.maps[d].hash && c2.maps[d].newest && (a2.c = c2.maps[d].hash, a2.dispatchEvent("versionupdate"));
      a2.s = c2;
      a2.dispatchEvent("infoupdate");
    }, function(c2) {
      throw c2;
    });
  }
  ax.prototype.Fe = function() {
    return this.s;
  };
  ax.prototype.getInfo = ax.prototype.Fe;
  ax.prototype.ue = function(a2, b2, c2, d, e, f2) {
    return new $w(this, d, { tileSize: a2, pixelRatio: b2, categoryFilter: c2, tileType: e, scheme: f2 });
  };
  ax.prototype.createTileProvider = ax.prototype.ue;
  ax.prototype.nc = function(a2, b2, c2, d, e, f2) {
    return new sl(this.ue(a2, b2, c2, d, e, f2));
  };
  ax.prototype.createTileLayer = ax.prototype.nc;
  X.prototype.Aj = function(a2) {
    return this.Ma(ax, a2);
  };
  X.prototype.getMetaInfoService = X.prototype.Aj;
  (function() {
    var a2 = X.prototype.createDefaultLayers;
    X.prototype.createDefaultLayers = function(b2, c2, d, e, f2, g) {
      var h = a2.call(this, b2, c2, d, e, f2, g), k = {}, l = this.Aj();
      "object" === typeof b2 && (g = b2, b2 = g.tileSize, c2 = g.ppi, d = g.lg, e = g.lg2, f2 = g.style, g = g.pois);
      b2 = b2 || 256;
      var m = 320 === c2 ? 2 : 1;
      if (0 > [72, 250, 320, 500].indexOf(+c2)) {
        if (c2 !== B)
          throw new D(this.wf, 1, c2);
      } else
        k.ppi = +c2;
      d && (k.lg = d);
      e && (k.lg2 = e);
      f2 && (k.style = f2);
      g && (k.pois = g);
      h.raster.normal.metaInfo = l.nc(b2, m, ["buildings"], k);
      return h;
    };
  })();
  H.__bootstrap__ = `var l,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(a,b){if(b){var c=ba;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}var ea;
if("function"==typeof Object.setPrototypeOf)ea=Object.setPrototypeOf;else{var fa;a:{var ha={lb:!0},ja={};try{ja.__proto__=ha;fa=ja.lb;break a}catch(a){}fa=!1}ea=fa?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ka=ea;ca("Object.setPrototypeOf",function(a){return a||ka});var p=this||self;
function la(a,b,c){a=a.split(".");c=c||p;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}function ma(){}
function na(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function r(a){return"function"==na(a)}function oa(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var pa="closure_uid_"+(1E9*Math.random()>>>0),ra=0;function sa(a,b,c){return a.call.apply(a.bind,arguments)}
function ta(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function ua(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ua=sa:ua=ta;return ua.apply(null,arguments)}
function va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function t(a,b){la(a,b,void 0)}function wa(a,b){function c(){}c.prototype=b.prototype;a.U=b.prototype;a.prototype=new c;a.prototype.constructor=a};function v(){}t("H.util.ICache",v);v.prototype.add=function(){};v.prototype.add=v.prototype.add;v.prototype.get=function(){};v.prototype.get=v.prototype.get;v.prototype.sa=function(){};v.prototype.drop=v.prototype.sa;v.prototype.forEach=function(){};v.prototype.forEach=v.prototype.forEach;v.prototype.S=function(){};v.prototype.removeAll=v.prototype.S;v.prototype.aa=function(){};v.prototype.registerOnDrop=v.prototype.aa;v.prototype.qa=function(){};v.prototype.deRegisterOnDrop=v.prototype.qa;function xa(){var a=ya,b;for(b in a)return!1;return!0}function za(a){var b={},c;for(c in a)b[c]=a[c];return b}var Aa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ba(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Aa.length;f++)c=Aa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Ca=this;function Da(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Da);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}wa(Da,Error);Da.prototype.name="CustomError";var Ea=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var Fa=ua,Ga=String,Ha=Ca.Object.freeze||function(a){return a},x=[].pop(),Ia=/x/.exec("");function Ja(a){return Ga(a).split(","!==x?",":" ")}var Ma="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Na(a,b,c,d){if(!(b=a instanceof b)&&c)throw new y(c,d,void 0!==x?void 0:a);return b}function Oa(a,b,c,d){var e;if(!(e="Array"===Pa(a))&&b)throw new y(b,c,d!==x?d:a);return e}
t("H.lang.isArray",function(a,b,c,d){return Oa(a,b,c,d)});function Qa(a){return"string"===typeof a}t("H.lang.isString",Qa);var Ra=isNaN;function Sa(a){return a===+a}t("H.lang.isNumber",Sa);t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(a){return"number"===typeof a&&0===a%1});function Pa(a){var b=Object[Ma[0]][Ma[6]].call(a).match(/^\\[object (\\w+)\\]$/);return b?b[1]:typeof a}var Ta=[];0>Ta.indexOf(Ta)&&Ta.push(Ta);
function Ua(a,b,c,d){var e="",f=2>arguments.length,g;f&&(b={H:Ca.H},c="",d=Ta.slice());Va(b,!0,function(h,k){try{if(g=h[k],k=Wa(h,g),!(oa(g)&&g.window===g&&g.self===g||oa(g)&&0<g.nodeType&&r(g.cloneNode))&&oa(g)){if(g===a)return e=c+"."+k,!0;if(0>d.indexOf(g)&&(d.push(g),e=Ua(a,g,c+"."+k,d)))return!0}}catch(m){}});f&&(e=e?e.substr(1).replace("."+Ma[0]+".","#"):"~"+(r(a)?Xa(a)+"()":Pa(a)));return e}
function Wa(a,b){var c=[];Va(a,!1,function(d,e){d[e]===b&&c.push(e)});return c.sort(Ya)[0]}function Ya(a,b){return b.length-a.length}var Za=Object[Ma[0]][Ma[2]];function Va(a,b,c){var d;if(a){for(e in a)if((!b||Za.call(a,e))&&c(a,e,!0))return;for(d=Ma.length;d--;){var e=Ma[d];if((!b||Za.call(a,e))&&c(a,e,!1))break}}}function Xa(a){return(a=/^\\s*function ([^\\( ]+)/.exec(a))?a[1]:"anonymous"}function $a(a,b,c){c[b]="#"+b};function A(a,b,c){this.g=[];b&&this.aa(b);if(c&&!r(c))throw new y(A,2,c);this.b=0;this.filter=c;this.a={};this.f=this.c=null;this.Ha(a)}t("H.util.Cache",A);A.prototype.add=function(a,b,c){var d,e;c=+c;if(!Sa(c)||0>c)throw new y(this.add,2,c);a=String(a);if(e=this.filter?this.filter(a,b,c):!0)(d=this.a[a])?(d.data!==b&&ab(this,d),this.b+=c-d.size,d.size=c,d.data=b,eb(this,d)):this.a[a]=fb(this,{id:a,data:b,size:c,m:null,C:null},this.c),gb(this);return e};A.prototype.add=A.prototype.add;
A.prototype.aa=function(a){if(!r(a))throw new y(this.aa,0,a);this.g.push(a)};A.prototype.registerOnDrop=A.prototype.aa;A.prototype.qa=function(a){this.g=this.g.filter(function(b){return b!==a})};A.prototype.deRegisterOnDrop=A.prototype.qa;A.prototype.get=function(a,b){return(a=b?this.a[a]:eb(this,this.a[a]))&&a.data};A.prototype.get=A.prototype.get;A.prototype.sa=function(a){var b;(b=this.a[a])&&hb(this,b,!0)};A.prototype.drop=A.prototype.sa;
A.prototype.forEach=function(a,b,c){var d;for(d in this.a){var e=this.a[d];(c?c(d,e.data,e.size):1)&&a.call(b,d,e.data,e.size)}};A.prototype.forEach=A.prototype.forEach;A.prototype.S=function(a){var b;for(b in this.a){var c=this.a[b];(a?a(b,c.data,c.size):1)&&hb(this,this.a[b],!0)}};A.prototype.removeAll=A.prototype.S;A.prototype.Ha=function(a){if(!(0<+a))throw new y(A.prototype.Ha,0,a);this.i=+a;gb(this);return this};A.prototype.setMaxSize=A.prototype.Ha;A.prototype.Bb=function(){return this.i};
A.prototype.getMaxSize=A.prototype.Bb;A.prototype.xb=function(){return this.b};A.prototype.getCurrentSize=A.prototype.xb;function eb(a,b){b&&(a.c=fb(a,b,a.c));return b}function gb(a){for(;a.b>a.i&&a.f;)hb(a,a.f,!0)}function fb(a,b,c){if(c!==b){(b.m||b.C)&&hb(a,b,!1);if(b.m=c)b.C=c.C,c.C=b;b.C||(a.c=b);b.m||(a.f=b);a.b+=b.size}return b}function hb(a,b,c){var d=b.C,e=b.m;if(d||e||b==a.c&&b==a.f)d?d.m=e:a.c=e,e?e.C=d:a.f=d,a.b-=b.size,c&&(delete a.a[b.id],ab(a,b));b.m=b.C=null}
function ab(a,b){for(var c=a.g.length;c--;)a.g[c].call(a,b.id,b.data,b.size)};function B(){}t("H.service.extension.dataView.ITable",B);B.prototype.xa=function(){};B.prototype.getMeta=B.prototype.xa;B.prototype.ya=function(){};B.prototype.getRowCount=B.prototype.ya;B.prototype.ga=function(){};B.prototype.getRow=B.prototype.ga;B.prototype.A=function(){};B.prototype.getColumnNames=B.prototype.A;B.prototype.wa=function(){};B.prototype.getColumn=B.prototype.wa;B.prototype.l=function(){};B.prototype.getCell=B.prototype.l;B.prototype.concat=function(){};B.prototype.concat=B.prototype.concat;function ib(){}t("H.service.extension.dataView.IRow",ib);ib.prototype.A=function(){};ib.prototype.getColumnNames=ib.prototype.A;ib.prototype.l=function(){};ib.prototype.getCell=ib.prototype.l;ib.prototype.za=function(){};ib.prototype.getTable=ib.prototype.za;function jb(a,b){this.a=a;this.b=b}t("H.service.extension.dataView.ObjRow",jb);jb.prototype.A=function(){return this.a.A()};jb.prototype.getColumnNames=jb.prototype.A;jb.prototype.l=function(a){return this.a.l(this.b,a)};jb.prototype.getCell=jb.prototype.l;jb.prototype.za=function(){return this.a};jb.prototype.getTable=jb.prototype.za;function kb(){}t("H.service.extension.dataView.IColumn",kb);kb.prototype.l=function(){};kb.prototype.getCell=kb.prototype.l;function lb(a,b){this.b=a;this.a=b}t("H.service.extension.dataView.ObjColumn",lb);lb.prototype.l=function(a){return this.b.l(a,this.a)};lb.prototype.getCell=lb.prototype.l;function y(a,b,c){var d=arguments.length;b=b!==x?+b:b;if(b!==x){var e=(e=/^.*?\\(([^\\)]+)/.exec((""+a).replace(/(\\/\\*([\\s\\S]*?)\\*\\/)|(\\/\\/(.*)$)/gm,"")))?Ja(e[1].replace(/\\s+/g,"")):[];e.forEach($a);e=e[b]||"#"+b}var f=a?Ua(a):"";d=2<d?Ga(c):"";if(e||d)f+=" (Argument "+(e||"")+(d?" "+d:"")+")";d=Error(f);Object.setPrototypeOf(d,y.prototype);return d}wa(y,Error);t("H.lang.InvalidArgumentError",y);y.prototype.name="InvalidArgumentError";function C(a,b,c){var d;b=b||(a&&a.length?Object.keys(a[0]):x);this.D=a;if(b)for(this.M=b,this.pa=a=Object.create(Ia,void 0),d=b.length;d--;)a[b[d]]=!0;c!==x&&(this.Ca=c)}t("H.service.extension.dataView.ObjTable",C);l=C.prototype;l.Ca=x;l.D=x;l.M=x;l.pa=x;l.xa=function(){return this.Ca};C.prototype.getMeta=C.prototype.xa;C.prototype.ya=function(){return this.D?this.D.length:0};C.prototype.getRowCount=C.prototype.ya;C.prototype.ga=function(a){var b=this.D;return b&&b[a]?new jb(this,a):x};
C.prototype.getRow=C.prototype.ga;C.prototype.A=function(){return this.M||mb};C.prototype.getColumnNames=C.prototype.A;C.prototype.wa=function(a){return this.pa[a]?new lb(this,a):x};C.prototype.getColumn=C.prototype.wa;C.prototype.l=function(a,b){var c=this.D;return(a=c&&this.pa[b]&&c[a])&&a[b]};C.prototype.getCell=C.prototype.l;
C.prototype.concat=function(){var a=arguments.length,b,c=this.M,d=""+this.M,e=(this.D||[]).slice();for(b=0;b<a;b++){var f=arguments[b];if(!(f instanceof C))throw new y(this.concat,b);if(f.D){if(c&&""+f.M!==d)throw new y(this.concat,b,"Incompatible columns!");e=e.concat(f.D)}}return new C(e,this.M,this.Ca)};C.prototype.concat=C.prototype.concat;var D=Math,nb=D.min,ob=D.max,pb=D.round,qb=D.floor,rb=D.ceil,sb=D.abs,tb=D.log,ub=D.sqrt,vb=D.pow,wb=D.exp,xb=D.sin,yb=D.asin,zb=D.cos,Ab=D.tan,Bb=D.atan,Cb=D.atan2,Db=D.LN2,E=D.PI,Eb=E/2,Fb=E/4,Gb=2*E,Hb=3*E,Ib=E/180,Kb=180/E,Lb=1/0;vb(-2,53);function Mb(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}t("H.math.normalize",function(a,b,c){b-=c=c||0;a-=c;return a-qb(a/b)*b+c});function Nb(a,b,c){return a>c?c:a<b?b:a}t("H.math.clamp",Nb);function Ob(a,b,c){return b<c?a>=b&&a<=c:a>=c&&a<=b}
function Pb(a,b,c,d,e,f){return ub(vb((a-e)*(d-f)-(b-f)*(c-e),2)/(vb(c-e,2)+vb(d-f,2)))}var Qb={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t("H.math.CoverType",Qb);
function Rb(a,b,c){for(var d=c.length,e=d,f,g,h,k,m=c[0],n=0,q=0,u=0;1!=n&&1<e;){g=c[--e];f=c[--e];k=c[e?e-1:(d+(e-1))%d];h=c[e?e-2:(d+(e-2))%d];if(f>=a&&f<=a&&g>=b&&g<=b||h>=a&&h<=a&&k>=b&&k<=b)n=1;else if(!n&&f===a)h===a&&(g<b&&k>b||g>b&&k<b)||(m<=a&&h>a||m>=a&&h<a)&&(g>=b?++q:++u),n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0;else if(!n&&Ob(a,f,h)){if(f<a&&h>a||f>a&&h<a)m=g+(a-f)/(h-f)*(k-g),q+=m>b,u+=m<b;n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0}m=f}!n&&0!==u&&0!==q%2&&(n=3);return n}
function Sb(a,b){return Rb(a.x,a.y,b)!==Qb.NONE}t("H.math.isPointInsidePolygon",Sb);function Tb(a){for(var b=a.length,c=new Float64Array(2*b),d=b&&a[0].x!==x;b--;){var e=a[b],f=b<<1;c[f]=d?e.x:e[0];c[f+1]=d?e.y:e[1]}return c}t("H.math.flatten",Tb);function F(a,b){this.x=+a;this.y=+b}t("H.math.Point",F);F.prototype.set=F;F.prototype.set=F.prototype.set;F.prototype.clone=function(a){a?(a.x=this.x,a.y=this.y):a=new F(this.x,this.y);return a};F.prototype.clone=F.prototype.clone;F.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};F.prototype.add=F.prototype.add;F.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};F.prototype.sub=F.prototype.sub;F.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};
F.prototype.scale=F.prototype.scale;F.prototype.round=function(){this.x=pb(this.x);this.y=pb(this.y);return this};F.prototype.round=F.prototype.round;F.prototype.floor=function(){this.x=qb(this.x);this.y=qb(this.y);return this};F.prototype.floor=F.prototype.floor;F.prototype.ceil=function(){this.x=rb(this.x);this.y=rb(this.y);return this};F.prototype.ceil=F.prototype.ceil;F.prototype.F=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};F.prototype.equals=F.prototype.F;
F.prototype.Cb=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=a;if(c||d){var f=((this.x-a.x)*c+(this.y-a.y)*d)/(c*c+d*d);0>=f?e=a:1<=f?e=b:e=new F(a.x+f*c,a.y+f*d)}return e};F.prototype.getNearest=F.prototype.Cb;F.prototype.ra=function(a){return ub(vb(this.x-a.x,2)+vb(this.y-a.y,2))};F.prototype.distance=F.prototype.ra;F.fromIPoint=function(a){if(!a)throw Error("invalid argument");return a instanceof F?a:new F(a.x,a.y)};function Ub(a,b,c,d,e,f){var g,h,k=a.length,m,n;if(k)for(g=[];k--;){var q=a[k];var u=q.length;var I=0;for(m=1;m<u;m++)if(n=Vb(q[m-1],q[m],c,b,d,e)){var L=n[0];var w=n[1];I&&I.F(L)?h.push(w):g.push(h=n);I=w;f&&(m=u,k=0)}}else g=a;return g}t("H.math.clipping.clipStrips",Ub);
function Vb(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;c=-c;f=-f;if(g>h){if(h>e||g<d)return;var k=g;var m=a;g=h;a=b;h=k;b=m;k=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;var n=1;a=-a;b=-b;m=f;f=-c;c=-m}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);n&&(a=-a,b=-b);return k?[new F(h,-b),new F(g,-a)]:[new F(g,-a),new F(h,-b)]}
function Wb(a,b,c){a=Xb(a,!0);b=Xb(b,!1);var d,e;var f={};var g=d=1;switch(~~(c||0)){case 1:g=d=0;break;case 2:d=0;g=1;break;case 3:d=1,g=0}c=d;var h=g;if(b&&a){b.W=new Yb(b.x,b.y,null,Zb(b));a.W=new Yb(a.x,a.y,null,Zb(a));for(g=b;g.next;g=g.next)if(!g.u)for(d=a;d.next;d=d.next)if(!d.u){var k=$b(g.next);var m=$b(d.next);if(e=ac(g,k,d,m,f)){e=f.mb;var n=f.nb;var q=f.ec;var u=f.fc;e=new Yb(q,u,null,null,null,null,!0,0,0,e);bc(e,g,k);k=new Yb(q,u,null,null,null,null,!0,0,0,n);bc(k,d,m);e.Da=k;k.Da=e}}f=
Sb(b,cc(a));c&&(f=!f);for(g=b;g;g=g.next)g.u&&(g.Aa=f,f=!f);f=Sb(a,cc(b));h&&(f=!f);for(d=a;d.next;d=d.next)d.u&&(d.Aa=f,f=!f);dc(b);for(dc(a);(a=ec(b))!=b;){for(c=null;!a.na;a=a.Da){for(f=a.Aa;;){c=new Yb(a.x,a.y,c);c.artificial=a.u||a.Wa;a.na=1;a=f?a.next:a.o;if(!a)break;if(a.u){a.na=1;break}}if(!a)break}c.Za=I||null;var I=c}return I}}t("H.math.clipping.clipPolygon",Wb);
function Yb(a,b,c,d,e,f,g,h,k,m){this.x=a;this.y=b;this.next=c||null;this.o=d||null;this.Za=e||null;this.Da=f||null;this.u=!!g;this.Aa=!!h;this.na=k||0;this.alpha=m||0;d&&(d.next=this);c&&(c.o=this);this.Wa=!1;this.W=null}function $b(a){for(;a&&a.u;)a=a.next;return a}function Zb(a){if(a)for(;a.next;)a=a.next;return a}function ec(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.u||b.u&&b.na))}return b}function dc(a){var b=Zb(a);b.o.next=a;a.o=b.o}
function ac(a,b,c,d,e){var f,g=b.x-a.x,h=b.y-a.y;var k=d.x-c.x;var m=d.y-c.y;var n=g*m-h*k;if(!n)return 0;k=((c.x-a.x)*m-(c.y-a.y)*k)/n;n=(h*(c.x-a.x)-g*(c.y-a.y))/n;if(0>k||1<k||0>n||1<n)return 0;0===k?f=a:1===k?f=b:0===n?f=c:1===n&&(f=d);if(f)return f.x+=2.480549651603763E-5,f.y+=7.321997314118067E-5,f.W&&(f.W.x=f.x,f.W.y=f.y),ac(a,b,c,d,e);e.ec=a.x+k*g;e.fc=a.y+k*h;e.mb=k;e.nb=n;return 1}function cc(a){for(var b=[];a;)b.push(a.x,a.y),a=a.next;return b}
function bc(a,b,c){for(b=b.next;b!==c&&b.alpha<=a.alpha;)b=b.next;a.next=b;a.o=b.o;a.next.o=a;a.o.next=a}function Xb(a,b){for(var c,d=null,e=0,f=a.length;e<f;e++){c=new Yb(a[e].x,a[e].y,d);c.Wa=b;if(c.next=d)d.o=c;d=c}return d};function fc(a,b){var c=[];a&&c.push(Ua(a));1<arguments.length&&c.push(""+b);c=Error(c.join(" "));Object.setPrototypeOf(c,fc.prototype);return c}wa(fc,Error);t("H.lang.IllegalOperationError",fc);fc.prototype.name="IllegalOperationError";function gc(){this.constructor=this.constructor;if(!Qa("STATIC_DB"))throw new y(this.constructor,0);this.i=hc();if(!this.i)throw new fc(this.constructor,"This browser does not support IndexedDB");this.a=[];this.c=[];this.g=Fa(this.g,this)}var ic,jc;gc.prototype.get=function(a,b,c){var d;if(!Qa(a)&&!Sa(a))throw new y(this.get,0);if(!r(b))throw new y(this.get,1);kc(this,function(e){d=e.get(a);lc(d,b,c)},c);return{cancel:function(){d&&(d.onsuccess=mc)}}};
gc.prototype.g=function(){var a=this.b.result;a.objectStoreNames.contains("data")||a.createObjectStore("data")};
function nc(a,b,c){if(a.b)a.a?(a.a.push(b),c&&a.c.push(c)):a.f?c&&c(a.f):b(a.b.result);else{a.b=a.i.open("H_STATIC_DB",1);a.b.onupgradeneeded=a.g;var d=a.b.onerror=function(){clearTimeout(a.j);a.f=this.error;a.c.forEach(function(e){e(a.f)});delete a.a;delete a.c};a.j=setTimeout(function(){d.call({error:Error("DbOpenTimeoutError")})},500);a.b.onsuccess=function(){clearTimeout(a.j);a.a?(a.a.forEach(function(e){e(this.result)},this),delete a.a,delete a.c):(delete a.b,delete a.f,a.a=[],a.c=[])};
a.a.push(b);c&&a.c.push(c)}}function kc(a,b,c){nc(a,function(d){d=d.transaction(["data"],"readwrite");b(d.objectStore("data"))},c)}function lc(a,b,c){b&&(a.onsuccess=function(){b(this.result)});c&&(a.onerror=function(){c(this.error)})}t("H.util.IndexedDBStorage.getInstance",function(){ic||(ic=new gc);return ic});function hc(){return Ca.indexedDB||Ca.webkitIndexedDB||Ca.mozIndexedDB||Ca.msIndexedDB}
t("H.util.IndexedDBStorage.isSupported",function(){var a="";if(jc===x)if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)jc=!1;else{try{var b=hc();a="H_TEST_DB";var c=b&&b.open(a,1)}catch(d){}jc=!!c&&null===c.onupgradeneeded;c&&b.deleteDatabase&&b.deleteDatabase(a)}return jc});function J(){0!=oc&&(pc[this[pa]||(this[pa]=++ra)]=this);this.c=this.c;this.a=this.a}var oc=0,pc={};J.prototype.c=!1;J.prototype.s=function(){if(!this.c&&(this.c=!0,this.v(),0!=oc)){var a=this[pa]||(this[pa]=++ra);if(0!=oc&&this.a&&0<this.a.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete pc[a]}};
J.prototype.L=function(a,b){this.c?void 0!==b?a.call(b):a():(this.a||(this.a=[]),this.a.push(void 0!==b?ua(a,b):a))};J.prototype.v=function(){if(this.a)for(;this.a.length;)this.a.shift()()};function K(a,b){this.type=a;this.currentTarget=this.target=b;this.a=!1;this.ab=!0}K.prototype.stopPropagation=function(){this.a=!0};K.prototype.c=function(){this.ab=!1};t("H.util.Event",K);K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.CAPTURING_PHASE=1;K.prototype.CAPTURING_PHASE=K.prototype.CAPTURING_PHASE;K.prototype.AT_TARGET=2;K.prototype.AT_TARGET=K.prototype.AT_TARGET;K.prototype.BUBBLING_PHASE=3;K.prototype.BUBBLING_PHASE=K.prototype.BUBBLING_PHASE;K.prototype.eventPhase=0;K.prototype.eventPhase=K.prototype.eventPhase;function qc(a,b,c){qc.U.constructor.call(this,a,c);this.data=b}wa(qc,K);t("H.util.DataEvent",qc);function rc(a,b,c){rc.U.constructor.call(this,a,c);this.message=b}wa(rc,K);t("H.util.ErrorEvent",rc);function sc(){}t("H.util.ICancelable",sc);sc.prototype.cancel=function(){};sc.prototype.cancel=sc.prototype.cancel;function tc(a,b){this.c=a;this.f=b;this.b=0;this.a=null}tc.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.c();return a};function uc(a,b){a.f(b);100>a.b&&(a.b++,b.next=a.a,a.a=b)};function vc(){this.b=this.a=null}var xc=new tc(function(){return new wc},function(a){a.reset()});vc.prototype.add=function(a,b){var c=xc.get();c.set(a,b);this.b?this.b.next=c:this.a=c;this.b=c};function yc(){var a=zc,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function wc(){this.next=this.b=this.a=null}wc.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};wc.prototype.reset=function(){this.next=this.b=this.a=null};var Ac=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]};function Bc(a,b){return a<b?-1:a>b?1:0};var Cc;a:{var Dc=p.navigator;if(Dc){var Ec=Dc.userAgent;if(Ec){Cc=Ec;break a}}Cc=""}function M(a){return-1!=Cc.indexOf(a)};function Hc(a,b){this.b=a===Ic&&b||"";this.a=Jc}var Jc={},Ic={},Kc=new Hc(Ic,"");function Lc(a,b){this.b=a===Mc&&b||"";this.a=Nc}var Nc={},Mc={};function Oc(){this.a="";this.b=Pc}function Qc(){var a=Rc;if(a instanceof Oc&&a.constructor===Oc&&a.b===Pc)return a.a;na(a);return"type_error:SafeHtml"}var Pc={};function Sc(a){var b=new Oc;b.a=a;return b}Sc("<!DOCTYPE html>");var Rc=Sc("");Sc("<br>");function Tc(a){var b=new Lc(Mc,Kc instanceof Hc&&Kc.constructor===Hc&&Kc.a===Jc?Kc.b:"type_error:Const");b instanceof Lc&&b.constructor===Lc&&b.a===Nc?b=b.b:(na(b),b="type_error:TrustedResourceUrl");a.src=b.toString()};function Uc(a){Uc[" "](a);return a}Uc[" "]=ma;var Vc=M("Opera"),Wc=M("Trident")||M("MSIE"),Xc=M("Edge"),Yc=M("Gecko")&&!(-1!=Cc.toLowerCase().indexOf("webkit")&&!M("Edge"))&&!(M("Trident")||M("MSIE"))&&!M("Edge"),Zc=-1!=Cc.toLowerCase().indexOf("webkit")&&!M("Edge");function $c(){var a=p.document;return a?a.documentMode:void 0}var ad;
a:{var bd="",cd=function(){var a=Cc;if(Yc)return/rv:([^\\);]+)(\\)|;)/.exec(a);if(Xc)return/Edge\\/([\\d\\.]+)/.exec(a);if(Wc)return/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a);if(Zc)return/WebKit\\/(\\S+)/.exec(a);if(Vc)return/(?:Version)[ \\/]?(\\S+)/.exec(a)}();cd&&(bd=cd?cd[1]:"");if(Wc){var dd=$c();if(null!=dd&&dd>parseFloat(bd)){ad=String(dd);break a}}ad=bd}var ed={},fd;fd=p.document&&Wc?$c():void 0;function gd(a){var b=document;a=String(a);"application/xhtml+xml"===b.contentType&&(a=a.toLowerCase());return b.createElement(a)};function hd(a){p.setTimeout(function(){throw a;},0)}var id;
function jd(){var a=p.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!M("Presto")&&(a=function(){var e=gd("IFRAME");e.style.display="none";Tc(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(Qc());e.close();var g="callImmediate"+Math.random(),h="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=ua(function(k){if(("*"==h||k.origin==h)&&k.data==g)this.port1.onmessage()},
this);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if("undefined"!==typeof a&&!M("Trident")&&!M("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.Pa;c.Pa=null;e()}};return function(e){d.next={Pa:e};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in gd("SCRIPT")?function(e){var f=gd("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;
f.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){p.setTimeout(e,0)}};function kd(a,b){ld||md();nd||(ld(),nd=!0);zc.add(a,b)}var ld;function md(){if(p.Promise&&p.Promise.resolve){var a=p.Promise.resolve(void 0);ld=function(){a.then(od)}}else ld=function(){var b=od;!r(p.setImmediate)||p.Window&&p.Window.prototype&&!M("Edge")&&p.Window.prototype.setImmediate==p.setImmediate?(id||(id=jd()),id(b)):p.setImmediate(b)}}var nd=!1,zc=new vc;function od(){for(var a;a=yc();){try{a.a.call(a.b)}catch(b){hd(b)}uc(xc,a)}nd=!1};function pd(a){this.a=qd;this.j=void 0;this.f=this.b=this.c=null;this.g=this.i=!1;if(a!=ma)try{var b=this;a.call(void 0,function(c){rd(b,sd,c)},function(c){rd(b,td,c)})}catch(c){rd(this,td,c)}}var qd=0,sd=2,td=3;function ud(){this.next=this.c=this.b=this.f=this.a=null;this.g=!1}ud.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var vd=new tc(function(){return new ud},function(a){a.reset()});function wd(a,b,c){var d=vd.get();d.f=a;d.b=b;d.c=c;return d}
function xd(a,b,c){yd(a,b,c,null)||kd(va(b,a))}function zd(a){return new pd(function(b,c){var d=a.length,e=[];if(d)for(var f=function(m,n){d--;e[m]=n;0==d&&b(e)},g=function(m){c(m)},h=0,k;h<a.length;h++)k=a[h],xd(k,va(f,h),g);else b(e)})}function Ad(){var a,b,c=new pd(function(d,e){a=d;b=e});return new Bd(c,a,b)}pd.prototype.then=function(a,b,c){return Cd(this,r(a)?a:null,r(b)?b:null,c)};pd.prototype.$goog_Thenable=!0;
pd.prototype.cancel=function(a){if(this.a==qd){var b=new Dd(a);kd(function(){Ed(this,b)},this)}};function Ed(a,b){if(a.a==qd)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.g||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==qd&&1==d?Ed(c,b):(f?(d=f,d.next==c.f&&(c.f=d),d.next=d.next.next):Fd(c),Gd(c,e,td,b)))}a.c=null}else rd(a,td,b)}function Hd(a,b){a.b||a.a!=sd&&a.a!=td||Id(a);a.f?a.f.next=b:a.b=b;a.f=b}
function Cd(a,b,c,d){var e=wd(null,null,null);e.a=new pd(function(f,g){e.f=b?function(h){try{var k=b.call(d,h);f(k)}catch(m){g(m)}}:f;e.b=c?function(h){try{var k=c.call(d,h);void 0===k&&h instanceof Dd?g(h):f(k)}catch(m){g(m)}}:g});e.a.c=a;Hd(a,e);return e.a}pd.prototype.Ea=function(a){this.a=qd;rd(this,sd,a)};pd.prototype.Ga=function(a){this.a=qd;rd(this,td,a)};
function rd(a,b,c){a.a==qd&&(a===c&&(b=td,c=new TypeError("Promise cannot resolve to itself")),a.a=1,yd(c,a.Ea,a.Ga,a)||(a.j=c,a.a=b,a.c=null,Id(a),b!=td||c instanceof Dd||Jd(a,c)))}function yd(a,b,c,d){if(a instanceof pd)return Hd(a,wd(b||ma,c||null,d)),!0;if(a)try{var e=!!a.$goog_Thenable}catch(g){e=!1}else e=!1;if(e)return a.then(b,c,d),!0;if(oa(a))try{var f=a.then;if(r(f))return Kd(a,f,b,c,d),!0}catch(g){return c.call(d,g),!0}return!1}
function Kd(a,b,c,d,e){function f(k){h||(h=!0,d.call(e,k))}function g(k){h||(h=!0,c.call(e,k))}var h=!1;try{b.call(a,g,f)}catch(k){f(k)}}function Id(a){a.i||(a.i=!0,kd(a.P,a))}function Fd(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);return b}pd.prototype.P=function(){for(var a;a=Fd(this);)Gd(this,a,this.a,this.j);this.i=!1};
function Gd(a,b,c,d){if(c==td&&b.b&&!b.g)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Ld(b,c,d);else try{b.g?b.f.call(b.c):Ld(b,c,d)}catch(e){Md.call(null,e)}uc(vd,b)}function Ld(a,b,c){b==sd?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function Jd(a,b){a.g=!0;kd(function(){a.g&&Md.call(null,b)})}var Md=hd;function Dd(a){Da.call(this,a)}wa(Dd,Da);Dd.prototype.name="cancel";function Bd(a,b,c){this.a=a;this.b=b;this.reject=c};function Nd(a,b,c){this.type=a;this.data=b;this.a=Ad();this.Xa=Fa(this.Xa,this);this.reject=Fa(this.reject,this);this.priority=Od;c!==x&&(this.priority=c);this.b().add(this)}var Od=1,Pd={hc:0,ic:Od,gc:2};l=Nd.prototype;l.then=function(a,b,c){return this.a.a.then(a,b,c)};l.Xa=function(a){this.Z=3;this.a.b(a)};l.reject=function(a){this.Z=5;this.a.reject(a)};l.Z=0;
l.cancel=function(){if(3>this.Z){this.c();var a=this.b(),b=this.priority,c=a.a[b].indexOf(this);-1<c?a.a[b].splice(c,1):this.Ma&&a.ca.qb(this.Ma);this.Z=4}};Nd.prototype.cancel=Nd.prototype.cancel;function Qd(a){var b;this.a={};for(b in Pd)this.a[Pd[b]]=[];this.ca=a;this.ca.addEventListener("allocatable",Fa(this.b,this))}t("H.util.JobManager",Qd);var Rd=Object.keys(Pd).map(function(a){return Pd[a]}).sort().reverse();Qd.prototype.add=function(a){Na(a,Nd,this.add,0);this.a[a.priority].push(a);this.b()};Qd.prototype.contains=function(a){return-1<this.a[a.priority].indexOf(a)};
Qd.prototype.b=function(){Rd.forEach(function(a){this.a[a]=this.a[a].filter(function(b){var c;if((c=this.ca.jc(b))!==Ia){var d=Fa(this.ca.qb,this.ca,c,b);b.Ma=c;b.then(d,d);b.Z=b.kc(c)?1:5}else return!0},this)},this)};function Sd(a,b,c){var d=[],e=arguments.length;a&&d.push(Ua(a));1<e&&(e=2<e&&Oa(c,void 0,void 0,void 0)?" out of ["+c[0]+"..."+c[1]+"]":"",d.push("("+b+e+")"));d=Error(d.join(" "));Object.setPrototypeOf(d,Sd.prototype);return d}wa(Sd,Error);t("H.lang.OutOfRangeError",Sd);Sd.prototype.name="OutOfRangeError";var Td="closure_listenable_"+(1E6*Math.random()|0),Ud=0;function Vd(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.ha=e;this.key=++Ud;this.T=this.da=!1}function Wd(a){a.T=!0;a.listener=null;a.proxy=null;a.src=null;a.ha=null};function Xd(a){this.src=a;this.a={};this.b=0}Xd.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=Yd(a,b,d,e);-1<g?(b=a[g],c||(b.da=!1)):(b=new Vd(b,this.src,f,!!d,e),b.da=c,a.push(b));return b};function Zd(a,b){var c=b.type;if(c in a.a){var d=a.a[c],e=Ea(d,b),f;(f=0<=e)&&Array.prototype.splice.call(d,e,1);f&&(Wd(b),0==a.a[c].length&&(delete a.a[c],a.b--))}}
Xd.prototype.S=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,Wd(d[e]);delete this.a[c];this.b--}return b};function Yd(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.T&&f.listener==b&&f.capture==!!c&&f.ha==d)return e}return-1};var $d;($d=!Wc)||($d=9<=Number(fd));var ae=$d,be;
if(be=Wc){var ce;if(Object.prototype.hasOwnProperty.call(ed,"9"))ce=ed["9"];else{for(var de=0,ee=Ac(String(ad)).split("."),fe=Ac("9").split("."),ge=Math.max(ee.length,fe.length),he=0;0==de&&he<ge;he++){var ie=ee[he]||"",je=fe[he]||"";do{var ke=/(\\d*)(\\D*)(.*)/.exec(ie)||["","","",""],le=/(\\d*)(\\D*)(.*)/.exec(je)||["","","",""];if(0==ke[0].length&&0==le[0].length)break;de=Bc(0==ke[1].length?0:parseInt(ke[1],10),0==le[1].length?0:parseInt(le[1],10))||Bc(0==ke[2].length,0==le[2].length)||Bc(ke[2],le[2]);
ie=ke[3];je=le[3]}while(0==de)}ce=ed["9"]=0<=de}be=!ce}var me=be,ne=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{p.addEventListener("test",ma,b),p.removeEventListener("test",ma,b)}catch(c){}return a}();function oe(a,b){K.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.b=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(Yc){a:{try{Uc(b.nodeName);var e=!0;break a}catch(f){}e=
!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=
a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:pe[a.pointerType]||"";this.b=a;a.defaultPrevented&&this.c()}}wa(oe,K);var pe={2:"touch",3:"pen",4:"mouse"};oe.prototype.stopPropagation=function(){oe.U.stopPropagation.call(this);this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0};
oe.prototype.c=function(){oe.U.c.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,me)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var qe="closure_lm_"+(1E6*Math.random()|0),re={},se=0;function te(a,b,c,d,e){if(d&&d.once)ue(a,b,c,d,e);else if("array"==na(b))for(var f=0;f<b.length;f++)te(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!1,oa(d)?!!d.capture:!!d,e):we(a,b,c,!1,d,e)}
function we(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=oa(e)?!!e.capture:!!e,h=xe(a);h||(a[qe]=h=new Xd(a));c=h.add(b,c,d,g,f);if(!c.proxy){d=ye();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)ne||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(ze(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");se++}}
function ye(){var a=Ae,b=ae?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function ue(a,b,c,d,e){if("array"==na(b))for(var f=0;f<b.length;f++)ue(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!0,oa(d)?!!d.capture:!!d,e):we(a,b,c,!0,d,e)}
function Be(a,b,c,d,e){if("array"==na(b))for(var f=0;f<b.length;f++)Be(a,b[f],c,d,e);else(d=oa(d)?!!d.capture:!!d,c=ve(c),a&&a[Td])?(a=a.b,b=String(b).toString(),b in a.a&&(f=a.a[b],c=Yd(f,c,d,e),-1<c&&(Wd(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=xe(a))&&(b=a.a[b.toString()],a=-1,b&&(a=Yd(b,c,d,e)),(c=-1<a?b[a]:null)&&Ce(c))}
function Ce(a){if("number"!==typeof a&&a&&!a.T){var b=a.src;if(b&&b[Td])Zd(b.b,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(ze(c),d):b.addListener&&b.removeListener&&b.removeListener(d);se--;(c=xe(b))?(Zd(c,a),0==c.b&&(c.src=null,b[qe]=null)):Wd(a)}}}function ze(a){return a in re?re[a]:re[a]="on"+a}
function De(a,b,c,d){var e=!0;if(a=xe(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.T&&(f=Ee(f,d),e=e&&!1!==f)}return e}function Ee(a,b){var c=a.listener,d=a.ha||a.src;a.da&&Ce(a);return c.call(d,b)}
function Ae(a,b){if(a.T)return!0;if(!ae){if(!b)a:{b=["window","event"];for(var c=p,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new oe(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.a&&0<=e;e--){b.currentTarget=d[e];var f=De(d[e],a,!0,b);c=c&&f}for(e=0;!b.a&&e<d.length;e++)b.currentTarget=
d[e],f=De(d[e],a,!1,b),c=c&&f}return c}return Ee(a,new oe(b,this))}function xe(a){a=a[qe];return a instanceof Xd?a:null}var Fe="__closure_events_fn_"+(1E9*Math.random()>>>0);function ve(a){if(r(a))return a;a[Fe]||(a[Fe]=function(b){return a.handleEvent(b)});return a[Fe]};function N(){J.call(this);this.b=new Xd(this);this.j=this;this.i=null}wa(N,J);N.prototype[Td]=!0;l=N.prototype;l.B=function(){return this.i};l.la=function(a){this.i=a};l.addEventListener=function(a,b,c,d){te(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){Be(this,a,b,c,d)};
l.dispatchEvent=function(a){var b,c=this.B();if(c)for(b=[];c;c=c.B())b.push(c);c=this.j;var d=a.type||a;if("string"===typeof a)a=new K(a,c);else if(a instanceof K)a.target=a.target||c;else{var e=a;a=new K(d,c);Ba(a,e)}e=!0;if(b)for(var f=b.length-1;!a.a&&0<=f;f--){var g=a.currentTarget=b[f];e=g.N(d,!0,a)&&e}a.a||(g=a.currentTarget=c,e=g.N(d,!0,a)&&e,a.a||(e=g.N(d,!1,a)&&e));if(b)for(f=0;!a.a&&f<b.length;f++)g=a.currentTarget=b[f],e=g.N(d,!1,a)&&e;return e};
l.v=function(){N.U.v.call(this);this.b&&this.b.S(void 0);this.i=null};l.N=function(a,b,c){a=this.b.a[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.T&&f.capture==b){var g=f.listener,h=f.ha||f.src;f.da&&Zd(this.b,f);d=!1!==g.call(h,c)&&d}}return d&&0!=c.ab};t("H.util.EventTarget",N);N.prototype.la=N.prototype.la;N.prototype.setParentEventTarget=N.prototype.la;N.prototype.B=N.prototype.B;N.prototype.getParentEventTarget=N.prototype.B;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.dispatchEvent=N.prototype.dispatchEvent;
N.prototype.dispatchEvent=N.prototype.dispatchEvent;N.prototype.s=N.prototype.s;N.prototype.dispose=N.prototype.s;N.prototype.L=N.prototype.L;N.prototype.addOnDisposeCallback=N.prototype.L;N.prototype.P=N.prototype.N;
N.prototype.N=function(a,b,c){var d,e,f=!0;var g=c[c.currentTarget===c.target?"AT_TARGET":b?"CAPTURING_PHASE":(d=!0,"BUBBLING_PHASE")];if(!d||"pointerenter"!==(e=c.type)&&"pointerleave"!==e)c.eventPhase=g,f=N.prototype.P.apply(this,arguments),d&&this.B&&null===this.B()&&delete c.eventPhase;return f};N.prototype.Yb=function(a){for(var b,c=this;c&&(b=c.B())&&b!==a;)c=b;b||c.la(a)};N.prototype.setRootParentEventTarget=N.prototype.Yb;function Q(a){a=a||{};var b=a.callback;this.g=a.label;r(b)&&(this.callback=b);this.f=!!a.disabled;Q.U.constructor.call(this)}wa(Q,N);t("H.util.ContextItem",Q);Q.prototype.zb=function(){return this.g};Q.prototype.getLabel=Q.prototype.zb;Q.prototype.Xb=function(a){this.g!==a&&(this.g=a,this.dispatchEvent("update"));return this};Q.prototype.setLabel=Q.prototype.Xb;Q.prototype.Ob=function(){return this.f};Q.prototype.isDisabled=Q.prototype.Ob;
Q.prototype.Wb=function(a){a!==this.f&&(this.f=a,this.dispatchEvent("update"));return this};Q.prototype.setDisabled=Q.prototype.Wb;var Ge=new Q;Q.SEPARATOR=Ge;function Ie(a){if(Ca.document){var b=document.createElement("canvas");b.width=b.height=1;b.getContext("2d",{lc:a})}}t("H.util.getPixelRatio",function(){return window.devicePixelRatio||1});Object.create(Ia,void 0);t("H.util.eval",function(a){return eval(a)});t("H.util.provide",function(a){var b=p.$jscomp;if(b&&("function"!=typeof b.wb?0:b.wb()))throw Error("goog.provide cannot be used within a module.");la(a,void 0)});function Je(){this.m=0}
Je.prototype.next=function(a){if(9007199254740992===this.m)throw new Sd(a,this.m,[0,9007199254740991]);return this.m++};var Ke=new Je;Fa(Ke.next,Ke);function mc(){}var mb=Ha([]);Ha({});Ie(!0);Ie(!1);function Le(a,b,c){var d=Nb(+a,-90,90);if(b&&Ra(d))throw new y(b,c,a);return d}function Me(a,b,c){var d=+a;if(-180>d||180<d)d=Mb(d+180,360)-180;if(b&&Ra(d))throw new y(b,c,a);return d}function Ne(a,b,c){var d;if(a!==x&&Ra(d=+a)&&b)throw new y(b,c,a);return d}t("H.geo.isDBC",function(a,b){return 0>a!==0>b&&180<sb(b-a)});function R(){var a=R;if(!0===(Na(this,a)&&this.constructor===a))throw new TypeError("Illegal constructor "+Ua(a));}t("H.geo.AbstractGeometry",R);R.prototype.getBoundingBox=R.prototype.X;R.prototype.equals=R.prototype.F;R.prototype.oa="";R.prototype.va="";R.prototype.toString=function(){return this.eb([this.oa.toUpperCase()," "]).join("")};R.prototype.toString=R.prototype.toString;R.prototype.$b=function(){return{type:this.va,coordinates:this.cb()}};R.prototype.toGeoJSON=R.prototype.$b;
R.prototype.ta=function(){return{type:this.oa,coordinates:this.ua(),boundingBox:this.X().ta()}};R.prototype.forWorkerMessage=R.prototype.ta;function S(a,b,c){this.lat=Le(a,S,0);this.lng=Me(b,S,1);c!==x&&(this.alt=Ne(c,S,2))}wa(S,R);t("H.geo.Point",S);S.prototype.F=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&(this.alt||0)===(a.alt||0)};S.prototype.equals=S.prototype.F;S.prototype.ra=function(a){if(this===a||this.lat===a.lat&&this.lng===a.lng)a=0;else{var b=this.lat*Ib;var c=a.lat*Ib;a=1.274200158E7*yb(nb(1,ub(vb(xb((b-c)/2),2)+zb(b)*zb(c)*vb(xb((this.lng*Ib-a.lng*Ib)/2),2))))}return a};
S.prototype.distance=S.prototype.ra;
S.prototype.dc=function(a,b,c){var d;if(c){if(d=b/6371000.79){b=a*Ib;a=Ib*this.lat;var e=xb(a);c=xb(d);var f=zb(d);d=Ib*this.lng;var g=zb(a);a=yb(g*zb(b)*c+e*f);b=Cb(xb(b)*g*c,f-e*xb(a));b=(d+b+E)%(2*E)-E;b*=Kb;e=new S(a*Kb,(b+540)%360-180)}return e||this}a=(a%360+360)%360;if(0===(a+90)%180)return a=this.lng+b/(6371000.79*Gb*zb(this.lat*Ib))*(270===a?-360:360),new S(this.lat,(a+540)%360-180);if(b/=6371000.79)a*=Ib,e=this.lat*Ib,c=this.lng*Ib,d=e+b*zb(a),f=d-e,g=tb(Ab(d/2+Fb)/Ab(e/2+Fb)),g=Ra(f/g)?
zb(e):f/g,a=b*xb(a)/g,sb(d)>Eb&&(d=0<d?E-d:-(E+d)),d=new S(d*Kb,((c+a+Hb+(sb(e+f)>Eb?E:0))%Gb-E)*Kb);return d||this};S.prototype.walk=S.prototype.dc;S.prototype.X=function(){return new V(this.lat,this.lng,this.lat,this.lng)};S.prototype.getBoundingBox=S.prototype.X;function Oe(a,b,c){var d=oa(a)&&!(Ra(a.lat=Le(a.lat))||Ra(a.lng=Me(a.lng))||a.alt!==x&&Ra(a.alt=Ne(a.alt)));if(!d&&b)throw new y(b,c,a);return d}S.validate=Oe;function Pe(a){if(!a)throw new y(Pe,0,a);return new S(a.lat,a.lng,a.alt)}
S.fromIPoint=Pe;l=S.prototype;l.oa="Point";l.eb=function(a){a.push("(",this.lng," ",this.lat,")");return a};l.va="Point";l.cb=function(){return[this.lng,this.lat,this.alt||0]};l.ua=function(){return[this.lat,this.lng,this.alt||0]};function Qe(){}function Re(a){return nb(1,ob(0,.5-tb(Ab(Fb+Eb*a/180))/E/2))}Qe.prototype.ia=function(a,b,c){c?(c.x=b/360+.5,c.y=Re(a)):c=new F(b/360+.5,Re(a));return c};Qe.prototype.latLngToPoint=Qe.prototype.ia;Qe.prototype.tb=function(a,b){return this.ia(a.lat,a.lng,b)};Qe.prototype.geoToPoint=Qe.prototype.tb;function Se(a){return 0>=a?90:1<=a?-90:Kb*(2*Bb(wb(E*(1-2*a)))-Eb)}Qe.prototype.V=function(a,b,c){c?(c.lat=Se(b),c.lng=360*(1===a?1:Mb(a,1))-180):c=new S(Se(b),360*(1===a?1:Mb(a,1))-180);return c};
Qe.prototype.xyToGeo=Qe.prototype.V;Qe.prototype.Tb=function(a,b){return this.V(a.x,a.y,b)};Qe.prototype.pointToGeo=Qe.prototype.Tb;var Te=new Qe;t("H.geo.mercator",Te);t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0);t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function W(a,b){this.projection=a||Te;this.b=0;this.a=this.exp=tb(b||256)/Db;Ue(this);this.y=this.x=0}t("H.geo.PixelProjection",W);var Ve=sb(24)+sb(-8);W.prototype.Vb=Te;W.prototype.projection=W.prototype.Vb;W.prototype.x=0;W.prototype.x=W.prototype.x;W.prototype.y=0;W.prototype.y=W.prototype.y;W.prototype.cc=vb(2,Ve);W.prototype.w=W.prototype.cc;W.prototype.Jb=vb(2,Ve);W.prototype.h=W.prototype.Jb;
W.prototype.ba=function(a){if(Ra(a))throw new y(this.ba,0,a);var b=this.x/this.w;var c=this.y/this.h;this.b=a;this.a=this.exp+a;Ue(this);this.x=b*this.w;this.y=c*this.h};W.prototype.rescale=W.prototype.ba;function Ue(a){a.a>Ve&&(a.a=Ve);a.w=vb(2,a.a);a.h=vb(2,a.a)}W.prototype.Ta=function(){return this.b||0};W.prototype.getZoomScale=W.prototype.Ta;W.prototype.sb=function(a,b){a=this.projection.ia(a.lat,a.lng,b);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};W.prototype.geoToPixel=W.prototype.sb;
W.prototype.Fa=function(a,b){return this.projection.V((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};W.prototype.pixelToGeo=W.prototype.Fa;W.prototype.V=function(a,b,c){return this.projection.V((a+this.x)/this.w,(b+this.y)/this.h,c)};W.prototype.xyToGeo=W.prototype.V;W.prototype.Ba=function(a,b,c){a=this.projection.ia(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};W.prototype.latLngToPixel=W.prototype.Ba;W.prototype.Ub=function(a){return new F(a.x*this.w-this.x,a.y*this.h-this.y)};
W.prototype.pointToPixel=W.prototype.Ub;t("H.util.Disposable",J);J.prototype.L=J.prototype.L;J.prototype.addOnDisposeCallback=J.prototype.L;t("H.util.dispose",function(a){a&&"function"==typeof a.s&&a.s()});J.prototype.s=J.prototype.s;J.prototype.dispose=J.prototype.s;J.prototype.v=J.prototype.v;J.prototype.disposeInternal=J.prototype.v;function We(a,b,c,d){if(!a||!b||!c)throw new y(We,x,"Must specify name, version and revision parameter");this.name=a;this.version=b;this.revision=c;d&&Ba(this,d)}t("H.util.BuildInfo",We);We.prototype.toString=function(){var a,b=[];for(a in this)Qa(this[a])&&b.push(this[a]);return b.join(";")};var Xe={};function Ye(a,b,c,d){if(!a)throw new y(Ye,1,"Must specify a name parameter");return Xe[a]||(Xe[a]=new We(a,b,c,d))}We.get=Ye;function Y(a,b,c,d,e,f){if(a&&b)this.Ka(a),this.ka(b),this.Ia(c),this.Ja(e),this.bb(f),this.ma(d);else throw new y(Y,x,'Parameters "scheme" and "host" must be specified');}t("H.service.Url",Y);
function Ze(a,b){var c=Ca.document,d;var e="";if(c){e=c.createElement("a");if(b){var f=(d=c.getElementsByTagName("base")[0])&&d.href;var g=c.head;var h=d||g.appendChild(c.createElement("base"));h.href=b}e.href=a;e=e.href;b&&(d?d.href=f:g.removeChild(h))}else/[\\w]+:\\/\\//.test(a)&&(e=a);f=/(?:(\\w+):\\/\\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\\/[^?#]*)?(\\?[^#]+)?(#.*)?/.exec(e);a=f[1];g=f[4];b=f[5];h=f[6];c=f[7];d=f[8];!f[2]&&g&&/@/.test(g)&&(g=g.split("@")[1]);f=Y;h=h&&0<h.length?h.substr(1):
"";e={};var k,m;if(c)for(k=/([?&]?([^=&+]+))(=([^&]+))?/g;m=k.exec(c);)e[decodeURIComponent(m[2])]=m[4]?decodeURIComponent(m[4]):void 0;return new f(a,g,h,e,isNaN(+b)?void 0:+b,d&&0<d.length?d.substr(1):"")}Y.parse=Ze;Y.prototype.clone=function(){var a={},b;for(b in this.a)a[b]=this.a[b];return new Y(this.i,this.g,this.b,a,this.f,this.c)};Y.prototype.clone=Y.prototype.clone;
Y.prototype.Ka=function(a){if(!a||"string"!==typeof a)throw new y(this.Ka,0,'The "scheme" parameter must be a non-empty string.');this.i=a;return this};Y.prototype.setScheme=Y.prototype.Ka;Y.prototype.Gb=function(){return this.i};Y.prototype.getScheme=Y.prototype.Gb;Y.prototype.ka=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw new y(this.ka,0,'The "host" parameter is not a valid host name.');this.g=a;return this};
Y.prototype.setHost=Y.prototype.ka;Y.prototype.yb=function(){return this.g};Y.prototype.getHost=Y.prototype.yb;Y.prototype.Ia=function(a){this.b=a||void 0;return this};Y.prototype.setPath=Y.prototype.Ia;Y.prototype.Db=function(){return this.b};Y.prototype.getPath=Y.prototype.Db;Y.prototype.ma=function(a){if(a)if("object"==typeof a)this.a=a;else throw new y(this.ma,0,'Parameter "params" must be an object.');else this.a={};return this};Y.prototype.setQuery=Y.prototype.ma;Y.prototype.Kb=function(){return!$e(this)};
Y.prototype.hasQuery=Y.prototype.Kb;Y.prototype.getQuery=function(){return this.a};Y.prototype.getQuery=Y.prototype.getQuery;Y.prototype.Ja=function(a){if(void 0===a)this.f=a;else{var b=Nb(+a<<0,0,65535);if(b!=a)throw new y(this.Ja,0,'Parameter "port" must be an integer in range [0...65535]');this.f=b}return this};Y.prototype.setPort=Y.prototype.Ja;Y.prototype.Eb=function(){return this.f};Y.prototype.getPort=Y.prototype.Eb;Y.prototype.bb=function(a){this.c=a||void 0;return this};
Y.prototype.setAnchor=Y.prototype.bb;Y.prototype.ub=function(){return this.c};Y.prototype.getAnchor=Y.prototype.ub;Y.prototype.R=function(a){if("object"!==typeof a)throw new y(this.R,0,'Parameter "other" must be an object.');var b=this.a,c;for(c in a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&(b[c]=a[c]);return this};Y.prototype.mergeQuery=Y.prototype.R;
Y.prototype.Na=function(a){if(!a||"string"!==typeof a)throw new y(this.Na,0,'Parameter "subDomain" must be a non-empty string');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.ka(a+"."+this.g)};Y.prototype.addSubDomain=Y.prototype.Na;Y.prototype.Oa=function(a){if(!a||"string"!==typeof a)throw new y(this.Oa,0,'Parameter "subPath" must be a non-empty string');return this.Ia((this.b?this.b+"/":"")+a)};Y.prototype.addSubPath=Y.prototype.Oa;
Y.prototype.toString=function(){return[this.i+"://",this.g,this.f?":"+this.f:"",this.b||!$e(this)||this.c?"/":"",this.b?encodeURI(this.b):"",af(this),this.c?"#"+encodeURIComponent(this.c):""].join("")};Y.prototype.toString=Y.prototype.toString;function bf(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(b){return"%"+b.charCodeAt(0).toString(16)})}
function af(a){var b=[],c=a.a,d={},e;for(e in c){if(c.hasOwnProperty(e)&&"function"!==typeof c[e]){var f=a.a[e];d.K=bf(e);Na(f,cf)?f.a.forEach(function(g){return function(h){b.push(g.K+"="+bf(h))}}(d)):Na(f,df)?b.push(d.K+"="+f.b.map(function(g){return bf(g)}).join(f.a)):b.push(void 0===f?d.K:d.K+"="+bf(f))}d={K:d.K}}return 0<b.length?"?"+b.join("&"):""}function $e(a){var b,c=0;for(b in a.a)if(a.a.hasOwnProperty(b)&&"function"!==typeof a.a[b]&&(c++,0<c))break;return!c}
function ef(a,b){if(Oa(a,void 0,void 0,void 0))for(var c=0;c<a.length;c++){var d=a[c];if(!Qa(d)&&!Sa(d)){var e="The Array does not contain only strings and numbers";break}}else e="Not an Array";if(e)throw new y(b,0,a);return a}function cf(a){this.a=ef(a,cf)}Y.MultiValueQueryParameter=cf;cf.prototype.Ib=function(){return this.a};cf.prototype.getValues=cf.prototype.Ib;function df(a,b){this.b=ef(a,df);if(!/^[!\\$\\(\\)\\*\\+,;]$/.test(b))throw new y(df,1,'Invalid delimiter "'+b+'"');this.a=b}
Y.DelimitedQuerySubValues=df;var ff={};function gf(a){try{importScripts.apply(self,arguments)}catch(b){this.postError("invalid_script")}}function hf(a){delete ff[a];this.postMessage(a)}function jf(a,b,c){if(r(b))var d=b;else try{d=self.eval("("+b+")"),r(d)||(d=null)}catch(e){}d?(ff[a]=d,c||this.postMessage(a)):this.postError("invalid_processor")}function kf(a){this.b=a&&a[0];this.a=a&&a[1];this.c=a&&a[2]||[]}kf.prototype.postError=function(a){this.postMessage(a,x,0)};
kf.prototype.postMessage=function(a,b,c){self.postMessage({processor:this.b,taskId:this.a,type:c===x?1:c,data:a},b||x)};function lf(a,b,c){if(!Qa(a))throw new y(lf,0,"InvalidArgument");if(!r(b))throw new y(lf,1,"InvalidArgument");var d=mf++;nf[d]={mimeType:c||of,ob:b};(new kf(["3",d,[]])).postMessage(a,[],2)}var nf={},mf=0;
function pf(a,b){var c=a;if(nf[this.a]){var d=nf[this.a];var e=d.ob;delete nf[this.a];if(b)e(null,b);else{if(d.mimeType===qf){a=new Uint8Array(a);b=a.byteLength;d="";c=0;for(var f,g,h,k;c<b;)f=a[c++],192>f||(g=a[c++],224>f?f=(f&31)<<6|g&63:(h=a[c++],240>f?f=(f&15)<<12|(g&63)<<6|h&63:(k=a[c++],f=(f&7)<<18|(g&63)<<12|(h&63)<<6|k&63))),65536>f?d+=String.fromCharCode(f):(f-=65536,d+=String.fromCharCode((f>>10)+55296,(f&1023)+56320));c=d}e(c)}}}var of=0,qf=1;function V(a,b,c,d){rf(this,Le(a,V,0),Me(b,V,1),Le(c,V,2),Me(d,V,3))}wa(V,R);t("H.geo.Rect",V);V.prototype.oa="Polygon";V.prototype.eb=function(a){var b=this.f,c=this.a,d=this.c,e=this.b;a.push("(","(",c," ",b,",",e," ",b,",",e," ",d,",",c," ",d,",",c," ",b,")",")");return a};V.prototype.F=function(a){var b=this===a;!b&&Na(a,V)&&(b=this.f===a.f&&this.a===a.a&&this.c===a.c&&this.b===a.b);return b};V.prototype.equals=V.prototype.F;
V.prototype.clone=function(){return new V(this.f,this.a,this.c,this.b)};V.prototype.clone=V.prototype.clone;function rf(a,b,c,d,e){a.a=c;a.b=e;b<d&&(c=b,b=d,d=c);a.f=b;a.c=d;a.j=a.g=a.i=null;return a}V.prototype.Sa=function(){this.j||(this.j=new S(this.f,this.a));return this.j};V.prototype.getTopLeft=V.prototype.Sa;V.prototype.Ra=function(){this.g||(this.g=new S(this.c,this.b));return this.g};V.prototype.getBottomRight=V.prototype.Ra;V.prototype.Hb=function(){return this.f};V.prototype.getTop=V.prototype.Hb;
V.prototype.vb=function(){return this.c};V.prototype.getBottom=V.prototype.vb;V.prototype.Ab=function(){return this.a};V.prototype.getLeft=V.prototype.Ab;V.prototype.Fb=function(){return this.b};V.prototype.getRight=V.prototype.Fb;V.prototype.G=function(){this.i||(this.i=new S(this.c+(this.f-this.c)/2,sf(this.a,this.I())));return this.i};V.prototype.getCenter=V.prototype.G;V.prototype.I=function(){return tf(this.a,this.b)};V.prototype.getWidth=V.prototype.I;
V.prototype.O=function(){return this.f-this.c};V.prototype.getHeight=V.prototype.O;V.prototype.Nb=function(){return this.a>this.b};V.prototype.isCDB=V.prototype.Nb;V.prototype.Pb=function(){return!this.I()&&!this.O()};V.prototype.isEmpty=V.prototype.Pb;V.prototype.X=function(){return new V(this.f,this.a,this.c,this.b)};V.prototype.getBoundingBox=V.prototype.X;
V.prototype.ea=function(a,b,c){var d=this.G();c||(a=Le(a,this.ea,0),b=Me(b,this.ea,1));b=this.J(a,b,c);a=b.G();return a.lat===d.lat&&a.lng===d.lng&&this.O()===b.O()&&this.I()===b.I()};V.prototype.containsLatLng=V.prototype.ea;V.prototype.fa=function(a,b){b||Oe(a,this.fa,0);return this.ea(a.lat,a.lng,b)};V.prototype.containsPoint=V.prototype.fa;
V.prototype.Qa=function(a,b){var c=this.G();if(!b&&!Na(a,V))throw new y(this.Qa,0,a);b=this.ja(a,b);a=b.G();return a.lat===c.lat&&a.lng===c.lng&&this.O()===b.O()&&this.I()===b.I()};V.prototype.containsRect=V.prototype.Qa;V.prototype.J=function(a,b,c,d){if(!c){if(Ra(a=Le(a)))throw new y(this.J,0,a);if(Ra(b=Me(b)))throw new y(this.J,1,b);}return uf(this.f,this.a,this.c,this.b,a,b,a,b,d)};V.prototype.mergeLatLng=V.prototype.J;
V.prototype.Ya=function(a,b,c){b||Oe(a,this.Ya,0);return this.J(a.lat,a.lng,b,c)};V.prototype.mergePoint=V.prototype.Ya;V.prototype.ja=function(a,b,c){if(!b&&!Na(a,V))throw new y(this.ja,0,a);return uf(this.f,this.a,this.c,this.b,a.f,a.a,a.c,a.b,c)};V.prototype.mergeRect=V.prototype.ja;V.prototype.$=function(a,b,c,d,e,f){e||(a=Le(a,this.$,0),b=Me(b,this.$,1),c=Le(c,this.$,2),d=Me(d,this.$,3));return uf(this.f,this.a,this.c,this.b,a,b,c,d,f)};V.prototype.mergeTopLeftBottomRight=V.prototype.$;
V.prototype.Va=function(a,b){var c=this.a<=this.b,d=a.a<=a.b,e=this.a<a.b,f=a.a<this.b;if(!b&&!Na(a,V))throw new y(this.Va,0,a);return this.c<=a.f&&a.c<=this.f&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};V.prototype.intersects=V.prototype.Va;function tf(a,b){a=b-a;return a+(0>a?360:0)}function sf(a,b){a+=b/2;return a-(180<a?360:0)}
function uf(a,b,c,d,e,f,g,h,k){c=nb(c,g);a=ob(a,e);e=tf(b,d);var m=sf(b,e);g=tf(f,h);var n=sf(f,g)-m;n+=0>n-1E-6?360:0;if(180>n-1E-6){m=b;var q=h}else n=360-n,m=f,q=d;n=n+e/2+g/2;360<=n+5E-7?(m=-180,q=180):n-5E-7<e?(m=b,q=d):n-5E-7<g&&(m=f,q=h);return k?rf(k,a,m,c,q):new V(a,m,c,q)}V.merge=uf;function vf(a,b,c){c||(Oe(a,vf,0),Oe(b,vf,1));return new V(a.lat,a.lng,b.lat,b.lng)}V.fromPoints=vf;
function wf(a,b){var c=1,d=a.length,e=null;var f=na(a);if("array"!=f&&("object"!=f||"number"!=typeof a.length))throw new y(wf,0,a);if(0<d)for(f=a[0],e=vf(f,f,b);c<d;c++)f=a[c],e.J(f.lat,f.lng,b,e);return e}V.coverPoints=wf;function xf(a,b){var c=3,d=a.length,e;if(!(b||a&&null!=a.length))throw new y(xf,0,a);if(0<d)for(e=new V(a[0],a[1],a[0],a[1]);c<d;c+=3)e.J(a[c],a[c+1],b,e);return e}V.coverLatLngAlts=xf;
function yf(a,b){var c=1,d=a.length,e;if(b&&(!a||null==a.length))throw new y(yf,0,a);if(0<d)for(e=new V(a[0].f,a[0].a,a[0].c,a[0].b);c<d;c++)e.ja(a[c],b,e);return e}V.coverRects=yf;
V.prototype.$a=function(a,b){var c=this.a,d=this.f,e=this.b,f=this.c,g=this.G().lng;Oe(a,this.$a,0);var h=a.lat-f-(d-f)/2;var k=a.lng-g;k=180<k||-180>k?-(g+a.lng):k;a=c+(0>k?2*k:0);a=-180>a?360+a:a;e+=0<k?2*k:0;e=180<e?e-360:e;d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?rf(b,d,a,f,e):new V(d,a,f,e)};V.prototype.resizeToCenter=V.prototype.$a;V.prototype.va="Polygon";
V.prototype.cb=function(){return[[this.a,this.f,0],[this.b,this.f,0],[this.b,this.c,0],[this.a,this.c,0],[this.a,this.f,0]]};V.prototype.ta=function(){return this.ua()};V.prototype.ua=function(){return[this.f,this.a,this.c,this.b]};function zf(a,b,c,d){this.key="";this.x=a;this.y=b;this.b=c;this.Y=d;this.a=Ad()}zf.prototype.then=function(a,b,c){return this.a.a.then(a,b,c)};zf.prototype.reject=function(a){this.a.reject(a)};zf.prototype.cancel=function(){this.a.a.cancel()};zf.prototype.cancel=zf.prototype.cancel;function Af(a,b,c,d){var e=!!c,f,g=0,h=0,k=0,m=0,n=0,q,u=-1;var I=Ca.Float32Array;var L,w=[];if(b){b=Ja(b);a=Ja(a);e&&(f=Ja(c));c=b.length;d=d?1E-7:1E-5;for(L=new I(3*c);g<c;){I=b[g];var G=+I;var X=+a[g];e&&(q=+f[g]);Bf.test(I)?0<=u&&(0<g-u&&w.push(u,g+1),u=-1):0>u&&(u=g);g++;m=L[h++]=m+X*d;k=L[h++]=k+G*d;e&&(n=L[h]=n+q);h++}0<=u&&1<c-u&&w.push(u,c)}else L=new I(0);return{path:L,outlineIndices:w}}var Bf=/^-?0\\d/;
function Cf(a,b){for(var c=0,d=a.length/3,e=new Ca.Array(d),f=0;c<d;)e[c++]=b.Ba(a[f],a[++f]),f+=2;return e};function Df(a,b){b=180/(1<<b);var c=a.lat+90;a=(a.lng+180)%360;var d=0;180==c&&d--;d+=Math.floor(c/b);return[d,Math.floor(a/b)]}var Ef=1/Math.pow(10,10);function Ff(a,b){var c=[],d=a.Sa();a=a.Ra();var e;180==a.lng&&(a.lng-=Ef);d=Df(d,b);a=Df(a,b);for(e=d[0];e>=a[0];e--)for(b=d[1];b<=a[1];b++)c.push(e,b);return c};function Gf(a,b){var c=a.tileSize||256;this.b={};this.j=Ze(a.serverUrl);this.g=b;this.fb=a.layerConfigs||[];this.i=a.projected;this.P=c;this.Ea=!1!==a.batchTiles;this.bc=a.horizontalMargin||0;this.gb=a.onlyOutline;this.ib=new W(x,c);this.f=new W(x,c);this.f.ba(22-Math.log(c)/Math.LN2+8)}wa(Gf,J);
Gf.prototype.kb=function(a,b,c){var d=this.P,e=this.bc,f={x:a*d-e,y:b*d};d={x:(a+1)*d-1+e,y:(b+1)*d-1};e=this.ib;e.ba(c);f=e.Fa(f);d=e.Fa(d);return Hf(this,new V(f.lat,f.lng,d.lat,d.lng),this.fb,{x:a,y:b,z:c})};Gf.prototype.jb=function(a,b,c,d,e){return Hf(this,new V(a,b,c,d),e)};
function Hf(a,b,c,d){var e=If(c),f=e.length,g={},h,k=a.b,m=[],n=[];for(c=0;c<f;c++){var q=e[c];var u=q.layerId;var I=q.level;g[u]=q.columns;q=Ff(b,I);var L=q.length-1;for(h=0;h<L;h+=2){var w=[u,q[h+1],q[h],I].join("_");var G=k[w]||a.g.get(w);G||(G=new zf(q[h+1],q[h],I,u),G.key=w,k[w]=G,n.push(G));m.push(G)}}n.length&&(a.Ea?Jf(a,n):Kf(a,n));return zd(m.map(function(X){return X.then(Fa(this.Ga,this,X.Y,Lf(e))).then(Fa(this.hb,this,X,d||Mf)).then(Fa(this.ac,this,g[X.Y]))},a))}var Mf={x:0,y:0,z:0};
Gf.prototype.Ga=function(a,b,c){var d=c.Rows,e=d.length,f,g;if(e&&(f=b[a])){b=new C(c.Rows);var h=[];for(g=0;g<e;g++){var k=d[g];f(b.ga(g),a)&&h.push(k)}a={Rows:h};if(c=c.Meta)a.Meta=c}else a=c;return a};function Kf(a,b){function c(k,m,n){n?(delete a.b[k.key],k.reject(n)):Nf(a,k,m)}var d,e=b.length,f=a.j;for(d=0;d<e;d++){var g=b[d];var h=f.clone().R({tilex:g.x}).R({tiley:g.y}).R({level:g.b}).R({layer:g.Y});new lf(h.toString(),Fa(c,null,g),qf)}}
function Jf(a,b){var c=b.length,d;for(d=0;d<c;d+=15){var e=b.slice(d,d+15);Of(a,e)}}function Of(a,b){var c=a.j.clone(),d=[],e=[],f=[],g=c.getQuery();b.length&&(b.forEach(function(h){d.push(h.x,h.y);e.push(h.b);f.push(h.Y)}),g.tilexy=d.join(","),g.layers=f.join(","),g.levels=e.join(","),c.ma(g),new lf(c.toString(),function(h,k){k?b.forEach(function(m){delete a.b[m.key];m.reject("error")}):Nf(a,b,h)},qf))}
function Nf(a,b,c){var d=b.length,e;if(Oa(b,void 0,void 0,void 0)){var f=c.indexOf("[")+1;for(e=0;e<d;e++){var g=c.indexOf("]},{",f+3)+2;g<f&&(g=c.lastIndexOf("]}"));var h=c.substr(f,g-f);f=g+1;Pf(a,b[e],h)}}else Pf(a,b,c)}function Pf(a,b,c){try{var d=c.length;var e=b.key;delete a.b[e];a.g.add(e,b,2*d);var f=JSON.parse(c);b.a.b(f)}catch(g){b.reject(g.message)}}
function Lf(a){var b={},c,d=a.length;for(c=0;c<d;c++){var e=a[c];if(e.rowFilter){var f=e.layerId;f=f!==x?f:e.layer;b[f]=Fa(e.rowFilter,e.rowFilterContext)}}return b}function Qf(a,b,c,d,e){return e?[new F(a,b),new F(c,b),new F(c,d),new F(a,d),new F(a,b)]:[a,b,c,b,c,d,a,d]}
Gf.prototype.hb=function(a,b,c){var d=this.f.Ta()-b.z,e=this.P<<d,f=50<<d,g=b.x*e;b=b.y*e;var h=g+e;e=b+e;var k=g-f,m=b-f,n=h+f;f=e+f;var q,u,I=c.Rows,L=I.length,w,G=/^ADAS/.test(a.Y),X=this.f,qa=this.gb,O,bb=[],Ka=[],La=[],cb=[];for(a=0;a<L;a++){var z=w=I[a];var T=(O=G)?"HPY":"LAT";var U=O?"HPX":"LON";var da=O?"HPZ":"ZLEVEL";if(z[T]){var P=Af(z[T],z[U],z[da],O);z.geometry=P;delete z[T];delete z[U];delete z[da];if(z.INNER_LAT)for(T=z.INNER_LAT.split(";"),P=z.INNER_LON.split(";"),delete z.INNER_LAT,
delete z.INNER_LON,z.interiors=da=[],U=T.length,z=0;z<U;z++)da.push(Af(T[z],P[z],"",O))}if(this.i){U=w;z=X;P=U.$$projected$$;T=0;if(!P){var Z=U.geometry;O=Cf(Z.path,z);w=[O];U.$$projected$$=P={Sb:w};U=(da=U.interiors)?da.length:0;w.length+=U;T|=+Rf(w,O,Z.outlineIndices);if(U)for(P.Lb=1,q=0;q<U;q++)Z=da[q],O=Cf(Z.path,z),w[1+q]=O,T|=+Rf(w,O,Z.outlineIndices);T&&(P.Qb=1+U)}z=P;O=z.Sb;w=z.Lb;var Fc=z.Qb;P=[];T=U=Lb;var db=da=x;z=O[0];if(1===z.length){var Gc=Gc||(Gc=Qf(g,b,h,e,!1));w=z[0];Rb(w.x,w.y,
Gc)&&P.push(Sf(z,g,b,d))}else{var He=O.length;for(Z=qa?Fc:0;Z<He&&(qa||!Z||P.length);Z++)if(z=O[Z],Z>=Fc){Z===Fc&&(T=P.length);var ia=Ub([z],k,m,n,f,!1);Tf(ia,g,b,d,P)}else{var Jb=Jb||(Jb=Qf(k,m,n,f,!0));if(Z>=w)if(Z===w&&(U=P.length),db)for(q=db.length;q--;){if(ia=Uf(db[q],z),u=ia.length){for(da=da||[];u--;)da.push(q);Tf(ia,g,b,d,P)}}else ia=Uf(Jb,z),Tf(ia,g,b,d,P);else if(ia=Uf(Jb,z),Tf(ia,g,b,d,P),1<ia.length&&w<He)for(db=[],q=ia.length;q--;)db[q]=ia[q]}}P.length&&(bb[a]=P,Ka[a]=U,La[a]=da,cb[a]=
T)}}return{Zb:c,pb:bb,Mb:Ka,rb:La,Rb:cb}};function Rf(a,b,c){for(var d=c.length,e=0,f,g,h=b.length;e<d;)f=c[e++],g=c[e++],a.push(g-f===h?b:b.slice(f,g));return 0<c.length}function Uf(a,b){var c,d=[];if(c=Wb(a,b)){do{a=[];b=c;do a.push(b);while(b=b.next);d.push(a)}while(c=c.Za)}else Sb(b[0],Tb(a))?d.push(b):Sb(a[0],Tb(b))&&d.push(a);return d}function Tf(a,b,c,d,e){for(var f=0,g=a.length;f<g;f++)e.push(Sf(a[f],b,c,d))}
function Sf(a,b,c,d){var e,f=a.length,g=new Int32Array(2*f),h=0;for(e=0;e<f;e++){var k=a[e];g[h++]=k.x-b>>d;g[h++]=k.y-c>>d}return g}
Gf.prototype.ac=function(a,b){var c=b.Zb,d=b.pb,e=b.Mb,f=b.Rb;b=b.rb;for(var g=[],h,k={Rows:g},m,n=a?a.length:0,q=0,u,I=c.Rows,L=I.length,w;q<L;q+=1)if(d[q]||!this.i){h={};u=I[q];if(n)for(m=0;m<n;m++)u.hasOwnProperty(a[m])&&(h[a[m]]=u[a[m]]);else for(w in u)"$$projected$$"!==w&&(h[w]=u[w]);u.geometry&&(h.geometry=u.geometry);m=void 0;var G,X=h,qa=d[q],O=e[q],bb=b[q],Ka=f[q],La=g;if(qa){var cb=qa.length;if(bb)for(G=O;G--;){if(G){var z={};for(m in X)z[m]=X[m]}else z=X;u=[qa[G]];var T=nb(cb,Ka)-O;for(h=
0;h<T;h++)bb[h]===G&&u.push(qa[O+h]);T=u.length;if(!G)for(h=Ka;h<cb;h++)u.push(qa[h]);z.$HProjGeometry={paths:u,interiorsIndex:1,outlinesIndex:T};La.push(z)}else X.$HProjGeometry={paths:qa,interiorsIndex:O,outlinesIndex:Ka},La.push(X)}else La.push(X)}c.Meta&&(k.Meta=c.Meta);return k};Gf.prototype.v=function(){var a,b=this.b;for(a in b)b.hasOwnProperty(a)&&(b[a].reject("disposed"),delete b[a])};Gf.prototype.disposeInternal=Gf.prototype.v;
function If(a){for(var b=[],c,d=a.length,e=0;e<d;e++){c=za(a[e]);if(c.rowFilter&&(c.rowFilter=eval("("+c.rowFilter+")"),!r(c.rowFilter)))throw Error("Invalid row filter for layer "+c.layerId);b.push(c)}return b};t("H.service.extension.worker.processor",function(a,b,c){function d(h){e.postMessage(h)}var e=this,f=ya[a];var g=function(h){e.postError(h.toString())};if(0===b)f||(ya[a]=new Gf(c,Vf)),this.postMessage(void 0);else if(f)switch(b){case 1:try{f.kb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 2:try{f.jb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 3:f.s();delete ya[a];xa()&&Vf.S();break;default:e.postError("Unsupported command")}});
var Vf=new A(26214400),ya=Object.create(Ia,void 0);function Wf(a,b,c){var d=a[b];a=a[b+1];this.Ua=[];this.La=0;this.b=b;this.a=[a-c,d-c,a+c,d+c]}Wf.prototype.fa=function(a,b){var c=a[b];a=a[b+1];b=this.a;return b[1]<=c&&c<=b[3]&&b[0]<=a&&a<=b[2]};Wf.prototype.G=function(){return this.b};var Xf=new F(0,0);function Yf(a,b,c,d,e){d[e]=b;d[e+1]=a}var Zf=new W;function $f(a,b,c,d,e){Zf.Ba(a,b,Xf);d[e]=Xf.x;d[e+1]=Xf.y}
t("H.clustering.dynamicgrid.worker",function(a,b,c,d,e){var f=e?Yf:$f,g=0;e=!!self.ArrayBuffer;var h=a.byteLength?new Float64Array(a):a,k=h.length/3;a=[];var m=[],n=[],q=e?new Float64Array(2*k):[];k=0;var u=0;for(Zf.ba(d);g<h.length;){var I=h[g++];var L=h[g++];var w=h[g++];f(w,L,d,q,u);for(w=a.length;w--;)if(L=a[w],L.fa(q,u)){var G=L;break}G||(G=new Wf(q,u,b),a.push(G));w=u/2;G.La+=I||1;G.Ua.push(w);G=null;u+=2}for(w=a.length;w--;)L=a[w],b=L.La>=c,f=L.Ua,d=f.length,b?(m.push(d),m=m.concat(f)):
(k+=d,n=n.concat(f));c=[k].concat(n,m);c=e?(new Uint32Array(c)).buffer:c;this.postMessage(c,[c])});self.addEventListener("message",function(a){a=new kf(a.data);var b=ff[a.b];if(b)try{b.apply(a,a.c)}catch(c){a.postError(c.message)}else a.postError("processor_not_found")});(function(){var a=new kf;var b=function(c,d){jf.apply(a,[c,d,!0])};b("0",gf);b("1",jf);b("2",hf);b("3",pf)})();
`;
  !function() {
    var f = function() {
      var target = ("undefined" == typeof self || !("undefined" != typeof WorkerGlobalScope && self instanceof WorkerGlobalScope)) && ("undefined" != typeof module && module.exports || "undefined" != typeof window), __worker_src__, __worker_src_map__, __worker_src_origin__;
      target && (__worker_src__ = f.toString(), __worker_src_map__ = "", __worker_src_origin__ = "undefined" != typeof document && document.currentScript instanceof HTMLScriptElement ? document.currentScript.src : ""), function() {
        "use strict";
        var toString = {}.toString, classofRaw = function(e) {
          return toString.call(e).slice(8, -1);
        }, commonjsGlobal = "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {};
        function commonjsRequire() {
          throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs");
        }
        function unwrapExports(e) {
          return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e;
        }
        function createCommonjsModule(e, t2) {
          return e(t2 = { exports: {} }, t2.exports), t2.exports;
        }
        function getCjsExportFromNamespace(e) {
          return e && e.default || e;
        }
        var commonjsHelpers = Object.freeze({ commonjsGlobal, commonjsRequire, unwrapExports, createCommonjsModule, getCjsExportFromNamespace }), O = "object", check = function(e) {
          return e && e.Math == Math && e;
        }, global_1 = check(typeof globalThis == O && globalThis) || check(typeof window == O && window) || check(typeof self == O && self) || check(typeof commonjsGlobal == O && commonjsGlobal) || Function("return this")(), fails = function(e) {
          try {
            return !!e();
          } catch (e2) {
            return true;
          }
        }, descriptors = !fails(function() {
          return 7 != Object.defineProperty({}, "a", { get: function() {
            return 7;
          } }).a;
        }), isObject = function(e) {
          return "object" == typeof e ? null !== e : "function" == typeof e;
        }, document$1 = global_1.document, exist = isObject(document$1) && isObject(document$1.createElement), documentCreateElement = function(e) {
          return exist ? document$1.createElement(e) : {};
        }, ie8DomDefine = !descriptors && !fails(function() {
          return 7 != Object.defineProperty(documentCreateElement("div"), "a", { get: function() {
            return 7;
          } }).a;
        }), anObject = function(e) {
          if (!isObject(e))
            throw TypeError(String(e) + " is not an object");
          return e;
        }, toPrimitive = function(e, t2) {
          if (!isObject(e))
            return e;
          var r, i2;
          if (t2 && "function" == typeof (r = e.toString) && !isObject(i2 = r.call(e)))
            return i2;
          if ("function" == typeof (r = e.valueOf) && !isObject(i2 = r.call(e)))
            return i2;
          if (!t2 && "function" == typeof (r = e.toString) && !isObject(i2 = r.call(e)))
            return i2;
          throw TypeError("Can't convert object to primitive value");
        }, nativeDefineProperty = Object.defineProperty, f = descriptors ? nativeDefineProperty : function(e, t2, r) {
          if (anObject(e), t2 = toPrimitive(t2, true), anObject(r), ie8DomDefine)
            try {
              return nativeDefineProperty(e, t2, r);
            } catch (e2) {
            }
          if ("get" in r || "set" in r)
            throw TypeError("Accessors not supported");
          return "value" in r && (e[t2] = r.value), e;
        }, objectDefineProperty = { f }, createPropertyDescriptor = function(e, t2) {
          return { enumerable: !(1 & e), configurable: !(2 & e), writable: !(4 & e), value: t2 };
        }, hide = descriptors ? function(e, t2, r) {
          return objectDefineProperty.f(e, t2, createPropertyDescriptor(1, r));
        } : function(e, t2, r) {
          return e[t2] = r, e;
        }, setGlobal = function(t2, r) {
          try {
            hide(global_1, t2, r);
          } catch (e) {
            global_1[t2] = r;
          }
          return r;
        }, isPure = false, shared = createCommonjsModule(function(e) {
          var t2 = "__core-js_shared__", r = global_1[t2] || setGlobal(t2, {});
          (e.exports = function(e2, t3) {
            return r[e2] || (r[e2] = void 0 !== t3 ? t3 : {});
          })("versions", []).push({ version: "3.1.0", mode: "global", copyright: " 2019 Denis Pushkarev (zloirock.ru)" });
        }), id = 0, postfix = Math.random(), uid = function(e) {
          return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++id + postfix).toString(36));
        }, nativeSymbol = !fails(function() {
          return !String(Symbol());
        }), store = shared("wks"), Symbol$1 = global_1.Symbol, wellKnownSymbol = function(e) {
          return store[e] || (store[e] = nativeSymbol && Symbol$1[e] || (nativeSymbol ? Symbol$1 : uid)("Symbol." + e));
        }, TO_STRING_TAG = wellKnownSymbol("toStringTag"), CORRECT_ARGUMENTS = "Arguments" == classofRaw(function() {
          return arguments;
        }()), tryGet = function(e, t2) {
          try {
            return e[t2];
          } catch (e2) {
          }
        }, classof = function(e) {
          var t2, r, i2;
          return void 0 === e ? "Undefined" : null === e ? "Null" : "string" == typeof (r = tryGet(t2 = Object(e), TO_STRING_TAG)) ? r : CORRECT_ARGUMENTS ? classofRaw(t2) : "Object" == (i2 = classofRaw(t2)) && "function" == typeof t2.callee ? "Arguments" : i2;
        }, TO_STRING_TAG$1 = wellKnownSymbol("toStringTag"), test = {};
        test[TO_STRING_TAG$1] = "z";
        var objectToString = "[object z]" !== String(test) ? function() {
          return "[object " + classof(this) + "]";
        } : test.toString, hasOwnProperty = {}.hasOwnProperty, has = function(e, t2) {
          return hasOwnProperty.call(e, t2);
        }, functionToString = shared("native-function-to-string", Function.toString), WeakMap = global_1.WeakMap, nativeWeakMap = "function" == typeof WeakMap && /native code/.test(functionToString.call(WeakMap)), shared$1 = shared("keys"), sharedKey = function(e) {
          return shared$1[e] || (shared$1[e] = uid(e));
        }, hiddenKeys = {}, WeakMap$1 = global_1.WeakMap, set, get, has$1, enforce = function(e) {
          return has$1(e) ? get(e) : set(e, {});
        }, getterFor = function(r) {
          return function(e) {
            var t2;
            if (!isObject(e) || (t2 = get(e)).type !== r)
              throw TypeError("Incompatible receiver, " + r + " required");
            return t2;
          };
        }, store$1, wmget, wmhas, wmset, set, get, has$1, STATE;
        has$1 = nativeWeakMap ? (store$1 = new WeakMap$1(), wmget = store$1.get, wmhas = store$1.has, wmset = store$1.set, set = function(e, t2) {
          return wmset.call(store$1, e, t2), t2;
        }, get = function(e) {
          return wmget.call(store$1, e) || {};
        }, function(e) {
          return wmhas.call(store$1, e);
        }) : (STATE = sharedKey("state"), hiddenKeys[STATE] = true, set = function(e, t2) {
          return hide(e, STATE, t2), t2;
        }, get = function(e) {
          return has(e, STATE) ? e[STATE] : {};
        }, function(e) {
          return has(e, STATE);
        });
        var internalState = { set, get, has: has$1, enforce, getterFor }, redefine = createCommonjsModule(function(e) {
          var t2 = internalState.get, s = internalState.enforce, l = String(functionToString).split("toString");
          shared("inspectSource", function(e2) {
            return functionToString.call(e2);
          }), (e.exports = function(e2, t3, r, i2) {
            var n = !!i2 && !!i2.unsafe, o = !!i2 && !!i2.enumerable, a2 = !!i2 && !!i2.noTargetGet;
            "function" == typeof r && ("string" != typeof t3 || has(r, "name") || hide(r, "name", t3), s(r).source = l.join("string" == typeof t3 ? t3 : "")), e2 !== global_1 ? (n ? !a2 && e2[t3] && (o = true) : delete e2[t3], o ? e2[t3] = r : hide(e2, t3, r)) : o ? e2[t3] = r : setGlobal(t3, r);
          })(Function.prototype, "toString", function() {
            return "function" == typeof this && t2(this).source || functionToString.call(this);
          });
        }), ObjectPrototype = Object.prototype;
        objectToString !== ObjectPrototype.toString && redefine(ObjectPrototype, "toString", objectToString, { unsafe: true });
        var ceil = Math.ceil, floor = Math.floor, toInteger = function(e) {
          return isNaN(e = +e) ? 0 : (0 < e ? floor : ceil)(e);
        }, requireObjectCoercible = function(e) {
          if (null == e)
            throw TypeError("Can't call method on " + e);
          return e;
        }, stringAt = function(e, t2, r) {
          var i2, n, o = String(requireObjectCoercible(e)), a2 = toInteger(t2), s = o.length;
          return a2 < 0 || s <= a2 ? r ? "" : void 0 : (i2 = o.charCodeAt(a2)) < 55296 || 56319 < i2 || a2 + 1 === s || (n = o.charCodeAt(a2 + 1)) < 56320 || 57343 < n ? r ? o.charAt(a2) : i2 : r ? o.slice(a2, a2 + 2) : n - 56320 + (i2 - 55296 << 10) + 65536;
        }, nativePropertyIsEnumerable = {}.propertyIsEnumerable, nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor, NASHORN_BUG = nativeGetOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1), f$1 = NASHORN_BUG ? function(e) {
          var t2 = nativeGetOwnPropertyDescriptor(this, e);
          return !!t2 && t2.enumerable;
        } : nativePropertyIsEnumerable, objectPropertyIsEnumerable = { f: f$1 }, split = "".split, indexedObject = fails(function() {
          return !Object("z").propertyIsEnumerable(0);
        }) ? function(e) {
          return "String" == classofRaw(e) ? split.call(e, "") : Object(e);
        } : Object, toIndexedObject = function(e) {
          return indexedObject(requireObjectCoercible(e));
        }, nativeGetOwnPropertyDescriptor$1 = Object.getOwnPropertyDescriptor, f$2 = descriptors ? nativeGetOwnPropertyDescriptor$1 : function(e, t2) {
          if (e = toIndexedObject(e), t2 = toPrimitive(t2, true), ie8DomDefine)
            try {
              return nativeGetOwnPropertyDescriptor$1(e, t2);
            } catch (e2) {
            }
          if (has(e, t2))
            return createPropertyDescriptor(!objectPropertyIsEnumerable.f.call(e, t2), e[t2]);
        }, objectGetOwnPropertyDescriptor = { f: f$2 }, min = Math.min, toLength = function(e) {
          return 0 < e ? min(toInteger(e), 9007199254740991) : 0;
        }, max = Math.max, min$1 = Math.min, toAbsoluteIndex = function(e, t2) {
          var r = toInteger(e);
          return r < 0 ? max(r + t2, 0) : min$1(r, t2);
        }, arrayIncludes = function(s) {
          return function(e, t2, r) {
            var i2, n = toIndexedObject(e), o = toLength(n.length), a2 = toAbsoluteIndex(r, o);
            if (s && t2 != t2) {
              for (; a2 < o; )
                if ((i2 = n[a2++]) != i2)
                  return true;
            } else
              for (; a2 < o; a2++)
                if ((s || a2 in n) && n[a2] === t2)
                  return s || a2 || 0;
            return !s && -1;
          };
        }, arrayIndexOf = arrayIncludes(false), objectKeysInternal = function(e, t2) {
          var r, i2 = toIndexedObject(e), n = 0, o = [];
          for (r in i2)
            !has(hiddenKeys, r) && has(i2, r) && o.push(r);
          for (; t2.length > n; )
            has(i2, r = t2[n++]) && (~arrayIndexOf(o, r) || o.push(r));
          return o;
        }, enumBugKeys = ["constructor", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "toLocaleString", "toString", "valueOf"], hiddenKeys$1 = enumBugKeys.concat("length", "prototype"), f$3 = Object.getOwnPropertyNames || function(e) {
          return objectKeysInternal(e, hiddenKeys$1);
        }, objectGetOwnPropertyNames = { f: f$3 }, f$4 = Object.getOwnPropertySymbols, objectGetOwnPropertySymbols = { f: f$4 }, Reflect$1 = global_1.Reflect, ownKeys = Reflect$1 && Reflect$1.ownKeys || function(e) {
          var t2 = objectGetOwnPropertyNames.f(anObject(e)), r = objectGetOwnPropertySymbols.f;
          return r ? t2.concat(r(e)) : t2;
        }, copyConstructorProperties = function(e, t2) {
          for (var r = ownKeys(t2), i2 = objectDefineProperty.f, n = objectGetOwnPropertyDescriptor.f, o = 0; o < r.length; o++) {
            var a2 = r[o];
            has(e, a2) || i2(e, a2, n(t2, a2));
          }
        }, replacement = /#|\.prototype\./, isForced = function(e, t2) {
          var r = data[normalize(e)];
          return r == POLYFILL || r != NATIVE && ("function" == typeof t2 ? fails(t2) : !!t2);
        }, normalize = isForced.normalize = function(e) {
          return String(e).replace(replacement, ".").toLowerCase();
        }, data = isForced.data = {}, NATIVE = isForced.NATIVE = "N", POLYFILL = isForced.POLYFILL = "P", isForced_1 = isForced, getOwnPropertyDescriptor = objectGetOwnPropertyDescriptor.f, _export = function(e, t2) {
          var r, i2, n, o, a2 = e.target, s = e.global, l = e.stat, u2 = s ? global_1 : l ? global_1[a2] || setGlobal(a2, {}) : (global_1[a2] || {}).prototype;
          if (u2)
            for (r in t2) {
              if (n = t2[r], i2 = e.noTargetGet ? (o = getOwnPropertyDescriptor(u2, r)) && o.value : u2[r], !isForced_1(s ? r : a2 + (l ? "." : "#") + r, e.forced) && void 0 !== i2) {
                if (typeof n == typeof i2)
                  continue;
                copyConstructorProperties(n, i2);
              }
              (e.sham || i2 && i2.sham) && hide(n, "sham", true), redefine(u2, r, n, e);
            }
        }, toObject = function(e) {
          return Object(requireObjectCoercible(e));
        }, correctPrototypeGetter = !fails(function() {
          function e() {
          }
          return e.prototype.constructor = null, Object.getPrototypeOf(new e()) !== e.prototype;
        }), IE_PROTO = sharedKey("IE_PROTO"), ObjectPrototype$1 = Object.prototype, objectGetPrototypeOf = correctPrototypeGetter ? Object.getPrototypeOf : function(e) {
          return e = toObject(e), has(e, IE_PROTO) ? e[IE_PROTO] : "function" == typeof e.constructor && e instanceof e.constructor ? e.constructor.prototype : e instanceof Object ? ObjectPrototype$1 : null;
        }, ITERATOR = wellKnownSymbol("iterator"), BUGGY_SAFARI_ITERATORS = false, returnThis = function() {
          return this;
        }, IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;
        [].keys && (arrayIterator = [].keys(), "next" in arrayIterator ? (PrototypeOfArrayIteratorPrototype = objectGetPrototypeOf(objectGetPrototypeOf(arrayIterator)), PrototypeOfArrayIteratorPrototype !== Object.prototype && (IteratorPrototype = PrototypeOfArrayIteratorPrototype)) : BUGGY_SAFARI_ITERATORS = true), null == IteratorPrototype && (IteratorPrototype = {}), has(IteratorPrototype, ITERATOR) || hide(IteratorPrototype, ITERATOR, returnThis);
        var iteratorsCore = { IteratorPrototype, BUGGY_SAFARI_ITERATORS }, objectKeys = Object.keys || function(e) {
          return objectKeysInternal(e, enumBugKeys);
        }, objectDefineProperties = descriptors ? Object.defineProperties : function(e, t2) {
          anObject(e);
          for (var r, i2 = objectKeys(t2), n = i2.length, o = 0; o < n; )
            objectDefineProperty.f(e, r = i2[o++], t2[r]);
          return e;
        }, document$2 = global_1.document, html = document$2 && document$2.documentElement, IE_PROTO$1 = sharedKey("IE_PROTO"), PROTOTYPE = "prototype", Empty = function() {
        }, createDict = function() {
          var e, t2 = documentCreateElement("iframe"), r = enumBugKeys.length, i2 = "script";
          for (t2.style.display = "none", html.appendChild(t2), t2.src = String("javascript:"), (e = t2.contentWindow.document).open(), e.write("<script>document.F=Object</" + i2 + ">"), e.close(), createDict = e.F; r--; )
            delete createDict[PROTOTYPE][enumBugKeys[r]];
          return createDict();
        }, objectCreate = Object.create || function(e, t2) {
          var r;
          return null !== e ? (Empty[PROTOTYPE] = anObject(e), r = new Empty(), Empty[PROTOTYPE] = null, r[IE_PROTO$1] = e) : r = createDict(), void 0 === t2 ? r : objectDefineProperties(r, t2);
        };
        hiddenKeys[IE_PROTO$1] = true;
        var defineProperty = objectDefineProperty.f, TO_STRING_TAG$2 = wellKnownSymbol("toStringTag"), setToStringTag = function(e, t2, r) {
          e && !has(e = r ? e : e.prototype, TO_STRING_TAG$2) && defineProperty(e, TO_STRING_TAG$2, { configurable: true, value: t2 });
        }, iterators = {}, IteratorPrototype$1 = iteratorsCore.IteratorPrototype, returnThis$1 = function() {
          return this;
        }, createIteratorConstructor = function(e, t2, r) {
          var i2 = t2 + " Iterator";
          return e.prototype = objectCreate(IteratorPrototype$1, { next: createPropertyDescriptor(1, r) }), setToStringTag(e, i2, false, true), iterators[i2] = returnThis$1, e;
        }, validateSetPrototypeOfArguments = function(e, t2) {
          if (anObject(e), !isObject(t2) && null !== t2)
            throw TypeError("Can't set " + String(t2) + " as a prototype");
        }, objectSetPrototypeOf = Object.setPrototypeOf || ("__proto__" in {} ? function() {
          var r, i2 = false, e = {};
          try {
            (r = Object.getOwnPropertyDescriptor(Object.prototype, "__proto__").set).call(e, []), i2 = e instanceof Array;
          } catch (e2) {
          }
          return function(e2, t2) {
            return validateSetPrototypeOfArguments(e2, t2), i2 ? r.call(e2, t2) : e2.__proto__ = t2, e2;
          };
        }() : void 0), ITERATOR$1 = wellKnownSymbol("iterator"), IteratorPrototype$2 = iteratorsCore.IteratorPrototype, BUGGY_SAFARI_ITERATORS$1 = iteratorsCore.BUGGY_SAFARI_ITERATORS, KEYS = "keys", VALUES = "values", ENTRIES = "entries", returnThis$2 = function() {
          return this;
        }, defineIterator = function(e, t2, r, i2, n, o, a2) {
          createIteratorConstructor(r, t2, i2);
          function s(e2) {
            if (e2 === n && p2)
              return p2;
            if (!BUGGY_SAFARI_ITERATORS$1 && e2 in d)
              return d[e2];
            switch (e2) {
              case KEYS:
              case VALUES:
              case ENTRIES:
                return function() {
                  return new r(this, e2);
                };
            }
            return function() {
              return new r(this);
            };
          }
          var l, u2, c2, h = t2 + " Iterator", f2 = false, d = e.prototype, _ = d[ITERATOR$1] || d["@@iterator"] || n && d[n], p2 = !BUGGY_SAFARI_ITERATORS$1 && _ || s(n), g = "Array" == t2 && d.entries || _;
          if (g && (l = objectGetPrototypeOf(g.call(new e())), IteratorPrototype$2 !== Object.prototype && l.next && (objectGetPrototypeOf(l) !== IteratorPrototype$2 && (objectSetPrototypeOf ? objectSetPrototypeOf(l, IteratorPrototype$2) : "function" != typeof l[ITERATOR$1] && hide(l, ITERATOR$1, returnThis$2)), setToStringTag(l, h, true, true))), n == VALUES && _ && _.name !== VALUES && (f2 = true, p2 = function() {
            return _.call(this);
          }), d[ITERATOR$1] !== p2 && hide(d, ITERATOR$1, p2), iterators[t2] = p2, n)
            if (u2 = { values: s(VALUES), keys: o ? p2 : s(KEYS), entries: s(ENTRIES) }, a2)
              for (c2 in u2)
                !BUGGY_SAFARI_ITERATORS$1 && !f2 && c2 in d || redefine(d, c2, u2[c2]);
            else
              _export({ target: t2, proto: true, forced: BUGGY_SAFARI_ITERATORS$1 || f2 }, u2);
          return u2;
        }, STRING_ITERATOR = "String Iterator", setInternalState = internalState.set, getInternalState = internalState.getterFor(STRING_ITERATOR);
        defineIterator(String, "String", function(e) {
          setInternalState(this, { type: STRING_ITERATOR, string: String(e), index: 0 });
        }, function() {
          var e, t2 = getInternalState(this), r = t2.string, i2 = t2.index;
          return i2 >= r.length ? { value: void 0, done: true } : (e = stringAt(r, i2, true), t2.index += e.length, { value: e, done: false });
        });
        var domIterables = { CSSRuleList: 0, CSSStyleDeclaration: 0, CSSValueList: 0, ClientRectList: 0, DOMRectList: 0, DOMStringList: 0, DOMTokenList: 1, DataTransferItemList: 0, FileList: 0, HTMLAllCollection: 0, HTMLCollection: 0, HTMLFormElement: 0, HTMLSelectElement: 0, MediaList: 0, MimeTypeArray: 0, NamedNodeMap: 0, NodeList: 1, PaintRequestList: 0, Plugin: 0, PluginArray: 0, SVGLengthList: 0, SVGNumberList: 0, SVGPathSegList: 0, SVGPointList: 0, SVGStringList: 0, SVGTransformList: 0, SourceBufferList: 0, StyleSheetList: 0, TextTrackCueList: 0, TextTrackList: 0, TouchList: 0 }, UNSCOPABLES = wellKnownSymbol("unscopables"), ArrayPrototype = Array.prototype;
        null == ArrayPrototype[UNSCOPABLES] && hide(ArrayPrototype, UNSCOPABLES, objectCreate(null));
        var addToUnscopables = function(e) {
          ArrayPrototype[UNSCOPABLES][e] = true;
        }, ARRAY_ITERATOR = "Array Iterator", setInternalState$1 = internalState.set, getInternalState$1 = internalState.getterFor(ARRAY_ITERATOR), es_array_iterator = defineIterator(Array, "Array", function(e, t2) {
          setInternalState$1(this, { type: ARRAY_ITERATOR, target: toIndexedObject(e), index: 0, kind: t2 });
        }, function() {
          var e = getInternalState$1(this), t2 = e.target, r = e.kind, i2 = e.index++;
          return !t2 || i2 >= t2.length ? { value: e.target = void 0, done: true } : "keys" == r ? { value: i2, done: false } : "values" == r ? { value: t2[i2], done: false } : { value: [i2, t2[i2]], done: false };
        }, "values");
        iterators.Arguments = iterators.Array, addToUnscopables("keys"), addToUnscopables("values"), addToUnscopables("entries");
        var ITERATOR$2 = wellKnownSymbol("iterator"), TO_STRING_TAG$3 = wellKnownSymbol("toStringTag"), ArrayValues = es_array_iterator.values;
        for (var COLLECTION_NAME in domIterables) {
          var Collection = global_1[COLLECTION_NAME], CollectionPrototype = Collection && Collection.prototype;
          if (CollectionPrototype) {
            if (CollectionPrototype[ITERATOR$2] !== ArrayValues)
              try {
                hide(CollectionPrototype, ITERATOR$2, ArrayValues);
              } catch (e) {
                CollectionPrototype[ITERATOR$2] = ArrayValues;
              }
            if (CollectionPrototype[TO_STRING_TAG$3] || hide(CollectionPrototype, TO_STRING_TAG$3, COLLECTION_NAME), domIterables[COLLECTION_NAME]) {
              for (var METHOD_NAME in es_array_iterator)
                if (CollectionPrototype[METHOD_NAME] !== es_array_iterator[METHOD_NAME])
                  try {
                    hide(CollectionPrototype, METHOD_NAME, es_array_iterator[METHOD_NAME]);
                  } catch (e) {
                    CollectionPrototype[METHOD_NAME] = es_array_iterator[METHOD_NAME];
                  }
            }
          }
        }
        var aFunction = function(e) {
          if ("function" != typeof e)
            throw TypeError(String(e) + " is not a function");
          return e;
        }, anInstance = function(e, t2, r) {
          if (!(e instanceof t2))
            throw TypeError("Incorrect " + (r ? r + " " : "") + "invocation");
          return e;
        }, ITERATOR$3 = wellKnownSymbol("iterator"), ArrayPrototype$1 = Array.prototype, isArrayIteratorMethod = function(e) {
          return void 0 !== e && (iterators.Array === e || ArrayPrototype$1[ITERATOR$3] === e);
        }, bindContext = function(i2, n, e) {
          if (aFunction(i2), void 0 === n)
            return i2;
          switch (e) {
            case 0:
              return function() {
                return i2.call(n);
              };
            case 1:
              return function(e2) {
                return i2.call(n, e2);
              };
            case 2:
              return function(e2, t2) {
                return i2.call(n, e2, t2);
              };
            case 3:
              return function(e2, t2, r) {
                return i2.call(n, e2, t2, r);
              };
          }
          return function() {
            return i2.apply(n, arguments);
          };
        }, ITERATOR$4 = wellKnownSymbol("iterator"), getIteratorMethod = function(e) {
          if (null != e)
            return e[ITERATOR$4] || e["@@iterator"] || iterators[classof(e)];
        }, callWithSafeIterationClosing = function(t2, e, r, i2) {
          try {
            return i2 ? e(anObject(r)[0], r[1]) : e(r);
          } catch (e2) {
            var n = t2.return;
            throw void 0 !== n && anObject(n.call(t2)), e2;
          }
        }, iterate = createCommonjsModule(function(e) {
          var h = {};
          (e.exports = function(e2, t2, r, i2, n) {
            var o, a2, s, l, u2, c2 = bindContext(t2, r, i2 ? 2 : 1);
            if (n)
              o = e2;
            else {
              if ("function" != typeof (a2 = getIteratorMethod(e2)))
                throw TypeError("Target is not iterable");
              if (isArrayIteratorMethod(a2)) {
                for (s = 0, l = toLength(e2.length); s < l; s++)
                  if ((i2 ? c2(anObject(u2 = e2[s])[0], u2[1]) : c2(e2[s])) === h)
                    return h;
                return;
              }
              o = a2.call(e2);
            }
            for (; !(u2 = o.next()).done; )
              if (callWithSafeIterationClosing(o, c2, u2.value, i2) === h)
                return h;
          }).BREAK = h;
        }), ITERATOR$5 = wellKnownSymbol("iterator"), SAFE_CLOSING = false;
        try {
          var called = 0, iteratorWithReturn = { next: function() {
            return { done: !!called++ };
          }, return: function() {
            SAFE_CLOSING = true;
          } };
          iteratorWithReturn[ITERATOR$5] = function() {
            return this;
          };
        } catch (e) {
        }
        var checkCorrectnessOfIteration = function(e, t2) {
          if (!t2 && !SAFE_CLOSING)
            return false;
          var r = false;
          try {
            var i2 = {};
            i2[ITERATOR$5] = function() {
              return { next: function() {
                return { done: r = true };
              } };
            }, e(i2);
          } catch (e2) {
          }
          return r;
        }, SPECIES = wellKnownSymbol("species"), speciesConstructor = function(e, t2) {
          var r, i2 = anObject(e).constructor;
          return void 0 === i2 || null == (r = anObject(i2)[SPECIES]) ? t2 : aFunction(r);
        }, location = global_1.location, set$1 = global_1.setImmediate, clear = global_1.clearImmediate, process = global_1.process, MessageChannel = global_1.MessageChannel, Dispatch = global_1.Dispatch, counter = 0, queue = {}, ONREADYSTATECHANGE = "onreadystatechange", defer, channel, port, run = function(e) {
          var t2;
          queue.hasOwnProperty(e) && (t2 = queue[e], delete queue[e], t2());
        }, runner = function(e) {
          return function() {
            run(e);
          };
        }, listener = function(e) {
          run(e.data);
        }, post = function(e) {
          global_1.postMessage(e + "", location.protocol + "//" + location.host);
        };
        set$1 && clear || (set$1 = function(e) {
          for (var t2 = [], r = 1; r < arguments.length; )
            t2.push(arguments[r++]);
          return queue[++counter] = function() {
            ("function" == typeof e ? e : Function(e)).apply(void 0, t2);
          }, defer(counter), counter;
        }, clear = function(e) {
          delete queue[e];
        }, "process" == classofRaw(process) ? defer = function(e) {
          process.nextTick(runner(e));
        } : Dispatch && Dispatch.now ? defer = function(e) {
          Dispatch.now(runner(e));
        } : MessageChannel ? (channel = new MessageChannel(), port = channel.port2, channel.port1.onmessage = listener, defer = bindContext(port.postMessage, port, 1)) : !global_1.addEventListener || "function" != typeof postMessage || global_1.importScripts || fails(post) ? defer = ONREADYSTATECHANGE in documentCreateElement("script") ? function(e) {
          html.appendChild(documentCreateElement("script"))[ONREADYSTATECHANGE] = function() {
            html.removeChild(this), run(e);
          };
        } : function(e) {
          setTimeout(runner(e), 0);
        } : (defer = post, global_1.addEventListener("message", listener, false)));
        var task = { set: set$1, clear }, navigator$1 = global_1.navigator, userAgent = navigator$1 && navigator$1.userAgent || "", getOwnPropertyDescriptor$1 = objectGetOwnPropertyDescriptor.f, macrotask = task.set, MutationObserver = global_1.MutationObserver || global_1.WebKitMutationObserver, process$1 = global_1.process, Promise$1 = global_1.Promise, IS_NODE = "process" == classofRaw(process$1), queueMicrotaskDescriptor = getOwnPropertyDescriptor$1(global_1, "queueMicrotask"), queueMicrotask = queueMicrotaskDescriptor && queueMicrotaskDescriptor.value, flush, head, last, notify, toggle, node, promise;
        queueMicrotask || (flush = function() {
          var e, t2;
          for (IS_NODE && (e = process$1.domain) && e.exit(); head; ) {
            t2 = head.fn, head = head.next;
            try {
              t2();
            } catch (e2) {
              throw head ? notify() : last = void 0, e2;
            }
          }
          last = void 0, e && e.enter();
        }, notify = IS_NODE ? function() {
          process$1.nextTick(flush);
        } : MutationObserver && !/(iphone|ipod|ipad).*applewebkit/i.test(userAgent) ? (toggle = true, node = document.createTextNode(""), new MutationObserver(flush).observe(node, { characterData: true }), function() {
          node.data = toggle = !toggle;
        }) : Promise$1 && Promise$1.resolve ? (promise = Promise$1.resolve(void 0), function() {
          promise.then(flush);
        }) : function() {
          macrotask.call(global_1, flush);
        });
        var microtask = queueMicrotask || function(e) {
          var t2 = { fn: e, next: void 0 };
          last && (last.next = t2), head || (head = t2, notify()), last = t2;
        }, PromiseCapability = function(e) {
          var r, i2;
          this.promise = new e(function(e2, t2) {
            if (void 0 !== r || void 0 !== i2)
              throw TypeError("Bad Promise constructor");
            r = e2, i2 = t2;
          }), this.resolve = aFunction(r), this.reject = aFunction(i2);
        }, f$5 = function(e) {
          return new PromiseCapability(e);
        }, newPromiseCapability = { f: f$5 }, promiseResolve = function(e, t2) {
          if (anObject(e), isObject(t2) && t2.constructor === e)
            return t2;
          var r = newPromiseCapability.f(e);
          return (0, r.resolve)(t2), r.promise;
        }, hostReportErrors = function(e, t2) {
          var r = global_1.console;
          r && r.error && (1 === arguments.length ? r.error(e) : r.error(e, t2));
        }, perform = function(e) {
          try {
            return { error: false, value: e() };
          } catch (e2) {
            return { error: true, value: e2 };
          }
        }, redefineAll = function(e, t2, r) {
          for (var i2 in t2)
            redefine(e, i2, t2[i2], r);
          return e;
        }, path = global_1, aFunction$1 = function(e) {
          return "function" == typeof e ? e : void 0;
        }, getBuiltIn = function(e, t2) {
          return arguments.length < 2 ? aFunction$1(path[e]) || aFunction$1(global_1[e]) : path[e] && path[e][t2] || global_1[e] && global_1[e][t2];
        }, SPECIES$1 = wellKnownSymbol("species"), setSpecies = function(e) {
          var t2 = getBuiltIn(e), r = objectDefineProperty.f;
          descriptors && t2 && !t2[SPECIES$1] && r(t2, SPECIES$1, { configurable: true, get: function() {
            return this;
          } });
        }, PROMISE = "Promise", task$1 = task.set, SPECIES$2 = wellKnownSymbol("species"), getInternalState$2 = internalState.get, setInternalState$2 = internalState.set, getInternalPromiseState = internalState.getterFor(PROMISE), PromiseConstructor = global_1[PROMISE], TypeError$1 = global_1.TypeError, document$3 = global_1.document, process$2 = global_1.process, $fetch = global_1.fetch, versions = process$2 && process$2.versions, v8 = versions && versions.v8 || "", newPromiseCapability$1 = newPromiseCapability.f, newGenericPromiseCapability = newPromiseCapability$1, IS_NODE$1 = "process" == classofRaw(process$2), DISPATCH_EVENT = !!(document$3 && document$3.createEvent && global_1.dispatchEvent), UNHANDLED_REJECTION = "unhandledrejection", REJECTION_HANDLED = "rejectionhandled", PENDING = 0, FULFILLED = 1, REJECTED = 2, HANDLED = 1, UNHANDLED = 2, Internal, OwnPromiseCapability, PromiseWrapper, FORCED = isForced_1(PROMISE, function() {
          function t2() {
          }
          var e = PromiseConstructor.resolve(1), r = (e.constructor = {})[SPECIES$2] = function(e2) {
            e2(t2, t2);
          };
          return !((IS_NODE$1 || "function" == typeof PromiseRejectionEvent) && (!isPure || e.finally) && e.then(t2) instanceof r && 0 !== v8.indexOf("6.6") && -1 === userAgent.indexOf("Chrome/66"));
        }), INCORRECT_ITERATION = FORCED || !checkCorrectnessOfIteration(function(e) {
          PromiseConstructor.all(e).catch(function() {
          });
        }), isThenable = function(e) {
          var t2;
          return !(!isObject(e) || "function" != typeof (t2 = e.then)) && t2;
        }, notify$1 = function(c2, h, t2) {
          var r;
          h.notified || (h.notified = true, r = h.reactions, microtask(function() {
            for (var l = h.value, u2 = h.state == FULFILLED, e = 0; r.length > e; )
              !function(e2) {
                var t3, r2, i2, n = u2 ? e2.ok : e2.fail, o = e2.resolve, a2 = e2.reject, s = e2.domain;
                try {
                  n ? (u2 || (h.rejection === UNHANDLED && onHandleUnhandled(c2, h), h.rejection = HANDLED), true === n ? t3 = l : (s && s.enter(), t3 = n(l), s && (s.exit(), i2 = true)), t3 === e2.promise ? a2(TypeError$1("Promise-chain cycle")) : (r2 = isThenable(t3)) ? r2.call(t3, o, a2) : o(t3)) : a2(l);
                } catch (e3) {
                  s && !i2 && s.exit(), a2(e3);
                }
              }(r[e++]);
            h.reactions = [], h.notified = false, t2 && !h.rejection && onUnhandled(c2, h);
          }));
        }, dispatchEvent = function(e, t2, r) {
          var i2, n;
          DISPATCH_EVENT ? ((i2 = document$3.createEvent("Event")).promise = t2, i2.reason = r, i2.initEvent(e, false, true), global_1.dispatchEvent(i2)) : i2 = { promise: t2, reason: r }, (n = global_1["on" + e]) ? n(i2) : e === UNHANDLED_REJECTION && hostReportErrors("Unhandled promise rejection", r);
        }, onUnhandled = function(r, i2) {
          task$1.call(global_1, function() {
            var e, t2 = i2.value;
            if (isUnhandled(i2) && (e = perform(function() {
              IS_NODE$1 ? process$2.emit("unhandledRejection", t2, r) : dispatchEvent(UNHANDLED_REJECTION, r, t2);
            }), i2.rejection = IS_NODE$1 || isUnhandled(i2) ? UNHANDLED : HANDLED, e.error))
              throw e.value;
          });
        }, isUnhandled = function(e) {
          return e.rejection !== HANDLED && !e.parent;
        }, onHandleUnhandled = function(e, t2) {
          task$1.call(global_1, function() {
            IS_NODE$1 ? process$2.emit("rejectionHandled", e) : dispatchEvent(REJECTION_HANDLED, e, t2.value);
          });
        }, bind = function(t2, r, i2, n) {
          return function(e) {
            t2(r, i2, e, n);
          };
        }, internalReject = function(e, t2, r, i2) {
          t2.done || (t2.done = true, i2 && (t2 = i2), t2.value = r, t2.state = REJECTED, notify$1(e, t2, true));
        }, internalResolve = function(r, i2, e, t2) {
          if (!i2.done) {
            i2.done = true, t2 && (i2 = t2);
            try {
              if (r === e)
                throw TypeError$1("Promise can't be resolved itself");
              var n = isThenable(e);
              n ? microtask(function() {
                var t3 = { done: false };
                try {
                  n.call(e, bind(internalResolve, r, t3, i2), bind(internalReject, r, t3, i2));
                } catch (e2) {
                  internalReject(r, t3, e2, i2);
                }
              }) : (i2.value = e, i2.state = FULFILLED, notify$1(r, i2, false));
            } catch (e2) {
              internalReject(r, { done: false }, e2, i2);
            }
          }
        };
        FORCED && (PromiseConstructor = function(e) {
          anInstance(this, PromiseConstructor, PROMISE), aFunction(e), Internal.call(this);
          var t2 = getInternalState$2(this);
          try {
            e(bind(internalResolve, this, t2), bind(internalReject, this, t2));
          } catch (e2) {
            internalReject(this, t2, e2);
          }
        }, Internal = function() {
          setInternalState$2(this, { type: PROMISE, done: false, notified: false, parent: false, reactions: [], rejection: false, state: PENDING, value: void 0 });
        }, Internal.prototype = redefineAll(PromiseConstructor.prototype, { then: function(e, t2) {
          var r = getInternalPromiseState(this), i2 = newPromiseCapability$1(speciesConstructor(this, PromiseConstructor));
          return i2.ok = "function" != typeof e || e, i2.fail = "function" == typeof t2 && t2, i2.domain = IS_NODE$1 ? process$2.domain : void 0, r.parent = true, r.reactions.push(i2), r.state != PENDING && notify$1(this, r, false), i2.promise;
        }, catch: function(e) {
          return this.then(void 0, e);
        } }), OwnPromiseCapability = function() {
          var e = new Internal(), t2 = getInternalState$2(e);
          this.promise = e, this.resolve = bind(internalResolve, e, t2), this.reject = bind(internalReject, e, t2);
        }, newPromiseCapability.f = newPromiseCapability$1 = function(e) {
          return e === PromiseConstructor || e === PromiseWrapper ? new OwnPromiseCapability(e) : newGenericPromiseCapability(e);
        }, "function" == typeof $fetch && _export({ global: true, enumerable: true, forced: true }, { fetch: function(e) {
          return promiseResolve(PromiseConstructor, $fetch.apply(global_1, arguments));
        } })), _export({ global: true, wrap: true, forced: FORCED }, { Promise: PromiseConstructor }), setToStringTag(PromiseConstructor, PROMISE, false, true), setSpecies(PROMISE), PromiseWrapper = path[PROMISE], _export({ target: PROMISE, stat: true, forced: FORCED }, { reject: function(e) {
          var t2 = newPromiseCapability$1(this);
          return t2.reject.call(void 0, e), t2.promise;
        } }), _export({ target: PROMISE, stat: true, forced: FORCED }, { resolve: function(e) {
          return promiseResolve(this, e);
        } }), _export({ target: PROMISE, stat: true, forced: INCORRECT_ITERATION }, { all: function(e) {
          var s = this, t2 = newPromiseCapability$1(s), l = t2.resolve, u2 = t2.reject, r = perform(function() {
            var i2 = aFunction(s.resolve), n = [], o = 0, a2 = 1;
            iterate(e, function(e2) {
              var t3 = o++, r2 = false;
              n.push(void 0), a2++, i2.call(s, e2).then(function(e3) {
                r2 || (r2 = true, n[t3] = e3, --a2 || l(n));
              }, u2);
            }), --a2 || l(n);
          });
          return r.error && u2(r.value), t2.promise;
        }, race: function(e) {
          var r = this, i2 = newPromiseCapability$1(r), n = i2.reject, t2 = perform(function() {
            var t3 = aFunction(r.resolve);
            iterate(e, function(e2) {
              t3.call(r, e2).then(i2.resolve, n);
            });
          });
          return t2.error && n(t2.value), i2.promise;
        } }), _export({ target: "Promise", proto: true, real: true }, { finally: function(t2) {
          var r = speciesConstructor(this, getBuiltIn("Promise")), e = "function" == typeof t2;
          return this.then(e ? function(e2) {
            return promiseResolve(r, t2()).then(function() {
              return e2;
            });
          } : t2, e ? function(e2) {
            return promiseResolve(r, t2()).then(function() {
              throw e2;
            });
          } : t2);
        } });
        var promise$1 = path.Promise, perf, start;
        function _typeof(e) {
          return (_typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e2) {
            return typeof e2;
          } : function(e2) {
            return e2 && "function" == typeof Symbol && e2.constructor === Symbol && e2 !== Symbol.prototype ? "symbol" : typeof e2;
          })(e);
        }
        function _classCallCheck(e, t2) {
          if (!(e instanceof t2))
            throw new TypeError("Cannot call a class as a function");
        }
        function _defineProperties(e, t2) {
          for (var r = 0; r < t2.length; r++) {
            var i2 = t2[r];
            i2.enumerable = i2.enumerable || false, i2.configurable = true, "value" in i2 && (i2.writable = true), Object.defineProperty(e, i2.key, i2);
          }
        }
        function _createClass(e, t2, r) {
          return t2 && _defineProperties(e.prototype, t2), r && _defineProperties(e, r), e;
        }
        function _defineProperty(e, t2, r) {
          return t2 in e ? Object.defineProperty(e, t2, { value: r, enumerable: true, configurable: true, writable: true }) : e[t2] = r, e;
        }
        function _inherits(e, t2) {
          if ("function" != typeof t2 && null !== t2)
            throw new TypeError("Super expression must either be null or a function");
          e.prototype = Object.create(t2 && t2.prototype, { constructor: { value: e, writable: true, configurable: true } }), t2 && _setPrototypeOf(e, t2);
        }
        function _getPrototypeOf(e) {
          return (_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function(e2) {
            return e2.__proto__ || Object.getPrototypeOf(e2);
          })(e);
        }
        function _setPrototypeOf(e, t2) {
          return (_setPrototypeOf = Object.setPrototypeOf || function(e2, t3) {
            return e2.__proto__ = t3, e2;
          })(e, t2);
        }
        function _isNativeReflectConstruct() {
          if ("undefined" == typeof Reflect || !Reflect.construct)
            return false;
          if (Reflect.construct.sham)
            return false;
          if ("function" == typeof Proxy)
            return true;
          try {
            return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
            })), true;
          } catch (e) {
            return false;
          }
        }
        function _construct(e, t2, r) {
          return (_construct = _isNativeReflectConstruct() ? Reflect.construct : function(e2, t3, r2) {
            var i2 = [null];
            i2.push.apply(i2, t3);
            var n = new (Function.bind.apply(e2, i2))();
            return r2 && _setPrototypeOf(n, r2.prototype), n;
          }).apply(null, arguments);
        }
        function _isNativeFunction(e) {
          return -1 !== Function.toString.call(e).indexOf("[native code]");
        }
        function _wrapNativeSuper(e) {
          var r = "function" == typeof Map ? /* @__PURE__ */ new Map() : void 0;
          return (_wrapNativeSuper = function(e2) {
            if (null === e2 || !_isNativeFunction(e2))
              return e2;
            if ("function" != typeof e2)
              throw new TypeError("Super expression must either be null or a function");
            if (void 0 !== r) {
              if (r.has(e2))
                return r.get(e2);
              r.set(e2, t2);
            }
            function t2() {
              return _construct(e2, arguments, _getPrototypeOf(this).constructor);
            }
            return t2.prototype = Object.create(e2.prototype, { constructor: { value: t2, enumerable: false, writable: true, configurable: true } }), _setPrototypeOf(t2, e2);
          })(e);
        }
        function _assertThisInitialized(e) {
          if (void 0 === e)
            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
          return e;
        }
        function _possibleConstructorReturn(e, t2) {
          return !t2 || "object" != typeof t2 && "function" != typeof t2 ? _assertThisInitialized(e) : t2;
        }
        function _createSuper(r) {
          var i2 = _isNativeReflectConstruct();
          return function() {
            var e, t2 = _getPrototypeOf(r);
            return _possibleConstructorReturn(this, i2 ? (e = _getPrototypeOf(this).constructor, Reflect.construct(t2, arguments, e)) : t2.apply(this, arguments));
          };
        }
        function _superPropBase(e, t2) {
          for (; !Object.prototype.hasOwnProperty.call(e, t2) && null !== (e = _getPrototypeOf(e)); )
            ;
          return e;
        }
        function _get(e, t2, r) {
          return (_get = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function(e2, t3, r2) {
            var i2 = _superPropBase(e2, t3);
            if (i2) {
              var n = Object.getOwnPropertyDescriptor(i2, t3);
              return n.get ? n.get.call(r2) : n.value;
            }
          })(e, t2, r || e);
        }
        function _slicedToArray(e, t2) {
          return _arrayWithHoles(e) || _iterableToArrayLimit(e, t2) || _unsupportedIterableToArray(e, t2) || _nonIterableRest();
        }
        function _toConsumableArray(e) {
          return _arrayWithoutHoles(e) || _iterableToArray(e) || _unsupportedIterableToArray(e) || _nonIterableSpread();
        }
        function _arrayWithoutHoles(e) {
          if (Array.isArray(e))
            return _arrayLikeToArray(e);
        }
        function _arrayWithHoles(e) {
          if (Array.isArray(e))
            return e;
        }
        function _iterableToArray(e) {
          if ("undefined" != typeof Symbol && Symbol.iterator in Object(e))
            return Array.from(e);
        }
        function _iterableToArrayLimit(e, t2) {
          if ("undefined" != typeof Symbol && Symbol.iterator in Object(e)) {
            var r = [], i2 = true, n = false, o = void 0;
            try {
              for (var a2, s = e[Symbol.iterator](); !(i2 = (a2 = s.next()).done) && (r.push(a2.value), !t2 || r.length !== t2); i2 = true)
                ;
            } catch (e2) {
              n = true, o = e2;
            } finally {
              try {
                i2 || null == s.return || s.return();
              } finally {
                if (n)
                  throw o;
              }
            }
            return r;
          }
        }
        function _unsupportedIterableToArray(e, t2) {
          if (e) {
            if ("string" == typeof e)
              return _arrayLikeToArray(e, t2);
            var r = Object.prototype.toString.call(e).slice(8, -1);
            return "Object" === r && e.constructor && (r = e.constructor.name), "Map" === r || "Set" === r ? Array.from(e) : "Arguments" === r || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? _arrayLikeToArray(e, t2) : void 0;
          }
        }
        function _arrayLikeToArray(e, t2) {
          (null == t2 || t2 > e.length) && (t2 = e.length);
          for (var r = 0, i2 = new Array(t2); r < t2; r++)
            i2[r] = e[r];
          return i2;
        }
        function _nonIterableSpread() {
          throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
        }
        function _nonIterableRest() {
          throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
        }
        function _createForOfIteratorHelper(e, t2) {
          var r;
          if ("undefined" == typeof Symbol || null == e[Symbol.iterator]) {
            if (Array.isArray(e) || (r = _unsupportedIterableToArray(e)) || t2 && e && "number" == typeof e.length) {
              r && (e = r);
              var i2 = 0, n = function() {
              };
              return { s: n, n: function() {
                return i2 >= e.length ? { done: true } : { done: false, value: e[i2++] };
              }, e: function(e2) {
                throw e2;
              }, f: n };
            }
            throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
          }
          var o, a2 = true, s = false;
          return { s: function() {
            r = e[Symbol.iterator]();
          }, n: function() {
            var e2 = r.next();
            return a2 = e2.done, e2;
          }, e: function(e2) {
            s = true, o = e2;
          }, f: function() {
            try {
              a2 || null == r.return || r.return();
            } finally {
              if (s)
                throw o;
            }
          } };
        }
        "function" != typeof Object.assign && (Object.assign = function(e) {
          if (null == e)
            throw new TypeError("Cannot convert undefined or null to object");
          for (var t2 = Object(e), r = 1; r < arguments.length; r++) {
            var i2 = arguments[r];
            if (null != i2)
              for (var n in i2)
                i2.hasOwnProperty(n) && (t2[n] = i2[n]);
          }
          return t2;
        }), "function" != typeof Object.values && (Object.values = function(t2) {
          return Object.keys(t2).map(function(e) {
            return t2[e];
          });
        }), Math.hypot = Math.hypot || function() {
          for (var e = 0, t2 = arguments.length, r = 0; r < t2; r++) {
            if (arguments[r] === 1 / 0 || arguments[r] === -1 / 0)
              return 1 / 0;
            e += arguments[r] * arguments[r];
          }
          return Math.sqrt(e);
        }, Math.log2 = Math.log2 || function(e) {
          return Math.log(e) * Math.LOG2E;
        }, "undefined" != typeof window ? ("performance" in window == false && (window.performance = {}), perf = window.performance) : "undefined" != typeof self && "undefined" != typeof WorkerGlobalScope && self instanceof WorkerGlobalScope && ("performance" in self == false && (self.performance = {}), perf = self.performance), perf && "function" != typeof perf.now && (start = +/* @__PURE__ */ new Date(), perf.now = function() {
          return /* @__PURE__ */ new Date() - start;
        });
        var global$1 = "undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : {}, ns = {}, MathUtils;
        (function() {
          var e, t2, o = "function" == typeof Object.defineProperties ? Object.defineProperty : function(e2, t3, r2) {
            e2 != Array.prototype && e2 != Object.prototype && (e2[t3] = r2.value);
          }, a2 = ("undefined" == typeof window || window !== this) && void 0 !== global$1 && null != global$1 ? global$1 : this;
          if ("function" == typeof Object.setPrototypeOf)
            e = Object.setPrototypeOf;
          else {
            e: {
              var r = {};
              try {
                r.__proto__ = { ea: true }, t2 = r.ea;
                break e;
              } catch (e2) {
              }
              t2 = false;
            }
            e = t2 ? function(e2, t3) {
              if (e2.__proto__ = t3, e2.__proto__ !== t3)
                throw new TypeError(e2 + " is not extensible");
              return e2;
            } : null;
          }
          var i2 = e;
          !function(e2, t3) {
            if (t3) {
              var r2 = a2;
              e2 = e2.split(".");
              for (var i3 = 0; i3 < e2.length - 1; i3++) {
                var n2 = e2[i3];
                n2 in r2 || (r2[n2] = {}), r2 = r2[n2];
              }
              (t3 = t3(i3 = r2[e2 = e2[e2.length - 1]])) != i3 && null != t3 && o(r2, e2, { configurable: true, writable: true, value: t3 });
            }
          }("Object.setPrototypeOf", function(e2) {
            return e2 || i2;
          });
          var n = this || self;
          function s(e2) {
            var t3 = _typeof(e2);
            if ("object" == t3) {
              if (!e2)
                return "null";
              if (e2 instanceof Array)
                return "array";
              if (e2 instanceof Object)
                return t3;
              var r2 = Object.prototype.toString.call(e2);
              if ("[object Window]" == r2)
                return "object";
              if ("[object Array]" == r2 || "number" == typeof e2.length && void 0 !== e2.splice && void 0 !== e2.propertyIsEnumerable && !e2.propertyIsEnumerable("splice"))
                return "array";
              if ("[object Function]" == r2 || void 0 !== e2.call && void 0 !== e2.propertyIsEnumerable && !e2.propertyIsEnumerable("call"))
                return "function";
            } else if ("function" == t3 && void 0 === e2.call)
              return "object";
            return t3;
          }
          function u2(e2) {
            return "function" == s(e2);
          }
          function c2(e2) {
            var t3 = _typeof(e2);
            return "object" == t3 && null != e2 || "function" == t3;
          }
          function l(e2, t3) {
            e2 = e2.split(".");
            var r2, i3 = n;
            e2[0] in i3 || void 0 === i3.execScript || i3.execScript("var " + e2[0]);
            for (; e2.length && (r2 = e2.shift()); )
              e2.length || void 0 === t3 ? i3 = i3[r2] && i3[r2] !== Object.prototype[r2] ? i3[r2] : i3[r2] = {} : i3[r2] = t3;
          }
          function h(e2, t3) {
            function r2() {
            }
            r2.prototype = t3.prototype, e2.ua = t3.prototype, e2.prototype = new r2(), e2.prototype.constructor = e2;
          }
          var f2 = Math, d = f2.min, _ = f2.max, p2 = f2.round, g = f2.floor, m = f2.ceil, y = f2.abs, v = f2.log, x2 = f2.sqrt, b2 = f2.pow, T2 = f2.sin, A2 = f2.asin, E2 = f2.cos, w = f2.tan, S2 = f2.atan2, k = f2.PI, P2 = k / 2, R2 = k / 4, M2 = 2 * k, L2 = 3 * k, O2 = k / 180, C2 = 180 / k;
          function N2(e2, t3, r2) {
            return r2 < e2 ? r2 : e2 < t3 ? t3 : e2;
          }
          function I(e2, t3, r2) {
            return t3 < r2 ? t3 <= e2 && e2 <= r2 : r2 <= e2 && e2 <= t3;
          }
          function B2(e2, t3, r2, i3, n2, o2) {
            return x2(b2((e2 - n2) * (i3 - o2) - (t3 - o2) * (r2 - n2), 2) / (b2(r2 - n2, 2) + b2(i3 - o2, 2)));
          }
          l("H.math.normalize", function(e2, t3, r2) {
            return t3 -= r2 = r2 || 0, (e2 -= r2) - g(e2 / t3) * t3 + r2;
          }), l("H.math.clamp", N2);
          var z2 = { NONE: 0, VERTEX: 1, EDGE: 2, SURFACE: 3 };
          function U2(e2, t3) {
            var r2 = e2.x;
            e2 = e2.y;
            for (var i3, n2, o2, a3, s2 = t3.length, l2 = s2, u3 = t3[0], c3 = 0, h2 = 0, f3 = 0; 1 != c3 && 1 < l2; )
              n2 = t3[--l2], i3 = t3[--l2], a3 = t3[l2 ? l2 - 1 : (s2 + (l2 - 1)) % s2], o2 = t3[l2 ? l2 - 2 : (s2 + (l2 - 2)) % s2], r2 <= i3 && i3 <= r2 && e2 <= n2 && n2 <= e2 || r2 <= o2 && o2 <= r2 && e2 <= a3 && a3 <= e2 ? c3 = 1 : c3 || i3 !== r2 ? !c3 && I(r2, i3, o2) && ((i3 < r2 && r2 < o2 || r2 < i3 && o2 < r2) && (h2 += e2 < (u3 = n2 + (r2 - i3) / (o2 - i3) * (a3 - n2)), f3 += u3 < e2), c3 = I(e2, n2, a3) && B2(r2, e2, i3, n2, o2, a3) <= 0 ? 2 : 0) : (o2 === r2 && (n2 < e2 && e2 < a3 || e2 < n2 && a3 < e2) || (u3 <= r2 && r2 < o2 || r2 <= u3 && o2 < r2) && (e2 <= n2 ? ++h2 : ++f3), c3 = I(e2, n2, a3) && B2(r2, e2, i3, n2, o2, a3) <= 0 ? 2 : 0), u3 = i3;
            return c3 || 0 === f3 || 0 == h2 % 2 || (c3 = 3), c3 !== z2.NONE;
          }
          function H2(e2, t3) {
            this.x = +e2, this.y = +t3;
          }
          function F2(e2, t3, r2, i3, n2, o2, a3, s2, l2, u3) {
            return e2 = { x: e2, y: t3, next: r2 || null, s: i3 || null, ta: n2 || null, X: o2 || null, o: !!a3, T: s2 || 0, O: l2 || 0, alpha: u3 || 0 }, i3 && (e2.s.next = e2), r2 && (e2.next.s = e2), e2;
          }
          function G(e2) {
            for (; e2 && e2.o; )
              e2 = e2.next;
            return e2;
          }
          function D2(e2) {
            if (e2)
              for (; e2.next; )
                e2 = e2.next;
            return e2;
          }
          function $(e2) {
            var t3 = D2(e2);
            (t3.s.next = e2).s = t3.s;
          }
          function j(e2) {
            for (var t3 = []; e2; )
              t3.push(e2.x, e2.y), e2 = e2.next;
            return t3;
          }
          function V(e2, t3, r2) {
            for (t3 = t3.next; t3 !== r2 && t3.alpha <= e2.alpha; )
              t3 = t3.next;
            e2.next = t3, e2.s = t3.s, (e2.next.s = e2).s.next = e2;
          }
          function W2(e2, t3) {
            for (var r2, i3 = null, n2 = 0, o2 = e2.length; n2 < o2; n2++)
              (r2 = F2(e2[n2].x, e2[n2].y, i3)).qa = t3, (r2.next = i3) && (i3.s = r2), i3 = r2;
            return i3;
          }
          function Y2(e2, t3, r2, i3) {
            return (e2 -= r2) * e2 + (t3 -= i3) * t3;
          }
          l("H.math.CoverType", z2), l("H.math.isPointInsidePolygon", U2), l("H.math.flatten", function(e2) {
            for (var t3 = e2.length, r2 = new Float64Array(2 * t3), i3 = t3 && e2[0].x !== Z2; t3--; ) {
              var n2 = e2[t3], o2 = t3 << 1;
              r2[o2] = i3 ? n2.x : n2[0], r2[1 + o2] = i3 ? n2.y : n2[1];
            }
            return r2;
          }), l("H.math.Point", H2), (H2.prototype.set = H2).prototype.clone = function(e2) {
            return e2 ? (e2.x = this.x, e2.y = this.y) : e2 = new H2(this.x, this.y), e2;
          }, H2.prototype.add = function(e2) {
            return this.x += e2.x, this.y += e2.y, this;
          }, H2.prototype.sub = function(e2) {
            return this.x -= e2.x, this.y -= e2.y, this;
          }, H2.prototype.scale = function(e2, t3) {
            return this.x *= e2, this.y *= void 0 === t3 ? e2 : t3, this;
          }, H2.prototype.round = function() {
            return this.x = p2(this.x), this.y = p2(this.y), this;
          }, H2.prototype.floor = function() {
            return this.x = g(this.x), this.y = g(this.y), this;
          }, H2.prototype.ceil = function() {
            return this.x = m(this.x), this.y = m(this.y), this;
          }, H2.prototype.equals = H2.prototype.w = function(e2) {
            return !(!e2 || this.x !== e2.x || this.y !== e2.y);
          }, H2.prototype.getNearest = H2.prototype.la = function(e2, t3) {
            var r2, i3 = t3.x - e2.x, n2 = t3.y - e2.y, o2 = e2;
            return (i3 || n2) && (o2 = (r2 = ((this.x - e2.x) * i3 + (this.y - e2.y) * n2) / (i3 * i3 + n2 * n2)) <= 0 ? e2 : 1 <= r2 ? t3 : new H2(e2.x + r2 * i3, e2.y + r2 * n2)), o2;
          }, H2.prototype.distance = H2.prototype.R = function(e2) {
            return x2(b2(this.x - e2.x, 2) + b2(this.y - e2.y, 2));
          }, H2.fromIPoint = function(e2) {
            if (!e2)
              throw Error("invalid argument");
            return e2 instanceof H2 ? e2 : new H2(e2.x, e2.y);
          }, l("H.math.clipping.clipStrips", function(e2, t3, r2, i3, n2, o2) {
            var a3, s2, l2, u3 = e2.length;
            if (u3)
              for (a3 = []; u3--; )
                for (var c3, h2, f3 = e2[u3], d2 = f3.length, _2 = 0, p3 = 1; p3 < d2; p3++) {
                  (l2 = function(e3, t4, r3, i4, n3, o3) {
                    var a4 = e3.x;
                    e3 = -e3.y;
                    var s3 = t4.x;
                    if (t4 = -t4.y, r3 = -r3, o3 = -o3, s3 < a4) {
                      if (n3 < s3 || a4 < i4)
                        return;
                      var l3 = a4, u4 = e3;
                      a4 = s3, e3 = t4, s3 = l3, t4 = u4, l3 = 1;
                    } else if (n3 < a4 || s3 < i4)
                      return;
                    if (t4 < e3) {
                      if (r3 < t4 || e3 < o3)
                        return;
                      var c4 = 1;
                      e3 = -e3, t4 = -t4, u4 = o3, o3 = -r3, r3 = -u4;
                    } else if (r3 < e3 || t4 < o3)
                      return;
                    if (a4 < i4) {
                      if ((e3 += (i4 - a4) * (t4 - e3) / (s3 - a4)) > r3)
                        return;
                      a4 = i4;
                    }
                    if (e3 < o3) {
                      if ((a4 += (o3 - e3) * (s3 - a4) / (t4 - e3)) > n3)
                        return;
                      e3 = o3;
                    }
                    return n3 < s3 && (t4 = e3 + (n3 - a4) * (t4 - e3) / (s3 - a4), s3 = n3), r3 < t4 && (s3 = a4 + (r3 - e3) * (s3 - a4) / (t4 - e3), t4 = r3), c4 && (e3 = -e3, t4 = -t4), l3 ? [new H2(s3, -t4), new H2(a4, -e3)] : [new H2(a4, -e3), new H2(s3, -t4)];
                  }(f3[p3 - 1], f3[p3], r2, t3, i3, n2)) && (c3 = l2[0], h2 = l2[1], _2 && _2.w(c3) ? s2.push(h2) : a3.push(s2 = l2), _2 = h2, o2 && (p3 = d2, u3 = 0));
                }
            else
              a3 = e2;
            return a3;
          }), l("H.math.clipping.clipPolygon", function(e2, t3, r2) {
            var i3;
            e2 = W2(e2, true), t3 = W2(t3, false);
            var n2 = {}, o2 = i3 = 1;
            switch (~~(r2 || 0)) {
              case 1:
                o2 = i3 = 0;
                break;
              case 2:
                i3 = 0, o2 = 1;
                break;
              case 3:
                i3 = 1, o2 = 0;
            }
            r2 = i3;
            var a3, s2, l2, u3, c3, h2, f3 = o2;
            if (t3 && e2) {
              for (t3.M = F2(t3.x, t3.y, null, D2(t3)), e2.M = F2(e2.x, e2.y, null, D2(e2)), o2 = t3; o2.next; o2 = o2.next)
                if (!o2.o)
                  for (i3 = e2; i3.next; i3 = i3.next) {
                    i3.o || (h2 = function e3(t4, r3, i4, n3, o3) {
                      var a4, s3 = r3.x - t4.x, l3 = r3.y - t4.y;
                      var u4 = n3.x - i4.x;
                      var c4 = n3.y - i4.y;
                      var h3 = s3 * c4 - l3 * u4;
                      if (!h3)
                        return 0;
                      u4 = ((i4.x - t4.x) * c4 - (i4.y - t4.y) * u4) / h3;
                      h3 = (l3 * (i4.x - t4.x) - s3 * (i4.y - t4.y)) / h3;
                      if (u4 < 0 || 1 < u4 || h3 < 0 || 1 < h3)
                        return 0;
                      0 === u4 ? a4 = t4 : 1 === u4 ? a4 = r3 : 0 === h3 ? a4 = i4 : 1 === h3 && (a4 = n3);
                      if (a4)
                        return a4.x += 2480549651603763e-20, a4.y += 7321997314118067e-20, a4.M && (a4.M.x = a4.x, a4.M.y = a4.y), e3(t4, r3, i4, n3, o3);
                      o3.xa = t4.x + u4 * s3;
                      o3.ya = t4.y + u4 * l3;
                      o3.fa = u4;
                      o3.ga = h3;
                      return 1;
                    }(o2, a3 = G(o2.next), i3, s2 = G(i3.next), n2)) && (h2 = n2.fa, l2 = n2.ga, V(h2 = F2(u3 = n2.xa, c3 = n2.ya, null, null, null, null, true, 0, 0, h2), o2, a3), V(a3 = F2(u3, c3, null, null, null, null, true, 0, 0, l2), i3, s2), (h2.X = a3).X = h2);
                  }
              for (n2 = U2(t3, j(e2)), r2 && (n2 = !n2), o2 = t3; o2; o2 = o2.next)
                o2.o && (n2 = !(o2.T = n2));
              for (n2 = U2(e2, j(t3)), f3 && (n2 = !n2), i3 = e2; i3.next; i3 = i3.next)
                i3.o && (n2 = !(i3.T = n2));
              for ($(t3), $(e2); (e2 = function(e3) {
                var t4 = e3;
                if (t4)
                  for (; (t4 = t4.next) != e3 && (!t4.o || t4.o && t4.O); )
                    ;
                return t4;
              }(t3)) != t3; ) {
                for (r2 = null; !e2.O; e2 = e2.X) {
                  for (n2 = e2.T; (r2 = F2(e2.x, e2.y, r2)).artificial = e2.o || e2.qa, e2.O = 1, e2 = n2 ? e2.next : e2.s; )
                    if (e2.o) {
                      e2.O = 1;
                      break;
                    }
                  if (!e2)
                    break;
                }
                r2.ta = d2;
                var d2 = r2;
              }
              return d2;
            }
          }), l("H.math.simplifyDP", function(e2, t3, r2) {
            return function e3(t4, r3, i3, n2, o2) {
              var a3 = 0, s2 = n2, l2 = t4[n2].x, u3 = t4[n2].y, c3 = t4[o2].x, h2 = t4[o2].y, f3 = n2 + 1, d2 = Y2(l2, u3, c3, h2);
              if (d2)
                for (; f3 < o2; ) {
                  var _2 = t4[f3++], p3 = _2.x;
                  _2 = _2.y;
                  var g2 = ((p3 - l2) * (c3 - l2) + (_2 - u3) * (h2 - u3)) / d2;
                  p3 = g2 < 0 ? Y2(p3, _2, l2, u3) : 1 < g2 ? Y2(p3, _2, c3, h2) : Y2(p3, _2, l2 + g2 * (c3 - l2), u3 + g2 * (h2 - u3)), a3 < p3 && (a3 = p3, s2 = f3 - 1);
                }
              else
                for (; f3 < o2; )
                  _2 = t4[f3++], p3 = _2.x, _2 = _2.y, p3 = Y2(p3, _2, l2, u3), a3 < p3 && (a3 = p3, s2 = f3 - 1);
              n2 = r3 <= a3 || 0 < i3 && s2 - n2 ? (--i3, 1 < s2 - n2 ? (n2 = e3(t4, r3, i3, n2, s2), n2.splice(n2.length - 1, 1)) : n2 = [t4[n2]], 1 < o2 - s2 ? n2.concat(e3(t4, r3, i3, s2, o2)) : n2.concat(t4.slice(s2, o2 + 1))) : [t4[n2], t4[o2]];
              return n2;
            }(e2, t3 * t3, r2 || 0, 0, e2.length - 1);
          });
          var q = this, X2 = String, Z2 = [].pop(), K2 = /x/.exec(""), J2 = "prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
          function Q(e2, t3) {
            if (true == (e2 instanceof t3 && e2.constructor === t3))
              throw new TypeError("Illegal constructor " + ne2(t3));
          }
          l("H.lang.isArray", function(e2, t3, r2, i3) {
            var n2;
            if (!(n2 = "Array" === re2(e2)) && t3)
              throw new ue2(t3, r2, i3 !== Z2 ? i3 : e2);
            return n2;
          }), l("H.lang.isString", function(e2) {
            return "string" == typeof e2;
          });
          var ee2 = isNaN;
          function te2(e2) {
            return e2 === +e2;
          }
          function re2(e2) {
            var t3 = Object[J2[0]][J2[6]].call(e2).match(/^\[object (\w+)\]$/);
            return t3 ? t3[1] : _typeof(e2);
          }
          l("H.lang.isNumber", te2), l("H.lang.isInteger", Number.isInteger ? Number.isInteger : function(e2) {
            return "number" == typeof e2 && 0 == e2 % 1;
          });
          var ie2 = [];
          function ne2(n2, e2, o2, a3) {
            var s2, t3, l2 = "", r2 = arguments.length < 2;
            return r2 && (e2 = { H: q.H }, o2 = "", a3 = ie2.slice()), se2(e2, true, function(e3, t4) {
              try {
                if (s2 = e3[t4], r3 = s2, se2(e3, !(i3 = []), function(e4, t5) {
                  e4[t5] === r3 && i3.push(t5);
                }), t4 = i3.sort(oe2)[0], !(c2(s2) && s2.window === s2 && s2.self === s2 || c2(s2) && 0 < s2.nodeType && u2(s2.cloneNode)) && c2(s2)) {
                  if (s2 === n2)
                    return l2 = o2 + "." + t4, 1;
                  if (a3.indexOf(s2) < 0 && (a3.push(s2), l2 = ne2(n2, s2, o2 + "." + t4, a3)))
                    return 1;
                }
              } catch (e4) {
              }
              var r3, i3;
            }), r2 && (l2 = l2 ? l2.substr(1).replace("." + J2[0] + ".", "#") : "~" + (u2(n2) ? ((t3 = /^\s*function ([^\( ]+)/.exec(t3 = n2)) ? t3[1] : "anonymous") + "()" : re2(n2))), l2;
          }
          function oe2(e2, t3) {
            return t3.length - e2.length;
          }
          ie2.indexOf(ie2) < 0 && ie2.push(ie2);
          var ae2 = Object[J2[0]][J2[2]];
          function se2(e2, t3, r2) {
            var i3;
            if (e2) {
              for (n2 in e2)
                if ((!t3 || ae2.call(e2, n2)) && r2(e2, n2, true))
                  return;
              for (i3 = J2.length; i3--; ) {
                var n2 = J2[i3];
                if ((!t3 || ae2.call(e2, n2)) && r2(e2, n2, false))
                  break;
              }
            }
          }
          function le2(e2, t3, r2) {
            r2[t3] = "#" + t3;
          }
          function ue2(e2, t3, r2) {
            var i3, n2, o2 = arguments.length;
            return (t3 = t3 !== Z2 ? +t3 : t3) !== Z2 && ((n2 = i3 = (n2 = /^.*?\(([^\)]+)/.exec(("" + e2).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm, ""))) ? X2(n2[1].replace(/\s+/g, "")).split("," !== Z2 ? "," : " ") : []).forEach(le2), n2 = n2[t3] || "#" + t3), i3 = e2 ? ne2(e2) : "", o2 = 2 < o2 ? X2(r2) : "", (n2 || o2) && (i3 += " (Argument " + (n2 || "") + (o2 ? " " + o2 : "") + ")"), o2 = Error(i3), Object.setPrototypeOf(o2, ue2.prototype), o2;
          }
          function ce2(e2, t3, r2) {
            var i3 = N2(+e2, -90, 90);
            if (t3 && ee2(i3))
              throw new ue2(t3, r2, e2);
            return i3;
          }
          function he2(e2, t3, r2) {
            var i3, n2 = +e2;
            if ((n2 < -180 || 180 < n2) && (n2 = (false == (i3 = (n2 + 180) % 360) < 0 ? i3 : 360 + i3) - 180), t3 && ee2(n2))
              throw new ue2(t3, r2, e2);
            return n2;
          }
          function fe2(e2, t3, r2) {
            var i3;
            if (e2 !== Z2 && ee2(i3 = +e2) && t3)
              throw new ue2(t3, r2, e2);
            return i3;
          }
          function de2() {
            Q(this, de2);
          }
          function _e(e2, t3, r2) {
            this.lat = ce2(e2, _e, 0), this.lng = he2(t3, _e, 1), r2 !== Z2 && (this.alt = fe2(r2, _e, 2));
          }
          function pe2(e2, t3, r2) {
            var i3 = c2(e2) && !(ee2(e2.lat = ce2(e2.lat)) || ee2(e2.lng = he2(e2.lng)) || e2.alt !== Z2 && ee2(e2.alt = fe2(e2.alt)));
            if (!i3 && t3)
              throw new ue2(t3, r2, e2);
            return i3;
          }
          function ge2(e2, t3, r2, i3) {
            me2(this, ce2(e2, ge2, 0), he2(t3, ge2, 1), ce2(r2, ge2, 2), he2(i3, ge2, 3));
          }
          function me2(e2, t3, r2, i3, n2) {
            return e2.f = r2, e2.g = n2, t3 < i3 && (r2 = t3, t3 = i3, i3 = r2), e2.i = t3, e2.h = i3, e2.m = e2.b = e2.c = null, e2;
          }
          function ye2(e2, t3) {
            return (e2 = t3 - e2) + (e2 < 0 ? 360 : 0);
          }
          function ve2(e2, t3) {
            return (e2 += t3 / 2) - (180 < e2 ? 360 : 0);
          }
          function xe2(e2, t3, r2, i3, n2, o2, a3, s2, l2) {
            r2 = d(r2, a3), e2 = _(e2, n2);
            var u3 = ve2(t3, n2 = ye2(t3, i3)), c3 = ve2(o2, a3 = ye2(o2, s2)) - u3, h2 = (c3 += c3 - 1e-6 < 0 ? 360 : 0) - 1e-6 < 180 ? (u3 = t3, s2) : (c3 = 360 - c3, u3 = o2, i3);
            return 360 <= (c3 = c3 + n2 / 2 + a3 / 2) + 5e-7 ? (u3 = -180, h2 = 180) : c3 - 5e-7 < n2 ? (u3 = t3, h2 = i3) : c3 - 5e-7 < a3 && (u3 = o2, h2 = s2), l2 ? me2(l2, e2, u3, r2, h2) : new ge2(e2, u3, r2, h2);
          }
          function be2(e2, t3, r2) {
            return r2 || (pe2(e2, be2, 0), pe2(t3, be2, 1)), new ge2(e2.lat, e2.lng, t3.lat, t3.lng);
          }
          function Te2(e2, t3, r2, i3, n2, o2) {
            Q(this, Te2), this.sa = e2 || 10, this.c = this.b = null, this.j = i3 || 0, this.l = n2 || 0, this.m = t3 || 1, this.u = r2 || 1, this.I = !!o2, this.flush();
          }
          function Ae2(e2, t3, r2) {
            var i3, n2;
            if (e2.I && (i3 = e2.c))
              for (n2 = 3; 0 <= n2; n2--) {
                var o2 = t3[n2];
                if (n2 % 3 ? o2 >= i3[n2] : o2 <= i3[n2]) {
                  if (!r2) {
                    e2.c = null;
                    break;
                  }
                  i3[n2] = o2;
                }
              }
          }
          function Ee2(e2, t3) {
            var r2, i3 = e2.a;
            if (t3) {
              var n2 = t3;
              if (n2 !== i3)
                for (i3 = n2; n2 = n2.c; )
                  (n2.entries || 1 < n2.a) && (i3 = n2);
            } else
              for (; !i3.entries && (r2 = i3.a) < 2 && r2; )
                i3 = n2;
            e2.a = i3;
          }
          h(ue2, Error), l("H.lang.InvalidArgumentError", ue2), ue2.prototype.name = "InvalidArgumentError", l("H.geo.isDBC", function(e2, t3) {
            return 0 != (e2 < 0 ^ t3 < 0) && 180 < y(t3 - e2);
          }), l("H.geo.AbstractGeometry", de2), de2.prototype.getBoundingBox = de2.prototype.D, de2.prototype.equals = de2.prototype.w, de2.prototype.a = "", de2.prototype.l = "", de2.prototype.toString = function() {
            return this.I([this.a.toUpperCase(), " "]).join("");
          }, de2.prototype.toGeoJSON = de2.prototype.va = function() {
            return { type: this.l, coordinates: this.u() };
          }, de2.prototype.forWorkerMessage = de2.prototype.U = function() {
            return { type: this.a, coordinates: this.j(), boundingBox: this.D().U() };
          }, h(_e, de2), l("H.geo.Point", _e), _e.prototype.equals = _e.prototype.w = function(e2) {
            return this === e2 || !!e2 && this.lat === e2.lat && this.lng === e2.lng && (this.alt || 0) === (e2.alt || 0);
          }, _e.prototype.distance = _e.prototype.R = function(e2) {
            var t3, r2;
            return e2 = this === e2 || this.lat === e2.lat && this.lng === e2.lng ? 0 : (t3 = this.lat * O2, r2 = e2.lat * O2, 1274200158e-2 * A2(d(1, x2(b2(T2((t3 - r2) / 2), 2) + E2(t3) * E2(r2) * b2(T2((this.lng * O2 - e2.lng * O2) / 2), 2)))));
          }, _e.prototype.walk = _e.prototype.wa = function(e2, t3, r2) {
            var i3, n2, o2, a3, s2, l2, u3;
            return r2 ? ((t3 /= 637100079e-2) && (e2 *= O2, s2 = O2 * this.lat, i3 = T2(s2), n2 = T2(t3), o2 = E2(t3), a3 = O2 * this.lng, l2 = E2(s2), s2 = A2(l2 * E2(e2) * n2 + i3 * o2), l2 = (e2 = (a3 + (e2 = S2(T2(e2) * l2 * n2, o2 - i3 * T2(s2))) + k) % (2 * k) - k) * C2), t3 ? new _e(s2 * C2, (l2 + 540) % 360 - 180) : this) : 0 == ((e2 = (e2 % 360 + 360) % 360) + 90) % 180 ? (s2 = this.lng + t3 / (637100079e-2 * M2 * E2(this.lat * O2)) * (270 === e2 ? -360 : 360), new _e(this.lat, (s2 + 540) % 360 - 180)) : ((t3 /= 637100079e-2) && (e2 *= O2, a3 = this.lat * O2, i3 = this.lng * O2, o2 = (n2 = a3 + t3 * E2(e2)) - a3, s2 = v(w(n2 / 2 + R2) / w(a3 / 2 + R2)), s2 = ee2(o2 / s2) ? E2(a3) : o2 / s2, u3 = t3 * T2(e2) / s2, y(n2) > P2 && (n2 = 0 < n2 ? k - n2 : -(k + n2))), t3 ? new _e(n2 * C2, ((i3 + u3 + L2 + (y(a3 + o2) > P2 ? k : 0)) % M2 - k) * C2) : this);
          }, _e.prototype.getBoundingBox = _e.prototype.D = function() {
            return new ge2(this.lat, this.lng, this.lat, this.lng);
          }, _e.validate = pe2, _e.fromIPoint = function e2(t3) {
            if (!t3)
              throw new ue2(e2, 0, t3);
            return new _e(t3.lat, t3.lng, t3.alt);
          }, _e.prototype.a = "Point", _e.prototype.I = function(e2) {
            return e2.push("(", this.lng, " ", this.lat, ")"), e2;
          }, _e.prototype.l = "Point", _e.prototype.u = function() {
            return [this.lng, this.lat, this.alt || 0];
          }, _e.prototype.j = function() {
            return [this.lat, this.lng, this.alt || 0];
          }, h(ge2, de2), l("H.geo.Rect", ge2), ge2.prototype.a = "Polygon", ge2.prototype.I = function(e2) {
            var t3 = this.i, r2 = this.f, i3 = this.h, n2 = this.g;
            return e2.push("(", "(", r2, " ", t3, ",", n2, " ", t3, ",", n2, " ", i3, ",", r2, " ", i3, ",", r2, " ", t3, ")", ")"), e2;
          }, ge2.prototype.equals = ge2.prototype.w = function(e2) {
            return this === e2 || !!e2 && this.i === e2.i && this.f === e2.f && this.h === e2.h && this.g === e2.g;
          }, ge2.prototype.clone = function() {
            return new ge2(this.i, this.f, this.h, this.g);
          }, ge2.prototype.getTopLeft = ge2.prototype.W = function() {
            return this.m || (this.m = new _e(this.i, this.f)), this.m;
          }, ge2.prototype.getBottomRight = ge2.prototype.V = function() {
            return this.b || (this.b = new _e(this.h, this.g)), this.b;
          }, ge2.prototype.getTop = ge2.prototype.na = function() {
            return this.i;
          }, ge2.prototype.getBottom = ge2.prototype.ha = function() {
            return this.h;
          }, ge2.prototype.getLeft = ge2.prototype.ja = function() {
            return this.f;
          }, ge2.prototype.getRight = ge2.prototype.ma = function() {
            return this.g;
          }, ge2.prototype.getCenter = ge2.prototype.F = function() {
            return this.c || (this.c = new _e(this.h + (this.i - this.h) / 2, ve2(this.f, this.A()))), this.c;
          }, ge2.prototype.getWidth = ge2.prototype.A = function() {
            return ye2(this.f, this.g);
          }, ge2.prototype.getHeight = ge2.prototype.G = function() {
            return this.i - this.h;
          }, ge2.prototype.isCDB = ge2.prototype.N = function() {
            return this.f > this.g;
          }, ge2.prototype.isEmpty = ge2.prototype.ra = function() {
            return !this.A() && !this.G();
          }, ge2.prototype.getBoundingBox = ge2.prototype.D = function() {
            return new ge2(this.i, this.f, this.h, this.g);
          }, ge2.prototype.containsLatLng = ge2.prototype.L = function(e2, t3, r2) {
            var i3 = this.F();
            return r2 || (e2 = ce2(e2, this.L, 0), t3 = he2(t3, this.L, 1)), (e2 = (t3 = this.B(e2, t3, r2)).F()).lat === i3.lat && e2.lng === i3.lng && this.G() === t3.G() && this.A() === t3.A();
          }, ge2.prototype.containsPoint = ge2.prototype.$ = function(e2, t3) {
            return t3 || pe2(e2, this.$, 0), this.L(e2.lat, e2.lng, t3);
          }, ge2.prototype.containsRect = ge2.prototype.aa = function(e2, t3) {
            var r2 = this.F();
            if (!(t3 || e2 instanceof ge2))
              throw new ue2(this.aa, 0, e2);
            return (e2 = (t3 = this.J(e2, t3)).F()).lat === r2.lat && e2.lng === r2.lng && this.G() === t3.G() && this.A() === t3.A();
          }, ge2.prototype.mergeLatLng = ge2.prototype.B = function(e2, t3, r2, i3) {
            if (!r2) {
              if (ee2(e2 = ce2(e2)))
                throw new ue2(this.B, 0, e2);
              if (ee2(t3 = he2(t3)))
                throw new ue2(this.B, 1, t3);
            }
            return xe2(this.i, this.f, this.h, this.g, e2, t3, e2, t3, i3);
          }, ge2.prototype.mergePoint = ge2.prototype.ca = function(e2, t3, r2) {
            return t3 || pe2(e2, this.ca, 0), this.B(e2.lat, e2.lng, t3, r2);
          }, ge2.prototype.mergeRect = ge2.prototype.J = function(e2, t3, r2) {
            if (!(t3 || e2 instanceof ge2))
              throw new ue2(this.J, 0, e2);
            return xe2(this.i, this.f, this.h, this.g, e2.i, e2.f, e2.h, e2.g, r2);
          }, ge2.prototype.mergeTopLeftBottomRight = ge2.prototype.C = function(e2, t3, r2, i3, n2, o2) {
            return n2 || (e2 = ce2(e2, this.C, 0), t3 = he2(t3, this.C, 1), r2 = ce2(r2, this.C, 2), i3 = he2(i3, this.C, 3)), xe2(this.i, this.f, this.h, this.g, e2, t3, r2, i3, o2);
          }, ge2.prototype.intersects = ge2.prototype.ba = function(e2, t3) {
            var r2 = this.f <= this.g, i3 = e2.f <= e2.g, n2 = this.f < e2.g, o2 = e2.f < this.g;
            if (!(t3 || e2 instanceof ge2))
              throw new ue2(this.ba, 0, e2);
            return this.h <= e2.i && e2.h <= this.i && (!r2 && (!i3 || n2 || o2) || !i3 && (n2 || o2) || n2 && o2);
          }, ge2.merge = xe2, ge2.fromPoints = be2, ge2.coverPoints = function e2(t3, r2) {
            var i3 = 1, n2 = t3.length, o2 = null, a3 = s(t3);
            if ("array" != a3 && ("object" != a3 || "number" != typeof t3.length))
              throw new ue2(e2, 0, t3);
            if (0 < n2)
              for (o2 = be2(a3 = t3[0], a3, r2); i3 < n2; i3++)
                a3 = t3[i3], o2.B(a3.lat, a3.lng, r2, o2);
            return o2;
          }, ge2.coverLatLngAlts = function e2(t3, r2) {
            var i3, n2 = 3, o2 = t3.length;
            if (!(r2 || t3 && null != t3.length))
              throw new ue2(e2, 0, t3);
            if (0 < o2)
              for (i3 = new ge2(t3[0], t3[1], t3[0], t3[1]); n2 < o2; n2 += 3)
                i3.B(t3[n2], t3[n2 + 1], r2, i3);
            return i3;
          }, ge2.coverRects = function e2(t3, r2) {
            var i3, n2 = 1, o2 = t3.length;
            if (r2 && (!t3 || null == t3.length))
              throw new ue2(e2, 0, t3);
            if (0 < o2)
              for (i3 = new ge2(t3[0].i, t3[0].f, t3[0].h, t3[0].g); n2 < o2; n2++)
                i3.J(t3[n2], r2, i3);
            return i3;
          }, ge2.prototype.resizeToCenter = ge2.prototype.da = function(e2, t3) {
            var r2 = this.f, i3 = this.i, n2 = this.g, o2 = this.h, a3 = this.F().lng;
            pe2(e2, this.da, 0);
            var s2 = e2.lat - o2 - (i3 - o2) / 2, l2 = e2.lng - a3;
            return e2 = (e2 = r2 + ((l2 = 180 < l2 || l2 < -180 ? -(a3 + e2.lng) : l2) < 0 ? 2 * l2 : 0)) < -180 ? 360 + e2 : e2, n2 = 180 < (n2 += 0 < l2 ? 2 * l2 : 0) ? n2 - 360 : n2, 90 <= (i3 = 0 < s2 ? i3 + 2 * s2 : i3) && (i3 = 90), (o2 = s2 < 0 ? o2 + 2 * s2 : o2) <= -90 && (o2 = -90), t3 ? me2(t3, i3, e2, o2, n2) : new ge2(i3, e2, o2, n2);
          }, ge2.prototype.l = "Polygon", ge2.prototype.u = function() {
            return [[this.f, this.i, 0], [this.g, this.i, 0], [this.g, this.h, 0], [this.f, this.h, 0], [this.f, this.i, 0]];
          }, ge2.prototype.U = function() {
            return this.j();
          }, ge2.prototype.j = function() {
            return [this.i, this.f, this.h, this.g];
          }, Te2.prototype.remove = function(e2) {
            var t3, r2, i3, n2, o2, a3, s2 = false;
            if (e2 && (t3 = e2.a) && t3.b === this && (r2 = t3.entries) && 0 <= (i3 = r2.indexOf(e2))) {
              for (r2.splice(i3, 1), r2 = this.a; t3; ) {
                (n2 = t3.entries) && n2.length || (n2 && delete t3.entries, t3.a || !(o2 = t3.c)) ? t3 = K2 : ((i3 = o2)[a3 = (s2 = t3).j] === s2 && (delete i3[a3], delete s2.c, --i3.a), r2 === t3 && (r2 = o2), t3 = o2);
              }
              this.a !== r2 && (this.a = r2, Ee2(this)), Ae2(this, e2, false), s2 = true;
            }
            return s2;
          }, Te2.prototype.flush = function() {
            var e2 = new Se2(null, NaN, this.j - this.m, this.l - this.u, this.j + this.m, this.l + this.u);
            (e2.b = this).a = this.b = e2, this.c = null;
          }, Te2.prototype.o = function(e2, t3, r2, i3, n2, o2) {
            var a3 = [], s2 = this.a, l2 = this.b;
            return e2 <= s2[5] && t3 <= s2[6] && (n2 ? r2 >= s2[7] : r2 > s2[7]) && (o2 ? i3 >= s2[4] : i3 > s2[4]) && function e3(t4, r3, i4, n3, o3, a4, s3, l3, u3) {
              var c3, h2 = r3.entries, f3 = r3[7], d2 = r3[4], _2 = r3[5], p3 = r3[6], g2 = r3[8], m2 = r3[9];
              if (h2) {
                var y2 = h2.length;
                if (d2 < o3 || f3 < n3 || s3 < p3 || a4 < _2)
                  for (; y2--; ) {
                    f3 = h2[y2], d2 = f3[3], _2 = f3[0], p3 = f3[1];
                    var v2 = f3[2];
                    o3 <= v2 && n3 <= p3 && (_2 < s3 || l3 && _2 == s3) && (d2 < a4 || u3 && d2 == a4) && i4.push(f3);
                  }
                else
                  for (; y2--; )
                    i4.push(h2[y2]);
              }
              (g2 < a4 || u3 && a4 == g2) && (o3 < m2 && (c3 = r3[1]) && e3(t4, c3, i4, n3, o3, a4, s3, l3, u3), (m2 < s3 || l3 && s3 == m2) && (c3 = r3[3]) && e3(t4, c3, i4, n3, o3, a4, s3, l3, u3));
              n3 < g2 && (o3 < m2 && (c3 = r3[0]) && e3(t4, c3, i4, n3, o3, a4, s3, l3, u3), (m2 < s3 || l3 && s3 == m2) && (c3 = r3[2]) && e3(t4, c3, i4, n3, o3, a4, s3, l3, u3));
            }(this, s2, a3, e2, t3, r2, i3, o2 || i3 >= l2[6], n2 || r2 >= l2[5]), a3;
          };
          var we2 = 0;
          function Se2(e2, t3, r2, i3, n2, o2) {
            this.j = t3, e2 && (this.c = e2, this.b = e2.b, n2 = 1 & t3 ? (r2 = e2[8], e2[5]) : (r2 = e2[7], e2[8]), o2 = 2 & t3 ? (i3 = e2[9], e2[6]) : (i3 = e2[4], e2[9])), this[7] = r2, this[5] = n2, this[8] = (r2 + n2) / 2, this[4] = i3, this[6] = o2, this[9] = (i3 + o2) / 2;
          }
          function ke2(e2, t3, r2, i3, n2, o2) {
            ke2.ua.constructor.apply(this, arguments);
          }
          function Pe2(e2, t3, r2, i3, n2, o2, a3) {
            var s2, l2, u3 = t3[8], c3 = t3[9];
            return a3 && (n2 < u3 || (s2 = u3 <= r2)) && (o2 < c3 || (l2 = c3 <= i3)) ? r2 = (u3 = Pe2)(e2, t3 = t3[s2 |= l2 << 1] || (++t3.a, t3[s2] = new Se2(t3, s2)), r2, i3, n2, o2, a3 - 1) : (i3 = r2 = new Re2(r2, i3, n2, o2), (t3.entries || (t3.entries = [])).push(i3), i3.a = t3, Ae2(e2, r2, true), Ee2(e2, t3)), r2;
          }
          function Re2(e2, t3, r2, i3) {
            this.id = we2++, this[0] = t3, this[1] = r2, this[2] = i3, this[3] = e2;
          }
          function Me2(e2) {
            this.l = new ke2(+e2 || 10, 180, 90, 0, 0, true), this.j = [], this.m = false, this.a = this.b = this.c = null;
          }
          function Le2(e2, t3, r2, i3, n2, o2) {
            if (o2)
              o2 = new Re2(n2, -t3, r2 + 360, -i3), e2.j.push(o2), e2.m = true, e2.a && e2.a.C(t3, r2, i3, n2, true, e2.a);
            else {
              var a3 = -t3, s2 = -i3, l2 = (o2 = e2.l).b, u3 = l2[5], c3 = l2[6];
              if (!(l2[7] <= r2 && l2[4] <= a3 && (n2 < u3 || u3 === n2 && u3 === l2.b.b[5]) && (s2 < c3 || c3 === s2 && c3 === l2.b.b[6])))
                throw Error("Coordinates out of bounds");
              o2 = Pe2(o2, o2.b, r2, a3, n2, s2, o2.sa), e2.b && e2.b.C(t3, r2, i3, n2, true, e2.b);
            }
            return e2.c = null, o2;
          }
          function Oe2(e2, t3, r2, i3, n2, o2, a3) {
            var s2 = (e2 = e2.j).length, l2 = [];
            if (s2)
              for (var u3 = r2 + 360, c3 = n2 + 360; s2--; ) {
                var h2 = e2[s2];
                (Ce2(h2, t3, r2, i3, n2, o2, a3) || Ce2(h2, t3, u3, i3, c3, o2, a3)) && l2.push(h2);
              }
            return l2;
          }
          function Ce2(e2, t3, r2, i3, n2, o2, a3) {
            var s2 = e2[3], l2 = e2[0], u3 = e2[1];
            return e2 = e2[2], (o2 ? l2 <= i3 : l2 < i3) && (a3 ? s2 <= n2 : s2 < n2) && t3 <= e2 && r2 <= u3;
          }
          function Ne2(e2, t3) {
            var r2, i3;
            if (r2 = t3.length) {
              for (var n2 = e2.length, o2 = {}; n2--; )
                o2[e2[n2].id] = 1;
              for (; r2--; )
                (i3 = t3[r2]).id in o2 || e2.push(i3);
            }
          }
          function Ie2() {
          }
          function Be2(e2, t3, r2) {
            if (this.l = [], t3 && this.K(t3), r2 && !u2(r2))
              throw new ue2(Be2, 2, r2);
            this.b = 0, this.m = r2, this.a = {}, this.j = this.c = null, this.Z(e2);
          }
          function ze2(e2, t3) {
            return t3 && (e2.c = Fe2(e2, t3, e2.c)), t3;
          }
          function Ue2(e2) {
            for (; e2.b > e2.u && e2.j; )
              Ge2(e2, e2.j, true);
          }
          function Fe2(e2, t3, r2) {
            return r2 !== t3 && ((t3.H || t3.v) && Ge2(e2, t3, false), (t3.H = r2) && (t3.v = r2.v, r2.v = t3), t3.v || (e2.c = t3), t3.H || (e2.j = t3), e2.b += t3.size), t3;
          }
          function Ge2(e2, t3, r2) {
            var i3 = t3.v, n2 = t3.H;
            (i3 || n2 || t3 == e2.c && t3 == e2.j) && (i3 ? i3.H = n2 : e2.c = n2, n2 ? n2.v = i3 : e2.j = i3, e2.b -= t3.size, r2 && (delete e2.a[t3.id], De2(e2, t3))), t3.H = t3.v = null;
          }
          function De2(e2, t3) {
            for (var r2 = e2.l.length; r2--; )
              e2.l[r2].call(e2, t3.id, t3.data, t3.size);
          }
          Se2.prototype.a = 0, h(ke2, Te2), l("H.geo.QuadTree", Me2), Me2.prototype.N = function() {
            return this.m;
          }, Me2.prototype.D = function() {
            var e2;
            if (!this.c) {
              var t3, r2, i3 = [];
              if ((a3 = !this.b) && (s2 = (o2 = this.l).c, o2.I && !s2 && ((a3 = o2.a).entries || a3[0] || a3[1] || a3[2] || a3[3]) && (s2 = function e3(t4, r3) {
                for (var i4, n3, o3 = 0, a4 = 3; 0 <= a4; a4--) {
                  for (var s3 = a4 + 4, l3 = 0 < a4 % 3, u3 = [], c3 = r3[a4], h2 = t4[a4], f3 = h2.length; f3--; ) {
                    var d2 = h2[f3];
                    if (i4 = d2.entries)
                      for (n3 = i4.length; n3--; ) {
                        var _2 = i4[n3][a4];
                        (l3 ? c3 < _2 : _2 < c3) && (c3 = _2);
                      }
                    for (n3 = 4; n3--; )
                      (i4 = d2[n3]) && (l3 ? i4[s3] > c3 : i4[s3] < c3) && u3.push(i4);
                  }
                  o3 += u3.length, r3[a4] = c3, t4[a4] = u3;
                }
                return o3 && (r3 = e3(t4, r3)), r3;
              }([s2 = [a3], s2, s2, s2], [a3[6], a3[7], a3[4], a3[5]]), o2.c = s2), a3 = o2 = s2), a3 && (this.b = new ge2(-o2[0], o2[3], -o2[2], o2[1])), (e2 = this.b) && i3.push(e2), !this.a && (r2 = (t3 = this.j).length)) {
                for (a3 = 360, s2 = -(o2 = 90), l2 = 0; r2--; )
                  var n2 = t3[r2], o2 = d(o2, n2[0]), a3 = d(a3, n2[3]), s2 = _(s2, n2[2]), l2 = _(l2, n2[1]);
                this.a = new ge2(-o2, a3, -s2, l2 - 360);
              }
              (e2 = this.a) && i3.push(e2), (e2 = i3[0]) && (i3[1] && (e2 = e2.J(i3[1], true)), this.c = e2);
            }
            return this.c;
          }, Me2.prototype.insertBoundingBox = Me2.prototype.oa = function(e2) {
            var t3 = e2.W(), r2 = e2.V();
            return (e2 = e2.N()) ? Le2(this, t3.lat, r2.lng, r2.lat, t3.lng, e2) : Le2(this, t3.lat, t3.lng, r2.lat, r2.lng, e2);
          }, Me2.prototype.remove = function(e2) {
            var t3, r2;
            return e2.a ? (r2 = this.l.remove(e2), this.b = null) : (r2 = 0 <= (e2 = (t3 = this.j).indexOf(e2))) && (t3.splice(e2, 1), this.m = 0 < t3.length, this.a = null), r2 && (this.c = null), r2;
          }, Me2.prototype.intersectBoundingBox = Me2.prototype.pa = function(e2, t3, r2) {
            var i3 = this.l, n2 = e2.W(), o2 = e2.V(), a3 = -n2.lat, n2 = n2.lng, s2 = -o2.lat, o2 = o2.lng;
            return !t3 && a3 == s2 || !r2 && n2 === o2 ? e2 = [] : e2.N() ? (Ne2(e2 = i3.o(-180, a3, o2, s2, r2, t3), i3.o(n2, a3, 180, s2, false, t3)), Ne2(e2, Oe2(this, a3, o2, s2, n2 + 360, t3, r2))) : Ne2(e2 = i3.o(n2, a3, o2, s2, r2, t3), Oe2(this, a3, n2, s2, o2, t3, r2)), e2;
          }, l("H.util.ICache", Ie2), Ie2.prototype.add = function() {
          }, Ie2.prototype.get = function() {
          }, Ie2.prototype.drop = Ie2.prototype.S = function() {
          }, Ie2.prototype.forEach = function() {
          }, Ie2.prototype.removeAll = Ie2.prototype.Y = function() {
          }, Ie2.prototype.registerOnDrop = Ie2.prototype.K = function() {
          }, Ie2.prototype.deRegisterOnDrop = Ie2.prototype.P = function() {
          }, l("H.util.Cache", Be2), Be2.prototype.add = function(e2, t3, r2) {
            var i3, n2;
            if (!te2(r2 = +r2) || r2 < 0)
              throw new ue2(this.add, 2, r2);
            return e2 = String(e2), (n2 = !this.m || this.m(e2, t3, r2)) && ((i3 = this.a[e2]) ? (i3.data !== t3 && De2(this, i3), this.b += r2 - i3.size, i3.size = r2, i3.data = t3, ze2(this, i3)) : this.a[e2] = Fe2(this, { id: e2, data: t3, size: r2, H: null, v: null }, this.c), Ue2(this)), n2;
          }, Be2.prototype.registerOnDrop = Be2.prototype.K = function(e2) {
            if (!u2(e2))
              throw new ue2(this.K, 0, e2);
            this.l.push(e2);
          }, Be2.prototype.deRegisterOnDrop = Be2.prototype.P = function(t3) {
            this.l = this.l.filter(function(e2) {
              return e2 !== t3;
            });
          }, Be2.prototype.get = function(e2, t3) {
            return (e2 = t3 ? this.a[e2] : ze2(this, this.a[e2])) && e2.data;
          }, Be2.prototype.drop = Be2.prototype.S = function(e2) {
            var t3;
            (t3 = this.a[e2]) && Ge2(this, t3, true);
          }, Be2.prototype.forEach = function(e2, t3, r2) {
            var i3;
            for (i3 in this.a) {
              var n2 = this.a[i3];
              r2 && !r2(i3, n2.data, n2.size) || e2.call(t3, i3, n2.data, n2.size);
            }
          }, Be2.prototype.removeAll = Be2.prototype.Y = function(e2) {
            var t3;
            for (t3 in this.a) {
              var r2 = this.a[t3];
              e2 && !e2(t3, r2.data, r2.size) || Ge2(this, this.a[t3], true);
            }
          }, Be2.prototype.setMaxSize = Be2.prototype.Z = function(e2) {
            if (!(0 < +e2))
              throw new ue2(Be2.prototype.Z, 0, e2);
            return this.u = +e2, Ue2(this), this;
          }, Be2.prototype.getMaxSize = Be2.prototype.ka = function() {
            return this.u;
          }, Be2.prototype.getCurrentSize = Be2.prototype.ia = function() {
            return this.b;
          };
        }).call(ns);
        var MathUtils$1 = MathUtils = {}, Geo;
        function _xyToArr(e) {
          return [e.x, e.y];
        }
        function _arrToXy(e) {
          return _construct(ns.H.math.Point, _toConsumableArray(e));
        }
        MathUtils.clipPolygon = function(e, t2) {
          var r, i2, n = [], o = ns.H.math.clipping.clipPolygon(e.map(_arrToXy), t2.map(_arrToXy));
          if (o)
            do {
              for (r = [], i2 = o; r.push(_xyToArr(i2)), i2 = i2.next; )
                ;
              n.push(r);
            } while (o = o.nextPoly);
          else
            MathUtils.isPointInsidePolygon(t2[0], e) ? n.push(t2) : MathUtils.isPointInsidePolygon(e[0], t2) && n.push(e);
          return n;
        }, MathUtils.isPointInsidePolygon = function(e, t2) {
          return ns.H.math.isPointInsidePolygon({ x: e[0], y: e[1] }, ns.H.math.flatten(t2));
        }, MathUtils.clamp = function(e, t2, r) {
          return (e -= 0) > r ? r : e < t2 ? t2 : e;
        }, MathUtils.splitLegs = function(e, t2) {
          var r = [];
          e.push(e[0]);
          for (var i2 = 0; i2 < e.length - 1; i2++) {
            var n, o = e[i2], a2 = e[i2 + 1];
            r.push(o), Math.abs(a2[0] - o[0]) >= t2 && (n = [(o[0] + a2[0]) / 2, (o[1] + a2[1]) / 2], r.push(n));
          }
          return r.length !== e.length - 1 ? MathUtils.splitLegs(r, t2) : r;
        }, MathUtils.getBBox = function(e) {
          var t2 = 1 / 0, r = 1 / 0, i2 = -1 / 0, n = -1 / 0;
          return e.forEach(function(e2) {
            e2[0] < t2 && (t2 = e2[0]), e2[1] < r && (r = e2[1]), e2[0] > i2 && (i2 = e2[0]), e2[1] > n && (n = e2[1]);
          }), [t2, r, i2, n];
        }, MathUtils.getBBoxCenter = function(e) {
          var t2 = _slicedToArray(e, 4), r = t2[0], i2 = t2[1];
          return [r + (t2[2] - r) / 2, i2 + (t2[3] - i2) / 2];
        }, MathUtils.getLineLength = function(e, t2, r, i2) {
          return Math.sqrt(Math.pow(e - r, 2) + Math.pow(t2 - i2, 2));
        }, MathUtils.modulo = function(e, t2) {
          var r;
          return (r = e % t2) < 0 == t2 < 0 ? r : r + t2;
        };
        var Geo$1 = Geo = {};
        Geo.default_source_max_zoom = 18, Geo.default_view_max_zoom = 20, Geo.tile_size = 256, Geo.half_circumference_meters = 20037508342789244e-9, Geo.circumference_meters = 2 * Geo.half_circumference_meters, Geo.min_zoom_meters_per_pixel = Geo.circumference_meters / Geo.tile_size;
        var meters_per_pixel = [];
        Geo.metersPerPixel = function(e) {
          return meters_per_pixel[e] = meters_per_pixel[e] || Geo.min_zoom_meters_per_pixel / Math.pow(2, e), meters_per_pixel[e];
        };
        var meters_per_tile = [];
        Geo.metersPerTile = function(e) {
          return meters_per_tile[e] = meters_per_tile[e] || Geo.circumference_meters / Math.pow(2, e), meters_per_tile[e];
        }, Geo.tile_scale = 4096, Geo.units_per_pixel = Geo.tile_scale / Geo.tile_size, Geo.height_scale = 16;
        var units_per_meter = [];
        Geo.unitsPerMeter = function(e) {
          return units_per_meter[e] = units_per_meter[e] || Geo.tile_scale / (Geo.tile_size * Geo.metersPerPixel(e)), units_per_meter[e];
        }, Geo.metersForTile = function(e) {
          return { x: e.x * Geo.circumference_meters / Math.pow(2, e.z) - Geo.half_circumference_meters, y: -(e.y * Geo.circumference_meters / Math.pow(2, e.z) - Geo.half_circumference_meters) };
        }, Geo.tileForMeters = function(e, t2) {
          var r = _slicedToArray(e, 2), i2 = r[0], n = r[1];
          return { x: Math.floor((i2 + Geo.half_circumference_meters) / (Geo.circumference_meters / Math.pow(2, t2))), y: Math.floor((-n + Geo.half_circumference_meters) / (Geo.circumference_meters / Math.pow(2, t2))), z: t2 };
        }, Geo.metersToExactTileCoords = function(e, t2) {
          var r = _slicedToArray(e, 2), i2 = r[0], n = r[1];
          return { x: Math.pow(2, t2 - 1) * (1 + i2 / Geo.half_circumference_meters), y: Math.pow(2, t2 - 1) * (1 - n / Geo.half_circumference_meters), z: t2 };
        }, Geo.wrapTile = function(e) {
          var t2 = e.x, r = e.y, i2 = e.z, n = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : { x: true, y: false }, o = (1 << i2) - 1;
          return n.x && (t2 &= o), n.y && (r &= o), { x: t2, y: r, z: i2 };
        }, Geo.wrapMeters = function(e) {
          var t2 = e.x, r = e.y;
          return { x: MathUtils$1.modulo(t2 + Geo.half_circumference_meters, Geo.circumference_meters) - Geo.half_circumference_meters, y: r };
        }, Geo.metersToLatLng = function(e) {
          var t2 = _slicedToArray(e, 2), r = t2[0], i2 = t2[1];
          return r /= Geo.half_circumference_meters, i2 /= Geo.half_circumference_meters, i2 = (2 * Math.atan(Math.exp(i2 * Math.PI)) - Math.PI / 2) / Math.PI, [r *= 180, i2 *= 180];
        }, Geo.latLngToMeters = function(e) {
          var t2 = _slicedToArray(e, 2), r = t2[0], i2 = t2[1], i2 = Math.log(Math.tan(i2 * Math.PI / 360 + Math.PI / 4)) / Math.PI;
          return i2 *= Geo.half_circumference_meters, i2 = Math.min(Math.max(i2, -Geo.half_circumference_meters), Geo.half_circumference_meters), [r *= Geo.half_circumference_meters / 180, i2];
        }, Geo.tileSpaceToMeters = function(e, t2, r) {
          var i2 = _slicedToArray(e, 2), n = i2[0], o = i2[1], a2 = Geo.unitsPerMeter(t2);
          return [n / a2 + r.x, o / a2 + r.y];
        }, Geo.tileSpaceToLatlng = function(e, t2, n) {
          var o = Geo.unitsPerMeter(t2);
          return Geo.transformGeometry(e, function(e2) {
            e2[0] = e2[0] / o + n.x, e2[1] = e2[1] / o + n.y;
            var t3 = _slicedToArray(Geo.metersToLatLng(e2), 2), r = t3[0], i2 = t3[1];
            e2[0] = r, e2[1] = i2;
          }), e;
        }, Geo.copyGeometry = function(e) {
          if (null != e) {
            var t2 = { type: e.type };
            return "Point" === e.type ? t2.coordinates = [e.coordinates[0], e.coordinates[1]] : "LineString" === e.type || "MultiPoint" === e.type ? t2.coordinates = e.coordinates.map(function(e2) {
              return [e2[0], e2[1]];
            }) : "Polygon" === e.type || "MultiLineString" === e.type ? t2.coordinates = e.coordinates.map(function(e2) {
              return e2.map(function(e3) {
                return [e3[0], e3[1]];
              });
            }) : "MultiPolygon" === e.type && (t2.coordinates = e.coordinates.map(function(e2) {
              return e2.map(function(e3) {
                return e3.map(function(e4) {
                  return [e4[0], e4[1]];
                });
              });
            })), t2;
          }
        }, Geo.transformGeometry = function(e, t2) {
          null != e && ("Point" === e.type ? t2(e.coordinates) : "LineString" === e.type || "MultiPoint" === e.type ? e.coordinates.forEach(t2) : "Polygon" === e.type || "MultiLineString" === e.type ? e.coordinates.forEach(function(e2) {
            return e2.forEach(t2);
          }) : "MultiPolygon" === e.type && e.coordinates.forEach(function(e2) {
            e2.forEach(function(e3) {
              return e3.forEach(t2);
            });
          }));
        }, Geo.boxIntersect = function(e, t2) {
          return !(t2.sw.x > e.ne.x || t2.ne.x < e.sw.x || t2.sw.y > e.ne.y || t2.ne.y < e.sw.y);
        }, Geo.findBoundingBox = function(e) {
          for (var t2 = 1 / 0, r = -1 / 0, i2 = 1 / 0, n = -1 / 0, o = e[0].length, a2 = 0; a2 < o; a2++) {
            var s = e[0][a2];
            s[0] < t2 && (t2 = s[0]), s[1] < i2 && (i2 = s[1]), s[0] > r && (r = s[0]), s[1] > n && (n = s[1]);
          }
          return [t2, i2, r, n];
        }, Geo.geometryType = function(e) {
          return "Polygon" === e || "MultiPolygon" === e ? "polygon" : "LineString" === e || "MultiLineString" === e ? "line" : "Point" === e || "MultiPoint" === e ? "point" : void 0;
        }, Geo.centroid = function(e) {
          var t2 = !(1 < arguments.length && void 0 !== arguments[1]) || arguments[1];
          if (e && 0 !== e.length) {
            var r, i2 = 0, n = 0, o = 0, a2 = e[0], s = a2.length;
            t2 && (r = a2[0], a2 = a2.map(function(e2) {
              return [e2[0] - r[0], e2[1] - r[1]];
            }));
            for (var l = 0, u2 = s - 1; l < s; u2 = l, l++) {
              var c2 = a2[l], h = a2[u2], f2 = c2[1] * h[0] - h[1] * c2[0];
              i2 += (c2[0] + h[0]) * f2, n += (c2[1] + h[1]) * f2, o += 3 * f2;
            }
            var d = [i2 / o, n / o];
            return t2 && (d[0] += r[0], d[1] += r[1]), d;
          }
        }, Geo.multiCentroid = function(e) {
          for (var t2 = e.length, r = [0, 0], i2 = 0; i2 < e.length; i2++) {
            var n = Geo.centroid(e[i2]);
            r[0] += n[0], r[1] += n[1];
          }
          return r[0] /= t2, r[1] /= t2, r;
        }, Geo.signedPolygonRingAreaSum = function(e) {
          for (var t2 = 0, r = e.length, i2 = 0; i2 < r - 1; i2++) {
            var n = e[i2], o = e[i2 + 1];
            t2 += n[0] * o[1] - o[0] * n[1];
          }
          return t2 += e[r - 1][0] * e[0][1] - e[0][0] * e[r - 1][1];
        }, Geo.polygonRingArea = function(e) {
          return Math.abs(Geo.signedPolygonRingAreaSum(e)) / 2;
        }, Geo.polygonArea = function(e) {
          if (e)
            return Geo.polygonRingArea(e[0]);
        }, Geo.multiPolygonArea = function(e) {
          for (var t2 = 0, r = 0; r < e.length; r++)
            t2 += Geo.polygonArea(e[r]);
          return t2;
        }, Geo.ringWinding = function(e) {
          var t2 = Geo.signedPolygonRingAreaSum(e);
          return 0 < t2 ? "CW" : t2 < 0 ? "CCW" : void 0;
        }, Geo.getTileBoundingBox = function(e, t2) {
          var r = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : 0, i2 = Geo.wrapTile(e, { x: true }), n = Geo.metersForTile(i2), o = Geo.metersPerPixel(i2.z), a2 = Geo.metersToLatLng([n.x - r * o, n.y + r * o]), s = Geo.metersToLatLng([n.x + (t2 + r) * o, n.y - (t2 + r) * o]), l = Geo.isLastTile(i2);
          return new ns.H.geo.Rect(0 === e.y ? 90 : MathUtils$1.clamp(a2[1], -90, 90), MathUtils$1.clamp(a2[0], -180, 180), l.row ? -90 : MathUtils$1.clamp(s[1], -90, 90), l.column ? 180 : MathUtils$1.clamp(s[0], -180, 180));
        }, Geo.isLastTile = function(e) {
          var t2 = e.x, r = e.y, i2 = e.z;
          return { row: r === Math.pow(2, i2) - 1, column: t2 === Math.pow(2, i2) - 1 };
        };
        var MethodNotImplemented = function() {
          _inherits(i2, _wrapNativeSuper(Error));
          var r = _createSuper(i2);
          function i2(e) {
            var t2;
            return _classCallCheck(this, i2), (t2 = r.call(this)).name = "MethodNotImplemented", t2.message = "Method " + e + " must be implemented in subclass", t2;
          }
          return i2;
        }(), is_worker = false, is_main = false, force_main, force_worker;
        try {
          window.document !== HTMLDocument && (is_main = true);
        } catch (e) {
          void 0 !== self && (is_worker = true, self.window = { document: {} }, self.document = self.window.document);
        }
        var Thread = { get is_fake_worker() {
          return self.is_fake_worker;
        }, get is_worker() {
          return void 0 !== force_worker ? force_worker : is_worker || self.is_fake_worker;
        }, set is_worker(e) {
          force_worker = e;
        }, get is_main() {
          return void 0 !== force_main ? force_main : is_main && !self.is_fake_worker;
        }, set is_main(e) {
          force_main = e;
        }, is_native_worker: is_worker }, WorkerBroker = {}, message_id = 0, messages = {}, targets = {}, main_worker_targets = {};
        function findTarget(e, t2) {
          var r = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : targets, i2 = [];
          if ("string" == typeof e && (e = (i2 = e.split(".")).pop()), Thread.is_main && t2 && 1 === i2.length && "self" === i2[0])
            r = t2;
          else
            for (var n = 0; n < i2.length; n++) {
              if (!r[i2[n]])
                return [];
              r = r[i2[n]];
            }
          return [e, r];
        }
        WorkerBroker.addTarget = function(e, t2) {
          Thread.is_fake_worker ? main_worker_targets[e] = t2 : targets[e] = t2;
        }, WorkerBroker.removeTarget = function(e) {
          delete targets[e], delete main_worker_targets[e];
        };
        var ERROR_NO_TARGET = " No object with that name is registered on main thread.", ERROR_NO_METHOD = " Object has no method with that name.", ERROR_NOT_SET = "_worker_broker_error_not_set_";
        function setupMainThread() {
          WorkerBroker.postMessage = function(e, r) {
            for (var t2 = arguments.length, i2 = new Array(2 < t2 ? t2 - 2 : 0), n = 2; n < t2; n++)
              i2[n - 2] = arguments[n];
            if (Array.isArray(e))
              return Promise.all(e.map(function(e2) {
                return WorkerBroker.postMessage.apply(WorkerBroker, [e2, r].concat(_toConsumableArray(i2)));
              }));
            var o, a2 = {};
            "object" === _typeof(r) && (r = (a2 = r).method);
            var s = "main_send";
            "string" == typeof e ? (r = e, i2 = Array.prototype.slice.call(arguments, 1), o = true, s = "worker_send") : e.init && (o = true);
            var l, u2 = [];
            if (i2 && 1 === i2.length && i2[0] instanceof WorkerBroker.withTransferables && (u2 = i2[0].transferables, i2 = i2[0].value), l = { type: s, message_id: ++message_id, method: r, message: i2 }, o)
              return function(i3, e2) {
                var t3 = i3.type, r2 = _slicedToArray(findTarget(i3.method, e2, "main_send" === t3 ? main_worker_targets : targets), 2), n2 = r2[0], o2 = r2[1], a3 = "Worker broker could not dispatch message type ".concat(i3.method, " on target ").concat(i3.target, ".");
                if (!o2)
                  throw Error(a3 + ERROR_NO_TARGET);
                var s2 = "function" == typeof o2[n2] && o2[n2];
                if (!s2)
                  throw Error(a3 + ERROR_NO_METHOD);
                return new Promise(function(t4, r3) {
                  var e3;
                  try {
                    e3 = s2.apply(o2, i3.message);
                  } catch (e4) {
                    return void r3(e4);
                  }
                  e3 instanceof Promise ? e3.then(function(e4) {
                    e4 instanceof WorkerBroker.withTransferables && (e4 = e4.value[0]), t4(e4);
                  }, function(e4) {
                    r3(e4 instanceof Error ? "".concat(e4.message, ": ").concat(e4.stack) : e4);
                  }) : (e3 instanceof WorkerBroker.withTransferables && (e3 = e3.value[0]), t4(e3));
                });
              }(l, e && e.init ? e : void 0);
            var c2 = new Promise(function(e2, t3) {
              messages[message_id] = { method: r, message: i2, resolve: e2, reject: t3 };
            });
            return a2.stringify && (l = JSON.stringify(l)), e.postMessage(l, u2.map(function(e2) {
              return e2.object;
            })), freeTransferables(u2), c2;
          }, WorkerBroker.addWorker = function(f2) {
            if (!(f2 instanceof Worker))
              throw Error("Worker broker could not add non-Worker object", f2);
            f2.addEventListener("message", function(e) {
              var t2 = "string" == typeof e.data ? JSON.parse(e.data) : e.data, r = t2.message_id;
              if ("worker_reply" === t2.type)
                messages[r] && (t2.error ? messages[r].reject(t2.error) : messages[r].resolve(t2.message), delete messages[r]);
              else if ("worker_send" === t2.type && null != r) {
                var i2 = _slicedToArray(findTarget(t2.method), 2), n = i2[0], o = i2[1], a2 = "Worker broker could not dispatch message type ".concat(t2.method, " on target ").concat(t2.target, ".");
                if (!o)
                  throw Error(a2 + ERROR_NO_TARGET);
                var s = "function" == typeof o[n] && o[n];
                if (!s)
                  throw Error(a2 + ERROR_NO_METHOD);
                var l, u2 = ERROR_NOT_SET;
                try {
                  l = s.apply(o, t2.message);
                } catch (e2) {
                  u2 = e2;
                }
                var c2, h = [];
                l && "function" == typeof l.then ? l.then(function(e2) {
                  e2 instanceof WorkerBroker.withTransferables && (h = e2.transferables, e2 = e2.value[0]), c2 = { type: "main_reply", message_id: r, message: e2 }, f2.postMessage(c2, h.map(function(e3) {
                    return e3.object;
                  })), freeTransferables(h);
                }, function(e2) {
                  f2.postMessage({ type: "main_reply", message_id: r, error: e2 instanceof Error ? "".concat(e2.message, ": ").concat(e2.stack) : e2 });
                }) : (l instanceof WorkerBroker.withTransferables && (h = l.transferables, l = l.value[0]), c2 = { type: "main_reply", message_id: r, message: l, error: u2 instanceof Error ? "".concat(u2.message, ": ").concat(u2.stack) : u2 }, f2.postMessage(c2, h.map(function(e2) {
                  return e2.object;
                })), freeTransferables(h));
              }
            });
          }, WorkerBroker.getMessages = function() {
            return messages;
          }, WorkerBroker.getMessageId = function() {
            return message_id;
          };
        }
        function setupWorkerThread() {
          WorkerBroker.postMessage = function(r) {
            for (var e = arguments.length, i2 = new Array(1 < e ? e - 1 : 0), t2 = 1; t2 < e; t2++)
              i2[t2 - 1] = arguments[t2];
            var n = {};
            "object" === _typeof(r) && (r = (n = r).method);
            var o, a2 = new Promise(function(e2, t3) {
              messages[message_id] = { method: r, message: i2, resolve: e2, reject: t3 };
            }), s = [];
            return i2 && 1 === i2.length && i2[0] instanceof WorkerBroker.withTransferables && (s = i2[0].transferables, i2 = i2[0].value), o = { type: "worker_send", message_id, method: r, message: i2 }, n.stringify && (o = JSON.stringify(o)), self.postMessage(o, s.map(function(e2) {
              return e2.object;
            })), freeTransferables(s), message_id++, a2;
          }, self.addEventListener("message", function(e) {
            var t2 = "string" == typeof e.data ? JSON.parse(e.data) : e.data, r = t2.message_id;
            if ("main_reply" === t2.type)
              messages[r] && (t2.hasOwnProperty("error") && t2.error !== ERROR_NOT_SET ? messages[r].reject(t2.error) : messages[r].resolve(t2.message), delete messages[r]);
            else if ("main_send" === t2.type && null != r) {
              var i2 = _slicedToArray(findTarget(t2.method), 2), n = i2[0], o = i2[1], a2 = "Worker broker could not dispatch message type ".concat(t2.method, " on target ").concat(t2.target, ".");
              if (!o)
                throw Error(a2 + ERROR_NO_TARGET);
              var s, l, u2 = "function" == typeof o[n] && o[n];
              if (!u2)
                throw Error(a2 + ERROR_NO_METHOD);
              try {
                s = u2.apply(o, t2.message);
              } catch (e2) {
                l = e2;
              }
              var c2, h = [];
              s instanceof Promise ? s.then(function(e2) {
                e2 instanceof WorkerBroker.withTransferables && (h = e2.transferables, e2 = e2.value[0]), c2 = { type: "worker_reply", message_id: r, message: e2 }, self.postMessage(c2, h.map(function(e3) {
                  return e3.object;
                })), freeTransferables(h);
              }, function(e2) {
                self.postMessage({ type: "worker_reply", message_id: r, error: e2 instanceof Error ? "".concat(e2.message, ": ").concat(e2.stack) : e2 });
              }) : (s instanceof WorkerBroker.withTransferables && (h = s.transferables, s = s.value[0]), c2 = { type: "worker_reply", message_id: r, message: s, error: l instanceof Error ? "".concat(l.message, ": ").concat(l.stack) : l }, self.postMessage(c2, h.map(function(e2) {
                return e2.object;
              })), freeTransferables(h));
            }
          });
        }
        function findTransferables(r) {
          var e = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : null, t2 = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : null, i2 = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : [];
          if (!r)
            return i2;
          if (Array.isArray(r))
            r.forEach(function(e2, t3) {
              return findTransferables(e2, r, t3, i2);
            });
          else if ("object" === _typeof(r))
            if (r instanceof ArrayBuffer)
              i2.push({ object: r, parent: e, property: t2 });
            else if (r.buffer instanceof ArrayBuffer)
              i2.push({ object: r.buffer, parent: e, property: t2 });
            else
              for (var n in r)
                findTransferables(r[n], r, n, i2);
          return i2;
        }
        function freeTransferables(e) {
          Array.isArray(e) && e.filter(function(e2) {
            return e2.parent && e2.property;
          }).forEach(function(e2) {
            return delete e2.parent[e2.property];
          });
        }
        WorkerBroker.withTransferables = function() {
          for (var e = arguments.length, t2 = new Array(e), r = 0; r < e; r++)
            t2[r] = arguments[r];
          if (!(this instanceof WorkerBroker.withTransferables))
            return _construct(WorkerBroker.withTransferables, t2);
          this.value = t2, this.transferables = findTransferables(this.value);
        }, Thread.is_main && setupMainThread(), Thread.is_worker && setupWorkerThread();
        var LEVELS = { silent: -1, error: 0, warn: 1, info: 2, debug: 3, trace: 4 }, methods = {}, logged_once = {}, Utils;
        function methodForLevel(e) {
          return methods[e] = methods[e] || (console[e] ? console[e] : console.log).bind(console), methods[e];
        }
        function log(e) {
          var t2 = "object" === _typeof(e) ? e.level : e;
          if (LEVELS[t2] <= LEVELS[log.level]) {
            for (var r = arguments.length, i2 = new Array(1 < r ? r - 1 : 0), n = 1; n < r; n++)
              i2[n - 1] = arguments[n];
            if (Thread.is_native_worker)
              WorkerBroker.postMessage.apply(WorkerBroker, [{ method: "_logProxy", stringify: true }, e].concat(i2));
            else {
              if ("object" === _typeof(e) && true === e.once) {
                if (logged_once[JSON.stringify(i2)])
                  return;
                logged_once[JSON.stringify(i2)] = true;
              }
              var o = methodForLevel(t2);
              1 < i2.length ? o.apply(void 0, ["Tangram [".concat(t2, "]: ").concat(i2[0])].concat(_toConsumableArray(i2.slice(1)))) : o("Tangram [".concat(t2, "]: ").concat(i2[0]));
            }
          }
        }
        function debounce(i2, n, o) {
          var a2, s;
          return o = o || 0, function() {
            var e = this, t2 = arguments;
            function r() {
              s = 0, i2.apply(e, t2);
            }
            clearTimeout(a2), s && o && Date.now() - s >= o ? r() : (s = s || Date.now(), a2 = setTimeout(function() {
              r();
            }, n));
          };
        }
        log.level = "info", log.workers = null, log.setLevel = function(e) {
          log.level = e, Thread.is_main && Array.isArray(log.workers) && WorkerBroker.postMessage(log.workers, "_logSetLevelProxy", e);
        }, Thread.is_main && (log.setWorkers = function(e) {
          log.workers = e;
        }, log.reset = function() {
          logged_once = {};
        }), WorkerBroker.addTarget("_logProxy", log), WorkerBroker.addTarget("_logSetLevelProxy", log.setLevel);
        var Utils$1 = Utils = {};
        WorkerBroker.addTarget("Utils", Utils), Utils.isSafari = function() {
          return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
        }, Utils.isMicrosoft = function() {
          return /(Trident\/7.0|Edge[ /](\d+[\.\d]+))/i.test(navigator.userAgent);
        }, Utils._requests = {}, Utils._proxy_requests = {}, Utils.io = function(r) {
          var i2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 6e4, n = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : "text", o = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : "GET", e = 4 < arguments.length && void 0 !== arguments[4] ? arguments[4] : {}, t2 = 5 < arguments.length && void 0 !== arguments[5] ? arguments[5] : null, a2 = 6 < arguments.length && void 0 !== arguments[6] && arguments[6];
          if (Thread.is_worker && Utils.isMicrosoft())
            return log("debug", "Proxying request for URL to worker", r), t2 && (Utils._proxy_requests[t2] = true), WorkerBroker.postMessage("Utils.io", r, i2, n, o, e, t2, true);
          var s = new XMLHttpRequest(), l = (l = new Promise(function(e2, t3) {
            s.open(o, r, true), s.timeout = i2, s.responseType = n, s.onload = function() {
              200 === s.status ? -1 < ["text", "json"].indexOf(s.responseType) ? e2(s.responseText) : e2(s.response) : t3(Error("Request error with a status of " + s.statusText));
            }, s.onerror = function(e3) {
              t3(Error("There was a network error" + e3.toString()));
            }, s.ontimeout = function(e3) {
              t3(Error("timeout " + e3.toString()));
            }, s.send();
          })).then(function(e2) {
            return t2 && delete Utils._requests[t2], a2 ? WorkerBroker.withTransferables(e2) : e2;
          });
          return t2 && (Utils._requests[t2] = s), l;
        }, Utils.cancelRequest = function(e) {
          if (Thread.is_worker && Utils._proxy_requests[e])
            return WorkerBroker.postMessage("Utils.cancelRequest", e);
          Utils._requests[e] ? (log("trace", "Cancelling network request key '".concat(e, "'")), Utils._requests[e].abort(), delete Utils._requests[e]) : log("trace", "Could not find network request key '".concat(e, "'"));
        }, Utils.requestAnimationFramePolyfill = function() {
          "function" != typeof window.requestAnimationFrame && (window.requestAnimationFrame = window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function(e) {
            setTimeout(e, 1e3 / 60);
          });
        }, Utils.serializeWithFunctions = function(e) {
          return "function" == typeof e ? e.toString() : JSON.stringify(e, function(e2, t2) {
            return "function" == typeof t2 ? t2.toString() : t2;
          });
        }, Utils.stringsToFunctions = function(e, t2) {
          if ("string" == typeof e)
            e = Utils.stringToFunction(e, t2);
          else if (null != e && "object" === _typeof(e))
            for (var r in e)
              e[r] = Utils.stringsToFunctions(e[r], t2);
          return e;
        }, Utils._use_count = 0, Utils._function_cache = {};
        var _clear_function_cache = debounce(function() {
          log("trace", "Cleared cached ".concat(Object.keys(Utils._function_cache).length, " functions (reused ").concat(Utils._use_count, " times)")), Utils._use_count = 0, Utils._function_cache = {};
        }, 1e4), FUNCTION_MATCH_RGX = /^\s*function[^(]*\(([^)]*)\)\s*?\{([\s\S]*)\}$/m, _createObjectURL, _revokeObjectURL;
        function addBaseURL(e, t2) {
          if (!e || !isRelativeURL(e))
            return e;
          var r, i2 = "/" !== e[0];
          return t2 ? (r = document.createElement("a")).href = t2 : r = window.location, e = i2 ? pathForURL(r.href) + e : (r.origin || r.protocol + "//" + r.host) + e;
        }
        function pathForURL(e) {
          if ("string" != typeof e || -1 !== e.search(/^(data|blob):/))
            return "";
          var t2 = e.indexOf("?");
          -1 < t2 && (e = e.substr(0, t2));
          var r = e.indexOf("#");
          return -1 < r && (e = e.substr(0, r)), e.substr(0, e.lastIndexOf("/") + 1) || "";
        }
        function extensionForURL(e) {
          var t2 = (e = e.split("/").pop()).lastIndexOf(".");
          if (-1 < t2)
            return e.substring(t2 + 1);
        }
        function isRelativeURL(e) {
          return "string" == typeof e && !(-1 < e.search(/^(http|https|data|blob):/) || "//" === e.substr(0, 2));
        }
        function addParamsToURL(e, t2) {
          if (!t2 || 0 === Object.keys(t2).length)
            return [e, []];
          var r = e.indexOf("?"), i2 = e.indexOf("#"), n = "";
          -1 < i2 && (n = e.slice(i2), e = e.slice(0, i2)), -1 === r && (r = e.length, e += "?"), r++;
          var o = "", a2 = [];
          for (var s in t2)
            "" === getURLParameter(s, e) ? o += "".concat(s, "=").concat(t2[s], "&") : a2.push([s, t2[s]]);
          return [e = e.slice(0, r) + o + e.slice(r) + n, a2];
        }
        function createObjectURL(e) {
          return void 0 === _createObjectURL && "function" != typeof (_createObjectURL = window.URL && window.URL.createObjectURL || window.webkitURL && window.webkitURL.createObjectURL) && (_createObjectURL = null, log("warn", "window.URL.createObjectURL (or vendor prefix) not found, unable to create local blob URLs")), _createObjectURL ? _createObjectURL(e) : e;
        }
        function revokeObjectURL(e) {
          return void 0 === _revokeObjectURL && "function" != typeof (_revokeObjectURL = window.URL && window.URL.revokeObjectURL || window.webkitURL && window.webkitURL.revokeObjectURL) && (_revokeObjectURL = null, log("warn", "window.URL.revokeObjectURL (or vendor prefix) not found, unable to create local blob URLs")), _revokeObjectURL ? _revokeObjectURL(e) : e;
        }
        function getURLParameter(e, t2) {
          e = e.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
          var r = new RegExp("[\\?&]" + e + "=([^&#]*)").exec(t2);
          return null === r ? "" : decodeURIComponent(r[1].replace(/\+/g, " "));
        }
        Utils.stringToFunction = function(t2, e) {
          var r = t2;
          e && (r += e.toString());
          var i2 = Utils._function_cache[r];
          if (_clear_function_cache(), i2)
            return Utils._use_count++, i2;
          var n = "string" == typeof t2 && t2.match(FUNCTION_MATCH_RGX);
          if (n && 2 < n.length)
            try {
              var o = n[2], a2 = 0 < (a2 = 0 < n[1].length && n[1].split(",").map(function(e2) {
                return e2.trim();
              }).filter(function(e2) {
                return e2;
              })).length ? a2 : ["context"], s = new Function(a2.toString(), "function" == typeof e ? e(o) : o);
              return Utils._function_cache[r] = s;
            } catch (e2) {
              return t2;
            }
          return t2;
        }, Utils.device_pixel_ratio = 1, Utils.isPowerOf2 = function(e) {
          return 0 == (e & e - 1);
        }, Utils.interpolate = function(e, t2, r) {
          if (!Array.isArray(t2) || !Array.isArray(t2[0]))
            return t2;
          if (t2.length < 1)
            return t2;
          var i2, n, o, a2, s;
          if (e <= t2[0][0])
            a2 = t2[0][1], "function" == typeof r && (a2 = r(a2));
          else if (e >= t2[t2.length - 1][0])
            a2 = t2[t2.length - 1][1], "function" == typeof r && (a2 = r(a2));
          else
            for (var l = 0; l < t2.length - 1; l++)
              if (e >= t2[l][0] && e < t2[l + 1][0]) {
                if (i2 = t2[l][0], n = t2[l + 1][0], Array.isArray(t2[l][1])) {
                  a2 = [];
                  for (var u2 = 0; u2 < t2[l][1].length; u2++)
                    "function" == typeof r ? (s = r(t2[l][1][u2]), o = r(t2[l + 1][1][u2]) - s, a2[u2] = o * (e - i2) / (n - i2) + s) : (o = t2[l + 1][1][u2] - t2[l][1][u2], a2[u2] = o * (e - i2) / (n - i2) + t2[l][1][u2]);
                } else
                  a2 = "function" == typeof r ? (s = r(t2[l][1]), (o = r(t2[l + 1][1]) - s) * (e - i2) / (n - i2) + s) : (o = t2[l + 1][1] - t2[l][1]) * (e - i2) / (n - i2) + t2[l][1];
                break;
              }
          return a2;
        }, Utils.toCSSColor = function(e) {
          return 1 === e[3] ? "rgb(".concat(e.slice(0, 3).map(function(e2) {
            return Math.round(255 * e2);
          }).join(", "), ")") : "rgba(".concat(e.map(function(e2, t2) {
            return t2 < 3 && Math.round(255 * e2) || e2;
          }).join(", "), ")");
        }, Utils.pointInTile = function(e) {
          return 0 <= e[0] && e[1] > -Geo$1.tile_scale && e[0] < Geo$1.tile_scale && e[1] <= 0;
        }, Utils.zoomToTileLevel = function(e) {
          return Math.floor(e);
        };
        var DataSource = function() {
          function u2(e, t2) {
            var r = this;
            if (_classCallCheck(this, u2), this.config = e, this.sources = t2, this.id = e.id, this.name = e.name, this.pad_scale = e.pad_scale || 1e-4, this.default_winding = null, this.rasters = [], Array.isArray(e.rasters) && e.rasters.forEach(function(e2) {
              -1 === r.rasters.indexOf(e2) && r.rasters.push(e2);
            }), this.preprocess = e.preprocess, "function" == typeof this.preprocess && this.preprocess.bind(this), this.transform = e.transform, "function" == typeof this.transform)
              this.transform = this.transform.bind(this);
            else if ("object" === _typeof(this.transform))
              for (var i2 in this.transform)
                "function" == typeof this.transform[i2] && (this.transform[i2] = this.transform[i2].bind(this));
            this.extra_data = e.extra_data, this.scripts = e.scripts, this.max_zoom = null != e.max_zoom ? e.max_zoom : Geo$1.default_source_max_zoom, this.setTileSize(e.tile_size), this.max_coord_zoom = this.max_zoom + this.zoom_bias, this.min_display_zoom = null != e.min_display_zoom ? e.min_display_zoom : 0, this.max_display_zoom = null != e.max_display_zoom ? e.max_display_zoom : null, this._has_volatile_data = !!e.has_volatile_data;
          }
          return _createClass(u2, [{ key: "hasLabeledData", value: function() {
            return true;
          } }, { key: "_transformTile", value: function(e) {
            if (e.source_data.layers) {
              var t2 = { coords: e.coords }, r = [];
              if ("function" == typeof this.transform)
                r.push(this.transform);
              else if ("object" === _typeof(this.transform))
                for (var i2 = Object.keys(this.transform).sort(), n = 0; n < i2.length; n++)
                  r.push(this.transform[i2[n]]);
              for (var o = 1 === Object.keys(e.source_data.layers).length && e.source_data.layers._default, a2 = 0; a2 < r.length; a2++)
                o ? e.source_data.layers._default = r[a2](e.source_data.layers._default, this.extra_data, t2) : e.source_data.layers = r[a2](e.source_data.layers, this.extra_data, t2);
            }
          } }, { key: "_postProcessTile", value: function(e) {
            var t2 = this;
            for (var r in this._transformTile(e), e.source_data.layers) {
              var i2 = e.source_data.layers[r];
              i2 && i2.features && i2.features.forEach(function(e2) {
                Geo$1.transformGeometry(e2.geometry, function(e3) {
                  e3[1] = -e3[1], t2.pad_scale && (e3[0] = Math.round(e3[0] * (1 + t2.pad_scale) - Geo$1.tile_scale * t2.pad_scale / 2), e3[1] = Math.round(e3[1] * (1 + t2.pad_scale) - Geo$1.tile_scale * t2.pad_scale / 2));
                }), t2.updateDefaultWinding(e2.geometry);
              });
            }
            e.default_winding = this.default_winding || "CCW";
          } }, { key: "load", value: function(e) {
            return e.source_data = {}, e.source_data.layers = {}, e.pad_scale = this.pad_scale, e.rasters = _toConsumableArray(this.rasters), this._load(e);
          } }, { key: "_load", value: function() {
            throw new MethodNotImplemented("_load");
          } }, { key: "setTileSize", value: function(e) {
            this.tile_size = e || 256, ("number" != typeof this.tile_size || this.tile_size < 256 || !Utils$1.isPowerOf2(this.tile_size)) && (log({ level: "warn", once: true }, "Data source '".concat(this.name, "': 'tile_size' parameter must be a number that is a power of 2 greater than or equal to 256, but was '").concat(e, "'")), this.tile_size = 256), this.zoom_bias = Math.log2(this.tile_size) - 8;
          } }, { key: "updateDefaultWinding", value: function(e) {
            return null == this.default_winding && ("Polygon" === e.type ? this.default_winding = Geo$1.ringWinding(e.coordinates[0]) : "MultiPolygon" === e.type && (this.default_winding = Geo$1.ringWinding(e.coordinates[0][0]))), this.default_winding;
          } }, { key: "includesTile", value: function(e, t2) {
            if (e.z < this.min_display_zoom || null != this.max_display_zoom && t2 > this.max_display_zoom)
              return false;
            for (var r = 0; r < this.rasters.length; r++) {
              var i2 = this.rasters[r];
              if (this.sources[i2] && this.sources[i2] !== this && !this.sources[i2].includesTile(e, e.z))
                return false;
            }
            return true;
          } }, { key: "has_volatile_data", get: function() {
            return this._has_volatile_data;
          }, set: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e && e;
            this._has_volatile_data = t2;
          } }], [{ key: "create", value: function(e, t2) {
            for (var r in t2)
              if (t2[r].config.name === e.name && u2.sameConfig(t2[r], { config: e }))
                return t2[r];
            if (u2.types[e.type])
              return new u2.types[e.type](e, t2);
          } }, { key: "sameConfig", value: function(e, t2) {
            if (!e || !t2)
              return false;
            var r = Object.assign({}, e.config, { id: null, tiled: null, url: null }), i2 = Object.assign({}, t2.config, { id: null, tiled: null, url: null });
            return JSON.stringify(r) === JSON.stringify(i2);
          } }, { key: "coordsToMeters", value: function(e) {
            var t2 = _slicedToArray(Geo$1.latLngToMeters(e), 2), r = t2[0], i2 = t2[1];
            e[0] = r, e[1] = i2;
          } }, { key: "projectData", value: function(e) {
            for (var t2 in e.layers)
              for (var r = e.layers[t2].features.length, i2 = 0; i2 < r; i2++) {
                var n = e.layers[t2].features[i2];
                Geo$1.transformGeometry(n.geometry, u2.coordsToMeters);
              }
          } }, { key: "metersToTileUnits", value: function(e, t2, r) {
            r[0] = Math.round((r[0] - t2.x) * e), r[1] = -1 * Math.round((r[1] - t2.y) * e);
          } }, { key: "scaleData", value: function(e, t2) {
            var r = t2.coords.z, i2 = t2.min, n = (t2.max, u2.metersToTileUnits.bind(this, Geo$1.unitsPerMeter(r), i2));
            for (var o in e.layers)
              for (var a2 = e.layers[o].features.length, s = 0; s < a2; s++) {
                var l = e.layers[o].features[s];
                Geo$1.transformGeometry(l.geometry, n);
              }
          } }, { key: "register", value: function(e, t2) {
            e && t2 && (u2.types[t2] = e);
          } }]), u2;
        }();
        DataSource.types = {};
        var network_request_id = 0, NetworkSource = function() {
          _inherits(s, DataSource);
          var a2 = _createSuper(s);
          function s(n, e) {
            var o;
            _classCallCheck(this, s), (o = a2.call(this, n, e)).response_type = "";
            var t2 = _slicedToArray(addParamsToURL(n.url, n.url_params), 2), r = t2[0], i2 = t2[1];
            if (o.url = r, i2.forEach(function(e2) {
              var t3 = _slicedToArray(e2, 2), r2 = t3[0], i3 = t3[1];
              log({ level: "warn", once: true }, "Data source '".concat(o.name, "': parameter '").concat(r2, "' already present in URL '").concat(n.url, "', ") + "skipping value '".concat(r2, "=").concat(i3, "' specified in 'url_params'"));
            }), "string" != typeof o.url)
              throw Error("Network data source must provide a string `url` property");
            return o;
          }
          return _createClass(s, [{ key: "_load", value: function(n) {
            var o = this, a3 = this.formatUrl(this.url, n), s2 = n.source_data;
            return s2.url = a3, new Promise(function(t2, e) {
              s2.error = null;
              var r = network_request_id++ + "-" + a3, i2 = Utils$1.io(a3, 6e4, o.response_type, "GET", {}, r);
              s2.request_id = r, i2.then(function(e2) {
                "function" == typeof o.preprocess && (e2 = o.preprocess(e2)), (e2 = e2 instanceof Promise ? e2 : Promise.resolve(e2)).then(function(e3) {
                  o.parseSourceData(n, s2, e3), o._postProcessTile(n), t2(n);
                });
              }, function(e2) {
                s2.error = e2.stack, o._postProcessTile(n), t2(n);
              });
            });
          } }, { key: "formatUrl", value: function() {
            throw new MethodNotImplemented("formatUrl");
          } }, { key: "parseSourceData", value: function() {
            throw new MethodNotImplemented("parseSourceData");
          } }]), s;
        }(), NetworkTileSource = function() {
          _inherits(n, NetworkSource);
          var i2 = _createSuper(n);
          function n(e, t2) {
            var r;
            return _classCallCheck(this, n), (r = i2.call(this, e, t2)).tiled = true, r.parseBounds(e), r.builds_geometry_tiles = false, r.tms = true === e.tms, -1 < r.url.search("{s}") && (Array.isArray(e.url_subdomains) && 0 < e.url_subdomains.length ? (r.url_subdomains = e.url_subdomains, r.next_url_subdomain = 0) : log({ level: "warn", once: true }, "Data source '".concat(r.name, "': source URL includes '{s}' subdomain marker ('").concat(r.url, "'), but no subdomains ") + "were specified in 'url_subdomains' parameter")), r;
          }
          return _createClass(n, [{ key: "parseBounds", value: function(e) {
            var t2, r, i3, n2, o;
            Array.isArray(e.bounds) && 4 === e.bounds.length && (this.bounds = e.bounds, r = (t2 = _slicedToArray(this.bounds, 4))[0], i3 = t2[1], n2 = t2[2], o = t2[3], this.bounds_meters = { min: Geo$1.latLngToMeters([r, o]), max: Geo$1.latLngToMeters([n2, i3]) }, this.bounds_tiles = { min: {}, max: {} });
          } }, { key: "checkBounds", value: function(e) {
            if (this.bounds) {
              e = Geo$1.wrapTile(e, { x: true });
              var t2 = (t2 = this.bounds_tiles.min[e.z]) || (this.bounds_tiles.min[e.z] = Geo$1.tileForMeters(this.bounds_meters.min, e.z)), r = (r = this.bounds_tiles.max[e.z]) || (this.bounds_tiles.max[e.z] = Geo$1.tileForMeters(this.bounds_meters.max, e.z));
              if (e.x < t2.x || e.x > r.x || e.y < t2.y || e.y > r.y)
                return false;
            }
            return true;
          } }, { key: "includesTile", value: function(e, t2) {
            return !!_get(_getPrototypeOf(n.prototype), "includesTile", this).call(this, e, t2) && !!this.checkBounds(e);
          } }, { key: "formatUrl", value: function(e, t2) {
            var r = Geo$1.wrapTile(t2.coords, { x: true });
            this.tms && (r.y = Math.pow(2, r.z) - 1 - r.y);
            var i3 = e.replace("{x}", r.x).replace("{y}", r.y).replace("{z}", r.z);
            return null != this.url_subdomains && (i3 = i3.replace("{s}", this.url_subdomains[this.next_url_subdomain]), this.next_url_subdomain = (this.next_url_subdomain + 1) % this.url_subdomains.length), i3;
          } }, { key: "urlHasTilePattern", value: function(e) {
            return e && -1 < e.search("{x}") && -1 < e.search("{y}") && -1 < e.search("{z}");
          } }]), n;
        }(), MapsJsSource = function() {
          _inherits(n, DataSource);
          var i2 = _createSuper(n);
          function n(e, t2) {
            var r;
            return _classCallCheck(this, n), (r = i2.call(this, e, t2)).target_name = "MapsJsSource" + e.uid, r.tiled = !!e.tiled, WorkerBroker.addTarget(r.target_name, _assertThisInitialized(r)), Thread.is_worker && WorkerBroker.postMessage(r.target_name + ".onWorkerInitialized"), Thread.is_main && (r._workers_left = 0), r;
          }
          return _createClass(n, [{ key: "initialize", value: function(e, t2, r, i3) {
            this._main_initialized || (this.provider = e, this.worker = i3, this._workers_left += r, this._on_update = t2, this._main_initialized = true, this._onProviderUpdate = this._onProviderUpdate.bind(this), e.addEventListener("update", this._onProviderUpdate), this._isReady() && this.onReady());
          } }, { key: "onWorkerInitialized", value: function() {
            --this._workers_left, this._isReady() && this.onReady();
          } }, { key: "onReady", value: function() {
          } }, { key: "_isReady", value: function() {
            return this._main_initialized && !this._workers_left;
          } }, { key: "_onProviderUpdate", value: function(e) {
            this._isReady() && this.onProviderUpdate(e);
          } }, { key: "onProviderUpdate", value: function(e) {
            this.dispatchUpdate(void 0, e.data);
          } }, { key: "dispatchUpdate", value: function(e, t2) {
            this._on_update(this.name, e, t2);
          } }, { key: "dispose", value: function() {
            WorkerBroker.removeTarget(this.target_name), this.provider.removeEventListener("update", this._onProviderUpdate);
          } }]), n;
        }(), read = function(e, t2, r, i2, n) {
          var o, a2, s = 8 * n - i2 - 1, l = (1 << s) - 1, u2 = l >> 1, c2 = -7, h = r ? n - 1 : 0, f2 = r ? -1 : 1, d = e[t2 + h];
          for (h += f2, o = d & (1 << -c2) - 1, d >>= -c2, c2 += s; 0 < c2; o = 256 * o + e[t2 + h], h += f2, c2 -= 8)
            ;
          for (a2 = o & (1 << -c2) - 1, o >>= -c2, c2 += i2; 0 < c2; a2 = 256 * a2 + e[t2 + h], h += f2, c2 -= 8)
            ;
          if (0 === o)
            o = 1 - u2;
          else {
            if (o === l)
              return a2 ? NaN : 1 / 0 * (d ? -1 : 1);
            a2 += Math.pow(2, i2), o -= u2;
          }
          return (d ? -1 : 1) * a2 * Math.pow(2, o - i2);
        }, write = function(e, t2, r, i2, n, o) {
          var a2, s, l, u2 = 8 * o - n - 1, c2 = (1 << u2) - 1, h = c2 >> 1, f2 = 23 === n ? Math.pow(2, -24) - Math.pow(2, -77) : 0, d = i2 ? 0 : o - 1, _ = i2 ? 1 : -1, p2 = t2 < 0 || 0 === t2 && 1 / t2 < 0 ? 1 : 0;
          for (t2 = Math.abs(t2), isNaN(t2) || t2 === 1 / 0 ? (s = isNaN(t2) ? 1 : 0, a2 = c2) : (a2 = Math.floor(Math.log(t2) / Math.LN2), t2 * (l = Math.pow(2, -a2)) < 1 && (a2--, l *= 2), 2 <= (t2 += 1 <= a2 + h ? f2 / l : f2 * Math.pow(2, 1 - h)) * l && (a2++, l /= 2), c2 <= a2 + h ? (s = 0, a2 = c2) : 1 <= a2 + h ? (s = (t2 * l - 1) * Math.pow(2, n), a2 += h) : (s = t2 * Math.pow(2, h - 1) * Math.pow(2, n), a2 = 0)); 8 <= n; e[r + d] = 255 & s, d += _, s /= 256, n -= 8)
            ;
          for (a2 = a2 << n | s, u2 += n; 0 < u2; e[r + d] = 255 & a2, d += _, a2 /= 256, u2 -= 8)
            ;
          e[r + d - _] |= 128 * p2;
        }, ieee754 = { read, write }, pbf = Pbf;
        function Pbf(e) {
          this.buf = ArrayBuffer.isView && ArrayBuffer.isView(e) ? e : new Uint8Array(e || 0), this.pos = 0, this.type = 0, this.length = this.buf.length;
        }
        Pbf.Varint = 0, Pbf.Fixed64 = 1, Pbf.Bytes = 2, Pbf.Fixed32 = 5;
        var SHIFT_LEFT_32 = 4294967296, SHIFT_RIGHT_32 = 1 / SHIFT_LEFT_32;
        function readVarintRemainder(e, t2, r) {
          var i2 = r.buf, n = i2[r.pos++], o = (112 & n) >> 4;
          if (n < 128)
            return toNum(e, o, t2);
          if (o |= (127 & (n = i2[r.pos++])) << 3, n < 128)
            return toNum(e, o, t2);
          if (o |= (127 & (n = i2[r.pos++])) << 10, n < 128)
            return toNum(e, o, t2);
          if (o |= (127 & (n = i2[r.pos++])) << 17, n < 128)
            return toNum(e, o, t2);
          if (o |= (127 & (n = i2[r.pos++])) << 24, n < 128)
            return toNum(e, o, t2);
          if (o |= (1 & (n = i2[r.pos++])) << 31, n < 128)
            return toNum(e, o, t2);
          throw new Error("Expected varint not more than 10 bytes");
        }
        function readPackedEnd(e) {
          return e.type === Pbf.Bytes ? e.readVarint() + e.pos : e.pos + 1;
        }
        function toNum(e, t2, r) {
          return r ? 4294967296 * t2 + (e >>> 0) : 4294967296 * (t2 >>> 0) + (e >>> 0);
        }
        function writeBigVarint(e, t2) {
          var r, i2;
          if (0 <= e ? (r = e % 4294967296 | 0, i2 = e / 4294967296 | 0) : (i2 = ~(-e / 4294967296), 4294967295 ^ (r = ~(-e % 4294967296)) ? r = r + 1 | 0 : i2 = i2 + 1 | (r = 0)), 18446744073709552e3 <= e || e < -18446744073709552e3)
            throw new Error("Given varint doesn't fit into 10 bytes");
          t2.realloc(10), writeBigVarintLow(r, i2, t2), writeBigVarintHigh(i2, t2);
        }
        function writeBigVarintLow(e, t2, r) {
          r.buf[r.pos++] = 127 & e | 128, e >>>= 7, r.buf[r.pos++] = 127 & e | 128, e >>>= 7, r.buf[r.pos++] = 127 & e | 128, e >>>= 7, r.buf[r.pos++] = 127 & e | 128, e >>>= 7, r.buf[r.pos] = 127 & e;
        }
        function writeBigVarintHigh(e, t2) {
          var r = (7 & e) << 4;
          t2.buf[t2.pos++] |= r | ((e >>>= 3) ? 128 : 0), e && (t2.buf[t2.pos++] = 127 & e | ((e >>>= 7) ? 128 : 0), e && (t2.buf[t2.pos++] = 127 & e | ((e >>>= 7) ? 128 : 0), e && (t2.buf[t2.pos++] = 127 & e | ((e >>>= 7) ? 128 : 0), e && (t2.buf[t2.pos++] = 127 & e | ((e >>>= 7) ? 128 : 0), e && (t2.buf[t2.pos++] = 127 & e)))));
        }
        function makeRoomForExtraLength(e, t2, r) {
          var i2 = t2 <= 16383 ? 1 : t2 <= 2097151 ? 2 : t2 <= 268435455 ? 3 : Math.ceil(Math.log(t2) / (7 * Math.LN2));
          r.realloc(i2);
          for (var n = r.pos - 1; e <= n; n--)
            r.buf[n + i2] = r.buf[n];
        }
        function writePackedVarint(e, t2) {
          for (var r = 0; r < e.length; r++)
            t2.writeVarint(e[r]);
        }
        function writePackedSVarint(e, t2) {
          for (var r = 0; r < e.length; r++)
            t2.writeSVarint(e[r]);
        }
        function writePackedFloat(e, t2) {
          for (var r = 0; r < e.length; r++)
            t2.writeFloat(e[r]);
        }
        function writePackedDouble(e, t2) {
          for (var r = 0; r < e.length; r++)
            t2.writeDouble(e[r]);
        }
        function writePackedBoolean(e, t2) {
          for (var r = 0; r < e.length; r++)
            t2.writeBoolean(e[r]);
        }
        function writePackedFixed32(e, t2) {
          for (var r = 0; r < e.length; r++)
            t2.writeFixed32(e[r]);
        }
        function writePackedSFixed32(e, t2) {
          for (var r = 0; r < e.length; r++)
            t2.writeSFixed32(e[r]);
        }
        function writePackedFixed64(e, t2) {
          for (var r = 0; r < e.length; r++)
            t2.writeFixed64(e[r]);
        }
        function writePackedSFixed64(e, t2) {
          for (var r = 0; r < e.length; r++)
            t2.writeSFixed64(e[r]);
        }
        function readUInt32(e, t2) {
          return (e[t2] | e[t2 + 1] << 8 | e[t2 + 2] << 16) + 16777216 * e[t2 + 3];
        }
        function writeInt32(e, t2, r) {
          e[r] = t2, e[r + 1] = t2 >>> 8, e[r + 2] = t2 >>> 16, e[r + 3] = t2 >>> 24;
        }
        function readInt32(e, t2) {
          return (e[t2] | e[t2 + 1] << 8 | e[t2 + 2] << 16) + (e[t2 + 3] << 24);
        }
        function readUtf8(e, t2, r) {
          for (var i2 = "", n = t2; n < r; ) {
            var o, a2, s, l = e[n], u2 = null, c2 = 239 < l ? 4 : 223 < l ? 3 : 191 < l ? 2 : 1;
            if (r < n + c2)
              break;
            1 === c2 ? l < 128 && (u2 = l) : 2 === c2 ? 128 == (192 & (o = e[n + 1])) && (u2 = (31 & l) << 6 | 63 & o) <= 127 && (u2 = null) : 3 === c2 ? (o = e[n + 1], a2 = e[n + 2], 128 == (192 & o) && 128 == (192 & a2) && ((u2 = (15 & l) << 12 | (63 & o) << 6 | 63 & a2) <= 2047 || 55296 <= u2 && u2 <= 57343) && (u2 = null)) : 4 === c2 && (o = e[n + 1], a2 = e[n + 2], s = e[n + 3], 128 == (192 & o) && 128 == (192 & a2) && 128 == (192 & s) && ((u2 = (15 & l) << 18 | (63 & o) << 12 | (63 & a2) << 6 | 63 & s) <= 65535 || 1114112 <= u2) && (u2 = null)), null === u2 ? (u2 = 65533, c2 = 1) : 65535 < u2 && (u2 -= 65536, i2 += String.fromCharCode(u2 >>> 10 & 1023 | 55296), u2 = 56320 | 1023 & u2), i2 += String.fromCharCode(u2), n += c2;
          }
          return i2;
        }
        function writeUtf8(e, t2, r) {
          for (var i2, n, o = 0; o < t2.length; o++) {
            if (55295 < (i2 = t2.charCodeAt(o)) && i2 < 57344) {
              if (!n) {
                56319 < i2 || o + 1 === t2.length ? (e[r++] = 239, e[r++] = 191, e[r++] = 189) : n = i2;
                continue;
              }
              if (i2 < 56320) {
                e[r++] = 239, e[r++] = 191, e[r++] = 189, n = i2;
                continue;
              }
              i2 = n - 55296 << 10 | i2 - 56320 | 65536, n = null;
            } else
              n && (e[r++] = 239, e[r++] = 191, e[r++] = 189, n = null);
            i2 < 128 ? e[r++] = i2 : (i2 < 2048 ? e[r++] = i2 >> 6 | 192 : (i2 < 65536 ? e[r++] = i2 >> 12 | 224 : (e[r++] = i2 >> 18 | 240, e[r++] = i2 >> 12 & 63 | 128), e[r++] = i2 >> 6 & 63 | 128), e[r++] = 63 & i2 | 128);
          }
          return r;
        }
        Pbf.prototype = { destroy: function() {
          this.buf = null;
        }, readFields: function(e, t2, r) {
          for (r = r || this.length; this.pos < r; ) {
            var i2 = this.readVarint(), n = i2 >> 3, o = this.pos;
            this.type = 7 & i2, e(n, t2, this), this.pos === o && this.skip(i2);
          }
          return t2;
        }, readMessage: function(e, t2) {
          return this.readFields(e, t2, this.readVarint() + this.pos);
        }, readFixed32: function() {
          var e = readUInt32(this.buf, this.pos);
          return this.pos += 4, e;
        }, readSFixed32: function() {
          var e = readInt32(this.buf, this.pos);
          return this.pos += 4, e;
        }, readFixed64: function() {
          var e = readUInt32(this.buf, this.pos) + readUInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;
          return this.pos += 8, e;
        }, readSFixed64: function() {
          var e = readUInt32(this.buf, this.pos) + readInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;
          return this.pos += 8, e;
        }, readFloat: function() {
          var e = ieee754.read(this.buf, this.pos, true, 23, 4);
          return this.pos += 4, e;
        }, readDouble: function() {
          var e = ieee754.read(this.buf, this.pos, true, 52, 8);
          return this.pos += 8, e;
        }, readVarint: function(e) {
          var t2 = this.buf, r = t2[this.pos++], i2 = 127 & r;
          return r < 128 ? i2 : (i2 |= (127 & (r = t2[this.pos++])) << 7, r < 128 ? i2 : (i2 |= (127 & (r = t2[this.pos++])) << 14, r < 128 ? i2 : (i2 |= (127 & (r = t2[this.pos++])) << 21, r < 128 ? i2 : readVarintRemainder(i2 |= (15 & (r = t2[this.pos])) << 28, e, this))));
        }, readVarint64: function() {
          return this.readVarint(true);
        }, readSVarint: function() {
          var e = this.readVarint();
          return e % 2 == 1 ? (e + 1) / -2 : e / 2;
        }, readBoolean: function() {
          return Boolean(this.readVarint());
        }, readString: function() {
          var e = this.readVarint() + this.pos, t2 = readUtf8(this.buf, this.pos, e);
          return this.pos = e, t2;
        }, readBytes: function() {
          var e = this.readVarint() + this.pos, t2 = this.buf.subarray(this.pos, e);
          return this.pos = e, t2;
        }, readPackedVarint: function(e, t2) {
          var r = readPackedEnd(this);
          for (e = e || []; this.pos < r; )
            e.push(this.readVarint(t2));
          return e;
        }, readPackedSVarint: function(e) {
          var t2 = readPackedEnd(this);
          for (e = e || []; this.pos < t2; )
            e.push(this.readSVarint());
          return e;
        }, readPackedBoolean: function(e) {
          var t2 = readPackedEnd(this);
          for (e = e || []; this.pos < t2; )
            e.push(this.readBoolean());
          return e;
        }, readPackedFloat: function(e) {
          var t2 = readPackedEnd(this);
          for (e = e || []; this.pos < t2; )
            e.push(this.readFloat());
          return e;
        }, readPackedDouble: function(e) {
          var t2 = readPackedEnd(this);
          for (e = e || []; this.pos < t2; )
            e.push(this.readDouble());
          return e;
        }, readPackedFixed32: function(e) {
          var t2 = readPackedEnd(this);
          for (e = e || []; this.pos < t2; )
            e.push(this.readFixed32());
          return e;
        }, readPackedSFixed32: function(e) {
          var t2 = readPackedEnd(this);
          for (e = e || []; this.pos < t2; )
            e.push(this.readSFixed32());
          return e;
        }, readPackedFixed64: function(e) {
          var t2 = readPackedEnd(this);
          for (e = e || []; this.pos < t2; )
            e.push(this.readFixed64());
          return e;
        }, readPackedSFixed64: function(e) {
          var t2 = readPackedEnd(this);
          for (e = e || []; this.pos < t2; )
            e.push(this.readSFixed64());
          return e;
        }, skip: function(e) {
          var t2 = 7 & e;
          if (t2 === Pbf.Varint)
            for (; 127 < this.buf[this.pos++]; )
              ;
          else if (t2 === Pbf.Bytes)
            this.pos = this.readVarint() + this.pos;
          else if (t2 === Pbf.Fixed32)
            this.pos += 4;
          else {
            if (t2 !== Pbf.Fixed64)
              throw new Error("Unimplemented type: " + t2);
            this.pos += 8;
          }
        }, writeTag: function(e, t2) {
          this.writeVarint(e << 3 | t2);
        }, realloc: function(e) {
          for (var t2, r = this.length || 16; r < this.pos + e; )
            r *= 2;
          r !== this.length && ((t2 = new Uint8Array(r)).set(this.buf), this.buf = t2, this.length = r);
        }, finish: function() {
          return this.length = this.pos, this.pos = 0, this.buf.subarray(0, this.length);
        }, writeFixed32: function(e) {
          this.realloc(4), writeInt32(this.buf, e, this.pos), this.pos += 4;
        }, writeSFixed32: function(e) {
          this.realloc(4), writeInt32(this.buf, e, this.pos), this.pos += 4;
        }, writeFixed64: function(e) {
          this.realloc(8), writeInt32(this.buf, -1 & e, this.pos), writeInt32(this.buf, Math.floor(e * SHIFT_RIGHT_32), this.pos + 4), this.pos += 8;
        }, writeSFixed64: function(e) {
          this.realloc(8), writeInt32(this.buf, -1 & e, this.pos), writeInt32(this.buf, Math.floor(e * SHIFT_RIGHT_32), this.pos + 4), this.pos += 8;
        }, writeVarint: function(e) {
          268435455 < (e = +e || 0) || e < 0 ? writeBigVarint(e, this) : (this.realloc(4), this.buf[this.pos++] = 127 & e | (127 < e ? 128 : 0), e <= 127 || (this.buf[this.pos++] = 127 & (e >>>= 7) | (127 < e ? 128 : 0), e <= 127 || (this.buf[this.pos++] = 127 & (e >>>= 7) | (127 < e ? 128 : 0), e <= 127 || (this.buf[this.pos++] = e >>> 7 & 127))));
        }, writeSVarint: function(e) {
          this.writeVarint(e < 0 ? 2 * -e - 1 : 2 * e);
        }, writeBoolean: function(e) {
          this.writeVarint(Boolean(e));
        }, writeString: function(e) {
          e = String(e), this.realloc(4 * e.length), this.pos++;
          var t2 = this.pos;
          this.pos = writeUtf8(this.buf, e, this.pos);
          var r = this.pos - t2;
          128 <= r && makeRoomForExtraLength(t2, r, this), this.pos = t2 - 1, this.writeVarint(r), this.pos += r;
        }, writeFloat: function(e) {
          this.realloc(4), ieee754.write(this.buf, e, this.pos, true, 23, 4), this.pos += 4;
        }, writeDouble: function(e) {
          this.realloc(8), ieee754.write(this.buf, e, this.pos, true, 52, 8), this.pos += 8;
        }, writeBytes: function(e) {
          var t2 = e.length;
          this.writeVarint(t2), this.realloc(t2);
          for (var r = 0; r < t2; r++)
            this.buf[this.pos++] = e[r];
        }, writeRawMessage: function(e, t2) {
          this.pos++;
          var r = this.pos;
          e(t2, this);
          var i2 = this.pos - r;
          128 <= i2 && makeRoomForExtraLength(r, i2, this), this.pos = r - 1, this.writeVarint(i2), this.pos += i2;
        }, writeMessage: function(e, t2, r) {
          this.writeTag(e, Pbf.Bytes), this.writeRawMessage(t2, r);
        }, writePackedVarint: function(e, t2) {
          this.writeMessage(e, writePackedVarint, t2);
        }, writePackedSVarint: function(e, t2) {
          this.writeMessage(e, writePackedSVarint, t2);
        }, writePackedBoolean: function(e, t2) {
          this.writeMessage(e, writePackedBoolean, t2);
        }, writePackedFloat: function(e, t2) {
          this.writeMessage(e, writePackedFloat, t2);
        }, writePackedDouble: function(e, t2) {
          this.writeMessage(e, writePackedDouble, t2);
        }, writePackedFixed32: function(e, t2) {
          this.writeMessage(e, writePackedFixed32, t2);
        }, writePackedSFixed32: function(e, t2) {
          this.writeMessage(e, writePackedSFixed32, t2);
        }, writePackedFixed64: function(e, t2) {
          this.writeMessage(e, writePackedFixed64, t2);
        }, writePackedSFixed64: function(e, t2) {
          this.writeMessage(e, writePackedSFixed64, t2);
        }, writeBytesField: function(e, t2) {
          this.writeTag(e, Pbf.Bytes), this.writeBytes(t2);
        }, writeFixed32Field: function(e, t2) {
          this.writeTag(e, Pbf.Fixed32), this.writeFixed32(t2);
        }, writeSFixed32Field: function(e, t2) {
          this.writeTag(e, Pbf.Fixed32), this.writeSFixed32(t2);
        }, writeFixed64Field: function(e, t2) {
          this.writeTag(e, Pbf.Fixed64), this.writeFixed64(t2);
        }, writeSFixed64Field: function(e, t2) {
          this.writeTag(e, Pbf.Fixed64), this.writeSFixed64(t2);
        }, writeVarintField: function(e, t2) {
          this.writeTag(e, Pbf.Varint), this.writeVarint(t2);
        }, writeSVarintField: function(e, t2) {
          this.writeTag(e, Pbf.Varint), this.writeSVarint(t2);
        }, writeStringField: function(e, t2) {
          this.writeTag(e, Pbf.Bytes), this.writeString(t2);
        }, writeFloatField: function(e, t2) {
          this.writeTag(e, Pbf.Fixed32), this.writeFloat(t2);
        }, writeDoubleField: function(e, t2) {
          this.writeTag(e, Pbf.Fixed64), this.writeDouble(t2);
        }, writeBooleanField: function(e, t2) {
          this.writeVarintField(e, Boolean(t2));
        } };
        var pointGeometry = Point;
        function Point(e, t2) {
          this.x = e, this.y = t2;
        }
        Point.prototype = { clone: function() {
          return new Point(this.x, this.y);
        }, add: function(e) {
          return this.clone()._add(e);
        }, sub: function(e) {
          return this.clone()._sub(e);
        }, multByPoint: function(e) {
          return this.clone()._multByPoint(e);
        }, divByPoint: function(e) {
          return this.clone()._divByPoint(e);
        }, mult: function(e) {
          return this.clone()._mult(e);
        }, div: function(e) {
          return this.clone()._div(e);
        }, rotate: function(e) {
          return this.clone()._rotate(e);
        }, rotateAround: function(e, t2) {
          return this.clone()._rotateAround(e, t2);
        }, matMult: function(e) {
          return this.clone()._matMult(e);
        }, unit: function() {
          return this.clone()._unit();
        }, perp: function() {
          return this.clone()._perp();
        }, round: function() {
          return this.clone()._round();
        }, mag: function() {
          return Math.sqrt(this.x * this.x + this.y * this.y);
        }, equals: function(e) {
          return this.x === e.x && this.y === e.y;
        }, dist: function(e) {
          return Math.sqrt(this.distSqr(e));
        }, distSqr: function(e) {
          var t2 = e.x - this.x, r = e.y - this.y;
          return t2 * t2 + r * r;
        }, angle: function() {
          return Math.atan2(this.y, this.x);
        }, angleTo: function(e) {
          return Math.atan2(this.y - e.y, this.x - e.x);
        }, angleWith: function(e) {
          return this.angleWithSep(e.x, e.y);
        }, angleWithSep: function(e, t2) {
          return Math.atan2(this.x * t2 - this.y * e, this.x * e + this.y * t2);
        }, _matMult: function(e) {
          var t2 = e[0] * this.x + e[1] * this.y, r = e[2] * this.x + e[3] * this.y;
          return this.x = t2, this.y = r, this;
        }, _add: function(e) {
          return this.x += e.x, this.y += e.y, this;
        }, _sub: function(e) {
          return this.x -= e.x, this.y -= e.y, this;
        }, _mult: function(e) {
          return this.x *= e, this.y *= e, this;
        }, _div: function(e) {
          return this.x /= e, this.y /= e, this;
        }, _multByPoint: function(e) {
          return this.x *= e.x, this.y *= e.y, this;
        }, _divByPoint: function(e) {
          return this.x /= e.x, this.y /= e.y, this;
        }, _unit: function() {
          return this._div(this.mag()), this;
        }, _perp: function() {
          var e = this.y;
          return this.y = this.x, this.x = -e, this;
        }, _rotate: function(e) {
          var t2 = Math.cos(e), r = Math.sin(e), i2 = t2 * this.x - r * this.y, n = r * this.x + t2 * this.y;
          return this.x = i2, this.y = n, this;
        }, _rotateAround: function(e, t2) {
          var r = Math.cos(e), i2 = Math.sin(e), n = t2.x + r * (this.x - t2.x) - i2 * (this.y - t2.y), o = t2.y + i2 * (this.x - t2.x) + r * (this.y - t2.y);
          return this.x = n, this.y = o, this;
        }, _round: function() {
          return this.x = Math.round(this.x), this.y = Math.round(this.y), this;
        } }, Point.convert = function(e) {
          return !(e instanceof Point) && Array.isArray(e) ? new Point(e[0], e[1]) : e;
        };
        var vectortilefeature = VectorTileFeature;
        function VectorTileFeature(e, t2, r, i2, n) {
          this.properties = {}, this.extent = r, this.type = 0, this._pbf = e, this._geometry = -1, this._keys = i2, this._values = n, e.readFields(readFeature, this, t2);
        }
        function readFeature(e, t2, r) {
          1 == e ? t2.id = r.readVarint() : 2 == e ? readTag(r, t2) : 3 == e ? t2.type = r.readVarint() : 4 == e && (t2._geometry = r.pos);
        }
        function readTag(e, t2) {
          for (var r = e.readVarint() + e.pos; e.pos < r; ) {
            var i2 = t2._keys[e.readVarint()], n = t2._values[e.readVarint()];
            t2.properties[i2] = n;
          }
        }
        function classifyRings(e) {
          var t2 = e.length;
          if (t2 <= 1)
            return [e];
          for (var r, i2, n = [], o = 0; o < t2; o++) {
            var a2 = signedArea(e[o]);
            0 !== a2 && (void 0 === i2 && (i2 = a2 < 0), i2 === a2 < 0 ? (r && n.push(r), r = [e[o]]) : r.push(e[o]));
          }
          return r && n.push(r), n;
        }
        function signedArea(e) {
          for (var t2, r, i2 = 0, n = 0, o = e.length, a2 = o - 1; n < o; a2 = n++)
            t2 = e[n], i2 += ((r = e[a2]).x - t2.x) * (t2.y + r.y);
          return i2;
        }
        VectorTileFeature.types = ["Unknown", "Point", "LineString", "Polygon"], VectorTileFeature.prototype.loadGeometry = function() {
          var e = this._pbf;
          e.pos = this._geometry;
          for (var t2, r, i2 = e.readVarint() + e.pos, n = 1, o = 0, a2 = 0, s = 0, l = []; e.pos < i2; ) {
            if (o || (n = 7 & (r = e.readVarint()), o = r >> 3), o--, 1 === n || 2 === n)
              a2 += e.readSVarint(), s += e.readSVarint(), 1 === n && (t2 && l.push(t2), t2 = []), t2.push(new pointGeometry(a2, s));
            else {
              if (7 !== n)
                throw new Error("unknown command " + n);
              t2 && t2.push(t2[0].clone());
            }
          }
          return t2 && l.push(t2), l;
        }, VectorTileFeature.prototype.bbox = function() {
          var e = this._pbf;
          e.pos = this._geometry;
          for (var t2, r = e.readVarint() + e.pos, i2 = 1, n = 0, o = 0, a2 = 0, s = 1 / 0, l = -1 / 0, u2 = 1 / 0, c2 = -1 / 0; e.pos < r; ) {
            if (n || (i2 = 7 & (t2 = e.readVarint()), n = t2 >> 3), n--, 1 === i2 || 2 === i2)
              (o += e.readSVarint()) < s && (s = o), l < o && (l = o), (a2 += e.readSVarint()) < u2 && (u2 = a2), c2 < a2 && (c2 = a2);
            else if (7 !== i2)
              throw new Error("unknown command " + i2);
          }
          return [s, u2, l, c2];
        }, VectorTileFeature.prototype.toGeoJSON = function(e, t2, r) {
          var i2, n = this.extent * Math.pow(2, r), o = this.extent * e, a2 = this.extent * t2, s = this.loadGeometry(), l = VectorTileFeature.types[this.type];
          function u2(e2) {
            for (var t3 = 0; t3 < e2.length; t3++) {
              var r2 = e2[t3], i3 = 180 - 360 * (r2.y + a2) / n;
              e2[t3] = [360 * (r2.x + o) / n - 180, 360 / Math.PI * Math.atan(Math.exp(i3 * Math.PI / 180)) - 90];
            }
          }
          switch (this.type) {
            case 1:
              for (var c2 = [], h = 0; h < s.length; h++)
                c2[h] = s[h][0];
              u2(s = c2);
              break;
            case 2:
              for (h = 0; h < s.length; h++)
                u2(s[h]);
              break;
            case 3:
              for (s = classifyRings(s), h = 0; h < s.length; h++)
                for (i2 = 0; i2 < s[h].length; i2++)
                  u2(s[h][i2]);
          }
          1 === s.length ? s = s[0] : l = "Multi" + l;
          var f2 = { type: "Feature", geometry: { type: l, coordinates: s }, properties: this.properties };
          return "id" in this && (f2.id = this.id), f2;
        };
        var VectorTileFeature$1 = vectortilefeature, long_1 = Long, wasm = null;
        try {
          wasm = new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0, 97, 115, 109, 1, 0, 0, 0, 1, 13, 2, 96, 0, 1, 127, 96, 4, 127, 127, 127, 127, 1, 127, 3, 7, 6, 0, 1, 1, 1, 1, 1, 6, 6, 1, 127, 1, 65, 0, 11, 7, 50, 6, 3, 109, 117, 108, 0, 1, 5, 100, 105, 118, 95, 115, 0, 2, 5, 100, 105, 118, 95, 117, 0, 3, 5, 114, 101, 109, 95, 115, 0, 4, 5, 114, 101, 109, 95, 117, 0, 5, 8, 103, 101, 116, 95, 104, 105, 103, 104, 0, 0, 10, 191, 1, 6, 4, 0, 35, 0, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 126, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 127, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 128, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 129, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 130, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11])), {}).exports;
        } catch (e) {
        }
        function Long(e, t2, r) {
          this.low = 0 | e, this.high = 0 | t2, this.unsigned = !!r;
        }
        function isLong(e) {
          return true === (e && e.__isLong__);
        }
        Long.prototype.__isLong__, Object.defineProperty(Long.prototype, "__isLong__", { value: true }), Long.isLong = isLong;
        var INT_CACHE = {}, UINT_CACHE = {};
        function fromInt(e, t2) {
          var r, i2, n;
          return t2 ? (n = 0 <= (e >>>= 0) && e < 256) && (i2 = UINT_CACHE[e]) ? i2 : (r = fromBits(e, (0 | e) < 0 ? -1 : 0, true), n && (UINT_CACHE[e] = r), r) : (n = -128 <= (e |= 0) && e < 128) && (i2 = INT_CACHE[e]) ? i2 : (r = fromBits(e, e < 0 ? -1 : 0, false), n && (INT_CACHE[e] = r), r);
        }
        function fromNumber(e, t2) {
          if (isNaN(e))
            return t2 ? UZERO : ZERO;
          if (t2) {
            if (e < 0)
              return UZERO;
            if (TWO_PWR_64_DBL <= e)
              return MAX_UNSIGNED_VALUE;
          } else {
            if (e <= -TWO_PWR_63_DBL)
              return MIN_VALUE;
            if (TWO_PWR_63_DBL <= e + 1)
              return MAX_VALUE;
          }
          return e < 0 ? fromNumber(-e, t2).neg() : fromBits(e % TWO_PWR_32_DBL | 0, e / TWO_PWR_32_DBL | 0, t2);
        }
        function fromBits(e, t2, r) {
          return new Long(e, t2, r);
        }
        Long.fromInt = fromInt, Long.fromNumber = fromNumber, Long.fromBits = fromBits;
        var pow_dbl = Math.pow;
        function fromString(e, t2, r) {
          if (0 === e.length)
            throw Error("empty string");
          if ("NaN" === e || "Infinity" === e || "+Infinity" === e || "-Infinity" === e)
            return ZERO;
          if (t2 = "number" == typeof t2 ? (r = t2, false) : !!t2, (r = r || 10) < 2 || 36 < r)
            throw RangeError("radix");
          var i2;
          if (0 < (i2 = e.indexOf("-")))
            throw Error("interior hyphen");
          if (0 === i2)
            return fromString(e.substring(1), t2, r).neg();
          for (var n = fromNumber(pow_dbl(r, 8)), o = ZERO, a2 = 0; a2 < e.length; a2 += 8) {
            var s, l = Math.min(8, e.length - a2), u2 = parseInt(e.substring(a2, a2 + l), r);
            o = l < 8 ? (s = fromNumber(pow_dbl(r, l)), o.mul(s).add(fromNumber(u2))) : (o = o.mul(n)).add(fromNumber(u2));
          }
          return o.unsigned = t2, o;
        }
        function fromValue(e, t2) {
          return "number" == typeof e ? fromNumber(e, t2) : "string" == typeof e ? fromString(e, t2) : fromBits(e.low, e.high, "boolean" == typeof t2 ? t2 : e.unsigned);
        }
        Long.fromString = fromString, Long.fromValue = fromValue;
        var TWO_PWR_16_DBL = 65536, TWO_PWR_24_DBL = 1 << 24, TWO_PWR_32_DBL = TWO_PWR_16_DBL * TWO_PWR_16_DBL, TWO_PWR_64_DBL = TWO_PWR_32_DBL * TWO_PWR_32_DBL, TWO_PWR_63_DBL = TWO_PWR_64_DBL / 2, TWO_PWR_24 = fromInt(TWO_PWR_24_DBL), ZERO = fromInt(0);
        Long.ZERO = ZERO;
        var UZERO = fromInt(0, true);
        Long.UZERO = UZERO;
        var ONE = fromInt(1);
        Long.ONE = ONE;
        var UONE = fromInt(1, true);
        Long.UONE = UONE;
        var NEG_ONE = fromInt(-1);
        Long.NEG_ONE = NEG_ONE;
        var MAX_VALUE = fromBits(-1, 2147483647, false);
        Long.MAX_VALUE = MAX_VALUE;
        var MAX_UNSIGNED_VALUE = fromBits(-1, -1, true);
        Long.MAX_UNSIGNED_VALUE = MAX_UNSIGNED_VALUE;
        var MIN_VALUE = fromBits(0, -2147483648, false);
        Long.MIN_VALUE = MIN_VALUE;
        var LongPrototype = Long.prototype;
        LongPrototype.toInt = function() {
          return this.unsigned ? this.low >>> 0 : this.low;
        }, LongPrototype.toNumber = function() {
          return this.unsigned ? (this.high >>> 0) * TWO_PWR_32_DBL + (this.low >>> 0) : this.high * TWO_PWR_32_DBL + (this.low >>> 0);
        }, LongPrototype.toString = function(e) {
          if ((e = e || 10) < 2 || 36 < e)
            throw RangeError("radix");
          if (this.isZero())
            return "0";
          if (this.isNegative()) {
            if (this.eq(MIN_VALUE)) {
              var t2 = fromNumber(e), r = this.div(t2), i2 = r.mul(t2).sub(this);
              return r.toString(e) + i2.toInt().toString(e);
            }
            return "-" + this.neg().toString(e);
          }
          for (var n = fromNumber(pow_dbl(e, 6), this.unsigned), o = this, a2 = ""; ; ) {
            var s = o.div(n), l = (o.sub(s.mul(n)).toInt() >>> 0).toString(e);
            if ((o = s).isZero())
              return l + a2;
            for (; l.length < 6; )
              l = "0" + l;
            a2 = "" + l + a2;
          }
        }, LongPrototype.getHighBits = function() {
          return this.high;
        }, LongPrototype.getHighBitsUnsigned = function() {
          return this.high >>> 0;
        }, LongPrototype.getLowBits = function() {
          return this.low;
        }, LongPrototype.getLowBitsUnsigned = function() {
          return this.low >>> 0;
        }, LongPrototype.getNumBitsAbs = function() {
          if (this.isNegative())
            return this.eq(MIN_VALUE) ? 64 : this.neg().getNumBitsAbs();
          for (var e = 0 != this.high ? this.high : this.low, t2 = 31; 0 < t2 && 0 == (e & 1 << t2); t2--)
            ;
          return 0 != this.high ? t2 + 33 : t2 + 1;
        }, LongPrototype.isZero = function() {
          return 0 === this.high && 0 === this.low;
        }, LongPrototype.eqz = LongPrototype.isZero, LongPrototype.isNegative = function() {
          return !this.unsigned && this.high < 0;
        }, LongPrototype.isPositive = function() {
          return this.unsigned || 0 <= this.high;
        }, LongPrototype.isOdd = function() {
          return 1 == (1 & this.low);
        }, LongPrototype.isEven = function() {
          return 0 == (1 & this.low);
        }, LongPrototype.equals = function(e) {
          return isLong(e) || (e = fromValue(e)), (this.unsigned === e.unsigned || this.high >>> 31 != 1 || e.high >>> 31 != 1) && (this.high === e.high && this.low === e.low);
        }, LongPrototype.eq = LongPrototype.equals, LongPrototype.notEquals = function(e) {
          return !this.eq(e);
        }, LongPrototype.neq = LongPrototype.notEquals, LongPrototype.ne = LongPrototype.notEquals, LongPrototype.lessThan = function(e) {
          return this.comp(e) < 0;
        }, LongPrototype.lt = LongPrototype.lessThan, LongPrototype.lessThanOrEqual = function(e) {
          return this.comp(e) <= 0;
        }, LongPrototype.lte = LongPrototype.lessThanOrEqual, LongPrototype.le = LongPrototype.lessThanOrEqual, LongPrototype.greaterThan = function(e) {
          return 0 < this.comp(e);
        }, LongPrototype.gt = LongPrototype.greaterThan, LongPrototype.greaterThanOrEqual = function(e) {
          return 0 <= this.comp(e);
        }, LongPrototype.gte = LongPrototype.greaterThanOrEqual, LongPrototype.ge = LongPrototype.greaterThanOrEqual, LongPrototype.compare = function(e) {
          if (isLong(e) || (e = fromValue(e)), this.eq(e))
            return 0;
          var t2 = this.isNegative(), r = e.isNegative();
          return t2 && !r ? -1 : !t2 && r ? 1 : this.unsigned ? e.high >>> 0 > this.high >>> 0 || e.high === this.high && e.low >>> 0 > this.low >>> 0 ? -1 : 1 : this.sub(e).isNegative() ? -1 : 1;
        }, LongPrototype.comp = LongPrototype.compare, LongPrototype.negate = function() {
          return !this.unsigned && this.eq(MIN_VALUE) ? MIN_VALUE : this.not().add(ONE);
        }, LongPrototype.neg = LongPrototype.negate, LongPrototype.add = function(e) {
          isLong(e) || (e = fromValue(e));
          var t2 = this.high >>> 16, r = 65535 & this.high, i2 = this.low >>> 16, n = 65535 & this.low, o = e.high >>> 16, a2 = 65535 & e.high, s = e.low >>> 16, l = 0, u2 = 0, c2 = 0, h = 0;
          return c2 += (h += n + (65535 & e.low)) >>> 16, u2 += (c2 += i2 + s) >>> 16, l += (u2 += r + a2) >>> 16, l += t2 + o, fromBits((c2 &= 65535) << 16 | (h &= 65535), (l &= 65535) << 16 | (u2 &= 65535), this.unsigned);
        }, LongPrototype.subtract = function(e) {
          return isLong(e) || (e = fromValue(e)), this.add(e.neg());
        }, LongPrototype.sub = LongPrototype.subtract, LongPrototype.multiply = function(e) {
          if (this.isZero())
            return ZERO;
          if (isLong(e) || (e = fromValue(e)), wasm)
            return fromBits(wasm.mul(this.low, this.high, e.low, e.high), wasm.get_high(), this.unsigned);
          if (e.isZero())
            return ZERO;
          if (this.eq(MIN_VALUE))
            return e.isOdd() ? MIN_VALUE : ZERO;
          if (e.eq(MIN_VALUE))
            return this.isOdd() ? MIN_VALUE : ZERO;
          if (this.isNegative())
            return e.isNegative() ? this.neg().mul(e.neg()) : this.neg().mul(e).neg();
          if (e.isNegative())
            return this.mul(e.neg()).neg();
          if (this.lt(TWO_PWR_24) && e.lt(TWO_PWR_24))
            return fromNumber(this.toNumber() * e.toNumber(), this.unsigned);
          var t2 = this.high >>> 16, r = 65535 & this.high, i2 = this.low >>> 16, n = 65535 & this.low, o = e.high >>> 16, a2 = 65535 & e.high, s = e.low >>> 16, l = 65535 & e.low, u2 = 0, c2 = 0, h = 0, f2 = 0;
          return h += (f2 += n * l) >>> 16, c2 += (h += i2 * l) >>> 16, h &= 65535, c2 += (h += n * s) >>> 16, u2 += (c2 += r * l) >>> 16, c2 &= 65535, u2 += (c2 += i2 * s) >>> 16, c2 &= 65535, u2 += (c2 += n * a2) >>> 16, u2 += t2 * l + r * s + i2 * a2 + n * o, fromBits((h &= 65535) << 16 | (f2 &= 65535), (u2 &= 65535) << 16 | (c2 &= 65535), this.unsigned);
        }, LongPrototype.mul = LongPrototype.multiply, LongPrototype.divide = function(e) {
          if (isLong(e) || (e = fromValue(e)), e.isZero())
            throw Error("division by zero");
          var t2, r, i2;
          if (wasm)
            return this.unsigned || -2147483648 !== this.high || -1 !== e.low || -1 !== e.high ? fromBits((this.unsigned ? wasm.div_u : wasm.div_s)(this.low, this.high, e.low, e.high), wasm.get_high(), this.unsigned) : this;
          if (this.isZero())
            return this.unsigned ? UZERO : ZERO;
          if (this.unsigned) {
            if (e.unsigned || (e = e.toUnsigned()), e.gt(this))
              return UZERO;
            if (e.gt(this.shru(1)))
              return UONE;
            r = UZERO;
          } else {
            if (this.eq(MIN_VALUE))
              return e.eq(ONE) || e.eq(NEG_ONE) ? MIN_VALUE : e.eq(MIN_VALUE) ? ONE : (i2 = this.shr(1).div(e).shl(1)).eq(ZERO) ? e.isNegative() ? ONE : NEG_ONE : (t2 = this.sub(e.mul(i2)), r = i2.add(t2.div(e)));
            else if (e.eq(MIN_VALUE))
              return this.unsigned ? UZERO : ZERO;
            if (this.isNegative())
              return e.isNegative() ? this.neg().div(e.neg()) : this.neg().div(e).neg();
            if (e.isNegative())
              return this.div(e.neg()).neg();
            r = ZERO;
          }
          for (t2 = this; t2.gte(e); ) {
            i2 = Math.max(1, Math.floor(t2.toNumber() / e.toNumber()));
            for (var n = Math.ceil(Math.log(i2) / Math.LN2), o = n <= 48 ? 1 : pow_dbl(2, n - 48), a2 = fromNumber(i2), s = a2.mul(e); s.isNegative() || s.gt(t2); )
              s = (a2 = fromNumber(i2 -= o, this.unsigned)).mul(e);
            a2.isZero() && (a2 = ONE), r = r.add(a2), t2 = t2.sub(s);
          }
          return r;
        }, LongPrototype.div = LongPrototype.divide, LongPrototype.modulo = function(e) {
          return isLong(e) || (e = fromValue(e)), wasm ? fromBits((this.unsigned ? wasm.rem_u : wasm.rem_s)(this.low, this.high, e.low, e.high), wasm.get_high(), this.unsigned) : this.sub(this.div(e).mul(e));
        }, LongPrototype.mod = LongPrototype.modulo, LongPrototype.rem = LongPrototype.modulo, LongPrototype.not = function() {
          return fromBits(~this.low, ~this.high, this.unsigned);
        }, LongPrototype.and = function(e) {
          return isLong(e) || (e = fromValue(e)), fromBits(this.low & e.low, this.high & e.high, this.unsigned);
        }, LongPrototype.or = function(e) {
          return isLong(e) || (e = fromValue(e)), fromBits(this.low | e.low, this.high | e.high, this.unsigned);
        }, LongPrototype.xor = function(e) {
          return isLong(e) || (e = fromValue(e)), fromBits(this.low ^ e.low, this.high ^ e.high, this.unsigned);
        }, LongPrototype.shiftLeft = function(e) {
          return isLong(e) && (e = e.toInt()), 0 == (e &= 63) ? this : e < 32 ? fromBits(this.low << e, this.high << e | this.low >>> 32 - e, this.unsigned) : fromBits(0, this.low << e - 32, this.unsigned);
        }, LongPrototype.shl = LongPrototype.shiftLeft, LongPrototype.shiftRight = function(e) {
          return isLong(e) && (e = e.toInt()), 0 == (e &= 63) ? this : e < 32 ? fromBits(this.low >>> e | this.high << 32 - e, this.high >> e, this.unsigned) : fromBits(this.high >> e - 32, 0 <= this.high ? 0 : -1, this.unsigned);
        }, LongPrototype.shr = LongPrototype.shiftRight, LongPrototype.shiftRightUnsigned = function(e) {
          if (isLong(e) && (e = e.toInt()), 0 === (e &= 63))
            return this;
          var t2 = this.high;
          return e < 32 ? fromBits(this.low >>> e | t2 << 32 - e, t2 >>> e, this.unsigned) : fromBits(32 === e ? t2 : t2 >>> e - 32, 0, this.unsigned);
        }, LongPrototype.shru = LongPrototype.shiftRightUnsigned, LongPrototype.shr_u = LongPrototype.shiftRightUnsigned, LongPrototype.toSigned = function() {
          return this.unsigned ? fromBits(this.low, this.high, false) : this;
        }, LongPrototype.toUnsigned = function() {
          return this.unsigned ? this : fromBits(this.low, this.high, true);
        }, LongPrototype.toBytes = function(e) {
          return e ? this.toBytesLE() : this.toBytesBE();
        }, LongPrototype.toBytesLE = function() {
          var e = this.high, t2 = this.low;
          return [255 & t2, t2 >>> 8 & 255, t2 >>> 16 & 255, t2 >>> 24, 255 & e, e >>> 8 & 255, e >>> 16 & 255, e >>> 24];
        }, LongPrototype.toBytesBE = function() {
          var e = this.high, t2 = this.low;
          return [e >>> 24, e >>> 16 & 255, e >>> 8 & 255, 255 & e, t2 >>> 24, t2 >>> 16 & 255, t2 >>> 8 & 255, 255 & t2];
        }, Long.fromBytes = function(e, t2, r) {
          return r ? Long.fromBytesLE(e, t2) : Long.fromBytesBE(e, t2);
        }, Long.fromBytesLE = function(e, t2) {
          return new Long(e[0] | e[1] << 8 | e[2] << 16 | e[3] << 24, e[4] | e[5] << 8 | e[6] << 16 | e[7] << 24, t2);
        }, Long.fromBytesBE = function(e, t2) {
          return new Long(e[4] << 24 | e[5] << 16 | e[6] << 8 | e[7], e[0] << 24 | e[1] << 16 | e[2] << 8 | e[3], t2);
        };
        var aspromise = asPromise;
        function asPromise(e, t2) {
          for (var r = new Array(arguments.length - 1), o = 0, i2 = 2, a2 = true; i2 < arguments.length; )
            r[o++] = arguments[i2++];
          return new Promise(function(i3, n) {
            r[o] = function(e2) {
              if (a2)
                if (a2 = false, e2)
                  n(e2);
                else {
                  for (var t3 = new Array(arguments.length - 1), r2 = 0; r2 < t3.length; )
                    t3[r2++] = arguments[r2];
                  i3.apply(null, t3);
                }
            };
            try {
              e.apply(t2 || null, r);
            } catch (e2) {
              a2 && (a2 = false, n(e2));
            }
          });
        }
        var base64_1 = createCommonjsModule(function(e, t2) {
          var r = t2;
          r.length = function(e2) {
            var t3 = e2.length;
            if (!t3)
              return 0;
            for (var r2 = 0; 1 < --t3 % 4 && "=" === e2.charAt(t3); )
              ++r2;
            return Math.ceil(3 * e2.length) / 4 - r2;
          };
          for (var u2 = new Array(64), l = new Array(123), i2 = 0; i2 < 64; )
            l[u2[i2] = i2 < 26 ? i2 + 65 : i2 < 52 ? i2 + 71 : i2 < 62 ? i2 - 4 : i2 - 59 | 43] = i2++;
          r.encode = function(e2, t3, r2) {
            for (var i3, n = null, o = [], a2 = 0, s = 0; t3 < r2; ) {
              var l2 = e2[t3++];
              switch (s) {
                case 0:
                  o[a2++] = u2[l2 >> 2], i3 = (3 & l2) << 4, s = 1;
                  break;
                case 1:
                  o[a2++] = u2[i3 | l2 >> 4], i3 = (15 & l2) << 2, s = 2;
                  break;
                case 2:
                  o[a2++] = u2[i3 | l2 >> 6], o[a2++] = u2[63 & l2], s = 0;
              }
              8191 < a2 && ((n = n || []).push(String.fromCharCode.apply(String, o)), a2 = 0);
            }
            return s && (o[a2++] = u2[i3], o[a2++] = 61, 1 === s && (o[a2++] = 61)), n ? (a2 && n.push(String.fromCharCode.apply(String, o.slice(0, a2))), n.join("")) : String.fromCharCode.apply(String, o.slice(0, a2));
          };
          var c2 = "invalid encoding";
          r.decode = function(e2, t3, r2) {
            for (var i3, n = r2, o = 0, a2 = 0; a2 < e2.length; ) {
              var s = e2.charCodeAt(a2++);
              if (61 === s && 1 < o)
                break;
              if (void 0 === (s = l[s]))
                throw Error(c2);
              switch (o) {
                case 0:
                  i3 = s, o = 1;
                  break;
                case 1:
                  t3[r2++] = i3 << 2 | (48 & s) >> 4, i3 = s, o = 2;
                  break;
                case 2:
                  t3[r2++] = (15 & i3) << 4 | (60 & s) >> 2, i3 = s, o = 3;
                  break;
                case 3:
                  t3[r2++] = (3 & i3) << 6 | s, o = 0;
              }
            }
            if (1 === o)
              throw Error(c2);
            return r2 - n;
          }, r.test = function(e2) {
            return /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e2);
          };
        }), eventemitter = EventEmitter;
        function EventEmitter() {
          this._listeners = {};
        }
        EventEmitter.prototype.on = function(e, t2, r) {
          return (this._listeners[e] || (this._listeners[e] = [])).push({ fn: t2, ctx: r || this }), this;
        }, EventEmitter.prototype.off = function(e, t2) {
          if (void 0 === e)
            this._listeners = {};
          else if (void 0 === t2)
            this._listeners[e] = [];
          else
            for (var r = this._listeners[e], i2 = 0; i2 < r.length; )
              r[i2].fn === t2 ? r.splice(i2, 1) : ++i2;
          return this;
        }, EventEmitter.prototype.emit = function(e) {
          var t2 = this._listeners[e];
          if (t2) {
            for (var r = [], i2 = 1; i2 < arguments.length; )
              r.push(arguments[i2++]);
            for (i2 = 0; i2 < t2.length; )
              t2[i2].fn.apply(t2[i2++].ctx, r);
          }
          return this;
        };
        var float_1 = factory(factory);
        function factory(e) {
          function t2(e2, t3, r2, i3) {
            var n2, o2 = t3 < 0 ? 1 : 0;
            o2 && (t3 = -t3), 0 === t3 ? e2(0 < 1 / t3 ? 0 : 2147483648, r2, i3) : isNaN(t3) ? e2(2143289344, r2, i3) : e2(34028234663852886e22 < t3 ? (o2 << 31 | 2139095040) >>> 0 : t3 < 11754943508222875e-54 ? (o2 << 31 | Math.round(t3 / 1401298464324817e-60)) >>> 0 : (o2 << 31 | (n2 = Math.floor(Math.log(t3) / Math.LN2)) + 127 << 23 | 8388607 & Math.round(t3 * Math.pow(2, -n2) * 8388608)) >>> 0, r2, i3);
          }
          function r(e2, t3, r2) {
            var i3 = e2(t3, r2), n2 = 2 * (i3 >> 31) + 1, o2 = i3 >>> 23 & 255, a3 = 8388607 & i3;
            return 255 == o2 ? a3 ? NaN : 1 / 0 * n2 : 0 == o2 ? 1401298464324817e-60 * n2 * a3 : n2 * Math.pow(2, o2 - 150) * (8388608 + a3);
          }
          function i2(e2, t3, r2) {
            s[0] = e2, t3[r2] = l[0], t3[r2 + 1] = l[1], t3[r2 + 2] = l[2], t3[r2 + 3] = l[3];
          }
          function n(e2, t3, r2) {
            s[0] = e2, t3[r2] = l[3], t3[r2 + 1] = l[2], t3[r2 + 2] = l[1], t3[r2 + 3] = l[0];
          }
          function o(e2, t3) {
            return l[0] = e2[t3], l[1] = e2[t3 + 1], l[2] = e2[t3 + 2], l[3] = e2[t3 + 3], s[0];
          }
          function a2(e2, t3) {
            return l[3] = e2[t3], l[2] = e2[t3 + 1], l[1] = e2[t3 + 2], l[0] = e2[t3 + 3], s[0];
          }
          var s, l, u2, c2, h, f2;
          function d(e2, t3, r2, i3, n2, o2) {
            var a3, s2, l2 = i3 < 0 ? 1 : 0;
            l2 && (i3 = -i3), 0 === i3 ? (e2(0, n2, o2 + t3), e2(0 < 1 / i3 ? 0 : 2147483648, n2, o2 + r2)) : isNaN(i3) ? (e2(0, n2, o2 + t3), e2(2146959360, n2, o2 + r2)) : 17976931348623157e292 < i3 ? (e2(0, n2, o2 + t3), e2((l2 << 31 | 2146435072) >>> 0, n2, o2 + r2)) : i3 < 22250738585072014e-324 ? (e2((a3 = i3 / 5e-324) >>> 0, n2, o2 + t3), e2((l2 << 31 | a3 / 4294967296) >>> 0, n2, o2 + r2)) : (1024 === (s2 = Math.floor(Math.log(i3) / Math.LN2)) && (s2 = 1023), e2(4503599627370496 * (a3 = i3 * Math.pow(2, -s2)) >>> 0, n2, o2 + t3), e2((l2 << 31 | s2 + 1023 << 20 | 1048576 * a3 & 1048575) >>> 0, n2, o2 + r2));
          }
          function _(e2, t3, r2, i3, n2) {
            var o2 = e2(i3, n2 + t3), a3 = e2(i3, n2 + r2), s2 = 2 * (a3 >> 31) + 1, l2 = a3 >>> 20 & 2047, u3 = 4294967296 * (1048575 & a3) + o2;
            return 2047 == l2 ? u3 ? NaN : 1 / 0 * s2 : 0 == l2 ? 5e-324 * s2 * u3 : s2 * Math.pow(2, l2 - 1075) * (u3 + 4503599627370496);
          }
          function p2(e2, t3, r2) {
            c2[0] = e2, t3[r2] = h[0], t3[r2 + 1] = h[1], t3[r2 + 2] = h[2], t3[r2 + 3] = h[3], t3[r2 + 4] = h[4], t3[r2 + 5] = h[5], t3[r2 + 6] = h[6], t3[r2 + 7] = h[7];
          }
          function g(e2, t3, r2) {
            c2[0] = e2, t3[r2] = h[7], t3[r2 + 1] = h[6], t3[r2 + 2] = h[5], t3[r2 + 3] = h[4], t3[r2 + 4] = h[3], t3[r2 + 5] = h[2], t3[r2 + 6] = h[1], t3[r2 + 7] = h[0];
          }
          function m(e2, t3) {
            return h[0] = e2[t3], h[1] = e2[t3 + 1], h[2] = e2[t3 + 2], h[3] = e2[t3 + 3], h[4] = e2[t3 + 4], h[5] = e2[t3 + 5], h[6] = e2[t3 + 6], h[7] = e2[t3 + 7], c2[0];
          }
          function y(e2, t3) {
            return h[7] = e2[t3], h[6] = e2[t3 + 1], h[5] = e2[t3 + 2], h[4] = e2[t3 + 3], h[3] = e2[t3 + 4], h[2] = e2[t3 + 5], h[1] = e2[t3 + 6], h[0] = e2[t3 + 7], c2[0];
          }
          return "undefined" != typeof Float32Array ? (s = new Float32Array([-0]), l = new Uint8Array(s.buffer), u2 = 128 === l[3], e.writeFloatLE = u2 ? i2 : n, e.writeFloatBE = u2 ? n : i2, e.readFloatLE = u2 ? o : a2, e.readFloatBE = u2 ? a2 : o) : (e.writeFloatLE = t2.bind(null, writeUintLE), e.writeFloatBE = t2.bind(null, writeUintBE), e.readFloatLE = r.bind(null, readUintLE), e.readFloatBE = r.bind(null, readUintBE)), "undefined" != typeof Float64Array ? (c2 = new Float64Array([-0]), h = new Uint8Array(c2.buffer), f2 = 128 === h[7], e.writeDoubleLE = f2 ? p2 : g, e.writeDoubleBE = f2 ? g : p2, e.readDoubleLE = f2 ? m : y, e.readDoubleBE = f2 ? y : m) : (e.writeDoubleLE = d.bind(null, writeUintLE, 0, 4), e.writeDoubleBE = d.bind(null, writeUintBE, 4, 0), e.readDoubleLE = _.bind(null, readUintLE, 0, 4), e.readDoubleBE = _.bind(null, readUintBE, 4, 0)), e;
        }
        function writeUintLE(e, t2, r) {
          t2[r] = 255 & e, t2[r + 1] = e >>> 8 & 255, t2[r + 2] = e >>> 16 & 255, t2[r + 3] = e >>> 24;
        }
        function writeUintBE(e, t2, r) {
          t2[r] = e >>> 24, t2[r + 1] = e >>> 16 & 255, t2[r + 2] = e >>> 8 & 255, t2[r + 3] = 255 & e;
        }
        function readUintLE(e, t2) {
          return (e[t2] | e[t2 + 1] << 8 | e[t2 + 2] << 16 | e[t2 + 3] << 24) >>> 0;
        }
        function readUintBE(e, t2) {
          return (e[t2] << 24 | e[t2 + 1] << 16 | e[t2 + 2] << 8 | e[t2 + 3]) >>> 0;
        }
        var inquire_1 = inquire;
        function inquire(moduleName) {
          try {
            var mod = eval("quire".replace(/^/, "re"))(moduleName);
            if (mod && (mod.length || Object.keys(mod).length))
              return mod;
          } catch (e) {
          }
          return null;
        }
        var utf8_1 = createCommonjsModule(function(e, t2) {
          var r = t2;
          r.length = function(e2) {
            for (var t3 = 0, r2 = 0, i2 = 0; i2 < e2.length; ++i2)
              (r2 = e2.charCodeAt(i2)) < 128 ? t3 += 1 : r2 < 2048 ? t3 += 2 : 55296 == (64512 & r2) && 56320 == (64512 & e2.charCodeAt(i2 + 1)) ? (++i2, t3 += 4) : t3 += 3;
            return t3;
          }, r.read = function(e2, t3, r2) {
            if (r2 - t3 < 1)
              return "";
            for (var i2, n = null, o = [], a2 = 0; t3 < r2; )
              (i2 = e2[t3++]) < 128 ? o[a2++] = i2 : 191 < i2 && i2 < 224 ? o[a2++] = (31 & i2) << 6 | 63 & e2[t3++] : 239 < i2 && i2 < 365 ? (i2 = ((7 & i2) << 18 | (63 & e2[t3++]) << 12 | (63 & e2[t3++]) << 6 | 63 & e2[t3++]) - 65536, o[a2++] = 55296 + (i2 >> 10), o[a2++] = 56320 + (1023 & i2)) : o[a2++] = (15 & i2) << 12 | (63 & e2[t3++]) << 6 | 63 & e2[t3++], 8191 < a2 && ((n = n || []).push(String.fromCharCode.apply(String, o)), a2 = 0);
            return n ? (a2 && n.push(String.fromCharCode.apply(String, o.slice(0, a2))), n.join("")) : String.fromCharCode.apply(String, o.slice(0, a2));
          }, r.write = function(e2, t3, r2) {
            for (var i2, n, o = r2, a2 = 0; a2 < e2.length; ++a2)
              (i2 = e2.charCodeAt(a2)) < 128 ? t3[r2++] = i2 : (i2 < 2048 ? t3[r2++] = i2 >> 6 | 192 : (55296 == (64512 & i2) && 56320 == (64512 & (n = e2.charCodeAt(a2 + 1))) ? (i2 = 65536 + ((1023 & i2) << 10) + (1023 & n), ++a2, t3[r2++] = i2 >> 18 | 240, t3[r2++] = i2 >> 12 & 63 | 128) : t3[r2++] = i2 >> 12 | 224, t3[r2++] = i2 >> 6 & 63 | 128), t3[r2++] = 63 & i2 | 128);
            return r2 - o;
          };
        }), pool_1 = pool;
        function pool(r, i2, e) {
          var n = e || 8192, o = n >>> 1, a2 = null, s = n;
          return function(e2) {
            if (e2 < 1 || o < e2)
              return r(e2);
            n < s + e2 && (a2 = r(n), s = 0);
            var t2 = i2.call(a2, s, s += e2);
            return 7 & s && (s = 1 + (7 | s)), t2;
          };
        }
        var longbits = LongBits;
        function LongBits(e, t2) {
          this.lo = e >>> 0, this.hi = t2 >>> 0;
        }
        var zero = LongBits.zero = new LongBits(0, 0);
        zero.toNumber = function() {
          return 0;
        }, zero.zzEncode = zero.zzDecode = function() {
          return this;
        }, zero.length = function() {
          return 1;
        };
        var zeroHash = LongBits.zeroHash = "\0\0\0\0\0\0\0\0";
        LongBits.fromNumber = function(e) {
          if (0 === e)
            return zero;
          var t2 = e < 0;
          t2 && (e = -e);
          var r = e >>> 0, i2 = (e - r) / 4294967296 >>> 0;
          return t2 && (i2 = ~i2 >>> 0, r = ~r >>> 0, 4294967295 < ++r && (r = 0, 4294967295 < ++i2 && (i2 = 0))), new LongBits(r, i2);
        }, LongBits.from = function(e) {
          if ("number" == typeof e)
            return LongBits.fromNumber(e);
          if (minimal.isString(e)) {
            if (!minimal.Long)
              return LongBits.fromNumber(parseInt(e, 10));
            e = minimal.Long.fromString(e);
          }
          return e.low || e.high ? new LongBits(e.low >>> 0, e.high >>> 0) : zero;
        }, LongBits.prototype.toNumber = function(e) {
          if (!e && this.hi >>> 31) {
            var t2 = 1 + ~this.lo >>> 0, r = ~this.hi >>> 0;
            return t2 || (r = r + 1 >>> 0), -(t2 + 4294967296 * r);
          }
          return this.lo + 4294967296 * this.hi;
        }, LongBits.prototype.toLong = function(e) {
          return minimal.Long ? new minimal.Long(0 | this.lo, 0 | this.hi, Boolean(e)) : { low: 0 | this.lo, high: 0 | this.hi, unsigned: Boolean(e) };
        };
        var charCodeAt = String.prototype.charCodeAt;
        LongBits.fromHash = function(e) {
          return e === zeroHash ? zero : new LongBits((charCodeAt.call(e, 0) | charCodeAt.call(e, 1) << 8 | charCodeAt.call(e, 2) << 16 | charCodeAt.call(e, 3) << 24) >>> 0, (charCodeAt.call(e, 4) | charCodeAt.call(e, 5) << 8 | charCodeAt.call(e, 6) << 16 | charCodeAt.call(e, 7) << 24) >>> 0);
        }, LongBits.prototype.toHash = function() {
          return String.fromCharCode(255 & this.lo, this.lo >>> 8 & 255, this.lo >>> 16 & 255, this.lo >>> 24, 255 & this.hi, this.hi >>> 8 & 255, this.hi >>> 16 & 255, this.hi >>> 24);
        }, LongBits.prototype.zzEncode = function() {
          var e = this.hi >> 31;
          return this.hi = ((this.hi << 1 | this.lo >>> 31) ^ e) >>> 0, this.lo = (this.lo << 1 ^ e) >>> 0, this;
        }, LongBits.prototype.zzDecode = function() {
          var e = -(1 & this.lo);
          return this.lo = ((this.lo >>> 1 | this.hi << 31) ^ e) >>> 0, this.hi = (this.hi >>> 1 ^ e) >>> 0, this;
        }, LongBits.prototype.length = function() {
          var e = this.lo, t2 = (this.lo >>> 28 | this.hi << 4) >>> 0, r = this.hi >>> 24;
          return 0 == r ? 0 == t2 ? e < 16384 ? e < 128 ? 1 : 2 : e < 2097152 ? 3 : 4 : t2 < 16384 ? t2 < 128 ? 5 : 6 : t2 < 2097152 ? 7 : 8 : r < 128 ? 9 : 10;
        };
        var minimal = createCommonjsModule(function(e, t2) {
          var i2 = t2;
          function n(e2, t3, r2) {
            for (var i3 = Object.keys(t3), n2 = 0; n2 < i3.length; ++n2)
              void 0 !== e2[i3[n2]] && r2 || (e2[i3[n2]] = t3[i3[n2]]);
            return e2;
          }
          function r(e2) {
            function r2(e3, t3) {
              if (!(this instanceof r2))
                return new r2(e3, t3);
              Object.defineProperty(this, "message", { get: function() {
                return e3;
              } }), Error.captureStackTrace ? Error.captureStackTrace(this, r2) : Object.defineProperty(this, "stack", { value: new Error().stack || "" }), t3 && n(this, t3);
            }
            return (r2.prototype = Object.create(Error.prototype)).constructor = r2, Object.defineProperty(r2.prototype, "name", { get: function() {
              return e2;
            } }), r2.prototype.toString = function() {
              return this.name + ": " + this.message;
            }, r2;
          }
          i2.asPromise = aspromise, i2.base64 = base64_1, i2.EventEmitter = eventemitter, i2.float = float_1, i2.inquire = inquire_1, i2.utf8 = utf8_1, i2.pool = pool_1, i2.LongBits = longbits, i2.isNode = Boolean(void 0 !== commonjsGlobal && commonjsGlobal && commonjsGlobal.process && commonjsGlobal.process.versions && commonjsGlobal.process.versions.node), i2.global = i2.isNode && commonjsGlobal || "undefined" != typeof window && window || "undefined" != typeof self && self || commonjsGlobal, i2.emptyArray = Object.freeze ? Object.freeze([]) : [], i2.emptyObject = Object.freeze ? Object.freeze({}) : {}, i2.isInteger = Number.isInteger || function(e2) {
            return "number" == typeof e2 && isFinite(e2) && Math.floor(e2) === e2;
          }, i2.isString = function(e2) {
            return "string" == typeof e2 || e2 instanceof String;
          }, i2.isObject = function(e2) {
            return e2 && "object" == typeof e2;
          }, i2.isset = i2.isSet = function(e2, t3) {
            var r2 = e2[t3];
            return !(null == r2 || !e2.hasOwnProperty(t3)) && ("object" != typeof r2 || 0 < (Array.isArray(r2) ? r2.length : Object.keys(r2).length));
          }, i2.Buffer = function() {
            try {
              var e2 = i2.inquire("buffer").Buffer;
              return e2.prototype.utf8Write ? e2 : null;
            } catch (e3) {
              return null;
            }
          }(), i2._Buffer_from = null, i2._Buffer_allocUnsafe = null, i2.newBuffer = function(e2) {
            return "number" == typeof e2 ? i2.Buffer ? i2._Buffer_allocUnsafe(e2) : new i2.Array(e2) : i2.Buffer ? i2._Buffer_from(e2) : "undefined" == typeof Uint8Array ? e2 : new Uint8Array(e2);
          }, i2.Array = "undefined" != typeof Uint8Array ? Uint8Array : Array, i2.Long = i2.global.dcodeIO && i2.global.dcodeIO.Long || i2.global.Long || i2.inquire("long"), i2.key2Re = /^true|false|0|1$/, i2.key32Re = /^-?(?:0|[1-9][0-9]*)$/, i2.key64Re = /^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/, i2.longToHash = function(e2) {
            return e2 ? i2.LongBits.from(e2).toHash() : i2.LongBits.zeroHash;
          }, i2.longFromHash = function(e2, t3) {
            var r2 = i2.LongBits.fromHash(e2);
            return i2.Long ? i2.Long.fromBits(r2.lo, r2.hi, t3) : r2.toNumber(Boolean(t3));
          }, i2.merge = n, i2.lcFirst = function(e2) {
            return e2.charAt(0).toLowerCase() + e2.substring(1);
          }, i2.newError = r, i2.ProtocolError = r("ProtocolError"), i2.oneOfGetter = function(e2) {
            for (var r2 = {}, t3 = 0; t3 < e2.length; ++t3)
              r2[e2[t3]] = 1;
            return function() {
              for (var e3 = Object.keys(this), t4 = e3.length - 1; -1 < t4; --t4)
                if (1 === r2[e3[t4]] && void 0 !== this[e3[t4]] && null !== this[e3[t4]])
                  return e3[t4];
            };
          }, i2.oneOfSetter = function(r2) {
            return function(e2) {
              for (var t3 = 0; t3 < r2.length; ++t3)
                r2[t3] !== e2 && delete this[r2[t3]];
            };
          }, i2.toJSONOptions = { longs: String, enums: String, bytes: String, json: true }, i2._configure = function() {
            var r2 = i2.Buffer;
            r2 ? (i2._Buffer_from = r2.from !== Uint8Array.from && r2.from || function(e2, t3) {
              return new r2(e2, t3);
            }, i2._Buffer_allocUnsafe = r2.allocUnsafe || function(e2) {
              return new r2(e2);
            }) : i2._Buffer_from = i2._Buffer_allocUnsafe = null;
          };
        }), writer = Writer, BufferWriter, LongBits$1 = minimal.LongBits, base64 = minimal.base64, utf8 = minimal.utf8;
        function Op(e, t2, r) {
          this.fn = e, this.len = t2, this.next = void 0, this.val = r;
        }
        function noop() {
        }
        function State(e) {
          this.head = e.head, this.tail = e.tail, this.len = e.len, this.next = e.states;
        }
        function Writer() {
          this.len = 0, this.head = new Op(noop, 0, 0), this.tail = this.head, this.states = null;
        }
        var create = function() {
          return minimal.Buffer ? function() {
            return (Writer.create = function() {
              return new BufferWriter();
            })();
          } : function() {
            return new Writer();
          };
        };
        function writeByte(e, t2, r) {
          t2[r] = 255 & e;
        }
        function writeVarint32(e, t2, r) {
          for (; 127 < e; )
            t2[r++] = 127 & e | 128, e >>>= 7;
          t2[r] = e;
        }
        function VarintOp(e, t2) {
          this.len = e, this.next = void 0, this.val = t2;
        }
        function writeVarint64(e, t2, r) {
          for (; e.hi; )
            t2[r++] = 127 & e.lo | 128, e.lo = (e.lo >>> 7 | e.hi << 25) >>> 0, e.hi >>>= 7;
          for (; 127 < e.lo; )
            t2[r++] = 127 & e.lo | 128, e.lo = e.lo >>> 7;
          t2[r++] = e.lo;
        }
        function writeFixed32(e, t2, r) {
          t2[r] = 255 & e, t2[r + 1] = e >>> 8 & 255, t2[r + 2] = e >>> 16 & 255, t2[r + 3] = e >>> 24;
        }
        Writer.create = create(), Writer.alloc = function(e) {
          return new minimal.Array(e);
        }, minimal.Array !== Array && (Writer.alloc = minimal.pool(Writer.alloc, minimal.Array.prototype.subarray)), Writer.prototype._push = function(e, t2, r) {
          return this.tail = this.tail.next = new Op(e, t2, r), this.len += t2, this;
        }, VarintOp.prototype = Object.create(Op.prototype), VarintOp.prototype.fn = writeVarint32, Writer.prototype.uint32 = function(e) {
          return this.len += (this.tail = this.tail.next = new VarintOp((e >>>= 0) < 128 ? 1 : e < 16384 ? 2 : e < 2097152 ? 3 : e < 268435456 ? 4 : 5, e)).len, this;
        }, Writer.prototype.int32 = function(e) {
          return e < 0 ? this._push(writeVarint64, 10, LongBits$1.fromNumber(e)) : this.uint32(e);
        }, Writer.prototype.sint32 = function(e) {
          return this.uint32((e << 1 ^ e >> 31) >>> 0);
        }, Writer.prototype.uint64 = function(e) {
          var t2 = LongBits$1.from(e);
          return this._push(writeVarint64, t2.length(), t2);
        }, Writer.prototype.int64 = Writer.prototype.uint64, Writer.prototype.sint64 = function(e) {
          var t2 = LongBits$1.from(e).zzEncode();
          return this._push(writeVarint64, t2.length(), t2);
        }, Writer.prototype.bool = function(e) {
          return this._push(writeByte, 1, e ? 1 : 0);
        }, Writer.prototype.fixed32 = function(e) {
          return this._push(writeFixed32, 4, e >>> 0);
        }, Writer.prototype.sfixed32 = Writer.prototype.fixed32, Writer.prototype.fixed64 = function(e) {
          var t2 = LongBits$1.from(e);
          return this._push(writeFixed32, 4, t2.lo)._push(writeFixed32, 4, t2.hi);
        }, Writer.prototype.sfixed64 = Writer.prototype.fixed64, Writer.prototype.float = function(e) {
          return this._push(minimal.float.writeFloatLE, 4, e);
        }, Writer.prototype.double = function(e) {
          return this._push(minimal.float.writeDoubleLE, 8, e);
        };
        var writeBytes = minimal.Array.prototype.set ? function(e, t2, r) {
          t2.set(e, r);
        } : function(e, t2, r) {
          for (var i2 = 0; i2 < e.length; ++i2)
            t2[r + i2] = e[i2];
        };
        Writer.prototype.bytes = function(e) {
          var t2, r = e.length >>> 0;
          return r ? (minimal.isString(e) && (t2 = Writer.alloc(r = base64.length(e)), base64.decode(e, t2, 0), e = t2), this.uint32(r)._push(writeBytes, r, e)) : this._push(writeByte, 1, 0);
        }, Writer.prototype.string = function(e) {
          var t2 = utf8.length(e);
          return t2 ? this.uint32(t2)._push(utf8.write, t2, e) : this._push(writeByte, 1, 0);
        }, Writer.prototype.fork = function() {
          return this.states = new State(this), this.head = this.tail = new Op(noop, 0, 0), this.len = 0, this;
        }, Writer.prototype.reset = function() {
          return this.states ? (this.head = this.states.head, this.tail = this.states.tail, this.len = this.states.len, this.states = this.states.next) : (this.head = this.tail = new Op(noop, 0, 0), this.len = 0), this;
        }, Writer.prototype.ldelim = function() {
          var e = this.head, t2 = this.tail, r = this.len;
          return this.reset().uint32(r), r && (this.tail.next = e.next, this.tail = t2, this.len += r), this;
        }, Writer.prototype.finish = function() {
          for (var e = this.head.next, t2 = this.constructor.alloc(this.len), r = 0; e; )
            e.fn(e.val, t2, r), r += e.len, e = e.next;
          return t2;
        }, Writer._configure = function(e) {
          BufferWriter = e, Writer.create = create(), BufferWriter._configure();
        };
        var writer_buffer = BufferWriter$1;
        function BufferWriter$1() {
          writer.call(this);
        }
        function writeStringBuffer(e, t2, r) {
          e.length < 40 ? minimal.utf8.write(e, t2, r) : t2.utf8Write ? t2.utf8Write(e, r) : t2.write(e, r);
        }
        (BufferWriter$1.prototype = Object.create(writer.prototype)).constructor = BufferWriter$1, BufferWriter$1._configure = function() {
          BufferWriter$1.alloc = minimal._Buffer_allocUnsafe, BufferWriter$1.writeBytesBuffer = minimal.Buffer && minimal.Buffer.prototype instanceof Uint8Array && "set" === minimal.Buffer.prototype.set.name ? function(e, t2, r) {
            t2.set(e, r);
          } : function(e, t2, r) {
            if (e.copy)
              e.copy(t2, r, 0, e.length);
            else
              for (var i2 = 0; i2 < e.length; )
                t2[r++] = e[i2++];
          };
        }, BufferWriter$1.prototype.bytes = function(e) {
          minimal.isString(e) && (e = minimal._Buffer_from(e, "base64"));
          var t2 = e.length >>> 0;
          return this.uint32(t2), t2 && this._push(BufferWriter$1.writeBytesBuffer, t2, e), this;
        }, BufferWriter$1.prototype.string = function(e) {
          var t2 = minimal.Buffer.byteLength(e);
          return this.uint32(t2), t2 && this._push(writeStringBuffer, t2, e), this;
        }, BufferWriter$1._configure();
        var reader = Reader, BufferReader, LongBits$2 = minimal.LongBits, utf8$1 = minimal.utf8;
        function indexOutOfRange(e, t2) {
          return RangeError("index out of range: " + e.pos + " + " + (t2 || 1) + " > " + e.len);
        }
        function Reader(e) {
          this.buf = e, this.pos = 0, this.len = e.length;
        }
        var create_array = "undefined" != typeof Uint8Array ? function(e) {
          if (e instanceof Uint8Array || Array.isArray(e))
            return new Reader(e);
          throw Error("illegal buffer");
        } : function(e) {
          if (Array.isArray(e))
            return new Reader(e);
          throw Error("illegal buffer");
        }, create$1 = function() {
          return minimal.Buffer ? function(e) {
            return (Reader.create = function(e2) {
              return minimal.Buffer.isBuffer(e2) ? new BufferReader(e2) : create_array(e2);
            })(e);
          } : create_array;
        }, fU;
        function readLongVarint() {
          var e = new LongBits$2(0, 0), t2 = 0;
          if (!(4 < this.len - this.pos)) {
            for (; t2 < 3; ++t2) {
              if (this.pos >= this.len)
                throw indexOutOfRange(this);
              if (e.lo = (e.lo | (127 & this.buf[this.pos]) << 7 * t2) >>> 0, this.buf[this.pos++] < 128)
                return e;
            }
            return e.lo = (e.lo | (127 & this.buf[this.pos++]) << 7 * t2) >>> 0, e;
          }
          for (; t2 < 4; ++t2)
            if (e.lo = (e.lo | (127 & this.buf[this.pos]) << 7 * t2) >>> 0, this.buf[this.pos++] < 128)
              return e;
          if (e.lo = (e.lo | (127 & this.buf[this.pos]) << 28) >>> 0, e.hi = (e.hi | (127 & this.buf[this.pos]) >> 4) >>> 0, this.buf[this.pos++] < 128)
            return e;
          if (t2 = 0, 4 < this.len - this.pos) {
            for (; t2 < 5; ++t2)
              if (e.hi = (e.hi | (127 & this.buf[this.pos]) << 7 * t2 + 3) >>> 0, this.buf[this.pos++] < 128)
                return e;
          } else
            for (; t2 < 5; ++t2) {
              if (this.pos >= this.len)
                throw indexOutOfRange(this);
              if (e.hi = (e.hi | (127 & this.buf[this.pos]) << 7 * t2 + 3) >>> 0, this.buf[this.pos++] < 128)
                return e;
            }
          throw Error("invalid varint encoding");
        }
        function readFixed32_end(e, t2) {
          return (e[t2 - 4] | e[t2 - 3] << 8 | e[t2 - 2] << 16 | e[t2 - 1] << 24) >>> 0;
        }
        function readFixed64() {
          if (this.pos + 8 > this.len)
            throw indexOutOfRange(this, 8);
          return new LongBits$2(readFixed32_end(this.buf, this.pos += 4), readFixed32_end(this.buf, this.pos += 4));
        }
        Reader.create = create$1(), Reader.prototype._slice = minimal.Array.prototype.subarray || minimal.Array.prototype.slice, Reader.prototype.uint32 = (fU = 4294967295, function() {
          if (fU = (127 & this.buf[this.pos]) >>> 0, this.buf[this.pos++] < 128)
            return fU;
          if (fU = (fU | (127 & this.buf[this.pos]) << 7) >>> 0, this.buf[this.pos++] < 128)
            return fU;
          if (fU = (fU | (127 & this.buf[this.pos]) << 14) >>> 0, this.buf[this.pos++] < 128)
            return fU;
          if (fU = (fU | (127 & this.buf[this.pos]) << 21) >>> 0, this.buf[this.pos++] < 128)
            return fU;
          if (fU = (fU | (15 & this.buf[this.pos]) << 28) >>> 0, this.buf[this.pos++] < 128)
            return fU;
          if ((this.pos += 5) > this.len)
            throw this.pos = this.len, indexOutOfRange(this, 10);
          return fU;
        }), Reader.prototype.int32 = function() {
          return 0 | this.uint32();
        }, Reader.prototype.sint32 = function() {
          var e = this.uint32();
          return e >>> 1 ^ -(1 & e) | 0;
        }, Reader.prototype.bool = function() {
          return 0 !== this.uint32();
        }, Reader.prototype.fixed32 = function() {
          if (this.pos + 4 > this.len)
            throw indexOutOfRange(this, 4);
          return readFixed32_end(this.buf, this.pos += 4);
        }, Reader.prototype.sfixed32 = function() {
          if (this.pos + 4 > this.len)
            throw indexOutOfRange(this, 4);
          return 0 | readFixed32_end(this.buf, this.pos += 4);
        }, Reader.prototype.float = function() {
          if (this.pos + 4 > this.len)
            throw indexOutOfRange(this, 4);
          var e = minimal.float.readFloatLE(this.buf, this.pos);
          return this.pos += 4, e;
        }, Reader.prototype.double = function() {
          if (this.pos + 8 > this.len)
            throw indexOutOfRange(this, 4);
          var e = minimal.float.readDoubleLE(this.buf, this.pos);
          return this.pos += 8, e;
        }, Reader.prototype.bytes = function() {
          var e = this.uint32(), t2 = this.pos, r = this.pos + e;
          if (r > this.len)
            throw indexOutOfRange(this, e);
          return this.pos += e, Array.isArray(this.buf) ? this.buf.slice(t2, r) : t2 === r ? new this.buf.constructor(0) : this._slice.call(this.buf, t2, r);
        }, Reader.prototype.string = function() {
          var e = this.bytes();
          return utf8$1.read(e, 0, e.length);
        }, Reader.prototype.skip = function(e) {
          if ("number" == typeof e) {
            if (this.pos + e > this.len)
              throw indexOutOfRange(this, e);
            this.pos += e;
          } else
            do {
              if (this.pos >= this.len)
                throw indexOutOfRange(this);
            } while (128 & this.buf[this.pos++]);
          return this;
        }, Reader.prototype.skipType = function(e) {
          switch (e) {
            case 0:
              this.skip();
              break;
            case 1:
              this.skip(8);
              break;
            case 2:
              this.skip(this.uint32());
              break;
            case 3:
              for (; 4 != (e = 7 & this.uint32()); )
                this.skipType(e);
              break;
            case 5:
              this.skip(4);
              break;
            default:
              throw Error("invalid wire type " + e + " at offset " + this.pos);
          }
          return this;
        }, Reader._configure = function(e) {
          BufferReader = e, Reader.create = create$1(), BufferReader._configure();
          var t2 = minimal.Long ? "toLong" : "toNumber";
          minimal.merge(Reader.prototype, { int64: function() {
            return readLongVarint.call(this)[t2](false);
          }, uint64: function() {
            return readLongVarint.call(this)[t2](true);
          }, sint64: function() {
            return readLongVarint.call(this).zzDecode()[t2](false);
          }, fixed64: function() {
            return readFixed64.call(this)[t2](true);
          }, sfixed64: function() {
            return readFixed64.call(this)[t2](false);
          } });
        };
        var reader_buffer = BufferReader$1;
        function BufferReader$1(e) {
          reader.call(this, e);
        }
        (BufferReader$1.prototype = Object.create(reader.prototype)).constructor = BufferReader$1, BufferReader$1._configure = function() {
          minimal.Buffer && (BufferReader$1.prototype._slice = minimal.Buffer.prototype.slice);
        }, BufferReader$1.prototype.string = function() {
          var e = this.uint32();
          return this.buf.utf8Slice ? this.buf.utf8Slice(this.pos, this.pos = Math.min(this.pos + e, this.len)) : this.buf.toString("utf-8", this.pos, this.pos = Math.min(this.pos + e, this.len));
        }, BufferReader$1._configure();
        var service = Service;
        function Service(e, t2, r) {
          if ("function" != typeof e)
            throw TypeError("rpcImpl must be a function");
          minimal.EventEmitter.call(this), this.rpcImpl = e, this.requestDelimited = Boolean(t2), this.responseDelimited = Boolean(r);
        }
        (Service.prototype = Object.create(minimal.EventEmitter.prototype)).constructor = Service, Service.prototype.rpcCall = function e(r, t2, i2, n, o) {
          if (!n)
            throw TypeError("request must be specified");
          var a2 = this;
          if (!o)
            return minimal.asPromise(e, a2, r, t2, i2, n);
          if (a2.rpcImpl)
            try {
              return a2.rpcImpl(r, t2[a2.requestDelimited ? "encodeDelimited" : "encode"](n).finish(), function(e2, t3) {
                if (e2)
                  return a2.emit("error", e2, r), o(e2);
                if (null !== t3) {
                  if (!(t3 instanceof i2))
                    try {
                      t3 = i2[a2.responseDelimited ? "decodeDelimited" : "decode"](t3);
                    } catch (e3) {
                      return a2.emit("error", e3, r), o(e3);
                    }
                  return a2.emit("data", t3, r), o(null, t3);
                }
                a2.end(true);
              });
            } catch (e2) {
              return a2.emit("error", e2, r), void setTimeout(function() {
                o(e2);
              }, 0);
            }
          else
            setTimeout(function() {
              o(Error("already ended"));
            }, 0);
        }, Service.prototype.end = function(e) {
          return this.rpcImpl && (e || this.rpcImpl(null, null, null), this.rpcImpl = null, this.emit("end").off()), this;
        };
        var rpc_1 = createCommonjsModule(function(e, t2) {
          t2.Service = service;
        }), roots = {}, indexMinimal = createCommonjsModule(function(e, t2) {
          var r = t2;
          function i2() {
            r.util._configure(), r.Writer._configure(r.BufferWriter), r.Reader._configure(r.BufferReader);
          }
          r.build = "minimal", r.Writer = writer, r.BufferWriter = writer_buffer, r.Reader = reader, r.BufferReader = reader_buffer, r.util = minimal, r.rpc = rpc_1, r.roots = roots, (r.configure = i2)();
        }), minimal$1 = indexMinimal;
        minimal$1.util.Long = long_1, minimal$1.configure(), VectorTileFeature$1.prototype.loadGeometry = function(e) {
          var t2 = this._pbf;
          t2.pos = this._geometry;
          for (var r, i2, n = t2.readVarint() + t2.pos, o = 1, a2 = 0, s = 0, l = 0, u2 = []; t2.pos < n; ) {
            if (a2 <= 0 && (o = 7 & (i2 = t2.readVarint()), a2 = i2 >> 3), a2--, 1 === o || 2 === o)
              s += t2.readSVarint(), l += t2.readSVarint(), 1 === o && (r && u2.push(r), r = []), r.push([s * e, l * e]);
            else {
              if (7 !== o)
                throw new Error("unknown command " + o);
              r && r.push(r[0].slice());
            }
          }
          return r && u2.push(r), u2;
        };
        var MAX_SAFE_INTEGER = long_1.fromNumber(Number.MAX_SAFE_INTEGER, true), MIN_SAFE_INTEGER = long_1.fromNumber(Number.MIN_SAFE_INTEGER, false);
        function readLong(e, t2, r) {
          t2.pos = e.pos;
          var i2 = r.call(t2);
          return e.pos = t2.pos, long_1.isLong(i2) ? 0 < i2.comp(MAX_SAFE_INTEGER) || i2.comp(MIN_SAFE_INTEGER) < 0 ? i2.toString() : i2.toNumber() : i2;
        }
        var VectorTileLayer = function() {
          function r(e, t2) {
            _classCallCheck(this, r), this.version = 1, this.name = null, this.extent = 4096, this.length = 0, this._pbf = e, this._keys = [], this._values = [], this._features = [], this._protobufjsReader = minimal$1.Reader.create(e.buf), e.readFields(readLayer, this, t2), this.length = this._features.length;
          }
          return _createClass(r, [{ key: "feature", value: function(e) {
            if (e < 0 || e >= this._features.length)
              throw new Error("feature index out of bounds");
            this._pbf.pos = this._features[e];
            var t2 = this._pbf.readVarint() + this._pbf.pos;
            return new VectorTileFeature$1(this._pbf, t2, this.extent, this._keys, this._values);
          } }]), r;
        }();
        function readLayer(e, t2, r) {
          15 === e ? t2.version = r.readVarint() : 1 === e ? t2.name = r.readString() : 5 === e ? t2.extent = r.readVarint() : 2 === e ? t2._features.push(r.pos) : 3 === e ? t2._keys.push(r.readString()) : 4 === e && t2._values.push(readValueMessage(r, t2._protobufjsReader));
        }
        function readValueMessage(e, t2) {
          for (var r = null, i2 = e.readVarint() + e.pos; e.pos < i2; )
            var n = e.readVarint() >> 3, r = 1 == n ? e.readString() : 2 == n ? e.readFloat() : 3 == n ? e.readDouble() : 4 == n ? readLong(e, t2, t2.int64) : 5 == n ? readLong(e, t2, t2.uint64) : 6 == n ? readLong(e, t2, t2.sint64) : 7 == n ? e.readBoolean() : null;
          return r;
        }
        var VectorTile = function e(t2, r) {
          _classCallCheck(this, e), this.layers = t2.readFields(readTile, {}, r);
        };
        function readTile(e, t2, r) {
          var i2;
          3 !== e || (i2 = new VectorTileLayer(r, r.readVarint() + r.pos)).length && (t2[i2.name] = i2);
        }
        function getLayersFromMVT(e) {
          var t2 = {};
          for (var r in e.layers) {
            for (var i2 = e.layers[r], n = [], o = Geo$1.tile_scale / i2.extent, a2 = 0, s = i2.length; a2 < s; a2++) {
              var l = i2.feature(a2), u2 = VectorTileFeature$1.types[l.type], c2 = l.loadGeometry(o), h = null;
              switch (u2) {
                case "Point":
                  h = decodePoint({ coordinates: c2 });
                  break;
                case "LineString":
                  h = 1 === c2.length ? { type: u2, coordinates: c2[0] } : { type: "MultiLineString", coordinates: c2 };
                  break;
                case "Polygon":
                  h = decodeMultiPolygon({ coordinates: c2 });
              }
              h && h.coordinates && n.push({ type: "Feature", geometry: h, properties: l.properties });
            }
            t2[r] = { type: "FeatureCollection", features: n };
          }
          return t2;
        }
        var GeomType = { UNKNOWN: 0, POINT: 1, LINESTRING: 2, POLYGON: 3 };
        function parseGeoJSONVectorTile(e) {
          var t2 = [], r = e && e.features;
          if (r)
            for (var i2 = 0, n = r.length; i2 < n; i2++) {
              var o = r[i2], a2 = o.type, s = void 0;
              switch (a2) {
                case GeomType.POINT:
                  s = { type: "MultiPoint", coordinates: o.geometry.map(function(e2) {
                    return e2.slice();
                  }) };
                  break;
                case GeomType.LINESTRING:
                case GeomType.POLYGON:
                  if (s = { type: "MultiLineString", coordinates: o.geometry.map(function(e2) {
                    return e2.map(function(e3) {
                      return e3.slice();
                    });
                  }) }, a2 === GeomType.POLYGON && null == (s = decodeMultiPolygon(s)))
                    continue;
                  break;
                default:
                  continue;
              }
              t2.push({ id: o.id, type: "Feature", geometry: s, properties: o.tags });
            }
          return { type: "FeatureCollection", features: t2 };
        }
        function decodeMultiPolygon(e) {
          for (var t2, r = [], i2 = [], n = 0, o = e.coordinates.length; n < o; n++) {
            var a2 = e.coordinates[n], s = Geo$1.ringWinding(a2);
            null != s && (s === (t2 = t2 || s) && i2.length && (r.push(i2), i2 = []), i2.push(a2));
          }
          return 0 < i2.length && r.push(i2), 1 === r.length ? (e.type = "Polygon", e.coordinates = r[0]) : 1 < r.length ? (e.type = "MultiPolygon", e.coordinates = r) : e = null, e;
        }
        function decodePoint(e) {
          var t2 = e.coordinates.length;
          if (1 < t2) {
            e.type = "MultiPoint";
            for (var r = [], i2 = 0; i2 < t2; i2++)
              r.push(e.coordinates[i2][0]);
            e.coordinates = r;
          } else
            e.type = "Point", e.coordinates = e.coordinates[0][0];
          return e;
        }
        var EMPTY_FEATURE_COLLECTION = { type: "FeatureCollection", features: [] }, MVTSource = function() {
          _inherits(i2, MapsJsSource);
          var r = _createSuper(i2);
          function i2(e, t2) {
            return _classCallCheck(this, i2), e.tiled = true, r.call(this, e, t2);
          }
          return _createClass(i2, [{ key: "fetchTile", value: function(e, t2, r2) {
            return this.provider ? this.provider.requestTileAsPromise(e, t2, r2).then(function(e2) {
              return e2.data;
            }) : Promise.resolve();
          } }, { key: "_load", value: function(r2) {
            var i3 = this, e = Geo$1.wrapTile(r2.coords, { x: true, y: true }), t2 = e.x, n = e.y, o = e.z;
            return WorkerBroker.postMessage(this.target_name + ".fetchTile", t2, n, o).then(function(e2) {
              var t3;
              return e2 instanceof ArrayBuffer ? (t3 = new pbf(new Uint8Array(e2)), r2.source_data.layers = getLayersFromMVT(new VectorTile(t3))) : e2 ? r2.source_data.error = e2 : r2.source_data.layers = { _default: EMPTY_FEATURE_COLLECTION }, i3._postProcessTile(r2), r2;
            });
          } }, { key: "onReady", value: function() {
            this.dispatchUpdate();
          } }]), i2;
        }();
        DataSource.register(MVTSource, "MVT"), DataSource.register(MVTSource, "OMV");
        var csscolorparser = createCommonjsModule(function(e, t2) {
          var d = { transparent: [0, 0, 0, 0], aliceblue: [240, 248, 255, 1], antiquewhite: [250, 235, 215, 1], aqua: [0, 255, 255, 1], aquamarine: [127, 255, 212, 1], azure: [240, 255, 255, 1], beige: [245, 245, 220, 1], bisque: [255, 228, 196, 1], black: [0, 0, 0, 1], blanchedalmond: [255, 235, 205, 1], blue: [0, 0, 255, 1], blueviolet: [138, 43, 226, 1], brown: [165, 42, 42, 1], burlywood: [222, 184, 135, 1], cadetblue: [95, 158, 160, 1], chartreuse: [127, 255, 0, 1], chocolate: [210, 105, 30, 1], coral: [255, 127, 80, 1], cornflowerblue: [100, 149, 237, 1], cornsilk: [255, 248, 220, 1], crimson: [220, 20, 60, 1], cyan: [0, 255, 255, 1], darkblue: [0, 0, 139, 1], darkcyan: [0, 139, 139, 1], darkgoldenrod: [184, 134, 11, 1], darkgray: [169, 169, 169, 1], darkgreen: [0, 100, 0, 1], darkgrey: [169, 169, 169, 1], darkkhaki: [189, 183, 107, 1], darkmagenta: [139, 0, 139, 1], darkolivegreen: [85, 107, 47, 1], darkorange: [255, 140, 0, 1], darkorchid: [153, 50, 204, 1], darkred: [139, 0, 0, 1], darksalmon: [233, 150, 122, 1], darkseagreen: [143, 188, 143, 1], darkslateblue: [72, 61, 139, 1], darkslategray: [47, 79, 79, 1], darkslategrey: [47, 79, 79, 1], darkturquoise: [0, 206, 209, 1], darkviolet: [148, 0, 211, 1], deeppink: [255, 20, 147, 1], deepskyblue: [0, 191, 255, 1], dimgray: [105, 105, 105, 1], dimgrey: [105, 105, 105, 1], dodgerblue: [30, 144, 255, 1], firebrick: [178, 34, 34, 1], floralwhite: [255, 250, 240, 1], forestgreen: [34, 139, 34, 1], fuchsia: [255, 0, 255, 1], gainsboro: [220, 220, 220, 1], ghostwhite: [248, 248, 255, 1], gold: [255, 215, 0, 1], goldenrod: [218, 165, 32, 1], gray: [128, 128, 128, 1], green: [0, 128, 0, 1], greenyellow: [173, 255, 47, 1], grey: [128, 128, 128, 1], honeydew: [240, 255, 240, 1], hotpink: [255, 105, 180, 1], indianred: [205, 92, 92, 1], indigo: [75, 0, 130, 1], ivory: [255, 255, 240, 1], khaki: [240, 230, 140, 1], lavender: [230, 230, 250, 1], lavenderblush: [255, 240, 245, 1], lawngreen: [124, 252, 0, 1], lemonchiffon: [255, 250, 205, 1], lightblue: [173, 216, 230, 1], lightcoral: [240, 128, 128, 1], lightcyan: [224, 255, 255, 1], lightgoldenrodyellow: [250, 250, 210, 1], lightgray: [211, 211, 211, 1], lightgreen: [144, 238, 144, 1], lightgrey: [211, 211, 211, 1], lightpink: [255, 182, 193, 1], lightsalmon: [255, 160, 122, 1], lightseagreen: [32, 178, 170, 1], lightskyblue: [135, 206, 250, 1], lightslategray: [119, 136, 153, 1], lightslategrey: [119, 136, 153, 1], lightsteelblue: [176, 196, 222, 1], lightyellow: [255, 255, 224, 1], lime: [0, 255, 0, 1], limegreen: [50, 205, 50, 1], linen: [250, 240, 230, 1], magenta: [255, 0, 255, 1], maroon: [128, 0, 0, 1], mediumaquamarine: [102, 205, 170, 1], mediumblue: [0, 0, 205, 1], mediumorchid: [186, 85, 211, 1], mediumpurple: [147, 112, 219, 1], mediumseagreen: [60, 179, 113, 1], mediumslateblue: [123, 104, 238, 1], mediumspringgreen: [0, 250, 154, 1], mediumturquoise: [72, 209, 204, 1], mediumvioletred: [199, 21, 133, 1], midnightblue: [25, 25, 112, 1], mintcream: [245, 255, 250, 1], mistyrose: [255, 228, 225, 1], moccasin: [255, 228, 181, 1], navajowhite: [255, 222, 173, 1], navy: [0, 0, 128, 1], oldlace: [253, 245, 230, 1], olive: [128, 128, 0, 1], olivedrab: [107, 142, 35, 1], orange: [255, 165, 0, 1], orangered: [255, 69, 0, 1], orchid: [218, 112, 214, 1], palegoldenrod: [238, 232, 170, 1], palegreen: [152, 251, 152, 1], paleturquoise: [175, 238, 238, 1], palevioletred: [219, 112, 147, 1], papayawhip: [255, 239, 213, 1], peachpuff: [255, 218, 185, 1], peru: [205, 133, 63, 1], pink: [255, 192, 203, 1], plum: [221, 160, 221, 1], powderblue: [176, 224, 230, 1], purple: [128, 0, 128, 1], rebeccapurple: [102, 51, 153, 1], red: [255, 0, 0, 1], rosybrown: [188, 143, 143, 1], royalblue: [65, 105, 225, 1], saddlebrown: [139, 69, 19, 1], salmon: [250, 128, 114, 1], sandybrown: [244, 164, 96, 1], seagreen: [46, 139, 87, 1], seashell: [255, 245, 238, 1], sienna: [160, 82, 45, 1], silver: [192, 192, 192, 1], skyblue: [135, 206, 235, 1], slateblue: [106, 90, 205, 1], slategray: [112, 128, 144, 1], slategrey: [112, 128, 144, 1], snow: [255, 250, 250, 1], springgreen: [0, 255, 127, 1], steelblue: [70, 130, 180, 1], tan: [210, 180, 140, 1], teal: [0, 128, 128, 1], thistle: [216, 191, 216, 1], tomato: [255, 99, 71, 1], turquoise: [64, 224, 208, 1], violet: [238, 130, 238, 1], wheat: [245, 222, 179, 1], white: [255, 255, 255, 1], whitesmoke: [245, 245, 245, 1], yellow: [255, 255, 0, 1], yellowgreen: [154, 205, 50, 1] };
          function _(e2) {
            return (e2 = Math.round(e2)) < 0 ? 0 : 255 < e2 ? 255 : e2;
          }
          function r(e2) {
            return e2 < 0 ? 0 : 1 < e2 ? 1 : e2;
          }
          function p2(e2) {
            return "%" === e2[e2.length - 1] ? _(parseFloat(e2) / 100 * 255) : _(parseInt(e2));
          }
          function g(e2) {
            return "%" === e2[e2.length - 1] ? r(parseFloat(e2) / 100) : r(parseFloat(e2));
          }
          function m(e2, t3, r2) {
            return r2 < 0 ? r2 += 1 : 1 < r2 && --r2, 6 * r2 < 1 ? e2 + (t3 - e2) * r2 * 6 : 2 * r2 < 1 ? t3 : 3 * r2 < 2 ? e2 + (t3 - e2) * (2 / 3 - r2) * 6 : e2;
          }
          try {
            t2.parseCSSColor = function(e2) {
              var t3, r2 = e2.replace(/ /g, "").toLowerCase();
              if (r2 in d)
                return d[r2].slice();
              if ("#" === r2[0])
                return 4 === r2.length ? 0 <= (t3 = parseInt(r2.substr(1), 16)) && t3 <= 4095 ? [(3840 & t3) >> 4 | (3840 & t3) >> 8, 240 & t3 | (240 & t3) >> 4, 15 & t3 | (15 & t3) << 4, 1] : null : 7 === r2.length && 0 <= (t3 = parseInt(r2.substr(1), 16)) && t3 <= 16777215 ? [(16711680 & t3) >> 16, (65280 & t3) >> 8, 255 & t3, 1] : null;
              var i2 = r2.indexOf("("), n = r2.indexOf(")");
              if (-1 !== i2 && n + 1 === r2.length) {
                var o = r2.substr(0, i2), a2 = r2.substr(i2 + 1, n - (i2 + 1)).split(","), s = 1;
                switch (o) {
                  case "rgba":
                    if (4 !== a2.length)
                      return null;
                    s = g(a2.pop());
                  case "rgb":
                    return 3 !== a2.length ? null : [p2(a2[0]), p2(a2[1]), p2(a2[2]), s];
                  case "hsla":
                    if (4 !== a2.length)
                      return null;
                    s = g(a2.pop());
                  case "hsl":
                    if (3 !== a2.length)
                      return null;
                    var l = (parseFloat(a2[0]) % 360 + 360) % 360 / 360, u2 = g(a2[1]), c2 = g(a2[2]), h = c2 <= 0.5 ? c2 * (u2 + 1) : c2 + u2 - c2 * u2, f2 = 2 * c2 - h;
                    return [_(255 * m(f2, h, l + 1 / 3)), _(255 * m(f2, h, l)), _(255 * m(f2, h, l - 1 / 3)), s];
                  default:
                    return null;
                }
              }
              return null;
            };
          } catch (e2) {
          }
        }), csscolorparser_1 = csscolorparser.parseCSSColor, StyleParser = {}, clampPositive = function(e) {
          return Math.max(e, 0);
        }, noNaN = function(e) {
          return isNaN(e) ? 0 : e;
        }, parseNumber = function(e) {
          return Array.isArray(e) ? e.map(parseFloat).map(noNaN) : noNaN(parseFloat(e));
        }, parsePositiveNumber = function(e) {
          return Array.isArray(e) ? e.map(parseNumber).map(clampPositive) : clampPositive(parseNumber(e));
        };
        Object.assign(StyleParser, { clampPositive, noNaN, parseNumber, parsePositiveNumber }), StyleParser.wrapFunction = function(e) {
          return "\n        var feature = context.feature.properties;\n        var global = context.global;\n        var $zoom = context.zoom;\n        var $layer = context.layer;\n        var $source = context.source;\n        var sources = context.sources;\n        var $geometry = context.geometry;\n        var $meters_per_pixel = context.meters_per_pixel;\n\n        var val = (function(){ ".concat(e, " }());\n\n        if (typeof val === 'number' && isNaN(val)) {\n            val = null; // convert NaNs to nulls\n        }\n\n        return val;\n    ");
        }, StyleParser.zeroPair = Object.freeze([0, 0]), StyleParser.defaults = { color: [1, 1, 1, 1], width: 1, size: 1, extrude: false, height: 20, min_height: 0, order: 0, z: 0, outline: { color: [0, 0, 0, 0], width: 0 }, material: { ambient: 1, diffuse: 1 } }, StyleParser.macros = { "Style.color.pseudoRandomColor": function() {
          return [parseInt(feature.id, 16) / 100 % 1 * 0.7, parseInt(feature.id, 16) / 1e4 % 1 * 0.7, parseInt(feature.id, 16) / 1e6 % 1 * 0.7, 1];
        }, "Style.color.randomColor": function() {
          return [0.7 * Math.random(), 0.7 * Math.random(), 0.7 * Math.random(), 1];
        } }, StyleParser.getFeatureParseContext = function(e, t2, r, i2) {
          return { feature: e, tile: t2, global: r, sources: i2, zoom: t2.style_zoom, geometry: Geo$1.geometryType(e.geometry.type), meters_per_pixel: t2.meters_per_pixel, meters_per_pixel_sq: t2.meters_per_pixel_sq, units_per_meter_overzoom: t2.units_per_meter_overzoom };
        };
        var CACHE_TYPE = { STATIC: 0, DYNAMIC: 1, ZOOM: 2 };
        StyleParser.CACHE_TYPE = CACHE_TYPE, StyleParser.createPropertyCache = function(e) {
          var r = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : null;
          if (null != e) {
            if (e.value)
              return { value: e.value, zoom: e.zoom ? {} : null, type: e.type };
            var t2 = { value: e, type: CACHE_TYPE.STATIC };
            return Array.isArray(t2.value) && Array.isArray(t2.value[0]) ? (t2.zoom = {}, t2.type = CACHE_TYPE.ZOOM) : "function" == typeof t2.value && (t2.type = CACHE_TYPE.DYNAMIC), "function" == typeof r && (t2.zoom ? t2.value = t2.value.map(function(e2, t3) {
              return [e2[0], r(e2[1], t3)];
            }) : "function" != typeof t2.value && (t2.value = r(t2.value, 0))), t2;
          }
        }, StyleParser.createColorPropertyCache = function(e) {
          return StyleParser.createPropertyCache(e, function(e2) {
            return "Style.color.pseudoRandomColor" === e2 ? Utils$1.stringToFunction(StyleParser.wrapFunction(StyleParser.macros["Style.color.pseudoRandomColor"])) : "Style.color.randomColor" === e2 ? StyleParser.macros["Style.color.randomColor"] : e2;
          });
        };
        var isPercent = function(e) {
          return "string" == typeof e && "%" === e[e.length - 1];
        }, isRatio = function(e) {
          return "auto" === e;
        }, isComputed = function(e) {
          return isPercent(e) || isRatio(e);
        }, dualRatioError = "'size' can specify either width or height as derived from aspect ratio, but not both";
        StyleParser.createPointSizePropertyCache = function(e) {
          var t2 = null, r = null;
          if (isPercent(e))
            t2 = [true];
          else if (Array.isArray(e)) {
            if (Array.isArray(e[0])) {
              if (e.some(function(e2) {
                return Array.isArray(e2[1]) ? e2[1].some(function(e3) {
                  return isComputed(e3);
                }) : isPercent(e2[1]);
              }) && (t2 = e.map(function(e2) {
                return Array.isArray(e2[1]) ? e2[1].map(function(e3) {
                  return isPercent(e3);
                }) : isPercent(e2[1]);
              }), (r = e.map(function(e2) {
                return Array.isArray(e2[1]) && e2[1].map(function(e3) {
                  return isRatio(e3);
                });
              })).some(function(e2) {
                return Array.isArray(e2) && e2.every(function(e3) {
                  return e3;
                });
              })))
                throw dualRatioError;
            } else if (e.some(isComputed) && (t2 = [e.map(isPercent)], (r = [e.map(isRatio)])[0].every(function(e2) {
              return e2;
            })))
              throw dualRatioError;
          }
          return t2 ? ((e = { value: e }).has_pct = t2, e.has_ratio = r, e.sprites = {}) : e = StyleParser.createPropertyCache(e, parsePositiveNumber), e;
        }, StyleParser.evalCachedPointSizeProperty = function(i2, n, e) {
          return i2.has_pct || i2.has_ratio ? n ? (i2.sprites[n.sprite] || (i2.sprites[n.sprite] = StyleParser.createPropertyCache(i2.value, function(t2, r) {
            return Array.isArray(t2) ? (t2 = t2.map(function(e2, t3) {
              return i2.has_ratio[r][t3] ? e2 : parsePositiveNumber(e2);
            }).map(function(e2, t3) {
              return i2.has_pct[r][t3] ? n.css_size[t3] * e2 / 100 : e2;
            }), i2.has_ratio[r][0] ? t2[0] = t2[1] * n.aspect : i2.has_ratio[r][1] && (t2[1] = t2[0] / n.aspect)) : (t2 = parsePositiveNumber(t2), t2 = i2.has_pct[r] ? n.css_size.map(function(e2) {
              return e2 * t2 / 100;
            }) : [t2, t2]), t2;
          })), StyleParser.evalCachedProperty(i2.sprites[n.sprite], e)) : void 0 : StyleParser.evalCachedProperty(i2, e);
        }, StyleParser.evalCachedProperty = function(e, t2) {
          if (null != e)
            return e.dynamic ? e.dynamic(t2) : e.static ? e.static : e.zoom && e.zoom[t2.zoom] ? e.zoom[t2.zoom] : "function" != typeof e.value ? Array.isArray(e.value) && Array.isArray(e.value[0]) ? (e.zoom = e.zoom || {}, e.zoom[t2.zoom] = Utils$1.interpolate(t2.zoom, e.value), e.zoom[t2.zoom]) : (e.static = e.value, e.static) : (e.dynamic = e.value, e.dynamic(t2));
        }, StyleParser.convertUnits = function(e, t2) {
          if (null != e.val)
            return "px" === e.units ? e.val * Geo$1.metersPerPixel(t2.zoom) : e.val;
          if ("string" == typeof e)
            "px" === e.trim().slice(-2) ? (e = parseNumber(e), e *= Geo$1.metersPerPixel(t2.zoom)) : e = parseNumber(e);
          else if (Array.isArray(e))
            return Array.isArray(e[0]) ? e.map(function(e2) {
              return [e2[0], StyleParser.convertUnits(e2[1], t2)];
            }) : e.map(function(e2) {
              return StyleParser.convertUnits(e2, t2);
            });
          return e;
        }, StyleParser.parseUnits = function(e) {
          var t2 = { val: parseNumber(e) };
          return 0 !== t2.val && "string" == typeof e && "px" === e.trim().slice(-2) && (t2.units = "px"), t2;
        }, StyleParser.evalCachedDistanceProperty = function(e, t2) {
          return e.dynamic ? e.dynamic(t2) : e.zoom && e.zoom[t2.zoom] ? e.zoom[t2.zoom] : "function" != typeof e.value ? e.zoom ? (e.zoom[t2.zoom] = Utils$1.interpolate(t2.zoom, e.value, function(e2) {
            return StyleParser.convertUnits(e2, t2);
          }), e.zoom[t2.zoom]) : StyleParser.convertUnits(e.value, t2) : (e.dynamic = e.value, e.dynamic(t2));
        }, StyleParser.string_colors = {}, StyleParser.colorForString = function(e) {
          if (StyleParser.string_colors[e])
            return StyleParser.string_colors[e];
          var t2 = null;
          return "none" !== e && ((t2 = csscolorparser.parseCSSColor(e)) && 4 === t2.length ? (t2[0] /= 255, t2[1] /= 255, t2[2] /= 255) : t2 = StyleParser.defaults.color), StyleParser.string_colors[e] = t2;
        }, StyleParser.evalCachedColorProperty = function(e) {
          var t2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {};
          if (e.dynamic) {
            var r = e.dynamic(t2);
            return "string" == typeof r && (r = StyleParser.colorForString(r)), r && null == r[3] && (r[3] = 1), r;
          }
          if (e.static)
            return e.static;
          if (e.zoom && e.zoom[t2.zoom])
            return e.zoom[t2.zoom];
          if ("function" == typeof e.value) {
            e.dynamic = e.value;
            var i2 = e.dynamic(t2);
            return "string" == typeof i2 && (i2 = StyleParser.colorForString(i2)), i2 && null == i2[3] && (i2[3] = 1), i2;
          }
          if ("string" == typeof e.value)
            return e.static = StyleParser.colorForString(e.value), e.static;
          if (e.zoom) {
            if (!e.zoom_preprocessed) {
              for (var n = 0; n < e.value.length; n++) {
                var o = e.value[n];
                o && "string" == typeof o[1] && (o[1] = StyleParser.colorForString(o[1]));
              }
              e.zoom_preprocessed = true;
            }
            return e.zoom[t2.zoom] = Utils$1.interpolate(t2.zoom, e.value), e.zoom[t2.zoom][3] = e.zoom[t2.zoom][3] || 1, e.zoom[t2.zoom];
          }
          return e.static = e.value.map(function(e2) {
            return e2;
          }), e.static && null == e.static[3] && (e.static[3] = 1), e.static;
        }, StyleParser.parseColor = function(e) {
          var t2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {};
          if ("function" == typeof e && (e = e(t2)), "string" == typeof e)
            e = StyleParser.colorForString(e);
          else if (Array.isArray(e) && Array.isArray(e[0])) {
            for (var r = 0; r < e.length; r++) {
              var i2 = e[r];
              "string" == typeof i2[1] && (i2[1] = StyleParser.colorForString(i2[1]));
            }
            t2.zoom && (e = Utils$1.interpolate(t2.zoom, e));
          }
          return Array.isArray(e) ? null == (e = e.map(function(e2) {
            return e2;
          }))[3] && (e[3] = 1) : e = [0, 0, 0, 1], e;
        }, StyleParser.calculateOrder = function(e, t2) {
          return "function" == typeof e ? e = e(t2) : "string" == typeof e && (e = t2.feature.properties[e] ? t2.feature.properties[e] : parsePositiveNumber(e)), e;
        }, StyleParser.evalProperty = function(e, t2) {
          return "function" == typeof e ? e(t2) : e;
        };
        var RepeatGroup = function() {
          function i2(e, t2) {
            _classCallCheck(this, i2), this.key = e, this.repeat_dist = t2, this.repeat_dist_sq = this.repeat_dist * this.repeat_dist, this.positions = [];
          }
          return _createClass(i2, [{ key: "check", value: function(e) {
            for (var t2 = e.position, r = 0; r < this.positions.length; r++) {
              var i3 = this.positions[r], n = t2[0] - i3[0], o = t2[1] - i3[1], a2 = n * n + o * o;
              if (a2 < this.repeat_dist_sq)
                return { dist_sq: a2, repeat_dist_sq: this.repeat_dist_sq };
            }
          } }, { key: "add", value: function(e) {
            e && e.position && this.positions.push(e.position);
          } }], [{ key: "clear", value: function(e) {
            this.groups[e] = {};
          } }, { key: "check", value: function(e, t2, r) {
            if (t2.repeat_distance && t2.repeat_group && this.groups[r][t2.repeat_group])
              return this.groups[r][t2.repeat_group].check(e);
          } }, { key: "add", value: function(e, t2, r) {
            t2.repeat_distance && t2.repeat_group && (null == this.groups[r][t2.repeat_group] && (this.groups[r][t2.repeat_group] = new i2(t2.repeat_group, t2.repeat_distance * t2.repeat_scale)), this.groups[r][t2.repeat_group].add(e));
          } }]), i2;
        }();
        RepeatGroup.groups = {};
        var GridIndex = function() {
          function a2(e, t2, r) {
            _classCallCheck(this, a2);
            var i2 = this.boxCells = [], n = this.circleCells = [];
            this.xCellCount = Math.ceil(e / r), this.yCellCount = Math.ceil(t2 / r);
            for (var o = 0; o < this.xCellCount * this.yCellCount; o++)
              i2.push([]), n.push([]);
            this.circleKeys = [], this.boxKeys = [], this.bboxes = [], this.circles = [], this.width = e, this.height = t2, this.xScale = this.xCellCount / e, this.yScale = this.yCellCount / t2, this.boxUid = 0, this.circleUid = 0;
          }
          return _createClass(a2, [{ key: "keysLength", value: function() {
            return this.boxKeys.length + this.circleKeys.length;
          } }, { key: "insert", value: function(e, t2, r, i2, n) {
            this._forEachCell(t2, r, i2, n, this._insertBoxCell, this.boxUid++), this.boxKeys.push(e), this.bboxes.push(t2), this.bboxes.push(r), this.bboxes.push(i2), this.bboxes.push(n);
          } }, { key: "insertCircle", value: function(e, t2, r, i2) {
            this._forEachCell(t2 - i2, r - i2, t2 + i2, r + i2, this._insertCircleCell, this.circleUid++), this.circleKeys.push(e), this.circles.push(t2), this.circles.push(r), this.circles.push(i2);
          } }, { key: "insertCircleList", value: function(e, t2) {
            for (var r = 0; r < t2.length - 2; r += 3)
              this.insertCircle("".concat(e, "/").concat(r), t2[r], t2[r + 1], t2[r + 2]);
          } }, { key: "_insertBoxCell", value: function(e, t2, r, i2, n, o) {
            this.boxCells[n].push(o);
          } }, { key: "_insertCircleCell", value: function(e, t2, r, i2, n, o) {
            this.circleCells[n].push(o);
          } }, { key: "_query", value: function(e, t2, r, i2, n, o) {
            if (r < 0 || e > this.width || i2 < 0 || t2 > this.height)
              return !n && [];
            var a3 = [];
            if (e <= 0 && t2 <= 0 && this.width <= r && this.height <= i2) {
              if (n)
                return true;
              for (var s = 0; s < this.boxKeys.length; s++)
                a3.push({ key: this.boxKeys[s], x1: this.bboxes[4 * s], y1: this.bboxes[4 * s + 1], x2: this.bboxes[4 * s + 2], y2: this.bboxes[4 * s + 3] });
              for (var l = 0; l < this.circleKeys.length; l++) {
                var u2 = this.circles[3 * l], c2 = this.circles[3 * l + 1], h = this.circles[3 * l + 2];
                a3.push({ key: this.circleKeys[l], x1: u2 - h, y1: c2 - h, x2: u2 + h, y2: c2 + h });
              }
              return o ? a3.filter(o) : a3;
            }
            var f2 = { hitTest: n, seenUids: { box: {}, circle: {} } };
            return this._forEachCell(e, t2, r, i2, this._queryCell, a3, f2, o), n ? 0 < a3.length : a3;
          } }, { key: "_queryCircle", value: function(e, t2, r, i2, n) {
            var o = e - r, a3 = e + r, s = t2 - r, l = t2 + r;
            if (a3 < 0 || o > this.width || l < 0 || s > this.height)
              return !i2 && [];
            var u2 = [], c2 = { hitTest: i2, circle: { x: e, y: t2, radius: r }, seenUids: { box: {}, circle: {} } };
            return this._forEachCell(o, s, a3, l, this._queryCellCircle, u2, c2, n), i2 ? 0 < u2.length : u2;
          } }, { key: "query", value: function(e, t2, r, i2, n) {
            return this._query(e, t2, r, i2, false, n);
          } }, { key: "hitTest", value: function(e, t2, r, i2, n) {
            return this._query(e, t2, r, i2, true, n);
          } }, { key: "hitTestCircle", value: function(e, t2, r, i2) {
            return this._queryCircle(e, t2, r, true, i2);
          } }, { key: "hitTestCircleList", value: function(e, t2) {
            for (var r = 0; r < e.length - 2; r += 3)
              if (this.hitTestCircle(e[r], e[r + 1], e[r + 2], t2))
                return true;
            return false;
          } }, { key: "_queryCell", value: function(e, t2, r, i2, n, o, a3, s) {
            var l = a3.seenUids, u2 = this.boxCells[n];
            if (null !== u2) {
              var c2, h = this.bboxes, f2 = _createForOfIteratorHelper(u2);
              try {
                for (f2.s(); !(c2 = f2.n()).done; ) {
                  var d = c2.value;
                  if (!l.box[d]) {
                    l.box[d] = true;
                    var _ = 4 * d;
                    if (e <= h[2 + _] && t2 <= h[3 + _] && r >= h[0 + _] && i2 >= h[1 + _] && (!s || s(this.boxKeys[d]))) {
                      if (a3.hitTest)
                        return o.push(true), true;
                      o.push({ key: this.boxKeys[d], x1: h[_], y1: h[1 + _], x2: h[2 + _], y2: h[3 + _] });
                    }
                  }
                }
              } catch (e2) {
                f2.e(e2);
              } finally {
                f2.f();
              }
            }
            var p2 = this.circleCells[n];
            if (null !== p2) {
              var g, m = this.circles, y = _createForOfIteratorHelper(p2);
              try {
                for (y.s(); !(g = y.n()).done; ) {
                  var v = g.value;
                  if (!l.circle[v]) {
                    l.circle[v] = true;
                    var x2 = 3 * v;
                    if (this._circleAndRectCollide(m[x2], m[1 + x2], m[2 + x2], e, t2, r, i2) && (!s || s(this.circleKeys[v]))) {
                      if (a3.hitTest)
                        return o.push(true), true;
                      var b2 = m[x2], T2 = m[1 + x2], A2 = m[2 + x2];
                      o.push({ key: this.circleKeys[v], x1: b2 - A2, y1: T2 - A2, x2: b2 + A2, y2: T2 + A2 });
                    }
                  }
                }
              } catch (e2) {
                y.e(e2);
              } finally {
                y.f();
              }
            }
          } }, { key: "_queryCellCircle", value: function(e, t2, r, i2, n, o, a3, s) {
            var l = a3.circle, u2 = a3.seenUids, c2 = this.boxCells[n];
            if (null !== c2) {
              var h, f2 = this.bboxes, d = _createForOfIteratorHelper(c2);
              try {
                for (d.s(); !(h = d.n()).done; ) {
                  var _ = h.value;
                  if (!u2.box[_]) {
                    u2.box[_] = true;
                    var p2 = 4 * _;
                    if (this._circleAndRectCollide(l.x, l.y, l.radius, f2[0 + p2], f2[1 + p2], f2[2 + p2], f2[3 + p2]) && (!s || s(this.boxKeys[_])))
                      return o.push(true), true;
                  }
                }
              } catch (e2) {
                d.e(e2);
              } finally {
                d.f();
              }
            }
            var g = this.circleCells[n];
            if (null !== g) {
              var m, y = this.circles, v = _createForOfIteratorHelper(g);
              try {
                for (v.s(); !(m = v.n()).done; ) {
                  var x2 = m.value;
                  if (!u2.circle[x2]) {
                    u2.circle[x2] = true;
                    var b2 = 3 * x2;
                    if (this._circlesCollide(y[b2], y[1 + b2], y[2 + b2], l.x, l.y, l.radius) && (!s || s(this.circleKeys[x2])))
                      return o.push(true), true;
                  }
                }
              } catch (e2) {
                v.e(e2);
              } finally {
                v.f();
              }
            }
          } }, { key: "_forEachCell", value: function(e, t2, r, i2, n, o, a3, s) {
            for (var l = this._convertToXCellCoord(e), u2 = this._convertToYCellCoord(t2), c2 = this._convertToXCellCoord(r), h = this._convertToYCellCoord(i2), f2 = l; f2 <= c2; f2++)
              for (var d = u2; d <= h; d++) {
                var _ = this.xCellCount * d + f2;
                if (n.call(this, e, t2, r, i2, _, o, a3, s))
                  return;
              }
          } }, { key: "_convertToXCellCoord", value: function(e) {
            return Math.max(0, Math.min(this.xCellCount - 1, Math.floor(e * this.xScale)));
          } }, { key: "_convertToYCellCoord", value: function(e) {
            return Math.max(0, Math.min(this.yCellCount - 1, Math.floor(e * this.yScale)));
          } }, { key: "_circlesCollide", value: function(e, t2, r, i2, n, o) {
            var a3 = i2 - e, s = n - t2, l = r + o;
            return a3 * a3 + s * s < l * l;
          } }, { key: "_circleAndRectCollide", value: function(e, t2, r, i2, n, o, a3) {
            var s = (o - i2) / 2, l = Math.abs(e - (i2 + s));
            if (s + r < l)
              return false;
            var u2 = (a3 - n) / 2, c2 = Math.abs(t2 - (n + u2));
            if (u2 + r < c2)
              return false;
            if (l <= s || c2 <= u2)
              return true;
            var h = l - s, f2 = c2 - u2;
            return h * h + f2 * f2 <= r * r;
          } }]), a2;
        }(), CollisionUtils = { toDiscardLabel: function(e, t2, r, i2) {
          var n;
          if (i2 && (n = function(e2) {
            return e2 !== i2.id;
          }), !t2) {
            if ("point" === e.type && !e.angle) {
              var o = e.getAABB(), a2 = o.left, s = o.top, l = o.right, u2 = o.bottom;
              if (r.hitTest(a2, -s, l, -u2, n)) {
                if (Array.isArray(e.layout.anchor))
                  for (var c2 = 1; c2 < e.layout.anchor.length; c2++) {
                    e.setAnchor(e.layout.anchor[c2]);
                    var h = e.getAABB(), f2 = h.left, d = h.top, _ = h.right, p2 = h.bottom;
                    if (!r.hitTest(f2, -d, _, -p2, n))
                      return false;
                  }
                return true;
              }
              return false;
            }
            var g = e.getBoundingCircles();
            return r.hitTestCircleList(g, n);
          }
          if (t2) {
            if ("point" === e.type && !e.isFlat()) {
              var m = e.getScreenSpaceBoundingBox(), y = m.left, v = m.top, x2 = m.right, b2 = m.bottom;
              return r.hitTest(y, v, x2, b2, n);
            }
            var T2 = e.getBoundingCircles();
            return r.hitTestCircleList(T2, n);
          }
          return false;
        }, addLabel: function(e, t2, r) {
          var i2, n, o, a2, s, l, u2, c2, h, f2, d, _, p2 = e.id;
          e.placed = true, t2 || ("point" !== e.type || e.angle ? (i2 = e.getBoundingCircles(), r.insertCircleList(p2, i2)) : (o = (n = e.getAABB()).left, a2 = n.top, s = n.right, l = n.bottom, r.insert(p2, o, -a2, s, -l))), t2 && ("point" !== e.type || e.isFlat() ? (u2 = e.getBoundingCircles(), r.insertCircleList(p2, u2)) : (h = (c2 = e.getScreenSpaceBoundingBox()).left, f2 = c2.top, d = c2.right, _ = c2.bottom, r.insert(p2, h, f2, d, _)));
        } }, Collision = { tiles: {}, startTile: function(e, t2) {
          var r = 1 < arguments.length && void 0 !== t2 ? t2 : {}, i2 = r.apply_repeat_groups, n = void 0 === i2 || i2, o = r.return_hidden, a2 = void 0 !== o && o, s = r.grid_index, l = void 0 === s ? null : s, u2 = this.tiles[e] = { grid_index: l || new GridIndex(Geo$1.tile_scale, Geo$1.tile_scale, 240), objects: {}, labels: {}, styles: {}, repeat: n, return_hidden: a2 };
          null == u2.complete && (u2.complete = new Promise(function(e2, t3) {
            u2.resolve = e2, u2.reject = t3;
          }));
        }, resetTile: function(e) {
          delete this.tiles[e];
        }, abortTile: function(e) {
          this.tiles[e] && this.tiles[e].resolve && this.tiles[e].resolve([]), this.resetTile(e);
        }, addStyle: function(e, t2) {
          this.tiles[t2].styles[e] = true;
        }, collide: function(e, t2, r) {
          var i2 = this.tiles[r];
          if (!i2)
            return Promise.resolve([]);
          for (var n = i2.objects, o = 0; o < e.length; o++) {
            var a2 = e[o], s = a2.label.layout.priority;
            n[s] = n[s] || {}, n[s][t2] = n[s][t2] || [], n[s][t2].push(a2);
          }
          return delete i2.styles[t2], 0 === Object.keys(i2.styles).length && this.endTile(r), i2.complete.then(function() {
            return i2.resolve = null, i2.labels[t2] || [];
          });
        }, endTile: function(e) {
          var t2 = this.tiles[e], r = t2.labels;
          t2.repeat && RepeatGroup.clear(e);
          for (var i2 = Object.keys(t2.objects).sort(function(e2, t3) {
            return e2 - t3;
          }), n = 0; n < i2.length; n++) {
            var o = t2.objects[i2[n]];
            if (o)
              for (var a2 in o) {
                var s = o[a2];
                r[a2] = r[a2] || [];
                for (var l = 0; l < s.length; l++) {
                  var u2 = s[l];
                  this.canBePlaced(u2, e, u2.linked, t2) ? u2.linked ? this.canBePlaced(u2.linked, e, u2, t2) ? (u2.show = true, (u2.label.breach || u2.linked.label.breach) && (u2.label.breach = true, u2.linked.label.breach = true), r[a2].push(u2), this.place(u2, e, t2), this.place(u2.linked, e, t2)) : t2.return_hidden && (u2.show = false, r[a2].push(u2)) : (u2.show = true, r[a2].push(u2), this.place(u2, e, t2)) : t2.return_hidden && (u2.show = false, r[a2].push(u2));
                }
              }
          }
          delete this.tiles[e], t2.resolve();
        }, canBePlaced: function(e, t2, r, i2) {
          var n = 2 < arguments.length && void 0 !== r ? r : null, o = (3 < arguments.length && void 0 !== i2 ? i2 : {}).repeat, a2 = void 0 === o || o, s = e.label, l = e.label.layout;
          if (null !== s.placed)
            return s.placed;
          var u2 = this.tiles[t2].grid_index;
          if (l.collide && CollisionUtils.toDiscardLabel(s, "main" === t2, u2, n && n.label))
            l.collide && (s.placed = false);
          else {
            if (!(a2 && RepeatGroup.check(s, l, t2)))
              return true;
            s.placed = false;
          }
          return s.placed;
        }, place: function(e, t2, r) {
          var i2 = e.label, n = r.repeat, o = void 0 === n || n;
          null === i2.placed && (o && RepeatGroup.add(i2, i2.layout, t2), CollisionUtils.addLabel(i2, "main" === t2, this.tiles[t2].grid_index));
        } }, Task = { id: 0, queue: [], max_time: 20, start_time: null, state: {}, ignore_user_moving_view: false, _ignoreViewMoveWithDebounce: debounce(function() {
          Task.ignore_user_moving_view = true;
        }, 0, 500), add: function(r) {
          r.id = Task.id++, r.max_time = r.max_time || Task.max_time, r.pause_factor = r.pause_factor || 1;
          var e = new Promise(function(e2, t2) {
            r.resolve = e2, r.reject = t2;
          });
          return r.promise = e, r.total_elapsed = 0, r.stats = { calls: 0 }, this.queue.push(r), this.start_time = this.start_time || performance.now(), this.elapsed = performance.now() - this.start_time, this.elapsed < Task.max_time && this.process(r), r.promise;
        }, remove: function(e) {
          var t2 = this.queue.indexOf(e);
          -1 < t2 && this.queue.splice(t2, 1);
        }, process: function(e) {
          if (!this.state.user_moving_view || false !== e.user_moving_view || this.ignore_user_moving_view)
            return e.pause ? (e.pause--, true) : (e.stats.calls++, e.start_time = performance.now(), e.run(e));
          Task._ignoreViewMoveWithDebounce();
        }, processAll: function() {
          this.start_time = this.start_time || performance.now(), this.ignore_user_moving_view && !this.hasPendingTasks() && (this.ignore_user_moving_view = false);
          for (var e = 0; e < this.queue.length; e++) {
            var t2 = this.queue[e];
            if (true !== this.process(t2) && (t2.pause || (t2.pause = t2.elapsed > t2.max_time ? t2.pause_factor : 0), t2.total_elapsed += t2.elapsed), this.elapsed = performance.now() - this.start_time, this.elapsed >= Task.max_time) {
              this.start_time = null;
              break;
            }
          }
        }, finish: function(e, t2) {
          return e.elapsed = performance.now() - e.start_time, e.total_elapsed += e.elapsed, this.remove(e), e.resolve(t2), e.promise;
        }, cancel: function(e) {
          var t2;
          e.cancel instanceof Function && (t2 = e.cancel(e)), e.resolve(t2 || {});
        }, shouldContinue: function(e) {
          return e.elapsed = performance.now() - e.start_time, this.elapsed = performance.now() - this.start_time, e.elapsed < e.max_time && this.elapsed < Task.max_time;
        }, removeForTile: function(e) {
          for (var t2 = this.queue.length - 1; 0 <= t2; t2--)
            this.queue[t2].tile_id === e && (this.cancel(this.queue[t2]), this.queue.splice(t2, 1));
        }, setState: function(e) {
          this.state = e;
        }, hasPendingTasks: function() {
          return !!this.queue.length;
        } };
        function sliceOptions(e) {
          return { coords: e.coords, uid: e.uid, filtering: e.filtering, sprites: e.sprites, url: e.url, element: e.element, data: e.data, width: e.width, height: e.height, density: e.density, repeat: e.repeat, TEXTURE_WRAP_S: e.TEXTURE_WRAP_S, TEXTURE_WRAP_T: e.TEXTURE_WRAP_T, UNPACK_FLIP_Y_WEBGL: e.UNPACK_FLIP_Y_WEBGL, UNPACK_PREMULTIPLY_ALPHA_WEBGL: e.UNPACK_PREMULTIPLY_ALPHA_WEBGL };
        }
        var Texture = function() {
          function n(e, t2, r) {
            var i2 = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {};
            _classCallCheck(this, n), i2 = sliceOptions(i2), this.gl = e, this.texture = e.createTexture(), this.texture && (this.valid = true), this.manager = r, this.bind(), this.name = t2, this.retain_count = 0, this.config_type = null, this.loading = null, this.loaded = false, this.filtering = i2.filtering, this.density = i2.density || 1, this.sprites = i2.sprites, this.texcoords = {}, this.sizes = {}, this.css_sizes = {}, this.aspects = {}, this._byte_length = 0, this.setData(1, 1, new Uint8Array([0, 0, 0, 0]), { filtering: "nearest" }), this.loaded = false, this.manager.textures[this.name] && (this.retain_count = this.manager.textures[this.name].retain_count, this.manager.textures[this.name].retain_count = 0, this.manager.textures[this.name].destroy()), (this.manager.textures[this.name] = this).manager.texture_configs[this.name] = JSON.stringify(Object.assign({ name: t2 }, i2)), this.load(i2), log("trace", "creating Texture ".concat(this.name));
          }
          return _createClass(n, [{ key: "destroy", value: function(e) {
            var t2 = (0 < arguments.length && void 0 !== e ? e : {}).force;
            0 < this.retain_count && !t2 ? log("error", "Texture '".concat(this.name, "': destroying texture with retain count of '").concat(this.retain_count, "'")) : this.valid && (this.gl.deleteTexture(this.texture), this.texture = null, delete this.data, this.data = null, delete this.manager.textures[this.name], delete this.manager.texture_configs[this.name], this.valid = false, this._byte_length = 0, log("trace", "destroying Texture ".concat(this.name)));
          } }, { key: "retain", value: function() {
            this.retain_count++;
          } }, { key: "release", value: function() {
            this.retain_count <= 0 && log("error", "Texture '".concat(this.name, "': releasing texture with retain count of '").concat(this.retain_count, "'")), this.retain_count--, this.retain_count <= 0 && this.destroy();
          } }, { key: "bind", value: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e ? e : 0;
            this.valid && (this.manager.activeUnit !== t2 && (this.gl.activeTexture(this.gl.TEXTURE0 + t2), this.manager.activeUnit = t2, this.manager.boundTexture = null), this.manager.boundTexture !== this.texture && (this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture), this.manager.boundTexture = this.texture));
          } }, { key: "load", value: function(e) {
            var t2 = this;
            return e ? (this.loading = null, "string" == typeof e.url ? (this.config_type = "url", this.setUrl(e.url, e)) : e.element ? (this.config_type = "element", this.setElement(e.element, e)) : e.data && e.width && e.height && (this.config_type = "data", this.setData(e.width, e.height, e.data, e)), this.loading = this.loading && this.loading.then(function() {
              return t2.calculateSprites(), t2;
            }) || Promise.resolve(this), this.loading) : this.loading || Promise.resolve(this);
          } }, { key: "setUrl", value: function(e, t2) {
            var i2 = this, n2 = 1 < arguments.length && void 0 !== t2 ? t2 : {};
            if (this.valid)
              return this.url = e, this.loading = new Promise(function(t3, e2) {
                var r = new Image();
                r.onload = function() {
                  try {
                    i2.setElement(r, n2);
                  } catch (e3) {
                    i2.loaded = false, log("warn", "Texture '".concat(i2.name, "': failed to load url: '").concat(i2.url, "'"), e3, n2), i2.manager.trigger("warning", { message: "Failed to load texture from ".concat(i2.url), error: e3, texture: n2 });
                  }
                  i2.loaded = true, t3(i2);
                }, r.onerror = function(e3) {
                  i2.loaded = false, log("warn", "Texture '".concat(i2.name, "': failed to load url: '").concat(i2.url, "'"), e3, n2), i2.manager.trigger("warning", { message: "Failed to load texture from ".concat(i2.url), error: e3, texture: n2 }), t3(i2);
                }, Utils$1.isSafari() && "data:" === i2.url.slice(0, 5) || (r.crossOrigin = "anonymous"), r.src = i2.url;
              }), this.loading;
          } }, { key: "setData", value: function(e, t2, r, i2) {
            var n2 = 3 < arguments.length && void 0 !== i2 ? i2 : {};
            return this.width = e, this.height = t2, Array.isArray(r) && (r = new Uint8Array(r)), this.update(r, n2), this.setFiltering(n2), this.loaded = true, this.loading = Promise.resolve(this), this.loading;
          } }, { key: "setElement", value: function(e, t2) {
            var r, i2 = e;
            return "string" == typeof e && (e = document.querySelector(e)), e instanceof HTMLCanvasElement || e instanceof HTMLImageElement || e instanceof HTMLVideoElement ? (this.update(e, t2), this.setFiltering(t2)) : (this.loaded = false, r = "the 'element' parameter (`element: ".concat(JSON.stringify(i2), "`) must be a CSS "), r += "selector string, or a <canvas>, <image> or <video> object", log("warn", "Texture '".concat(this.name, "': ").concat(r), t2), this.manager.trigger("warning", { message: "Failed to load texture because ".concat(r), texture: t2 })), this.loaded = true, this.loading = Promise.resolve(this), this.loading;
          } }, { key: "update", value: function(e, t2) {
            var r = 1 < arguments.length && void 0 !== t2 ? t2 : {};
            this.valid && (this.bind(), e instanceof HTMLCanvasElement || e instanceof HTMLVideoElement || e instanceof HTMLImageElement && e.complete ? (this.width = e.width, this.height = e.height, this._byte_length = this.width * this.height * 4, this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, false !== r.UNPACK_FLIP_Y_WEBGL), this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r.UNPACK_PREMULTIPLY_ALPHA_WEBGL || false), this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.gl.RGBA, this.gl.UNSIGNED_BYTE, e)) : (this._byte_length = e ? e.byteLength : 0, this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, false), this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false), this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.width, this.height, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE, e)), this.manager.trigger("update", this));
          } }, { key: "getByteLength", value: function() {
            return this._byte_length;
          } }, { key: "setFiltering", value: function(e) {
            var t2, r = 0 < arguments.length && void 0 !== e ? e : {};
            this.valid && (r.filtering = r.filtering || "linear", t2 = this.gl, this.bind(), Utils$1.isPowerOf2(this.width) && Utils$1.isPowerOf2(this.height) ? (this.power_of_2 = true, t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_WRAP_S, r.TEXTURE_WRAP_S || r.repeat && t2.REPEAT || t2.CLAMP_TO_EDGE), t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_WRAP_T, r.TEXTURE_WRAP_T || r.repeat && t2.REPEAT || t2.CLAMP_TO_EDGE), "mipmap" === r.filtering ? (this.filtering = "mipmap", t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MIN_FILTER, t2.LINEAR_MIPMAP_LINEAR), t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MAG_FILTER, t2.LINEAR), t2.generateMipmap(t2.TEXTURE_2D)) : "linear" === r.filtering ? (this.filtering = "linear", t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MIN_FILTER, t2.LINEAR), t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MAG_FILTER, t2.LINEAR)) : "nearest" === r.filtering && (this.filtering = "nearest", t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MIN_FILTER, t2.NEAREST), t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MAG_FILTER, t2.NEAREST))) : (this.power_of_2 = false, t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_WRAP_S, t2.CLAMP_TO_EDGE), t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_WRAP_T, t2.CLAMP_TO_EDGE), "nearest" === r.filtering ? (this.filtering = "nearest", t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MIN_FILTER, t2.NEAREST), t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MAG_FILTER, t2.NEAREST)) : (this.filtering = "linear", t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MIN_FILTER, t2.LINEAR), t2.texParameteri(t2.TEXTURE_2D, t2.TEXTURE_MAG_FILTER, t2.LINEAR))), this.manager.trigger("update", this));
          } }, { key: "calculateSprites", value: function() {
            if (this.sprites)
              for (var e in this.sprites) {
                var t2 = this.sprites[e];
                this.texcoords[e] = this.manager.getTexcoordsForSprite([t2[0], t2[1]], [t2[2], t2[3]], [this.width, this.height]), this.sizes[e] = [t2[2], t2[3]], this.css_sizes[e] = [t2[2] / this.density, t2[3] / this.density], this.aspects[e] = t2[2] / t2[3];
              }
          } }]), n;
        }();
        function subscribeMixin(e) {
          var n = [];
          return Object.assign(e, { subscribe: function(e2) {
            -1 === n.indexOf(e2) && n.push(e2);
          }, unsubscribe: function(e2) {
            var t2 = n.indexOf(e2);
            -1 < t2 && n.splice(t2, 1);
          }, unsubscribeAll: function() {
            n = [];
          }, trigger: function(t2) {
            for (var e2 = arguments.length, r = new Array(1 < e2 ? e2 - 1 : 0), i2 = 1; i2 < e2; i2++)
              r[i2 - 1] = arguments[i2];
            n.forEach(function(e3) {
              if ("function" == typeof e3[t2])
                try {
                  e3[t2].apply(e3, r);
                } catch (e4) {
                  log("warn", "Caught exception in listener for event '".concat(t2, "':"), e4);
                }
            });
          }, hasSubscribersFor: function(t2) {
            var r = false;
            return n.forEach(function(e2) {
              "function" == typeof e2[t2] && (r = true);
            }), r;
          } });
        }
        var TextureManager = function() {
          function s(e) {
            _classCallCheck(this, s), this.default = s.DEFAULT_TEXTURE_NAME, this.textures = {}, this.texture_configs = {}, this.boundTexture = null, this.activeUnit = null, this.scene_id = e, WorkerBroker.addTarget("Texture" + this.scene_id, this), subscribeMixin(this);
          }
          return _createClass(s, [{ key: "create", value: function(e, t2, r) {
            for (var i2 = s.matchers_, n = 0; n < i2.length; n++) {
              var o = i2[n][0], a2 = i2[n][1];
              if (a2 && a2(r))
                return new o(e, t2, this, r);
            }
            return new Texture(e, t2, this, r);
          } }, { key: "retain", value: function(e) {
            this.textures[e] && this.textures[e].retain();
          } }, { key: "release", value: function(e) {
            this.textures[e] && this.textures[e].release();
          } }, { key: "getRetainCount", value: function(e) {
            if (this.textures[e])
              return this.textures[e].retain_count;
          } }, { key: "getByteLength", value: function(e) {
            if (this.textures[e])
              return this.textures[e].getByteLength();
          } }, { key: "destroy", value: function(r) {
            var i2 = this;
            Object.keys(this.textures).forEach(function(e) {
              var t2 = i2.textures[e];
              e !== i2.default && t2.gl === r && t2.destroy({ force: true });
            });
          } }, { key: "getSpriteInfo", value: function(e, t2) {
            var r = this.textures[e];
            return r && { size: r.sizes[t2], css_size: r.css_sizes[t2], aspect: r.aspects[t2], texcoords: r.texcoords[t2] };
          } }, { key: "getTexcoordsForSprite", value: function(e, t2, r) {
            var i2 = r[1] - e[1] - t2[1];
            return [e[0] / r[0], i2 / r[1], (t2[0] + e[0]) / r[0], (t2[1] + i2) / r[1]];
          } }, { key: "createFromObject", value: function(e, t2) {
            var r = [];
            if (t2)
              for (var i2 in t2) {
                var n, o = t2[i2];
                this.changed(i2, o) && (n = this.create(e, i2, o), r.push(n.loading));
              }
            return Promise.all(r);
          } }, { key: "createDefault", value: function(e) {
            return this.create(e, this.default);
          } }, { key: "changed", value: function(e, t2) {
            var r = this.textures[e];
            if (r) {
              if ("element" === r.config_type || null != t2.element)
                return true;
              if (t2 = sliceOptions(t2), this.texture_configs[e] === JSON.stringify(Object.assign({ name: e }, t2)))
                return false;
            }
            return true;
          } }, { key: "getInfo", value: function(e) {
            var t2 = this;
            if (e = e || Object.keys(this.textures), Array.isArray(e))
              return Promise.all(e.map(function(e2) {
                return t2.getInfo(e2);
              }));
            var r = this.textures[e];
            return r ? (r.loading || Promise.resolve(r)).then(function() {
              return { name: r.name, width: r.width, height: r.height, density: r.density, sprites: r.sprites, texcoords: r.texcoords, sizes: r.sizes, css_sizes: r.css_sizes, aspects: r.aspects, filtering: r.filtering, power_of_2: r.power_of_2, valid: r.valid };
            }) : Promise.resolve(null);
          } }, { key: "syncTexturesToWorker", value: function(e) {
            var r = this;
            return Thread.is_main ? Promise.all(e.map(function(e2) {
              var t2 = r.textures[e2];
              return t2 && t2.loading || Promise.resolve();
            })).then(function() {
              return r.textures;
            }) : WorkerBroker.postMessage("Texture" + this.scene_id + ".getInfo", e).then(function(e2) {
              return e2.forEach(function(e3) {
                r.textures[e3.name] = e3;
              }), r.textures;
            });
          } }, { key: "getMaxTextureSize", value: function(e) {
            return e.getParameter(e.MAX_TEXTURE_SIZE);
          } }], [{ key: "register", value: function(e, t2) {
            var r = s.matchers_;
            if (!(e instanceof Function && t2 instanceof Function))
              throw "Invalid texture constructor or matcher";
            this.deRegister(e), r.push([e, t2]);
          } }, { key: "deRegister", value: function(e) {
            for (var t2 = s.matchers_, r = 0; r < t2.length; r++)
              t2[r][0] === e && t2.splice(r, 1);
          } }]), s;
        }();
        TextureManager.DEFAULT_TEXTURE_NAME = "__default", TextureManager.matchers_ = [];
        var Registry = {};
        function getTextureManager(e) {
          return Registry[e] || (Registry[e] = new TextureManager(e)), Registry[e];
        }
        var transformMat4_1 = transformMat4;
        function transformMat4(e, t2, r) {
          var i2 = t2[0], n = t2[1], o = t2[2], a2 = (a2 = r[3] * i2 + r[7] * n + r[11] * o + r[15]) || 1;
          return e[0] = (r[0] * i2 + r[4] * n + r[8] * o + r[12]) / a2, e[1] = (r[1] * i2 + r[5] * n + r[9] * o + r[13]) / a2, e[2] = (r[2] * i2 + r[6] * n + r[10] * o + r[14]) / a2, e;
        }
        var normalFromMat4_1 = normalFromMat4;
        function normalFromMat4(e, t2) {
          var r = t2[0], i2 = t2[1], n = t2[2], o = t2[3], a2 = t2[4], s = t2[5], l = t2[6], u2 = t2[7], c2 = t2[8], h = t2[9], f2 = t2[10], d = t2[11], _ = t2[12], p2 = t2[13], g = t2[14], m = t2[15], y = r * s - i2 * a2, v = r * l - n * a2, x2 = r * u2 - o * a2, b2 = i2 * l - n * s, T2 = i2 * u2 - o * s, A2 = n * u2 - o * l, E2 = c2 * p2 - h * _, w = c2 * g - f2 * _, S2 = c2 * m - d * _, k = h * g - f2 * p2, P2 = h * m - d * p2, R2 = f2 * m - d * g, M2 = y * R2 - v * P2 + x2 * k + b2 * S2 - T2 * w + A2 * E2;
          return M2 ? (M2 = 1 / M2, e[0] = (s * R2 - l * P2 + u2 * k) * M2, e[1] = (l * S2 - a2 * R2 - u2 * w) * M2, e[2] = (a2 * P2 - s * S2 + u2 * E2) * M2, e[3] = (n * P2 - i2 * R2 - o * k) * M2, e[4] = (r * R2 - n * S2 + o * w) * M2, e[5] = (i2 * S2 - r * P2 - o * E2) * M2, e[6] = (p2 * A2 - g * T2 + m * b2) * M2, e[7] = (g * x2 - _ * A2 - m * v) * M2, e[8] = (_ * T2 - p2 * x2 + m * y) * M2, e) : null;
        }
        var invert_1 = invert;
        function invert(e, t2) {
          var r = t2[0], i2 = t2[1], n = t2[2], o = t2[3], a2 = t2[4], s = t2[5], l = t2[6], u2 = t2[7], c2 = t2[8], h = c2 * a2 - s * u2, f2 = -c2 * o + s * l, d = u2 * o - a2 * l, _ = r * h + i2 * f2 + n * d;
          return _ ? (_ = 1 / _, e[0] = h * _, e[1] = (-c2 * i2 + n * u2) * _, e[2] = (s * i2 - n * a2) * _, e[3] = f2 * _, e[4] = (c2 * r - n * l) * _, e[5] = (-s * r + n * o) * _, e[6] = d * _, e[7] = (-u2 * r + i2 * l) * _, e[8] = (a2 * r - i2 * o) * _, e) : null;
        }
        var identity_1 = identity;
        function identity(e) {
          return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 1, e[5] = 0, e[6] = 0, e[7] = 0, e[8] = 1, e;
        }
        var multiply_1 = multiply;
        function multiply(e, t2, r) {
          var i2 = t2[0], n = t2[1], o = t2[2], a2 = t2[3], s = t2[4], l = t2[5], u2 = t2[6], c2 = t2[7], h = t2[8], f2 = t2[9], d = t2[10], _ = t2[11], p2 = t2[12], g = t2[13], m = t2[14], y = t2[15], v = r[0], x2 = r[1], b2 = r[2], T2 = r[3];
          return e[0] = v * i2 + x2 * s + b2 * h + T2 * p2, e[1] = v * n + x2 * l + b2 * f2 + T2 * g, e[2] = v * o + x2 * u2 + b2 * d + T2 * m, e[3] = v * a2 + x2 * c2 + b2 * _ + T2 * y, v = r[4], x2 = r[5], b2 = r[6], T2 = r[7], e[4] = v * i2 + x2 * s + b2 * h + T2 * p2, e[5] = v * n + x2 * l + b2 * f2 + T2 * g, e[6] = v * o + x2 * u2 + b2 * d + T2 * m, e[7] = v * a2 + x2 * c2 + b2 * _ + T2 * y, v = r[8], x2 = r[9], b2 = r[10], T2 = r[11], e[8] = v * i2 + x2 * s + b2 * h + T2 * p2, e[9] = v * n + x2 * l + b2 * f2 + T2 * g, e[10] = v * o + x2 * u2 + b2 * d + T2 * m, e[11] = v * a2 + x2 * c2 + b2 * _ + T2 * y, v = r[12], x2 = r[13], b2 = r[14], T2 = r[15], e[12] = v * i2 + x2 * s + b2 * h + T2 * p2, e[13] = v * n + x2 * l + b2 * f2 + T2 * g, e[14] = v * o + x2 * u2 + b2 * d + T2 * m, e[15] = v * a2 + x2 * c2 + b2 * _ + T2 * y, e;
        }
        var translate_1 = translate;
        function translate(e, t2, r) {
          var i2, n, o, a2, s, l, u2, c2, h, f2, d, _, p2 = r[0], g = r[1], m = r[2];
          return t2 === e ? (e[12] = t2[0] * p2 + t2[4] * g + t2[8] * m + t2[12], e[13] = t2[1] * p2 + t2[5] * g + t2[9] * m + t2[13], e[14] = t2[2] * p2 + t2[6] * g + t2[10] * m + t2[14], e[15] = t2[3] * p2 + t2[7] * g + t2[11] * m + t2[15]) : (i2 = t2[0], n = t2[1], o = t2[2], a2 = t2[3], s = t2[4], l = t2[5], u2 = t2[6], c2 = t2[7], h = t2[8], f2 = t2[9], d = t2[10], _ = t2[11], e[0] = i2, e[1] = n, e[2] = o, e[3] = a2, e[4] = s, e[5] = l, e[6] = u2, e[7] = c2, e[8] = h, e[9] = f2, e[10] = d, e[11] = _, e[12] = i2 * p2 + s * g + h * m + t2[12], e[13] = n * p2 + l * g + f2 * m + t2[13], e[14] = o * p2 + u2 * g + d * m + t2[14], e[15] = a2 * p2 + c2 * g + _ * m + t2[15]), e;
        }
        var scale_1 = scale;
        function scale(e, t2, r) {
          var i2 = r[0], n = r[1], o = r[2];
          return e[0] = t2[0] * i2, e[1] = t2[1] * i2, e[2] = t2[2] * i2, e[3] = t2[3] * i2, e[4] = t2[4] * n, e[5] = t2[5] * n, e[6] = t2[6] * n, e[7] = t2[7] * n, e[8] = t2[8] * o, e[9] = t2[9] * o, e[10] = t2[10] * o, e[11] = t2[11] * o, e[12] = t2[12], e[13] = t2[13], e[14] = t2[14], e[15] = t2[15], e;
        }
        var perspective_1 = perspective;
        function perspective(e, t2, r, i2, n) {
          var o = 1 / Math.tan(t2 / 2), a2 = 1 / (i2 - n);
          return e[0] = o / r, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = o, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = (n + i2) * a2, e[11] = -1, e[12] = 0, e[13] = 0, e[14] = 2 * n * i2 * a2, e[15] = 0, e;
        }
        var identity_1$1 = identity$1;
        function identity$1(e) {
          return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = 1, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = 1, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e;
        }
        var lookAt_1 = lookAt;
        function lookAt(e, t2, r, i2) {
          var n, o, a2, s, l, u2, c2, h, f2, d, _ = t2[0], p2 = t2[1], g = t2[2], m = i2[0], y = i2[1], v = i2[2], x2 = r[0], b2 = r[1], T2 = r[2];
          return Math.abs(_ - x2) < 1e-6 && Math.abs(p2 - b2) < 1e-6 && Math.abs(g - T2) < 1e-6 ? identity_1$1(e) : (c2 = _ - x2, h = p2 - b2, f2 = g - T2, n = y * (f2 *= d = 1 / Math.sqrt(c2 * c2 + h * h + f2 * f2)) - v * (h *= d), o = v * (c2 *= d) - m * f2, a2 = m * h - y * c2, (d = Math.sqrt(n * n + o * o + a2 * a2)) ? (n *= d = 1 / d, o *= d, a2 *= d) : a2 = o = n = 0, s = h * a2 - f2 * o, l = f2 * n - c2 * a2, u2 = c2 * o - h * n, (d = Math.sqrt(s * s + l * l + u2 * u2)) ? (s *= d = 1 / d, l *= d, u2 *= d) : u2 = l = s = 0, e[0] = n, e[1] = s, e[2] = c2, e[3] = 0, e[4] = o, e[5] = l, e[6] = h, e[7] = 0, e[8] = a2, e[9] = u2, e[10] = f2, e[11] = 0, e[12] = -(n * _ + o * p2 + a2 * g), e[13] = -(s * _ + l * p2 + u2 * g), e[14] = -(c2 * _ + h * p2 + f2 * g), e[15] = 1, e);
        }
        var copy_1 = copy;
        function copy(e, t2) {
          return e[0] = t2[0], e[1] = t2[1], e[2] = t2[2], e[3] = t2[3], e[4] = t2[4], e[5] = t2[5], e[6] = t2[6], e[7] = t2[7], e[8] = t2[8], e[9] = t2[9], e[10] = t2[10], e[11] = t2[11], e[12] = t2[12], e[13] = t2[13], e[14] = t2[14], e[15] = t2[15], e;
        }
        var invert_1$1 = invert$1;
        function invert$1(e, t2) {
          var r = t2[0], i2 = t2[1], n = t2[2], o = t2[3], a2 = t2[4], s = t2[5], l = t2[6], u2 = t2[7], c2 = t2[8], h = t2[9], f2 = t2[10], d = t2[11], _ = t2[12], p2 = t2[13], g = t2[14], m = t2[15], y = r * s - i2 * a2, v = r * l - n * a2, x2 = r * u2 - o * a2, b2 = i2 * l - n * s, T2 = i2 * u2 - o * s, A2 = n * u2 - o * l, E2 = c2 * p2 - h * _, w = c2 * g - f2 * _, S2 = c2 * m - d * _, k = h * g - f2 * p2, P2 = h * m - d * p2, R2 = f2 * m - d * g, M2 = y * R2 - v * P2 + x2 * k + b2 * S2 - T2 * w + A2 * E2;
          return M2 ? (M2 = 1 / M2, e[0] = (s * R2 - l * P2 + u2 * k) * M2, e[1] = (n * P2 - i2 * R2 - o * k) * M2, e[2] = (p2 * A2 - g * T2 + m * b2) * M2, e[3] = (f2 * T2 - h * A2 - d * b2) * M2, e[4] = (l * S2 - a2 * R2 - u2 * w) * M2, e[5] = (r * R2 - n * S2 + o * w) * M2, e[6] = (g * x2 - _ * A2 - m * v) * M2, e[7] = (c2 * A2 - f2 * x2 + d * v) * M2, e[8] = (a2 * P2 - s * S2 + u2 * E2) * M2, e[9] = (i2 * S2 - r * P2 - o * E2) * M2, e[10] = (_ * T2 - p2 * x2 + m * y) * M2, e[11] = (h * x2 - c2 * T2 - d * y) * M2, e[12] = (s * w - a2 * k - l * E2) * M2, e[13] = (r * k - i2 * w + n * E2) * M2, e[14] = (p2 * v - _ * b2 - g * y) * M2, e[15] = (c2 * b2 - h * v + f2 * y) * M2, e) : null;
        }
        var transformMat4_1$1 = transformMat4$1;
        function transformMat4$1(e, t2, r) {
          var i2 = t2[0], n = t2[1], o = t2[2], a2 = t2[3];
          return e[0] = r[0] * i2 + r[4] * n + r[8] * o + r[12] * a2, e[1] = r[1] * i2 + r[5] * n + r[9] * o + r[13] * a2, e[2] = r[2] * i2 + r[6] * n + r[10] * o + r[14] * a2, e[3] = r[3] * i2 + r[7] * n + r[11] * o + r[15] * a2, e;
        }
        var normalize_1 = normalize$1;
        function normalize$1(e, t2) {
          var r = t2[0], i2 = t2[1], n = t2[2], o = t2[3], a2 = r * r + i2 * i2 + n * n + o * o;
          return 0 < a2 && (a2 = 1 / Math.sqrt(a2), e[0] = r * a2, e[1] = i2 * a2, e[2] = n * a2, e[3] = o * a2), e;
        }
        var scale_1$1 = scale$1;
        function scale$1(e, t2, r) {
          return e[0] = t2[0] * r, e[1] = t2[1] * r, e[2] = t2[2] * r, e[3] = t2[3] * r, e;
        }
        var vec3 = { fromValues: function(e, t2, r) {
          var i2 = new Float64Array(3);
          return i2[0] = e, i2[1] = t2, i2[2] = r, i2;
        }, transformMat4: transformMat4_1 }, mat3 = { normalFromMat4: normalFromMat4_1, invert: invert_1, identity: identity_1 }, mat4 = { multiply: multiply_1, translate: translate_1, scale: scale_1, perspective: perspective_1, lookAt: lookAt_1, identity: identity_1$1, copy: copy_1, invert: invert_1$1 }, vec4 = { transformMat4: transformMat4_1$1, normalize: normalize_1, scale: scale_1$1 }, FeatureSelection = function() {
          function b2(e, t2) {
            _classCallCheck(this, b2), this._gl = e, this._requests = {}, this._pixels = null, this._has_dirty_buffer = false, this._fbo = this._gl.createFramebuffer(), this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, this._fbo), this._fbo_size = { width: 256, height: 256 };
            var r = getTextureManager(t2).create(this._gl, "selection_fbo", { filtering: "nearest" });
            r.setData(this._fbo_size.width, this._fbo_size.height, null, { filtering: "nearest" }), this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER, this._gl.COLOR_ATTACHMENT0, this._gl.TEXTURE_2D, r.texture, 0);
            var i2 = this._gl.createRenderbuffer();
            this._gl.bindRenderbuffer(this._gl.RENDERBUFFER, i2), this._gl.renderbufferStorage(this._gl.RENDERBUFFER, this._gl.DEPTH_COMPONENT16, this._fbo_size.width, this._fbo_size.height), this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER, this._gl.DEPTH_ATTACHMENT, this._gl.RENDERBUFFER, i2), this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);
          }
          return _createClass(b2, [{ key: "destroy", value: function() {
            this._gl && this._fbo && (this._gl.deleteFramebuffer(this._fbo), this._fbo = null, this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null));
          } }, { key: "bind", value: function() {
            var e;
            this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, this._fbo), this._gl.viewport(0, 0, this._fbo_size.width, this._fbo_size.height), (e = this._gl).clearColor.apply(e, _toConsumableArray(b2.defaultColor));
          } }, { key: "getFeatureAt", value: function(e, t2, r) {
            var i2 = t2.radius, n = t2.top_most_only, o = void 0 === n || n;
            !e || e.x < 0 || e.y < 0 || 1 < e.x || 1 < e.y ? r({ features: null }) : (this.selection_request_id = this.selection_request_id + 1 || 0, this._requests[this.selection_request_id] = { id: this.selection_request_id, point: e, radius: i2, top_most_only: o, ttl: o ? 1 : b2.MAX_PICKING_TRIES, callback: r });
          } }, { key: "hasPendingRequests", value: function() {
            return 0 < Object.keys(this._requests).length;
          } }, { key: "clearPendingRequests", value: function() {
            for (var e in this._requests) {
              this._requests[e].callback(new Error("cleared")), delete this._requests[e];
            }
            this._pending_deep_request = null;
          } }, { key: "read", value: function(e) {
            if (this.hasPendingRequests()) {
              var t2 = this._gl;
              for (var r in t2.bindFramebuffer(t2.FRAMEBUFFER, this._fbo), this._pending_deep_request && this.processRequest(this._pending_deep_request, e), this._requests)
                if (this.processRequest(this._requests[r], e))
                  break;
              t2.bindFramebuffer(t2.FRAMEBUFFER, null);
            }
          } }, { key: "processRequest", value: function(e, t2) {
            var r, i2, n, o = this._gl, a2 = 255, s = e.point, l = e.radius, u2 = (n = l ? (i2 = Math.min(this._fbo_size.width, this._fbo_size.height), { x: Math.min(Math.ceil(2 * l.x * this._fbo_size.width), i2), y: Math.min(Math.ceil(2 * l.y * this._fbo_size.height), i2) }) : (l = { x: 0, y: 0 }, { x: 1, y: 1 })).x * n.y * 4;
            if (null == this._pixels || this._pixels.byteLength < u2)
              this._pixels = new Uint8Array(u2);
            else if (this._pixels.fill instanceof Function)
              this._pixels.fill(0, 0, u2);
            else
              for (var c2 = 0; c2 < u2; c2++)
                this._pixels[c2] = 0;
            o.readPixels(Math.round((s.x - l.x) * this._fbo_size.width), Math.round((1 - s.y - l.y) * this._fbo_size.height), n.x, n.y, o.RGBA, o.UNSIGNED_BYTE, this._pixels), e.ttl--;
            var h = Math.floor(n.x / 2), f2 = Math.floor(n.y / 2), d = 4 * (f2 * n.x + h), _ = this._pixels.slice(d, d + 4), p2 = _[0] + (_[1] << 8) + (_[2] << 16);
            if (0 < p2)
              r = p2 + (_[3] << 24) >>> 0, a2 = _[3];
            else if (4 < u2)
              for (var g = 1 / 0, d = 0, m = 0; m < n.y; m++)
                for (var y, v = 0; v < n.x; v++, d += 4) {
                  0 < (p2 = (_ = this._pixels.slice(d, d + 4))[0] + (_[1] << 8) + (_[2] << 16)) && ((y = Math.pow(v - h, 2) + Math.pow(m - f2, 2)) < g && (r = p2 + (_[3] << 24) >>> 0, a2 = _[3], g = y));
                }
            if (255 !== a2) {
              var x2 = this._getFeatureByKey(r, t2);
              if (e.features || (e.features = []), !x2)
                return void this._finishRead(e);
              if (e.features.every(function(e2) {
                return e2.id !== x2.id;
              }) && e.features.push(x2), e.ttl)
                return this._pending_deep_request = e, b2._discardColor(_), this._has_dirty_buffer = true;
              this._finishRead(e);
            } else
              this._finishRead(e);
          } }, { key: "_finishRead", value: function(e) {
            var t2 = e.features || b2.EMPTY_ARRAY;
            e.top_most_only || (this._pending_deep_request = null, b2._resetDiscardedColors()), delete this._requests[e.id], e.callback({ features: t2 });
          } }, { key: "_getFeatureByKey", value: function(e, t2) {
            for (var r = null, i2 = 0; i2 < t2.length; i2++) {
              var n = t2[i2];
              if (n.selection_data && (r = n.selection_data[e])) {
                r.tile = { coords: n.coords };
                break;
              }
            }
            return r;
          } }, { key: "setupDiscards", value: function(e) {
            for (var t2 = b2.MAX_PICKING_TRIES; t2--; )
              e.uniform("4fv", "u_selection_discard".concat(t2), b2._discarded_colors[t2] || b2.defaultColor);
          } }, { key: "has_dirty_buffer", get: function() {
            return this._has_dirty_buffer;
          }, set: function() {
            this._has_dirty_buffer = !!this._pending_deep_request;
          } }], [{ key: "makeEntry", value: function() {
            this.map_entry++;
            var e = 255 & this.map_entry, t2 = this.map_entry >> 8 & 255, r = this.map_entry >> 16 & 255, i2 = this.map_prefix;
            return { key: e + (t2 << 8) + (r << 16) + (i2 << 24) >>> 0, color: [e / 255, t2 / 255, r / 255, i2 / 255] };
          } }, { key: "reset", value: function() {
            this.map_entry = 0;
          } }, { key: "setPrefix", value: function(e) {
            this.map_prefix = e;
          } }, { key: "_discardColor", value: function(e) {
            this._discarded_colors.push([e[0] / 255, e[1] / 255, e[2] / 255, e[3] / 255]);
          } }, { key: "_resetDiscardedColors", value: function() {
            this._discarded_colors.length = 0;
          } }]), b2;
        }();
        FeatureSelection._discarded_colors = [], FeatureSelection.map_entry = 0, FeatureSelection.map_prefix = 0, FeatureSelection.defaultColor = [0, 0, 0, 1], FeatureSelection.MAX_PICKING_TRIES = 10, FeatureSelection.EMPTY_ARRAY = Object.freeze([]);
        var GLSL = { parseUniforms: function(e) {
          var t2 = [];
          for (var r in e) {
            var i2, n = r, o = e[r];
            if ("number" == typeof o)
              t2.push({ type: "float", method: "1f", name: r, value: o, key: n, uniforms: e });
            else if (Array.isArray(o)) {
              if ("number" == typeof o[0])
                2 <= o.length && o.length <= 4 ? t2.push({ type: "vec" + o.length, method: o.length + "fv", name: r, value: o, key: n, uniforms: e }) : 4 < o.length && t2.push({ type: "float[]", method: "1fv", name: r + "[0]", value: o, key: n, uniforms: e });
              else if ("string" == typeof o[0])
                for (i2 = 0; i2 < o.length; i2++)
                  t2.push({ type: "sampler2D", method: "1i", name: r + "[" + i2 + "]", value: o[i2], key: i2, uniforms: o });
              else if (Array.isArray(o[0]) && "number" == typeof o[0][0] && 2 <= o[0].length && o[0].length <= 4)
                for (i2 = 0; i2 < o.length; i2++)
                  t2.push({ type: "vec" + o[0].length, method: o[i2].length + "fv", name: r + "[" + i2 + "]", value: o[i2], key: i2, uniforms: o });
            } else
              "boolean" == typeof o ? t2.push({ type: "bool", method: "1i", name: r, value: o, key: n, uniforms: e }) : "string" == typeof o && t2.push({ type: "sampler2D", method: "1i", name: r, value: o, key: n, uniforms: e });
          }
          return t2;
        }, defineVariable: function(e, t2) {
          var r, i2;
          if ("number" == typeof t2)
            r = "float";
          else if (Array.isArray(t2))
            "number" == typeof t2[0] ? 2 <= t2.length && t2.length <= 4 ? r = "vec" + t2.length : (r = "float", i2 = t2.length) : "string" == typeof t2[0] && (r = "sampler2D", i2 = t2.length);
          else if ("boolean" == typeof t2)
            r = "bool";
          else {
            if ("string" != typeof t2)
              return;
            r = "sampler2D";
          }
          var n = "";
          return n += "".concat(r, " ").concat(e), i2 && (n += "[".concat(i2, "]")), n += ";\n";
        }, defineUniform: function(e, t2) {
          var r = GLSL.defineVariable(e, t2);
          if (r)
            return "uniform " + r;
        }, isUniformDefined: function(e, t2) {
          var r = new RegExp("uniform[^;]+(?:{[\\s\\S]*})?[^;]*\\b" + e + "\\b", "g");
          return !!t2.match(r);
        }, isSymbolReferenced: function(e, t2) {
          var r = new RegExp("\\b" + e + "\\b", "g");
          return 0 <= t2.search(r);
        }, expandVec3: function(e) {
          var t2, r = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 1;
          if (Array.isArray(e)) {
            if (2 !== e.length)
              return e;
            t2 = [].concat(_toConsumableArray(e), [r]).map(parseFloat);
          } else
            t2 = [e, e, e].map(parseFloat);
          if (t2 && t2.every(function(e2) {
            return "number" == typeof e2 && !isNaN(e2);
          }))
            return t2;
        }, expandVec4: function(e) {
          var t2, r = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 1;
          if (Array.isArray(e)) {
            if (3 !== e.length)
              return e;
            t2 = [].concat(_toConsumableArray(e), [r]).map(parseFloat);
          } else
            t2 = [e, e, e, r].map(parseFloat);
          if (t2 && t2.every(function(e2) {
            return "number" == typeof e2 && !isNaN(e2);
          }))
            return t2;
        } }, extensions = [];
        function getExtension(t2, e) {
          var r = extensions.filter(function(e2) {
            return e2[0] === t2;
          })[0];
          return (r = r && r[1]) || (extensions.push([t2, {}]), r = extensions[extensions.length - 1][1]), r[e] || (r[e] = t2.getExtension(e)), r[e];
        }
        function hashString(e) {
          var t2, r, i2 = 0;
          if (0 === e.length)
            return i2;
          for (t2 = 0, r = e.length; t2 < r; t2++)
            i2 = (i2 << 5) - i2 + e.charCodeAt(t2), i2 |= 0;
          return i2;
        }
        var stripComments = createCommonjsModule(function(e) {
          var i2 = "(.|[\\r\\n]|\\n)*?\\*\\/\\n?\\n?", n = /(^|[^\S\n])(?:\/\/)([\s\S]+?)$/gm, o = /(^|[^\S\n])(?:\/\/[^!])([\s\S]+?)$/gm, r = e.exports = function(e2, t2) {
            return e2 ? r.block(r.line(e2, t2), t2) : "";
          };
          r.block = function(e2, t2) {
            t2 = t2 || {};
            var r2 = new RegExp("\\/\\*" + i2, "gm");
            return t2.safe && (r2 = new RegExp("\\/\\*(?!\\*?\\!)" + i2, "gm")), e2 ? e2.replace(r2, "") : "";
          }, r.line = function(e2, t2) {
            var r2 = n;
            return (t2 = t2 || {}).safe && (r2 = o), e2 ? e2.replace(r2, "") : "";
          };
        }), glShaderErrors = parseErrors;
        function parseErrors(e) {
          e = String(e);
          for (var t2, r = []; t2 = e.match(/ERROR\:([^\n]+)/); ) {
            e = e.slice(t2.index + 1);
            var i2 = (a2 = t2[1].trim()).split(":"), n = i2.slice(2).join(":").trim(), o = parseInt(i2[0], 10), a2 = parseInt(i2[1], 10);
            r.push({ message: n, file: o, line: a2 });
          }
          return r;
        }
        var re_pragma = /^\s*#pragma.*$/gm, re_continue_line = /\\\s*\n/gm, ShaderProgram = function() {
          function f2(e, t2, r, i2, n) {
            if (_classCallCheck(this, f2), n = n || {}, this.textureManager = getTextureManager(i2), this.gl = e, this.program = null, this.compiled = false, this.compiling = false, this.error = null, !f2.polyfills[i2]) {
              f2.polyfills[i2] = {};
              try {
                this.gl.uniformMatrix3fv(null, false, new Float64Array(9));
              } catch (e2) {
                f2.polyfills[i2].uniformMatrix3fv = this.gl.uniformMatrix3fv, this.gl.uniformMatrix3fv = function(e3, t3, r2) {
                  f2.polyfills[i2].uniformMatrix3fv.call(this, e3, t3, new Float32Array(r2));
                };
              }
              try {
                this.gl.uniformMatrix4fv(null, false, new Float64Array(16));
              } catch (e2) {
                f2.polyfills[i2].uniformMatrix4fv = this.gl.uniformMatrix4fv, this.gl.uniformMatrix4fv = function(e3, t3, r2) {
                  f2.polyfills[i2].uniformMatrix4fv.call(this, e3, t3, new Float32Array(r2));
                };
              }
            }
            this.defines = Object.assign({}, n.defines || {}), this.blocks = Object.assign({}, n.blocks || {}), this.block_scopes = Object.assign({}, n.block_scopes || {}), this.extensions = n.extensions || [], this.dependent_uniforms = n.uniforms, this.uniforms = {}, this.attribs = {}, this.vertex_source = t2, this.fragment_source = r, this.id = f2.id++, this.name = n.name;
          }
          return _createClass(f2, [{ key: "destroy", value: function() {
            this.gl.useProgram(null), this.gl.deleteProgram(this.program), this.program = null, this.uniforms = {}, this.attribs = {}, this.compiled = false;
          } }, { key: "use", value: function() {
            this.compiled && (f2.current !== this && this.gl.useProgram(this.program), f2.current = this);
          } }, { key: "compile", value: function() {
            var r = this;
            if (this.compiling)
              throw new Error("ShaderProgram.compile(): skipping for ".concat(this.id, " (").concat(this.name, ") because already compiling"));
            this.compiling = true, this.compiled = false, this.error = null, this.computed_vertex_source = this.vertex_source, this.computed_fragment_source = this.fragment_source;
            var e, t2 = this.checkExtensions(), i2 = this.buildDefineList(), n = this.buildShaderBlockList();
            for (var o in n) {
              var a2, s, l, u2 = n[o];
              !u2 || Array.isArray(u2) && 0 === u2.length || (e = new RegExp("^\\s*#pragma\\s+tangram:\\s+" + o + "\\s*$", "m"), a2 = this.computed_vertex_source.match(e), s = this.computed_fragment_source.match(e), null == a2 && null == s || (l = "", u2.forEach(function(e2) {
                var t3 = "".concat(e2.scope, ", ").concat(e2.key, ", ").concat(e2.num);
                l += "\n// tangram-block-start: ".concat(t3, "\n"), l += e2.source, l += "\n// tangram-block-end: ".concat(t3, "\n");
              }), null != a2 && (this.computed_vertex_source = this.computed_vertex_source.replace(e, l)), null != s && (this.computed_fragment_source = this.computed_fragment_source.replace(e, l)), i2["TANGRAM_BLOCK_" + o.replace(/[\s-]+/g, "_").toUpperCase()] = true));
            }
            this.computed_vertex_source = this.computed_vertex_source.replace(re_pragma, ""), this.computed_fragment_source = this.computed_fragment_source.replace(re_pragma, ""), this.ensureUniforms(this.dependent_uniforms);
            var c2 = "", h = this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER, this.gl.HIGH_FLOAT), c2 = h && 0 < h.precision ? "precision highp float;\n" : "precision mediump float;\n";
            i2.TANGRAM_VERTEX_SHADER = true, i2.TANGRAM_FRAGMENT_SHADER = false, this.computed_vertex_source = c2 + f2.buildDefineString(i2) + this.computed_vertex_source, i2.TANGRAM_VERTEX_SHADER = false, i2.TANGRAM_FRAGMENT_SHADER = true, this.computed_fragment_source = f2.buildExtensionString(t2) + c2 + f2.buildDefineString(i2) + this.computed_fragment_source, this.computed_vertex_source = this.computed_vertex_source.replace(re_continue_line, ""), this.computed_fragment_source = this.computed_fragment_source.replace(re_continue_line, "");
            try {
              this.program = f2.updateProgram(this.gl, this.program, this.computed_vertex_source, this.computed_fragment_source), this.compiled = true, this.compiling = false;
            } catch (t3) {
              throw this.program = null, this.compiled = false, this.compiling = false, "vertex" !== (this.error = t3).type && "fragment" !== t3.type || (this.shader_errors = t3.errors, this.shader_errors.forEach(function(e2) {
                e2.type = t3.type, e2.block = r.block(t3.type, e2.line);
              })), t3;
            }
            this.computed_vertex_source = null, this.computed_fragment_source = null, this.use(), this.refreshUniforms(), this.refreshAttributes();
          } }, { key: "buildDefineList", value: function() {
            var e, t2 = {};
            for (e in f2.defines)
              t2[e] = f2.defines[e];
            for (e in this.defines)
              t2[e] = this.defines[e];
            return t2;
          } }, { key: "buildShaderBlockList", value: function() {
            var r, e, t2 = {};
            for (r in f2.blocks) {
              t2[r] = [], Array.isArray(f2.blocks[r]) ? (e = t2[r]).push.apply(e, _toConsumableArray(f2.blocks[r].map(function(e2, t3) {
                return { key: r, source: e2, num: t3, scope: "ShaderProgram" };
              }))) : t2[r] = [{ key: r, source: f2.blocks[r], num: 0, scope: "ShaderProgram" }];
            }
            for (r in this.blocks)
              if (t2[r] = t2[r] || [], Array.isArray(this.blocks[r]))
                for (var i2 = this.block_scopes && this.block_scopes[r] || [], n = null, o = 0, a2 = 0; a2 < this.blocks[r].length; a2++)
                  i2[a2] !== n && (n = i2[a2], o = 0), t2[r].push({ key: r, source: this.blocks[r][a2], num: o, scope: n || this.name }), o++;
              else
                t2[r].push({ key: r, source: this.blocks[r], num: 0, scope: this.name });
            return t2;
          } }, { key: "ensureUniforms", value: function(e) {
            if (e) {
              var t2, r = stripComments(this.computed_vertex_source), i2 = stripComments(this.computed_fragment_source), n = [], o = [];
              for (var a2 in e) {
                var s = GLSL.isUniformDefined(a2, r), l = GLSL.isUniformDefined(a2, i2);
                if (!s || !l) {
                  if (!(t2 = GLSL.defineUniform(a2, e[a2])))
                    continue;
                  s || (log("trace", "Program ".concat(this.name, ": ").concat(a2, " not defined in vertex shader, injecting: '").concat(t2, "'")), n.push(t2)), l || (log("trace", "Program ".concat(this.name, ": ").concat(a2, " not defined in fragment shader, injecting: '").concat(t2, "'")), o.push(t2));
                }
              }
              0 < n.length && (this.computed_vertex_source = n.join("\n") + this.computed_vertex_source), 0 < o.length && (this.computed_fragment_source = o.join("\n") + this.computed_fragment_source);
            }
          } }, { key: "setUniforms", value: function(e, t2) {
            var r = !(1 < arguments.length && void 0 !== t2) || t2;
            if (this.compiled) {
              r && (this.texture_unit = 0);
              for (var i2 = GLSL.parseUniforms(e), n = 0; n < i2.length; n++) {
                var o = i2[n];
                "sampler2D" === o.type ? this.setTextureUniform(o.name, o.value) : this.uniform(o.method, o.name, o.value);
              }
            }
          } }, { key: "saveUniforms", value: function(e) {
            var t2 = e || this.uniforms;
            for (var r in t2) {
              var i2 = this.uniforms[r];
              i2 && (i2.saved_value = i2.value);
            }
            this.saved_texture_unit = this.texture_unit || 0;
          } }, { key: "restoreUniforms", value: function(e) {
            var t2 = e || this.uniforms;
            for (var r in t2) {
              var i2 = this.uniforms[r];
              i2 && i2.saved_value && (i2.value = i2.saved_value, this.updateUniform(i2));
            }
            this.texture_unit = this.saved_texture_unit || 0;
          } }, { key: "setTextureUniform", value: function(e, t2) {
            var r = this.textureManager.textures[t2];
            null != r ? (r.bind(this.texture_unit), this.uniform("1i", e, this.texture_unit), this.texture_unit++) : log("warn", "Cannot find texture '".concat(t2, "'"));
          } }, { key: "uniform", value: function(e, t2, r) {
            var i2;
            this.compiled && (this.uniforms[t2] = this.uniforms[t2] || {}, i2 = this.uniforms[t2], i2.name = t2, void 0 === i2.location && (i2.location = this.gl.getUniformLocation(this.program, t2)), i2.method = e, i2.value = r, this.updateUniform(i2));
          } }, { key: "updateUniform", value: function(e) {
            this.compiled && e && null != e.location && (this.use(), this.commitUniform(e));
          } }, { key: "commitUniform", value: function(e) {
            var t2 = e.location, r = e.value;
            switch (e.method) {
              case "1i":
                this.gl.uniform1i(t2, r);
                break;
              case "1f":
                this.gl.uniform1f(t2, r);
                break;
              case "2f":
                this.gl.uniform2f(t2, r[0], r[1]);
                break;
              case "3f":
                this.gl.uniform3f(t2, r[0], r[1], r[2]);
                break;
              case "4f":
                this.gl.uniform4f(t2, r[0], r[1], r[2], r[3]);
                break;
              case "1iv":
                this.gl.uniform1iv(t2, r);
                break;
              case "3iv":
                this.gl.uniform3iv(t2, r);
                break;
              case "1fv":
                this.gl.uniform1fv(t2, r);
                break;
              case "2fv":
                this.gl.uniform2fv(t2, r);
                break;
              case "3fv":
                this.gl.uniform3fv(t2, r);
                break;
              case "4fv":
                this.gl.uniform4fv(t2, r);
                break;
              case "Matrix3fv":
                this.gl.uniformMatrix3fv(t2, false, r);
                break;
              case "Matrix4fv":
                this.gl.uniformMatrix4fv(t2, false, r);
            }
          } }, { key: "refreshUniforms", value: function() {
            if (this.compiled)
              for (var e in this.uniforms) {
                var t2 = this.uniforms[e];
                t2.location = this.gl.getUniformLocation(this.program, e), this.updateUniform(t2);
              }
          } }, { key: "refreshAttributes", value: function() {
            this.attribs = {};
          } }, { key: "attribute", value: function(e) {
            if (this.compiled) {
              var t2 = this.attribs[e] = this.attribs[e] || {};
              return null != t2.location ? t2 : (t2.name = e, t2.location = this.gl.getAttribLocation(this.program, e), t2);
            }
          } }, { key: "source", value: function(e) {
            return "vertex" === e ? this.computed_vertex_source : "fragment" === e ? this.computed_fragment_source : void 0;
          } }, { key: "lines", value: function(e) {
            var t2 = this.source(e);
            return t2 ? t2.split("\n") : [];
          } }, { key: "line", value: function(e, t2) {
            var r = this.lines(e);
            if (r)
              return r[t2];
          } }, { key: "block", value: function(e, t2) {
            for (var r, i2 = this.lines(e), n = 0; n < t2 && n < i2.length; n++) {
              var o = i2[n], a2 = o.match(/\/\/ tangram-block-start: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/);
              a2 && 1 < a2.length ? r = { scope: a2[1], name: a2[2], num: a2[3] } : (a2 = o.match(/\/\/ tangram-block-end: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/)) && 1 < a2.length && (r = null), r && (r.line = null == r.line ? -1 : r.line + 1, r.source = o);
            }
            return r;
          } }, { key: "checkExtensions", value: function() {
            var i2 = this, n = [];
            return this.extensions.forEach(function(e) {
              var t2 = getExtension(i2.gl, e), r = "TANGRAM_EXTENSION_".concat(e);
              i2.defines[r] = null != t2, t2 ? n.push(e) : log("debug", "Could not enable extension '".concat(e, "'"));
            }), n;
          } }]), f2;
        }();
        ShaderProgram.polyfills = {}, ShaderProgram.id = 0, ShaderProgram.current = null, ShaderProgram.defines = {}, ShaderProgram.blocks = {}, ShaderProgram.reset = function() {
          ShaderProgram.programs_by_source = {}, ShaderProgram.shaders_by_source = {};
        }, ShaderProgram.reset(), ShaderProgram.buildDefineString = function(e) {
          var t2 = "";
          for (var r in e)
            null != e[r] && false !== e[r] && ("boolean" == typeof e[r] && true === e[r] ? t2 += "#define " + r + "\n" : "number" == typeof e[r] && Math.floor(e[r]) === e[r] ? t2 += "#define " + r + " " + e[r].toFixed(1) + "\n" : t2 += "#define " + r + " " + e[r] + "\n");
          return t2;
        }, ShaderProgram.buildExtensionString = function(e) {
          var t2 = "";
          return (e = e || []).forEach(function(e2) {
            t2 += "#ifdef GL_".concat(e2, "\n#extension GL_").concat(e2, " : enable\n#endif\n");
          }), t2;
        }, ShaderProgram.addBlock = function(e) {
          var t2;
          ShaderProgram.blocks[e] = ShaderProgram.blocks[e] || [];
          for (var r = arguments.length, i2 = new Array(1 < r ? r - 1 : 0), n = 1; n < r; n++)
            i2[n - 1] = arguments[n];
          (t2 = ShaderProgram.blocks[e]).push.apply(t2, i2);
        }, ShaderProgram.removeBlock = function(e) {
          ShaderProgram.blocks[e] = [];
        }, ShaderProgram.replaceBlock = function(e) {
          ShaderProgram.removeBlock(e);
          for (var t2 = arguments.length, r = new Array(1 < t2 ? t2 - 1 : 0), i2 = 1; i2 < t2; i2++)
            r[i2 - 1] = arguments[i2];
          ShaderProgram.addBlock.apply(ShaderProgram, [e].concat(r));
        }, ShaderProgram.updateProgram = function(e, t2, r, i2) {
          var n = hashString(e._tangram_id + "::" + r + "::" + i2);
          if (ShaderProgram.programs_by_source[n])
            return log("trace", "Reusing identical source GL program object"), ShaderProgram.programs_by_source[n];
          var o = ShaderProgram.createShader(e, r, e.VERTEX_SHADER), a2 = ShaderProgram.createShader(e, i2, e.FRAGMENT_SHADER);
          if (e.useProgram(null), null != t2)
            for (var s = e.getAttachedShaders(t2), l = 0; l < s.length; l++)
              e.detachShader(t2, s[l]);
          else
            t2 = e.createProgram();
          if (null == o || null == a2)
            return t2;
          if (e.attachShader(t2, o), e.attachShader(t2, a2), e.linkProgram(t2), e.getProgramParameter(t2, e.LINK_STATUS))
            return ShaderProgram.programs_by_source[n] = t2;
          var u2 = new Error("WebGL program error:\n            VALIDATE_STATUS: ".concat(e.getProgramParameter(t2, e.VALIDATE_STATUS), "\n            ERROR: ").concat(e.getError(), "\n            --- Vertex Shader ---\n            ").concat(r, "\n            --- Fragment Shader ---\n            ").concat(i2));
          throw Object.assign(new Error(u2), { type: "program" });
        }, ShaderProgram.createShader = function(e, t2, r) {
          var i2 = hashString(e._tangram_id + "::" + t2);
          if (ShaderProgram.shaders_by_source[i2])
            return log("trace", "Reusing identical source GL shader object"), ShaderProgram.shaders_by_source[i2];
          var n = e.createShader(r);
          if (e.shaderSource(n, t2), e.compileShader(n), e.getShaderParameter(n, e.COMPILE_STATUS))
            return ShaderProgram.shaders_by_source[i2] = n;
          var o = r === e.VERTEX_SHADER ? "vertex" : "fragment", a2 = e.getShaderInfoLog(n), s = glShaderErrors(a2);
          throw Object.assign(new Error(a2), { type: o, errors: s });
        };
        var VertexArrayObject = { disabled: false, bound_vao: [], init: function(e) {
          var t2;
          true !== this.disabled && (t2 = getExtension(e, "OES_vertex_array_object")), null != t2 ? log("info", "Vertex Array Object extension available") : true !== this.disabled ? log("warn", "Vertex Array Object extension NOT available") : log("warn", "Vertex Array Object extension force disabled");
        }, create: function(e, t2, r) {
          var i2 = {};
          i2.setup = t2, i2.teardown = r;
          var n = getExtension(e, "OES_vertex_array_object");
          return null != n && (i2._vao = n.createVertexArrayOES(), n.bindVertexArrayOES(i2._vao)), i2.setup(true), i2;
        }, getCurrentBinding: function(t2) {
          var e = this.bound_vao.filter(function(e2) {
            return e2[0] === t2;
          })[0];
          return e && e[1];
        }, setCurrentBinding: function(t2, e) {
          var r = this.bound_vao, i2 = r.filter(function(e2) {
            return e2[0] === t2;
          })[0];
          null == i2 ? r.push([t2, e]) : i2[1] = e;
        }, bind: function(e, t2) {
          var r, i2 = getExtension(e, "OES_vertex_array_object");
          null != t2 ? null != i2 && null != t2._vao ? (i2.bindVertexArrayOES(t2._vao), this.setCurrentBinding(e, t2)) : t2.setup(false) : (r = this.getCurrentBinding(e), null != i2 ? i2.bindVertexArrayOES(null) : null != r && "function" == typeof r.teardown && r.teardown(), this.setCurrentBinding(e, null));
        }, destroy: function(e, t2) {
          var r = getExtension(e, "OES_vertex_array_object");
          null != r && null != t2 && null != t2._vao && (r.deleteVertexArrayOES(t2._vao), t2._vao = null);
        } }, VBOMesh = function() {
          function a2(e, t2, r, i2, n, o) {
            _classCallCheck(this, a2), o = o || {}, this.textureManager = getTextureManager(n), this.gl = e, this.vertex_data = t2, this.element_data = r, this.vertex_layout = i2, this.vertex_buffer = this.gl.createBuffer(), this.buffer_size = this.vertex_data.byteLength, this.draw_mode = o.draw_mode || this.gl.TRIANGLES, this.data_usage = o.data_usage || this.gl.STATIC_DRAW, this.vertices_per_geometry = 3, this.uniforms = o.uniforms, this.textures = o.textures, this.retain = o.retain || false, this.created_at = +/* @__PURE__ */ new Date(), this.fade_in_time = o.fade_in_time || 0, this.vertex_count = this.vertex_data.byteLength / this.vertex_layout.stride, this.element_count = 0, this.vaos = {}, this.toggle_element_array = false, this.element_data ? (this.toggle_element_array = true, this.element_count = this.element_data.length, this.geometry_count = this.element_count / this.vertices_per_geometry, this.element_type = this.element_data.constructor === Uint16Array ? this.gl.UNSIGNED_SHORT : this.gl.UNSIGNED_INT, this.element_buffer = this.gl.createBuffer(), this.buffer_size += this.element_data.byteLength, this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.element_buffer), this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER, this.element_data, this.data_usage)) : this.geometry_count = this.vertex_count / this.vertices_per_geometry, this.upload(), this.retain || (delete this.vertex_data, delete this.element_data), this.valid = true;
          }
          return _createClass(a2, [{ key: "render", value: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e ? e : {};
            if (!this.valid)
              return false;
            var r = t2.program || ShaderProgram.current;
            r.use(), this.uniforms && (r.saveUniforms(this.uniforms), r.setUniforms(this.uniforms, false));
            var i2 = (/* @__PURE__ */ new Date() - this.created_at) / 1e3;
            return r.uniform("1f", "u_visible_time", i2), this.bind(r), this.toggle_element_array ? this.gl.drawElements(this.draw_mode, this.element_count, this.element_type, 0) : this.gl.drawArrays(this.draw_mode, 0, this.vertex_count), VertexArrayObject.bind(this.gl, null), this.uniforms && r.restoreUniforms(this.uniforms), i2 < this.fade_in_time;
          } }, { key: "bind", value: function(t2) {
            var r = this, e = this.vaos[t2.id];
            e ? VertexArrayObject.bind(this.gl, e) : this.vaos[t2.id] = VertexArrayObject.create(this.gl, function(e2) {
              r.gl.bindBuffer(r.gl.ARRAY_BUFFER, r.vertex_buffer), r.toggle_element_array && r.gl.bindBuffer(r.gl.ELEMENT_ARRAY_BUFFER, r.element_buffer), r.vertex_layout.enable(r.gl, t2, e2);
            });
          } }, { key: "upload", value: function() {
            this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertex_buffer), this.gl.bufferData(this.gl.ARRAY_BUFFER, this.vertex_data, this.data_usage);
          } }, { key: "destroy", value: function() {
            var t2 = this;
            if (!this.valid)
              return false;
            for (var e in this.valid = false, this.vaos)
              VertexArrayObject.destroy(this.gl, this.vaos[e]);
            return this.gl.deleteBuffer(this.vertex_buffer), this.vertex_buffer = null, this.element_buffer && (this.gl.deleteBuffer(this.element_buffer), this.element_buffer = null), delete this.vertex_data, delete this.element_data, this.textures && this.textures.forEach(function(e2) {
              return t2.textureManager.release(e2);
            }), true;
          } }]), a2;
        }(), shaderSrc_material = "/*Defines globals:materiallight_accumulator_**/struct Material{\n#ifdef TANGRAM_MATERIAL_EMISSION\nvec4 emission;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nvec3 emissionScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT\nvec4 ambient;\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nvec3 ambientScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nvec4 diffuse;\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nvec3 diffuseScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 specular;float shininess;\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nvec3 specularScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvec3 normalScale;float normalAmount;\n#endif\n};uniform Material u_material;Material material;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nuniform sampler2D u_material_emission_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nuniform sampler2D u_material_ambient_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nuniform sampler2D u_material_diffuse_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nuniform sampler2D u_material_specular_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nuniform sampler2D u_material_normal_texture;\n#endif\nvec4 light_accumulator_ambient=vec4(vec3(0.0),1.);vec4 light_accumulator_diffuse=vec4(vec3(0.0),1.);\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 light_accumulator_specular=vec4(vec3(0.0),1.);\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_SPHEREMAP\nvec4 getSphereMap(in sampler2D _tex,in vec3 _eyeToPoint,in vec3 _normal,in vec2 _skew){vec3 eye=normalize(_eyeToPoint);eye.xy-=_skew;eye=normalize(eye);vec3 r=reflect(eye,_normal);r.z+=1.0;float m=2.*length(r);vec2 uv=r.xy/m+.5;return texture2D(_tex,uv);}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_TRIPLANAR\nvec3 getTriPlanarBlend(in vec3 _normal){vec3 blending=abs(_normal);blending=normalize(max(blending,0.00001));float b=(blending.x+blending.y+blending.z);return blending/b;}vec4 getTriPlanar(in sampler2D _tex,in vec3 _pos,in vec3 _normal,in vec3 _scale){vec3 blending=getTriPlanarBlend(_normal);vec4 xaxis=texture2D(_tex,fract(_pos.yz*_scale.x));vec4 yaxis=texture2D(_tex,fract(_pos.xz*_scale.y));vec4 zaxis=texture2D(_tex,fract(_pos.xy*_scale.z));return xaxis*blending.x+yaxis*blending.y+zaxis*blending.z;}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_PLANAR\nvec4 getPlanar(in sampler2D _tex,in vec3 _pos,in vec2 _scale){return texture2D(_tex,fract(_pos.xy*_scale.x));}\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvoid calculateNormal(inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_UV\n_normal+=texture2D(u_material_normal_texture,fract(v_texcoord*material.normalScale.xy)).rgb*2.0-1.0;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_PLANAR\nvec3 normalTex=getPlanar(u_material_normal_texture,v_world_position.xyz,material.normalScale.xy).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_TRIPLANAR\nvec3 normalTex=getTriPlanar(u_material_normal_texture,v_world_position.xyz,_normal,material.normalScale).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n_normal=normalize(_normal);}\n#endif\nvoid calculateMaterial(in vec3 _eyeToPoint,inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_UV\nmaterial.emission*=texture2D(u_material_emission_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_PLANAR\nmaterial.emission*=getPlanar(u_material_emission_texture,v_world_position.xyz,material.emissionScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_TRIPLANAR\nmaterial.emission*=getTriPlanar(u_material_emission_texture,v_world_position.xyz,_normal,material.emissionScale);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_SPHEREMAP\nmaterial.emission*=getSphereMap(u_material_emission_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_UV\nmaterial.ambient*=texture2D(u_material_ambient_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_PLANAR\nmaterial.ambient*=getPlanar(u_material_ambient_texture,v_world_position.xyz,material.ambientScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_TRIPLANAR\nmaterial.ambient*=getTriPlanar(u_material_ambient_texture,v_world_position.xyz,_normal,material.ambientScale);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_SPHEREMAP\nmaterial.ambient*=getSphereMap(u_material_ambient_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_UV\nmaterial.diffuse*=texture2D(u_material_diffuse_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_PLANAR\nmaterial.diffuse*=getPlanar(u_material_diffuse_texture,v_world_position.xyz,material.diffuseScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_TRIPLANAR\nmaterial.diffuse*=getTriPlanar(u_material_diffuse_texture,v_world_position.xyz,_normal,material.diffuseScale);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_SPHEREMAP\nmaterial.diffuse*=getSphereMap(u_material_diffuse_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_UV\nmaterial.specular*=texture2D(u_material_specular_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_PLANAR\nmaterial.specular*=getPlanar(u_material_specular_texture,v_world_position.xyz,material.specularScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_TRIPLANAR\nmaterial.specular*=getTriPlanar(u_material_specular_texture,v_world_position.xyz,_normal,material.specularScale);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_SPHEREMAP\nmaterial.specular*=getSphereMap(u_material_specular_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n}", material_props = ["emission", "ambient", "diffuse", "specular"], Material = function() {
          function e(r) {
            var i2 = this;
            _classCallCheck(this, e), r = r || {}, material_props.forEach(function(e2) {
              var t2 = r[e2];
              null != t2 && (t2.texture ? i2[e2] = { texture: t2.texture, mapping: t2.mapping || "spheremap", scale: GLSL.expandVec3(null != t2.scale ? t2.scale : 1), amount: GLSL.expandVec4(null != t2.amount ? t2.amount : 1) } : "number" == typeof t2 || Array.isArray(t2) ? i2[e2] = { amount: GLSL.expandVec4(t2) } : i2[e2] = "string" == typeof t2 ? { amount: StyleParser.parseColor(t2) } : t2);
            }), this.specular && (this.specular.shininess = r.shininess ? parseFloat(r.shininess) : 0.2), null != r.normal && (this.normal = { texture: r.normal.texture, mapping: r.normal.mapping || "triplanar", scale: GLSL.expandVec3(null != r.normal.scale ? r.normal.scale : 1), amount: null != r.normal.amount ? r.normal.amount : 1 });
          }
          return _createClass(e, [{ key: "inject", value: function(i2) {
            var n = this;
            material_props.forEach(function(e2) {
              var t2 = "TANGRAM_MATERIAL_".concat(e2.toUpperCase()), r = t2 + "_TEXTURE";
              i2.defines[t2] = null != n[e2], n[e2] && n[e2].texture && (i2.defines[r] = true, i2.defines[r + "_" + n[e2].mapping.toUpperCase()] = true, i2.defines["TANGRAM_MATERIAL_TEXTURE_".concat(n[e2].mapping.toUpperCase())] = true, i2.texcoords = i2.texcoords || "uv" === n[e2].mapping);
            }), this.normal && this.normal.texture && (i2.defines.TANGRAM_MATERIAL_NORMAL_TEXTURE = true, i2.defines["TANGRAM_MATERIAL_NORMAL_TEXTURE_" + this.normal.mapping.toUpperCase()] = true, i2.defines["TANGRAM_MATERIAL_TEXTURE_".concat(this.normal.mapping.toUpperCase())] = true, i2.texcoords = i2.texcoords || "uv" === this.normal.mapping), i2.replaceShaderBlock(e.block, shaderSrc_material, "Material"), i2.addShaderBlock("setup", "\nmaterial = u_material;\n", "Material");
          } }, { key: "setupProgram", value: function(t2) {
            var r = this;
            material_props.forEach(function(e2) {
              r[e2] && (r[e2].texture ? (t2.setTextureUniform("u_material_".concat(e2, "_texture"), r[e2].texture), t2.uniform("3fv", "u_material.".concat(e2, "Scale"), r[e2].scale), t2.uniform("4fv", "u_material.".concat(e2), r[e2].amount)) : r[e2].amount && t2.uniform("4fv", "u_material.".concat(e2), r[e2].amount));
            }), this.specular && t2.uniform("1f", "u_material.shininess", this.specular.shininess), this.normal && this.normal.texture && (t2.setTextureUniform("u_material_normal_texture", this.normal.texture), t2.uniform("3fv", "u_material.normalScale", this.normal.scale), t2.uniform("1f", "u_material.normalAmount", this.normal.amount));
          } }], [{ key: "isValid", value: function(e2) {
            return null != e2 && (null != e2.emission || null != e2.ambient || null != e2.diffuse || null != e2.specular);
          } }]), e;
        }(), Vector;
        Material.block = "material";
        var Vector$1 = Vector = {};
        Vector.copy = function(e) {
          for (var t2 = [], r = e.length, i2 = 0; i2 < r; i2++)
            t2[i2] = e[i2];
          return t2;
        }, Vector.neg = function(e) {
          for (var t2 = [], r = e.length, i2 = 0; i2 < r; i2++)
            t2[i2] = -e[i2];
          return t2;
        }, Vector.add = function(e, t2) {
          for (var r = [], i2 = Math.min(e.length, t2.length), n = 0; n < i2; n++)
            r[n] = e[n] + t2[n];
          return r;
        }, Vector.sub = function(e, t2) {
          for (var r = [], i2 = Math.min(e.length, t2.length), n = 0; n < i2; n++)
            r[n] = e[n] - t2[n];
          return r;
        }, Vector.signed_area = function(e, t2, r) {
          return (t2[0] - e[0]) * (r[1] - e[1]) - (r[0] - e[0]) * (t2[1] - e[1]);
        }, Vector.mult = function(e, t2) {
          var r, i2 = [], n = e.length;
          if ("number" == typeof t2)
            for (r = 0; r < n; r++)
              i2[r] = e[r] * t2;
          else
            for (n = Math.min(e.length, t2.length), r = 0; r < n; r++)
              i2[r] = e[r] * t2[r];
          return i2;
        }, Vector.multMatrix = function(e, t2) {
          return [e[0][0] * t2[0] + e[0][1] * t2[1], e[1][0] * t2[0] + e[1][1] * t2[1]];
        }, Vector.div = function(e, t2) {
          var r = [];
          if ("number" == typeof t2)
            for (n = 0; n < e.length; n++)
              r[n] = e[n] / t2;
          else
            for (var i2 = Math.min(e.length, t2.length), n = 0; n < i2; n++)
              r[n] = e[n] / t2[n];
          return r;
        }, Vector.perp = function(e, t2) {
          return [t2[1] - e[1], e[0] - t2[0]];
        }, Vector.rot = function(e, t2) {
          var r = Math.cos(t2), i2 = Math.sin(t2);
          return [e[0] * r - e[1] * i2, e[0] * i2 + e[1] * r];
        }, Vector.angle = function(e) {
          var t2 = _slicedToArray(e, 2), r = t2[0], i2 = t2[1];
          return Math.atan2(i2, r);
        }, Vector.angleBetween = function(e, t2) {
          var r = Vector.dot(Vector.normalize(Vector.copy(e)), Vector.normalize(Vector.copy(t2)));
          return 1 < r && (r = 1), Math.acos(r);
        }, Vector.signedAngleBetween = function(e, t2) {
          return Math.atan2(e[0] * t2[1] - e[1] * t2[0], e[0] * t2[0] + e[1] * t2[1]);
        }, Vector.isEqual = function(e, t2) {
          for (var r = e.length, i2 = 0; i2 < r; i2++)
            if (e[i2] !== t2[i2])
              return false;
          return true;
        }, Vector.lengthSq = function(e) {
          return 2 === e.length ? e[0] * e[0] + e[1] * e[1] : 3 <= e.length ? e[0] * e[0] + e[1] * e[1] + e[2] * e[2] : 0;
        }, Vector.length = function(e) {
          return Math.sqrt(Vector.lengthSq(e));
        }, Vector.normalize = function(e) {
          var t2;
          if (2 === e.length) {
            if (1 === (t2 = e[0] * e[0] + e[1] * e[1]))
              return e;
            0 !== (t2 = Math.sqrt(t2)) ? (e[0] /= t2, e[1] /= t2) : (e[0] = 0, e[1] = 0);
          } else if (3 <= e.length) {
            if (1 === (t2 = e[0] * e[0] + e[1] * e[1] + e[2] * e[2]))
              return e;
            0 !== (t2 = Math.sqrt(t2)) ? (e[0] /= t2, e[1] /= t2, e[2] /= t2) : (e[0] = 0, e[1] = 0, e[2] = 0);
          }
          return e;
        }, Vector.cross = function(e, t2) {
          return 2 === e.length ? e[0] * t2[1] - e[1] * t2[0] : 3 === e.length ? [e[1] * t2[2] - e[2] * t2[1], e[2] * t2[0] - e[0] * t2[2], e[0] * t2[1] - e[1] * t2[0]] : void 0;
        }, Vector.dot = function(e, t2) {
          for (var r = 0, i2 = Math.min(e.length, t2.length), n = 0; n < i2; n++)
            r += e[n] * t2[n];
          return r;
        };
        var shaderSrc_ambientLight = "/*Expected globals:light_accumulator_**/struct AmbientLight{vec3 ambient;};void calculateLight(in AmbientLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;}", shaderSrc_directionalLight = "/*Expected globals:materiallight_accumulator_**/struct DirectionalLight{vec3 ambient;vec3 diffuse;vec3 specular;vec3 direction;};void calculateLight(in DirectionalLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;float nDotVP=clamp(dot(_normal,-_light.direction),0.0,1.0);\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(_light.direction,_normal);float eyeDotR=max(dot(normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf;\n#endif\n}", shaderSrc_pointLight = "/*Expected globals:materiallight_accumulator_**/struct PointLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\n};void calculateLight(in PointLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(VP,_normal),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nlight_accumulator_ambient.rgb+=_light.ambient*attenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(0.0,dot(-normalize(_eyeToPoint),reflectVector));pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation;\n#endif\n}", shaderSrc_spotLight = "/*Expected globals:materiallight_accumulator_**/struct SpotLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\nvec3 direction;float spotCosCutoff;float spotExponent;};void calculateLight(in SpotLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(_normal,VP),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nfloat spotAttenuation=0.0;float spotDot=clamp(dot(-VP,_light.direction),0.0,1.0);if(spotDot>=_light.spotCosCutoff){spotAttenuation=pow(spotDot,_light.spotExponent);}light_accumulator_ambient.rgb+=_light.ambient*attenuation*spotAttenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation*spotAttenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(dot(-normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation*spotAttenuation;\n#endif\n}", Light = function() {
          function s(e, t2) {
            _classCallCheck(this, s), this.name = t2.name, this.view = e, null == t2.ambient || "number" == typeof t2.ambient ? this.ambient = GLSL.expandVec3(t2.ambient || 0) : this.ambient = StyleParser.parseColor(t2.ambient).slice(0, 3), null == t2.diffuse || "number" == typeof t2.diffuse ? this.diffuse = GLSL.expandVec3(null != t2.diffuse ? t2.diffuse : 1) : this.diffuse = StyleParser.parseColor(t2.diffuse).slice(0, 3), null == t2.specular || "number" == typeof t2.specular ? this.specular = GLSL.expandVec3(t2.specular || 0) : this.specular = StyleParser.parseColor(t2.specular).slice(0, 3);
          }
          return _createClass(s, [{ key: "inject", value: function() {
            var e = "\n            uniform ".concat(this.struct_name, " u_").concat(this.name, ";\n            ").concat(this.struct_name, " ").concat(this.name, ";\n            "), t2 = "\n            ".concat(this.name, " = u_").concat(this.name, ";\n\n        ");
            ShaderProgram.addBlock(s.block, e), ShaderProgram.addBlock("setup", t2);
          } }, { key: "update", value: function() {
          } }, { key: "setupProgram", value: function(e) {
            e.uniform("3fv", "u_".concat(this.name, ".ambient"), this.ambient), e.uniform("3fv", "u_".concat(this.name, ".diffuse"), this.diffuse), e.uniform("3fv", "u_".concat(this.name, ".specular"), this.specular);
          } }], [{ key: "create", value: function(e, t2) {
            if (s.types[t2.type])
              return new s.types[t2.type](e, t2);
          } }, { key: "setMode", value: function(e, t2) {
            true === e && (e = "fragment"), e = s.enabled && (null != e ? e : "fragment"), t2.defines.TANGRAM_LIGHTING_FRAGMENT = "fragment" === e, t2.defines.TANGRAM_LIGHTING_VERTEX = "vertex" === e;
          } }, { key: "inject", value: function(e) {
            if (ShaderProgram.removeBlock(s.block), s.enabled) {
              var t2 = "";
              if (e && 0 < Object.keys(e).length) {
                var r = {};
                for (var i2 in e)
                  r[e[i2].type] = true;
                for (var n in r)
                  s.types[n].inject();
                for (var o in e)
                  e[o].inject(), t2 += "calculateLight(".concat(o, ", _eyeToPoint, _normal);\n");
              }
              var a2 = "\n            vec4 calculateLighting(in vec3 _eyeToPoint, in vec3 _normal, in vec4 _color) {\n\n                // Do initial material calculations over normal, emission, ambient, diffuse and specular values\n                calculateMaterial(_eyeToPoint,_normal);\n\n                // Un roll the loop of individual ligths to calculate\n                ".concat(t2, "\n\n                //  Final light intensity calculation\n                vec4 color = vec4(vec3(0.), _color.a); // start with vertex color alpha\n\n                #ifdef TANGRAM_MATERIAL_EMISSION\n                    color.rgb = material.emission.rgb;\n                    color.a *= material.emission.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_AMBIENT\n                    color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.ambient.rgb;\n                    color.a *= material.ambient.a;\n                #else\n                    #ifdef TANGRAM_MATERIAL_DIFFUSE\n                        color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.diffuse.rgb;\n                    #endif\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_DIFFUSE\n                    color.rgb += light_accumulator_diffuse.rgb * _color.rgb * material.diffuse.rgb;\n                    color.a *= material.diffuse.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_SPECULAR\n                    color.rgb += light_accumulator_specular.rgb * material.specular.rgb;\n                    color.a *= material.specular.a;\n                #endif\n\n                // Clamp final color\n                color = clamp(color, 0.0, 1.0);\n\n                return color;\n            }");
              ShaderProgram.addBlock(s.block, a2);
            }
          } }]), s;
        }();
        Light.types = {}, Light.block = "lighting", Light.enabled = true;
        var AmbientLight = function() {
          _inherits(n, Light);
          var i2 = _createSuper(n);
          function n(e, t2) {
            var r;
            return _classCallCheck(this, n), (r = i2.call(this, e, t2)).type = "ambient", r.struct_name = "AmbientLight", r;
          }
          return _createClass(n, [{ key: "setupProgram", value: function(e) {
            e.uniform("3fv", "u_".concat(this.name, ".ambient"), this.ambient);
          } }], [{ key: "inject", value: function() {
            ShaderProgram.addBlock(Light.block, shaderSrc_ambientLight);
          } }]), n;
        }();
        Light.types.ambient = AmbientLight;
        var DirectionalLight = function() {
          _inherits(o, Light);
          var n = _createSuper(o);
          function o(e, t2) {
            var r, i2;
            return _classCallCheck(this, o), (r = n.call(this, e, t2)).type = "directional", r.struct_name = "DirectionalLight", t2.direction ? r._direction = t2.direction : (i2 = Math.sin(60 * Math.PI / 180), r._direction = [Math.cos(135 * Math.PI / 180) * i2, Math.sin(135 * Math.PI / 180) * i2, -0.5]), null == t2.ambient && (r.ambient = GLSL.expandVec3(0.5)), r.direction = r._direction.map(parseFloat), r._initial_direction = [r.direction[0], r.direction[1], r.direction[2]], r;
          }
          return _createClass(o, [{ key: "update", value: function() {
            vec3.transformMat4(this.direction, this._initial_direction, this.view.lookAtManipulator.getTransformationMatrix());
          } }, { key: "setupProgram", value: function(e) {
            _get(_getPrototypeOf(o.prototype), "setupProgram", this).call(this, e), e.uniform("3fv", "u_".concat(this.name, ".direction"), this.direction);
          } }, { key: "direction", get: function() {
            return this._direction;
          }, set: function(e) {
            this._direction = Vector$1.normalize(Vector$1.copy(e));
          } }], [{ key: "inject", value: function() {
            ShaderProgram.addBlock(Light.block, shaderSrc_directionalLight);
          } }]), o;
        }();
        Light.types.directional = DirectionalLight;
        var PointLight = function() {
          _inherits(n, Light);
          var i2 = _createSuper(n);
          function n(e, t2) {
            var r;
            return _classCallCheck(this, n), (r = i2.call(this, e, t2)).type = "point", r.struct_name = "PointLight", r.position = t2.position || [0, 0, "100px"], r.position_eye = [], r.origin = t2.origin || "ground", r.attenuation = isNaN(parseFloat(t2.attenuation)) ? 0 : parseFloat(t2.attenuation), t2.radius ? Array.isArray(t2.radius) && 2 === t2.radius.length ? r.radius = t2.radius : r.radius = [null, t2.radius] : r.radius = null, r;
          }
          return _createClass(n, [{ key: "inject", value: function() {
            _get(_getPrototypeOf(n.prototype), "inject", this).call(this), ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT = 0 !== this.attenuation, ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS = null != this.radius && null != this.radius[0], ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS = null != this.radius;
          } }, { key: "update", value: function() {
            var e, t2, r, i3 = this.view.lookAtManipulator.getLookAtData().zoom;
            "world" === this.origin ? (t2 = (e = _slicedToArray(Geo$1.latLngToMeters(this.position), 2))[0], r = e[1], this.position_eye[0] = t2 - this.view.lookAtManipulator.getLookAtData().position[0], this.position_eye[1] = r - this.view.lookAtManipulator.getLookAtData().position[1], this.position_eye[2] = StyleParser.convertUnits(this.position[2], { zoom: i3, meters_per_pixel: Geo$1.metersPerPixel(i3) }), this.position_eye[2] = this.position_eye[2] - this.view.lookAtManipulator.getLookAtData().distance) : "ground" !== this.origin && "camera" !== this.origin || (this.position_eye = StyleParser.convertUnits(this.position, { zoom: i3, meters_per_pixel: Geo$1.metersPerPixel(i3) }), "ground" === this.origin && (this.position_eye[2] = this.position_eye[2] - this.view.lookAtManipulator.getLookAtData().distance)), this.position_eye[3] = 1;
          } }, { key: "setupProgram", value: function(e) {
            _get(_getPrototypeOf(n.prototype), "setupProgram", this).call(this, e), e.uniform("4fv", "u_".concat(this.name, ".position"), this.position_eye), ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT && e.uniform("1f", "u_".concat(this.name, ".attenuationExponent"), this.attenuation);
            var t2 = this.view.lookAtManipulator.getLookAtData().zoom;
            ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS && e.uniform("1f", "u_".concat(this.name, ".innerRadius"), StyleParser.convertUnits(this.radius[0], { zoom: t2, meters_per_pixel: Geo$1.metersPerPixel(t2) })), ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS && e.uniform("1f", "u_".concat(this.name, ".outerRadius"), StyleParser.convertUnits(this.radius[1], { zoom: t2, meters_per_pixel: Geo$1.metersPerPixel(t2) }));
          } }], [{ key: "inject", value: function() {
            ShaderProgram.addBlock(Light.block, shaderSrc_pointLight);
          } }]), n;
        }();
        Light.types.point = PointLight;
        var SpotLight = function() {
          _inherits(n, PointLight);
          var i2 = _createSuper(n);
          function n(e, t2) {
            var r;
            return _classCallCheck(this, n), (r = i2.call(this, e, t2)).type = "spotlight", r.struct_name = "SpotLight", r.direction = r._direction = (t2.direction || [0, 0, -1]).map(parseFloat), r._initial_direction = [r.direction[0], r.direction[1], r.direction[2]], r.exponent = t2.exponent ? parseFloat(t2.exponent) : 0.2, r.angle = t2.angle ? parseFloat(t2.angle) : 20, r;
          }
          return _createClass(n, [{ key: "setupProgram", value: function(e) {
            _get(_getPrototypeOf(n.prototype), "setupProgram", this).call(this, e), e.uniform("3fv", "u_".concat(this.name, ".direction"), this.direction), e.uniform("1f", "u_".concat(this.name, ".spotCosCutoff"), Math.cos(3.14159 * this.angle / 180)), e.uniform("1f", "u_".concat(this.name, ".spotExponent"), this.exponent);
          } }, { key: "update", value: function() {
            _get(_getPrototypeOf(n.prototype), "update", this).call(this), vec3.transformMat4(this.direction, this._initial_direction, this.view.lookAtManipulator.getTransformationMatrix());
          } }, { key: "direction", get: function() {
            return this._direction;
          }, set: function(e) {
            this._direction = Vector$1.normalize(Vector$1.copy(e));
          } }], [{ key: "inject", value: function() {
            ShaderProgram.addBlock(Light.block, shaderSrc_spotLight);
          } }]), n;
        }();
        function mergeObjects(e) {
          for (var t2 = 0; t2 < (arguments.length <= 1 ? 0 : arguments.length - 1); t2++) {
            var r = t2 + 1 < 1 || arguments.length <= t2 + 1 ? void 0 : arguments[t2 + 1];
            if (r)
              for (var i2 in r) {
                var n = r[i2];
                null === n || "object" !== _typeof(n) || Array.isArray(n) ? void 0 !== n && (e[i2] = n) : null === e[i2] || "object" !== _typeof(e[i2]) || Array.isArray(e[i2]) ? e[i2] = mergeObjects({}, n) : e[i2] = mergeObjects(e[i2], n);
              }
          }
          return e;
        }
        Light.types.spotlight = SpotLight;
        var shaderSrc_selectionFragment = "\n#ifdef TANGRAM_FEATURE_SELECTION\nvarying vec4 v_selection_color;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\ngl_FragColor=v_selection_color;\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}", shaderSrc_selectionCropFragment = "\n#pragma tangram: utils\n#ifdef TANGRAM_FEATURE_SELECTION\nuniform float u_meters_per_pixel;varying vec4 v_selection_color;varying vec4 v_local_space_position;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}else{gl_FragColor=v_selection_color;}\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}", shaderSrc_rasters = "#ifdef TANGRAM_FRAGMENT_SHADER\nuniform sampler2D u_raster;uniform vec3 u_raster_offset;\n#define sampleRaster() (texture2D(u_raster, v_modelpos_base_zoom.xy * u_raster_offset.z + u_raster_offset.xy))\n#endif\n", Style = { init: function(e) {
          var t2 = 0 < arguments.length && void 0 !== e ? e : {}, r = t2.generation, i2 = t2.styles, n = t2.sources, o = void 0 === n ? {} : n, a2 = t2.introspection, s = t2.id, l = void 0 !== s ? s + "/" : "";
          this.scene_id = s, this.textureManager = getTextureManager(s), this.main_thread_target = "".concat(l, "Style/").concat(this.name), this.setGeneration(r), this.styles = i2, this.sources = o, this.defines = this.hasOwnProperty("defines") && this.defines || {}, this.shaders = this.hasOwnProperty("shaders") && this.shaders || {}, this.introspection = a2 || false, this.selection = this.selection || this.introspection || false, this.compile_setup = false, this.program = null, this.selection_program = null, this.feature_style = {}, this.vertex_template = [], this.tile_data = {}, this.defines.TANGRAM_WORLD_POSITION_WRAP = 1e5, this.blend = this.blend || "opaque", this.defines["TANGRAM_BLEND_".concat(this.blend.toUpperCase())] = true, null == this.blend_order && (this.blend_order = -1), this.removeShaderBlock("setup"), this.material instanceof Material || (Material.isValid(this.material) || (this.material = StyleParser.defaults.material), this.material = new Material(this.material)), this.material.inject(this), Light.setMode(this.lighting, this), this.setupRasters(), this.initialized = true;
        }, destroy: function() {
          this.program && (this.program.destroy(), this.program = null), this.selection_program && (this.selection_program.destroy(), this.selection_program = null), WorkerBroker.removeTarget(this.main_thread_target), this.gl = null, this.initialized = false;
        }, reset: function() {
        }, baseStyle: function() {
          return this.base || this.name;
        }, setGeneration: function(e) {
          this.generation = e, Thread.is_main && WorkerBroker.addTarget(this.main_thread_target, this);
        }, fillVertexTemplate: function(e, t2, r, i2) {
          var n = i2.size, o = void 0 === (o = i2.offset) ? 0 : o, a2 = e.index[t2];
          if (void 0 !== a2)
            for (var s = 0; s < n; ++s) {
              var l = r.length > s ? r[s] : r;
              this.vertex_template[a2 + s + o] = l;
            }
          else
            log("warn", "Style: in style '".concat(this.name, "', no index found in vertex layout for attribute '").concat(t2, "'"));
        }, startData: function(e) {
          this.tile_data[e.id] = this.tile_data[e.id] || { meshes: {}, uniforms: {}, textures: [] };
        }, endData: function(e) {
          var t2 = this.tile_data[e.id];
          if (this.tile_data[e.id] = null, t2 && 0 < Object.keys(t2.meshes).length) {
            for (var r in t2.meshes) {
              var i2 = t2.meshes[r];
              0 !== i2.vertex_data.vertex_count ? (i2.vertex_data.end(), i2.vertex_elements = i2.vertex_data.element_buffer, i2.vertex_data = i2.vertex_data.vertex_buffer) : delete t2.meshes[r];
            }
            return e.mesh_data[this.name] = t2, this.buildRasterTextures(e, t2).then(function(e2) {
              return e2;
            });
          }
          return Promise.resolve(null);
        }, hasDataForTile: function(e) {
          return null != this.tile_data[e.id];
        }, getTileMesh: function(e, t2) {
          var r = this.tile_data[e.id].meshes;
          return null == r[t2.key] && (r[t2.key] = { variant: t2, vertex_data: this.vertexLayoutForMeshVariant(t2).createVertexData() }), r[t2.key];
        }, vertexLayoutForMeshVariant: function() {
          return this.vertex_layout;
        }, default_mesh_variant: { key: 0 }, style_mesh_variants: { default: { variants: { 0: { variant: { key: 0 }, times_unref: 0 } } } }, addMeshVariantForDraw: function(e, t2) {
          this.style_mesh_variants[e] || (this.style_mesh_variants[e] = { variants: {} });
          var r = this.computeVariantForDraw(t2);
          return this.style_mesh_variants[e].variants[r.key] = { variant: r, times_unref: 0 }, this.style_mesh_variants[e].variants[r.key].variant;
        }, getMeshVariantTypeForDraw: function(e) {
          return this.getMeshVariantType(this.base, e);
        }, getMeshVariantType: function(e, t2) {
          void 0 === e && (e = "default");
          var r = this.style_mesh_variants[e];
          if (void 0 === t2.variantKey || !r || !r.variants[t2.variantKey])
            return this.addMeshVariantForDraw(e, t2);
          var i2 = t2.variantKey, n = r.variants[i2];
          return n.times_unref = 0, n.variant;
        }, updateMeshVariantTypeCache: function(e) {
          for (var t2 in this.style_mesh_variants) {
            var r = this.style_mesh_variants[t2].variants;
            for (var i2 in r) {
              var n = r[i2];
              n.times_unref++, n.times_unref > e && ("default" !== t2 || 0 != +i2) && (delete r[i2], 0 === Object.keys(r).length && delete this.style_mesh_variants[t2]);
            }
          }
        }, computeVariantForDraw: function() {
          return this.default_mesh_variant;
        }, addFeature: function(e, t2, r) {
          var i2 = r.tile;
          this.tile_data[i2.id] || this.startData(i2);
          var n, o, a2, s, l = this.parseFeature(e, t2, r);
          l && (n = "lines" === this.base ? this.getMeshVariantTypeForDraw(t2) : this.getMeshVariantTypeForDraw(l), a2 = (o = this.getTileMesh(i2, n)).vertex_data.offset, s = o.vertex_data.vertex_count, 0 < this.buildGeometry(e.geometry, l, o, r) ? e.generation = this.generation : o.vertex_data.vertex_count > s && (o.vertex_data.vertex_buffer.fill(0, a2, o.vertex_data.offset), o.vertex_data.vertex_count = s, o.vertex_data.offset = a2));
        }, buildGeometry: function(e, t2, r, i2) {
          var n;
          return "Polygon" === e.type ? n = this.buildPolygons([e.coordinates], t2, r, i2) : "MultiPolygon" === e.type ? n = this.buildPolygons(e.coordinates, t2, r, i2) : "LineString" === e.type ? n = this.buildLines([e.coordinates], t2, r, i2) : "MultiLineString" === e.type ? n = this.buildLines(e.coordinates, t2, r, i2) : "Point" === e.type ? n = this.buildPoints([e.coordinates], t2, r, i2) : "MultiPoint" === e.type && (n = this.buildPoints(e.coordinates, t2, r, i2)), n;
        }, parseFeature: function(t2, e, r) {
          try {
            var i2, n, o, a2 = this.feature_style;
            if (a2.order = this.parseOrder(e.order, r), null == a2.order && "overlay" !== this.blend) {
              var s = "Layer '".concat(e.layers.join(", "), "', draw group '").concat(e.group, "': ");
              return s += "'order' parameter is required unless blend mode is 'overlay'", null != e.order && (s += "; 'order' was set to a dynamic value (e.g. string tied to feature property, ", s += "or JS function), but evaluated to null for one or more features"), void log({ level: "warn", once: true }, s);
            }
            if (!(a2 = this._parseFeature(t2, e, r)))
              return;
            return this.selection ? a2.interactive = StyleParser.evalProperty(this.introspection || e.interactive, r) : a2.interactive = false, true === a2.interactive ? (n = (i2 = FeatureSelection.makeEntry()).color, o = i2.key, a2.selection_color = n, r.tile.selection_data || (r.tile.selection_data = {}), r.tile.selection_data[o] = { id: t2.id || o, properties: t2.properties, source_name: r.source, source_layer: r.layer, layers: r.layers }) : a2.selection_color = FeatureSelection.defaultColor, a2;
          } catch (e2) {
            log("error", "Style.parseFeature: style parsing error", t2, a2, e2.stack);
          }
        }, _parseFeature: function() {
          return this.feature_style;
        }, preprocess: function(e, t2) {
          if (!e.preprocessed) {
            if (this.draw)
              for (var r in this.draw) {
                var i2 = this.draw[r];
                "object" !== _typeof(i2) || Array.isArray(i2) ? null == e[r] && (e[r] = i2) : e[r] = mergeObjects({}, i2, e[r]);
              }
            var n = t2 || "";
            if (!(e = this._preprocess(e, n)))
              return;
            e.preprocessed = true;
          }
          return e;
        }, _preprocess: function(e) {
          return e;
        }, parseOrder: function(e, t2) {
          return "number" != typeof e ? StyleParser.calculateOrder(e, t2) : e;
        }, scaleOrder: function(e) {
          return 2 * e;
        }, parseColor: function(e, t2) {
          return e ? StyleParser.evalCachedColorProperty(e, t2) : this.shaders.blocks.color || this.shaders.blocks.filter ? StyleParser.defaults.color : void 0;
        }, buildPolygons: function() {
          return 0;
        }, buildLines: function() {
          return 0;
        }, buildPoints: function() {
          return 0;
        }, setGL: function(e) {
          this.gl = e, this.max_texture_size = this.textureManager.getMaxTextureSize(this.gl);
        }, makeMesh: function(e, t2, r) {
          var i2 = 2 < arguments.length && void 0 !== r ? r : {}, n = this.vertexLayoutForMeshVariant(i2.variant);
          return new VBOMesh(this.gl, e, t2, n, this.scene_id, i2);
        }, render: function(e) {
          return e.render();
        }, getProgram: function(e) {
          var t2 = 0 < arguments.length && void 0 !== e ? e : "program";
          this.compileSetup();
          var r = this[t2];
          if (r && !r.error) {
            if (!r.compiled)
              try {
                r.compile();
              } catch (e2) {
                log("error", "Style: error compiling program for style '".concat(this.name, "' (program key '").concat(t2, "')"), this, e2.stack);
              }
            return r;
          }
        }, compileSetup: function() {
          if (!this.compile_setup) {
            if (!this.gl)
              throw new Error("style.compile(): skipping for ".concat(this.name, " because no GL context"));
            var e, t2 = this.buildDefineList();
            this.selection && ((e = Object.assign({}, t2)).TANGRAM_FEATURE_SELECTION = true);
            var r = this.shaders && this.shaders.blocks, i2 = this.shaders && this.shaders.block_scopes, n = Object.assign({}, this.shaders && this.shaders.uniforms);
            for (var o in n)
              null == n[o] && log({ level: "warn", once: true }, "Style '".concat(this.name, "' has invalid uniform '").concat(o, "': uniform values must be non-null"));
            var a2 = this.shaders && this.shaders.extensions;
            "string" == typeof a2 && (a2 = [a2]), this.program = new ShaderProgram(this.gl, this.vertex_shader_src, this.fragment_shader_src, this.scene_id, { name: this.name, defines: t2, uniforms: n, blocks: r, block_scopes: i2, extensions: a2 }), this.selection ? this.selection_program = new ShaderProgram(this.gl, this.vertex_shader_src, this.crop_by_tile ? shaderSrc_selectionCropFragment : shaderSrc_selectionFragment, this.scene_id, { name: this.name + " (selection)", defines: e, uniforms: n, blocks: r, block_scopes: i2, extensions: a2 }) : this.selection_program = null, this.compile_setup = true;
          }
        }, addShaderBlock: function(e, t2, r) {
          var i2 = 2 < arguments.length && void 0 !== r ? r : null;
          this.shaders.blocks = this.shaders.blocks || {}, this.shaders.blocks[e] = this.shaders.blocks[e] || [], this.shaders.blocks[e].push(t2), this.shaders.block_scopes = this.shaders.block_scopes || {}, this.shaders.block_scopes[e] = this.shaders.block_scopes[e] || [], this.shaders.block_scopes[e].push(i2);
        }, removeShaderBlock: function(e) {
          this.shaders.blocks && (this.shaders.blocks[e] = null);
        }, replaceShaderBlock: function(e, t2, r) {
          var i2 = 2 < arguments.length && void 0 !== r ? r : null;
          this.removeShaderBlock(e), this.addShaderBlock(e, t2, i2);
        }, buildDefineList: function() {
          var e = {};
          if (null != this.defines)
            for (var t2 in this.defines)
              e[t2] = this.defines[t2];
          if (null != this.shaders && null != this.shaders.defines)
            for (t2 in this.shaders.defines)
              e[t2] = this.shaders.defines[t2];
          return e;
        }, hasRasters: function() {
          return -1 < ["color", "normal", "custom"].indexOf(this.raster);
        }, setupRasters: function() {
          if (!Thread.is_main)
            return false;
          if (!this.hasRasters())
            return false;
          "color" === this.raster ? this.defines.TANGRAM_RASTER_TEXTURE_COLOR = true : "normal" === this.raster && (this.defines.TANGRAM_RASTER_TEXTURE_NORMAL = true);
          var e = false;
          for (var t2 in this.sources)
            if (this.sources[t2] instanceof RasterTileSource) {
              e = true;
              break;
            }
          return !!e && (this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING = true, this.replaceShaderBlock("raster", shaderSrc_rasters, "Raster"), true);
        }, buildRasterTextures: function(o, a2) {
          var t2 = this;
          if (!this.hasRasters())
            return Promise.resolve(a2);
          var s = {};
          return o.rasters.map(function(e) {
            return t2.sources[e];
          }).filter(function(e) {
            return e;
          }).forEach(function(e, t3) {
            var r;
            e instanceof RasterTileSource && (r = e.tileTexture(o), s[r.url] = r);
          }), 0 === Object.keys(s).length ? Promise.resolve(a2) : WorkerBroker.postMessage(this.main_thread_target + ".loadTextures", s).then(function(e) {
            if (!e || e.length < 1)
              return log("trace", "Missing texture info for tile ".concat(o.key)), null;
            if (e.some(function(e2) {
              return !e2.loaded;
            }))
              return null;
            a2.uniforms = a2.uniforms || {}, a2.textures = a2.textures || [];
            var t3, r, i2 = e[0].name, n = s[i2].coords;
            return a2.uniforms.u_raster = i2, a2.textures.push(i2), o.coords.z > n.z ? (t3 = o.coords.z - n.z, r = Math.pow(2, t3), a2.uniforms.u_raster_offset = [(o.coords.x % r + r) % r / r, (r - 1 - o.coords.y % r) / r, 1 / r]) : a2.uniforms.u_raster_offset = [0, 0, 1], a2;
          });
        }, loadTextures: function(e) {
          var t2 = this;
          return this.textureManager.createFromObject(this.gl, e).then(function() {
            return Promise.all(Object.keys(e).map(function(e2) {
              return t2.textureManager.textures[e2] && t2.textureManager.textures[e2].load();
            }).filter(function(e2) {
              return e2;
            }));
          }).then(function(e2) {
            return e2.forEach(function(e3) {
              return e3.retain();
            }), e2.map(function(e3) {
              return { name: e3.name, width: e3.width, height: e3.height, loaded: e3.loaded };
            });
          });
        }, setup: function() {
          this.setUniforms(), this.material.setupProgram(ShaderProgram.current);
        }, setUniforms: function() {
          var e = ShaderProgram.current;
          e && e.setUniforms(this.shaders && this.shaders.uniforms, true);
        }, render_states: { opaque: { depth_test: true, depth_write: true }, translucent: { depth_test: true, depth_write: true }, add: { depth_test: true, depth_write: false }, multiply: { depth_test: true, depth_write: false }, inlay: { depth_test: true, depth_write: false }, overlay: { depth_test: false, depth_write: false } }, default_blend_orders: { opaque: 0, add: 1, multiply: 2, inlay: 3, translucent: 4, overlay: 5 }, sortByBlendOrderWithinLayers: function(e) {
          var t2 = [], r = {};
          for (var i2 in e.forEach(function(e2) {
            var t3 = parseInt(e2.name, 10) || 0;
            r[t3] || (r[t3] = []), r[t3].push(e2);
          }), r)
            t2.push.apply(t2, _toConsumableArray(r[i2].sort(Style.blendOrderSort)));
          return t2;
        }, blendOrderSort: function(e, t2) {
          return "opaque" === e.blend || "opaque" === t2.blend ? "opaque" === e.blend && "opaque" === t2.blend ? e.name < t2.name ? -1 : 1 : "opaque" === e.blend ? -1 : 1 : e.blend_order < t2.blend_order || !(e.blend_order > t2.blend_order) && (Style.default_blend_orders[e.blend] < Style.default_blend_orders[t2.blend] || !(Style.default_blend_orders[e.blend] > Style.default_blend_orders[t2.blend]) && e.name < t2.name) ? -1 : 1;
        } }, id$1 = 0, build_id = 0, Tile = function() {
          function E2(e) {
            var t2 = e.coords, r = e.style_zoom, i2 = e.source, n = e.worker, o = e.view, a2 = e.sceneId;
            _classCallCheck(this, E2), this.textureManager = getTextureManager(a2), this.id = id$1++, this.worker = n, this.view = o, this.source = i2, this.generation = null, this.valid = true, this.proxy_for = null, this.proxy_depth = 0, this.proxied_as = null, this.fade_in = true, this.loading = false, this.loaded = false, this.built = false, this.labeled = false, this.error = null, this.style_zoom = r, this.coords = E2.normalizedCoordinate(t2, this.source, this.style_zoom), this.key = E2.key(this.coords, this.source, this.style_zoom), this.overzoom = Math.max(this.style_zoom - this.coords.z, 0), this.overzoom2 = Math.pow(2, this.overzoom), this.min = Geo$1.metersForTile(this.coords), this.max = Geo$1.metersForTile({ x: this.coords.x + 1, y: this.coords.y + 1, z: this.coords.z }), this.span = { x: this.max.x - this.min.x, y: this.max.y - this.min.y }, this.bounds = { sw: { x: this.min.x, y: this.max.y }, ne: { x: this.max.x, y: this.min.y } }, this.center_dist = 0, this.meters_per_pixel = Geo$1.metersPerPixel(this.style_zoom), this.meters_per_pixel_sq = this.meters_per_pixel * this.meters_per_pixel, this.units_per_pixel = Geo$1.units_per_pixel / this.overzoom2, this.units_per_meter_overzoom = Geo$1.unitsPerMeter(this.coords.z) * this.overzoom2, this.meshes = {}, this.new_mesh_styles = [];
          }
          return _createClass(E2, [{ key: "freeResources", value: function() {
            for (var e in this.meshes)
              this.meshes[e].forEach(function(e2) {
                return e2.destroy();
              });
            this.meshes = {};
          } }, { key: "destroy", value: function() {
            Task.removeForTile(this.id), this.workerMessage("self.removeTile", this.id), this.freeResources(), this.worker = null, this.valid = false;
          } }, { key: "buildAsMessage", value: function() {
            return { id: this.id, key: this.key, source: this.source.name, coords: this.coords, min: this.min, max: this.max, units_per_pixel: this.units_per_pixel, meters_per_pixel: this.meters_per_pixel, meters_per_pixel_sq: this.meters_per_pixel_sq, units_per_meter_overzoom: this.units_per_meter_overzoom, style_zoom: this.style_zoom, overzoom: this.overzoom, overzoom2: this.overzoom2, generation: this.generation };
          } }, { key: "workerMessage", value: function() {
            for (var e = arguments.length, t2 = new Array(e), r = 0; r < e; r++)
              t2[r] = arguments[r];
            return WorkerBroker.postMessage.apply(WorkerBroker, [this.worker].concat(t2));
          } }, { key: "build", value: function(e, t2) {
            var r = (1 < arguments.length && void 0 !== t2 ? t2 : {}).fade_in, i2 = void 0 === r || r;
            return this.generation = e, this.fade_in = i2, this.loaded || (this.loading = true, this.built = false, this.labeled = false), this.workerMessage("self.buildTile", { tile: this.buildAsMessage() });
          } }, { key: "buildMeshes", value: function(e, t2) {
            if (!this.error) {
              this.build_id = build_id++;
              var r = {}, i2 = this.mesh_data;
              if (i2)
                for (var n in i2) {
                  for (var o in i2[n].meshes) {
                    var a2 = i2[n].meshes[o];
                    if (a2.vertex_data) {
                      if (!e[n]) {
                        log("warn", "Could not create mesh because style '".concat(n, "' not found, for tile ").concat(this.key, ", aborting tile"));
                        break;
                      }
                      var s = Object.assign({}, i2[n]);
                      s.uniforms = Object.assign({}, s.uniforms, a2.uniforms), s.variant = a2.variant, a2.textures && (s.textures = a2.textures), a2.labels && (s.retain = true);
                      var l = e[n].makeMesh(a2.vertex_data, a2.vertex_elements, s);
                      l.variant = s.variant, l.labels = a2.labels, r[n] = r[n] || [], r[n].push(l), null == l.variant.order && (l.variant.order = r[n].length - 1);
                    }
                  }
                  r[n] && r[n].sort(function(e2, t3) {
                    var r2 = e2.variant.order, i3 = t3.variant.order;
                    return null != r2 && (null == i3 || r2 < i3) ? -1 : 1;
                  });
                }
              for (var u2 in delete this.mesh_data, r)
                this.meshes[u2] && this.meshes[u2].forEach(function(e2) {
                  return e2.destroy();
                }), this.meshes[u2] = r[u2], this.new_mesh_styles.push(u2);
              if (t2.done) {
                for (var c2 in this.meshes)
                  -1 === this.new_mesh_styles.indexOf(c2) && (this.meshes[c2].forEach(function(e2) {
                    return e2.destroy();
                  }), delete this.meshes[c2]);
                this.new_mesh_styles = [];
              }
            }
          } }, { key: "setProxyFor", value: function(e) {
            e ? (this.proxy_for = this.proxy_for || [], this.proxy_for.push(e), this.proxy_depth = 1, e.proxied_as = e.style_zoom > this.style_zoom ? "child" : "parent") : (this.proxy_for = null, this.proxy_depth = 0);
          } }, { key: "isProxy", value: function() {
            return null != this.proxy_for;
          } }, { key: "shouldProxyForStyle", value: function(t2) {
            return !this.proxy_for || this.proxy_for.some(function(e) {
              return null == e.meshes[t2];
            });
          } }, { key: "setupProgram", value: function(e, t2) {
            var r = e.model, i2 = e.model32;
            t2.uniform("4fv", "u_tile_origin", [this.min.x, this.min.y, this.style_zoom, this.coords.z]), t2.uniform("1f", "u_tile_proxy_depth", this.proxy_depth), mat4.identity(r), mat4.translate(r, r, vec3.fromValues(this.min.x, this.min.y, 0)), mat4.scale(r, r, vec3.fromValues(this.span.x / Geo$1.tile_scale, -1 * this.span.y / Geo$1.tile_scale, 1)), mat4.copy(i2, r), t2.uniform("Matrix4fv", "u_model", i2), t2.uniform("1i", "u_tile_fade_in", this.fade_in && "child" !== this.proxied_as);
          } }, { key: "merge", value: function(e) {
            return this.loading = e.loading, this.loaded = e.loaded, this.generation = e.generation, this.error = e.error, this.mesh_data = e.mesh_data, this.selection_data ? Object.assign(this.selection_data, e.selection_data) : this.selection_data = e.selection_data, this;
          } }], [{ key: "coord", value: function(e) {
            return { x: e.x, y: e.y, z: e.z, key: E2.coordKey(e) };
          } }, { key: "coordKey", value: function(e) {
            return e.x + "/" + e.y + "/" + e.z;
          } }, { key: "key", value: function(e, t2, r) {
            if (!(e.y < 0 || e.y >= 1 << e.z || e.z < 0))
              return [t2.name, r, e.x, e.y, e.z].join("/");
          } }, { key: "normalizedKey", value: function(e, t2, r) {
            return E2.key(E2.normalizedCoordinate(e, t2, r), t2, r);
          } }, { key: "normalizedCoordinate", value: function(e, t2) {
            return t2.zoom_bias && (e = E2.coordinateAtZoom(e, Math.max(0, e.z - t2.zoom_bias))), E2.coordinateWithMaxZoom(e, t2.max_zoom);
          } }, { key: "coordinateAtZoom", value: function(e, t2) {
            var r, i2 = e.x, n = e.y, o = e.z;
            return o !== t2 && (r = Math.pow(2, o - t2), i2 = Math.floor(i2 / r), n = Math.floor(n / r), o = t2), E2.coord({ x: i2, y: n, z: o });
          } }, { key: "coordinateWithMaxZoom", value: function(e, t2) {
            var r = e.x, i2 = e.y, n = e.z;
            return void 0 !== t2 && t2 < n ? E2.coordinateAtZoom({ x: r, y: i2, z: n }, t2) : E2.coord({ x: r, y: i2, z: n });
          } }, { key: "childrenForCoordinate", value: function(e) {
            var t2 = e.x, r = e.y, i2 = e.z, n = e.key;
            return E2.coord_children[n] || (i2++, t2 *= 2, r *= 2, E2.coord_children[n] = [E2.coord({ x: t2, y: r, z: i2 }), E2.coord({ x: t2 + 1, y: r, z: i2 }), E2.coord({ x: t2, y: r + 1, z: i2 }), E2.coord({ x: t2 + 1, y: r + 1, z: i2 })]), E2.coord_children[n];
          } }, { key: "isDescendant", value: function(e, t2) {
            if (t2.z > e.z) {
              var r = E2.coordinateAtZoom(t2, e.z), i2 = r.x, n = r.y;
              return e.x === i2 && e.y === n;
            }
            return false;
          } }, { key: "cancel", value: function(e) {
            e && (e.canceled = true, e.source_data && e.source_data.request_id && (Utils$1.cancelRequest(e.source_data.request_id), e.source_data.request_id = null), E2.abortBuild(e));
          } }, { key: "buildGeometry", value: function(e, t2) {
            var r = t2.scene_id, i2 = t2.layers, n = t2.styles, o = t2.global, a2 = t2.sources, s = t2.meshVariantMaxLife, l = e.source_data;
            for (var u2 in Collision.startTile(e.id, { apply_repeat_groups: true }), i2) {
              var c2 = i2[u2];
              if (c2 && c2.config_data) {
                if (c2.config_data.source === e.source)
                  for (var h = E2._getDataForSource(l, c2.config_data, u2), f2 = 0; f2 < h.length; f2++) {
                    var d = h[f2], _ = d.geom;
                    if (_)
                      for (var p2 = 0; p2 < _.features.length; p2++) {
                        var g = _.features[p2];
                        if (null != g.geometry) {
                          var m = StyleParser.getFeatureParseContext(g, e, o, a2);
                          m.winding = e.default_winding, m.source = e.source, m.layer = d.layer;
                          var y = c2.buildDrawGroups(m, true);
                          if (y)
                            for (var v in y) {
                              var x2 = y[v], b2 = x2.style || v, T2 = n[b2];
                              T2 ? null != (x2 = T2.preprocess(x2, e.source)) && false !== x2.visible && (m.layers = x2.layers, T2.addFeature(g, x2, m)) : log("warn", "Style '".concat(b2, "' not found, skipping layer '").concat(u2, "':"), x2, g);
                            }
                        }
                      }
                  }
              } else
                log("warn", "Layer ".concat(u2, " was defined without a geometry data source and will not be rendered."));
            }
            var A2 = E2._stylesForTile(e, n);
            E2._sendStyleGroups(e, A2, { scene_id: r, meshVariantMaxLife: s }, function(e2) {
              return e2.collision ? "collision" : "non-collision";
            });
          } }, { key: "_stylesForTile", value: function(e, t2) {
            var r = [];
            for (var i2 in t2)
              t2[i2].hasDataForTile(e) && r.push(t2[i2]);
            return r;
          } }, { key: "_sendStyleGroups", value: function(i2, e, t2, r) {
            var n = t2.scene_id, o = t2.meshVariantMaxLife, a2 = {};
            e.forEach(function(e2) {
              var t3 = r(e2);
              a2[t3] = a2[t3] || [], a2[t3].push(e2);
            }), 0 < Object.keys(a2).length ? function() {
              var r2 = { start: true };
              i2.mesh_data = {};
              for (var e2 in a2)
                !function(t3) {
                  var e3 = a2[t3];
                  Promise.all(e3.map(function(e4) {
                    return e4.endData(i2);
                  })).then(function() {
                    log("trace", "Finished style group '".concat(t3, "' for tile ").concat(i2.key)), a2[t3] = [], Object.keys(a2).every(function(e4) {
                      return 0 === a2[e4].length;
                    }) && (r2.done = true), WorkerBroker.postMessage("TileManager_".concat(n, ".buildTileStylesCompleted"), WorkerBroker.withTransferables({ tile: E2.slice(i2, ["mesh_data", "selection_data"]), progress: r2 })), r2.start = null, i2.mesh_data = {}, i2.selection_data = {}, r2.done && Collision.resetTile(i2.id);
                  }, function(e4) {
                    log("error", "Error for style group '".concat(t3, "' for tile ").concat(i2.key), e4);
                  });
                }(e2);
              Style.updateMeshVariantTypeCache(o);
            }() : (WorkerBroker.postMessage("TileManager_".concat(n, ".buildTileStylesCompleted"), WorkerBroker.withTransferables({ tile: E2.slice(i2), progress: { start: true, done: true } })), Collision.resetTile(i2.id));
          } }, { key: "_getDataForSource", value: function(t2, e, r) {
            var i2 = 2 < arguments.length && void 0 !== r ? r : null, n = [];
            return null != e && null != t2 && null != t2.layers && (!e.layer && t2.layers._default || "string" == typeof e.layer && !t2.layers[e.layer] && new RegExp("^\\d+_" + e.layer + "$").test(i2) && t2.layers._default ? n.push({ geom: t2.layers._default }) : !e.layer && i2 ? n.push({ layer: i2, geom: t2.layers[i2] }) : "string" == typeof e.layer ? n.push({ layer: e.layer, geom: t2.layers[e.layer] }) : Array.isArray(e.layer) && e.layer.forEach(function(e2) {
              t2.layers[e2] && t2.layers[e2].features && n.push({ layer: e2, geom: t2.layers[e2] });
            })), n;
          } }, { key: "abortBuild", value: function(r, i2) {
            if (Task.removeForTile(r.id), Collision.abortTile(r.id), r.mesh_data)
              for (var e in r.mesh_data) {
                var t2 = r.mesh_data[e].textures;
                t2 && t2.forEach(function(e2) {
                  var t3 = getTextureManager(i2).textures[e2];
                  t3 && (log("trace", "releasing texture ".concat(e2, " for tile ").concat(r.key)), t3.release());
                });
              }
          } }, { key: "slice", value: function(e, t2) {
            var r = ["id", "key", "loading", "loaded", "generation", "error", "debug"];
            Array.isArray(t2) && r.push.apply(r, _toConsumableArray(t2));
            for (var i2 = {}, n = 0; n < r.length; n++) {
              var o = r[n];
              i2[o] = e[o];
            }
            return i2;
          } }]), E2;
        }();
        Tile.coord_children = {};
        var RasterTileSource = function() {
          _inherits(n, NetworkTileSource);
          var i2 = _createSuper(n);
          function n(e, t2) {
            var r;
            return _classCallCheck(this, n), -1 === (r = i2.call(this, e, t2)).rasters.indexOf(r.name) && r.rasters.unshift(r.name), r.filtering = e.filtering, r.textures = {}, r;
          }
          return _createClass(n, [{ key: "load", value: function(e) {
            e.source_data = {}, e.source_data.layers = {}, e.pad_scale = this.pad_scale, e.rasters = _toConsumableArray(this.rasters);
            var t2 = Geo$1.tile_scale;
            return e.source_data.layers = { _default: { type: "FeatureCollection", features: [{ geometry: { type: "Polygon", coordinates: [[[0, 0], [t2, 0], [t2, -t2], [0, -t2], [0, 0]]] }, properties: {} }] } }, e.default_winding = "CW", Promise.resolve(e);
          } }, { key: "tileTexture", value: function(e) {
            var t2, r, i3 = e.coords.key;
            return this.textures[i3] || (t2 = Tile.coordinateWithMaxZoom(e.coords, this.max_zoom), r = this.formatUrl(this.url, { coords: t2 }), this.textures[i3] = { url: r, filtering: this.filtering, coords: t2 }), this.textures[i3];
          } }]), n;
        }(), ArrayUtils;
        DataSource.register(RasterTileSource, "Raster");
        var ArrayUtils$1 = ArrayUtils = {};
        function simplify(e, t2, r, i2) {
          for (var n, o = i2, a2 = r - t2 >> 1, s = r - t2, l = e[t2], u2 = e[t2 + 1], c2 = e[r], h = e[r + 1], f2 = t2 + 3; f2 < r; f2 += 3) {
            var d, _ = getSqSegDist(e[f2], e[f2 + 1], l, u2, c2, h);
            o < _ ? (n = f2, o = _) : _ !== o || (d = Math.abs(f2 - a2)) < s && (n = f2, s = d);
          }
          i2 < o && (3 < n - t2 && simplify(e, t2, n, i2), e[n + 2] = o, 3 < r - n && simplify(e, n, r, i2));
        }
        function getSqSegDist(e, t2, r, i2, n, o) {
          var a2, s = n - r, l = o - i2;
          return 0 === s && 0 === l || (1 < (a2 = ((e - r) * s + (t2 - i2) * l) / (s * s + l * l)) ? (r = n, i2 = o) : 0 < a2 && (r += s * a2, i2 += l * a2)), (s = e - r) * s + (l = t2 - i2) * l;
        }
        function createFeature(e, t2, r, i2) {
          var n = { id: void 0 === e ? null : e, type: t2, geometry: r, tags: i2, minX: 1 / 0, minY: 1 / 0, maxX: -1 / 0, maxY: -1 / 0 };
          return calcBBox(n), n;
        }
        function calcBBox(e) {
          var t2 = e.geometry, r = e.type;
          if ("Point" === r || "MultiPoint" === r || "LineString" === r)
            calcLineBBox(e, t2);
          else if ("Polygon" === r || "MultiLineString" === r)
            for (var i2 = 0; i2 < t2.length; i2++)
              calcLineBBox(e, t2[i2]);
          else if ("MultiPolygon" === r)
            for (i2 = 0; i2 < t2.length; i2++)
              for (var n = 0; n < t2[i2].length; n++)
                calcLineBBox(e, t2[i2][n]);
        }
        function calcLineBBox(e, t2) {
          for (var r = 0; r < t2.length; r += 3)
            e.minX = Math.min(e.minX, t2[r]), e.minY = Math.min(e.minY, t2[r + 1]), e.maxX = Math.max(e.maxX, t2[r]), e.maxY = Math.max(e.maxY, t2[r + 1]);
        }
        function convert(e, t2) {
          var r = [];
          if ("FeatureCollection" === e.type)
            for (var i2 = 0; i2 < e.features.length; i2++)
              convertFeature(r, e.features[i2], t2, i2);
          else
            "Feature" === e.type ? convertFeature(r, e, t2) : convertFeature(r, { geometry: e }, t2);
          return r;
        }
        function convertFeature(e, t2, r, i2) {
          if (t2.geometry) {
            var n = t2.geometry.coordinates, o = t2.geometry.type, a2 = Math.pow(r.tolerance / ((1 << r.maxZoom) * r.extent), 2), s = [], l = t2.id;
            if (r.promoteId ? l = t2.properties[r.promoteId] : r.generateId && (l = i2 || 0), "Point" === o)
              convertPoint(n, s);
            else if ("MultiPoint" === o)
              for (var u2 = 0; u2 < n.length; u2++)
                convertPoint(n[u2], s);
            else if ("LineString" === o)
              convertLine(n, s, a2, false);
            else if ("MultiLineString" === o) {
              if (r.lineMetrics) {
                for (u2 = 0; u2 < n.length; u2++)
                  s = [], convertLine(n[u2], s, a2, false), e.push(createFeature(l, "LineString", s, t2.properties));
                return;
              }
              convertLines(n, s, a2, false);
            } else if ("Polygon" === o)
              convertLines(n, s, a2, true);
            else {
              if ("MultiPolygon" !== o) {
                if ("GeometryCollection" !== o)
                  throw new Error("Input data is not a valid GeoJSON object.");
                for (u2 = 0; u2 < t2.geometry.geometries.length; u2++)
                  convertFeature(e, { id: l, geometry: t2.geometry.geometries[u2], properties: t2.properties }, r, i2);
                return;
              }
              for (u2 = 0; u2 < n.length; u2++) {
                var c2 = [];
                convertLines(n[u2], c2, a2, true), s.push(c2);
              }
            }
            e.push(createFeature(l, o, s, t2.properties));
          }
        }
        function convertPoint(e, t2) {
          t2.push(projectX(e[0])), t2.push(projectY(e[1])), t2.push(0);
        }
        function convertLine(e, t2, r, i2) {
          for (var n, o, a2 = 0, s = 0; s < e.length; s++) {
            var l = projectX(e[s][0]), u2 = projectY(e[s][1]);
            t2.push(l), t2.push(u2), t2.push(0), 0 < s && (a2 += i2 ? (n * u2 - l * o) / 2 : Math.sqrt(Math.pow(l - n, 2) + Math.pow(u2 - o, 2))), n = l, o = u2;
          }
          var c2 = t2.length - 3;
          t2[2] = 1, simplify(t2, 0, c2, r), t2[2 + c2] = 1, t2.size = Math.abs(a2), t2.start = 0, t2.end = t2.size;
        }
        function convertLines(e, t2, r, i2) {
          for (var n = 0; n < e.length; n++) {
            var o = [];
            convertLine(e[n], o, r, i2), t2.push(o);
          }
        }
        function projectX(e) {
          return e / 360 + 0.5;
        }
        function projectY(e) {
          var t2 = Math.sin(e * Math.PI / 180), r = 0.5 - 0.25 * Math.log((1 + t2) / (1 - t2)) / Math.PI;
          return r < 0 ? 0 : 1 < r ? 1 : r;
        }
        function clip(e, t2, r, i2, n, o, a2, s) {
          if (i2 /= t2, (r /= t2) <= o && a2 < i2)
            return e;
          if (a2 < r || i2 <= o)
            return null;
          for (var l = [], u2 = 0; u2 < e.length; u2++) {
            var c2 = e[u2], h = c2.geometry, f2 = c2.type, d = 0 === n ? c2.minX : c2.minY, _ = 0 === n ? c2.maxX : c2.maxY;
            if (r <= d && _ < i2)
              l.push(c2);
            else if (!(_ < r || i2 <= d)) {
              var p2 = [];
              if ("Point" === f2 || "MultiPoint" === f2)
                clipPoints(h, p2, r, i2, n);
              else if ("LineString" === f2)
                clipLine(h, p2, r, i2, n, false, s.lineMetrics);
              else if ("MultiLineString" === f2)
                clipLines(h, p2, r, i2, n, false);
              else if ("Polygon" === f2)
                clipLines(h, p2, r, i2, n, true);
              else if ("MultiPolygon" === f2)
                for (var g = 0; g < h.length; g++) {
                  var m = [];
                  clipLines(h[g], m, r, i2, n, true), m.length && p2.push(m);
                }
              if (p2.length) {
                if (s.lineMetrics && "LineString" === f2) {
                  for (g = 0; g < p2.length; g++)
                    l.push(createFeature(c2.id, f2, p2[g], c2.tags));
                  continue;
                }
                "LineString" !== f2 && "MultiLineString" !== f2 || (1 === p2.length ? (f2 = "LineString", p2 = p2[0]) : f2 = "MultiLineString"), "Point" !== f2 && "MultiPoint" !== f2 || (f2 = 3 === p2.length ? "Point" : "MultiPoint"), l.push(createFeature(c2.id, f2, p2, c2.tags));
              }
            }
          }
          return l.length ? l : null;
        }
        function clipPoints(e, t2, r, i2, n) {
          for (var o = 0; o < e.length; o += 3) {
            var a2 = e[o + n];
            r <= a2 && a2 <= i2 && (t2.push(e[o]), t2.push(e[o + 1]), t2.push(e[o + 2]));
          }
        }
        function clipLine(e, t2, r, i2, n, o, a2) {
          for (var s, l, u2 = newSlice(e), c2 = 0 === n ? intersectX : intersectY, h = e.start, f2 = 0; f2 < e.length - 3; f2 += 3) {
            var d = e[f2], _ = e[f2 + 1], p2 = e[f2 + 2], g = e[f2 + 3], m = e[f2 + 4], y = 0 === n ? d : _, v = 0 === n ? g : m, x2 = false;
            a2 && (s = Math.sqrt(Math.pow(d - g, 2) + Math.pow(_ - m, 2))), y < r ? r < v && (l = c2(u2, d, _, g, m, r), a2 && (u2.start = h + s * l)) : i2 < y ? v < i2 && (l = c2(u2, d, _, g, m, i2), a2 && (u2.start = h + s * l)) : addPoint(u2, d, _, p2), v < r && r <= y && (l = c2(u2, d, _, g, m, r), x2 = true), i2 < v && y <= i2 && (l = c2(u2, d, _, g, m, i2), x2 = true), !o && x2 && (a2 && (u2.end = h + s * l), t2.push(u2), u2 = newSlice(e)), a2 && (h += s);
          }
          var b2 = e.length - 3, d = e[b2], _ = e[b2 + 1], p2 = e[b2 + 2];
          r <= (y = 0 === n ? d : _) && y <= i2 && addPoint(u2, d, _, p2), b2 = u2.length - 3, o && 3 <= b2 && (u2[b2] !== u2[0] || u2[b2 + 1] !== u2[1]) && addPoint(u2, u2[0], u2[1], u2[2]), u2.length && t2.push(u2);
        }
        function newSlice(e) {
          var t2 = [];
          return t2.size = e.size, t2.start = e.start, t2.end = e.end, t2;
        }
        function clipLines(e, t2, r, i2, n, o) {
          for (var a2 = 0; a2 < e.length; a2++)
            clipLine(e[a2], t2, r, i2, n, o, false);
        }
        function addPoint(e, t2, r, i2) {
          e.push(t2), e.push(r), e.push(i2);
        }
        function intersectX(e, t2, r, i2, n, o) {
          var a2 = (o - t2) / (i2 - t2);
          return e.push(o), e.push(r + (n - r) * a2), e.push(1), a2;
        }
        function intersectY(e, t2, r, i2, n, o) {
          var a2 = (o - r) / (n - r);
          return e.push(t2 + (i2 - t2) * a2), e.push(o), e.push(1), a2;
        }
        function wrap(e, t2) {
          var r = t2.buffer / t2.extent, i2 = e, n = clip(e, 1, -1 - r, r, 0, -1, 2, t2), o = clip(e, 1, 1 - r, 2 + r, 0, -1, 2, t2);
          return (n || o) && (i2 = clip(e, 1, -r, 1 + r, 0, -1, 2, t2) || [], n && (i2 = shiftFeatureCoords(n, 1).concat(i2)), o && (i2 = i2.concat(shiftFeatureCoords(o, -1)))), i2;
        }
        function shiftFeatureCoords(e, t2) {
          for (var r = [], i2 = 0; i2 < e.length; i2++) {
            var n, o = e[i2], a2 = o.type;
            if ("Point" === a2 || "MultiPoint" === a2 || "LineString" === a2)
              n = shiftCoords(o.geometry, t2);
            else if ("MultiLineString" === a2 || "Polygon" === a2) {
              n = [];
              for (var s = 0; s < o.geometry.length; s++)
                n.push(shiftCoords(o.geometry[s], t2));
            } else if ("MultiPolygon" === a2)
              for (n = [], s = 0; s < o.geometry.length; s++) {
                for (var l = [], u2 = 0; u2 < o.geometry[s].length; u2++)
                  l.push(shiftCoords(o.geometry[s][u2], t2));
                n.push(l);
              }
            r.push(createFeature(o.id, a2, n, o.tags));
          }
          return r;
        }
        function shiftCoords(e, t2) {
          var r = [];
          r.size = e.size, void 0 !== e.start && (r.start = e.start, r.end = e.end);
          for (var i2 = 0; i2 < e.length; i2 += 3)
            r.push(e[i2] + t2, e[i2 + 1], e[i2 + 2]);
          return r;
        }
        function transformTile(e, t2) {
          if (e.transformed)
            return e;
          for (var r, i2 = 1 << e.z, n = e.x, o = e.y, a2 = 0; a2 < e.features.length; a2++) {
            var s = e.features[a2], l = s.geometry, u2 = s.type;
            if (s.geometry = [], 1 === u2)
              for (r = 0; r < l.length; r += 2)
                s.geometry.push(transformPoint(l[r], l[r + 1], t2, i2, n, o));
            else
              for (r = 0; r < l.length; r++) {
                for (var c2 = [], h = 0; h < l[r].length; h += 2)
                  c2.push(transformPoint(l[r][h], l[r][h + 1], t2, i2, n, o));
                s.geometry.push(c2);
              }
          }
          return e.transformed = true, e;
        }
        function transformPoint(e, t2, r, i2, n, o) {
          return [Math.round(r * (e * i2 - n)), Math.round(r * (t2 * i2 - o))];
        }
        function createTile(e, t2, r, i2, n) {
          for (var o = t2 === n.maxZoom ? 0 : n.tolerance / ((1 << t2) * n.extent), a2 = { features: [], numPoints: 0, numSimplified: 0, numFeatures: 0, source: null, x: r, y: i2, z: t2, transformed: false, minX: 2, minY: 1, maxX: -1, maxY: 0 }, s = 0; s < e.length; s++) {
            a2.numFeatures++, addFeature(a2, e[s], o, n);
            var l = e[s].minX, u2 = e[s].minY, c2 = e[s].maxX, h = e[s].maxY;
            l < a2.minX && (a2.minX = l), u2 < a2.minY && (a2.minY = u2), c2 > a2.maxX && (a2.maxX = c2), h > a2.maxY && (a2.maxY = h);
          }
          return a2;
        }
        function addFeature(e, t2, r, i2) {
          var n = t2.geometry, o = t2.type, a2 = [];
          if ("Point" === o || "MultiPoint" === o)
            for (var s = 0; s < n.length; s += 3)
              a2.push(n[s]), a2.push(n[s + 1]), e.numPoints++, e.numSimplified++;
          else if ("LineString" === o)
            addLine(a2, n, e, r, false, false);
          else if ("MultiLineString" === o || "Polygon" === o)
            for (s = 0; s < n.length; s++)
              addLine(a2, n[s], e, r, "Polygon" === o, 0 === s);
          else if ("MultiPolygon" === o)
            for (var l = 0; l < n.length; l++)
              for (var u2 = n[l], s = 0; s < u2.length; s++)
                addLine(a2, u2[s], e, r, true, 0 === s);
          if (a2.length) {
            var c2 = t2.tags || null;
            if ("LineString" === o && i2.lineMetrics) {
              for (var h in c2 = {}, t2.tags)
                c2[h] = t2.tags[h];
              c2.mapbox_clip_start = n.start / n.size, c2.mapbox_clip_end = n.end / n.size;
            }
            var f2 = { geometry: a2, type: "Polygon" === o || "MultiPolygon" === o ? 3 : "LineString" === o || "MultiLineString" === o ? 2 : 1, tags: c2 };
            null !== t2.id && (f2.id = t2.id), e.features.push(f2);
          }
        }
        function addLine(e, t2, r, i2, n, o) {
          var a2 = i2 * i2;
          if (0 < i2 && t2.size < (n ? a2 : i2))
            r.numPoints += t2.length / 3;
          else {
            for (var s = [], l = 0; l < t2.length; l += 3)
              (0 === i2 || t2[l + 2] > a2) && (r.numSimplified++, s.push(t2[l]), s.push(t2[l + 1])), r.numPoints++;
            n && rewind(s, o), e.push(s);
          }
        }
        function rewind(e, t2) {
          for (var r = 0, i2 = 0, n = e.length, o = n - 2; i2 < n; o = i2, i2 += 2)
            r += (e[i2] - e[o]) * (e[i2 + 1] + e[o + 1]);
          if (0 < r === t2)
            for (i2 = 0, n = e.length; i2 < n / 2; i2 += 2) {
              var a2 = e[i2], s = e[i2 + 1];
              e[i2] = e[n - 2 - i2], e[i2 + 1] = e[n - 1 - i2], e[n - 2 - i2] = a2, e[n - 1 - i2] = s;
            }
        }
        ArrayUtils.deepClone = function(e) {
          return Array.isArray(e) ? e.map(ArrayUtils.deepClone) : e;
        };
        var defaults = { maxZoom: 14, tolerance: 3, extent: 4096, buffer: 64, lineMetrics: false, promoteId: null, generateId: false };
        function createGeoJsonTile(e, t2, r, i2, n) {
          var o = Object.assign({}, defaults, n), a2 = convert(e, o), s = getBBox(a2 = wrap(a2, o)), l = s.minX, u2 = s.minY, c2 = s.maxX, h = s.maxY, f2 = 1 << t2, d = o.buffer / o.extent, _ = 1 + d;
          return a2 = clip(a2, f2, r - d, r + _, 0, l, c2, o) || [], transformTile(createTile(a2 = clip(a2, f2, i2 - d, i2 + _, 1, u2, h, o) || [], t2, r, i2, o), o.extent);
        }
        function getBBox(e) {
          var t2, r = 2, i2 = -1, n = 1, o = 0, a2 = _createForOfIteratorHelper(e);
          try {
            for (a2.s(); !(t2 = a2.n()).done; ) {
              var s = t2.value;
              s.minX < r && (r = s.minX), s.maxX > i2 && (i2 = s.maxX), s.minY < n && (n = s.minY), s.maxY > o && (o = s.maxY);
            }
          } catch (e2) {
            a2.e(e2);
          } finally {
            a2.f();
          }
          return { minX: r, maxX: i2, minY: n, maxY: o };
        }
        function PackingSmith(e, t2) {
          this.items = [], this.algorithm = e;
          var r = void 0 === (t2 = t2 || {}).sort || t2.sort;
          this.sort = r;
        }
        PackingSmith.prototype = { addItem: function(e) {
          this.items.push(e);
        }, normalizeCoordinates: function() {
          var e = this.items, r = 1 / 0, i2 = 1 / 0;
          e.forEach(function(e2) {
            var t2 = e2;
            r = Math.min(r, t2.x), i2 = Math.min(i2, t2.y);
          }), e.forEach(function(e2) {
            var t2 = e2;
            t2.x -= r, t2.y -= i2;
          });
        }, getStats: function() {
          var e = this.items.map(function(e2) {
            return e2;
          }), t2 = e.map(function(e2) {
            return e2.x;
          }), r = e.map(function(e2) {
            return e2.y;
          }), i2 = e.map(function(e2) {
            return e2.x + e2.width;
          }), n = e.map(function(e2) {
            return e2.y + e2.height;
          });
          return { minX: Math.max.apply(Math, t2), minY: Math.max.apply(Math, r), maxX: Math.max.apply(Math, i2), maxY: Math.max.apply(Math, n) };
        }, getItems: function() {
          return this.items;
        }, processItems: function() {
          var e = this.items;
          return this.sort && (e = this.algorithm.sort(e)), e = this.algorithm.placeItems(e), this.items = e;
        }, exportItems: function() {
          return this.processItems(), this.normalizeCoordinates(), this.items;
        }, export: function() {
          var e = this.exportItems(), t2 = this.getStats();
          return { height: t2.maxY, width: t2.maxX, items: e };
        } };
        var packing_smith = PackingSmith, lookup = [], revLookup = [], Arr = "undefined" != typeof Uint8Array ? Uint8Array : Array, inited = false;
        function init() {
          inited = true;
          for (var e = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", t2 = 0, r = e.length; t2 < r; ++t2)
            lookup[t2] = e[t2], revLookup[e.charCodeAt(t2)] = t2;
          revLookup["-".charCodeAt(0)] = 62, revLookup["_".charCodeAt(0)] = 63;
        }
        function toByteArray(e) {
          var t2, r, i2, n;
          inited || init();
          var o = e.length;
          if (0 < o % 4)
            throw new Error("Invalid string. Length must be a multiple of 4");
          i2 = "=" === e[o - 2] ? 2 : "=" === e[o - 1] ? 1 : 0, n = new Arr(3 * o / 4 - i2), t2 = 0 < i2 ? o - 4 : o;
          for (var a2 = 0, s = 0; s < t2; s += 4, 0)
            r = revLookup[e.charCodeAt(s)] << 18 | revLookup[e.charCodeAt(s + 1)] << 12 | revLookup[e.charCodeAt(s + 2)] << 6 | revLookup[e.charCodeAt(s + 3)], n[a2++] = r >> 16 & 255, n[a2++] = r >> 8 & 255, n[a2++] = 255 & r;
          return 2 == i2 ? (r = revLookup[e.charCodeAt(s)] << 2 | revLookup[e.charCodeAt(s + 1)] >> 4, n[a2++] = 255 & r) : 1 == i2 && (r = revLookup[e.charCodeAt(s)] << 10 | revLookup[e.charCodeAt(s + 1)] << 4 | revLookup[e.charCodeAt(s + 2)] >> 2, n[a2++] = r >> 8 & 255, n[a2++] = 255 & r), n;
        }
        function tripletToBase64(e) {
          return lookup[e >> 18 & 63] + lookup[e >> 12 & 63] + lookup[e >> 6 & 63] + lookup[63 & e];
        }
        function encodeChunk(e, t2, r) {
          for (var i2, n = [], o = t2; o < r; o += 3)
            i2 = (e[o] << 16) + (e[o + 1] << 8) + e[o + 2], n.push(tripletToBase64(i2));
          return n.join("");
        }
        function fromByteArray(e) {
          var t2;
          inited || init();
          for (var r = e.length, i2 = r % 3, n = "", o = [], a2 = 0, s = r - i2; a2 < s; a2 += 16383)
            o.push(encodeChunk(e, a2, s < a2 + 16383 ? s : a2 + 16383));
          return 1 == i2 ? (t2 = e[r - 1], n += lookup[t2 >> 2], n += lookup[t2 << 4 & 63], n += "==") : 2 == i2 && (t2 = (e[r - 2] << 8) + e[r - 1], n += lookup[t2 >> 10], n += lookup[t2 >> 4 & 63], n += lookup[t2 << 2 & 63], n += "="), o.push(n), o.join("");
        }
        var base64$1 = Object.freeze({ toByteArray, fromByteArray });
        function read$1(e, t2, r, i2, n) {
          var o, a2, s = 8 * n - i2 - 1, l = (1 << s) - 1, u2 = l >> 1, c2 = -7, h = r ? n - 1 : 0, f2 = r ? -1 : 1, d = e[t2 + h];
          for (h += f2, o = d & (1 << -c2) - 1, d >>= -c2, c2 += s; 0 < c2; o = 256 * o + e[t2 + h], h += f2, c2 -= 8)
            ;
          for (a2 = o & (1 << -c2) - 1, o >>= -c2, c2 += i2; 0 < c2; a2 = 256 * a2 + e[t2 + h], h += f2, c2 -= 8)
            ;
          if (0 === o)
            o = 1 - u2;
          else {
            if (o === l)
              return a2 ? NaN : 1 / 0 * (d ? -1 : 1);
            a2 += Math.pow(2, i2), o -= u2;
          }
          return (d ? -1 : 1) * a2 * Math.pow(2, o - i2);
        }
        function write$1(e, t2, r, i2, n, o) {
          var a2, s, l, u2 = 8 * o - n - 1, c2 = (1 << u2) - 1, h = c2 >> 1, f2 = 23 === n ? Math.pow(2, -24) - Math.pow(2, -77) : 0, d = i2 ? 0 : o - 1, _ = i2 ? 1 : -1, p2 = t2 < 0 || 0 === t2 && 1 / t2 < 0 ? 1 : 0;
          for (t2 = Math.abs(t2), isNaN(t2) || t2 === 1 / 0 ? (s = isNaN(t2) ? 1 : 0, a2 = c2) : (a2 = Math.floor(Math.log(t2) / Math.LN2), t2 * (l = Math.pow(2, -a2)) < 1 && (a2--, l *= 2), 2 <= (t2 += 1 <= a2 + h ? f2 / l : f2 * Math.pow(2, 1 - h)) * l && (a2++, l /= 2), c2 <= a2 + h ? (s = 0, a2 = c2) : 1 <= a2 + h ? (s = (t2 * l - 1) * Math.pow(2, n), a2 += h) : (s = t2 * Math.pow(2, h - 1) * Math.pow(2, n), a2 = 0)); 8 <= n; e[r + d] = 255 & s, d += _, s /= 256, n -= 8)
            ;
          for (a2 = a2 << n | s, u2 += n; 0 < u2; e[r + d] = 255 & a2, d += _, a2 /= 256, u2 -= 8)
            ;
          e[r + d - _] |= 128 * p2;
        }
        var toString$1 = {}.toString, isArray = Array.isArray || function(e) {
          return "[object Array]" == toString$1.call(e);
        }, INSPECT_MAX_BYTES = 50;
        Buffer.TYPED_ARRAY_SUPPORT = void 0 === global$1.TYPED_ARRAY_SUPPORT || global$1.TYPED_ARRAY_SUPPORT;
        var _kMaxLength = kMaxLength();
        function kMaxLength() {
          return Buffer.TYPED_ARRAY_SUPPORT ? 2147483647 : 1073741823;
        }
        function createBuffer(e, t2) {
          if (kMaxLength() < t2)
            throw new RangeError("Invalid typed array length");
          return Buffer.TYPED_ARRAY_SUPPORT ? (e = new Uint8Array(t2)).__proto__ = Buffer.prototype : (null === e && (e = new Buffer(t2)), e.length = t2), e;
        }
        function Buffer(e, t2, r) {
          if (!(Buffer.TYPED_ARRAY_SUPPORT || this instanceof Buffer))
            return new Buffer(e, t2, r);
          if ("number" != typeof e)
            return from(this, e, t2, r);
          if ("string" == typeof t2)
            throw new Error("If encoding is specified then the first argument must be a string");
          return allocUnsafe(this, e);
        }
        function from(e, t2, r, i2) {
          if ("number" == typeof t2)
            throw new TypeError('"value" argument must not be a number');
          return "undefined" != typeof ArrayBuffer && t2 instanceof ArrayBuffer ? fromArrayBuffer(e, t2, r, i2) : "string" == typeof t2 ? fromString$1(e, t2, r) : fromObject(e, t2);
        }
        function assertSize(e) {
          if ("number" != typeof e)
            throw new TypeError('"size" argument must be a number');
          if (e < 0)
            throw new RangeError('"size" argument must not be negative');
        }
        function alloc(e, t2, r, i2) {
          return assertSize(t2), !(t2 <= 0) && void 0 !== r ? "string" == typeof i2 ? createBuffer(e, t2).fill(r, i2) : createBuffer(e, t2).fill(r) : createBuffer(e, t2);
        }
        function allocUnsafe(e, t2) {
          if (assertSize(t2), e = createBuffer(e, t2 < 0 ? 0 : 0 | checked(t2)), !Buffer.TYPED_ARRAY_SUPPORT)
            for (var r = 0; r < t2; ++r)
              e[r] = 0;
          return e;
        }
        function fromString$1(e, t2, r) {
          if ("string" == typeof r && "" !== r || (r = "utf8"), !Buffer.isEncoding(r))
            throw new TypeError('"encoding" must be a valid string encoding');
          var i2 = 0 | byteLength(t2, r), n = (e = createBuffer(e, i2)).write(t2, r);
          return n !== i2 && (e = e.slice(0, n)), e;
        }
        function fromArrayLike(e, t2) {
          var r = t2.length < 0 ? 0 : 0 | checked(t2.length);
          e = createBuffer(e, r);
          for (var i2 = 0; i2 < r; i2 += 1)
            e[i2] = 255 & t2[i2];
          return e;
        }
        function fromArrayBuffer(e, t2, r, i2) {
          if (t2.byteLength, r < 0 || t2.byteLength < r)
            throw new RangeError("'offset' is out of bounds");
          if (t2.byteLength < r + (i2 || 0))
            throw new RangeError("'length' is out of bounds");
          return t2 = void 0 === r && void 0 === i2 ? new Uint8Array(t2) : void 0 === i2 ? new Uint8Array(t2, r) : new Uint8Array(t2, r, i2), Buffer.TYPED_ARRAY_SUPPORT ? (e = t2).__proto__ = Buffer.prototype : e = fromArrayLike(e, t2), e;
        }
        function fromObject(e, t2) {
          if (internalIsBuffer(t2)) {
            var r = 0 | checked(t2.length);
            return 0 === (e = createBuffer(e, r)).length ? e : (t2.copy(e, 0, 0, r), e);
          }
          if (t2) {
            if ("undefined" != typeof ArrayBuffer && t2.buffer instanceof ArrayBuffer || "length" in t2)
              return "number" != typeof t2.length || isnan(t2.length) ? createBuffer(e, 0) : fromArrayLike(e, t2);
            if ("Buffer" === t2.type && isArray(t2.data))
              return fromArrayLike(e, t2.data);
          }
          throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
        }
        function checked(e) {
          if (e >= kMaxLength())
            throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x" + kMaxLength().toString(16) + " bytes");
          return 0 | e;
        }
        function SlowBuffer(e) {
          return +e != e && (e = 0), Buffer.alloc(+e);
        }
        function internalIsBuffer(e) {
          return null != e && e._isBuffer;
        }
        function byteLength(e, t2) {
          if (internalIsBuffer(e))
            return e.length;
          if ("undefined" != typeof ArrayBuffer && "function" == typeof ArrayBuffer.isView && (ArrayBuffer.isView(e) || e instanceof ArrayBuffer))
            return e.byteLength;
          "string" != typeof e && (e = "" + e);
          var r = e.length;
          if (0 === r)
            return 0;
          for (var i2 = false; ; )
            switch (t2) {
              case "ascii":
              case "latin1":
              case "binary":
                return r;
              case "utf8":
              case "utf-8":
              case void 0:
                return utf8ToBytes(e).length;
              case "ucs2":
              case "ucs-2":
              case "utf16le":
              case "utf-16le":
                return 2 * r;
              case "hex":
                return r >>> 1;
              case "base64":
                return base64ToBytes(e).length;
              default:
                if (i2)
                  return utf8ToBytes(e).length;
                t2 = ("" + t2).toLowerCase(), i2 = true;
            }
        }
        function slowToString(e, t2, r) {
          var i2 = false;
          if ((void 0 === t2 || t2 < 0) && (t2 = 0), t2 > this.length)
            return "";
          if ((void 0 === r || r > this.length) && (r = this.length), r <= 0)
            return "";
          if ((r >>>= 0) <= (t2 >>>= 0))
            return "";
          for (e = e || "utf8"; ; )
            switch (e) {
              case "hex":
                return hexSlice(this, t2, r);
              case "utf8":
              case "utf-8":
                return utf8Slice(this, t2, r);
              case "ascii":
                return asciiSlice(this, t2, r);
              case "latin1":
              case "binary":
                return latin1Slice(this, t2, r);
              case "base64":
                return base64Slice(this, t2, r);
              case "ucs2":
              case "ucs-2":
              case "utf16le":
              case "utf-16le":
                return utf16leSlice(this, t2, r);
              default:
                if (i2)
                  throw new TypeError("Unknown encoding: " + e);
                e = (e + "").toLowerCase(), i2 = true;
            }
        }
        function swap(e, t2, r) {
          var i2 = e[t2];
          e[t2] = e[r], e[r] = i2;
        }
        function bidirectionalIndexOf(e, t2, r, i2, n) {
          if (0 === e.length)
            return -1;
          if ("string" == typeof r ? (i2 = r, r = 0) : 2147483647 < r ? r = 2147483647 : r < -2147483648 && (r = -2147483648), r = +r, isNaN(r) && (r = n ? 0 : e.length - 1), r < 0 && (r = e.length + r), r >= e.length) {
            if (n)
              return -1;
            r = e.length - 1;
          } else if (r < 0) {
            if (!n)
              return -1;
            r = 0;
          }
          if ("string" == typeof t2 && (t2 = Buffer.from(t2, i2)), internalIsBuffer(t2))
            return 0 === t2.length ? -1 : arrayIndexOf$1(e, t2, r, i2, n);
          if ("number" == typeof t2)
            return t2 &= 255, Buffer.TYPED_ARRAY_SUPPORT && "function" == typeof Uint8Array.prototype.indexOf ? n ? Uint8Array.prototype.indexOf.call(e, t2, r) : Uint8Array.prototype.lastIndexOf.call(e, t2, r) : arrayIndexOf$1(e, [t2], r, i2, n);
          throw new TypeError("val must be string, number or Buffer");
        }
        function arrayIndexOf$1(e, t2, r, i2, n) {
          var o = 1, a2 = e.length, s = t2.length;
          if (void 0 !== i2 && ("ucs2" === (i2 = String(i2).toLowerCase()) || "ucs-2" === i2 || "utf16le" === i2 || "utf-16le" === i2)) {
            if (e.length < 2 || t2.length < 2)
              return -1;
            a2 /= o = 2, s /= 2, r /= 2;
          }
          function l(e2, t3) {
            return 1 === o ? e2[t3] : e2.readUInt16BE(t3 * o);
          }
          if (n)
            for (var u2 = -1, c2 = r; c2 < a2; c2++)
              if (l(e, c2) === l(t2, -1 === u2 ? 0 : c2 - u2)) {
                if (-1 === u2 && (u2 = c2), c2 - u2 + 1 === s)
                  return u2 * o;
              } else
                -1 !== u2 && (c2 -= c2 - u2), u2 = -1;
          else
            for (a2 < r + s && (r = a2 - s), c2 = r; 0 <= c2; c2--) {
              for (var h = true, f2 = 0; f2 < s; f2++)
                if (l(e, c2 + f2) !== l(t2, f2)) {
                  h = false;
                  break;
                }
              if (h)
                return c2;
            }
          return -1;
        }
        function hexWrite(e, t2, r, i2) {
          r = Number(r) || 0;
          var n = e.length - r;
          (!i2 || n < (i2 = Number(i2))) && (i2 = n);
          var o = t2.length;
          if (o % 2 != 0)
            throw new TypeError("Invalid hex string");
          o / 2 < i2 && (i2 = o / 2);
          for (var a2 = 0; a2 < i2; ++a2) {
            var s = parseInt(t2.substr(2 * a2, 2), 16);
            if (isNaN(s))
              return a2;
            e[r + a2] = s;
          }
          return a2;
        }
        function utf8Write(e, t2, r, i2) {
          return blitBuffer(utf8ToBytes(t2, e.length - r), e, r, i2);
        }
        function asciiWrite(e, t2, r, i2) {
          return blitBuffer(asciiToBytes(t2), e, r, i2);
        }
        function latin1Write(e, t2, r, i2) {
          return asciiWrite(e, t2, r, i2);
        }
        function base64Write(e, t2, r, i2) {
          return blitBuffer(base64ToBytes(t2), e, r, i2);
        }
        function ucs2Write(e, t2, r, i2) {
          return blitBuffer(utf16leToBytes(t2, e.length - r), e, r, i2);
        }
        function base64Slice(e, t2, r) {
          return 0 === t2 && r === e.length ? fromByteArray(e) : fromByteArray(e.slice(t2, r));
        }
        function utf8Slice(e, t2, r) {
          r = Math.min(e.length, r);
          for (var i2 = [], n = t2; n < r; ) {
            var o, a2, s, l, u2 = e[n], c2 = null, h = 239 < u2 ? 4 : 223 < u2 ? 3 : 191 < u2 ? 2 : 1;
            if (n + h <= r)
              switch (h) {
                case 1:
                  u2 < 128 && (c2 = u2);
                  break;
                case 2:
                  128 == (192 & (o = e[n + 1])) && 127 < (l = (31 & u2) << 6 | 63 & o) && (c2 = l);
                  break;
                case 3:
                  o = e[n + 1], a2 = e[n + 2], 128 == (192 & o) && 128 == (192 & a2) && 2047 < (l = (15 & u2) << 12 | (63 & o) << 6 | 63 & a2) && (l < 55296 || 57343 < l) && (c2 = l);
                  break;
                case 4:
                  o = e[n + 1], a2 = e[n + 2], s = e[n + 3], 128 == (192 & o) && 128 == (192 & a2) && 128 == (192 & s) && 65535 < (l = (15 & u2) << 18 | (63 & o) << 12 | (63 & a2) << 6 | 63 & s) && l < 1114112 && (c2 = l);
              }
            null === c2 ? (c2 = 65533, h = 1) : 65535 < c2 && (c2 -= 65536, i2.push(c2 >>> 10 & 1023 | 55296), c2 = 56320 | 1023 & c2), i2.push(c2), n += h;
          }
          return decodeCodePointsArray(i2);
        }
        Buffer.poolSize = 8192, Buffer._augment = function(e) {
          return e.__proto__ = Buffer.prototype, e;
        }, Buffer.from = function(e, t2, r) {
          return from(null, e, t2, r);
        }, Buffer.TYPED_ARRAY_SUPPORT && (Buffer.prototype.__proto__ = Uint8Array.prototype, Buffer.__proto__ = Uint8Array), Buffer.alloc = function(e, t2, r) {
          return alloc(null, e, t2, r);
        }, Buffer.allocUnsafe = function(e) {
          return allocUnsafe(null, e);
        }, Buffer.allocUnsafeSlow = function(e) {
          return allocUnsafe(null, e);
        }, Buffer.isBuffer = isBuffer, Buffer.compare = function(e, t2) {
          if (!internalIsBuffer(e) || !internalIsBuffer(t2))
            throw new TypeError("Arguments must be Buffers");
          if (e === t2)
            return 0;
          for (var r = e.length, i2 = t2.length, n = 0, o = Math.min(r, i2); n < o; ++n)
            if (e[n] !== t2[n]) {
              r = e[n], i2 = t2[n];
              break;
            }
          return r < i2 ? -1 : i2 < r ? 1 : 0;
        }, Buffer.isEncoding = function(e) {
          switch (String(e).toLowerCase()) {
            case "hex":
            case "utf8":
            case "utf-8":
            case "ascii":
            case "latin1":
            case "binary":
            case "base64":
            case "ucs2":
            case "ucs-2":
            case "utf16le":
            case "utf-16le":
              return true;
            default:
              return false;
          }
        }, Buffer.concat = function(e, t2) {
          if (!isArray(e))
            throw new TypeError('"list" argument must be an Array of Buffers');
          if (0 === e.length)
            return Buffer.alloc(0);
          if (void 0 === t2)
            for (n = t2 = 0; n < e.length; ++n)
              t2 += e[n].length;
          for (var r = Buffer.allocUnsafe(t2), i2 = 0, n = 0; n < e.length; ++n) {
            var o = e[n];
            if (!internalIsBuffer(o))
              throw new TypeError('"list" argument must be an Array of Buffers');
            o.copy(r, i2), i2 += o.length;
          }
          return r;
        }, Buffer.byteLength = byteLength, Buffer.prototype._isBuffer = true, Buffer.prototype.swap16 = function() {
          var e = this.length;
          if (e % 2 != 0)
            throw new RangeError("Buffer size must be a multiple of 16-bits");
          for (var t2 = 0; t2 < e; t2 += 2)
            swap(this, t2, t2 + 1);
          return this;
        }, Buffer.prototype.swap32 = function() {
          var e = this.length;
          if (e % 4 != 0)
            throw new RangeError("Buffer size must be a multiple of 32-bits");
          for (var t2 = 0; t2 < e; t2 += 4)
            swap(this, t2, t2 + 3), swap(this, t2 + 1, t2 + 2);
          return this;
        }, Buffer.prototype.swap64 = function() {
          var e = this.length;
          if (e % 8 != 0)
            throw new RangeError("Buffer size must be a multiple of 64-bits");
          for (var t2 = 0; t2 < e; t2 += 8)
            swap(this, t2, t2 + 7), swap(this, t2 + 1, t2 + 6), swap(this, t2 + 2, t2 + 5), swap(this, t2 + 3, t2 + 4);
          return this;
        }, Buffer.prototype.toString = function() {
          var e = 0 | this.length;
          return 0 == e ? "" : 0 === arguments.length ? utf8Slice(this, 0, e) : slowToString.apply(this, arguments);
        }, Buffer.prototype.equals = function(e) {
          if (!internalIsBuffer(e))
            throw new TypeError("Argument must be a Buffer");
          return this === e || 0 === Buffer.compare(this, e);
        }, Buffer.prototype.inspect = function() {
          var e = "", t2 = INSPECT_MAX_BYTES;
          return 0 < this.length && (e = this.toString("hex", 0, t2).match(/.{2}/g).join(" "), this.length > t2 && (e += " ... ")), "<Buffer " + e + ">";
        }, Buffer.prototype.compare = function(e, t2, r, i2, n) {
          if (!internalIsBuffer(e))
            throw new TypeError("Argument must be a Buffer");
          if (void 0 === t2 && (t2 = 0), void 0 === r && (r = e ? e.length : 0), void 0 === i2 && (i2 = 0), void 0 === n && (n = this.length), t2 < 0 || r > e.length || i2 < 0 || n > this.length)
            throw new RangeError("out of range index");
          if (n <= i2 && r <= t2)
            return 0;
          if (n <= i2)
            return -1;
          if (r <= t2)
            return 1;
          if (this === e)
            return 0;
          for (var o = (n >>>= 0) - (i2 >>>= 0), a2 = (r >>>= 0) - (t2 >>>= 0), s = Math.min(o, a2), l = this.slice(i2, n), u2 = e.slice(t2, r), c2 = 0; c2 < s; ++c2)
            if (l[c2] !== u2[c2]) {
              o = l[c2], a2 = u2[c2];
              break;
            }
          return o < a2 ? -1 : a2 < o ? 1 : 0;
        }, Buffer.prototype.includes = function(e, t2, r) {
          return -1 !== this.indexOf(e, t2, r);
        }, Buffer.prototype.indexOf = function(e, t2, r) {
          return bidirectionalIndexOf(this, e, t2, r, true);
        }, Buffer.prototype.lastIndexOf = function(e, t2, r) {
          return bidirectionalIndexOf(this, e, t2, r, false);
        }, Buffer.prototype.write = function(e, t2, r, i2) {
          if (void 0 === t2)
            i2 = "utf8", r = this.length, t2 = 0;
          else if (void 0 === r && "string" == typeof t2)
            i2 = t2, r = this.length, t2 = 0;
          else {
            if (!isFinite(t2))
              throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
            t2 |= 0, isFinite(r) ? (r |= 0, void 0 === i2 && (i2 = "utf8")) : (i2 = r, r = void 0);
          }
          var n = this.length - t2;
          if ((void 0 === r || n < r) && (r = n), 0 < e.length && (r < 0 || t2 < 0) || t2 > this.length)
            throw new RangeError("Attempt to write outside buffer bounds");
          i2 = i2 || "utf8";
          for (var o = false; ; )
            switch (i2) {
              case "hex":
                return hexWrite(this, e, t2, r);
              case "utf8":
              case "utf-8":
                return utf8Write(this, e, t2, r);
              case "ascii":
                return asciiWrite(this, e, t2, r);
              case "latin1":
              case "binary":
                return latin1Write(this, e, t2, r);
              case "base64":
                return base64Write(this, e, t2, r);
              case "ucs2":
              case "ucs-2":
              case "utf16le":
              case "utf-16le":
                return ucs2Write(this, e, t2, r);
              default:
                if (o)
                  throw new TypeError("Unknown encoding: " + i2);
                i2 = ("" + i2).toLowerCase(), o = true;
            }
        }, Buffer.prototype.toJSON = function() {
          return { type: "Buffer", data: Array.prototype.slice.call(this._arr || this, 0) };
        };
        var MAX_ARGUMENTS_LENGTH = 4096;
        function decodeCodePointsArray(e) {
          var t2 = e.length;
          if (t2 <= MAX_ARGUMENTS_LENGTH)
            return String.fromCharCode.apply(String, e);
          for (var r = "", i2 = 0; i2 < t2; )
            r += String.fromCharCode.apply(String, e.slice(i2, i2 += MAX_ARGUMENTS_LENGTH));
          return r;
        }
        function asciiSlice(e, t2, r) {
          var i2 = "";
          r = Math.min(e.length, r);
          for (var n = t2; n < r; ++n)
            i2 += String.fromCharCode(127 & e[n]);
          return i2;
        }
        function latin1Slice(e, t2, r) {
          var i2 = "";
          r = Math.min(e.length, r);
          for (var n = t2; n < r; ++n)
            i2 += String.fromCharCode(e[n]);
          return i2;
        }
        function hexSlice(e, t2, r) {
          var i2 = e.length;
          (!t2 || t2 < 0) && (t2 = 0), (!r || r < 0 || i2 < r) && (r = i2);
          for (var n = "", o = t2; o < r; ++o)
            n += toHex(e[o]);
          return n;
        }
        function utf16leSlice(e, t2, r) {
          for (var i2 = e.slice(t2, r), n = "", o = 0; o < i2.length; o += 2)
            n += String.fromCharCode(i2[o] + 256 * i2[o + 1]);
          return n;
        }
        function checkOffset(e, t2, r) {
          if (e % 1 != 0 || e < 0)
            throw new RangeError("offset is not uint");
          if (r < e + t2)
            throw new RangeError("Trying to access beyond buffer length");
        }
        function checkInt(e, t2, r, i2, n, o) {
          if (!internalIsBuffer(e))
            throw new TypeError('"buffer" argument must be a Buffer instance');
          if (n < t2 || t2 < o)
            throw new RangeError('"value" argument is out of bounds');
          if (r + i2 > e.length)
            throw new RangeError("Index out of range");
        }
        function objectWriteUInt16(e, t2, r, i2) {
          t2 < 0 && (t2 = 65535 + t2 + 1);
          for (var n = 0, o = Math.min(e.length - r, 2); n < o; ++n)
            e[r + n] = (t2 & 255 << 8 * (i2 ? n : 1 - n)) >>> 8 * (i2 ? n : 1 - n);
        }
        function objectWriteUInt32(e, t2, r, i2) {
          t2 < 0 && (t2 = 4294967295 + t2 + 1);
          for (var n = 0, o = Math.min(e.length - r, 4); n < o; ++n)
            e[r + n] = t2 >>> 8 * (i2 ? n : 3 - n) & 255;
        }
        function checkIEEE754(e, t2, r, i2, n, o) {
          if (r + i2 > e.length)
            throw new RangeError("Index out of range");
          if (r < 0)
            throw new RangeError("Index out of range");
        }
        function writeFloat(e, t2, r, i2, n) {
          return n || checkIEEE754(e, t2, r, 4, 34028234663852886e22, -34028234663852886e22), write$1(e, t2, r, i2, 23, 4), r + 4;
        }
        function writeDouble(e, t2, r, i2, n) {
          return n || checkIEEE754(e, t2, r, 8, 17976931348623157e292, -17976931348623157e292), write$1(e, t2, r, i2, 52, 8), r + 8;
        }
        Buffer.prototype.slice = function(e, t2) {
          var r = this.length;
          if ((e = ~~e) < 0 ? (e += r) < 0 && (e = 0) : r < e && (e = r), (t2 = void 0 === t2 ? r : ~~t2) < 0 ? (t2 += r) < 0 && (t2 = 0) : r < t2 && (t2 = r), t2 < e && (t2 = e), Buffer.TYPED_ARRAY_SUPPORT)
            (n = this.subarray(e, t2)).__proto__ = Buffer.prototype;
          else
            for (var i2 = t2 - e, n = new Buffer(i2, void 0), o = 0; o < i2; ++o)
              n[o] = this[o + e];
          return n;
        }, Buffer.prototype.readUIntLE = function(e, t2, r) {
          e |= 0, t2 |= 0, r || checkOffset(e, t2, this.length);
          for (var i2 = this[e], n = 1, o = 0; ++o < t2 && (n *= 256); )
            i2 += this[e + o] * n;
          return i2;
        }, Buffer.prototype.readUIntBE = function(e, t2, r) {
          e |= 0, t2 |= 0, r || checkOffset(e, t2, this.length);
          for (var i2 = this[e + --t2], n = 1; 0 < t2 && (n *= 256); )
            i2 += this[e + --t2] * n;
          return i2;
        }, Buffer.prototype.readUInt8 = function(e, t2) {
          return t2 || checkOffset(e, 1, this.length), this[e];
        }, Buffer.prototype.readUInt16LE = function(e, t2) {
          return t2 || checkOffset(e, 2, this.length), this[e] | this[e + 1] << 8;
        }, Buffer.prototype.readUInt16BE = function(e, t2) {
          return t2 || checkOffset(e, 2, this.length), this[e] << 8 | this[e + 1];
        }, Buffer.prototype.readUInt32LE = function(e, t2) {
          return t2 || checkOffset(e, 4, this.length), (this[e] | this[e + 1] << 8 | this[e + 2] << 16) + 16777216 * this[e + 3];
        }, Buffer.prototype.readUInt32BE = function(e, t2) {
          return t2 || checkOffset(e, 4, this.length), 16777216 * this[e] + (this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3]);
        }, Buffer.prototype.readIntLE = function(e, t2, r) {
          e |= 0, t2 |= 0, r || checkOffset(e, t2, this.length);
          for (var i2 = this[e], n = 1, o = 0; ++o < t2 && (n *= 256); )
            i2 += this[e + o] * n;
          return (n *= 128) <= i2 && (i2 -= Math.pow(2, 8 * t2)), i2;
        }, Buffer.prototype.readIntBE = function(e, t2, r) {
          e |= 0, t2 |= 0, r || checkOffset(e, t2, this.length);
          for (var i2 = t2, n = 1, o = this[e + --i2]; 0 < i2 && (n *= 256); )
            o += this[e + --i2] * n;
          return (n *= 128) <= o && (o -= Math.pow(2, 8 * t2)), o;
        }, Buffer.prototype.readInt8 = function(e, t2) {
          return t2 || checkOffset(e, 1, this.length), 128 & this[e] ? -1 * (255 - this[e] + 1) : this[e];
        }, Buffer.prototype.readInt16LE = function(e, t2) {
          t2 || checkOffset(e, 2, this.length);
          var r = this[e] | this[e + 1] << 8;
          return 32768 & r ? 4294901760 | r : r;
        }, Buffer.prototype.readInt16BE = function(e, t2) {
          t2 || checkOffset(e, 2, this.length);
          var r = this[e + 1] | this[e] << 8;
          return 32768 & r ? 4294901760 | r : r;
        }, Buffer.prototype.readInt32LE = function(e, t2) {
          return t2 || checkOffset(e, 4, this.length), this[e] | this[e + 1] << 8 | this[e + 2] << 16 | this[e + 3] << 24;
        }, Buffer.prototype.readInt32BE = function(e, t2) {
          return t2 || checkOffset(e, 4, this.length), this[e] << 24 | this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3];
        }, Buffer.prototype.readFloatLE = function(e, t2) {
          return t2 || checkOffset(e, 4, this.length), read$1(this, e, true, 23, 4);
        }, Buffer.prototype.readFloatBE = function(e, t2) {
          return t2 || checkOffset(e, 4, this.length), read$1(this, e, false, 23, 4);
        }, Buffer.prototype.readDoubleLE = function(e, t2) {
          return t2 || checkOffset(e, 8, this.length), read$1(this, e, true, 52, 8);
        }, Buffer.prototype.readDoubleBE = function(e, t2) {
          return t2 || checkOffset(e, 8, this.length), read$1(this, e, false, 52, 8);
        }, Buffer.prototype.writeUIntLE = function(e, t2, r, i2) {
          e = +e, t2 |= 0, r |= 0, i2 || checkInt(this, e, t2, r, Math.pow(2, 8 * r) - 1, 0);
          var n = 1, o = 0;
          for (this[t2] = 255 & e; ++o < r && (n *= 256); )
            this[t2 + o] = e / n & 255;
          return t2 + r;
        }, Buffer.prototype.writeUIntBE = function(e, t2, r, i2) {
          e = +e, t2 |= 0, r |= 0, i2 || checkInt(this, e, t2, r, Math.pow(2, 8 * r) - 1, 0);
          var n = r - 1, o = 1;
          for (this[t2 + n] = 255 & e; 0 <= --n && (o *= 256); )
            this[t2 + n] = e / o & 255;
          return t2 + r;
        }, Buffer.prototype.writeUInt8 = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 1, 255, 0), Buffer.TYPED_ARRAY_SUPPORT || (e = Math.floor(e)), this[t2] = 255 & e, t2 + 1;
        }, Buffer.prototype.writeUInt16LE = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 2, 65535, 0), Buffer.TYPED_ARRAY_SUPPORT ? (this[t2] = 255 & e, this[t2 + 1] = e >>> 8) : objectWriteUInt16(this, e, t2, true), t2 + 2;
        }, Buffer.prototype.writeUInt16BE = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 2, 65535, 0), Buffer.TYPED_ARRAY_SUPPORT ? (this[t2] = e >>> 8, this[t2 + 1] = 255 & e) : objectWriteUInt16(this, e, t2, false), t2 + 2;
        }, Buffer.prototype.writeUInt32LE = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 4, 4294967295, 0), Buffer.TYPED_ARRAY_SUPPORT ? (this[t2 + 3] = e >>> 24, this[t2 + 2] = e >>> 16, this[t2 + 1] = e >>> 8, this[t2] = 255 & e) : objectWriteUInt32(this, e, t2, true), t2 + 4;
        }, Buffer.prototype.writeUInt32BE = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 4, 4294967295, 0), Buffer.TYPED_ARRAY_SUPPORT ? (this[t2] = e >>> 24, this[t2 + 1] = e >>> 16, this[t2 + 2] = e >>> 8, this[t2 + 3] = 255 & e) : objectWriteUInt32(this, e, t2, false), t2 + 4;
        }, Buffer.prototype.writeIntLE = function(e, t2, r, i2) {
          var n;
          e = +e, t2 |= 0, i2 || checkInt(this, e, t2, r, (n = Math.pow(2, 8 * r - 1)) - 1, -n);
          var o = 0, a2 = 1, s = 0;
          for (this[t2] = 255 & e; ++o < r && (a2 *= 256); )
            e < 0 && 0 === s && 0 !== this[t2 + o - 1] && (s = 1), this[t2 + o] = (e / a2 >> 0) - s & 255;
          return t2 + r;
        }, Buffer.prototype.writeIntBE = function(e, t2, r, i2) {
          var n;
          e = +e, t2 |= 0, i2 || checkInt(this, e, t2, r, (n = Math.pow(2, 8 * r - 1)) - 1, -n);
          var o = r - 1, a2 = 1, s = 0;
          for (this[t2 + o] = 255 & e; 0 <= --o && (a2 *= 256); )
            e < 0 && 0 === s && 0 !== this[t2 + o + 1] && (s = 1), this[t2 + o] = (e / a2 >> 0) - s & 255;
          return t2 + r;
        }, Buffer.prototype.writeInt8 = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 1, 127, -128), Buffer.TYPED_ARRAY_SUPPORT || (e = Math.floor(e)), e < 0 && (e = 255 + e + 1), this[t2] = 255 & e, t2 + 1;
        }, Buffer.prototype.writeInt16LE = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 2, 32767, -32768), Buffer.TYPED_ARRAY_SUPPORT ? (this[t2] = 255 & e, this[t2 + 1] = e >>> 8) : objectWriteUInt16(this, e, t2, true), t2 + 2;
        }, Buffer.prototype.writeInt16BE = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 2, 32767, -32768), Buffer.TYPED_ARRAY_SUPPORT ? (this[t2] = e >>> 8, this[t2 + 1] = 255 & e) : objectWriteUInt16(this, e, t2, false), t2 + 2;
        }, Buffer.prototype.writeInt32LE = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 4, 2147483647, -2147483648), Buffer.TYPED_ARRAY_SUPPORT ? (this[t2] = 255 & e, this[t2 + 1] = e >>> 8, this[t2 + 2] = e >>> 16, this[t2 + 3] = e >>> 24) : objectWriteUInt32(this, e, t2, true), t2 + 4;
        }, Buffer.prototype.writeInt32BE = function(e, t2, r) {
          return e = +e, t2 |= 0, r || checkInt(this, e, t2, 4, 2147483647, -2147483648), e < 0 && (e = 4294967295 + e + 1), Buffer.TYPED_ARRAY_SUPPORT ? (this[t2] = e >>> 24, this[t2 + 1] = e >>> 16, this[t2 + 2] = e >>> 8, this[t2 + 3] = 255 & e) : objectWriteUInt32(this, e, t2, false), t2 + 4;
        }, Buffer.prototype.writeFloatLE = function(e, t2, r) {
          return writeFloat(this, e, t2, true, r);
        }, Buffer.prototype.writeFloatBE = function(e, t2, r) {
          return writeFloat(this, e, t2, false, r);
        }, Buffer.prototype.writeDoubleLE = function(e, t2, r) {
          return writeDouble(this, e, t2, true, r);
        }, Buffer.prototype.writeDoubleBE = function(e, t2, r) {
          return writeDouble(this, e, t2, false, r);
        }, Buffer.prototype.copy = function(e, t2, r, i2) {
          if (r = r || 0, i2 || 0 === i2 || (i2 = this.length), t2 >= e.length && (t2 = e.length), t2 = t2 || 0, 0 < i2 && i2 < r && (i2 = r), i2 === r)
            return 0;
          if (0 === e.length || 0 === this.length)
            return 0;
          if (t2 < 0)
            throw new RangeError("targetStart out of bounds");
          if (r < 0 || r >= this.length)
            throw new RangeError("sourceStart out of bounds");
          if (i2 < 0)
            throw new RangeError("sourceEnd out of bounds");
          i2 > this.length && (i2 = this.length), e.length - t2 < i2 - r && (i2 = e.length - t2 + r);
          var n, o = i2 - r;
          if (this === e && r < t2 && t2 < i2)
            for (n = o - 1; 0 <= n; --n)
              e[n + t2] = this[n + r];
          else if (o < 1e3 || !Buffer.TYPED_ARRAY_SUPPORT)
            for (n = 0; n < o; ++n)
              e[n + t2] = this[n + r];
          else
            Uint8Array.prototype.set.call(e, this.subarray(r, r + o), t2);
          return o;
        }, Buffer.prototype.fill = function(e, t2, r, i2) {
          if ("string" == typeof e) {
            var n;
            if ("string" == typeof t2 ? (i2 = t2, t2 = 0, r = this.length) : "string" == typeof r && (i2 = r, r = this.length), 1 !== e.length || (n = e.charCodeAt(0)) < 256 && (e = n), void 0 !== i2 && "string" != typeof i2)
              throw new TypeError("encoding must be a string");
            if ("string" == typeof i2 && !Buffer.isEncoding(i2))
              throw new TypeError("Unknown encoding: " + i2);
          } else
            "number" == typeof e && (e &= 255);
          if (t2 < 0 || this.length < t2 || this.length < r)
            throw new RangeError("Out of range index");
          if (r <= t2)
            return this;
          if (t2 >>>= 0, r = void 0 === r ? this.length : r >>> 0, "number" == typeof (e = e || 0))
            for (s = t2; s < r; ++s)
              this[s] = e;
          else
            for (var o = internalIsBuffer(e) ? e : utf8ToBytes(new Buffer(e, i2).toString()), a2 = o.length, s = 0; s < r - t2; ++s)
              this[s + t2] = o[s % a2];
          return this;
        };
        var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g;
        function base64clean(e) {
          if ((e = stringtrim(e).replace(INVALID_BASE64_RE, "")).length < 2)
            return "";
          for (; e.length % 4 != 0; )
            e += "=";
          return e;
        }
        function stringtrim(e) {
          return e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "");
        }
        function toHex(e) {
          return e < 16 ? "0" + e.toString(16) : e.toString(16);
        }
        function utf8ToBytes(e, t2) {
          var r;
          t2 = t2 || 1 / 0;
          for (var i2 = e.length, n = null, o = [], a2 = 0; a2 < i2; ++a2) {
            if (55295 < (r = e.charCodeAt(a2)) && r < 57344) {
              if (!n) {
                if (56319 < r) {
                  -1 < (t2 -= 3) && o.push(239, 191, 189);
                  continue;
                }
                if (a2 + 1 === i2) {
                  -1 < (t2 -= 3) && o.push(239, 191, 189);
                  continue;
                }
                n = r;
                continue;
              }
              if (r < 56320) {
                -1 < (t2 -= 3) && o.push(239, 191, 189), n = r;
                continue;
              }
              r = 65536 + (n - 55296 << 10 | r - 56320);
            } else
              n && -1 < (t2 -= 3) && o.push(239, 191, 189);
            if (n = null, r < 128) {
              if (--t2 < 0)
                break;
              o.push(r);
            } else if (r < 2048) {
              if ((t2 -= 2) < 0)
                break;
              o.push(r >> 6 | 192, 63 & r | 128);
            } else if (r < 65536) {
              if ((t2 -= 3) < 0)
                break;
              o.push(r >> 12 | 224, r >> 6 & 63 | 128, 63 & r | 128);
            } else {
              if (!(r < 1114112))
                throw new Error("Invalid code point");
              if ((t2 -= 4) < 0)
                break;
              o.push(r >> 18 | 240, r >> 12 & 63 | 128, r >> 6 & 63 | 128, 63 & r | 128);
            }
          }
          return o;
        }
        function asciiToBytes(e) {
          for (var t2 = [], r = 0; r < e.length; ++r)
            t2.push(255 & e.charCodeAt(r));
          return t2;
        }
        function utf16leToBytes(e, t2) {
          for (var r, i2, n, o = [], a2 = 0; a2 < e.length && !((t2 -= 2) < 0); ++a2)
            i2 = (r = e.charCodeAt(a2)) >> 8, n = r % 256, o.push(n), o.push(i2);
          return o;
        }
        function base64ToBytes(e) {
          return toByteArray(base64clean(e));
        }
        function blitBuffer(e, t2, r, i2) {
          for (var n = 0; n < i2 && !(n + r >= t2.length || n >= e.length); ++n)
            t2[n + r] = e[n];
          return n;
        }
        function isnan(e) {
          return e != e;
        }
        function isBuffer(e) {
          return null != e && (!!e._isBuffer || isFastBuffer(e) || isSlowBuffer(e));
        }
        function isFastBuffer(e) {
          return !!e.constructor && "function" == typeof e.constructor.isBuffer && e.constructor.isBuffer(e);
        }
        function isSlowBuffer(e) {
          return "function" == typeof e.readFloatLE && "function" == typeof e.slice && isFastBuffer(e.slice(0, 0));
        }
        var bufferEs6 = Object.freeze({ INSPECT_MAX_BYTES, kMaxLength: _kMaxLength, Buffer, SlowBuffer, isBuffer });
        global$1.setTimeout, global$1.clearTimeout;
        var performance$1 = global$1.performance || {}, performanceNow = performance$1.now || performance$1.mozNow || performance$1.msNow || performance$1.oNow || performance$1.webkitNow || function() {
          return (/* @__PURE__ */ new Date()).getTime();
        }, inherits, inherits = "function" == typeof Object.create ? function(e, t2) {
          e.super_ = t2, e.prototype = Object.create(t2.prototype, { constructor: { value: e, enumerable: false, writable: true, configurable: true } });
        } : function(e, t2) {
          e.super_ = t2;
          function r() {
          }
          r.prototype = t2.prototype, e.prototype = new r(), e.prototype.constructor = e;
        }, inherits$1 = inherits;
        function inspect(e, t2) {
          var r = { seen: [], stylize: stylizeNoColor };
          return 3 <= arguments.length && (r.depth = arguments[2]), 4 <= arguments.length && (r.colors = arguments[3]), isBoolean(t2) ? r.showHidden = t2 : t2 && _extend(r, t2), isUndefined(r.showHidden) && (r.showHidden = false), isUndefined(r.depth) && (r.depth = 2), isUndefined(r.colors) && (r.colors = false), isUndefined(r.customInspect) && (r.customInspect = true), r.colors && (r.stylize = stylizeWithColor), formatValue(r, e, r.depth);
        }
        function stylizeWithColor(e, t2) {
          var r = inspect.styles[t2];
          return r ? "\x1B[" + inspect.colors[r][0] + "m" + e + "\x1B[" + inspect.colors[r][1] + "m" : e;
        }
        function stylizeNoColor(e, t2) {
          return e;
        }
        function arrayToHash(e) {
          var r = {};
          return e.forEach(function(e2, t2) {
            r[e2] = true;
          }), r;
        }
        function formatValue(t2, r, i2) {
          if (t2.customInspect && r && isFunction(r.inspect) && r.inspect !== inspect && (!r.constructor || r.constructor.prototype !== r)) {
            var e = r.inspect(i2, t2);
            return isString(e) || (e = formatValue(t2, e, i2)), e;
          }
          var n = formatPrimitive(t2, r);
          if (n)
            return n;
          var o = Object.keys(r), a2 = arrayToHash(o);
          if (t2.showHidden && (o = Object.getOwnPropertyNames(r)), isError(r) && (0 <= o.indexOf("message") || 0 <= o.indexOf("description")))
            return formatError(r);
          if (0 === o.length) {
            if (isFunction(r)) {
              var s = r.name ? ": " + r.name : "";
              return t2.stylize("[Function" + s + "]", "special");
            }
            if (isRegExp(r))
              return t2.stylize(RegExp.prototype.toString.call(r), "regexp");
            if (isDate(r))
              return t2.stylize(Date.prototype.toString.call(r), "date");
            if (isError(r))
              return formatError(r);
          }
          var l, u2 = "", c2 = false, h = ["{", "}"];
          return isArray$1(r) && (c2 = true, h = ["[", "]"]), isFunction(r) && (u2 = " [Function" + (r.name ? ": " + r.name : "") + "]"), isRegExp(r) && (u2 = " " + RegExp.prototype.toString.call(r)), isDate(r) && (u2 = " " + Date.prototype.toUTCString.call(r)), isError(r) && (u2 = " " + formatError(r)), 0 !== o.length || c2 && 0 != r.length ? i2 < 0 ? isRegExp(r) ? t2.stylize(RegExp.prototype.toString.call(r), "regexp") : t2.stylize("[Object]", "special") : (t2.seen.push(r), l = c2 ? formatArray(t2, r, i2, a2, o) : o.map(function(e2) {
            return formatProperty(t2, r, i2, a2, e2, c2);
          }), t2.seen.pop(), reduceToSingleString(l, u2, h)) : h[0] + u2 + h[1];
        }
        function formatPrimitive(e, t2) {
          if (isUndefined(t2))
            return e.stylize("undefined", "undefined");
          if (isString(t2)) {
            var r = "'" + JSON.stringify(t2).replace(/^"|"$/g, "").replace(/'/g, "\\'").replace(/\\"/g, '"') + "'";
            return e.stylize(r, "string");
          }
          return isNumber(t2) ? e.stylize("" + t2, "number") : isBoolean(t2) ? e.stylize("" + t2, "boolean") : isNull(t2) ? e.stylize("null", "null") : void 0;
        }
        function formatError(e) {
          return "[" + Error.prototype.toString.call(e) + "]";
        }
        function formatArray(t2, r, i2, n, e) {
          for (var o = [], a2 = 0, s = r.length; a2 < s; ++a2)
            hasOwnProperty$1(r, String(a2)) ? o.push(formatProperty(t2, r, i2, n, String(a2), true)) : o.push("");
          return e.forEach(function(e2) {
            e2.match(/^\d+$/) || o.push(formatProperty(t2, r, i2, n, e2, true));
          }), o;
        }
        function formatProperty(e, t2, r, i2, n, o) {
          var a2, s, l = Object.getOwnPropertyDescriptor(t2, n) || { value: t2[n] };
          if (l.get ? s = l.set ? e.stylize("[Getter/Setter]", "special") : e.stylize("[Getter]", "special") : l.set && (s = e.stylize("[Setter]", "special")), hasOwnProperty$1(i2, n) || (a2 = "[" + n + "]"), s || (e.seen.indexOf(l.value) < 0 ? -1 < (s = isNull(r) ? formatValue(e, l.value, null) : formatValue(e, l.value, r - 1)).indexOf("\n") && (s = o ? s.split("\n").map(function(e2) {
            return "  " + e2;
          }).join("\n").substr(2) : "\n" + s.split("\n").map(function(e2) {
            return "   " + e2;
          }).join("\n")) : s = e.stylize("[Circular]", "special")), isUndefined(a2)) {
            if (o && n.match(/^\d+$/))
              return s;
            a2 = (a2 = JSON.stringify("" + n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/) ? (a2 = a2.substr(1, a2.length - 2), e.stylize(a2, "name")) : (a2 = a2.replace(/'/g, "\\'").replace(/\\"/g, '"').replace(/(^"|"$)/g, "'"), e.stylize(a2, "string"));
          }
          return a2 + ": " + s;
        }
        function reduceToSingleString(e, t2, r) {
          return 60 < e.reduce(function(e2, t3) {
            return t3.indexOf("\n"), e2 + t3.replace(/\u001b\[\d\d?m/g, "").length + 1;
          }, 0) ? r[0] + ("" === t2 ? "" : t2 + "\n ") + " " + e.join(",\n  ") + " " + r[1] : r[0] + t2 + " " + e.join(", ") + " " + r[1];
        }
        function isArray$1(e) {
          return Array.isArray(e);
        }
        function isBoolean(e) {
          return "boolean" == typeof e;
        }
        function isNull(e) {
          return null === e;
        }
        function isNumber(e) {
          return "number" == typeof e;
        }
        function isString(e) {
          return "string" == typeof e;
        }
        function isUndefined(e) {
          return void 0 === e;
        }
        function isRegExp(e) {
          return isObject$1(e) && "[object RegExp]" === objectToString$1(e);
        }
        function isObject$1(e) {
          return "object" == typeof e && null !== e;
        }
        function isDate(e) {
          return isObject$1(e) && "[object Date]" === objectToString$1(e);
        }
        function isError(e) {
          return isObject$1(e) && ("[object Error]" === objectToString$1(e) || e instanceof Error);
        }
        function isFunction(e) {
          return "function" == typeof e;
        }
        function isPrimitive(e) {
          return null === e || "boolean" == typeof e || "number" == typeof e || "string" == typeof e || "symbol" == typeof e || void 0 === e;
        }
        function objectToString$1(e) {
          return Object.prototype.toString.call(e);
        }
        function _extend(e, t2) {
          if (!t2 || !isObject$1(t2))
            return e;
          for (var r = Object.keys(t2), i2 = r.length; i2--; )
            e[r[i2]] = t2[r[i2]];
          return e;
        }
        function hasOwnProperty$1(e, t2) {
          return Object.prototype.hasOwnProperty.call(e, t2);
        }
        function compare(e, t2) {
          if (e === t2)
            return 0;
          for (var r = e.length, i2 = t2.length, n = 0, o = Math.min(r, i2); n < o; ++n)
            if (e[n] !== t2[n]) {
              r = e[n], i2 = t2[n];
              break;
            }
          return r < i2 ? -1 : i2 < r ? 1 : 0;
        }
        inspect.colors = { bold: [1, 22], italic: [3, 23], underline: [4, 24], inverse: [7, 27], white: [37, 39], grey: [90, 39], black: [30, 39], blue: [34, 39], cyan: [36, 39], green: [32, 39], magenta: [35, 39], red: [31, 39], yellow: [33, 39] }, inspect.styles = { special: "cyan", number: "yellow", boolean: "yellow", undefined: "grey", null: "bold", string: "green", date: "magenta", regexp: "red" };
        var hasOwn = Object.prototype.hasOwnProperty, objectKeys$1 = Object.keys || function(e) {
          var t2 = [];
          for (var r in e)
            hasOwn.call(e, r) && t2.push(r);
          return t2;
        }, pSlice = Array.prototype.slice, _functionsHaveNames;
        function functionsHaveNames() {
          return void 0 !== _functionsHaveNames ? _functionsHaveNames : _functionsHaveNames = "foo" === (function() {
          }).name;
        }
        function pToString(e) {
          return Object.prototype.toString.call(e);
        }
        function isView(e) {
          if (!isBuffer(e) && "function" == typeof global$1.ArrayBuffer) {
            if ("function" == typeof ArrayBuffer.isView)
              return ArrayBuffer.isView(e);
            if (e)
              return e instanceof DataView || !!(e.buffer && e.buffer instanceof ArrayBuffer);
          }
        }
        function assert(e, t2) {
          e || fail(e, true, t2, "==", ok);
        }
        var regex = /\s*function\s+([^\(\s]*)\s*/;
        function getName(e) {
          if (isFunction(e)) {
            if (functionsHaveNames())
              return e.name;
            var t2 = e.toString().match(regex);
            return t2 && t2[1];
          }
        }
        function AssertionError(e) {
          this.name = "AssertionError", this.actual = e.actual, this.expected = e.expected, this.operator = e.operator, e.message ? (this.message = e.message, this.generatedMessage = false) : (this.message = getMessage(this), this.generatedMessage = true);
          var t2, r, i2, n, o, a2 = e.stackStartFunction || fail;
          Error.captureStackTrace ? Error.captureStackTrace(this, a2) : (t2 = new Error()).stack && (o = t2.stack, r = getName(a2), 0 <= (i2 = o.indexOf("\n" + r)) && (n = o.indexOf("\n", i2 + 1), o = o.substring(n + 1)), this.stack = o);
        }
        function truncate(e, t2) {
          return "string" != typeof e || e.length < t2 ? e : e.slice(0, t2);
        }
        function inspect$1(e) {
          if (functionsHaveNames() || !isFunction(e))
            return inspect(e);
          var t2 = getName(e);
          return "[Function" + (t2 ? ": " + t2 : "") + "]";
        }
        function getMessage(e) {
          return truncate(inspect$1(e.actual), 128) + " " + e.operator + " " + truncate(inspect$1(e.expected), 128);
        }
        function fail(e, t2, r, i2, n) {
          throw new AssertionError({ message: r, actual: e, expected: t2, operator: i2, stackStartFunction: n });
        }
        function ok(e, t2) {
          e || fail(e, true, t2, "==", ok);
        }
        function equal(e, t2, r) {
          e != t2 && fail(e, t2, r, "==", equal);
        }
        function notEqual(e, t2, r) {
          e == t2 && fail(e, t2, r, "!=", notEqual);
        }
        function deepEqual(e, t2, r) {
          _deepEqual(e, t2, false) || fail(e, t2, r, "deepEqual", deepEqual);
        }
        function deepStrictEqual(e, t2, r) {
          _deepEqual(e, t2, true) || fail(e, t2, r, "deepStrictEqual", deepStrictEqual);
        }
        function _deepEqual(e, t2, r, i2) {
          if (e === t2)
            return true;
          if (isBuffer(e) && isBuffer(t2))
            return 0 === compare(e, t2);
          if (isDate(e) && isDate(t2))
            return e.getTime() === t2.getTime();
          if (isRegExp(e) && isRegExp(t2))
            return e.source === t2.source && e.global === t2.global && e.multiline === t2.multiline && e.lastIndex === t2.lastIndex && e.ignoreCase === t2.ignoreCase;
          if (null !== e && "object" == typeof e || null !== t2 && "object" == typeof t2) {
            if (isView(e) && isView(t2) && pToString(e) === pToString(t2) && !(e instanceof Float32Array || e instanceof Float64Array))
              return 0 === compare(new Uint8Array(e.buffer), new Uint8Array(t2.buffer));
            if (isBuffer(e) !== isBuffer(t2))
              return false;
            var n = (i2 = i2 || { actual: [], expected: [] }).actual.indexOf(e);
            return -1 !== n && n === i2.expected.indexOf(t2) || (i2.actual.push(e), i2.expected.push(t2), objEquiv(e, t2, r, i2));
          }
          return r ? e === t2 : e == t2;
        }
        function isArguments(e) {
          return "[object Arguments]" == Object.prototype.toString.call(e);
        }
        function objEquiv(e, t2, r, i2) {
          if (null == e || null == t2)
            return false;
          if (isPrimitive(e) || isPrimitive(t2))
            return e === t2;
          if (r && Object.getPrototypeOf(e) !== Object.getPrototypeOf(t2))
            return false;
          var n = isArguments(e), o = isArguments(t2);
          if (n && !o || !n && o)
            return false;
          if (n)
            return _deepEqual(e = pSlice.call(e), t2 = pSlice.call(t2), r);
          var a2, s, l = objectKeys$1(e), u2 = objectKeys$1(t2);
          if (l.length !== u2.length)
            return false;
          for (l.sort(), u2.sort(), s = l.length - 1; 0 <= s; s--)
            if (l[s] !== u2[s])
              return false;
          for (s = l.length - 1; 0 <= s; s--)
            if (!_deepEqual(e[a2 = l[s]], t2[a2], r, i2))
              return false;
          return true;
        }
        function notDeepEqual(e, t2, r) {
          _deepEqual(e, t2, false) && fail(e, t2, r, "notDeepEqual", notDeepEqual);
        }
        function notDeepStrictEqual(e, t2, r) {
          _deepEqual(e, t2, true) && fail(e, t2, r, "notDeepStrictEqual", notDeepStrictEqual);
        }
        function strictEqual(e, t2, r) {
          e !== t2 && fail(e, t2, r, "===", strictEqual);
        }
        function notStrictEqual(e, t2, r) {
          e === t2 && fail(e, t2, r, "!==", notStrictEqual);
        }
        function expectedException(e, t2) {
          if (e && t2) {
            if ("[object RegExp]" == Object.prototype.toString.call(t2))
              return t2.test(e);
            try {
              if (e instanceof t2)
                return 1;
            } catch (e2) {
            }
            if (!Error.isPrototypeOf(t2))
              return true === t2.call({}, e);
          }
        }
        function _tryBlock(e) {
          var t2;
          try {
            e();
          } catch (e2) {
            t2 = e2;
          }
          return t2;
        }
        function _throws(e, t2, r, i2) {
          var n;
          if ("function" != typeof t2)
            throw new TypeError('"block" argument must be a function');
          "string" == typeof r && (i2 = r, r = null), n = _tryBlock(t2), i2 = (r && r.name ? " (" + r.name + ")." : ".") + (i2 ? " " + i2 : "."), e && !n && fail(n, r, "Missing expected exception" + i2);
          var o = "string" == typeof i2, a2 = !e && n && !r;
          if ((!e && isError(n) && o && expectedException(n, r) || a2) && fail(n, r, "Got unwanted exception" + i2), e && n && r && !expectedException(n, r) || !e && n)
            throw n;
        }
        function throws(e, t2, r) {
          _throws(true, e, t2, r);
        }
        function doesNotThrow(e, t2, r) {
          _throws(false, e, t2, r);
        }
        function ifError(e) {
          if (e)
            throw e;
        }
        assert.AssertionError = AssertionError, inherits$1(AssertionError, Error), assert.fail = fail, assert.ok = ok, assert.equal = equal, assert.notEqual = notEqual, assert.deepEqual = deepEqual, assert.deepStrictEqual = deepStrictEqual, assert.notDeepEqual = notDeepEqual, assert.notDeepStrictEqual = notDeepStrictEqual, assert.strictEqual = strictEqual, assert.notStrictEqual = notStrictEqual, assert.throws = throws, assert.doesNotThrow = doesNotThrow, assert.ifError = ifError;
        var sort = function(e) {
          return e.sort(function(e2, t2) {
            return e2.height - t2.height;
          }), e;
        }, placeItems = function(e) {
          var t2 = 0;
          return e.forEach(function(e2) {
            e2.x = 0, e2.y = t2, t2 += e2.height;
          }), e;
        }, topDown_algorithm = { sort, placeItems }, sort$1 = function(e) {
          return e.sort(function(e2, t2) {
            return e2.width - t2.width;
          }), e;
        }, placeItems$1 = function(e) {
          var t2 = 0;
          return e.forEach(function(e2) {
            e2.x = t2, e2.y = 0, t2 += e2.width;
          }), e;
        }, leftRight_algorithm = { sort: sort$1, placeItems: placeItems$1 }, sort$2 = function(e) {
          return e.sort(function(e2, t2) {
            return Math.sqrt(Math.pow(e2.height, 2) + Math.pow(e2.width, 2)) - Math.sqrt(Math.pow(t2.height, 2) + Math.pow(t2.width, 2));
          }), e;
        }, placeItems$2 = function(e) {
          var t2 = 0, r = 0;
          return e.forEach(function(e2) {
            e2.x = t2, e2.y = r, t2 += e2.width, r += e2.height;
          }), e;
        }, diagonal_algorithm = { sort: sort$2, placeItems: placeItems$2 }, sort$3 = function(e) {
          return e.sort(function(e2, t2) {
            return Math.sqrt(Math.pow(e2.height, 2) + Math.pow(e2.width, 2)) - Math.sqrt(Math.pow(t2.height, 2) + Math.pow(t2.width, 2));
          }), e;
        }, placeItems$3 = function(e) {
          var r = 0, i2 = 0;
          return e.forEach(function(e2) {
            var t2 = e2.width;
            e2.x = r - t2, e2.y = i2, r -= t2, i2 += e2.height;
          }), e;
        }, altDiagonal_algorithm = { sort: sort$3, placeItems: placeItems$3 }, GrowingPacker = function() {
        };
        GrowingPacker.prototype = { fit: function(e) {
          var t2, r, i2, n, o = e.length, a2 = 0 < o ? e[0].width : 0, s = 0 < o ? e[0].height : 0;
          for (this.root = { x: 0, y: 0, width: a2, height: s }, t2 = 0; t2 < o; t2++)
            i2 = e[t2], n = (r = this.findNode(this.root, i2.width, i2.height)) ? this.splitNode(r, i2.width, i2.height) : this.growNode(i2.width, i2.height), i2.x = n.x, i2.y = n.y;
        }, findNode: function(e, t2, r) {
          return e.used ? this.findNode(e.right, t2, r) || this.findNode(e.down, t2, r) : t2 <= e.width && r <= e.height ? e : null;
        }, splitNode: function(e, t2, r) {
          return e.used = true, e.down = { x: e.x, y: e.y + r, width: e.width, height: e.height - r }, e.right = { x: e.x + t2, y: e.y, width: e.width - t2, height: r }, e;
        }, growNode: function(e, t2) {
          var r = e <= this.root.width, i2 = t2 <= this.root.height, n = i2 && this.root.height >= this.root.width + e, o = r && this.root.width >= this.root.height + t2;
          return n ? this.growRight(e, t2) : o ? this.growDown(e, t2) : i2 ? this.growRight(e, t2) : r ? this.growDown(e, t2) : null;
        }, growRight: function(e, t2) {
          var r;
          return this.root = { used: true, x: 0, y: 0, width: this.root.width + e, height: this.root.height, down: this.root, right: { x: this.root.width, y: 0, width: e, height: this.root.height } }, (r = this.findNode(this.root, e, t2)) ? this.splitNode(r, e, t2) : null;
        }, growDown: function(e, t2) {
          var r;
          return this.root = { used: true, x: 0, y: 0, width: this.root.width, height: this.root.height + t2, down: { x: 0, y: this.root.height, width: this.root.width, height: t2 }, right: this.root }, (r = this.findNode(this.root, e, t2)) ? this.splitNode(r, e, t2) : null;
        } };
        var packer_growing = GrowingPacker, binPack = function(e, t2) {
          t2 = t2 || {};
          var r = new packer_growing(), i2 = t2.inPlace || false, n = (n = e.map(function(e2) {
            return i2 ? e2 : { width: e2.width, height: e2.height, item: e2 };
          })).sort(function(e2, t3) {
            return t3.width * t3.height - e2.width * e2.height;
          });
          r.fit(n);
          var o = { width: n.reduce(function(e2, t3) {
            return Math.max(e2, t3.x + t3.width);
          }, 0), height: n.reduce(function(e2, t3) {
            return Math.max(e2, t3.y + t3.height);
          }, 0) };
          return i2 || (o.items = n), o;
        }, sort$4 = function(e) {
          return e;
        }, placeItems$4 = function(e) {
          return binPack(e, { inPlace: true }), e;
        }, binaryTree_algorithm = { sort: sort$4, placeItems: placeItems$4 }, algorithms = {};
        function Layout(e, t2) {
          var r = e || "top-down";
          return "string" == typeof r && assert(r = algorithms[e], "Sorry, the '" + e + "' algorithm could not be loaded."), new packing_smith(r, t2);
        }
        function addAlgorithm(e, t2) {
          algorithms[e] = t2;
        }
        Layout.PackingSmith = packing_smith, Layout.addAlgorithm = addAlgorithm, Layout.algorithms = algorithms, addAlgorithm("top-down", topDown_algorithm), addAlgorithm("left-right", leftRight_algorithm), addAlgorithm("diagonal", diagonal_algorithm), addAlgorithm("alt-diagonal", altDiagonal_algorithm), addAlgorithm("binary-tree", binaryTree_algorithm);
        var layout = Layout;
        function isTainting(e) {
          var t2;
          try {
            e.getContext("2d", { willReadFrequently: true }).getImageData(0, 0, 1, 1);
          } catch (e2) {
            t2 = e2.message;
          }
          return t2;
        }
        function bitmapToCanvas(e, t2, r) {
          var i2;
          return e instanceof HTMLImageElement && ((i2 = e.ownerDocument.createElement("canvas")).width = t2, i2.height = r, i2.getContext("2d").drawImage(e, 0, 0, t2, r), e = i2), e;
        }
        var MAX_LNG_LAT = Geo$1.metersToLatLng([Geo$1.half_circumference_meters, Geo$1.half_circumference_meters]), TILE_EXPONENT = Math.log(Geo$1.tile_size) / Math.LN2, ICON_READY = 1, DOM_MARKER_TYPE = 8, GROUP_TYPE = 16, TILE_MARGIN = 100, AFFECTED_BBOX_CALC_THRESHOLD = 10, ObjectSource = function() {
          _inherits(p2, MapsJsSource);
          var i2 = _createSuper(p2);
          function p2(e, t2) {
            var r;
            return _classCallCheck(this, p2), r = i2.call(this, e, t2), Thread.is_worker && (r._quad_tree = new ns.H.geo.QuadTree(), r._marker_quad_tree = new ns.H.geo.QuadTree(), r._tree_entries_by_object_id = {}, r._groups_by_id = {}, r._layersCache = new ns.H.util.Cache(100)), Thread.is_main && (r._objects_by_id = {}, r._commands = [], r._sendCommands = debounce(r._sendCommands, 100, 200), r.dispatchUpdate = r.dispatchUpdate.bind(_assertThisInitialized(r))), r;
          }
          return _createClass(p2, [{ key: "hasLabeledData", value: function() {
            return false;
          } }, { key: "onReady", value: function() {
            this._synced_at = this.provider.getInvalidations().getMark();
            var e, t2, r = this.provider.getRootGroup(), i3 = r.getObjects(true), n = [];
            for (i3.push(r), e = i3.length; e--; )
              t2 = i3[e], this._isObjectSupported(t2) && this._shouldBeStored(t2) && (this._objects_by_id[t2.getId()] = t2, n.push(t2.forWorkerMessage()));
            var o = [{ method_name: "addObjects", arguments: [n] }];
            this._sendImmediateCommands(o);
          } }, { key: "onProviderUpdate", value: function(e) {
            var t2, r, i3, n, o = e.target, a2 = e.currentTarget.getInvalidations(o.type);
            this._isObjectSupported(o) && (t2 = this._synced_at, r = o.getId(), a2.isRemove(t2) ? (delete this._objects_by_id[r], this._commands.push({ method_name: "removeObjectsByIds", arguments: [[r], true] })) : a2.isAdd(t2) ? this._shouldBeStored(o) && (this._objects_by_id[r] = o, this._commands.push({ method_name: "addObjects", arguments: [[o.forWorkerMessage()]] })) : a2.isSpatial(t2) || a2.isZOrder(t2) ? this._shouldBeStored(o) && (i3 = [{ method_name: "removeObjectsByIds", arguments: [[r], true] }, { method_name: "addObjects", arguments: [[(this._objects_by_id[r] = o).forWorkerMessage()]] }], this.has_volatile_data && !this.hasPendingCommands() ? this._sendImmediateCommands(i3) : this._commands.push(i3[0], i3[1])) : a2.isVisual(t2) ? this._shouldBeStored(o) && (n = { method_name: "updateObjectProperties", arguments: [(this._objects_by_id[r] = o).forWorkerMessage()] }, this.has_volatile_data && !this.hasPendingCommands() ? this._sendImmediateCommands([n]) : this._commands.push(n)) : a2.isVolatility(t2) && (delete this._objects_by_id[r], this._commands.push({ method_name: "removeObjectsByIds", arguments: [[r], true] }), this._shouldBeStored(o) && (this._objects_by_id[r] = o, this._commands.push({ method_name: "addObjects", arguments: [[o.forWorkerMessage()]] }))), this._commands.length && this._sendCommands()), this._synced_at = a2.getMark();
          } }, { key: "_shouldBeStored", value: function(e) {
            return e.type === GROUP_TYPE || (!e.getIcon || e.getIcon().getState() === ICON_READY) && this._hasSameVolatility(e);
          } }, { key: "_hasSameVolatility", value: function(e) {
            return e.getVolatility(true) === this.has_volatile_data;
          } }, { key: "hasPendingCommands", value: function() {
            return 0 < this._commands.length;
          } }, { key: "_sendCommands", value: function() {
            this._sendImmediateCommands(this._commands), this._commands = [];
          } }, { key: "_sendImmediateCommands", value: function(e) {
            e.length && WorkerBroker.postMessage(this.worker, this.target_name + ".executeCommands", e).then(this.dispatchUpdate);
          } }, { key: "_isObjectSupported", value: function(e) {
            return e.forWorkerMessage && e.type !== DOM_MARKER_TYPE;
          } }, { key: "getSyncedAt", value: function() {
            return this._synced_at;
          } }, { key: "getMapObjectById", value: function(e) {
            return this._objects_by_id[e];
          } }, { key: "getIconBitmapByObjectId", value: function(e, t2) {
            var r = this.getMapObjectById(e);
            if (r) {
              var i3 = r.getIcon();
              if (i3.uid === t2 && i3.getState() === ICON_READY) {
                var n = i3.getSize();
                return bitmapToCanvas(i3.getBitmap(), n.w, n.h);
              }
            }
          } }, { key: "_getRastersForMarkers", value: function(e) {
            for (var t2 = {}, r = layout("binary-tree"), i3 = 0; i3 < e.length; i3++) {
              var n = e[i3], o = n.properties.icon;
              t2[o.id] || (r.addItem({ width: o.size.w, height: o.size.h, meta: { objectId: n.id, id: o.id } }), t2[o.id] = true);
            }
            return r.export();
          } }, { key: "fetchFeaturesForTile", value: function(e) {
            var t2 = [], r = [], i3 = [], n = [], o = [], a2 = this._marker_quad_tree.intersectBoundingBox(Geo$1.getTileBoundingBox(e.coords, this.tile_size));
            e.source_data.error = null;
            for (var s = 0; s < a2.length; s++) {
              var l = { id: a2[s].$feature$.id, properties: Object.assign({}, a2[s].$feature$.properties), geometry: { type: a2[s].$feature$.geometry.type, coordinates: ArrayUtils$1.deepClone(a2[s].$feature$.geometry.coordinates) } };
              t2.push(l);
            }
            a2 = this._quad_tree.intersectBoundingBox(Geo$1.getTileBoundingBox(e.coords, this.tile_size, TILE_MARGIN));
            for (var u2 = 0; u2 < a2.length; u2++) {
              var c2, h = { id: a2[u2].$feature$.id, properties: Object.assign({}, a2[u2].$feature$.properties), geometry: { type: a2[u2].$feature$.geometry.type, coordinates: ArrayUtils$1.deepClone(a2[u2].$feature$.geometry.coordinates) } };
              h.properties.overlay ? r.push(h) : h.geometry.type.includes("LineString") ? i3.push(h) : h.geometry.type.includes("Polygon") && (n.push(h), c2 = { id: h.id, properties: h.properties, geometry: { type: h.geometry.type, coordinates: ArrayUtils$1.deepClone(h.geometry.coordinates) } }, o.push(c2));
            }
            t2.sort(p2._compareZInfo), n.sort(p2._compareZInfo), r.sort(p2._compareZInfo);
            var f2 = this.has_volatile_data ? 4096 : 0;
            o.sort(p2._compareZInfo);
            for (var d = 0; d < o.length; d++)
              o[d].properties.effectiveZIdx = f2++;
            i3.sort(p2._compareZInfo);
            for (var _ = 0; _ < i3.length; _++)
              i3[_].properties.effectiveZIdx = f2++;
            e.source_data.layers.markers = { type: "FeatureCollection", features: t2 }, e.source_data.layers.polylines = { type: "FeatureCollection", features: i3 }, e.source_data.layers.polygons = { type: "FeatureCollection", features: n }, e.source_data.layers.outlines = { type: "FeatureCollection", features: o }, e.source_data.layers.overlays = { type: "FeatureCollection", features: r };
          } }, { key: "tileTexture", value: function(e) {
            var t2 = e.source_data.layers.overlays;
            if (t2) {
              var r = this.name + "_" + e.coords.key, i3 = Tile.coordinateWithMaxZoom(e.coords, this.max_zoom), n = t2.features[0].properties.overlays_config;
              return { name: r, filtering: this.filtering, coords: i3, width: Geo$1.tile_size, height: Geo$1.tile_size, overlays_config: n, source: this.name };
            }
          } }, { key: "_load", value: function(e) {
            var t2 = Geo$1.wrapTile(e.coords, { x: true }), r = t2.z, i3 = t2.x, n = t2.y, o = "".concat(r, "_").concat(i3, "_").concat(n), a2 = this._layersCache.get(o), s = false;
            if (a2)
              e.source_data.layers = a2;
            else {
              this.fetchFeaturesForTile(e);
              var l = { maxZoom: this.max_zoom, tolerance: 1.5, extent: Geo$1.tile_scale }, u2 = e.source_data.layers.overlays;
              u2.features.length && delete e.source_data.layers.overlays;
              var c2 = e.source_data.layers.markers;
              for (var h in c2.features.length && delete e.source_data.layers.markers, e.source_data.layers) {
                var f2, d = e.source_data.layers[h];
                d.features.length && (l.buffer = h.includes("lines") ? TILE_MARGIN * Geo$1.units_per_pixel : 0, f2 = createGeoJsonTile(d, r, i3, n, l), e.source_data.layers[h] = parseGeoJSONVectorTile(f2));
              }
              e.source_data.layers.overlays = this._processOverlays(e, u2);
              for (var _ = e.source_data.layers.overlays.features.length; _--; )
                if (!e.source_data.layers.overlays.features[_].id) {
                  s = true, this._layersCache.drop(o);
                  break;
                }
              e.source_data.layers.markers = this._processMarkers(e, c2), this._postProcessTile(e), s || this._layersCache.add(o, e.source_data.layers, 1);
            }
            return e.rasters = this._getRastersForMarkers(e.source_data.layers.markers.features), Promise.resolve(e);
          } }, { key: "_processMarkers", value: function(o, e) {
            var t2 = e.features.length;
            if (t2) {
              for (var a2 = Geo$1.unitsPerMeter(o.coords.z), r = Geo$1.wrapTile(o.coords, { x: true }), s = Geo$1.metersForTile(r), l = Geo$1.isLastTile(r), u2 = Geo$1.wrapMeters(o.min), c2 = Geo$1.wrapMeters(o.max), i3 = function(e2) {
                DataSource.coordsToMeters(e2);
                var t3 = _slicedToArray(e2, 2), r2 = t3[0], i4 = t3[1], n2 = r2 >= u2.x && (l.column || r2 < c2.x) && i4 >= c2.y && (l.row || !o.coords.y || i4 < u2.y);
                return DataSource.metersToTileUnits(a2, s, e2), n2;
              }, n = [], h = 0; h < t2; h++) {
                var f2, d = e.features[h].geometry, _ = false;
                "Point" === d.type ? i3(f2 = d.coordinates) ? d.coordinates = f2 : _ = true : "MultiPoint" === d.type && (d.coordinates = d.coordinates.filter(i3), 0 === d.coordinates.length && (_ = true)), _ || n.push(e.features[h]);
              }
              e.features = n;
            }
            return e;
          } }, { key: "_processOverlays", value: function(t2, e) {
            var r = this;
            if (!e.features.length)
              return e;
            var i3 = { coords: t2.coords, min: Geo$1.metersForTile(Geo$1.wrapTile(t2.coords, { x: true })) }, n = { coords: t2.coords, source_data: { layers: { _default: { type: "FeatureCollection", features: e.features } } } }, h = Math.pow(2, t2.coords.z + TILE_EXPONENT);
            MapsJsSource.projectData(n.source_data), MapsJsSource.scaleData(n.source_data, i3);
            var o = e.features.map(function(e2) {
              var t3 = e2.geometry.coordinates[0], r2 = t3[0], i4 = t3[5 === t3.length ? 2 : 3], n2 = Math.floor(r2[0] / Geo$1.tile_scale * Geo$1.tile_size), o2 = Math.floor(r2[1] / Geo$1.tile_scale * Geo$1.tile_size), a3 = Math.floor(i4[0] / Geo$1.tile_scale * Geo$1.tile_size), s = Math.floor(i4[1] / Geo$1.tile_scale * Geo$1.tile_size) - o2, l = a3 <= n2, u2 = l ? h - (n2 - a3) : a3 - n2, c2 = [];
              return n2 <= Geo$1.tile_size && c2.push([n2, o2, u2, s]), l && 0 < a3 && c2.push([n2 - h, o2, u2, s]), { id: e2.id, properties: e2.properties, texcoords: c2 };
            }).filter(function(e2) {
              return r._isVisible(e2.properties) && r.isInMinMaxRange(e2.properties, t2.style_zoom);
            }), a2 = Geo$1.tile_scale;
            return t2.pad_scale = this.pad_scale, t2.default_winding = "CW", e.features = o.length ? [{ geometry: { type: "Polygon", coordinates: [[[0, 0], [a2, 0], [a2, a2], [0, a2], [0, 0]]] }, properties: { overlays_config: o } }] : o, e;
          } }, { key: "executeCommands", value: function(e) {
            for (var t2, r = e.length < AFFECTED_BBOX_CALC_THRESHOLD, i3 = 0; i3 < e.length; i3++) {
              var n = e[i3];
              n.arguments.push(r);
              var o = this[n.method_name].apply(this, n.arguments);
              r && (o && t2 ? t2.mergeRect(o, true, t2) : o && (t2 = o));
            }
            return t2 ? t2.forWorkerMessage() : void 0;
          } }, { key: "_getClampedGeoRectForFeature", value: function(e) {
            var t2 = e.geometry.boundingBox;
            return new ns.H.geo.Rect(MathUtils$1.clamp(t2[0], -MAX_LNG_LAT[1], MAX_LNG_LAT[1]), t2[1], MathUtils$1.clamp(t2[2], -MAX_LNG_LAT[1], MAX_LNG_LAT[1]), t2[3]);
          } }, { key: "addObjects", value: function(e, t2) {
            for (var r, i3 = 1 < arguments.length && void 0 !== t2 && t2, n = 0; n < e.length; n++) {
              var o, a2, s, l = e[n];
              "Group" === l.type ? (l.$children_ids$ = {}, this._groups_by_id[l.id] = l) : (p2._preprocessGeometry(l.geometry), o = this._getClampedGeoRectForFeature(l), i3 && (r ? r.mergeRect(o, true, r) : r = o), (s = (a2 = -1 !== l.geometry.type.indexOf("Point") ? this._marker_quad_tree : this._quad_tree).insertBoundingBox(o)).$tree = a2, s.$feature$ = l, this._tree_entries_by_object_id[l.id] = s);
            }
            for (var u2 = 0; u2 < e.length; u2++) {
              var c2 = e[u2];
              c2.properties.parent && (this._groups_by_id[c2.properties.parent].$children_ids$[c2.id] = c2.id), c2.properties.ref = { effectiveVisibility: this._isVisible(c2.properties), zInfo: this._getZInfo([], c2) };
            }
            return this._layersCache.removeAll(), r;
          } }, { key: "removeObjectsByIds", value: function(e, t2, r) {
            for (var i3, n = 2 < arguments.length && void 0 !== r && r, o = 0; o < e.length; o++) {
              var a2, s = e[o], l = void 0, u2 = void 0;
              (l = this._tree_entries_by_object_id[s]) ? (n && (a2 = this._getClampedGeoRectForFeature(l.$feature$), i3 ? i3.mergeRect(a2, true, i3) : i3 = a2), delete this._groups_by_id[l.$feature$.properties.parent].$children_ids$[s], l.$tree.remove(l), delete this._tree_entries_by_object_id[s]) : (u2 = this._groups_by_id[s]) && (u2.properties.parent && delete this._groups_by_id[u2.properties.parent].$children_ids$[s], t2 && this.removeObjectsByIds(Object.keys(u2.$children_ids$), true), delete this._groups_by_id[s]);
            }
            return this._layersCache.removeAll(), i3;
          } }, { key: "updateObjectProperties", value: function(e, t2) {
            var r, i3 = 1 < arguments.length && void 0 !== t2 && t2;
            return "Group" === e.type ? (mergeObjects(this._groups_by_id[e.id].properties, e.properties), this._groups_by_id[e.id].properties.ref.effectiveVisibility = this._isVisible(e.properties)) : (this._tree_entries_by_object_id[e.id] || this.addObjects([e]), mergeObjects(this._tree_entries_by_object_id[e.id].$feature$.properties, e.properties), this._tree_entries_by_object_id[e.id].$feature$.properties.ref.effectiveVisibility = this._isVisible(e.properties), i3 && (r = this._getClampedGeoRectForFeature(e))), r;
          } }, { key: "_getZInfo", value: function(e, t2) {
            var r = t2.properties.zIdx, i3 = t2.properties.sIdx;
            return e[0] |= void 0 !== r, e.splice(1, 0, r || 0, i3 < 0 ? t2.id : i3), 0 === t2.properties.parent ? e : this._getZInfo(e, this._groups_by_id[t2.properties.parent]);
          } }, { key: "_isVisible", value: function(e) {
            var t2 = e.visible, r = !e.parent || this._isVisible(this._groups_by_id[e.parent].properties);
            return t2 && r;
          } }, { key: "isInMinMaxRange", value: function(e, t2) {
            var r = e.min <= t2 && e.max >= t2, i3 = !e.parent || this.isInMinMaxRange(this._groups_by_id[e.parent].properties, t2);
            return r && i3;
          } }, { key: "dispose", value: function() {
            this._commands = [], _get(_getPrototypeOf(p2.prototype), "dispose", this).call(this);
          } }], [{ key: "_compareZInfo", value: function(e, t2) {
            for (var r, i3 = e.properties.ref.zInfo, n = t2.properties.ref.zInfo, o = i3.length, a2 = n.length, s = Math.min(o, a2), l = 1; l < s; l++)
              if (r = i3[l] - n[l])
                return r;
            return o - a2;
          } }, { key: "_preprocessGeometry", value: function(e) {
            var t2 = e.type;
            e.coordinates = "Point" === t2 ? p2._processPointCoordinates(e.coordinates) : "MultiPoint" === t2 ? e.coordinates.map(p2._processPointCoordinates) : "LineString" === t2 ? p2._processLineStringCoordinates(e.coordinates) : "MultiLineString" === t2 ? e.coordinates.map(p2._processLineStringCoordinates) : "Polygon" === t2 ? e.coordinates.map(p2._processPolygonCoordinates) : "MultiPolygon" === t2 ? e.coordinates.map(p2._processMultiPolygonCoordinates) : [];
          } }, { key: "_processPointCoordinates", value: function(e) {
            return [e[1], e[0], e[2]];
          } }, { key: "_processLineStringCoordinates", value: function(e) {
            return p2._latLngAltArrayToLineString(e, false);
          } }, { key: "_processPolygonCoordinates", value: function(e) {
            return p2._latLngAltArrayToLineString(e, true);
          } }, { key: "_processMultiPolygonCoordinates", value: function(e) {
            return e.map(p2._processPolygonCoordinates);
          } }, { key: "_latLngAltArrayToLineString", value: function(e, t2) {
            for (var r = [], i3 = e.length, n = 0; n < i3; n += 3)
              r.push([e[n + 1], e[n]]);
            return t2 && r.push([e[1], e[0]]), r;
          } }]), p2;
        }();
        MapsJsSource.register(ObjectSource, "ObjectSource");
        var GEOMETRY_TYPE = { POLYGON: 1, POLYLINE: 2, OUTLINE: 3 }, IconMap = function() {
          function e() {
            _classCallCheck(this, e), this._map = {};
          }
          return _createClass(e, [{ key: "set", value: function(e2, t2, r) {
            var i2;
            this._map[e2] ? this._map[e2].accumulator.add(r) : ((i2 = /* @__PURE__ */ new Set()).add(r), this._map[e2] = { value: t2, accumulator: i2 });
          } }, { key: "get", value: function(e2) {
            return this._map[e2] && this._map[e2].value;
          } }, { key: "delete", value: function(e2, t2) {
            var r = this._map[e2];
            r && r.accumulator && (r.accumulator.delete(t2), 0 === r.accumulator.size && delete this._map[e2]);
          } }]), e;
        }(), ObjectTileSource = function() {
          _inherits(n, MapsJsSource);
          var i2 = _createSuper(n);
          function n(e, t2) {
            var r;
            return _classCallCheck(this, n), r = i2.call(this, e, t2), Thread.is_worker || (r._icons = new IconMap()), r;
          }
          return _createClass(n, [{ key: "onProviderUpdate", value: function(e) {
            e.target instanceof H.map.provider.Tile ? this.dispatchUpdate(e.target, e.data) : this.dispatchUpdate(void 0, e.data);
          } }, { key: "onReady", value: function() {
            var e = this.provider;
            e.setTileCanvasRendering && e.setTileCanvasRendering(false), e.providesMarkers() && (this._onCacheDrop = this._onCacheDrop.bind(this), e.getCache().registerOnDrop(this._onCacheDrop)), this.dispatchUpdate();
          } }, { key: "dispose", value: function() {
            _get(_getPrototypeOf(n.prototype), "dispose", this).call(this);
            var e = this.provider;
            e.providesMarkers() && e.getCache().deRegisterOnDrop(this._onCacheDrop);
          } }, { key: "_onCacheDrop", value: function(e, t2) {
            this.provider.cacheFilter(e) && this._deleteIcons(e, t2.data);
          } }, { key: "_deleteIcons", value: function(e, t2) {
            for (var r = 0, i3 = t2.length; r < i3; r++) {
              var n2 = t2[r].getIcon();
              this._icons.delete(n2.uid, e);
            }
          } }, { key: "getIconBitmapByObjectId", value: function(e, t2) {
            var r = this._icons.get(t2);
            return r && r.getBitmap();
          } }, { key: "requestMarkerTile", value: function(t2) {
            var s = this;
            return new Promise(function(a2, e) {
              s.provider ? s.provider.requestTileAsPromise(t2.x, t2.y, t2.z, false).then(function(e2) {
                var t3, r, i3 = [];
                if (e2.data)
                  for (r = (t3 = e2.data).length; r--; ) {
                    var n2 = t3[r], o = n2.getIcon();
                    s._icons.set(o.uid, o, e2.key), i3.push(n2.forWorkerMessage());
                  }
                a2(i3);
              }) : a2([]);
            });
          } }, { key: "requestSpatialTile", value: function(t2) {
            var r = this;
            return new Promise(function(o, e) {
              r.provider ? r.provider.requestTileAsPromise(t2.x, t2.y, t2.z, false).then(function(e2) {
                var t3, r2 = [];
                if (e2.getObjects) {
                  t3 = e2.getObjects();
                  for (var i3 = 0; i3 < t3.length; i3++) {
                    var n2 = t3[i3];
                    r2.push({ id: n2.getId(), geometries: n2.getGeometriesForTile(e2), isClosed: n2.isClosed(), style: n2.getStyle().forWorkerMessage() });
                  }
                }
                o(r2);
              }) : o([]);
            });
          } }, { key: "_pointToArray", value: function(e) {
            var t2 = Geo$1.tile_scale / this.tile_size;
            return [e.x * t2, e.y * t2];
          } }, { key: "_getGeoJsonMultiPolygon", value: function(e) {
            for (var t2 = e.geometries, r = t2.length, i3 = [], n2 = { coordinates: i3, type: "MultiPolygon" }, o = 0; o < r; o++) {
              for (var a2 = t2[o], s = a2.paths, l = s.length, u2 = a2.interiorsIndex, c2 = a2.outlinesIndex, h = Math.min(u2, c2, l), f2 = void 0, d = void 0, d = 0; d < h; d++)
                f2 = [s[d].map(this._pointToArray, this)], i3.push(f2);
              if (1 === h)
                for (h = Math.min(c2, l), d = u2; d < h; d++)
                  f2.push(s[d].map(this._pointToArray, this));
            }
            return n2;
          } }, { key: "_getGeoJsonMultiLineString", value: function(e, t2) {
            for (var r = 1 < arguments.length && void 0 !== t2 && t2, i3 = { coordinates: [], type: "MultiLineString" }, n2 = e.geometries, o = 0; o < n2.length; o++)
              for (var a2 = n2[o], s = r ? a2.outlinesIndex : 0, l = r ? a2.paths.length : Math.min(a2.interiorsIndex, a2.outlinesIndex, a2.paths.length), u2 = s; u2 < l; u2++) {
                var c2 = a2.paths[u2].map(this._pointToArray, this);
                i3.coordinates.push(c2);
              }
            return i3;
          } }, { key: "_getGeoJsonGeometry", value: function(e, t2) {
            var r = t2 === GEOMETRY_TYPE.POLYGON ? this._getGeoJsonMultiPolygon(e) : this._getGeoJsonMultiLineString(e, t2 === GEOMETRY_TYPE.OUTLINE);
            return r.coordinates.length ? r : null;
          } }, { key: "_load", value: function(f2) {
            var d = this;
            return new Promise(function(t2, e) {
              var r = WorkerBroker.postMessage(d.target_name + ".requestMarkerTile", f2.coords).then(d._prepareTileData.bind(d, f2)), i3 = new Promise(function(h, e2) {
                WorkerBroker.postMessage(d.target_name + ".requestSpatialTile", f2.coords).then(function(e3) {
                  for (var t3 = [], r2 = [], i4 = [], n2 = 0; n2 < e3.length; n2++) {
                    var o, a2 = e3[n2], s = void 0, l = void 0, l = a2.isClosed ? (s = r2, GEOMETRY_TYPE.POLYGON) : (s = t3, GEOMETRY_TYPE.POLYLINE), u2 = d._getGeoJsonGeometry(a2, l);
                    u2 && (o = { id: a2.id, type: "Feature", properties: { height: 0, style: a2.style }, geometry: u2 }, l === GEOMETRY_TYPE.POLYLINE && (o.properties.effectiveZIdx = t3.length), s.push(o));
                    var c2 = d._getGeoJsonGeometry(a2, GEOMETRY_TYPE.OUTLINE);
                    c2 && i4.push({ id: a2.id, type: "Feature", properties: { height: 0, style: a2.style, effectiveZIdx: i4.length }, geometry: c2 });
                  }
                  f2.source_data.layers.polylines = { type: "FeatureCollection", features: t3 }, f2.source_data.layers.polygons = { type: "FeatureCollection", features: r2 }, f2.source_data.layers.outlines = { type: "FeatureCollection", features: i4 }, h(f2);
                });
              });
              Promise.all([r, i3]).then(function(e2) {
                d._postProcessTile(f2), t2(f2);
              });
            });
          } }, { key: "_prepareTileData", value: function(e, t2) {
            var r = Geo$1.wrapTile(e.coords, { x: true, y: true }), i3 = Geo$1.metersForTile(r);
            e.source_data.layers = { markers: { features: t2, type: "FeatureCollection" } };
            var n2 = { coords: r, min: i3 }, o = e.source_data, a2 = layout("binary-tree"), s = {};
            for (var l in o.layers)
              for (var u2 = o.layers[l].features.length, c2 = 0; c2 < u2; c2++) {
                var h = o.layers[l].features[c2], f2 = h.properties.icon;
                s[f2.id] || (a2.addItem({ width: f2.size.w, height: f2.size.h, meta: { objectId: h.id, id: f2.id } }), s[f2.id] = true), Geo$1.transformGeometry(h.geometry, function(e2) {
                  var t3 = e2[0];
                  e2[0] = e2[1], e2[1] = t3;
                });
              }
            return e.rasters = a2.export(), MapsJsSource.projectData(e.source_data), MapsJsSource.scaleData(e.source_data, n2), e;
          } }]), n;
        }();
        MapsJsSource.register(ObjectTileSource, "ObjectTileSource");
        var RemoteRasterTileSource = function() {
          _inherits(n, RasterTileSource);
          var i2 = _createSuper(n);
          function n(e, t2) {
            var r;
            return _classCallCheck(this, n), (r = i2.call(this, e, t2)).uid_ = e.uid, r;
          }
          return _createClass(n, [{ key: "initialize", value: function(e, t2) {
            this.provider = e, this._on_update = t2, this._onProviderUpdate = this._onProviderUpdate.bind(this), e.addEventListener("update", this._onProviderUpdate);
          } }, { key: "_onProviderUpdate", value: function() {
            this._on_update(this.name);
          } }, { key: "tileTexture", value: function(e) {
            return Object.assign(_get(_getPrototypeOf(n.prototype), "tileTexture", this).call(this, e), { uid: this.uid_, url: this.uid_ + "_" + e.coords.key, coords: e.coords });
          } }, { key: "dispose", value: function() {
            this.provider.removeEventListener("update", this._onProviderUpdate);
          } }]), n;
        }();
        function geojsonvt(e, t2) {
          return new GeoJSONVT(e, t2);
        }
        function GeoJSONVT(e, t2) {
          var r = (t2 = this.options = extend(Object.create(this.options), t2)).debug;
          if (r && console.time("preprocess data"), t2.maxZoom < 0 || 24 < t2.maxZoom)
            throw new Error("maxZoom should be in the 0-24 range");
          if (t2.promoteId && t2.generateId)
            throw new Error("promoteId and generateId cannot be used together.");
          var i2 = convert(e, t2);
          this.tiles = {}, this.tileCoords = [], r && (console.timeEnd("preprocess data"), console.log("index: maxZoom: %d, maxPoints: %d", t2.indexMaxZoom, t2.indexMaxPoints), console.time("generate tiles"), this.stats = {}, this.total = 0), (i2 = wrap(i2, t2)).length && this.splitTile(i2, 0, 0, 0), r && (i2.length && console.log("features: %d, points: %d", this.tiles[0].numFeatures, this.tiles[0].numPoints), console.timeEnd("generate tiles"), console.log("tiles generated:", this.total, JSON.stringify(this.stats)));
        }
        function toID(e, t2, r) {
          return 32 * ((1 << e) * r + t2) + e;
        }
        function extend(e, t2) {
          for (var r in t2)
            e[r] = t2[r];
          return e;
        }
        DataSource.register(RemoteRasterTileSource, "RemoteRasterTileSource"), GeoJSONVT.prototype.options = { maxZoom: 14, indexMaxZoom: 5, indexMaxPoints: 1e5, tolerance: 3, extent: 4096, buffer: 64, lineMetrics: false, promoteId: null, generateId: false, debug: 0 }, GeoJSONVT.prototype.splitTile = function(e, t2, r, i2, n, o, a2) {
          for (var s = [e, t2, r, i2], l = this.options, u2 = l.debug; s.length; ) {
            i2 = s.pop(), r = s.pop(), t2 = s.pop(), e = s.pop();
            var c2, h, f2, d, _, p2, g, m, y, v, x2, b2 = 1 << t2, T2 = toID(t2, r, i2), A2 = this.tiles[T2];
            if (A2 || (1 < u2 && console.time("creation"), A2 = this.tiles[T2] = createTile(e, t2, r, i2, l), this.tileCoords.push({ z: t2, x: r, y: i2 }), u2 && (1 < u2 && (console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)", t2, r, i2, A2.numFeatures, A2.numPoints, A2.numSimplified), console.timeEnd("creation")), c2 = "z" + t2, this.stats[c2] = (this.stats[c2] || 0) + 1, this.total++)), A2.source = e, n) {
              if (t2 === l.maxZoom || t2 === n)
                continue;
              var E2 = 1 << n - t2;
              if (r !== Math.floor(o / E2) || i2 !== Math.floor(a2 / E2))
                continue;
            } else if (t2 === l.indexMaxZoom || A2.numPoints <= l.indexMaxPoints)
              continue;
            A2.source = null, 0 !== e.length && (1 < u2 && console.time("clipping"), f2 = 0.5 - (h = 0.5 * l.buffer / l.extent), _ = 1 + h, y = p2 = g = m = null, v = clip(e, b2, r - h, r + (d = 0.5 + h), 0, A2.minX, A2.maxX, l), x2 = clip(e, b2, r + f2, r + _, 0, A2.minX, A2.maxX, l), e = null, v && (y = clip(v, b2, i2 - h, i2 + d, 1, A2.minY, A2.maxY, l), p2 = clip(v, b2, i2 + f2, i2 + _, 1, A2.minY, A2.maxY, l), v = null), x2 && (g = clip(x2, b2, i2 - h, i2 + d, 1, A2.minY, A2.maxY, l), m = clip(x2, b2, i2 + f2, i2 + _, 1, A2.minY, A2.maxY, l), x2 = null), 1 < u2 && console.timeEnd("clipping"), s.push(y || [], t2 + 1, 2 * r, 2 * i2), s.push(p2 || [], t2 + 1, 2 * r, 2 * i2 + 1), s.push(g || [], t2 + 1, 2 * r + 1, 2 * i2), s.push(m || [], t2 + 1, 2 * r + 1, 2 * i2 + 1));
          }
        }, GeoJSONVT.prototype.getTile = function(e, t2, r) {
          var i2 = this.options, n = i2.extent, o = i2.debug;
          if (e < 0 || 24 < e)
            return null;
          var a2 = 1 << e, s = toID(e, t2 = (t2 % a2 + a2) % a2, r);
          if (this.tiles[s])
            return transformTile(this.tiles[s], n);
          1 < o && console.log("drilling down to z%d-%d-%d", e, t2, r);
          for (var l, u2 = e, c2 = t2, h = r; !l && 0 < u2; )
            u2--, c2 = Math.floor(c2 / 2), h = Math.floor(h / 2), l = this.tiles[toID(u2, c2, h)];
          return l && l.source ? (1 < o && console.log("found parent tile z%d-%d-%d", u2, c2, h), 1 < o && console.time("drilling down"), this.splitTile(l.source, u2, c2, h, e, t2, r), 1 < o && console.timeEnd("drilling down"), this.tiles[s] ? transformTile(this.tiles[s], n) : null) : null;
        };
        var EMPTY_FEATURE_COLLECTION$1 = { type: "FeatureCollection", features: [] }, GeoJSONTileSource = function() {
          _inherits(i2, MapsJsSource);
          var r = _createSuper(i2);
          function i2(e, t2) {
            return _classCallCheck(this, i2), e.tiled = true, e.url = "", r.call(this, e, t2);
          }
          return _createClass(i2, [{ key: "fetchTile", value: function(e, t2, r2) {
            return this.provider ? this.provider.requestTileAsPromise(e, t2, r2).then(function(e2) {
              return e2.data;
            }) : Promise.resolve(EMPTY_FEATURE_COLLECTION$1);
          } }, { key: "_load", value: function(i3) {
            var n = this, o = Geo$1.wrapTile(i3.coords, { x: true, y: true }), a2 = { indexMaxZoom: 0, maxZoom: this.max_zoom, tolerance: 1.5, extent: Geo$1.tile_scale };
            return WorkerBroker.postMessage(this.target_name + ".fetchTile", o.x, o.y, o.z).then(function(e) {
              for (var t2 in i3.source_data.layers = "FeatureCollection" === e.type ? { _default: e } : e, i3.source_data.layers) {
                var r2 = geojsonvt(i3.source_data.layers[t2], a2).getTile(o.z, o.x, o.y);
                i3.source_data.layers[t2] = parseGeoJSONVectorTile(r2);
              }
              return n._postProcessTile(i3), i3;
            });
          } }, { key: "onReady", value: function() {
            this.dispatchUpdate();
          } }]), i2;
        }();
        DataSource.register(GeoJSONTileSource, "GeoJSONTileSource");
        var DEFAULT_RESPONSE = { layers: { _default: { type: "FeatureCollection", features: [{ type: "Point", geometry: {} }] } } }, SkyBoxSource = function() {
          _inherits(i2, DataSource);
          var r = _createSuper(i2);
          function i2(e, t2) {
            return _classCallCheck(this, i2), e.max_zoom = 0, r.call(this, e, t2);
          }
          return _createClass(i2, [{ key: "load", value: function(e) {
            return e.source_data = "0/0/0" === e.coords.key ? DEFAULT_RESPONSE : void 0, Promise.resolve(e);
          } }]), i2;
        }(), debugSettings;
        DataSource.register(SkyBoxSource, "SkyBox");
        var debugSettings$1 = debugSettings = { draw_label_collision_boxes: false, draw_label_texture_boxes: false, suppress_label_fade_in: false, suppress_snap_animation: false, show_hidden_labels: false, layer_stats: false };
        function mergeDebugSettings(e) {
          Object.assign(debugSettings, e);
        }
        var WorkerType = { NATIVE: 0, FAKE: 1 }, Context;
        function sliceObject(t2, e) {
          var r = {};
          return e.forEach(function(e2) {
            return r[e2] = t2[e2];
          }), r;
        }
        var Context$1 = Context = {}, context_id = 0, gl;
        Context.getContext = function(e, t2) {
          var r = false;
          null == e && ((e = document.createElement("canvas")).style.position = "absolute", e.style.top = 0, e.style.left = 0, e.style.zIndex = -1, document.body.appendChild(e), r = true);
          var i2 = e.getContext("webgl", t2) || e.getContext("experimental-webgl", t2);
          if (!i2)
            throw new Error("Couldn't create WebGL context.");
          return i2._tangram_id = context_id++, r ? (Context.resize(i2, window.innerWidth, window.innerHeight, t2.device_pixel_ratio), window.addEventListener("resize", function() {
            Context.resize(i2, window.innerWidth, window.innerHeight, t2.device_pixel_ratio);
          })) : Context.resize(i2, parseFloat(e.style.width), parseFloat(e.style.height), t2.device_pixel_ratio), i2;
        }, Context.resize = function(e, t2, r, i2) {
          e.canvas.style.width = t2 + "px", e.canvas.style.height = r + "px", e.canvas.width = Math.round(t2 * i2), e.canvas.height = Math.round(r * i2), e.bindFramebuffer(e.FRAMEBUFFER, null), e.viewport(0, 0, e.canvas.width, e.canvas.height);
        };
        var gl$1 = gl = {};
        gl.BYTE = 5120, gl.UNSIGNED_BYTE = 5121, gl.SHORT = 5122, gl.UNSIGNED_SHORT = 5123, gl.INT = 5124, gl.UNSIGNED_INT = 5125, gl.FLOAT = 5126;
        var MAX_VALUE$1 = Math.pow(2, 16) - 1, DEFAULT_SIZE = 1024, HAS_ELEMENT_INDEX_UINT = false, VertexElements = function() {
          function t2(e) {
            _classCallCheck(this, t2), this.size_ = e || DEFAULT_SIZE, this.position_ = 0, this.ArrayType_ = Uint16Array, this.buffer_ = new this.ArrayType_(this.size_), this.overflows_ = false;
          }
          return _createClass(t2, [{ key: "push", value: function(e) {
            if (!this.overflows_ || HAS_ELEMENT_INDEX_UINT) {
              if (MAX_VALUE$1 < e) {
                if (this.overflows_ = true, !HAS_ELEMENT_INDEX_UINT)
                  return;
                this.ArrayType_ === Uint16Array && (this.ArrayType_ = Uint32Array, this.buffer_ = new this.ArrayType_(this.buffer_));
              }
              this.position_ === this.size_ && this.expand_(), this.buffer_[this.position_] = e, this.position_ += 1;
            }
          } }, { key: "end", value: function() {
            if (0 === this.position_)
              return false;
            var e = this.buffer_, t3 = this.position_;
            return this.buffer_ = new this.ArrayType_(this.size_), this.position_ = 0, this.overflows_ = false, e.subarray(0, t3);
          } }, { key: "expand_", value: function() {
            this.size_ = this.size_ << 1;
            var e = new this.ArrayType_(this.size_);
            e.set(this.buffer_), this.buffer_ = e;
          } }]), t2;
        }(), _array_types;
        VertexElements.setElementIndexUint = function(e) {
          HAS_ELEMENT_INDEX_UINT = e;
        };
        var array_types = (_array_types = {}, _defineProperty(_array_types, gl$1.FLOAT, Float32Array), _defineProperty(_array_types, gl$1.BYTE, Int8Array), _defineProperty(_array_types, gl$1.UNSIGNED_BYTE, Uint8Array), _defineProperty(_array_types, gl$1.INT, Int32Array), _defineProperty(_array_types, gl$1.UNSIGNED_INT, Uint32Array), _defineProperty(_array_types, gl$1.SHORT, Int16Array), _defineProperty(_array_types, gl$1.UNSIGNED_SHORT, Uint16Array), _array_types), VertexData = function() {
          function i2(e) {
            var t2 = (1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {}).prealloc, r = void 0 === t2 ? 500 : t2;
            _classCallCheck(this, i2), this.vertex_layout = e, this.vertex_elements = new VertexElements(), this.stride = this.vertex_layout.stride, 0 < i2.array_pool.length ? (this.vertex_buffer = i2.array_pool.pop(), this.byte_length = this.vertex_buffer.byteLength, this.size = Math.floor(this.byte_length / this.stride), log("trace", "VertexData: reused buffer of bytes ".concat(this.byte_length, ", ").concat(this.size, " vertices"))) : (this.size = r, this.byte_length = this.stride * this.size, this.vertex_buffer = new Uint8Array(this.byte_length)), this.offset = 0, this.vertex_count = 0, this.realloc_count = 0, this.setBufferViews(), this.setAddVertexFunction();
          }
          return _createClass(i2, [{ key: "setBufferViews", value: function() {
            var r = this;
            this.views = {}, this.views[gl$1.UNSIGNED_BYTE] = this.vertex_buffer, this.vertex_layout.dynamic_attribs.forEach(function(e) {
              var t2;
              null == r.views[e.type] && (t2 = array_types[e.type], r.views[e.type] = new t2(r.vertex_buffer.buffer));
            });
          } }, { key: "checkBufferSize", value: function() {
            var e;
            this.offset + this.stride > this.byte_length && (this.size = Math.floor(1.5 * this.size), this.size -= this.size % 4, this.byte_length = this.stride * this.size, (e = new Uint8Array(this.byte_length)).set(this.vertex_buffer), i2.array_pool.push(this.vertex_buffer), this.vertex_buffer = e, this.setBufferViews(), this.realloc_count++);
          } }, { key: "setAddVertexFunction", value: function() {
            this.vertexLayoutAddVertex = this.vertex_layout.getAddVertexFunction();
          } }, { key: "addVertex", value: function(e) {
            this.checkBufferSize(), this.vertexLayoutAddVertex(e, this.views, this.offset), this.offset += this.stride, this.vertex_count++;
          } }, { key: "end", value: function() {
            return this.vertex_buffer = this.vertex_buffer.subarray(0, this.offset), this.element_buffer = this.vertex_elements.end(), log("trace", "VertexData: ".concat(this.size, " vertices total, realloc count ").concat(this.realloc_count)), this;
          } }]), i2;
        }();
        VertexData.array_pool = [];
        var VertexLayout = function() {
          function l(e) {
            _classCallCheck(this, l), this.attribs = e, this.dynamic_attribs = this.attribs.filter(function(e2) {
              return !e2.static;
            }), this.components = [], this.index = {}, this.offset = {};
            for (var t2 = this.stride = 0, r = 0, i2 = 0; i2 < this.attribs.length; i2++) {
              var n = this.attribs[i2];
              if (null == n.static) {
                n.offset = this.stride, n.byte_size = n.size;
                var o = 0;
                switch (n.type) {
                  case gl$1.FLOAT:
                  case gl$1.INT:
                  case gl$1.UNSIGNED_INT:
                    n.byte_size *= 4, o = 2;
                    break;
                  case gl$1.SHORT:
                  case gl$1.UNSIGNED_SHORT:
                    n.byte_size *= 2, o = 1;
                }
                3 & n.byte_size && (n.byte_size += 4 - (3 & n.byte_size)), this.stride += n.byte_size;
                for (var a2 = n.offset >> o, s = 0; s < n.size; s++)
                  this.components.push({ type: n.type, shift: o, offset: a2++, index: r++ });
                this.index[n.name] = t2, t2 += n.size, this.offset[n.name] = n.offset;
              } else
                n.static = Array.isArray(n.static) ? n.static : [n.static], n.method = "vertexAttrib".concat(n.static.length, "fv");
            }
          }
          return _createClass(l, [{ key: "enable", value: function(e, t2, r) {
            for (var i2, n, o = 0; o < this.attribs.length; o++)
              i2 = this.attribs[o], -1 !== (n = t2.attribute(i2.name).location) && (null == i2.static ? (l.enabled_attribs[n] && !r || e.enableVertexAttribArray(n), e.vertexAttribPointer(n, i2.size, i2.type, i2.normalized, this.stride, i2.offset), l.enabled_attribs[n] = t2) : e[i2.method] instanceof Function && (e.enableVertexAttribArray(n), e[i2.method](n, i2.static), e.disableVertexAttribArray(n), delete l.enabled_attribs[n]));
            for (n in l.enabled_attribs)
              this.disableUnusedAttribute(e, n, t2);
          } }, { key: "disableUnusedAttribute", value: function(e, t2, r) {
            l.enabled_attribs[t2] !== r && (e.disableVertexAttribArray(t2), delete l.enabled_attribs[t2]);
          } }, { key: "createVertexData", value: function() {
            return new VertexData(this);
          } }, { key: "getAddVertexFunction", value: function() {
            return null == this.addVertex && this.createAddVertexFunction(), this.addVertex;
          } }, { key: "createAddVertexFunction", value: function() {
            var e = hashString(JSON.stringify(this.attribs));
            if (null == l.add_vertex_funcs[e]) {
              var t2, r = ["var t, o;"], i2 = _toConsumableArray(this.components);
              i2.sort(function(e2, t3) {
                return e2.type !== t3.type ? e2.type - t3.type : e2.index - t3.index;
              });
              for (var n = 0; n < i2.length; n++) {
                var o = i2[n];
                t2 !== o.type && (r.push("t = vs[".concat(o.type, "];")), r.push("o = off".concat(o.shift ? " >> " + o.shift : "", ";")), t2 = o.type), r.push("t[o + ".concat(o.offset, "] = v[").concat(o.index, "];"));
              }
              r = r.join("\n");
              var a2 = new Function("v", "vs", "off", r);
              l.add_vertex_funcs[e] = a2;
            }
            this.addVertex = l.add_vertex_funcs[e];
          } }]), l;
        }();
        VertexLayout.enabled_attribs = {}, VertexLayout.add_vertex_funcs = {};
        var tile_bounds = [{ x: 0, y: 0 }, { x: Geo$1.tile_scale, y: -Geo$1.tile_scale }], default_uvs = [0, 0, 1, 1];
        function outsideTile(e, t2, r) {
          var i2 = tile_bounds[0], n = tile_bounds[1];
          return e[0] <= i2.x + r && t2[0] <= i2.x + r || e[0] >= n.x - r && t2[0] >= n.x - r || e[1] >= i2.y - r && t2[1] >= i2.y - r || e[1] <= n.y + r && t2[1] <= n.y + r;
        }
        function isCoordOutsideTile(e, t2) {
          t2 = t2 || 0;
          var r = tile_bounds[0], i2 = tile_bounds[1];
          return e[0] <= r.x + t2 || e[0] >= i2.x - t2 || e[1] >= r.y - t2 || e[1] <= i2.y + t2;
        }
        var earcut_1 = earcut;
        function earcut(e, t2, r) {
          r = r || 2;
          var i2, n, o, a2, s, l, u2, c2 = t2 && t2.length, h = c2 ? t2[0] * r : e.length, f2 = linkedList(e, 0, h, r, true), d = [];
          if (!f2)
            return d;
          if (c2 && (f2 = eliminateHoles(e, t2, f2, r)), e.length > 80 * r) {
            i2 = o = e[0], n = a2 = e[1];
            for (var _ = r; _ < h; _ += r)
              (s = e[_]) < i2 && (i2 = s), (l = e[_ + 1]) < n && (n = l), o < s && (o = s), a2 < l && (a2 = l);
            u2 = Math.max(o - i2, a2 - n);
          }
          return earcutLinked(f2, d, r, i2, n, u2), d;
        }
        function linkedList(e, t2, r, i2, n) {
          var o, a2;
          if (n === 0 < signedArea$1(e, t2, r, i2))
            for (o = t2; o < r; o += i2)
              a2 = insertNode(o, e[o], e[o + 1], a2);
          else
            for (o = r - i2; t2 <= o; o -= i2)
              a2 = insertNode(o, e[o], e[o + 1], a2);
          return a2 && equals(a2, a2.next) && (removeNode(a2), a2 = a2.next), a2;
        }
        function filterPoints(e, t2) {
          if (!e)
            return e;
          t2 = t2 || e;
          var r, i2 = e;
          do {
            if (r = false, i2.steiner || !equals(i2, i2.next) && 0 !== area(i2.prev, i2, i2.next))
              i2 = i2.next;
            else {
              if (removeNode(i2), (i2 = t2 = i2.prev) === i2.next)
                return null;
              r = true;
            }
          } while (r || i2 !== t2);
          return t2;
        }
        function earcutLinked(e, t2, r, i2, n, o, a2) {
          if (e) {
            !a2 && o && indexCurve(e, i2, n, o);
            for (var s, l, u2 = e; e.prev !== e.next; )
              if (s = e.prev, l = e.next, o ? isEarHashed(e, i2, n, o) : isEar(e))
                t2.push(s.i / r), t2.push(e.i / r), t2.push(l.i / r), removeNode(e), e = l.next, u2 = l.next;
              else if ((e = l) === u2) {
                a2 ? 1 === a2 ? earcutLinked(e = cureLocalIntersections(e, t2, r), t2, r, i2, n, o, 2) : 2 === a2 && splitEarcut(e, t2, r, i2, n, o) : earcutLinked(filterPoints(e), t2, r, i2, n, o, 1);
                break;
              }
          }
        }
        function isEar(e) {
          var t2 = e.prev, r = e, i2 = e.next;
          if (!(0 <= area(t2, r, i2))) {
            for (var n = e.next.next; n !== e.prev; ) {
              if (pointInTriangle(t2.x, t2.y, r.x, r.y, i2.x, i2.y, n.x, n.y) && 0 <= area(n.prev, n, n.next))
                return;
              n = n.next;
            }
            return 1;
          }
        }
        function isEarHashed(e, t2, r, i2) {
          var n = e.prev, o = e, a2 = e.next;
          if (!(0 <= area(n, o, a2))) {
            for (var s = n.x < o.x ? n.x < a2.x ? n.x : a2.x : o.x < a2.x ? o.x : a2.x, l = n.y < o.y ? n.y < a2.y ? n.y : a2.y : o.y < a2.y ? o.y : a2.y, u2 = n.x > o.x ? n.x > a2.x ? n.x : a2.x : o.x > a2.x ? o.x : a2.x, c2 = n.y > o.y ? n.y > a2.y ? n.y : a2.y : o.y > a2.y ? o.y : a2.y, h = zOrder(s, l, t2, r, i2), f2 = zOrder(u2, c2, t2, r, i2), d = e.nextZ; d && d.z <= f2; ) {
              if (d !== e.prev && d !== e.next && pointInTriangle(n.x, n.y, o.x, o.y, a2.x, a2.y, d.x, d.y) && 0 <= area(d.prev, d, d.next))
                return;
              d = d.nextZ;
            }
            for (d = e.prevZ; d && d.z >= h; ) {
              if (d !== e.prev && d !== e.next && pointInTriangle(n.x, n.y, o.x, o.y, a2.x, a2.y, d.x, d.y) && 0 <= area(d.prev, d, d.next))
                return;
              d = d.prevZ;
            }
            return 1;
          }
        }
        function cureLocalIntersections(e, t2, r) {
          var i2 = e;
          do {
            var n = i2.prev, o = i2.next.next;
            !equals(n, o) && intersects(n, i2, i2.next, o) && locallyInside(n, o) && locallyInside(o, n) && (t2.push(n.i / r), t2.push(i2.i / r), t2.push(o.i / r), removeNode(i2), removeNode(i2.next), i2 = e = o), i2 = i2.next;
          } while (i2 !== e);
          return i2;
        }
        function splitEarcut(e, t2, r, i2, n, o) {
          var a2 = e;
          do {
            for (var s = a2.next.next; s !== a2.prev; ) {
              if (a2.i !== s.i && isValidDiagonal(a2, s)) {
                var l = splitPolygon(a2, s), a2 = filterPoints(a2, a2.next), l = filterPoints(l, l.next);
                return earcutLinked(a2, t2, r, i2, n, o), void earcutLinked(l, t2, r, i2, n, o);
              }
              s = s.next;
            }
            a2 = a2.next;
          } while (a2 !== e);
        }
        function eliminateHoles(e, t2, r, i2) {
          for (var n, o = [], a2 = 0, s = t2.length; a2 < s; a2++)
            (n = linkedList(e, t2[a2] * i2, a2 < s - 1 ? t2[a2 + 1] * i2 : e.length, i2, false)) === n.next && (n.steiner = true), o.push(getLeftmost(n));
          for (o.sort(compareX), a2 = 0; a2 < o.length; a2++)
            eliminateHole(o[a2], r), r = filterPoints(r, r.next);
          return r;
        }
        function compareX(e, t2) {
          return e.x - t2.x;
        }
        function eliminateHole(e, t2) {
          var r;
          (t2 = findHoleBridge(e, t2)) && filterPoints(r = splitPolygon(t2, e), r.next);
        }
        function findHoleBridge(e, t2) {
          var r, i2 = t2, n = e.x, o = e.y, a2 = -1 / 0;
          do {
            if (o <= i2.y && o >= i2.next.y) {
              var s = i2.x + (o - i2.y) * (i2.next.x - i2.x) / (i2.next.y - i2.y);
              if (s <= n && a2 < s) {
                if ((a2 = s) === n) {
                  if (o === i2.y)
                    return i2;
                  if (o === i2.next.y)
                    return i2.next;
                }
                r = i2.x < i2.next.x ? i2 : i2.next;
              }
            }
            i2 = i2.next;
          } while (i2 !== t2);
          if (!r)
            return null;
          if (n === a2)
            return r.prev;
          for (var l, u2 = r, c2 = r.x, h = r.y, f2 = 1 / 0, i2 = r.next; i2 !== u2; )
            n >= i2.x && i2.x >= c2 && pointInTriangle(o < h ? n : a2, o, c2, h, o < h ? a2 : n, o, i2.x, i2.y) && ((l = Math.abs(o - i2.y) / (n - i2.x)) < f2 || l === f2 && i2.x > r.x) && locallyInside(i2, e) && (r = i2, f2 = l), i2 = i2.next;
          return r;
        }
        function indexCurve(e, t2, r, i2) {
          for (var n = e; null === n.z && (n.z = zOrder(n.x, n.y, t2, r, i2)), n.prevZ = n.prev, n.nextZ = n.next, (n = n.next) !== e; )
            ;
          n.prevZ.nextZ = null, n.prevZ = null, sortLinked(n);
        }
        function sortLinked(e) {
          var t2, r, i2, n, o, a2, s, l, u2 = 1;
          do {
            for (r = e, o = e = null, a2 = 0; r; ) {
              for (a2++, i2 = r, t2 = s = 0; t2 < u2 && (s++, i2 = i2.nextZ); t2++)
                ;
              for (l = u2; 0 < s || 0 < l && i2; )
                0 !== s && (0 === l || !i2 || r.z <= i2.z) ? (r = (n = r).nextZ, s--) : (i2 = (n = i2).nextZ, l--), o ? o.nextZ = n : e = n, n.prevZ = o, o = n;
              r = i2;
            }
            o.nextZ = null, u2 *= 2;
          } while (1 < a2);
          return e;
        }
        function zOrder(e, t2, r, i2, n) {
          return (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - r) / n) | e << 8)) | e << 4)) | e << 2)) | e << 1)) | (t2 = 1431655765 & ((t2 = 858993459 & ((t2 = 252645135 & ((t2 = 16711935 & ((t2 = 32767 * (t2 - i2) / n) | t2 << 8)) | t2 << 4)) | t2 << 2)) | t2 << 1)) << 1;
        }
        function getLeftmost(e) {
          for (var t2 = e, r = e; t2.x < r.x && (r = t2), (t2 = t2.next) !== e; )
            ;
          return r;
        }
        function pointInTriangle(e, t2, r, i2, n, o, a2, s) {
          return 0 <= (n - a2) * (t2 - s) - (e - a2) * (o - s) && 0 <= (e - a2) * (i2 - s) - (r - a2) * (t2 - s) && 0 <= (r - a2) * (o - s) - (n - a2) * (i2 - s);
        }
        function isValidDiagonal(e, t2) {
          return e.next.i !== t2.i && e.prev.i !== t2.i && !intersectsPolygon(e, t2) && locallyInside(e, t2) && locallyInside(t2, e) && middleInside(e, t2);
        }
        function area(e, t2, r) {
          return (t2.y - e.y) * (r.x - t2.x) - (t2.x - e.x) * (r.y - t2.y);
        }
        function equals(e, t2) {
          return e.x === t2.x && e.y === t2.y;
        }
        function intersects(e, t2, r, i2) {
          return equals(e, t2) && equals(r, i2) || equals(e, i2) && equals(r, t2) || 0 < area(e, t2, r) != 0 < area(e, t2, i2) && 0 < area(r, i2, e) != 0 < area(r, i2, t2);
        }
        function intersectsPolygon(e, t2) {
          var r = e;
          do {
            if (r.i !== e.i && r.next.i !== e.i && r.i !== t2.i && r.next.i !== t2.i && intersects(r, r.next, e, t2))
              return 1;
            r = r.next;
          } while (r !== e);
        }
        function locallyInside(e, t2) {
          return area(e.prev, e, e.next) < 0 ? 0 <= area(e, t2, e.next) && 0 <= area(e, e.prev, t2) : area(e, t2, e.prev) < 0 || area(e, e.next, t2) < 0;
        }
        function middleInside(e, t2) {
          for (var r = e, i2 = false, n = (e.x + t2.x) / 2, o = (e.y + t2.y) / 2; r.y > o != r.next.y > o && n < (r.next.x - r.x) * (o - r.y) / (r.next.y - r.y) + r.x && (i2 = !i2), (r = r.next) !== e; )
            ;
          return i2;
        }
        function splitPolygon(e, t2) {
          var r = new Node(e.i, e.x, e.y), i2 = new Node(t2.i, t2.x, t2.y), n = e.next, o = t2.prev;
          return (e.next = t2).prev = e, (r.next = n).prev = r, (i2.next = r).prev = i2, (o.next = i2).prev = o, i2;
        }
        function insertNode(e, t2, r, i2) {
          var n = new Node(e, t2, r);
          return i2 ? (n.next = i2.next, (n.prev = i2).next.prev = n, i2.next = n) : (n.prev = n).next = n, n;
        }
        function removeNode(e) {
          e.next.prev = e.prev, e.prev.next = e.next, e.prevZ && (e.prevZ.nextZ = e.nextZ), e.nextZ && (e.nextZ.prevZ = e.prevZ);
        }
        function Node(e, t2, r) {
          this.i = e, this.x = t2, this.y = r, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = false;
        }
        function signedArea$1(e, t2, r, i2) {
          for (var n = 0, o = t2, a2 = r - i2; o < r; o += i2)
            n += (e[a2] - e[o]) * (e[o + 1] + e[a2 + 1]), a2 = o;
          return n;
        }
        earcut.deviation = function(e, t2, r, i2) {
          var n = t2 && t2.length, o = n ? t2[0] * r : e.length, a2 = Math.abs(signedArea$1(e, 0, o, r));
          if (n)
            for (var s = 0, l = t2.length; s < l; s++) {
              var u2 = t2[s] * r, c2 = s < l - 1 ? t2[s + 1] * r : e.length;
              a2 -= Math.abs(signedArea$1(e, u2, c2, r));
            }
          for (var h = 0, s = 0; s < i2.length; s += 3) {
            var f2 = i2[s] * r, d = i2[s + 1] * r, _ = i2[s + 2] * r;
            h += Math.abs((e[f2] - e[_]) * (e[1 + d] - e[1 + f2]) - (e[f2] - e[d]) * (e[1 + _] - e[1 + f2]));
          }
          return 0 === a2 && 0 === h ? 0 : Math.abs((h - a2) / a2);
        }, earcut.flatten = function(e) {
          for (var t2 = e[0][0].length, r = { vertices: [], holes: [], dimensions: t2 }, i2 = 0, n = 0; n < e.length; n++) {
            for (var o = 0; o < e[n].length; o++)
              for (var a2 = 0; a2 < t2; a2++)
                r.vertices.push(e[n][o][a2]);
            0 < n && (i2 += e[n - 1].length, r.holes.push(i2));
          }
          return r;
        };
        var up_vec3 = [0, 0, 1];
        function buildPolygons(e, t2, r, i2) {
          var n, o, a2, s, l, u2 = i2.texcoord_index, c2 = i2.texcoord_scale, h = i2.texcoord_normalize, f2 = t2.vertex_elements;
          u2 && (h = h || 1, o = (n = _slicedToArray(c2 || default_uvs, 4))[0], a2 = n[1], s = n[2], l = n[3]);
          for (var d = 0, _ = e.length, p2 = 0; p2 < _; p2++) {
            var g, m, y, v, x2, b2 = t2.vertex_count, T2 = e[p2];
            u2 && (m = (g = _slicedToArray(Geo$1.findBoundingBox(T2), 4))[0], y = g[1], v = (s - o) / (g[2] - m), x2 = (l - a2) / (g[3] - y));
            for (var A2 = 0; A2 < T2.length; A2++)
              for (var E2 = T2[A2], w = 0; w < E2.length; w++) {
                var S2 = E2[w];
                r[0] = S2[0], r[1] = S2[1], u2 && (r[u2 + 0] = ((S2[0] - m) * v + o) * h, r[u2 + 1] = ((S2[1] - y) * x2 + a2) * h), t2.addVertex(r);
              }
            for (var k = triangulatePolygon(earcut_1.flatten(T2)), P2 = 0; P2 < k.length; P2++)
              f2.push(b2 + k[P2]);
            d += k.length / 3;
          }
          return d;
        }
        function buildExtrudedPolygons(e, t2, r, i2, n, o, a2, s, l) {
          var u2 = l.remove_tile_edges, c2 = l.tile_edge_tolerance, h = l.texcoord_index, f2 = l.texcoord_scale, d = l.texcoord_normalize, _ = l.winding, p2 = t2 + (i2 || 0), g = t2 + r;
          o[2] = g;
          var m, y, v, x2, b2, T2, A2 = buildPolygons(e, n, o, { texcoord_index: h, texcoord_scale: f2, texcoord_normalize: d }), E2 = n.vertex_elements, w = n.vertex_count;
          h && (d = d || 1, y = (m = _slicedToArray(f2 || default_uvs, 4))[0], v = m[1], x2 = m[2], T2 = [[y, b2 = m[3]], [y, v], [x2, v], [x2, b2]]);
          for (var S2 = e.length, k = 0; k < S2; k++)
            for (var P2 = e[k], R2 = 0; R2 < P2.length; R2++)
              for (var M2 = P2[R2], L2 = 0; L2 < M2.length - 1; L2++)
                if (!u2 || !outsideTile(M2[L2], M2[L2 + 1], c2)) {
                  var O2 = void 0, C2 = void 0, N2 = [[M2[C2 = "CCW" === _ ? (O2 = L2) + 1 : (O2 = L2 + 1, L2)][0], M2[C2][1], g], [M2[C2][0], M2[C2][1], p2], [M2[O2][0], M2[O2][1], p2], [M2[O2][0], M2[O2][1], g]], I = Vector$1.normalize([M2[C2][0] - M2[O2][0], M2[C2][1] - M2[O2][1], 0]), B2 = Vector$1.cross(up_vec3, I);
                  o[a2 + 0] = B2[0] * s, o[a2 + 1] = B2[1] * s, o[a2 + 2] = B2[2] * s;
                  for (var z2 = 0; z2 < N2.length; z2++)
                    o[0] = N2[z2][0], o[1] = N2[z2][1], o[2] = N2[z2][2], h && (o[h + 0] = T2[z2][0] * d, o[h + 1] = T2[z2][1] * d), n.addVertex(o);
                  E2.push(w + 0), E2.push(w + 1), E2.push(w + 2), E2.push(w + 2), E2.push(w + 3), E2.push(w + 0), w += 4, A2 += 2;
                }
          return A2;
        }
        function triangulatePolygon(e) {
          return earcut_1(e.vertices, e.holes, e.dimensions);
        }
        var shaderSrc_polygonsVertex = "uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;attribute vec4 a_position;attribute vec4 a_color;\n#ifdef TANGRAM_NORMAL_ATTRIBUTE\nattribute vec3 a_normal;\n#define TANGRAM_NORMAL a_normal\n#else\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nattribute vec2 a_extrude;attribute vec2 a_offset;attribute vec2 a_scaling;uniform float u_v_scale_adjust;\n#endif\nvarying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nattribute vec2 a_texcoord;varying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvoid main(){\n#pragma tangram: setup\n#ifdef TANGRAM_TEXTURE_COORDS\nv_texcoord=a_texcoord;\n#ifdef TANGRAM_EXTRUDE_LINES\nv_texcoord.y*=u_v_scale_adjust;\n#endif\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nvec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.);\n#ifdef TANGRAM_EXTRUDE_LINES\nvec2 extrude=a_extrude.xy;vec2 offset=a_offset.xy;float dz=clamp(u_map_position.z-u_tile_origin.z,0.,4.);dz+=step(1.,dz)*(1.-dz)+mix(0.,2.,clamp((dz-2.)/2.,0.,1.));float mdz=(dz-0.5)*2.;extrude-=extrude*UNPACK_SCALING(a_scaling.x)*mdz;float dwdz=UNPACK_SCALING(a_scaling.y);float sdwdz=sign(step(0.,dwdz)-0.5);offset-=offset*abs(dwdz)*((1.-step(0.,sdwdz))-(dz*-sdwdz));float ssz=exp2(-dz-(u_tile_origin.z-u_tile_origin.w));extrude*=ssz;offset*=ssz;\n#ifdef TANGRAM_BLOCK_WIDTH\nfloat width=1.;\n#pragma tangram: width\nextrude*=width;\n#endif\nposition.xy+=extrude+offset;\n#endif\nv_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);v_color=a_color;\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#if defined(SNAP_TO_PIXEL_GRID)\nsnapToPixelGrid(position);\n#endif\ngl_Position=position;}", shaderSrc_polygonsFragment = "uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_EXTRUDE_LINES\nuniform bool u_has_line_texture;uniform sampler2D u_texture;uniform float u_texture_ratio;uniform vec4 u_dash_background_color;\n#endif\n#define TANGRAM_NORMAL v_normal\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nvarying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#pragma tangram: utils\nvoid main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_COLOR\ncolor*=sampleRaster();\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nif(u_has_line_texture){vec2 _line_st=vec2(v_texcoord.x,fract(v_texcoord.y/u_texture_ratio));vec4 _line_color=texture2D(u_texture,_line_st);if(_line_color.a<TANGRAM_ALPHA_TEST){\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY)\nif(u_dash_background_color.a==0.){discard;}color=u_dash_background_color;\n#else\ncolor=vec4(u_dash_background_color.rgb,color.a*step(TANGRAM_EPSILON,u_dash_background_color.a));\n#endif\n}else{color*=_line_color;}}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_NORMAL\nnormal=normalize(sampleRaster().rgb*2.-1.);\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\ngl_FragColor=color;}", Polygons = Object.create(Style);
        Object.assign(Polygons, { name: "polygons", built_in: true, vertex_shader_src: shaderSrc_polygonsVertex, fragment_shader_src: shaderSrc_polygonsFragment, selection: true, init: function() {
          Style.init.apply(this, arguments), this.defines.TANGRAM_NORMAL_ATTRIBUTE = true, this.defines.TANGRAM_LAYER_ORDER = true, this.defines.TANGRAM_CROP_BY_TILE = this.crop_by_tile, this.texcoords && (this.defines.TANGRAM_TEXTURE_COORDS = true);
        }, vertexLayoutForMeshVariant: function() {
          var e;
          return this.vertex_layout || (e = [{ name: "a_position", size: 4, type: gl$1.SHORT, normalized: false }, { name: "a_normal", size: 3, type: gl$1.BYTE, normalized: true }, { name: "a_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_selection_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }], this.texcoords && e.push({ name: "a_texcoord", size: 2, type: gl$1.UNSIGNED_SHORT, normalized: true }), this.vertex_layout = new VertexLayout(e)), this.vertex_layout;
        }, _parseFeature: function(e, t2, r) {
          var i2 = this.feature_style;
          return i2.color = this.parseColor(t2.color, r), i2.color ? (i2.z = t2.z && StyleParser.evalCachedDistanceProperty(t2.z, r) || StyleParser.defaults.z, i2.z *= Geo$1.height_scale, i2.extrude = StyleParser.evalProperty(t2.extrude, r), i2.extrude && (true === i2.extrude ? (i2.height = void 0 !== e.properties.height ? e.properties.height : StyleParser.defaults.height, i2.min_height = void 0 !== e.properties.min_height ? e.properties.min_height : StyleParser.defaults.min_height) : "number" == typeof i2.extrude ? (i2.height = i2.extrude, i2.min_height = 0) : Array.isArray(i2.extrude) && (i2.min_height = i2.extrude[0], i2.height = i2.extrude[1]), i2.height *= Geo$1.height_scale, i2.min_height *= Geo$1.height_scale), i2.tile_edges = t2.tile_edges, i2) : null;
        }, _preprocess: function(e) {
          return e.color = StyleParser.createColorPropertyCache(e.color), e.z = StyleParser.createPropertyCache(e.z, StyleParser.parseUnits), e;
        }, makeVertexTemplate: function(e) {
          var t2 = 0;
          return this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = e.z || 0, this.vertex_template[t2++] = this.scaleOrder(e.order), this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 127, this.vertex_template[t2++] = 255 * e.color[0], this.vertex_template[t2++] = 255 * e.color[1], this.vertex_template[t2++] = 255 * e.color[2], this.vertex_template[t2++] = 255 * e.color[3], this.selection && (this.vertex_template[t2++] = 255 * e.selection_color[0], this.vertex_template[t2++] = 255 * e.selection_color[1], this.vertex_template[t2++] = 255 * e.selection_color[2], this.vertex_template[t2++] = 255 * e.selection_color[3]), this.texcoords && (this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0), this.vertex_template;
        }, buildPolygons: function(e, t2, r, i2) {
          var n = this.makeVertexTemplate(t2), o = { texcoord_index: this.vertex_layout.index.a_texcoord, texcoord_normalize: 65535, remove_tile_edges: !t2.tile_edges, tile_edge_tolerance: Geo$1.tile_scale * i2.tile.pad_scale * 4, winding: i2.winding };
          return t2.extrude && t2.height ? buildExtrudedPolygons(e, t2.z, t2.height, t2.min_height, r.vertex_data, n, this.vertex_layout.index.a_normal, 127, o) : buildPolygons(e, r.vertex_data, n, o);
        } });
        var zero_vec2 = [0, 0], CAP_TYPE = { butt: 0, square: 1, round: 2 }, JOIN_TYPE = { miter: 0, bevel: 1, round: 2 }, DEFAULT = { MITER_LIMIT: 3, TEXCOORD_NORMALIZE: 1, TEXCOORD_RATIO: 1, MIN_FAN_WIDTH: 5 }, v_scale_adjust = Geo$1.tile_scale, zero_v = [0, 0], one_v = [1, 0], mid_v = [0.5, 0];
        function buildPolylines(e, t2, r, i2, n) {
          var o, a2, s = n.closed_polygon, l = n.remove_tile_edges, u2 = n.tile_edge_tolerance, c2 = n.texcoord_index, h = (n.texcoord_scale, n.texcoord_width), f2 = n.texcoord_ratio, d = n.texcoord_normalize, _ = n.extrude_index, p2 = n.offset_index, g = n.join, m = n.cap, y = n.miter_limit, v = n.offset, x2 = n.crop_by_tile, b2 = m ? CAP_TYPE[m] : CAP_TYPE.butt, T2 = g ? JOIN_TYPE[g] : JOIN_TYPE.miter;
          T2 === JOIN_TYPE.miter && (o = (y = y || DEFAULT.MITER_LIMIT) * y), c2 && (d = d || DEFAULT.TEXCOORD_NORMALIZE, a2 = 1 / (h * (f2 = f2 || DEFAULT.TEXCOORD_RATIO) * v_scale_adjust));
          for (var A2 = { closed_polygon: s, remove_tile_edges: l, tile_edge_tolerance: u2, miter_len_sq: o, join_type: T2, cap_type: b2, vertex_data: r, vertex_template: i2, half_width: t2 / 2, extrude_index: _, offset_index: p2, v_scale: a2, texcoord_index: c2, texcoord_width: h, texcoord_normalize: d, offset: v, geom_count: 0, crop_by_tile: x2 }, E2 = 0; E2 < e.length; E2++)
            buildPolyline(e[E2], A2);
          if (A2.extra_lines)
            for (var w = 0; w < A2.extra_lines.length; w++)
              buildPolyline(A2.extra_lines[w], A2);
          return A2.geom_count;
        }
        function buildPolyline(e, t2) {
          if (!(e.length < 2)) {
            var r, i2, n = t2.join_type, o = t2.cap_type, a2 = t2.closed_polygon, s = t2.remove_tile_edges, l = t2.tile_edge_tolerance, u2 = t2.v_scale, c2 = t2.miter_len_sq, h = t2.crop_by_tile, f2 = null != t2.texcoord_index, d = 0;
            if (a2 && n === JOIN_TYPE.miter) {
              var _ = getTileBoundaryIndex(e);
              if (0 !== _) {
                var p2 = permuteLine(e, _);
                return t2.extra_lines = t2.extra_lines || [], void t2.extra_lines.push(p2);
              }
            }
            var g = 0, m = e.length - 1, y = 0;
            for (A2 = e[g], E2 = e[g + 1]; Vector$1.isEqual(A2, E2); )
              if (A2 = E2, E2 = e[++g + 1], y++, g === e.length - 1)
                return;
            for (; Vector$1.isEqual(e[m], e[m - 1]); )
              if (y++, 0 === --m)
                return;
            if (!(e.length < 2 + y))
              if (i2 = Vector$1.normalize(Vector$1.perp(A2, E2)), s && outsideTile(A2, E2, l)) {
                var v = getNextNonBoundarySegment(e, g, l);
                v && (t2.extra_lines = t2.extra_lines || [], t2.extra_lines.push(v));
              } else {
                a2 ? startPolygon(A2, r = Vector$1.normalize(Vector$1.perp(e[m - 1], A2)), i2, n, t2) : (!h && isCoordOutsideTile(A2) || (addCap(A2, d, i2, o, true, t2), f2 && o !== CAP_TYPE.butt && (d += 0.5 * u2 * t2.texcoord_width)), addVertex(A2, i2, i2, 1, d, t2, 1), addVertex(A2, i2, i2, 0, d, t2, -1)), f2 && (d += u2 * Vector$1.length(Vector$1.sub(E2, A2)));
                for (var x2 = g + 1; x2 < m; x2++) {
                  var b2 = x2, T2 = x2 + 1, A2 = e[b2], E2 = e[T2];
                  if (!Vector$1.isEqual(A2, E2)) {
                    if (s && outsideTile(A2, E2, l)) {
                      addVertex(A2, i2, i2, 1, d, t2, 1), addVertex(A2, i2, i2, 0, d, t2, -1), indexPairs(1, t2);
                      var w = getNextNonBoundarySegment(e, b2 + 1, l);
                      return void (w && (t2.extra_lines = t2.extra_lines || [], t2.extra_lines.push(w)));
                    }
                    r = i2, i2 = Vector$1.normalize(Vector$1.perp(A2, E2)), n === JOIN_TYPE.miter ? addMiter(d, A2, r, i2, c2, false, t2) : addJoin(n, d, A2, r, i2, false, t2), f2 && (d += u2 * Vector$1.length(Vector$1.sub(E2, A2)));
                  }
                }
                A2 = E2, r = i2, a2 ? endPolygon(A2, r, i2 = Vector$1.normalize(Vector$1.perp(A2, e[1])), n, d, t2) : (addVertex(A2, r, i2, 1, d, t2, 1), addVertex(A2, r, i2, 0, d, t2, -1), indexPairs(1, t2), !h && isCoordOutsideTile(A2) || addCap(A2, d, r, o, false, t2));
              }
          }
        }
        function getTileBoundaryIndex(e) {
          if (isCoordOutsideTile(e[0]))
            return 0;
          for (var t2 = 0; t2 < e.length; t2++) {
            if (isCoordOutsideTile(e[e.length - 1 - t2]))
              return e.length - 1 - t2;
          }
          return 0;
        }
        function getNextNonBoundarySegment(e, t2, r) {
          for (var i2 = t2; e[i2 + 1] && outsideTile(e[i2], e[i2 + 1], r); )
            i2++;
          return 2 <= e.length - i2 && e.slice(i2);
        }
        function startPolygon(e, t2, r, i2, n) {
          void 0 === i2 || isCoordOutsideTile(e) && !n.crop_by_tile ? (addVertex(e, r, r, 1, 0, n, 1), addVertex(e, r, r, 0, 0, n, -1)) : i2 === JOIN_TYPE.miter ? addMiter(0, e, t2, r, n.miter_len_sq, true, n) : addJoin(i2, 0, e, t2, r, true, n);
        }
        function endPolygon(e, t2, r, i2, n, o) {
          var a2;
          isCoordOutsideTile(e) && !o.crop_by_tile ? (addVertex(e, t2, t2, 1, n, o, 1), addVertex(e, t2, t2, 0, n, o, -1)) : (a2 = createMiterVec(t2, r), i2 === JOIN_TYPE.miter && Vector$1.lengthSq(a2) > o.miter_len_sq && (i2 = JOIN_TYPE.bevel), i2 === JOIN_TYPE.miter ? (addVertex(e, a2, t2, 1, n, o, 1), addVertex(e, a2, t2, 0, n, o, -1)) : (addVertex(e, t2, t2, 1, n, o, 1), addVertex(e, t2, t2, 0, n, o, -1))), indexPairs(1, o);
        }
        function createMiterVec(e, t2) {
          var r = Vector$1.normalize(Vector$1.add(e, t2)), i2 = 2 / (1 + Math.abs(Vector$1.dot(e, r)));
          return Vector$1.mult(r, i2 * i2);
        }
        function addMiter(e, t2, r, i2, n, o, a2) {
          var s = createMiterVec(r, i2);
          Vector$1.lengthSq(s) > n ? addJoin(JOIN_TYPE.bevel, e, t2, r, i2, o, a2) : (addVertex(t2, s, s, 1, e, a2, 1), addVertex(t2, s, s, 0, e, a2, -1), o || indexPairs(1, a2));
        }
        function addJoin(e, t2, r, i2, n, o, a2) {
          var s = createMiterVec(i2, n), l = 0 < n[0] * i2[1] - n[1] * i2[0];
          null != a2.texcoord_index && (zero_v[1] = t2, one_v[1] = t2), l ? (addVertex(r, s, s, 1, t2, a2, 1), addVertex(r, i2, s, 0, t2, a2, -1), o || indexPairs(1, a2), addFan(r, Vector$1.neg(i2), s, Vector$1.neg(n), s, zero_v, one_v, zero_v, false, e === JOIN_TYPE.bevel, a2), addVertex(r, s, s, 1, t2, a2, 1), addVertex(r, n, s, 0, t2, a2, -1)) : (addVertex(r, i2, s, 1, t2, a2, 1), addVertex(r, s, s, 0, t2, a2, -1), o || indexPairs(1, a2), addFan(r, i2, Vector$1.neg(s), n, s, one_v, zero_v, one_v, false, e === JOIN_TYPE.bevel, a2), addVertex(r, n, s, 1, t2, a2, 1), addVertex(r, s, s, 0, t2, a2, -1));
        }
        function indexPairs(e, t2) {
          for (var r = t2.vertex_data.vertex_elements, i2 = t2.vertex_data.vertex_count - 2 * e - 2, n = 0; n < e; n++)
            r.push(i2 + 2 * n + 2), r.push(i2 + 2 * n + 1), r.push(i2 + 2 * n), r.push(i2 + 2 * n + 2), r.push(i2 + 2 * n + 3), r.push(i2 + 2 * n + 1), t2.geom_count += 2;
        }
        function addVertex(e, t2, r, i2, n, o, a2) {
          var s = o.vertex_template, l = o.vertex_data;
          s[0] = e[0], s[1] = e[1];
          var u2 = o.half_width * a2;
          s[o.extrude_index + 0] = t2[0] * u2, s[o.extrude_index + 1] = t2[1] * u2, o.offset && (s[o.offset_index + 0] = r[0] * o.offset, s[o.offset_index + 1] = r[1] * o.offset), null != o.texcoord_index && (s[o.texcoord_index + 0] = i2 * o.texcoord_normalize, s[o.texcoord_index + 1] = n * o.texcoord_normalize), l.addVertex(s);
        }
        var uvCurr = [0, 0];
        function addFan(e, t2, r, i2, n, o, a2, s, l, u2, c2) {
          for (var h = t2[0] * i2[1] - t2[1] * i2[0], f2 = Vector$1.dot(t2, i2), d = Math.atan2(h, f2); d >= Math.PI; )
            d -= 2 * Math.PI;
          if (u2)
            _ = 1;
          else {
            var _ = trianglesPerArc(d, c2.half_width);
            if (_ < 1)
              return;
          }
          var p2 = c2.vertex_data.vertex_count, g = c2.vertex_data.vertex_elements;
          addVertex(e, r, n, a2[0], a2[1], c2, 1), addVertex(e, t2, n, o[0], o[1], c2, 1);
          var m, y, v = t2, x2 = null != c2.texcoord_index;
          x2 && (l ? m = Vector$1.sub(o, a2) : (uvCurr = Vector$1.copy(o), y = Vector$1.div(Vector$1.sub(s, o), _)));
          for (var b2, T2 = d / _, A2 = d < 0 ? -1 : 1, E2 = 0 < h ? (b2 = 2, 1) : (b2 = 1, 2), w = 0; w < _; w++)
            0 === w && d < 0 && (v = Vector$1.neg(v)), v = Vector$1.rot(v, T2), x2 && (l ? (m = Vector$1.rot(m, T2), uvCurr[0] = m[0] + a2[0], uvCurr[1] = m[1] * c2.texcoord_width * c2.v_scale + a2[1]) : uvCurr = Vector$1.add(uvCurr, y)), addVertex(e, v, n, uvCurr[0], uvCurr[1], c2, A2), g.push(p2 + w + b2), g.push(p2), g.push(p2 + w + E2);
        }
        function addCap(e, t2, r, i2, n, o) {
          var a2, s = Vector$1.neg(r), l = null != o.texcoord_index;
          switch (i2) {
            case CAP_TYPE.square:
              n ? (a2 = [r[1], -r[0]], addVertex(e, Vector$1.add(r, a2), r, 1, t2, o, 1), addVertex(e, Vector$1.add(s, a2), r, 0, t2, o, 1), l && (t2 += 0.5 * o.texcoord_width * o.v_scale), addVertex(e, r, r, 1, t2, o, 1), addVertex(e, s, r, 0, t2, o, 1)) : (a2 = [-r[1], r[0]], addVertex(e, r, r, 1, t2, o, 1), addVertex(e, s, r, 0, t2, o, 1), l && (t2 += 0.5 * o.texcoord_width * o.v_scale), addVertex(e, Vector$1.add(r, a2), r, 1, t2, o, 1), addVertex(e, Vector$1.add(s, a2), r, 0, t2, o, 1)), indexPairs(1, o);
              break;
            case CAP_TYPE.round:
              var u2, c2, h = zero_v, f2 = one_v, d = mid_v;
              n ? (u2 = r, c2 = s, l && (t2 += 0.5 * o.texcoord_width * o.v_scale, h = one_v, f2 = zero_v, d = mid_v)) : (u2 = s, c2 = r), l && (zero_v[1] = t2, one_v[1] = t2, mid_v[1] = t2), addFan(e, u2, zero_vec2, c2, r, h, d, f2, true, false, o);
              break;
            case CAP_TYPE.butt:
              return;
          }
        }
        function trianglesPerArc(e, t2) {
          e < 0 && (e = -e);
          var r = t2 > 2 * DEFAULT.MIN_FAN_WIDTH ? Math.log2(t2 / DEFAULT.MIN_FAN_WIDTH) : 1;
          return Math.ceil(e / Math.PI * r);
        }
        function permuteLine(e, t2) {
          for (var r = [], i2 = 0; i2 < e.length; i2++) {
            var n = (i2 + t2) % e.length;
            0 != n && r.push(e[n]);
          }
          return r.push(r[0]), r;
        }
        var default_dash_color = [255, 255, 255, 255], default_background_color = [0, 0, 0, 0];
        function renderDashArray(e) {
          var t2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {}, r = t2.dash_color || default_dash_color, i2 = t2.background_color || default_background_color, n = e, o = t2.scale || 1;
          n.length % 2 == 1 && Array.prototype.push.apply(n, n);
          for (var a2 = true, s = [], l = 0; l < n.length; l++) {
            for (var u2 = Math.floor(n[l] * o), c2 = 0; c2 < u2; c2++)
              Array.prototype.push.apply(s, a2 ? r : i2);
            a2 = !a2;
          }
          return { pixels: s = new Uint8Array(s), length: s.length / 4 };
        }
        var Lines = Object.create(Style);
        Lines.vertex_layouts = [[], []], Lines.dash_textures = {};
        var DASH_SCALE = 20;
        function buildPolylines$1(e, t2, r, i2, n, o) {
          for (var a2 = { closed: o, vertex_data: r, vertex_template: i2, half_width: t2 / 2, vertex_layout_index: n, geom_count: 0 }, s = 0, l = e.length; s < l; s++)
            buildPolyline$1(e[s], a2);
          return a2.geom_count;
        }
        function buildPolyline$1(e, t2) {
          if (!(e.length < 2)) {
            for (var r, i2, n = [e[0]], o = 0, a2 = [], s = [], l = 1, u2 = e.length; l < u2; l++) {
              e[l][0] === e[l - 1][0] && e[l][1] === e[l - 1][1] || (n.push(e[l]), r = Vector$1.sub(e[l], e[l - 1]), i2 = Vector$1.length(r), a2.push(r), s.push([o, o + i2]), o += i2);
            }
            if (!(n.length < 2)) {
              var c2 = 0, h = a2[a2.length - 1], f2 = a2[0], d = a2[1], _ = [0, 0];
              2 < n.length && (t2.closed && (_[0] = Vector$1.signedAngleBetween(h, f2)), _[1] = Vector$1.signedAngleBetween(f2, d));
              var p2 = n[0], g = s[0];
              t2.closed ? (addVertex$1(p2, t2, c2++, g, o, _, [h, f2]), addVertex$1(p2, t2, c2++, g, o, _, [h, f2])) : (addVertex$1(p2, t2, c2++, g, o, _, [f2, f2]), addVertex$1(p2, t2, c2++, g, o, _, [f2, f2]));
              for (var m = 1, y = n.length - 1; m < y; m++)
                p2 = n[m], h = a2[m - 1], f2 = a2[m], d = a2[m + 1], addVertex$1(p2, t2, c2++, g = s[m - 1], o, _, [h, f2]), addVertex$1(p2, t2, c2++, g, o, _, [h, f2]), triangulate(t2), g = s[m], _[0] = _[1], _[1] = m !== y - 1 ? Vector$1.signedAngleBetween(f2, d) : t2.closed ? Vector$1.signedAngleBetween(f2, a2[0]) : 0, addVertex$1(p2, t2, c2++, g, o, _, [h, f2]), addVertex$1(p2, t2, c2++, g, o, _, [h, f2]);
              p2 = n[n.length - 1], g = s[s.length - 1], f2 = a2[a2.length - 1], t2.closed ? (addVertex$1(p2, t2, c2++, g, o, _, [f2, a2[0]]), addVertex$1(p2, t2, c2++, g, o, _, [f2, a2[0]])) : (addVertex$1(p2, t2, c2++, g, o, _, [f2, f2]), addVertex$1(p2, t2, c2++, g, o, _, [f2, f2])), triangulate(t2);
            }
          }
        }
        function triangulate(e) {
          var t2 = e.vertex_data.vertex_elements, r = e.vertex_data.vertex_count - 4;
          t2.push(2 + r), t2.push(1 + r), t2.push(r), t2.push(2 + r), t2.push(3 + r), t2.push(1 + r), e.geom_count += 2;
        }
        Object.assign(Lines, { name: "lines", built_in: true, vertex_shader_src: shaderSrc_polygonsVertex, fragment_shader_src: shaderSrc_polygonsFragment, selection: true, init: function() {
          Style.init.apply(this, arguments), this.styles = this.styles || {}, this.defines.TANGRAM_LAYER_ORDER = true, this.defines.TANGRAM_EXTRUDE_LINES = true, this.defines.TANGRAM_CROP_BY_TILE = this.crop_by_tile, this.defines.TANGRAM_TEXTURE_COORDS = true, this.outline_feature_style = {}, this.inline_feature_style = this.feature_style;
        }, calcDistance: function(e, t2) {
          return e && StyleParser.evalCachedDistanceProperty(e, t2) || 0;
        }, calcDistanceNextZoom: function(e, t2) {
          t2.zoom++;
          var r = this.calcDistance(e, t2);
          return t2.zoom--, r;
        }, calcWidth: function(e, t2, r) {
          var i2 = this.calcDistance(e.width, r);
          if (!(i2 < 0)) {
            var n, o = e.next_width ? this.calcDistanceNextZoom(e.next_width, r) : i2 / 2;
            return 0 === i2 && 0 === o || o < 0 ? false : (t2.width_unscaled = i2, t2.next_width_unscaled = o, e.next_width ? (n = 0.5 * (i2 + (o *= 2)), t2.width = n * r.units_per_meter_overzoom, t2.width_scale = 1 - o / n) : (t2.width = i2 * r.units_per_meter_overzoom, t2.width_scale = 0), e.texcoords && (e.inline_texcoord_width ? t2.texcoord_width = e.inline_texcoord_width : t2.texcoord_width = (t2.width_unscaled || t2.next_width_unscaled) * r.units_per_meter_overzoom / r.tile.overzoom2), true);
          }
        }, calcOffset: function(e, t2, r) {
          var i2, n;
          e.offset_precalc ? (t2.offset = e.offset_precalc, t2.offset_scale = e.offset_scale_precalc) : e.offset ? (i2 = this.calcDistance(e.offset, r), e.next_offset ? (n = 2 * this.calcDistanceNextZoom(e.next_offset, r), Math.abs(i2) >= Math.abs(n) ? (t2.offset = i2 * r.units_per_meter_overzoom, t2.offset_scale = 0 !== i2 ? 1 - n / i2 : 0) : (t2.offset = n * r.units_per_meter_overzoom, t2.offset_scale = 0 != n ? -1 * (1 - i2 / n) : 0)) : (t2.offset = i2 * r.units_per_meter_overzoom, t2.offset_scale = 0)) : (t2.offset = 0, t2.offset_scale = 0), StyleParser.evalProperty(e.offset_reverse, r) && (t2.offset *= -1);
        }, _parseFeature: function(e, t2, r) {
          var i2, n, o = this.feature_style;
          if (false !== this.calcWidth(t2, o, r) && (this.calcOffset(t2, o, r), o.color = this.parseColor(t2.color, r), o.color))
            return o.variantKey = t2.variantKey, o.z = t2.z && StyleParser.evalCachedDistanceProperty(t2.z || 0, r) || StyleParser.defaults.z, o.height = e.properties.height || StyleParser.defaults.height, o.extrude = StyleParser.evalProperty(t2.extrude, r), o.extrude && ("number" == typeof o.extrude ? o.height = o.extrude : Array.isArray(o.extrude) && (o.height = o.extrude[1])), o.extrude && o.height && (o.z += o.height), o.z *= Geo$1.height_scale, o.height *= Geo$1.height_scale, o.cap = StyleParser.evalProperty(t2.cap, r), o.join = StyleParser.evalProperty(t2.join, r), o.miter_limit = StyleParser.evalProperty(t2.miter_limit, r), o.tile_edges = t2.tile_edges, o.outline = o.outline || { width: {}, next_width: {}, preprocessed: true }, t2.outline && false !== t2.outline.visible && t2.outline.color && t2.outline.width ? (i2 = 2 * this.calcDistance(t2.outline.width, r), n = 2 * this.calcDistanceNextZoom(t2.outline.next_width, r), 0 == i2 && 0 == n || i2 < 0 || n < 0 ? (o.outline.width.value = null, o.outline.next_width.value = null, o.outline.color = null, o.outline.inline_texcoord_width = null, o.outline.texcoords = false) : (o.outline.width.value = i2 + o.width_unscaled, o.outline.next_width.value = n + o.next_width_unscaled, o.outline.inline_texcoord_width = o.texcoord_width, o.outline.offset_precalc = o.offset, o.outline.offset_scale_precalc = o.offset_scale, o.outline.color = t2.outline.color, o.outline.cap = t2.outline.cap, o.outline.join = t2.outline.join, o.outline.miter_limit = t2.outline.miter_limit, o.outline.texcoords = t2.outline.texcoords, o.outline.style = t2.outline.style, o.outline.variantKey = t2.outline.variantKey, t2.outline.order ? o.outline.order = this.parseOrder(t2.outline.order, r) : o.outline.order = o.order, o.outline.order > o.order && (o.outline.order = o.order), o.outline.order -= 0.5, o.outline.variant_order = 0)) : (o.outline.width.value = null, o.outline.next_width.value = null, o.outline.color = null, o.outline.inline_texcoord_width = null), o;
        }, _preprocess: function(e, t2) {
          var r, i2 = this.sources[t2] ? this.sources[t2].config.uid : "";
          return e.color = StyleParser.createColorPropertyCache(e.color), e.width = StyleParser.createPropertyCache(e.width, StyleParser.parseUnits), e.width && e.width.type !== StyleParser.CACHE_TYPE.STATIC && (e.next_width = StyleParser.createPropertyCache(e.width, StyleParser.parseUnits)), e.offset = e.offset && StyleParser.createPropertyCache(e.offset, StyleParser.parseUnits), e.offset && e.offset.type !== StyleParser.CACHE_TYPE.STATIC && (e.next_offset = StyleParser.createPropertyCache(e.offset, StyleParser.parseUnits)), e.z = StyleParser.createPropertyCache(e.z, StyleParser.parseUnits), e.dash = void 0 !== e.dash ? e.dash : this.dash, e.dash_key = e.dash && this.dashTextureKey(e.dash, i2), e.dash_background_color = void 0 !== e.dash_background_color ? e.dash_background_color : this.dash_background_color, e.dash_background_color = e.dash_background_color && StyleParser.parseColor(e.dash_background_color), e.texture_merged = e.dash_key || (void 0 !== e.texture ? e.texture : this.texture), e.texcoords = this.texcoords || e.texture_merged ? 1 : 0, this.addMeshVariantForDraw(this.base, e), e.outline && (e.outline.style = e.outline.style || this.name, e.outline.color = StyleParser.createColorPropertyCache(e.outline.color), e.outline.width = StyleParser.createPropertyCache(e.outline.width, StyleParser.parseUnits), e.outline.next_width = StyleParser.createPropertyCache(e.outline.width, StyleParser.parseUnits), e.outline.cap = e.outline.cap || e.cap, e.outline.join = e.outline.join || e.join, e.outline.miter_limit = e.outline.miter_limit || e.miter_limit, e.outline.offset = e.offset, (r = this.styles[e.outline.style]) ? (e.outline.dash = void 0 !== e.outline.dash ? e.outline.dash : r.dash, e.outline.texture = void 0 !== e.outline.texture ? e.outline.texture : r.texture, null != e.outline.dash ? (e.outline.dash_key = e.outline.dash && this.dashTextureKey(e.outline.dash, i2), e.outline.texture_merged = e.outline.dash_key) : null === e.outline.dash || null != e.outline.texture ? (e.outline.dash_key = null, e.outline.texture_merged = e.outline.texture) : (e.outline.dash = e.dash, e.outline.dash_key = e.outline.dash && this.dashTextureKey(e.outline.dash, i2), e.outline.texture_merged = e.outline.dash_key), e.outline.dash_background_color = void 0 !== e.outline.dash_background_color ? e.outline.dash_background_color : r.dash_background_color, e.outline.dash_background_color = void 0 !== e.outline.dash_background_color ? e.outline.dash_background_color : e.dash_background_color, e.outline.dash_background_color = e.outline.dash_background_color && StyleParser.parseColor(e.outline.dash_background_color), e.outline.texcoords = r.texcoords || e.outline.texture_merged ? 1 : 0, this.addMeshVariantForDraw(this.base, e.outline)) : (log({ level: "warn", once: true }, "Layer '".concat(e.layers[e.layers.length - 1], "': ") + "line 'outline' specifies non-existent draw style '".concat(e.outline.style, "' (or maybe the style is ") + "defined but is missing a 'base' or has another error), skipping outlines in layer"), e.outline = null)), e;
        }, dashTextureKey: function(e, t2) {
          return "__dash_" + t2 + "_" + this.scene_id + "_" + JSON.stringify(e);
        }, getDashTexture: function(e, t2) {
          var r, i2 = this.dashTextureKey(e, this.sources[t2].config.uid);
          null == Lines.dash_textures[i2] && (Lines.dash_textures[i2] = true, r = renderDashArray(e, { scale: DASH_SCALE }), this.textureManager.create(this.gl, i2, { data: r.pixels, height: r.length, width: 1, filtering: "nearest" }));
        }, endData: function(a2) {
          var s = this;
          return Style.endData.call(this, a2).then(function(n) {
            if (n) {
              n.uniforms.u_has_line_texture = false, n.uniforms.u_texture = s.textureManager.default, n.uniforms.u_v_scale_adjust = Geo$1.tile_scale;
              var o = [];
              for (var e in n.meshes)
                !function(e2) {
                  var r, t2, i2 = n.meshes[e2].variant;
                  i2.texture && ((r = n.meshes[e2].uniforms = n.meshes[e2].uniforms || {}).u_has_line_texture = true, r.u_texture = i2.texture, r.u_texture_ratio = 1, i2.dash && (r.u_v_scale_adjust = Geo$1.tile_scale * DASH_SCALE, r.u_dash_background_color = i2.dash_background_color || [0, 0, 0, 0]), i2.dash_key && null == Lines.dash_textures[i2.dash_key] && (Lines.dash_textures[i2.dash_key] = true, WorkerBroker.postMessage(s.main_thread_target + ".getDashTexture", i2.dash, a2.source)), null == s.textureManager.textures[i2.texture] ? o.push(s.textureManager.syncTexturesToWorker([i2.texture]).then(function(e3) {
                    var t3 = e3[i2.texture];
                    t3 && (r.u_texture_ratio = t3.height / t3.width);
                  })) : (t2 = s.textureManager.textures[i2.texture], r.u_texture_ratio = t2.height / t2.width));
                }(e);
              return a2.mesh_data[s.name] = n, Promise.all(o).then(function() {
                return n;
              });
            }
            return n;
          });
        }, computeVariantForDraw: function(e) {
          var t2 = e.offset ? 1 : 0;
          return e.dash_key && (t2 += e.dash_key, e.dash_background_color && (t2 += e.dash_background_color)), e.texture_merged && (t2 += e.texture_merged), t2 = hashString(t2 += "/" + e.texcoords), { key: e.variantKey = t2, order: e.variant_order, offset: e.offset ? 1 : 0, texcoords: e.texcoords, texture: e.texture_merged, dash: e.dash, dash_key: e.dash_key, dash_background_color: e.dash_background_color };
        }, vertexLayoutForMeshVariant: function(e) {
          var t2;
          return null == Lines.vertex_layouts[e.key] && (t2 = [{ name: "a_position", size: 4, type: gl$1.SHORT, normalized: false }, { name: "a_extrude", size: 2, type: gl$1.SHORT, normalized: false }, { name: "a_offset", size: 2, type: gl$1.SHORT, normalized: false, static: e.offset ? null : [0, 0] }, { name: "a_scaling", size: 2, type: gl$1.SHORT, normalized: false }, { name: "a_texcoord", size: 2, type: gl$1.UNSIGNED_SHORT, normalized: true, static: e.texcoords ? null : [0, 0] }, { name: "a_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_selection_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }], Lines.vertex_layouts[e.key] = new VertexLayout(t2)), Lines.vertex_layouts[e.key];
        }, makeVertexTemplate: function(e, t2) {
          var r = 0;
          return this.vertex_template[r++] = 0, this.vertex_template[r++] = 0, this.vertex_template[r++] = e.z || 0, this.vertex_template[r++] = this.scaleOrder(e.order), this.vertex_template[r++] = 0, this.vertex_template[r++] = 0, t2.variant.offset && (this.vertex_template[r++] = 0, this.vertex_template[r++] = 0), this.vertex_template[r++] = 1024 * e.width_scale, this.vertex_template[r++] = 1024 * e.offset_scale, t2.variant.texcoords && (this.vertex_template[r++] = 0, this.vertex_template[r++] = 0), this.vertex_template[r++] = 255 * e.color[0], this.vertex_template[r++] = 255 * e.color[1], this.vertex_template[r++] = 255 * e.color[2], this.vertex_template[r++] = 255 * e.color[3], this.selection && (this.vertex_template[r++] = 255 * e.selection_color[0], this.vertex_template[r++] = 255 * e.selection_color[1], this.vertex_template[r++] = 255 * e.selection_color[2], this.vertex_template[r++] = 255 * e.selection_color[3]), this.vertex_template;
        }, buildLines: function(e, t2, r, i2, n) {
          var o;
          this.feature_style = this.outline_feature_style, !t2.outline || null == t2.outline.color || null == t2.outline.width.value || (o = this.styles[t2.outline.style]) && o.addFeature(i2.feature, t2.outline, i2), this.feature_style = this.inline_feature_style;
          var a2 = r.vertex_data, s = a2.vertex_layout, l = this.makeVertexTemplate(t2, r);
          return buildPolylines(e, t2.width, a2, l, { cap: t2.cap, join: t2.join, miter_limit: t2.miter_limit, extrude_index: s.index.a_extrude, offset_index: s.index.a_offset, texcoord_index: s.index.a_texcoord, texcoord_width: t2.texcoord_width, texcoord_normalize: 65535, closed_polygon: n && n.closed_polygon, remove_tile_edges: !t2.tile_edges && n && n.remove_tile_edges, tile_edge_tolerance: Geo$1.tile_scale * i2.tile.pad_scale * 2, offset: t2.offset, crop_by_tile: this.crop_by_tile });
        }, buildPolygons: function(e, t2, r, i2) {
          for (var n = 0, o = 0; o < e.length; o++)
            n += this.buildLines(e[o], t2, r, i2, { closed_polygon: true, remove_tile_edges: !this.crop_by_tile });
          return n;
        } });
        var TEX_COORDS = [[1, 1], [1, -1], [-1, 1], [-1, -1]];
        function addVertex$1(e, t2, r, i2, n, o, a2) {
          var s, l = t2.vertex_template, u2 = t2.vertex_data;
          setAttribute(t2, "a_position", e), setAttribute(t2, "a_width", t2.half_width), t2.vertex_layout_index.a_barycentric && ((s = [0, 0, 0])[r % 3] = 1, setAttribute(t2, "a_barycentric", s)), setAttribute(t2, "a_tangents", a2[0].concat(a2[1])), setAttribute(t2, "a_segment", i2), setAttribute(t2, "a_texcoord", TEX_COORDS[r % 4]), setAttribute(t2, "a_length", n), setAttribute(t2, "a_closed", t2.closed ? 1 : 0), setAttribute(t2, "a_angles", o), u2.addVertex(l);
        }
        function setAttribute(e, t2, r) {
          var i2 = r.length, n = e.vertex_template, o = e.vertex_layout_index[t2], a2 = 0;
          if (i2)
            for (; a2 !== i2; )
              n[o + a2] = r[a2], a2++;
          else
            n[o + a2] = r;
        }
        function buildPatternBuffer(e, a2) {
          for (var s = e.reduce(function(e2, t3) {
            return e2 + t3;
          }), t2 = 0, l = [], r = 0, i2 = e.length; r <= i2; r += 2) {
            var n = Math.max(1e-4, e[r % i2]), o = Math.max(1e-4, e[(r + 1) % i2]);
            l.push(t2, t2 + n), t2 += n + o;
          }
          for (var u2 = new Uint8Array(4 * a2), c2 = 0, h = 0; h < a2; h++)
            !function(e2) {
              var t3 = s * e2 / (a2 - 1), r2 = minIdx(l.map(function(e3) {
                return Math.abs(e3 - t3);
              })), i3 = void 0, n2 = void 0, o2 = void 0, o2 = r2 % 2 == 0 ? (i3 = t3 <= l[r2] ? 1 : 0, n2 = l[r2], l[r2 + 1]) : (i3 = t3 > l[r2] ? 2 : 0, n2 = l[r2 - 1], l[r2]);
              u2[c2++] = l[r2], u2[c2++] = i3, u2[c2++] = n2, u2[c2++] = o2;
            }(h);
          return u2;
        }
        function minIdx(e) {
          for (var t2 = e[0], r = 0, i2 = 1, n = e.length; i2 < n; i2++)
            e[i2] < t2 && (t2 = e[r = i2]);
          return r;
        }
        var vertex_shader_src = "uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform sampler2D u_uniforms;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform vec3 u_map_position;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_index;uniform vec2 u_dash_caps;uniform float u_dash_phase;uniform float u_dash_period;attribute vec4 a_position;attribute vec4 a_color;attribute float a_width;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nattribute vec3 a_barycentric;\n#endif\nattribute vec2 a_normal;attribute float a_length;attribute vec2 a_segment;attribute vec2 a_texcoord;attribute vec2 a_angles;attribute vec4 a_tangents;attribute float a_closed;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#ifndef TANGRAM_HEIGHT_SCALE\nfloat TANGRAM_HEIGHT_SCALE=16.0;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\nconst float PI=3.141592653589793;const float THETA=15.0*PI/180.0;float cross(in vec2 v1,in vec2 v2){return v1.x*v2.y-v1.y*v2.x;}float signed_distance(in vec2 v1,in vec2 v2,in vec2 v3){return cross(v2-v1,v1-v3)/length(v2-v1);}void rotate(in vec2 v,in float angle,out vec2 result){float cosine=cos(angle);float sine=sin(angle);result=vec2(cosine*v.x-sine*v.y,sine*v.x+cosine*v.y);}void main(){\n#pragma tangram: setup\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nfloat linewidth=a_width*2.0;v_angles=a_angles;v_segment=a_segment;v_color=a_color;v_length=a_length;v_texcoord=a_texcoord;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nv_barycentric=a_barycentric;\n#endif\nv_color.a=min(linewidth,v_color.a);linewidth=max(linewidth,1.0);linewidth/=exp2(u_map_position.z-u_tile_origin.w);v_linewidth_and_closed=linewidth*(a_closed>0.0 ?-1.0 : 1.0);if(v_color.a<=0.0){gl_Position=vec4(0.0,0.0,0.0,1.0);return;}float width=ceil(1.25*u_antialias+linewidth)/2.0;vec2 t1=normalize(a_tangents.xy);vec2 t2=normalize(a_tangents.zw);float u=a_texcoord.x;u*=-1.0;float v=a_texcoord.y;vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.0);if(t1!=t2){float angle=a_texcoord.x==1.0 ? a_angles.x : a_angles.y;vec2 t=normalize(t1+t2);vec2 o=vec2(+t.y,-t.x);float segmentLength=a_segment.y-a_segment.x;float magnitude=width/cos(angle/2.0);float sqMagnitude=magnitude*magnitude;float seg1SqMagnitude=dot(a_tangents.xy,a_tangents.xy);float seg2SqMagnitude=dot(a_tangents.zw,a_tangents.zw);if((abs(magnitude)>linewidth)&&(sqMagnitude>=min(seg1SqMagnitude,seg2SqMagnitude))){if(u==1.0){o=vec2(-t2.y,+t2.x);}else{o=vec2(-t1.y,+t1.x);}magnitude=width;angle=0.0;v_angles.x=0.0;v_angles.y=0.0;}if(u_dash_index>0.0){if((abs(angle)>THETA)){position.xy+=v*width*o/cos(angle/2.0);float s=sign(angle);if(angle<0.0){if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==1.0){position.xy-=2.0*width*t1/sin(angle);u-=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==1.0){position.xy+=2.0*width*t2/sin(angle);u+=2.0*width/sin(angle);}}}else{if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==-1.0){position.xy+=2.0*width*t1/sin(angle);u+=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==-1.0){position.xy-=2.0*width*t2/sin(angle);u-=2.0*width/sin(angle);}}}}else{position.xy+=v*width*o/cos(angle/2.0);if(u==+1.0){u=v_segment.y;}else{u=v_segment.x;}}}else{position.xy+=v*o*magnitude;if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);}else{u=v_segment.x-v*width*tan(angle/2.0);}}v_joinIndicator=(segmentLength+v*width*tan(angle/2.0))/segmentLength;}else{v_joinIndicator=-1.0;vec2 o=vec2(+t1.y,-t1.x);position.xy+=v*width*o;if(u==-1.0){u=v_segment.x-width;position.xy-=width*t1;}else{u=v_segment.y+width;position.xy+=width*t2;}}vec2 t;vec2 curr=a_position.xy;if(a_texcoord.x>=0.0){vec2 next=curr+t2*(v_segment.y-v_segment.x);rotate(t1,+a_angles.x/2.0,t);v_miter.x=signed_distance(curr,curr+t,position.xy);rotate(t2,+a_angles.y/2.0,t);v_miter.y=signed_distance(next,next+t,position.xy);}else{vec2 prev=curr-t1*(v_segment.y-v_segment.x);rotate(t1,-a_angles.x/2.0,t);v_miter.x=signed_distance(prev,prev+t,position.xy);rotate(t2,-a_angles.y/2.0,t);v_miter.y=signed_distance(curr,curr+t,position.xy);}v_distances=vec2(u,v*width);v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#endif\ngl_Position=position;}", fragment_shader_src = "uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_dash_atlas;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_phase;uniform float u_dash_period;uniform float u_dash_index;uniform vec2 u_dash_caps;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL v_normal\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\n#pragma tangram: utils\nconst float PI=3.141592653589793;const float HALF_PI=PI/2.0;const float THETA=15.0*PI/180.0;/***Compute distance to cap.*@param{int}type The Type of the cap(see CAP_TYPE in pattern_lines)*@param{float}dx The distance of the pixel from the beginning of the line(not straight distance,but along the legs)*@param{float}dy The distance of the pixel from the midline(see v_distances in vertex shader,aka 1*half_line_width)*@param{float}aa_radius The distance from the mid-line from where antialiasing starts.*For example for a linewidth 10px width and 2px filter radius it is 10px/2-2px=3px.*@return{float}distance*/float cap(int type,float dx,float dy,float aa_radius){float dist=0.0;dx=abs(dx);dy=abs(dy);if(type==1)dist=sqrt(dx*dx+dy*dy);else if(type==3)dist=(dx+abs(dy));else if(type==2)dist=max(abs(dy),(aa_radius+dx-abs(dy)));else if(type==4)dist=max(dx,dy);else if(type==5)dist=max(dx+aa_radius,dy);return dist;}/***Compute distance to join.*@param{int}type The type of the join(see JOIN_TYPE in pattern_lines)*@param{vec2}segment Interpolated a_segment attribute from the vertex shader*@param{vec2}texcoord Pair of u/v coordinates to identify the 4 different extruded points of the segment.*@param{vec2}distances 2 component vector where:*x is the distance of the pixel from the beginning of the line(along the legs)*y is the  distance of the pixel from the midline(see v_distances in vertex shader,1*half_line_width)*@param{vec2}miter Miter point coordiante*@param{float}miter_limit The miter limit*@param{float}linewidth The width of the line*@return{float}computed distance*/float join(in int type,in vec2 segment,in vec2 texcoord,in vec2 distances,in vec2 miter,in float miter_limit,in float linewidth){float dx=distances.x;float result=abs(distances.y);if((dx<segment.x)||(dx>segment.y)){if(type==1){float s=dx<segment.x ? segment.x : segment.y;result=max(result,length(distances-vec2(s,0.0)));}else{float m=abs(texcoord.x>=0.0 ? miter.x : miter.y);if(type==2){result=max(result,m);}else if(type==0){result=max(result,m-miter_limit*linewidth/2.0);}}}return result;}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\nif(v_color.a<=0.0){discard;}bool solid=(u_dash_index==0.0);bool closed=v_linewidth_and_closed<0.0;float dx=v_distances.x;float dy=v_distances.y;float linewidth=abs(v_linewidth_and_closed);float aa_radius=linewidth/2.0-u_antialias;float dist=0.0;vec2 linecaps=u_linecaps;vec2 dash_caps=u_dash_caps;float line_start=0.0;float line_stop=v_length;if(solid){dist=abs(dy);bool potentialCap=!closed&&v_joinIndicator<0.0;if(potentialCap&&dx<line_start){dist=cap(int(u_linecaps.x),abs(dx),abs(dy),aa_radius);}else if(potentialCap&&dx>line_stop){dist=cap(int(u_linecaps.y),abs(dx)-line_stop,abs(dy),aa_radius);}else{dist=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);}}else{float segment_start=v_segment.x;float segment_stop=v_segment.y;float segment_center=(segment_start+segment_stop)/2.0;float freq=u_dash_period*linewidth;float dash_phase=u_dash_phase-1e-5;float u=mod(dx+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));float dash_center=float(tex.x)*255.0*linewidth;float dash_type=floor(float(tex.y)*255.0+0.5);float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;float dash_start=dx-u+_start;float dash_stop=dx-u+_stop;if((dash_stop<segment_start)&&(dash_caps.x!=5.0)){float u=mod(segment_start+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_start-u+_start;dash_stop=segment_start-u+_stop;}else if((dash_start>segment_stop)&&(dash_caps.y!=5.0)){float u=mod(segment_stop+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_stop-u+_start;dash_stop=segment_stop-u+_stop;}bool discontinuous=((dx<segment_center)&&abs(v_angles.x)>THETA)||((dx>=segment_center)&&abs(v_angles.y)>THETA);float d_join=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);if(closed){line_start+=linewidth/2.0;line_stop-=linewidth/2.0;}if(dash_stop<=line_start){discard;}if(dash_start>=line_stop){discard;}if(discontinuous){if((dash_start>segment_stop)){discard;}if((dash_stop<segment_start)){discard;}if(dash_caps.x==1.0){if((u>_stop)&&(dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){discard;}}if(dash_caps.y==1.0){if((u<_start)&&(dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){discard;}}if((dash_caps.x!=1.0)&&(dash_caps.x!=5.0)){if((dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){float a=v_angles.x/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(segment_start-dx)*cos_a-dy*sin_a;float y=(segment_start-dx)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.x=4.0;}}if((dash_caps.y!=1.0)&&(dash_caps.y!=5.0)){if((dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){float a=v_angles.y/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(dx-segment_stop)*cos_a-dy*sin_a;float y=(dx-segment_stop)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.y=4.0;}}}if((dx<line_start)&&(dash_start<=line_start)&&(dash_stop>line_start)){dist=cap(int(linecaps.x),dx-line_start,dy,aa_radius);}else if((dx>line_stop)&&(dash_stop>line_stop)&&(dash_start<line_stop)){dist=cap(int(linecaps.y),dx-line_stop,dy,aa_radius);}else if(dash_type==1.0){dist=cap(int(dash_caps.x),abs(dash_center-u),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}else if(dash_type==0.0){dist=abs(dy);}else if(dash_type==2.0){dist=cap(int(dash_caps.y),abs(u-dash_center),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}if((dx>line_start)&&(dx<line_stop)){if((dx<=segment_start)&&(dash_start<=segment_start)&&(dash_stop>=segment_start)){dist=d_join;float angle=HALF_PI+v_angles.x;float f=abs((segment_start-dx)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if((dx>segment_stop)&&(dash_start<=segment_stop)&&(dash_stop>=segment_stop)){dist=d_join;float angle=HALF_PI+v_angles.y;float f=abs((dx-segment_stop)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}dist=dist-aa_radius;if(dist>=0.0){if(u_antialias==0.0){discard;}else{color=vec4(color.rgb,exp(-dist*dist)*color.a);}}\n#ifdef TANGRAM_DEBUG_TRIANGLES\nif(any(lessThan(v_barycentric,vec3(0.0085)))){color=vec4(0.0,1.0,0.0,1.0);}\n#endif\ngl_FragColor=color;}", PatternLines = Object.create(Style), CAP_TYPE$1 = { round: 1, "arrow-tail": 2, "arrow-head": 3, square: 4, butt: 5 }, JOIN_TYPE$1 = { miter: 0, round: 1, bevel: 2 }, PATTERN_MAX_WIDTH = 1024, DEFAULT_LINE_CAP = CAP_TYPE$1.round, DEFAULT_JOIN_TYPE = JOIN_TYPE$1.miter, DEFAULT_DASH_PATTERN = [0, 0], VARIANT_UNIQUE_PROP_NAMES = "antialias join linecaps miter_limit dash_index dash dash_caps dash_phase".split(" ");
        function getHashForStyle(e) {
          for (var t2 = [], r = 0, i2 = VARIANT_UNIQUE_PROP_NAMES.length; r < i2; r++) {
            var n = e[VARIANT_UNIQUE_PROP_NAMES[r]];
            Array.isArray(n) ? t2.push(n.join("_")) : "boolean" == typeof n ? t2.push(n ? 1 : 0) : n && t2.push(n.toString());
          }
          return t2.join("/");
        }
        Object.assign(PatternLines, { name: "pattern-lines", built_in: true, vertex_shader_src, fragment_shader_src, selection: true, init: function() {
          Style.init.apply(this, arguments), this.defines.TANGRAM_LAYER_ORDER = true, this.defines.TANGRAM_CROP_BY_TILE = this.crop_by_tile, this.defines.TANGRAM_DEBUG_TRIANGLES = false, this.defines.TANGRAM_DEBUG_NO_TEXTURE_FLOAT_SUPPORT = false, this.styles = this.styles || {}, PatternLines.vertex_layouts = [];
        }, calcDistance: function(e, t2) {
          return e && StyleParser.evalCachedDistanceProperty(e, t2) || 0;
        }, calcDash: function(e, t2) {
          var r = StyleParser.evalProperty(e.dash, t2), i2 = 0;
          return r && ((r = Array.isArray(r) && r.length ? r : DEFAULT_DASH_PATTERN).length % 2 == 1 && (r = r.concat(r)), i2 = +(i2 = r.reduce(function(e2, t3) {
            return e2 + t3;
          })) || 0), { dash: r, dash_period: i2 };
        }, calcWidth: function(e, t2, r) {
          var i2 = this.calcDistance(e.width, r);
          return !(i2 < 0) && (t2.width = i2 * r.units_per_meter_overzoom, true);
        }, getCapType: function(e, t2, r) {
          var i2 = StyleParser.evalProperty(e, t2);
          return void 0 !== CAP_TYPE$1[i2] ? CAP_TYPE$1[i2] : r;
        }, _parseFeature: function(e, t2, r) {
          if (false !== this.calcWidth(t2, this.feature_style, r)) {
            var i2 = this.parseColor(t2.color, r);
            if (i2 && 0 !== i2[3]) {
              var n = this.getCapType(t2.cap, r, DEFAULT_LINE_CAP), o = StyleParser.evalProperty(t2.join, r), a2 = +StyleParser.evalProperty(t2.miter_limit, r), s = this.calcDash(t2, r), l = s.dash, u2 = s.dash_period, c2 = Object.assign({ color: i2, antialias: t2.antialias, linecaps: [this.getCapType(t2.tail_cap, r, n), this.getCapType(t2.head_cap, r, n)], join: void 0 !== JOIN_TYPE$1[o] ? JOIN_TYPE$1[o] : DEFAULT_JOIN_TYPE, miter_limit: 0 <= a2 ? a2 : 3, dash_index: 0 === u2 ? 0 : 1, dash: l, dash_caps: [this.getCapType(t2.tail_cap, r, n), this.getCapType(t2.head_cap, r, n)], dash_phase: +StyleParser.evalProperty(t2.dash_phase, r) || 0, dash_period: u2 }, this.feature_style);
              return c2.z = t2.z && StyleParser.evalCachedDistanceProperty(t2.z || 0, r) || StyleParser.defaults.z, c2.z *= Geo$1.height_scale, c2.extrude = StyleParser.evalProperty(t2.extrude, r), c2.extrude && (true === c2.extrude ? (c2.height = void 0 !== e.properties.height ? e.properties.height : StyleParser.defaults.height, c2.min_height = void 0 !== e.properties.min_height ? e.properties.min_height : StyleParser.defaults.min_height) : "number" == typeof c2.extrude ? (c2.height = c2.extrude, c2.min_height = 0) : Array.isArray(c2.extrude) && (c2.min_height = c2.extrude[0], c2.height = c2.extrude[1]), c2.height *= Geo$1.height_scale, c2.min_height *= Geo$1.height_scale), this.addMeshVariantForDraw(this.base, c2), c2;
            }
          }
        }, _preprocess: function(e) {
          e.color = StyleParser.createColorPropertyCache(e.color), e.width = StyleParser.createPropertyCache(e.width, StyleParser.parseUnits), e.width && e.width.type !== StyleParser.CACHE_TYPE.STATIC && (e.next_width = StyleParser.createPropertyCache(e.width, StyleParser.parseUnits)), e.z = StyleParser.createPropertyCache(e.z, StyleParser.parseUnits);
          var t2 = +e.antialias;
          return e.antialias = isNaN(t2) ? 0 : t2, e;
        }, buildRasterTextures: function(e, t2) {
          var r = [];
          for (var i2 in t2.meshes) {
            var n, o = this.getMeshVariantTypeForDraw({ variantKey: i2 }), a2 = o.uniforms, s = o.pattern;
            a2.u_dash_index && (n = "__dash_" + s.join("_") + "_" + e.key + "_" + e.id, r.push({ name: n, data: buildPatternBuffer(s, PATTERN_MAX_WIDTH) }), a2.u_dash_atlas = n, t2.meshes[i2].textures = [n]), t2.meshes[i2].uniforms = a2;
          }
          return t2.uniforms = t2.uniforms || {}, r.length ? WorkerBroker.postMessage(this.main_thread_target + ".loadTextures", r).then(function(e2) {
            return t2;
          }) : Promise.resolve(t2);
        }, loadTextures: function(e) {
          for (var t2 = [], r = 0; r < e.length; r++) {
            var i2 = e[r], n = (n = this.textureManager.textures[i2.name]) || this.textureManager.create(this.gl, i2.name, { filtering: "nearest", repeat: true, width: PATTERN_MAX_WIDTH, height: 1, data: i2.data });
            t2.push(n.loading);
          }
          return Promise.all(t2).then(function(e2) {
            return e2.map(function(e3) {
              return e3.retain(), e3.name;
            });
          });
        }, computeVariantForDraw: function(e) {
          var t2 = getHashForStyle(e);
          return { key: e.variantKey = t2, order: e.variant_order, uniforms: { u_antialias: e.antialias, u_linecaps: e.linecaps, u_linejoin: e.join, u_miter_limit: e.miter_limit, u_dash_index: e.dash_index, u_dash_caps: e.dash_caps, u_dash_phase: e.dash_phase, u_dash_period: e.dash_period }, pattern: e.dash };
        }, vertexLayoutForMeshVariant: function(e) {
          var t2;
          return null == PatternLines.vertex_layouts[e.key] && (t2 = [{ name: "a_position", size: 4, type: gl$1.SHORT, normalized: false }, { name: "a_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_width", size: 1, type: gl$1.FLOAT, normalized: false }, { name: "a_tangents", size: 4, type: gl$1.FLOAT, normalized: false }, { name: "a_segment", size: 2, type: gl$1.FLOAT, normalized: false }, { name: "a_angles", size: 2, type: gl$1.FLOAT, normalized: false }, { name: "a_texcoord", size: 2, type: gl$1.FLOAT, normalized: true }, { name: "a_length", size: 1, type: gl$1.FLOAT, normalized: false }, { name: "a_closed", size: 1, type: gl$1.FLOAT, normalized: false }, { name: "a_selection_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }], this.defines.TANGRAM_DEBUG_TRIANGLES && t2.push({ name: "a_barycentric", size: 3, type: gl$1.SHORT, normalized: false }), PatternLines.vertex_layouts[e.key] = new VertexLayout(t2)), PatternLines.vertex_layouts[e.key];
        }, makeVertexTemplate: function(e) {
          var t2 = 0;
          return this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = e.z + e.height || 0, this.vertex_template[t2++] = this.scaleOrder(e.order), this.vertex_template[t2++] = 255 * e.color[0], this.vertex_template[t2++] = 255 * e.color[1], this.vertex_template[t2++] = 255 * e.color[2], this.vertex_template[t2++] = 255 * e.color[3], this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.selection && (this.vertex_template[t2++] = 255 * e.selection_color[0], this.vertex_template[t2++] = 255 * e.selection_color[1], this.vertex_template[t2++] = 255 * e.selection_color[2], this.vertex_template[t2++] = 255 * e.selection_color[3]), this.defines.TANGRAM_DEBUG_TRIANGLES && (this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0, this.vertex_template[t2++] = 0), this.vertex_template;
        }, buildLines: function(e, t2, r, i2, n) {
          var o = 4 < arguments.length && void 0 !== n && n, a2 = r.vertex_data, s = a2.vertex_layout, l = this.makeVertexTemplate(t2, r);
          return buildPolylines$1(e, t2.width, a2, l, s.index, o);
        }, buildPolygons: function(e, t2, r, i2) {
          for (var n = 0, o = 0, a2 = e.length; o < a2; o++)
            n += this.buildLines(e[o], t2, r, i2, true);
          return n;
        } });
        var STICK_WIDTH = 1;
        function buildQuadsForPoints(e, t2, r, i2) {
          var n, o, a2, s, l, u2, c2 = i2.quad, h = i2.quad_normalize, f2 = i2.offset, d = i2.offsets, _ = i2.offsets_alt, p2 = i2.pre_angles, g = i2.pre_angles_alt, m = i2.angle, y = i2.angles, v = i2.angles_alt, x2 = i2.is_flat, b2 = i2.elevate_by_altitude, T2 = i2.build_stick_points, A2 = i2.color, E2 = i2.stick_color, w = i2.curve, S2 = i2.texcoord_scale, k = i2.texcoord_normalize, P2 = i2.pre_angles_normalize, R2 = i2.angles_normalize, M2 = i2.offsets_normalize, h = h || 1, L2 = c2[0] / 2 * h, O2 = c2[1] / 2 * h, C2 = [[-L2, -O2], [L2, -O2], [L2, O2], [-L2, O2]], N2 = t2.vertex_elements, I = t2.vertex_count, B2 = t2.vertex_layout.index, z2 = B2.a_texcoord, U2 = B2.a_position, F2 = B2.a_shape, G = B2.a_offset, D2 = B2.a_offsets, $ = B2.a_offsets_alt, j = B2.a_pre_angles, V = B2.a_pre_angles_alt, W2 = B2.a_angles, Y2 = B2.a_angles_alt, q = B2.a_is_flat, X2 = B2.a_is_stick, Z2 = B2.a_color;
          z2 && (k = k || 1, u2 = [[o = (n = _slicedToArray(S2 || default_uvs, 4))[0], a2 = n[1]], [s = n[2], a2], [s, l = n[3]], [o, l]]);
          for (var K2 = 0, J2 = e.length, Q = 0; Q < J2; Q++) {
            var ee2 = e[Q];
            if (T2) {
              for (var te2 = STICK_WIDTH / 2 * h, re2 = +h, ie2 = [[-te2, 0], [+te2, 0], [+te2, re2], [-te2, re2]], ne2 = 0; ne2 < 4; ne2++)
                z2 && (r[z2 + 0] = u2[ne2][0] * k, r[z2 + 1] = u2[ne2][1] * k), r[U2 + 0] = ee2[0], r[U2 + 1] = ee2[1], b2 && (r[U2 + 2] = MathUtils$1.clamp(ee2[2], 0, 32767)), r[F2 + 0] = ie2[ne2][0], r[F2 + 1] = ie2[ne2][1], r[F2 + 2] = 0, r[Z2 + 0] = E2[0], r[Z2 + 1] = E2[1], r[Z2 + 2] = E2[2], r[Z2 + 3] = E2[3], r[X2 + 0] = 255, t2.addVertex(r);
              N2.push(I + 0), N2.push(I + 1), N2.push(I + 2), N2.push(I + 2), N2.push(I + 3), N2.push(I + 0), I += 4, K2 += 2;
            }
            for (var oe2 = 0; oe2 < 4; oe2++)
              z2 && (r[z2 + 0] = u2[oe2][0] * k, r[z2 + 1] = u2[oe2][1] * k), r[U2 + 0] = ee2[0], r[U2 + 1] = ee2[1], b2 && (r[U2 + 2] = MathUtils$1.clamp(ee2[2], 0, 32767)), r[F2 + 0] = C2[oe2][0], r[F2 + 1] = C2[oe2][1], r[F2 + 2] = m, r[Z2 + 0] = A2[0], r[Z2 + 1] = A2[1], r[Z2 + 2] = A2[2], r[Z2 + 3] = A2[3], r[G + 0] = f2[0], r[G + 1] = f2[1], r[q + 0] = x2 ? 255 : 0, T2 && (r[X2 + 0] = 0), w && (r[j + 0] = P2 * p2[0], r[j + 1] = P2 * p2[1], r[j + 2] = P2 * p2[2], r[j + 3] = P2 * p2[3], r[W2 + 0] = R2 * y[0], r[W2 + 1] = R2 * y[1], r[W2 + 2] = R2 * y[2], r[W2 + 3] = R2 * y[3], r[D2 + 0] = M2 * d[0], r[D2 + 1] = M2 * d[1], r[D2 + 2] = M2 * d[2], r[D2 + 3] = M2 * d[3], _ && (r[$ + 0] = M2 * _[0], r[$ + 1] = M2 * _[1], r[$ + 2] = M2 * _[2], r[$ + 3] = M2 * _[3], r[V + 0] = P2 * g[0], r[V + 1] = P2 * g[1], r[V + 2] = P2 * g[2], r[V + 3] = P2 * g[3], r[Y2 + 0] = R2 * v[0], r[Y2 + 1] = R2 * v[1], r[Y2 + 2] = R2 * v[2], r[Y2 + 3] = R2 * v[3])), t2.addVertex(r);
            N2.push(I + 0), N2.push(I + 1), N2.push(I + 2), N2.push(I + 2), N2.push(I + 3), N2.push(I + 0), I += 4, K2 += 2;
          }
          return K2;
        }
        var id$2 = 0, Label = { id_prefix: "", nextLabelId: function() {
          return "".concat(Label.id_prefix, "/").concat(id$2++);
        } };
        function textLayoutToJSON(e) {
          return { priority: e.priority, collide: e.collide, repeat_distance: e.repeat_distance, repeat_group: e.repeat_group, buffer: e.buffer, italic: e.italic };
        }
        var lefts = ["left", "top-left", "bottom-left"], rights = ["right", "top-right", "bottom-right"], tops = ["top", "top-left", "top-right"], bottoms = ["bottom", "bottom-left", "bottom-right"], PointAnchor, PointAnchor$1 = PointAnchor = { computeOffset: function(e, t2, r, i2) {
          var n = 3 < arguments.length && void 0 !== i2 ? i2 : null;
          if (!r || "center" === r)
            return e;
          var o = [e[0], e[1]], n = n || this.default_buffer;
          return this.isLeftAnchor(r) ? (o[0] -= t2[0] / 2, "left" === r && (o[0] -= n[0])) : this.isRightAnchor(r) && (o[0] += t2[0] / 2, "right" === r && (o[0] += n[1])), this.isTopAnchor(r) ? (o[1] -= t2[1] / 2, "top" === r && (o[1] -= n[2])) : this.isBottomAnchor(r) && (o[1] += t2[1] / 2, "bottom" === r && (o[1] += n[3])), o;
        }, alignForAnchor: function(e) {
          if (e && "center" !== e) {
            if (this.isLeftAnchor(e))
              return "right";
            if (this.isRightAnchor(e))
              return "left";
          }
          return "center";
        }, isLeftAnchor: function(e) {
          return -1 < lefts.indexOf(e);
        }, isRightAnchor: function(e) {
          return -1 < rights.indexOf(e);
        }, isTopAnchor: function(e) {
          return -1 < tops.indexOf(e);
        }, isBottomAnchor: function(e) {
          return -1 < bottoms.indexOf(e);
        }, default_buffer: [2.5, 2.5, 1.5, 0.75], zero_buffer: [0, 0, 0, 0] };
        function encircleLine(e, t2, r, i2, n) {
          var o = [], a2 = r - e, s = i2 - t2, l = MathUtils$1.getLineLength(e, t2, r, i2), u2 = 2 * n;
          if ((c2 = l / u2) <= 1)
            o.push(e + a2 / 2, t2 + s / 2, n);
          else {
            var c2, h = u2 / l, f2 = a2 * h, d = s * h;
            (c2 = l / n / 2) % 1 && o.push(r - f2 / 2, i2 - d / 2, n), c2 |= 0;
            for (var _ = e + f2 / 2, p2 = t2 + d / 2; c2--; )
              o.push(_, p2, n), _ += f2, p2 += d;
          }
          return o;
        }
        var LabelPoint = function() {
          function n(e, t2, r, i2) {
            _classCallCheck(this, n), this.id = Label.nextLabelId(), this.position = [e[0], e[1]], void 0 !== e[2] && this.position.push(e[2]), this.size = t2, this.layout = i2, this.anchor = Array.isArray(this.layout.anchor) ? this.layout.anchor[0] : this.layout.anchor, this.placed = null, this.type = "point", this.parent = this.layout.parent, this.offset = this.computeOffset(), this.align = this.layout.align || PointAnchor$1.alignForAnchor(this.anchor), this._is_flat = r;
          }
          return _createClass(n, [{ key: "toJSON", value: function() {
            return { id: this.id, type: this.type, is_flat: this._is_flat, position: this.position, size: this.size, offset: this.offset, align: this.align, sides: this.getSides(), breach: !this.inTileBounds(), layout: textLayoutToJSON(this.layout) };
          } }, { key: "inTileBounds", value: function() {
            var e = this.getAABB(), t2 = e.left, r = e.top, i2 = e.right, n2 = e.bottom;
            return Utils$1.pointInTile([t2, r]) && Utils$1.pointInTile([i2, n2]);
          } }, { key: "isFlat", value: function() {
            return this._is_flat;
          } }, { key: "setAnchor", value: function(e) {
            this._circles = void 0, this._aabb = void 0, this.anchor = e, this.offset = this.computeOffset();
          } }, { key: "computeOffset", value: function() {
            var e, t2 = [this.layout.offset[0], this.layout.offset[1]];
            return this.parent && (e = this.parent, t2 = PointAnchor$1.computeOffset(t2, e.size, e.anchor, PointAnchor$1.zero_buffer), t2 = PointAnchor$1.computeOffset(t2, e.size, this.anchor, PointAnchor$1.zero_buffer), e.offset !== StyleParser.zeroPair && (t2 === StyleParser.zeroPair ? t2 = e.offset : (t2[0] += e.offset[0], t2[1] += e.offset[1]))), PointAnchor$1.computeOffset(t2, this.size, this.anchor);
          } }, { key: "getBoundingCircles", value: function() {
            return this.angle ? (this._circles || (e = this.layout.units_per_pixel, n2 = -(r = (t2 = this.size[0] / 2 * e) * Math.cos(this.angle)), o = -(i2 = t2 * Math.sin(this.angle)), s = (a2 = _slicedToArray(this.position, 2))[0], l = a2[1], r += s, i2 += l *= -1, n2 += s, o += l, u2 = this.size[1] / 2 * e, this._circles = encircleLine(r, i2, n2, o, u2)), this._circles) : [];
            var e, t2, r, i2, n2, o, a2, s, l, u2;
          } }, { key: "getAABB", value: function() {
            var e, t2, r, i2, n2;
            return this._aabb || (e = this.layout.units_per_pixel, t2 = (this.size[0] / 2 + this.layout.buffer[0]) * e, r = (this.size[1] / 2 + this.layout.buffer[1]) * e, i2 = this.position[0] + this.offset[0] * e, n2 = this.position[1] - this.offset[1] * e, this._aabb = { left: i2 - t2, top: n2 + r, right: i2 + t2, bottom: n2 - r }), this._aabb;
          } }, { key: "getSides", value: function() {
            var e = this.getAABB(), t2 = e.left, r = e.top, i2 = e.right, n2 = (r + e.bottom) / 2;
            return [t2, n2, i2, n2];
          } }]), n;
        }();
        LabelPoint.PLACEMENT = { VERTEX: 0, MIDPOINT: 1, SPACED: 2, CENTROID: 3 };
        var PLACEMENT = LabelPoint.PLACEMENT, default_spacing = 80, TextSettings;
        function placePointsOnLine(e, t2, r, i2) {
          var n = [], o = i2.placement, a2 = Math.max(t2[0], t2[1]) * i2.placement_min_length_ratio * i2.units_per_pixel;
          switch (o) {
            case PLACEMENT.SPACED:
              var s = getPositionsAndAngles(e, a2, i2);
              if (!s)
                return [];
              for (var l = s.positions, u2 = s.angles, c2 = 0; c2 < l.length; c2++) {
                var h, f2 = l[c2], d = u2[c2];
                true !== i2.tile_edges && isCoordOutsideTile(f2) || ((h = new LabelPoint(f2, t2, r, i2)).angle = d, n.push(h));
              }
              break;
            case PLACEMENT.VERTEX:
              for (var _, p2, g, m = 0; m < e.length - 1; m++)
                _ = e[m], p2 = e[m + 1], true !== i2.tile_edges && isCoordOutsideTile(_) || ((g = new LabelPoint(_, t2, r, i2)).angle = getAngle(_, p2, i2.angle), n.push(g));
              (g = new LabelPoint(p2, t2, r, i2)).angle = getAngle(_, p2, i2.angle), n.push(g);
              break;
            case PLACEMENT.MIDPOINT:
              for (var y = 0; y < e.length - 1; y++) {
                var v, x2 = e[y], b2 = e[y + 1], T2 = [0.5 * (x2[0] + b2[0]), 0.5 * (x2[1] + b2[1])];
                true !== i2.tile_edges && isCoordOutsideTile(T2) || (!a2 || norm(x2, b2) > a2) && ((v = new LabelPoint(T2, t2, r, i2)).angle = getAngle(x2, b2, i2.angle), n.push(v));
              }
          }
          return n;
        }
        function getPositionsAndAngles(e, t2, r) {
          var i2 = r.units_per_pixel, n = (r.placement_spacing || default_spacing) * i2, o = getLineLength(e);
          if (o <= t2)
            return false;
          for (var a2 = Math.max(Math.floor(o / n), 1), s = [], l = [], u2 = 0.5 * (o - (a2 - 1) * n), c2 = 0; c2 < a2; c2++) {
            var h = interpolateLine(e, u2, t2, r), f2 = h.position, d = h.angle;
            null != f2 && null != d && (s.push(f2), l.push(d)), u2 += n;
          }
          return { positions: s, angles: l };
        }
        function getAngle(e, t2) {
          var r = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : 0;
          return "auto" === r ? Math.atan2(t2[0] - e[0], t2[1] - e[1]) : r;
        }
        function getLineLength(e) {
          for (var t2 = 0, r = 0; r < e.length - 1; r++)
            t2 += norm(e[r], e[r + 1]);
          return t2;
        }
        function norm(e, t2) {
          return Math.sqrt(Math.pow(e[0] - t2[0], 2) + Math.pow(e[1] - t2[1], 2));
        }
        function interpolateLine(e, t2, r, i2) {
          for (var n, o, a2 = 0, s = 0; s < e.length - 1; s++) {
            var l = e[s], u2 = e[s + 1], c2 = norm(l, u2);
            if (!(c2 <= r) && t2 < (a2 += c2)) {
              n = interpolateSegment(l, u2, a2 - t2), o = getAngle(l, u2, i2.angle);
              break;
            }
          }
          return { position: n, angle: o };
        }
        function interpolateSegment(e, t2, r) {
          var i2 = r / norm(e, t2);
          return [i2 * e[0] + (1 - i2) * t2[0], i2 * e[1] + (1 - i2) * t2[1]];
        }
        var TextSettings$1 = TextSettings = { key: function(e) {
          return [e.style, e.weight, e.family, e.px_size, e.fill, e.stroke, e.stroke_width, e.transform, e.text_wrap, e.max_lines, e.supersample, e.background_color, e.outline_color, e.outline_width, e.padding, Utils$1.device_pixel_ratio].join("/");
        }, defaults: { style: "normal", weight: null, size: "12px", px_size: 12, family: "Helvetica", fill: "white", text_wrap: 15, max_lines: 5, align: "center", stroke: null, stroke_width: 0, background_color: null, outline_color: null, outline_width: 0, padding: [0, 0, 0, 0] }, compute: function(e, t2, r) {
          var i2 = {};
          if (t2.font = t2.font || this.defaults, i2.can_articulate = t2.can_articulate, i2.fill = t2.font.fill && Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(t2.font.fill, r)) || this.defaults.fill, i2.style = t2.font.style || this.defaults.style, i2.weight = t2.font.weight || this.defaults.weight, t2.font.family ? (i2.family = t2.font.family, i2.family !== this.defaults.family && (i2.family += ", " + this.defaults.family)) : i2.family = this.defaults.family, i2.transform = t2.font.transform, i2.size = t2.font.size || this.defaults.size, i2.supersample = t2.supersample_text ? 1.5 : 1, i2.px_size = StyleParser.evalCachedProperty(t2.font.px_size, r) * i2.supersample, 0 !== i2.px_size) {
            t2.font.stroke && t2.font.stroke.color && (i2.stroke = Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(t2.font.stroke.color, r) || this.defaults.stroke), i2.stroke_width = StyleParser.evalCachedProperty(t2.font.stroke.width, r) || this.defaults.stroke_width), i2.font_css = this.fontCSS(i2);
            var n = t2.text_wrap;
            return null == n && "line" !== Geo$1.geometryType(e.geometry.type) && (n = true), true === n && (n = this.defaults.text_wrap), i2.text_wrap = n, i2.max_lines = t2.max_lines || this.defaults.max_lines, i2.background_color = t2.background && t2.background.color && !t2.can_articulate ? Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(t2.background.color, r)) : this.defaults.background_color, i2.outline_color = t2.outline && t2.outline.color && !t2.can_articulate ? Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(t2.outline.color, r)) : this.defaults.outline_color, i2.outline_width = t2.outline && t2.outline.width && !t2.can_articulate ? StyleParser.evalCachedProperty(t2.outline.width, r) : this.defaults.outline_width, i2.padding = t2.padding && !t2.can_articulate ? StyleParser.evalCachedProperty(t2.padding, r) : this.defaults.padding, i2;
          }
        }, fontCSS: function(e) {
          return [e.style, e.weight, e.px_size + "px", e.family].filter(function(e2) {
            return e2;
          }).join(" ");
        } }, fontfaceobserver_standalone = createCommonjsModule(function(e) {
          function n(e2, t3) {
            document.addEventListener ? e2.addEventListener("scroll", t3, false) : e2.attachEvent("scroll", t3);
          }
          function v(e2) {
            this.a = document.createElement("div"), this.a.setAttribute("aria-hidden", "true"), this.a.appendChild(document.createTextNode(e2)), this.b = document.createElement("span"), this.c = document.createElement("span"), this.h = document.createElement("span"), this.f = document.createElement("span"), this.g = -1, this.b.style.cssText = "max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;", this.c.style.cssText = "max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;", this.f.style.cssText = "max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;", this.h.style.cssText = "display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;", this.b.appendChild(this.h), this.c.appendChild(this.f), this.a.appendChild(this.b), this.a.appendChild(this.c);
          }
          function x2(e2, t3) {
            e2.a.style.cssText = "max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:" + t3 + ";";
          }
          function o(e2) {
            var t3 = e2.a.offsetWidth, r2 = t3 + 100;
            return e2.f.style.width = r2 + "px", e2.c.scrollLeft = r2, e2.b.scrollLeft = e2.b.scrollWidth + 100, e2.g !== t3 && (e2.g = t3, 1);
          }
          function b2(e2, t3) {
            function r2() {
              var e3 = i3;
              o(e3) && e3.a.parentNode && t3(e3.g);
            }
            var i3 = e2;
            n(e2.b, r2), n(e2.c, r2), o(e2);
          }
          function t2(e2, t3) {
            var r2 = t3 || {};
            this.family = e2, this.style = r2.style || "normal", this.weight = r2.weight || "normal", this.stretch = r2.stretch || "normal";
          }
          function T2(e2, t3) {
            return [e2.style, e2.weight, function() {
              if (null === r) {
                var e3 = document.createElement("div");
                try {
                  e3.style.font = "condensed 100px sans-serif";
                } catch (e4) {
                }
                r = "" !== e3.style.font;
              }
              return r;
            }() ? e2.stretch : "", "100px", t3].join(" ");
          }
          var A2, i2, r, a2;
          a2 = r = i2 = A2 = null, t2.prototype.load = function(e2, t3) {
            var _ = this, p2 = e2 || "BESbswy", g = 0, m = t3 || 3e3, y = (/* @__PURE__ */ new Date()).getTime();
            return new Promise(function(f2, d) {
              var e3, t4, r2;
              null === a2 && (a2 = !!document.fonts), (e3 = a2) && (null === i2 && (i2 = /OS X.*Version\/10\..*Safari/.test(navigator.userAgent) && /Apple/.test(navigator.vendor)), e3 = !i2), e3 ? (e3 = new Promise(function(r3, e4) {
                !function t5() {
                  (/* @__PURE__ */ new Date()).getTime() - y >= m ? e4() : document.fonts.load(T2(_, '"' + _.family + '"'), p2).then(function(e5) {
                    1 <= e5.length ? r3() : setTimeout(t5, 25);
                  }, function() {
                    e4();
                  });
                }();
              }), t4 = new Promise(function(e4, t5) {
                g = setTimeout(t5, m);
              }), Promise.race([t4, e3]).then(function() {
                clearTimeout(g), f2(_);
              }, function() {
                d(_);
              })) : (r2 = function() {
                function t5() {
                  var e4;
                  (e4 = -1 != o2 && -1 != a3 || -1 != o2 && -1 != s || -1 != a3 && -1 != s) && ((e4 = o2 != a3 && o2 != s && a3 != s) || (null === A2 && (e4 = /AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent), A2 = !!e4 && (parseInt(e4[1], 10) < 536 || 536 === parseInt(e4[1], 10) && parseInt(e4[2], 10) <= 11)), e4 = A2 && (o2 == l && a3 == l && s == l || o2 == u2 && a3 == u2 && s == u2 || o2 == c2 && a3 == c2 && s == c2)), e4 = !e4), e4 && (h.parentNode && h.parentNode.removeChild(h), clearTimeout(g), f2(_));
                }
                var r3 = new v(p2), i3 = new v(p2), n2 = new v(p2), o2 = -1, a3 = -1, s = -1, l = -1, u2 = -1, c2 = -1, h = document.createElement("div");
                h.dir = "ltr", x2(r3, T2(_, "sans-serif")), x2(i3, T2(_, "serif")), x2(n2, T2(_, "monospace")), h.appendChild(r3.a), h.appendChild(i3.a), h.appendChild(n2.a), document.body.appendChild(h), l = r3.a.offsetWidth, u2 = i3.a.offsetWidth, c2 = n2.a.offsetWidth, function H2() {
                  var e4;
                  (/* @__PURE__ */ new Date()).getTime() - y >= m ? (h.parentNode && h.parentNode.removeChild(h), d(_)) : (true !== (e4 = document.hidden) && void 0 !== e4 || (o2 = r3.a.offsetWidth, a3 = i3.a.offsetWidth, s = n2.a.offsetWidth, t5()), g = setTimeout(H2, 50));
                }(), b2(r3, function(e4) {
                  o2 = e4, t5();
                }), x2(r3, T2(_, '"' + _.family + '",sans-serif')), b2(i3, function(e4) {
                  a3 = e4, t5();
                }), x2(i3, T2(_, '"' + _.family + '",serif')), b2(n2, function(e4) {
                  s = e4, t5();
                }), x2(n2, T2(_, '"' + _.family + '",monospace'));
              }, document.body ? r2() : document.addEventListener ? document.addEventListener("DOMContentLoaded", function e4() {
                document.removeEventListener("DOMContentLoaded", e4), r2();
              }) : document.attachEvent("onreadystatechange", function e4() {
                "interactive" != document.readyState && "complete" != document.readyState || (document.detachEvent("onreadystatechange", e4), r2());
              }));
            });
          }, e.exports = t2;
        }), FontManager = { fonts_loaded: Promise.resolve(), last_loaded: null, loadFonts: function(i2) {
          var n = this, e = JSON.stringify(i2) === this.last_loaded;
          return i2 && !e && function() {
            var r = [];
            for (var e2 in i2)
              !function(t2) {
                Array.isArray(i2[t2]) ? i2[t2].forEach(function(e3) {
                  return r.push(n.loadFontFace(t2, e3));
                }) : r.push(n.loadFontFace(t2, i2[t2]));
              }(e2);
            n.last_loaded = JSON.stringify(i2), n.fonts_loaded = Promise.all(r.filter(function(e3) {
              return e3;
            }));
          }(), this.fonts_loaded;
        }, loadFontFace: function(e, t2) {
          if (null != t2 && ("object" === _typeof(t2) || "external" === t2)) {
            var r = { family: e }, i2 = Promise.resolve();
            "object" === _typeof(t2) && (Object.assign(r, t2), "string" == typeof t2.url && (i2 = this.injectFontFace(r)));
            var n = new fontfaceobserver_standalone(e, r);
            return i2.then(function() {
              return n.load();
            }).then(function() {
              log("debug", "Font face '".concat(e, "' is available"), r);
            }, function() {
              log("debug", "Font face '".concat(e, "' is NOT available"), r);
            });
          }
        }, injectFontFace: function(e) {
          var n = this, o = e.family, t2 = e.url, a2 = e.weight, s = e.style;
          void 0 === this.supports_native_font_loading && (this.supports_native_font_loading = void 0 !== window.FontFace);
          var r = Promise.resolve(t2);
          return "blob:" === t2.slice(0, 5) && (r = Utils$1.io(t2, 6e4, "arraybuffer").then(function(e2) {
            var t3 = new Uint8Array(e2);
            if (n.supports_native_font_loading)
              return t3;
            for (var r2 = "", i2 = 0; i2 < t3.length; i2++)
              r2 += String.fromCharCode(t3[i2]);
            return "data:font/opentype;base64," + btoa(r2);
          })), r.then(function(e2) {
            var t3, r2, i2;
            n.supports_native_font_loading ? ("string" == typeof e2 ? t3 = new FontFace(o, "url(".concat(encodeURI(e2), ")"), { weight: a2, style: s }) : e2 instanceof Uint8Array && (t3 = new FontFace(o, e2, { weight: a2, style: s })), document.fonts.add(t3), log("trace", "Adding FontFace to document.fonts:", t3)) : (r2 = "\n                    @font-face {\n                        font-family: '".concat(o, "';\n                        font-weight: ").concat(a2 || "normal", ";\n                        font-style: ").concat(s || "normal", ";\n                        src: url(").concat(encodeURI(e2), ");\n                    }\n                "), (i2 = document.createElement("style")).appendChild(document.createTextNode("")), document.head.appendChild(i2), i2.sheet.insertRule(r2, 0), log("trace", "Injecting CSS font face:", r2));
          });
        } }, CanvasText = function() {
          function S2() {
            _classCallCheck(this, S2), this.vertical_text_buffer = 1, this.horizontal_text_buffer = 1, this.layout = layout("binary-tree");
          }
          return _createClass(S2, [{ key: "createCanvas", value: function(e, t2) {
            var r = document.createElement("canvas");
            return e && t2 && (r.width = e, r.height = t2), r.style.backgroundColor = "transparent", r;
          } }, { key: "setFont", value: function(e, t2) {
            var r = t2.font_css, i2 = t2.fill, n = t2.stroke, o = t2.stroke_width, a2 = t2.px_size, s = t2.supersample;
            this.px_size = a2;
            var l = Utils$1.device_pixel_ratio * s;
            n && 0 < o && (e.strokeStyle = n, e.lineWidth = o * l), e.fillStyle = i2, e.textBaseline = "bottom", e.font = r, e.miterLimit = 2;
          } }, { key: "textSizes", value: function(e, t2, r) {
            var i2 = this;
            return FontManager.loadFonts().then(function() {
              return Task.add({ type: "textSizes", run: i2.processTextSizesTask.bind(i2), texts: t2, tile_id: e, cursor: { ctx: r, styles: Object.keys(t2), texts: null, style_idx: null, text_idx: null } });
            });
          } }, { key: "processTextSizesTask", value: function(e) {
            var t2 = e.cursor, r = e.texts, i2 = t2.ctx;
            for (t2.style_idx = t2.style_idx || 0; t2.style_idx < t2.styles.length; ) {
              var n = t2.styles[t2.style_idx];
              null == t2.text_idx && (t2.text_idx = 0, t2.texts = Object.keys(r[n]));
              for (var o = r[n], a2 = true; t2.text_idx < t2.texts.length; ) {
                var s = t2.texts[t2.text_idx], l = o[s], u2 = l.text_settings;
                if (a2 && (this.setFont(i2, u2), a2 = false), l.size = this.textSize(i2, n, s, u2).size, u2.can_articulate) {
                  var c2 = false, h = false;
                  if (isTextRTL(s) && (isTextNeutral(s) ? c2 = true : h = true), l.isRTL = c2, l.no_curving = h || isTextCurveBlacklisted(s), l.vertical_buffer = this.vertical_text_buffer + u2.outline_width + (u2.padding[0] + u2.padding[2]) / 2, l.segment_sizes = [], !l.no_curving) {
                    var f2 = splitLabelText(s, c2);
                    l.segments = f2;
                    for (var d = 0; d < f2.length; d++)
                      l.segment_sizes.push(this.textSize(i2, n, f2[d], u2).size);
                  }
                }
                if (t2.text_idx++, !Task.shouldContinue(e))
                  return false;
              }
              t2.text_idx = null, t2.style_idx++;
            }
            return Task.finish(e, { texts: r }), true;
          } }, { key: "textSize", value: function(e, t2, r, i2) {
            var n = i2.transform, o = i2.text_wrap, a2 = i2.max_lines, s = i2.stroke_width, l = void 0 === s ? 0 : s, u2 = i2.supersample, c2 = i2.padding, h = i2.outline_width, f2 = i2.can_articulate;
            if (S2.cache.text[t2] = S2.cache.text[t2] || {}, S2.cache.text[t2][r])
              return S2.cache.stats.text_hits++, S2.cache.text[t2][r];
            S2.cache.stats.text_misses++, S2.cache.text_count++;
            var d = Utils$1.device_pixel_ratio * u2, _ = this.applyTextTransform(r, n), p2 = d * (this.vertical_text_buffer + h + (c2[0] + c2[2]) / 2), g = d * (this.horizontal_text_buffer + h + l + (c2[1] + c2[3]) / 2), m = 2 * d, y = this.px_size + m, v = MultiLine.parse(_, o, a2, y, e), x2 = v.height, b2 = v.width, T2 = v.lines, A2 = [b2 / d, x2 / d];
            f2 || (A2[0] += 2 * g / d, A2[1] += 2 * p2 / d);
            var E2 = [b2 + 2 * g, x2 + 2 * p2], w = [E2[0] / d, E2[1] / d];
            return S2.cache.text[t2][r] = { lines: T2, size: { collision_size: A2, texture_size: E2, logical_size: w, line_height: y } }, S2.cache.text[t2][r];
          } }, { key: "drawTextMultiLine", value: function(e, t2, r, i2, n, o) {
            var a2 = _slicedToArray(r, 2), s = a2[0], l = a2[1], u2 = Utils$1.device_pixel_ratio * n.supersample, c2 = n.stroke_width || 0, h = n.stroke;
            n.background_color && (e.fillStyle = n.background_color, e.fillRect(s, l, i2.texture_size[0], i2.texture_size[1]));
            var f2 = n.outline_width * u2, d = n.outline_color;
            f2 && d && (e.strokeStyle = d, e.lineWidth = f2, e.strokeRect(s + f2 / 2, l + f2 / 2, i2.texture_size[0] - f2, i2.texture_size[1] - f2)), (n.background_color || f2 && d) && this.setFont(e, n);
            for (var _, p2, g, m, y = i2.line_height, v = l, x2 = 0; x2 < t2.length; x2++) {
              var b2 = t2[x2];
              this.drawTextLine(e, b2, [s, v], i2, n, o), v += y;
            }
            debugSettings$1.draw_label_collision_boxes && (e.save(), _ = u2 * (this.horizontal_text_buffer + n.outline_width + c2 + (n.padding[1] + n.padding[3]) / 2), p2 = u2 * (this.vertical_text_buffer + n.outline_width + (n.padding[0] + n.padding[2]) / 2), g = i2.collision_size, e.strokeStyle = "blue", e.lineWidth = 2, e.strokeRect(s + _, l + p2, u2 * g[0], u2 * g[1]), "curved" === o && h && 0 < c2 && e.strokeRect(s + i2.texture_size[0] + _, l + p2, u2 * g[0], u2 * g[1]), e.restore()), debugSettings$1.draw_label_texture_boxes && (e.save(), m = i2.texture_size, e.strokeStyle = "green", e.lineWidth = 2, e.strokeRect(s + 2, l + 2, m[0] - 4, m[1] - 4), "curved" === o && h && 0 < c2 && e.strokeRect(s + 2 + i2.texture_size[0], l + 2, m[0] - 4, m[1] - 4), e.restore());
          } }, { key: "drawTextLine", value: function(e, t2, r, i2, n, o) {
            var a2, s = _slicedToArray(r, 2), l = s[0], u2 = s[1], c2 = n.stroke, h = n.stroke_width, f2 = void 0 === h ? 0 : h, d = n.transform, _ = n.align, p2 = n.supersample, g = n.padding, m = n.outline_width, y = Utils$1.device_pixel_ratio * p2, _ = _ || "center", v = i2.texture_size, x2 = i2.line_height, b2 = y * (this.vertical_text_buffer + m), T2 = y * (this.horizontal_text_buffer + m + f2), A2 = this.applyTextTransform(t2.text, d);
            "left" === _ ? a2 = l + T2 + g[3] * y : "center" === _ ? a2 = l + v[0] / 2 - t2.width / 2 - (g[1] - g[3]) * y / 2 : "right" === _ && (a2 = l + v[0] - t2.width - T2 - g[1] * y);
            var E2, w = u2 + b2 + x2 + g[0] * y;
            c2 && 0 < f2 && (E2 = "curved" === o ? v[0] : 0, e.strokeText(A2, a2 + E2, w)), e.fillText(A2, a2, w);
          } }, { key: "rasterize", value: function(e, t2, r, i2, n, o) {
            return Task.removeForTile(r), Task.add({ type: "rasterizeLabels", run: this.processRasterizeTask.bind(this), cancel: S2.returnNoTextures, pause_factor: 2, user_moving_view: false, texts: e, textures: t2, texture_prefix: i2, gl: n, tile_id: r, texture_manager: o, cursor: { styles: Object.keys(e), texts: null, style_idx: 0, text_idx: null, texture_idx: 0, texture_names: [] } });
          } }, { key: "processRasterizeTask", value: function(e) {
            if (!Task.shouldContinue(e))
              return false;
            for (var t2 = e.cursor, r = e.texts, i2 = e.textures; t2.texture_idx < e.textures.length; ) {
              for (var n = false, o = i2[t2.texture_idx], a2 = this.createCanvas.apply(this, _toConsumableArray(o.texture_size)), s = a2.getContext("2d"); t2.style_idx < t2.styles.length; ) {
                var l = t2.styles[t2.style_idx];
                null == t2.text_idx && (t2.text_idx = 0, t2.texts = Object.keys(r[l]));
                for (var u2 = r[l], c2 = true; t2.text_idx < t2.texts.length; ) {
                  var h = t2.texts[t2.text_idx], f2 = u2[h], d = f2.text_settings;
                  if (c2 && (this.setFont(s, d), c2 = false), d.can_articulate) {
                    f2.texcoords = f2.texcoords || {};
                    for (var _ = 0; _ < f2.type.length; _++) {
                      var p2 = f2.type[_];
                      switch (p2) {
                        case "straight":
                          if (f2.textures[_] !== t2.texture_idx)
                            continue;
                          var g, m, y, v, x2 = f2.isRTL ? h.split().reverse().join() : h, b2 = o.texcoord_cache[l][x2], T2 = void 0;
                          b2.texcoord ? T2 = b2.texcoord : (g = b2.texture_position, y = (m = this.textSize(s, l, x2, d)).size, v = m.lines, this.drawTextMultiLine(s, v, g, y, d, p2), T2 = e.texture_manager.getTexcoordsForSprite(g, y.texture_size, o.texture_size), b2.texcoord = T2), f2.texcoords[p2] = { texcoord: T2, texture_id: b2.texture_id };
                          break;
                        case "curved":
                          var A2 = f2.segments;
                          f2.texcoords.curved = [], f2.texcoords_stroke = [];
                          for (var E2, w, S3, k, P2, R2, M2, L2, O2 = 0; O2 < A2.length; O2++) {
                            f2.textures[_][O2] === t2.texture_idx && (E2 = A2[O2], k = S3 = void 0, (w = o.texcoord_cache[l][E2]).texcoord && w.texcoord_stroke ? (S3 = w.texcoord, k = w.texcoord_stroke) : (P2 = w.texture_position, M2 = (R2 = this.textSize(s, l, E2, d)).size, L2 = R2.lines, this.drawTextMultiLine(s, L2, P2, M2, d, p2), S3 = e.texture_manager.getTexcoordsForSprite(P2, M2.texture_size, o.texture_size), k = d.stroke && 0 < d.stroke_width ? e.texture_manager.getTexcoordsForSprite([P2[0] + M2.texture_size[0], P2[1]], M2.texture_size, o.texture_size) : (n = true, e.texture_manager.getTexcoordsForSprite([o.texture_size[0], o.texture_size[1]], [0, 0], o.texture_size)), w.texcoord = S3, w.texcoord_stroke = k), f2.texcoords_stroke.push(k), f2.texcoords.curved.push({ texcoord: S3, texture_id: w.texture_id }));
                          }
                      }
                    }
                  } else {
                    var C2 = this.textSize(s, l, h, d).lines;
                    for (var N2 in f2.align)
                      f2.align[N2].texture_id === t2.texture_idx && (this.drawTextMultiLine(s, C2, f2.align[N2].texture_position, f2.size, { stroke: d.stroke, stroke_width: d.stroke_width, transform: d.transform, supersample: d.supersample, align: N2, background_color: d.background_color, outline_width: d.outline_width, outline_color: d.outline_color, padding: d.padding, fill: d.fill, font_css: d.font_css, px_size: d.px_size }), f2.align[N2].texcoords = e.texture_manager.getTexcoordsForSprite(f2.align[N2].texture_position, f2.size.texture_size, o.texture_size));
                  }
                  t2.text_idx++;
                }
                t2.text_idx = null, t2.style_idx++;
              }
              true === n && (s.fillStyle = "rgba(0, 0, 0, 0)", s.fillRect(a2.width - 1, a2.height - 1, 1, 1));
              var I = e.texture_prefix + t2.texture_idx;
              e.texture_manager.create(e.gl, I, { element: a2, filtering: "linear", UNPACK_PREMULTIPLY_ALPHA_WEBGL: true }), t2.texture_names.push(I), t2.texture_idx++, t2.style_idx = 0, a2.width = 0, a2.height = 0;
            }
            return Task.finish(e, t2.texture_names), true;
          } }, { key: "setTextureTextPositions", value: function(e) {
            var t2 = { texture_id: 0, texcoord_cache: {} }, r = [];
            for (var i2 in e) {
              var n = e[i2];
              for (var o in n) {
                var a2 = n[o], s = a2.text_settings, l = s.can_articulate, u2 = s.stroke, c2 = s.stroke_width;
                if (l) {
                  a2.textures = [], t2.texcoord_cache[i2] = t2.texcoord_cache[i2] || {};
                  for (var h = 0; h < a2.type.length; h++) {
                    switch (a2.type[h]) {
                      case "straight":
                        var f2, d = a2.isRTL ? o.split().reverse().join() : o;
                        t2.texcoord_cache[i2][d] || (f2 = a2.size.texture_size, t2.texcoord_cache[i2][d] = {}, this.placeText(f2[0], f2[1], { can_articulate: l, style: i2, word: d })), a2.textures[h] = t2.texture_id;
                        break;
                      case "curved":
                        a2.textures[h] = [];
                        for (var _ = 0; _ < a2.segment_sizes.length; _++) {
                          var p2, g, m = a2.segments[_];
                          t2.texcoord_cache[i2][m] || (g = (p2 = a2.segment_sizes[_].texture_size)[0], u2 && 0 < c2 && (g *= 2), t2.texcoord_cache[i2][m] = {}, this.placeText(g, p2[1], { can_articulate: l, style: i2, word: m })), a2.textures[h].push(t2.texture_id);
                        }
                    }
                  }
                } else {
                  var y = a2.size.texture_size;
                  this.placeText(y[0], y[1], { can_articulate: l, text_info: a2 });
                }
              }
            }
            var v = this.layout.export(), x2 = v.items, b2 = v.width, T2 = v.height;
            t2.texcoord_cache = {};
            for (var A2 = 0, E2 = x2.length; A2 < E2; A2++) {
              var w = x2[A2], S3 = w.x, k = w.y;
              if (!w.meta.can_articulate) {
                var P2 = w.meta.text_info;
                for (var R2 in P2.align)
                  P2.align[R2].texture_id = t2.texture_id, P2.align[R2].texture_position = [S3, k];
              } else {
                var M2 = w.meta, L2 = M2.style, O2 = M2.word;
                t2.texcoord_cache[L2] = t2.texcoord_cache[L2] || {}, t2.texcoord_cache[L2][O2] || (t2.texcoord_cache[L2][O2] = { texture_id: t2.texture_id, texture_position: [S3, k] });
              }
            }
            return 0 < b2 && 0 < T2 && (r[t2.texture_id] = { texture_size: [b2, T2], texcoord_cache: t2.texcoord_cache }), r;
          } }, { key: "placeText", value: function(e, t2, r) {
            this.layout.addItem({ width: e + this.vertical_text_buffer, height: t2 + this.vertical_text_buffer, meta: r });
          } }, { key: "applyTextTransform", value: function(e, t2) {
            return "capitalize" === t2 ? e.replace(/\w\S*/g, function(e2) {
              return e2.charAt(0).toUpperCase() + e2.substr(1);
            }) : "uppercase" === t2 ? e.toUpperCase() : "lowercase" === t2 ? e.toLowerCase() : e;
          } }], [{ key: "fontPixelSize", value: function(e) {
            if (null != e) {
              var t2 = _slicedToArray((e = "string" == typeof e ? e : String(e)).match(S2.font_size_re) || [], 3), r = t2[1], i2 = t2[2];
              return "em" === (i2 = i2 || "px") ? r *= 16 : "pt" === i2 ? r /= 0.75 : "%" === i2 && (r /= 6.25), r = StyleParser.parsePositiveNumber(r), r *= Utils$1.device_pixel_ratio;
            }
          } }, { key: "pruneTextCache", value: function() {
            S2.cache.text_count > S2.cache.text_count_max && (S2.cache.text = {}, S2.cache.text_count = 0, log("debug", "CanvasText: pruning text cache")), Object.keys(S2.cache.segment).length > S2.cache.segment_count_max && (S2.cache.segment = {}, log("debug", "CanvasText: pruning segment cache"));
          } }]), S2;
        }();
        CanvasText.font_size_re = /((?:[0-9]*\.)?[0-9]+)\s*(px|pt|em|%)?/, CanvasText.cache = { text: {}, text_count: 0, text_count_max: 2e3, segment: {}, segment_count_max: 2e3, stats: { text_hits: 0, text_misses: 0, segment_hits: 0, segment_misses: 0 } }, CanvasText.EMPTY_TEXTURES_ARR = [], CanvasText.returnNoTextures = function() {
          return CanvasText.EMPTY_TEXTURES_ARR;
        };
        var rtlDirCheck = new RegExp("[---]");
        function isTextRTL(e) {
          return rtlDirCheck.test(e);
        }
        var neutral_chars = "\0-/:-@[-`{----\u2029-", neutralDirCheck = new RegExp("[" + neutral_chars + "]+");
        function isTextNeutral(e) {
          return neutralDirCheck.test(e);
        }
        var markRTL = "", arabic_range = new RegExp("^[" + neutral_chars + "-]+"), arabic_splitters = new RegExp("[" + neutral_chars + "-----]"), arabic_vowels = new RegExp("^[-----]+"), accents_and_vowels = "[------------------------------------------]", combo_characters = "[]", graphemeRegex = new RegExp("^.(?:" + accents_and_vowels + "+)?(" + combo_characters + "\\W(?:" + accents_and_vowels + "+)?)*"), curve_blacklist = { Mongolian: "-" }, curve_blacklist_range = Object.keys(curve_blacklist).map(function(e) {
          return curve_blacklist[e];
        }).join(""), curve_blacklist_test = new RegExp("[" + curve_blacklist_range + "]");
        function isTextCurveBlacklisted(e) {
          return curve_blacklist_test.test(e);
        }
        var default_segment_length = 2;
        function splitLabelText(e, t2) {
          var r = t2 ? 1 : default_segment_length;
          if (e.length < r)
            return [e];
          var i2 = e;
          if (CanvasText.cache.segment[i2])
            return CanvasText.cache.stats.segment_hits++, CanvasText.cache.segment[i2];
          var n = [];
          if (arabic_range.exec(e)) {
            n = e.split(arabic_splitters);
            for (var o, a2 = -1, s = 0; s < n.length - 1; s++) {
              0 < s && ((o = arabic_vowels.exec(n[s])) && (n[s] = n[s].substring(o[0].length), n[s - 1] += o[0], a2 += o[0].length)), a2 += 1 + n[s].length, n[s] += e.slice(a2, a2 + 1);
            }
            e = "";
          }
          for (; e.length; ) {
            for (var l = "", u2 = e, c2 = 0; c2 < r && u2.length; c2++) {
              var h = (graphemeRegex.exec(u2) || u2)[0];
              l += h, u2 = u2.substring(h.length);
            }
            n.push(l), e = e.substring(l.length);
          }
          return t2 && n.reverse(), CanvasText.cache.stats.segment_misses++, CanvasText.cache.segment[i2] = n;
        }
        var MultiLine = function() {
          function _(e) {
            var t2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 1 / 0, r = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : 1 / 0;
            _classCallCheck(this, _), this.width = 0, this.height = 0, this.lines = [], this.max_lines = t2, this.text_wrap = r, this.context = e;
          }
          return _createClass(_, [{ key: "createLine", value: function(e) {
            return this.lines.length < this.max_lines && new Line(e, this.text_wrap);
          } }, { key: "push", value: function(e) {
            if (this.lines.length < this.max_lines) {
              var t2 = this.context.measureText(e.text).width;
              return (e.width = t2) > this.width && (this.width = Math.ceil(t2)), this.lines.push(e), this.height += e.height, true;
            }
            return this.addEllipsis(), false;
          } }, { key: "advance", value: function(e, t2) {
            return !!this.push(e) && this.createLine(t2);
          } }, { key: "addEllipsis", value: function() {
            var e = this.lines[this.lines.length - 1], t2 = Math.ceil(this.context.measureText(_.ellipsis).width);
            e.append(_.ellipsis), e.width += t2, e.width > this.width && (this.width = e.width);
          } }, { key: "finish", value: function(e) {
            e ? this.push(e) : this.addEllipsis();
          } }], [{ key: "parse", value: function(e, t2, r, i2, n) {
            for (var o = "number" == typeof t2 ? e.split(" ") : [e], a2 = new _(n, r, t2), s = a2.createLine(i2), l = 0; l < o.length; l++) {
              for (var u2 = o[l].split("\n"), c2 = 0 === l, h = 0; h < u2.length && s; h++) {
                var f2 = u2[h];
                isTextRTL(f2) && isTextNeutral(f2[f2.length - 1]) && (f2 += markRTL);
                var d = c2 ? f2 : " " + f2;
                if (t2 && 0 < l && s.exceedsTextwrap(d)) {
                  if (!(s = a2.advance(s, i2)))
                    break;
                  s.append(f2), c2 = true;
                } else
                  s.append(d);
                h < u2.length - 1 && (s = a2.advance(s, i2), c2 = true);
              }
              l === o.length - 1 && a2.finish(s);
            }
            return a2;
          } }]), _;
        }();
        MultiLine.ellipsis = "...";
        var Line = function() {
          function r() {
            var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : 0, t2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 0;
            _classCallCheck(this, r), this.chars = 0, this.text = "", this.height = Math.ceil(e), this.text_wrap = t2;
          }
          return _createClass(r, [{ key: "append", value: function(e) {
            this.chars += e.length, this.text += e;
          } }, { key: "exceedsTextwrap", value: function(e) {
            return e.length + this.chars > this.text_wrap;
          } }]), r;
        }(), TextLabels = { resetText: function() {
          this.texts = {};
        }, freeText: function(e) {
          delete this.texts[e.id];
        }, parseTextFeature: function(e, t2, r, i2) {
          var n = this.parseTextSource(e, t2, r);
          if (null != n && "" !== n) {
            var o = TextSettings$1.compute(e, t2, r);
            if (o) {
              var a2 = TextSettings$1.key(o);
              this.texts[i2.id] = this.texts[i2.id] || {};
              var s = this.texts[i2.id][a2] = this.texts[i2.id][a2] || {};
              if (n instanceof Object) {
                var l = [], u2 = n.left + "-" + n.right;
                for (var c2 in n) {
                  var h, f2 = n[c2];
                  f2 && (h = this.computeTextLayout({}, e, t2, r, i2, f2, o, u2, c2), s[f2] || (s[f2] = { text_settings: o, ref: 0 }), l.push({ draw: t2, text: f2, text_settings_key: a2, layout: h }));
                }
                return 0 < l.length && l;
              }
              var d = this.computeTextLayout({}, e, t2, r, i2, n, o);
              return s[n] || (s[n] = { text_settings: o, ref: 0 }), { draw: t2, text: n, text_settings_key: a2, layout: d };
            }
          }
        }, parseTextSource: function(e, t2, r) {
          var i2, n = t2.text_source || "name";
          if (null != n && "object" === _typeof(n))
            for (var o in i2 = {}, n)
              i2[o] = this.parseTextSourceValue(n[o], e, r);
          else
            i2 = this.parseTextSourceValue(n, e, r);
          return i2;
        }, parseTextSourceValue: function(e, t2, r) {
          var i2;
          if (Array.isArray(e)) {
            for (var n = 0; n < e.length; n++)
              if ("string" == typeof e[n] ? i2 = t2.properties[e[n]] : "function" == typeof e[n] && (i2 = e[n](r)), i2)
                return i2;
          } else
            "string" == typeof e ? i2 = t2.properties[e] : e instanceof Function && (i2 = e(r));
          return i2;
        }, prepareTextLabels: function(r, e, i2) {
          var n = this;
          return 0 === Object.keys(this.texts[r.id] || {}).length ? Promise.resolve([]) : WorkerBroker.postMessage(this.main_thread_target + ".calcTextSizes", r.id, this.texts[r.id]).then(function(e2) {
            var t2 = e2.texts;
            return r.canceled ? (log("trace", "Style ".concat(n.name, ": stop tile build because tile was canceled: ").concat(r.key, ", post-calcTextSizes()")), []) : (n.texts[r.id] = t2 || [], t2 ? n.buildTextLabels(r, i2) : (Collision.abortTile(r.id), []));
          });
        }, collideAndRenderTextLabels: function(t2, r, e) {
          var n = this;
          return this.prepareTextLabels(t2, r, e).then(function(e2) {
            return 0 === e2.length ? (Collision.collide([], r, t2.id), Promise.resolve({})) : Collision.collide(e2, r, t2.id).then(function(e3) {
              if (t2.canceled)
                return log("trace", "stop tile build because tile was canceled: ".concat(t2.key, ", post-collide()")), {};
              var i2 = n.texts[t2.id];
              return null == i2 || 0 === e3.length ? {} : (n.cullTextStyles(i2, e3), e3.forEach(function(e4) {
                var t3 = e4.text_settings_key, r2 = i2[t3] && i2[t3][e4.text];
                r2.text_settings.can_articulate ? (r2.type || (r2.type = []), -1 === r2.type.indexOf(e4.label.type) && r2.type.push(e4.label.type)) : (r2.align = r2.align || {}, r2.align[e4.label.align] = {});
              }), { labels: e3, texts: i2, textures: [] });
            });
          });
        }, cullTextStyles: function(e, t2) {
          for (var r = 0; r < t2.length; r++) {
            var i2 = t2[r];
            e[i2.text_settings_key][i2.text].ref++;
          }
          for (var n in e)
            for (var o in e[n])
              e[n][o].ref < 1 && delete e[n][o];
          for (var a2 in e)
            0 === Object.keys(e[a2]).length && delete e[a2];
        }, calcTextSizes: function(e, t2) {
          return this._canvas_text || (this._canvas_text = new CanvasText(), this._canvas_ctx_for_sizes = this._canvas_text.createCanvas().getContext("2d")), this._canvas_text.textSizes(e, t2, this._canvas_ctx_for_sizes);
        }, preprocessText: function(e) {
          if (e && e.font && "object" === _typeof(e.font))
            return e.font.fill = StyleParser.createPropertyCache(e.font.fill), e.font.stroke && (e.font.stroke.color = StyleParser.createPropertyCache(e.font.stroke.color)), e.background && e.background.color && (e.background.color = StyleParser.createPropertyCache(e.background.color)), e.outline && (e.outline.color && (e.outline.color = StyleParser.createPropertyCache(e.outline.color)), e.outline.width && (e.outline.width = StyleParser.createPropertyCache(e.outline.width, StyleParser.parsePositiveNumber))), e.padding && (Array.isArray(e.padding) ? 2 === e.padding.length && (e.padding = [e.padding[0], e.padding[1], e.padding[0], e.padding[1]]) : e.padding = Array(4).fill(e.padding), e.padding = StyleParser.createPropertyCache(e.padding, function(e2) {
              return e2.map(StyleParser.parsePositiveNumber);
            })), e.font.px_size = StyleParser.createPropertyCache(e.font.size || TextSettings$1.defaults.size, CanvasText.fontPixelSize), e.font.stroke && null != e.font.stroke.width && (e.font.stroke.width = StyleParser.createPropertyCache(e.font.stroke.width, StyleParser.parsePositiveNumber)), e.offset = StyleParser.createPropertyCache(e.offset, function(e2) {
              return Array.isArray(e2) && e2.map(StyleParser.parseNumber);
            }), e.buffer = StyleParser.createPropertyCache(e.buffer, function(e2) {
              return (Array.isArray(e2) ? e2 : [e2, e2]).map(StyleParser.parsePositiveNumber);
            }), e.repeat_distance = StyleParser.createPropertyCache(e.repeat_distance || Geo$1.tile_size, StyleParser.parsePositiveNumber), e;
        }, computeTextLayout: function(e, t2, r, i2, n, o, a2, s, l) {
          var u2 = e || {};
          return (u2 = this.computeLayout(u2, t2, r, i2, n)).repeat_distance && (s && (u2.repeat_group += "/" + s), u2.repeat_group += "/" + o), u2.subdiv = n.overzoom2, u2.align = r.align, u2.italic = "normal" !== a2.style, "right" === l ? u2.orientation = 1 : "left" === l && (u2.orientation = -1), u2;
        } };
        function degToRad(e) {
          return e * Math.PI / 180;
        }
        var PI_OVER_180 = Math.PI / 180, HORIZON_THRESHOLD_MULTIPLIER = 0.75, ZOOM_FOR_BOUNDS_EPSILON = 1e-3, NEAR_PLANE = 1, LookAtManipulator = function() {
          function r(e, t2) {
            _classCallCheck(this, r), this._min_zoom = H.util.constants.DEFAULT_MIN_ZOOM_LEVEL, this._max_zoom = H.util.constants.DEFAULT_MAX_ZOOM_LEVEL, this._viewport = e, this._center_offset = [], this._center_offset_normalized = [], this._viewport_aspect_ratio = 1, this._focal_length = [[16, 2], [17, 2.5], [18, 3], [19, 4], [20, 6]], this._view_matrix = new Float64Array(16), this._projection_matrix = new Float64Array(16), this._heading_matrix = new Float64Array(16), this._tilt_matrix = new Float64Array(16), this._transformation_matrix = new Float64Array(16), this._camera_matrix = new Float64Array(16), this._lookAtData = { position: [0, 0, 0], zoom: 0, tile_level: 0, tetragon: void 0, bounds: void 0, unpadded_bounds: void 0, distance: void 0, tilt: 0, incline: 0, heading: 180 }, this._zoom_direction = 0, this._horizon = 0, this.handleViewportUpdate(true), t2 ? this.setLookAtData(t2) : this._updateMatrices(), ShaderProgram.replaceBlock("camera", "\n            uniform mat4 u_projection;\n            uniform vec3 u_eye;\n            uniform vec2 u_center_offset;\n\n            void cameraProjection (inout vec4 position) {\n                position = u_projection * position;\n            }");
          }
          return _createClass(r, [{ key: "getZoomForBounds", value: function(a2, e, s, l) {
            var t2, u2 = this.clone(), c2 = this._max_zoom, h = this._min_zoom, f2 = (c2 - h) / 2, d = c2 - f2, _ = e, r2 = MathUtils$1.getBBoxCenter(MathUtils$1.getBBox(a2));
            void 0 === _ ? _ = r2 : (t2 = r2[0] - _[0], Math.abs(t2) > Geo$1.half_circumference_meters + 1e-8 && (_[0] += Math.round(t2 / Geo$1.circumference_meters) * Geo$1.circumference_meters));
            for (; ZOOM_FOR_BOUNDS_EPSILON < f2; )
              !function() {
                u2.setLookAtData({ zoom: d, position: _, tilt: s, heading: l });
                var e2, t3, r3, i2, n, o = u2.getLookAtData().bounds;
                a2.every(function(e3) {
                  return MathUtils$1.isPointInsidePolygon(e3, o);
                }) ? h = d : (t3 = (e2 = _slicedToArray(MathUtils$1.getBBox(o), 4))[0], r3 = e2[1], i2 = e2[2], n = e2[3], i2 - t3 + 1e-8 >= Geo$1.circumference_meters && n - r3 + 1e-8 >= Geo$1.circumference_meters ? h = d : c2 = d), d = c2 - (f2 = (c2 - h) / 2);
              }();
            return h;
          } }, { key: "setZoomConstraints", value: function(e, t2) {
            this._min_zoom = e, this._max_zoom = t2, this.setLookAtData(this.getLookAtData());
          } }, { key: "setLookAtData", value: function(e, t2) {
            var r2, i2, n, o, a2, s = e.position, l = e.zoom;
            s === r2 && e.bounds !== r2 && (s = MathUtils$1.getBBoxCenter(MathUtils$1.getBBox(e.bounds))), l === r2 && e.bounds !== r2 && (l = this.getZoomForBounds(e.bounds, s, e.tilt, e.heading)), t2 !== r2 && (i2 = s || this.screenToWorld(t2)), l !== r2 && (l = MathUtils$1.clamp(l, this._min_zoom, this._max_zoom), (n = Utils$1.zoomToTileLevel(l)) !== (o = this._lookAtData.tile_level) && (this._zoom_direction = o < n ? 1 : -1), this._lookAtData.zoom = l, this._lookAtData.tile_level = n), e.tilt !== r2 && (this._lookAtData.tilt = e.tilt), e.heading !== r2 && (this._lookAtData.heading = e.heading), t2 !== r2 ? (this._updateMatrices(), a2 = this.screenToWorld(t2), this._lookAtData.position[0] -= a2[0] - i2[0], this._lookAtData.position[1] -= a2[1] - i2[1]) : s && (this._lookAtData.position = s), this._lookAtData.position[2] = 0, this._lookAtData.position[1] = MathUtils$1.clamp(this._lookAtData.position[1], -Geo$1.half_circumference_meters, Geo$1.half_circumference_meters), this._updateMatrices(), this._updateVisibleBounds();
          } }, { key: "getZoomDirection", value: function() {
            return this._zoom_direction;
          } }, { key: "resetZoomDirection", value: function() {
            this._zoom_direction = 0;
          } }, { key: "getLookAtData", value: function() {
            return this._lookAtData;
          } }, { key: "handleViewportUpdate", value: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e && e, r2 = this._viewport, i2 = r2.width, n = r2.height;
            this._viewport_aspect_ratio = i2 / n;
            var o = this._viewport.center.x - (i2 / 2 << 0), a2 = this._viewport.center.y - (n / 2 << 0);
            this._center_offset[0] = o, this._center_offset[1] = a2, this._center_offset_normalized[0] = o / i2, this._center_offset_normalized[1] = a2 / -n, t2 || (this._updateMatrices(), this._updateVisibleBounds());
          } }, { key: "setupMatrices", value: function(e, t2) {
            mat4.multiply(e.model_view32, this._view_matrix, e.model), t2.uniform("Matrix4fv", "u_modelView", e.model_view32), mat3.normalFromMat4(e.normal32, e.model_view32), mat3.invert(e.inverse_normal32, e.normal32), t2.uniform("Matrix3fv", "u_normalMatrix", e.normal32), t2.uniform("Matrix3fv", "u_inverseNormalMatrix", e.inverse_normal32);
          } }, { key: "_updateMatrices", value: function() {
            var e = this._viewport.height * Geo$1.metersPerPixel(this._lookAtData.zoom), t2 = Utils$1.interpolate(this._lookAtData.zoom, this._focal_length);
            this._lookAtData.distance = e / 2 * t2;
            var r2 = this._lookAtData.position[0], i2 = this._lookAtData.position[1];
            mat4.lookAt(this._view_matrix, vec3.fromValues(r2, i2, 0), vec3.fromValues(r2, i2, -1), vec3.fromValues(0, 1, 0)), this._heading_matrix = mat4.identity(this._heading_matrix);
            var n = 180 - this._lookAtData.heading;
            n *= PI_OVER_180, this._heading_matrix[0] = Math.cos(n), this._heading_matrix[1] = -Math.sin(n), this._heading_matrix[4] = Math.sin(n), this._heading_matrix[5] = Math.cos(n), this._tilt_matrix = mat4.identity(this._tilt_matrix), n = 0 < (n = this._lookAtData.tilt ? this._lookAtData.tilt * PI_OVER_180 : 0) ? -n : n, this._tilt_matrix[5] = Math.cos(n), this._tilt_matrix[6] = Math.sin(n), this._tilt_matrix[9] = -Math.sin(n), this._tilt_matrix[10] = Math.cos(n), mat4.multiply(this._transformation_matrix, this._tilt_matrix, this._heading_matrix), mat4.multiply(this._view_matrix, this._transformation_matrix, this._view_matrix);
            var o = 2 * Math.atan(1 / t2), a2 = 2 * this._lookAtData.distance;
            this._depth_buffer_adjustment = 2 / Math.log(a2 / NEAR_PLANE), mat4.perspective(this._projection_matrix, o, this._viewport_aspect_ratio, NEAR_PLANE, a2), this._projection_matrix[8] = 2 * -this._center_offset_normalized[0], this._projection_matrix[9] = 2 * -this._center_offset_normalized[1], mat4.translate(this._projection_matrix, this._projection_matrix, vec3.fromValues(0, 0, -this._lookAtData.distance)), this._camera_matrix = mat4.multiply(this._camera_matrix, this._projection_matrix, this._view_matrix);
          } }, { key: "_updateVisibleBounds", value: function() {
            var e, t2, r2, i2, n, o = this._viewport, a2 = o.width, s = o.height, l = o.padding, u2 = degToRad(this._lookAtData.tilt);
            this._horizon = Math.max((l.top + s) / 2 - Math.cos(u2) * (l.top * (1 - Math.sin(u2)) + s * HORIZON_THRESHOLD_MULTIPLIER), 0), this._lookAtData.tetragon = [this.screenToWorld([0, this._horizon]), this.screenToWorld([a2, this._horizon]), this.screenToWorld([a2, s]), this.screenToWorld([0, s])], this._lookAtData.unpadded_bounds = this._clipAgainstGeoBounds(this._lookAtData.tetragon), 0 === l.left && 0 === l.top && 0 === l.right && 0 === l.bottom ? this._lookAtData.bounds = this._lookAtData.unpadded_bounds : (e = l.left, t2 = Math.max(this._horizon, l.top), r2 = a2 - l.right, i2 = s - l.bottom, n = [this.screenToWorld([e, t2]), this.screenToWorld([r2, t2]), this.screenToWorld([r2, i2]), this.screenToWorld([e, i2])], this._lookAtData.bounds = this._clipAgainstGeoBounds(n));
          } }, { key: "_clipAgainstGeoBounds", value: function(e) {
            var t2, r2 = _slicedToArray(MathUtils$1.getBBox(e), 4), i2 = r2[0], n = r2[1], o = r2[2], a2 = r2[3], s = Geo$1.half_circumference_meters, l = [[i2 - 1, +s], [o + 1, +s], [o + 1, -s], [i2 - 1, -s]], u2 = MathUtils$1.clipPolygon(l, e)[0], c2 = _slicedToArray(MathUtils$1.getBBox(u2), 4), i2 = c2[0], n = c2[1], o = c2[2], a2 = c2[3];
            o - i2 >= Geo$1.circumference_meters && (u2 = [[(t2 = (o - i2) / 2) - s, a2], [t2 + s, a2], [t2 + s, n], [t2 - s, n]]);
            var h = [];
            return u2 && (h = MathUtils$1.splitLegs(u2, s)), h;
          } }, { key: "applyPxOffset", value: function(e) {
            var t2 = _slicedToArray(e, 2), r2 = t2[0], i2 = t2[1], n = Math.PI - this._lookAtData.heading * PI_OVER_180, o = Geo$1.metersPerPixel(this._lookAtData.zoom);
            this._lookAtData.position[0] += (r2 * Math.cos(n) + i2 * Math.sin(n)) * o, this._lookAtData.position[1] -= (i2 * Math.cos(n) - r2 * Math.sin(n)) * o, this._lookAtData.position[1] = MathUtils$1.clamp(this._lookAtData.position[1], -Geo$1.half_circumference_meters, Geo$1.half_circumference_meters), this._updateMatrices(), this._updateVisibleBounds();
          } }, { key: "screenToWorld", value: function(e) {
            var t2 = _slicedToArray(e, 2), r2 = t2[0], i2 = t2[1], n = this._viewport, o = n.width, a2 = n.height;
            return 0 === o || 0 === a2 ? [0, 0] : (r2 -= o / 2, i2 -= a2 / 2, this._clipCoordsToWorldPlaneCoords([2 * (r2 + o / 2) / o - 1, 1 - 2 * (i2 + a2 / 2) / a2, -1, 1]));
          } }, { key: "_clipToScreenCoords", value: function(e) {
            var t2 = this._viewport, r2 = t2.width, i2 = t2.height;
            return [(0.5 * e[0] + 0.5) * r2, i2 - (0.5 * e[1] + 0.5) * i2];
          } }, { key: "_isScreenPointInViewPort", value: function(e) {
            var t2 = this._viewport, r2 = t2.width, i2 = t2.height;
            return 0 <= e[0] && e[0] <= r2 && 0 <= e[1] && e[1] <= i2;
          } }, { key: "worldToScreen", value: function(e, t2) {
            var r2, i2, n, o, a2, s, l = 1 < arguments.length && void 0 !== t2 && t2;
            return e[2] || (e[2] = 0), l ? (r2 = this._worldToClipCoords(e), a2 = this._clipToScreenCoords(r2)) : (i2 = Math.sign(this._lookAtData.position[0]), n = Math.trunc(this._lookAtData.position[0] / Geo$1.circumference_meters + i2 / 2), e[0] += Geo$1.circumference_meters * n, o = this._worldToClipCoords(e), s = a2 = this._clipToScreenCoords(o), this._isScreenPointInViewPort(a2) || (o = this._worldToClipCoords([e[0] + Geo$1.circumference_meters, e[1], e[2]]), a2 = this._clipToScreenCoords(o), this._isScreenPointInViewPort(a2) || (o = this._worldToClipCoords([e[0] - Geo$1.circumference_meters, e[1], e[2]]), a2 = this._clipToScreenCoords(o)), this._isScreenPointInViewPort(a2) || (a2 = s))), a2;
          } }, { key: "getHorizon", value: function() {
            return this._horizon;
          } }, { key: "_clipCoordsToWorldPlaneCoords", value: function(e) {
            var t2 = [], r2 = this._lookAtData.distance, i2 = this._lookAtData.position, n = [0, 0, r2, 0], o = 0, a2 = r2 * Math.sin(PI_OVER_180 * this._lookAtData.tilt) * Math.cos(PI_OVER_180 * this._lookAtData.heading), s = r2 * Math.sin(PI_OVER_180 * this._lookAtData.tilt) * Math.sin(PI_OVER_180 * this._lookAtData.heading), l = new Float64Array(16), u2 = new Float64Array(16);
            return mat4.invert(l, this._projection_matrix), vec4.transformMat4(t2, e, l), t2[2] = -1, t2[3] = 0, mat4.invert(u2, this._view_matrix), vec4.transformMat4(t2, t2, u2), vec4.normalize(t2, t2), vec4.transformMat4(n, n, this._transformation_matrix), 0 !== t2[2] && (o = -n[2] / t2[2]), vec4.scale(t2, t2, o), [i2[0] + (t2[0] + s), i2[1] + (t2[1] + a2)];
          } }, { key: "_worldToClipCoords", value: function(e) {
            var t2 = [e[0], e[1], e[2], 1];
            return vec4.transformMat4(t2, t2, this._view_matrix), vec4.transformMat4(t2, t2, this._projection_matrix), vec4.scale(t2, t2, 1 / t2[3]), t2;
          } }, { key: "setupProgram", value: function(e) {
            e.uniform("Matrix4fv", "u_projection", this._projection_matrix), e.uniform("3f", "u_eye", [0, 0, this._lookAtData.distance]), e.uniform("2fv", "u_center_offset", this._center_offset_normalized), e.uniform("1f", "u_tilt", this._lookAtData.tilt * PI_OVER_180), e.uniform("1f", "u_heading", this._lookAtData.heading * PI_OVER_180), e.uniform("1f", "u_near_plane", NEAR_PLANE), e.uniform("1f", "u_depth_buffer_adjustment", this._depth_buffer_adjustment);
          } }, { key: "getTransformationMatrix", value: function() {
            return this._transformation_matrix;
          } }, { key: "getCameraMatrix", value: function() {
            return this._camera_matrix;
          } }, { key: "clone", value: function() {
            var e = new r(this._viewport, this._lookAtData);
            return e.setZoomConstraints(this._min_zoom, this._max_zoom), e;
          } }, { key: "getViewport", value: function() {
            return this._viewport;
          } }]), r;
        }();
        function getX(e) {
          return void 0 === e.x ? e[0] : e.x;
        }
        function getY(e) {
          return void 0 === e.y ? e[1] : e.y;
        }
        function xAscendingComparator(e, t2) {
          return getX(e) - getX(t2);
        }
        function yAscendingComparator(e, t2) {
          return getY(e) - getY(t2);
        }
        function sortByX(e) {
          return e.sort(xAscendingComparator);
        }
        function sortByY(e) {
          return e.sort(yAscendingComparator);
        }
        function getMinMax(e, t2) {
          for (var r, i2 = e[0], n = i2, o = 0; o < e.length; o += 1)
            t2(r = e[o], i2) < 0 ? i2 = r : 0 < t2(r, n) && (n = r);
          return [i2, n];
        }
        function groupByCoord(i2, e) {
          return Object.values(e.reduce(function(e2, t2) {
            var r = t2[+i2];
            return e2[r] || (e2[r] = []), e2[r].push(t2), e2;
          }, {}));
        }
        function groupByX(e) {
          return groupByCoord(false, e);
        }
        function groupByY(e) {
          return groupByCoord(true, e);
        }
        function createTileRangeByCoord(e, t2, r) {
          var i2 = +e, n = t2[i2], o = r[i2];
          if (o < n)
            return [];
          var a2 = [t2];
          if (o < n)
            return a2;
          for (var s = t2[(1 + i2) % 2], l = e ? function(e2) {
            return a2.push([s, e2]);
          } : function(e2) {
            return a2.push([e2, s]);
          }, u2 = n + 1; u2 < o; u2 += 1)
            l(u2);
          return a2.push(r), a2;
        }
        function createTileRangeByX(e, t2) {
          return createTileRangeByCoord(false, e, t2);
        }
        function createTileRangeByY(e, t2) {
          return createTileRangeByCoord(true, e, t2);
        }
        function deduplicate(e) {
          var r = {}, i2 = [];
          return e.forEach(function(e2) {
            var t2 = e2.key || (Array.isArray(e2) ? "".concat(e2[0], "/").concat(e2[1]) : "".concat(e2.x, "/").concat(e2.y));
            r[t2] || (r[t2] = true, i2.push(e2));
          }), i2;
        }
        function flat(e) {
          return e.reduce(function(e2, t2) {
            return e2.concat(t2);
          });
        }
        function applyMargin(e, a2) {
          if (a2 <= 0)
            return e;
          var t2, r = function(e2) {
            var t3 = _slicedToArray(getMinMax(e2, xAscendingComparator), 2), r2 = t3[0], i3 = t3[1], n = [r2[0] - a2, r2[1]], o = [i3[0] + a2, i3[1]];
            return e2.concat(createTileRangeByX(n, r2), createTileRangeByX(i3, o));
          }, i2 = function(e2) {
            var t3 = _slicedToArray(getMinMax(e2, yAscendingComparator), 2), r2 = t3[0], i3 = t3[1], n = [r2[0], r2[1] - a2], o = [i3[0], i3[1] + a2];
            return e2.concat(createTileRangeByY(n, r2), createTileRangeByY(i3, o));
          };
          return deduplicate((t2 = groupByY(flat(groupByX(e).map(i2))), flat(t2.map(r))));
        }
        function constructTiles(e, n, o) {
          return e.map(function(e2) {
            var t2 = _slicedToArray(e2, 2), r = t2[0], i2 = t2[1];
            return Tile.coord(Geo$1.wrapTile({ x: r, y: i2, z: n }, { x: !o, y: true }));
          });
        }
        function getTileGrid(t2, e, r) {
          function i2(e2) {
            return Object.values(Geo$1.metersToExactTileCoords(e2, t2.tile_level));
          }
          return deduplicate(constructTiles(applyMargin(rasterizeTetragon(i2(t2.tetragon[0]), i2(t2.tetragon[1]), i2(t2.tetragon[3]), i2(t2.tetragon[2])), e), t2.tile_level, r));
        }
        function rasterizeTetragon(e, t2, r, i2) {
          var n = rasterizeTriangle(t2, e, r), o = rasterizeTriangle(r, i2, t2);
          return deduplicate(n.concat(o));
        }
        function rasterizeTriangle(e, t2, r) {
          var i2 = _slicedToArray(sliceTriangle.apply(void 0, _toConsumableArray(sortByY([e, t2, r]))), 2), n = i2[0], o = i2[1];
          return deduplicate(rasterizeBottomFlatTriangle.apply(void 0, _toConsumableArray(n)).concat(rasterizeTopFlatTriangle.apply(void 0, _toConsumableArray(o))));
        }
        function sliceTriangle(e, t2, r) {
          var i2 = _slicedToArray(e, 2), n = i2[0], o = i2[1], a2 = _slicedToArray(t2, 2), s = a2[0], l = a2[1], u2 = _slicedToArray(r, 2), c2 = u2[0], h = u2[1], f2 = n + (l - o) / (h - o) * (c2 - n);
          return [[[n, o]].concat(_toConsumableArray(sortByX([[s, l], [f2, l]]))), [].concat(_toConsumableArray(sortByX([[s, l], [f2, l]])), [[c2, h]])];
        }
        function rasterizeBottomFlatTriangle(e, t2, r) {
          var i2 = _slicedToArray(e, 2), n = i2[0], o = i2[1], a2 = _slicedToArray(t2, 2), s = a2[0], l = a2[1];
          return scanFlatTriangle(n, s, _slicedToArray(r, 1)[0], o, l);
        }
        function rasterizeTopFlatTriangle(e, t2, r) {
          var i2 = _slicedToArray(e, 2), n = i2[0], o = i2[1], a2 = _slicedToArray(t2, 1)[0], s = _slicedToArray(r, 2);
          return scanFlatTriangle(s[0], n, a2, s[1], o);
        }
        var scanStepStatic = 0.125;
        function getScanStep(e, t2) {
          return scanStepStatic * (t2 - e) / (Math.ceil(t2) - Math.floor(e));
        }
        function scanFlatTriangle(e, t2, r, i2, n) {
          var o = Math.min(e, t2), a2 = Math.max(e, r), s = Math.min(i2, n), l = Math.max(i2, n);
          if (Math.floor(i2) === Math.floor(n))
            return scanRow(o, a2, i2);
          if (l - s < scanStepStatic)
            return scanRectangle([o, s], [a2, l]);
          function u2(e2) {
            _ = _.concat(scanRow(p2, g, Math.floor(e2))), p2 += f2, g += d;
          }
          var c2 = getScanStep(s, l), h = (l - s) / c2, f2 = (t2 - e) / h, d = (r - e) / h, _ = [], p2 = e, g = e;
          if (i2 < n)
            for (var m = s; m <= l; m += c2)
              u2(m);
          else
            for (var y = l; s <= y; y -= c2)
              u2(y);
          return deduplicate(_);
        }
        function xCoordsToPoints(e, t2) {
          return e.map(function(e2) {
            return [e2, t2];
          });
        }
        function createCoordRange(e, t2) {
          var r = Math.floor(e), i2 = Math.floor(t2);
          if (i2 < r)
            return [];
          if (r === i2)
            return [r];
          for (var n = [], o = r; o <= i2; o += 1)
            n.push(o);
          return n;
        }
        function scanRow(e, t2, r) {
          return xCoordsToPoints(createCoordRange(e, t2), r);
        }
        function scanRectangle(e, t2) {
          var r = _slicedToArray(e, 2), i2 = r[0], n = r[1], o = _slicedToArray(t2, 2), a2 = o[0], s = o[1], l = createCoordRange(i2, a2), u2 = xCoordsToPoints(l, n), c2 = xCoordsToPoints(l, s);
          return u2.concat(c2);
        }
        var VIEW_PAN_SNAP_TIME = 0.5, Z_PRECISION = 1e5, View = function() {
          function o(e, t2) {
            _classCallCheck(this, o), subscribeMixin(this), this.scene = e, this.createMatrices(), this.bounds = null, this.center_tile = null, this.panning = false, this.panning_stop_at = 0, this.pan_snap_timer = 0, this.user_input_at = 0, this.user_input_timeout = 50, this.user_input_active = false, this.size = {}, this.buffer = 0, this.wrap = false !== t2.wrapView, this.preserve_tiles_within_zoom = 1, this.lookAtManipulator = new LookAtManipulator(t2.viewport), this._viewport = t2.viewport, this._offset_buffer = [0, 0], this.handleViewportUpdate(true);
          }
          return _createClass(o, [{ key: "update", value: function() {
            this.pan_snap_timer = (/* @__PURE__ */ new Date() - this.panning_stop_at) / 1e3, this.user_input_active = /* @__PURE__ */ new Date() - this.user_input_at < this.user_input_timeout, this.scene.tile_manager.updateTilesVisibilityCounters();
          } }, { key: "handleViewportUpdate", value: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e && e, r = this._viewport, i2 = r.width, n = r.height;
            this.size.css = { width: i2, height: n }, this.size.device = { width: Math.round(i2 * Utils$1.device_pixel_ratio), height: Math.round(n * Utils$1.device_pixel_ratio) }, this.lookAtManipulator.handleViewportUpdate(), t2 || this.updateBounds();
          } }, { key: "setLookAtData", value: function(e, t2) {
            o._setLookAtDataForManipulator(this.lookAtManipulator, e, t2), this.updateBounds();
          } }, { key: "getLookAtData", value: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e && e;
            return o._getLookAtDataFromManipulator(this.lookAtManipulator, t2);
          } }, { key: "getBestLookAtData", value: function(e, t2, r) {
            var i2 = 2 < arguments.length && void 0 !== r && r, n = this.lookAtManipulator.clone();
            return o._setLookAtDataForManipulator(n, e, t2), o._getLookAtDataFromManipulator(n, i2);
          } }, { key: "getTileLevel", value: function() {
            return this.lookAtManipulator.getLookAtData().tile_level;
          } }, { key: "applyPxOffset", value: function(e) {
            var t2 = this._offset_buffer;
            t2[0] += e[0], t2[1] += e[1];
            var r, i2, n = Math.abs(t2[0]), o2 = Math.abs(t2[1]);
            (1 <= n || 1 <= o2) && (r = ~~t2[0], i2 = ~~t2[1], this.lookAtManipulator.applyPxOffset([n < 1 ? 0 : r, o2 < 1 ? 0 : i2]), 1 <= n && (t2[0] -= r), 1 <= o2 && (t2[1] -= i2), this.updateBounds());
          } }, { key: "setPanning", value: function(e) {
            this.panning = e, this.panning || (this.panning_stop_at = +/* @__PURE__ */ new Date());
          } }, { key: "markUserInput", value: function() {
            this.user_input_at = +/* @__PURE__ */ new Date();
          } }, { key: "ready", value: function() {
            return "number" == typeof this.size.css.width && "number" == typeof this.size.css.height;
          } }, { key: "updateBounds", value: function() {
            var e, t2;
            this.markUserInput(), this.ready() && (this.center_tile = Geo$1.tileForMeters(this.lookAtManipulator.getLookAtData().position, this.lookAtManipulator.getLookAtData().tile_level), e = this.lookAtManipulator.screenToWorld([0, this.size.css.height]), t2 = this.lookAtManipulator.screenToWorld([this.size.css.width, 0]), this.bounds = { sw: { x: e[0], y: e[1] }, ne: { x: t2[0], y: t2[1] } }, this.scene.tile_manager.updateTilesForView(true), this.trigger("move"), this.scene.requestRedraw());
          } }, { key: "getTileGridFlatForBBox", value: function(e, t2, r, i2, n, o2) {
            var a2, s = 4 < arguments.length && void 0 !== n ? n : 0, l = !(5 < arguments.length && void 0 !== o2) || o2, u2 = this.lookAtManipulator.getLookAtData().tile_level, c2 = Geo$1.tileForMeters([t2, e], u2), h = Geo$1.tileForMeters([i2, r], u2);
            c2.x -= s, c2.y -= s, h.x += s, h.y += s, false === l && (a2 = (1 << u2) - 1, c2.x = Math.min(Math.max(0, c2.x), a2), c2.y = Math.min(Math.max(0, c2.y), a2), h.x = Math.min(Math.max(0, h.x), a2), h.y = Math.min(Math.max(0, h.y), a2));
            for (var f2 = [], d = {}, _ = c2.x; _ <= h.x; _++)
              for (var p2 = c2.y; p2 <= h.y; p2++) {
                var g = Tile.coord(Geo$1.wrapTile({ x: _, y: p2, z: u2 }, { x: !l, y: true }));
                d[g.key] || (d[g.key] = true, f2.push(g));
              }
            return f2;
          } }, { key: "getTileGridFlat", value: function() {
            return this.getTileGridFlatForBBox(this.bounds.ne.y, this.bounds.sw.x, this.bounds.sw.y, this.bounds.ne.x, this.buffer, this.wrap);
          } }, { key: "getTileGridDistorted", value: function() {
            return getTileGrid(this.lookAtManipulator.getLookAtData(), this.buffer, this.wrap);
          } }, { key: "findVisibleTileCoordinates", value: function() {
            if (!this.bounds)
              return [];
            var e = this.lookAtManipulator.getLookAtData(), t2 = e.tilt, r = e.heading;
            return 0 === t2 && 180 === r ? this.getTileGridFlat() : this.getTileGridDistorted();
          } }, { key: "createMatrices", value: function() {
            this.matrices = {}, this.matrices.model = new Float64Array(16), this.matrices.model32 = new Float32Array(16), this.matrices.model_view = new Float64Array(16), this.matrices.model_view32 = new Float32Array(16), this.matrices.normal = new Float64Array(9), this.matrices.normal32 = new Float32Array(9), this.matrices.inverse_normal32 = new Float32Array(9);
          } }, { key: "setupTile", value: function(e, t2) {
            e.setupProgram(this.matrices, t2), this.lookAtManipulator.setupMatrices(this.matrices, t2);
          } }, { key: "setupProgram", value: function(e) {
            var t2 = this.lookAtManipulator.getLookAtData();
            e.uniform("2fv", "u_resolution", [this.size.device.width, this.size.device.height]), e.uniform("3fv", "u_map_position", [t2.position[0], t2.position[1], Math.trunc(t2.zoom * Z_PRECISION) / Z_PRECISION]), e.uniform("1f", "u_meters_per_pixel", Geo$1.metersPerPixel(t2.zoom)), e.uniform("1f", "u_device_pixel_ratio", Utils$1.device_pixel_ratio), e.uniform("1f", "u_view_pan_snap_timer", this.pan_snap_timer), e.uniform("1i", "u_view_panning", this.panning), e.uniform("1f", "u_horizon", this.lookAtManipulator.getHorizon() / (this.size.css.height / 2)), this.lookAtManipulator.setupProgram(e);
          } }, { key: "isAnimating", value: function() {
            return this.pan_snap_timer <= VIEW_PAN_SNAP_TIME;
          } }, { key: "xyToGeo", value: function(e, t2) {
            var r = this.lookAtManipulator.screenToWorld([e, t2]), i2 = _slicedToArray(Geo$1.metersToLatLng(r), 2), n = i2[0];
            return { lat: i2[1], lng: n };
          } }, { key: "geoToPixel", value: function(e) {
            var t2 = Geo$1.latLngToMeters([e.lng, e.lat]);
            t2.push(e.alt || 0);
            var r = this.lookAtManipulator.worldToScreen(t2);
            return { x: Math.floor(r[0]), y: Math.floor(r[1]) };
          } }, { key: "geoToMeters", value: function(e) {
            var t2 = _slicedToArray(Geo$1.latLngToMeters([e.lng, e.lat]), 2);
            return { x: t2[0], y: t2[1], z: e.alt || 0 };
          } }, { key: "metersToGeo", value: function(e) {
            var t2 = _slicedToArray(Geo$1.metersToLatLng([e.x, e.y]), 2), r = t2[0];
            return { lat: t2[1], lng: r, alt: e.z || 0 };
          } }, { key: "setZoomConstraints", value: function(e, t2) {
            this.lookAtManipulator.setZoomConstraints(e, t2);
          } }], [{ key: "_setLookAtDataForManipulator", value: function(e, t2, r) {
            var i2 = t2.position, n = t2.zoom, o2 = t2.tilt, a2 = t2.heading, s = t2.bounds, l = { zoom: n, tilt: o2, heading: a2 };
            if (i2 && "number" == typeof i2.lng && "number" == typeof i2.lat && (l.position = Geo$1.latLngToMeters([i2.lng, i2.lat])), s) {
              var u2 = s.getExterior().getLatLngAltArray(), c2 = u2.length / 3, h = Array(c2);
              if (s.getBoundingBox().isCDB())
                for (var f2 = u2[1], d = 0, _ = 0; _ < c2; _++) {
                  var p2, g = u2[3 * _ + 1];
                  0 < _ && (p2 = g - f2, 180 < Math.abs(p2) && (d += f2 < g ? -360 : 360)), f2 = g, h[_] = Geo$1.latLngToMeters([g + d, u2[3 * _]]);
                }
              else
                for (var m = 0; m < c2; m++)
                  h[m] = Geo$1.latLngToMeters([u2[3 * m + 1], u2[3 * m]]);
              l.bounds = h;
            }
            e.setLookAtData(l, r);
          } }, { key: "_getLookAtDataFromManipulator", value: function(e, t2) {
            var r = 1 < arguments.length && void 0 !== t2 && t2, i2 = e.getLookAtData(), n = i2.heading, o2 = i2.incline, a2 = i2.tilt, s = i2.zoom, l = i2.position, u2 = i2.bounds, c2 = i2.unpadded_bounds, h = _slicedToArray(Geo$1.metersToLatLng(l), 2), f2 = h[0], d = h[1], _ = new H.geo.LineString();
            return (r ? c2 : u2).forEach(function(e2) {
              var t3 = Geo$1.metersToLatLng(e2);
              _.pushLatLngAlt(t3[1], t3[0], 0);
            }), { heading: n, incline: o2, tilt: a2, zoom: s, bounds: new H.geo.Polygon(_), position: { lat: d, lng: f2, alt: l[2] } };
          } }]), o;
        }(), shaderSrc_pointsVertex = "uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform bool u_tile_fade_in;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform bool u_view_panning;uniform float u_tilt;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform float u_heading;uniform float u_near_plane;uniform float u_depth_buffer_adjustment;attribute vec4 a_position;attribute vec4 a_shape;attribute vec4 a_color;attribute vec2 a_texcoord;attribute vec2 a_offset;uniform float u_point_type;attribute float a_is_flat;\n#ifdef TANGRAM_IS_TEXT_STYLE\nattribute vec4 a_offsets_alt;attribute vec4 a_pre_angles_alt;attribute vec4 a_angles_alt;attribute vec4 a_offsets;attribute vec4 a_pre_angles;attribute vec4 a_angles;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nattribute float a_is_stick;attribute float a_stick_height;varying float v_is_stick;\n#endif\nvarying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nattribute float a_outline_edge;attribute vec4 a_outline_color;varying float v_outline_edge;varying vec4 v_outline_color;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#define PI 3.14159265359\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvec2 rotate2D(vec2 _st,float _angle){return mat2(cos(_angle),-sin(_angle),sin(_angle),cos(_angle))*_st;}vec3 rotateX3D(vec3 _st,float _angle){return mat3(1.,0.,0.,0.,cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle))*_st;}vec3 rotateZ3D(vec3 _st,float _angle){return mat3(cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle),0.,0.,0.,1.)*_st;}\n#ifdef TANGRAM_IS_TEXT_STYLE\nfloat mix4linear(float a,float b,float c,float d,float x){return mix(mix(a,b,3.*x),mix(b,mix(c,d,3.*(max(x,.66)-.66)),3.*(clamp(x,.33,.66)-.33)),step(0.33,x));}\n#endif\nvoid main(){\n#pragma tangram: setup\n#ifndef TANGRAM_SHOW_HIDDEN_LABELS\nif(a_shape.w==0.){gl_Position=vec4(0.,0.,0.,1.);return;}\n#else\nif(a_shape.w==0.){v_label_hidden=1.;}else{v_label_hidden=0.;}\n#endif\nv_alpha_factor=1.0;v_color=a_color;v_texcoord=a_texcoord;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nv_outline_color=a_outline_color;v_outline_edge=a_outline_edge;if(u_point_type==TANGRAM_POINT_TYPE_SHADER){v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;float size=abs(a_shape.x/128.);v_texcoord=sign(a_shape.xy)*(size+1.0)/size;size+=2.0;v_aa_offset=2.0/size;}\n#endif\nvec4 position=u_modelView*vec4(a_position.xyz,1.);vec4 shape=vec4(a_shape.xy,0.,0.);vec2 offset=vec2(a_offset.x,-a_offset.y);\n#ifdef TANGRAM_POINT_DRAW_STICK\nv_is_stick=a_is_stick;float scaled_stick_height=(sin(u_tilt+(1.5*PI))+1.0)*a_stick_height;offset.y+=(1.0-a_is_stick)*scaled_stick_height;\n#endif\nfloat zoom=clamp(u_map_position.z-u_tile_origin.z,0.,1.);float theta=a_shape.z/4096.;float heading=u_heading;float delta=(heading-PI);float new_theta=theta-delta;float reversed=abs(new_theta)>PI/2. ? 1. : 0.;if(a_is_flat==1.0){\n#ifdef TANGRAM_IS_TEXT_STYLE\nif(a_offsets[0]!=0.){vec4 angles_scaled;vec4 pre_angles_scaled;vec4 offsets_scaled;if(reversed==1.){offsets_scaled=a_offsets_alt*4.;angles_scaled=(PI/16384.)*a_angles_alt;pre_angles_scaled=(PI/128.)*a_pre_angles_alt;}else{offsets_scaled=a_offsets*4.;angles_scaled=(PI/16384.)*a_angles;pre_angles_scaled=(PI/128.)*a_pre_angles;}float pre_angle=mix4linear(pre_angles_scaled[0],pre_angles_scaled[1],pre_angles_scaled[2],pre_angles_scaled[3],zoom);float angle=mix4linear(angles_scaled[0],angles_scaled[1],angles_scaled[2],angles_scaled[3],zoom);float offset_curve=mix4linear(offsets_scaled[0],offsets_scaled[1],offsets_scaled[2],offsets_scaled[3],zoom);shape.xy=rotate2D(shape.xy,pre_angle+PI*reversed);shape.x+=offset_curve;shape.xy=rotate2D(shape.xy,angle);shape.xy+=rotate2D(offset,theta);}else{shape.xy=rotate2D(shape.xy+offset*256.,theta+(PI*reversed));}\n#else\nshape.xy=rotate2D(shape.xy+offset*256.,theta);\n#endif\nshape.xy/=pow(2.,4.+(u_map_position.z-u_tile_origin.w));shape=u_modelView*shape;position+=shape;}else{shape.xy/=256.;\n#ifdef TANGRAM_POINT_DRAW_STICK\nshape.y*=1.0+(scaled_stick_height-1.0)*a_is_stick;\n#endif\nshape.xy=rotate2D(shape.xy+offset,theta);}\n#ifdef TANGRAM_FADE_IN_RATE\nif(u_tile_fade_in){v_alpha_factor*=clamp(u_visible_time*TANGRAM_FADE_IN_RATE,0.,1.);}\n#endif\n#ifdef TANGRAM_FADE_ON_ZOOM_OUT\nv_alpha_factor*=clamp(1.+TANGRAM_FADE_ON_ZOOM_OUT_RATE*(u_map_position.z-u_tile_origin.z),0.,1.);\n#endif\nv_world_position=u_model*position;v_world_position.xy+=shape.xy*u_meters_per_pixel;v_world_position=wrapWorldPosition(v_world_position);\n#pragma tangram: position\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);/***Due to the precision loss on depth buffer,we had a z-fighting of translucent points when the distance to the camera was big.*For more information about the problem see: https:*For more information about the fix see: https:*position.z=(2.0*log(position.w/u_near_plane)/log(u_far_plane/u_near_plane)-1.0)*position.w;*/position.z=(log(position.w/u_near_plane)*u_depth_buffer_adjustment-1.0)*position.w;\n#endif\nif(a_is_flat!=1.){position.xy+=shape.xy*position.w*2.*u_device_pixel_ratio/u_resolution;}\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_SHADER){position.xy+=sign(shape.xy)*position.w*u_device_pixel_ratio/u_resolution;}\n#endif\nif(!u_view_panning){snapToPixelGrid(position);}gl_Position=position;}", shaderSrc_pointsFragment = "uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_texture;uniform float u_point_type;uniform bool u_apply_color_blocks;varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nvarying vec4 v_outline_color;varying float v_outline_edge;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nvarying float v_is_stick;\n#endif\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#ifdef TANGRAM_HAS_SHADER_POINTS\nfloat _tangram_antialias(float l,float R){float low=R-v_aa_offset;float high=R+v_aa_offset;return 1.-smoothstep(low,high,l);}\n#endif\nvoid mixTextureColor(inout vec4 color){\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_TEXTURE){color*=texture2D(u_texture,v_texcoord);}else if(u_point_type==TANGRAM_POINT_TYPE_LABEL){color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);}else if(u_point_type==TANGRAM_POINT_TYPE_SHADER){float outline_edge=v_outline_edge;vec4 outlineColor=v_outline_color;float l=length(v_texcoord);float outer_alpha=_tangram_antialias(l,1.);float fill_alpha=_tangram_antialias(l,1.-v_outline_edge*0.5)*color.a;float stroke_alpha=(outer_alpha-_tangram_antialias(l,1.-v_outline_edge))*outlineColor.a;\n#ifdef TANGRAM_BLEND_ADD\ncolor.a=stroke_alpha+fill_alpha;color.rgb=color.rgb*fill_alpha+outlineColor.rgb*stroke_alpha;\n#else\ncolor.a=stroke_alpha+fill_alpha*(1.-stroke_alpha);color.rgb=mix(color.rgb*fill_alpha,outlineColor.rgb,stroke_alpha)/max(color.a,0.001);\n#endif\n}\n#else\ncolor=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);\n#endif\nif(u_apply_color_blocks){\n#pragma tangram: color\n#pragma tangram: filter\n}color.a*=v_alpha_factor;\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nif(v_label_hidden>0.){color.a*=0.5;color.rgb=vec3(1.,0.,0.);}\n#endif\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY) && !defined(TANGRAM_BLEND_ADD)\nif(color.a<TANGRAM_ALPHA_TEST){discard;}\n#endif\n}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;\n#ifdef TANGRAM_POINT_DRAW_STICK\nif(v_is_stick==0.0){mixTextureColor(color);}\n#else\nmixTextureColor(color);\n#endif\ngl_FragColor=color;}", PLACEMENT$1 = LabelPoint.PLACEMENT, pre_angles_normalize = 128 / Math.PI, angles_normalize = 16384 / Math.PI, offsets_normalize = 64, texcoord_normalize = 65535, Points = Object.create(Style), TANGRAM_POINT_TYPE_TEXTURE = 1, TANGRAM_POINT_TYPE_LABEL = 2, TANGRAM_POINT_TYPE_SHADER = 3, DEFAULT_POINT_SIZE = 16;
        Object.assign(Points, TextLabels), Object.assign(Points, { name: "points", built_in: true, vertex_shader_src: shaderSrc_pointsVertex, fragment_shader_src: shaderSrc_pointsFragment, selection: true, collision: true, blend: "overlay", init: function(e) {
          var t2 = 0 < arguments.length && void 0 !== e ? e : {};
          Style.init.call(this, t2), this.setupDefines(), this.defines.TANGRAM_HAS_SHADER_POINTS = true, this.defines.TANGRAM_POINT_TYPE_TEXTURE = TANGRAM_POINT_TYPE_TEXTURE, this.defines.TANGRAM_POINT_TYPE_LABEL = TANGRAM_POINT_TYPE_LABEL, this.defines.TANGRAM_POINT_TYPE_SHADER = TANGRAM_POINT_TYPE_SHADER, this.defines.TANGRAM_POINT_DRAW_STICK = !!this.stick, this.collision_group_points = this.name + "-points", this.collision_group_text = this.name + "-text", this.reset();
        }, setupDefines: function() {
          "overlay" !== this.blend && (this.defines.TANGRAM_LAYER_ORDER = true), this.defines.TANGRAM_FADE_ON_ZOOM_OUT = true, this.defines.TANGRAM_FADE_ON_ZOOM_OUT_RATE = 2, debugSettings$1.suppress_label_fade_in || this.suppress_fade ? (this.fade_in_time = 0, this.defines.TANGRAM_FADE_IN_RATE = null) : (this.fade_in_time = 0.15, this.defines.TANGRAM_FADE_IN_RATE = 1 / this.fade_in_time), debugSettings$1.suppress_snap_animation || (this.defines.TANGRAM_VIEW_PAN_SNAP_RATE = 1 / VIEW_PAN_SNAP_TIME), debugSettings$1.show_hidden_labels && (this.defines.TANGRAM_SHOW_HIDDEN_LABELS = true);
        }, reset: function() {
          this.queues = {}, this.resetText(), this.texture_missing_sprites = {};
        }, addFeature: function(e, t2, r) {
          var i2, n, o, a2 = r.tile, s = {};
          if (s.color = this.parseColor(t2.color, r), s.texture = t2.texture, s.label_texture = null, s.color || s.texture) {
            if (this.hasSprites(s)) {
              if (!(i2 = this.parseSprite(s, t2, r)))
                return;
              s.texcoords = i2.texcoords;
            }
            if (s.size = t2.size, s.size) {
              if (s.size = StyleParser.evalCachedPointSizeProperty(t2.size, i2, r), null == s.size)
                return void log({ level: "warn", once: true }, "Layer '".concat(t2.layers[t2.layers.length - 1], "': ") + "'size' includes % and/or ratio-based scaling (".concat(JSON.stringify(t2.size.value), "); ") + "these can only applied to sprites, but no sprite was specified, skipping features in layer");
              "number" == typeof s.size && (s.size = [s.size, s.size]);
            } else
              s.size = i2 && i2.css_size || [DEFAULT_POINT_SIZE, DEFAULT_POINT_SIZE];
            t2.outline && (s.outline_width = StyleParser.evalCachedProperty(t2.outline.width, r) || StyleParser.defaults.outline.width, s.outline_color = this.parseColor(t2.outline.color, r)), s.outline_edge_pct = 0, s.outline_width && s.outline_color && (n = s.outline_width, s.size[0] += n, s.size[1] += n, s.outline_edge_pct = n / Math.min(s.size[0], s.size[1]) * 2), s.size[0] = Math.min(s.size[0], 256), s.size[1] = Math.min(s.size[1], 256), s.placement = t2.placement, s.placement_min_length_ratio = StyleParser.evalCachedProperty(t2.placement_min_length_ratio, r), s.placement === PLACEMENT$1.SPACED && t2.placement_spacing && (s.placement_spacing = StyleParser.evalCachedProperty(t2.placement_spacing, r)), s.angle = StyleParser.evalProperty(t2.angle, r) || 0, s.elevate_by_altitude = !!t2.elevate_by_altitude, s.z = t2.z ? MathUtils$1.clamp(StyleParser.evalCachedDistanceProperty(t2.z, r), 0, 32767) : StyleParser.defaults.z, s.flat = t2.flat, s.tile_edges = t2.tile_edges, this.computeLayout(s, e, t2, r, a2), t2.stick && !s.flat && (o = StyleParser.parseNumber(StyleParser.evalProperty(t2.stick.height, r)), s.stick = { color: this.parseColor(t2.stick.color, r) || StyleParser.defaults.color, height: o ? Math.max(o, 0) : 0 });
            var l = t2.text && false !== StyleParser.evalProperty(t2.text.visible, r) && this.parseTextFeature(e, t2.text, r, a2);
            Array.isArray(l) && log({ level: "warn", once: !(l = null) }, "Layer '".concat(t2.layers[t2.layers.length - 1], "': ") + "cannot use boundary labels (e.g. 'text_source: { left: ..., right: ... }') for 'text' labels attached to 'points'; " + "provided 'text_source' value was ".concat(JSON.stringify(t2.text.text_source))), l && (l.layout.parent = s, l.layout.priority = t2.text.priority ? Math.max(l.layout.priority, s.priority + 0.5) : s.priority + 0.5, l.layout.move_into_tile = false, Collision.addStyle(this.collision_group_text, a2.id)), this.queueFeature({ feature: e, draw: t2, context: r, style: s, text_feature: l }, a2), Collision.addStyle(this.collision_group_points, a2.id);
          }
        }, hasSprites: function(e) {
          return e.texture && this.textureManager.textures[e.texture] && this.textureManager.textures[e.texture].sprites;
        }, getSpriteInfo: function(e, t2) {
          var r = this.textureManager.textures[e.texture].sprites[t2] && this.textureManager.getSpriteInfo(e.texture, t2);
          return t2 && !r ? (this.texture_missing_sprites[e.texture] = this.texture_missing_sprites[e.texture] || {}, this.texture_missing_sprites[e.texture][t2] || (log("debug", "Style: in style '".concat(this.name, "', could not find sprite '").concat(t2, "' for texture '").concat(e.texture, "'")), this.texture_missing_sprites[e.texture][t2] = true)) : r && (r.sprite = t2), r;
        }, parseSprite: function(e, t2, r) {
          var i2 = StyleParser.evalProperty(t2.sprite, r);
          return this.getSpriteInfo(e, i2) || this.getSpriteInfo(e, t2.sprite_default);
        }, queueFeature: function(e, t2) {
          this.tile_data[t2.id] && this.queues[t2.id] || this.startData(t2), this.queues[t2.id] = this.queues[t2.id] || [], this.queues[t2.id].push(e);
        }, endData: function(i2) {
          var u2 = this;
          if (i2.canceled)
            return log("trace", "Style ".concat(this.name, ": stop tile build because tile was canceled: ").concat(i2.key)), Promise.resolve();
          var e = this.queues[i2.id];
          delete this.queues[i2.id];
          var c2 = [], h = [];
          return e.forEach(function(e2) {
            for (var t2 = e2.style, r = e2.feature, i3 = r.geometry, n = u2.buildLabels(t2.size, i3, t2), o = 0; o < n.length; o++) {
              var a2, s = n[o], l = { feature: r, draw: e2.draw, context: e2.context, style: t2, label: s };
              h.push(l), e2.text_feature && (a2 = { feature: r, draw: e2.text_feature.draw, context: e2.context, text: e2.text_feature.text, text_settings_key: e2.text_feature.text_settings_key, layout: e2.text_feature.layout, point_label: s, linked: l }, c2.push(a2), e2.draw.text.optional || (l.linked = a2));
            }
          }), Promise.all([Collision.collide(h, this.collision_group_points, i2.id).then(function(e2) {
            e2.forEach(function(e3) {
              u2.feature_style = e3.style, u2.feature_style.label = e3.label, u2.feature_style.linked = e3.linked, Style.addFeature.call(u2, e3.feature, e3.draw, e3.context);
            });
          }), this.collideAndRenderTextLabels(i2, this.collision_group_text, c2)]).then(function(e2) {
            var t2 = _slicedToArray(e2, 2)[1], r = t2.labels, n = t2.texts;
            return r && n && r.forEach(function(e3) {
              var t3 = e3.text_settings_key, r2 = n[t3] && n[t3][e3.text], i3 = u2.feature_style;
              i3.label = e3.label, i3.linked = e3.linked, i3.size = r2.size.logical_size, i3.angle = 0, e3.label.text_data = { text_info: r2, text_settings_key: t3, text: e3.text }, i3.label_texture = u2.textureManager.default, Style.addFeature.call(u2, e3.feature, e3.draw, e3.context);
            }), u2.freeText(i2), Style.endData.call(u2, i2);
          });
        }, _preprocess: function(t2) {
          t2.color = StyleParser.createColorPropertyCache(t2.color), t2.texture = void 0 !== t2.texture ? t2.texture : this.texture, t2.outline && (t2.outline.color = StyleParser.createColorPropertyCache(t2.outline.color), t2.outline.width = StyleParser.createPropertyCache(t2.outline.width, StyleParser.parsePositiveNumber)), t2.z = StyleParser.createPropertyCache(t2.z, StyleParser.parseUnits);
          try {
            t2.size = StyleParser.createPointSizePropertyCache(t2.size);
          } catch (e) {
            return log({ level: "warn", once: true }, "Layer '".concat(t2.layers[t2.layers.length - 1], "': ") + "".concat(e, " (").concat(JSON.stringify(t2.size), "), skipping features in layer")), null;
          }
          return t2.offset = StyleParser.createPropertyCache(t2.offset, function(e) {
            return Array.isArray(e) && e.map(StyleParser.parseNumber);
          }), t2.buffer = StyleParser.createPropertyCache(t2.buffer, function(e) {
            return (Array.isArray(e) ? e : [e, e]).map(StyleParser.parsePositiveNumber);
          }), t2.repeat_distance = StyleParser.createPropertyCache(t2.repeat_distance, StyleParser.parseNumber), null == t2.repeat_group && (t2.repeat_group = t2.layers.join("-")), t2.placement = PLACEMENT$1[t2.placement && t2.placement.toUpperCase()], null == t2.placement && (t2.placement = PLACEMENT$1.VERTEX), t2.placement_spacing = null != t2.placement_spacing ? t2.placement_spacing : 80, t2.placement_spacing = StyleParser.createPropertyCache(t2.placement_spacing, StyleParser.parsePositiveNumber), t2.placement_min_length_ratio = null != t2.placement_min_length_ratio ? t2.placement_min_length_ratio : 1, t2.placement_min_length_ratio = StyleParser.createPropertyCache(t2.placement_min_length_ratio, StyleParser.parsePositiveNumber), "number" == typeof t2.angle ? t2.angle = t2.angle * Math.PI / 180 : t2.angle = t2.angle || 0, t2.text = this.preprocessText(t2.text), t2.text && (t2.text.variantKey = t2.variantKey, t2.text.group = t2.group, t2.text.layers = t2.layers, t2.text.order = t2.order, t2.text.repeat_group = t2.text.repeat_group || t2.repeat_group, t2.text.anchor = t2.text.anchor || this.default_anchor, t2.text.optional = "boolean" == typeof t2.text.optional && t2.text.optional, t2.text.interactive = t2.text.interactive || t2.interactive), t2.stick && (t2.stick.color = StyleParser.createColorPropertyCache(t2.stick.color)), t2;
        }, default_anchor: ["bottom", "top", "right", "left"], computeLayout: function(e, t2, r, i2, n) {
          var o = e || {};
          o.id = t2, o.units_per_pixel = n.units_per_pixel || 1, o.collide = false !== r.collide, o.anchor = r.anchor, o.offset = StyleParser.evalCachedProperty(r.offset, i2) || StyleParser.zeroPair, o.buffer = StyleParser.evalCachedProperty(r.buffer, i2) || StyleParser.zeroPair, o.repeat_distance = StyleParser.evalCachedProperty(r.repeat_distance, i2), o.repeat_distance && (o.repeat_distance *= o.units_per_pixel, o.repeat_scale = 1, "function" == typeof r.repeat_group ? o.repeat_group = r.repeat_group(i2) : o.repeat_group = r.repeat_group);
          var a2 = r.priority;
          return null != a2 ? "function" == typeof a2 && (a2 = a2(i2)) : a2 = -1 >>> 0, o.priority = a2, o;
        }, buildTextLabels: function(e, t2) {
          for (var r = [], i2 = 0; i2 < t2.length; i2++) {
            var n = t2[i2], o = this.texts[e.id][n.text_settings_key][n.text].size.collision_size;
            n.label = new LabelPoint(n.point_label.position, o, n.point_label.isFlat(), n.layout), r.push(n);
          }
          return r;
        }, buildLabels: function(e, t2, r) {
          var i2 = !!r.flat, n = [];
          if ("Point" === t2.type)
            n.push(new LabelPoint(t2.coordinates, e, i2, r));
          else if ("MultiPoint" === t2.type)
            for (var o = t2.coordinates, a2 = 0; a2 < o.length; ++a2) {
              var s = o[a2];
              n.push(new LabelPoint(s, e, i2, r));
            }
          else if ("LineString" === t2.type)
            for (var l = placePointsOnLine(t2.coordinates, e, i2, r), u2 = 0; u2 < l.length; ++u2)
              n.push(l[u2]);
          else if ("MultiLineString" === t2.type)
            for (var c2 = t2.coordinates, h = 0; h < c2.length; h++)
              for (var f2 = placePointsOnLine(c2[h], e, i2, r), d = 0; d < f2.length; ++d)
                n.push(f2[d]);
          else if ("Polygon" === t2.type)
            if (r.placement === PLACEMENT$1.CENTROID) {
              var _ = Geo$1.centroid(t2.coordinates);
              n.push(new LabelPoint(_, e, i2, r));
            } else
              for (var p2 = t2.coordinates, g = 0; g < p2.length; g++)
                for (var m = placePointsOnLine(p2[g], e, i2, r), y = 0; y < m.length; ++y)
                  n.push(m[y]);
          else if ("MultiPolygon" === t2.type)
            if (r.placement === PLACEMENT$1.CENTROID) {
              var v = Geo$1.multiCentroid(t2.coordinates);
              n.push(new LabelPoint(v, e, i2, r));
            } else
              for (var x2 = t2.coordinates, b2 = 0; b2 < x2.length; b2++)
                for (var T2 = x2[b2], A2 = 0; A2 < T2.length; A2++)
                  for (var E2 = placePointsOnLine(T2[A2], e, i2, r), w = 0; w < E2.length; ++w)
                    n.push(E2[w]);
          return n;
        }, makeVertexTemplate: function(e, t2) {
          var r, i2 = e.color || StyleParser.defaults.color, n = t2.vertex_data.vertex_layout;
          return this.fillVertexTemplate(n, "a_position", 0, { size: 2 }), this.fillVertexTemplate(n, "a_position", e.z || 0, { size: 1, offset: 2 }), this.fillVertexTemplate(n, "a_position", this.scaleOrder(e.order), { size: 1, offset: 3 }), this.fillVertexTemplate(n, "a_shape", 0, { size: 4 }), this.fillVertexTemplate(n, "a_shape", e.label.layout.collide ? 0 : 1, { size: 1, offset: 3 }), this.fillVertexTemplate(n, "a_texcoord", 0, { size: 2 }), this.fillVertexTemplate(n, "a_offset", 0, { size: 2 }), this.fillVertexTemplate(n, "a_color", Vector$1.mult(i2, 255), { size: 4 }), this.defines.TANGRAM_HAS_SHADER_POINTS && t2.variant.shader_point && (r = e.outline_color || StyleParser.defaults.outline.color, this.fillVertexTemplate(n, "a_outline_color", Vector$1.mult(r, 255), { size: 4 }), this.fillVertexTemplate(n, "a_outline_edge", e.outline_edge_pct || StyleParser.defaults.outline.width, { size: 1 })), this.selection && this.fillVertexTemplate(n, "a_selection_color", Vector$1.mult(e.selection_color, 255), { size: 4 }), this.fillVertexTemplate(n, "a_is_flat", 0, { size: 1 }), this.defines.TANGRAM_POINT_DRAW_STICK && e.stick && (this.fillVertexTemplate(n, "a_is_stick", 0, { size: 1 }), this.fillVertexTemplate(n, "a_stick_height", e.stick.height, { size: 1 })), this.vertex_template;
        }, buildQuad: function(e, t2, r, i2, n, o, a2, s, l, u2, c2, h, f2, d, _, p2, g, m, y) {
          return t2[0] <= 0 || t2[1] <= 0 ? 0 : buildQuadsForPoints(e, _, p2, { quad: t2, quad_normalize: 256, offset: s, offsets: l, offsets_alt: u2, pre_angles: o, pre_angles_alt: a2, angle: 4096 * r, angles: i2, angles_alt: n, is_flat: f2, elevate_by_altitude: d, build_stick_points: g, stick_color: g && Vector$1.mult(m, 255), color: Vector$1.mult(y || StyleParser.defaults.color, 255), curve: h, texcoord_scale: c2, texcoord_normalize, pre_angles_normalize, angles_normalize, offsets_normalize });
        }, build: function(e, t2, r) {
          var i2 = e.label;
          return "curved" === i2.type ? this.buildCurvedLabel(i2, e, t2, r) : this.buildStraightLabel(i2, e, t2, r);
        }, buildStraightLabel: function(e, t2, r, i2) {
          var n, o = this.makeVertexTemplate(t2, r), a2 = e.angle || t2.angle, s = "point" !== e.type ? (n = t2.size[e.type], default_uvs) : (n = t2.size, t2.texcoords || default_uvs);
          r.uniforms = r.uniforms || {}, t2.label_texture ? (r.uniforms.u_texture = t2.label_texture, r.uniforms.u_point_type = TANGRAM_POINT_TYPE_LABEL, r.uniforms.u_apply_color_blocks = false) : (t2.texture ? (r.uniforms.u_texture = t2.texture, r.uniforms.u_point_type = TANGRAM_POINT_TYPE_TEXTURE) : (r.uniforms.u_texture = this.textureManager.default, r.uniforms.u_point_type = TANGRAM_POINT_TYPE_SHADER), r.uniforms.u_apply_color_blocks = true);
          var l = e.offset, u2 = this.defines.TANGRAM_POINT_DRAW_STICK && !t2.label_texture && t2.stick && 0 < t2.stick.height, c2 = this.buildQuad([e.position], n, a2, null, null, null, null, l, null, null, s, false, e.isFlat(), t2.elevate_by_altitude, r.vertex_data, o, u2, u2 && t2.stick.color, t2.color), h = t2.linked && t2.linked.label.id;
          return this.trackLabel(e, h, r, c2, i2, u2), c2;
        }, buildCurvedLabel: function(e, t2, r, i2) {
          for (var n = this.makeVertexTemplate(t2, r), o = e.angle, a2 = 0, s = 0; s < 2; s++)
            for (var l = 0; l < e.num_segments; l++) {
              var u2 = t2.size[e.type][l], c2 = default_uvs, h = this.getTileMesh(i2.tile, this.getMeshVariantTypeForDraw(t2));
              h.uniforms = h.uniforms || {}, h.uniforms.u_texture = t2.label_texture, h.uniforms.u_point_type = TANGRAM_POINT_TYPE_LABEL, h.uniforms.u_apply_color_blocks = false;
              var f2 = e.offset || [0, 0], d = e.position, _ = e.angles[l], p2 = e.offsets[l], g = e.pre_angles[l], m = e.num_segments - l - 1, y = e.alt_angles[m], v = e.alt_pre_angles[m], x2 = e.alt_offsets[m], b2 = this.buildQuad([d], u2, o, _, y, g, v, f2, p2, x2, c2, true, e.isFlat(), t2.elevate_by_altitude, h.vertex_data, n, false, false, t2.color);
              a2 += b2;
              var T2 = t2.linked && t2.linked.label.id;
              this.trackLabel(e, T2, r, b2, i2, false);
            }
          return a2;
        }, trackLabel: function(e, t2, r, i2, n, o) {
          var a2 = 5 < arguments.length && void 0 !== o && o;
          r.labels = r.labels || {}, r.labels.collision = r.labels.collision || {}, r.labels["non-collision"] = r.labels["non-collision"] || {};
          var s = e.layout.collide ? r.labels.collision : r.labels["non-collision"];
          s[e.id] = s[e.id] || { container: { label: e.text_data ? Object.assign(e.toJSON(), { text_data: e.text_data }) : e.toJSON(), linked: t2 }, ranges: [] };
          var l = 2 * i2, u2 = r.vertex_data.offset - r.vertex_data.stride * l;
          s[e.id].ranges.push([u2, l, a2]);
        }, buildLines: function(e, t2, r, i2) {
          return this.build(t2, r, i2);
        }, buildPoints: function(e, t2, r, i2) {
          return this.build(t2, r, i2);
        }, buildPolygons: function(e, t2, r, i2) {
          return this.build(t2, r, i2);
        }, vertexLayoutForMeshVariant: function(e) {
          var t2;
          return this.vertex_layout || (t2 = [{ name: "a_position", size: 4, type: gl$1.SHORT, normalized: false }, { name: "a_shape", size: 4, type: gl$1.SHORT, normalized: false }, { name: "a_texcoord", size: 2, type: gl$1.UNSIGNED_SHORT, normalized: true }, { name: "a_offset", size: 2, type: gl$1.SHORT, normalized: false }, { name: "a_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_outline_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true, static: [0, 0, 0, 0] }, { name: "a_outline_edge", size: 1, type: gl$1.FLOAT, normalized: false, static: 0 }, { name: "a_selection_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_is_flat", size: 1, type: gl$1.UNSIGNED_BYTE, normalized: true }], this.defines && this.defines.TANGRAM_POINT_DRAW_STICK && t2.push({ name: "a_is_stick", size: 1, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_stick_height", size: 1, type: gl$1.FLOAT, normalized: false }), this.vertex_layout = new VertexLayout(t2), (t2 = t2.map(function(e2) {
            return Object.assign({}, e2);
          })).forEach(function(e2) {
            "a_outline_color" !== e2.name && "a_outline_edge" !== e2.name || (e2.static = null);
          }), this.vertex_layout_shader_point = new VertexLayout(t2)), e.shader_point ? this.vertex_layout_shader_point : this.vertex_layout;
        }, computeVariantForDraw: function(e) {
          var t2 = e.label_texture || e.texture || this.default_mesh_variant.key;
          return { key: t2, shader_point: t2 === this.default_mesh_variant.key, order: e.label_texture ? 1 : 0 };
        }, makeMesh: function(e, t2, r) {
          var i2 = 2 < arguments.length && void 0 !== r ? r : {}, i2 = Object.assign({}, i2, { fade_in_time: this.fade_in_time });
          return Style.makeMesh.call(this, e, t2, i2);
        } });
        var STOPS = [0, 0.33, 0.66, 0.99], LINE_EXCEED_STRAIGHT = 1.5, LINE_EXCEED_STRAIGHT_NO_CURVE = 1.8, LINE_EXCEED_STAIGHT_LOOSE = 2.3, STRAIGHT_ANGLE_TOLERANCE = 0.1, CURVE_MIN_TOTAL_COST = 1.3, CURVE_MIN_AVG_COST = 0.4, CURVE_MAX_ANGLE = 1, ORIENTED_LABEL_OFFSET_FACTOR = 1.2, VERTICAL_ANGLE_TOLERANCE = 0.01, LabelLine = { create: function(e, t2, r, i2, n) {
          for (var o = [{ type: "straight", tolerance: n.no_curving ? LINE_EXCEED_STRAIGHT_NO_CURVE : LINE_EXCEED_STRAIGHT }, { type: "curved" }, { type: "straight", tolerance: LINE_EXCEED_STAIGHT_LOOSE }], a2 = 0; a2 < o.length; a2++) {
            var s = o[a2], l = void 0;
            if ("straight" === s.type ? l = new LabelLineStraight(t2, r, i2, n, s.tolerance) : "curved" === s.type && !n.no_curving && 2 < r.length && (l = new LabelLineCurved(e, r, i2, n)), l && !l.throw_away)
              return l;
          }
          return false;
        } }, LabelLineBase = function() {
          function r(e, t2) {
            _classCallCheck(this, r), this.id = Label.nextLabelId(), this.layout = t2, this.position = [], this.angle = 0, this.offset = t2.offset.slice(), this.unit_scale = this.layout.units_per_pixel, this.type = "", this.throw_away = false, this._is_flat = e, this._circles = void 0, this.placed = null;
          }
          return _createClass(r, [{ key: "toJSON", value: function() {
            return { id: this.id, type: this.type, is_flat: this._is_flat, position: this.position, size: this.size, offset: this.offset, angle: this.angle, breach: this.breach, layout: textLayoutToJSON(this.layout), circles: this.getBoundingCircles() };
          } }, { key: "inTileBounds", value: function() {
            var e = this.getAABB(), t2 = e.left, r2 = e.top, i2 = e.right, n = e.bottom;
            return Utils$1.pointInTile([t2, r2]) && Utils$1.pointInTile([i2, n]);
          } }, { key: "getAABBForSegment", value: function(e, t2, r2, i2) {
            var n, o = this.unit_scale, a2 = t2 / 2, s = r2 / 2, l = _slicedToArray(e, 2), u2 = l[0], c2 = l[1];
            0 === this.offset[0] && 0 === this.offset[1] || (u2 += (n = Vector$1.rot(this.offset, this.angle))[0] * o, c2 -= n[1] * o);
            var h = [[Math.cos(i2), -Math.sin(i2)], [Math.sin(i2), Math.cos(i2)]], f2 = Vector$1.multMatrix(h, [-a2, -s]), d = Vector$1.multMatrix(h, [a2, -s]), _ = Vector$1.multMatrix(h, [a2, s]), p2 = Vector$1.multMatrix(h, [-a2, s]);
            return { left: u2 + Math.min(f2[0], d[0], _[0], p2[0]), top: c2 + Math.max(f2[1], d[1], _[1], p2[1]), right: u2 + Math.max(f2[0], d[0], _[0], p2[0]), bottom: c2 + Math.min(f2[1], d[1], _[1], p2[1]) };
          } }, { key: "isFlat", value: function() {
            return this._is_flat;
          } }, { key: "getBoundingCircles", value: function() {
          } }, { key: "getAABB", value: function() {
          } }], [{ key: "splitLineByOrientation", value: function(e) {
            for (var t2 = [e[0]], r2 = 0, i2 = 0, n = 0, o = t2, a2 = false, s = 1; s < e.length; s++) {
              var l = e[s], u2 = e[s - 1], c2 = Vector$1.length(Vector$1.sub(l, u2));
              l[0] > u2[0] ? 1 === n ? (t2.push(l), i2 < (r2 += c2) && (o = t2, i2 = r2, a2 = false)) : (t2 = [u2, l], i2 < (r2 = c2) && (o = t2, i2 = r2, a2 = false), n = 1) : l[0] < u2[0] ? -1 === n ? (t2.unshift(l), i2 < (r2 += c2) && (o = t2, i2 = r2, a2 = true)) : (t2 = [l, u2], i2 < (r2 = c2) && (o = t2, i2 = r2, a2 = true), n = -1) : (-1 === n ? t2.unshift(l) : (t2.push(l), n = 1), i2 < (r2 += c2) && (o = t2, i2 = r2, a2 = -1 === n));
            }
            return [o, a2];
          } }]), r;
        }(), LabelLineStraight = function() {
          _inherits(s, LabelLineBase);
          var a2 = _createSuper(s);
          function s(e, t2, r, i2, n) {
            var o;
            return _classCallCheck(this, s), (o = a2.call(this, r, i2)).type = "straight", o.size = e, o.throw_away = !o.fit(e, t2, i2, n), o;
          }
          return _createClass(s, [{ key: "fit", value: function(e, t2, r, i2) {
            var n, o = this.unit_scale, a3 = _slicedToArray(LabelLineBase.splitLineByOrientation(t2), 2);
            t2 = a3[0], n = a3[1], "number" == typeof r.orientation && (this.offset[1] += ORIENTED_LABEL_OFFSET_FACTOR * (e[1] - r.vertical_buffer), n && (this.offset[1] *= -1), -1 === r.orientation && (this.offset[1] *= -1));
            for (var s2 = getLineLengths(t2), l = e[0] * o, u2 = 0; u2 < t2.length - 1; u2++)
              for (var c2 = t2[u2], h = 0, f2 = 0, d = u2 + 1, _ = void 0; d < t2.length; ) {
                var p2 = t2[d - 1], g = t2[d], m = getAngleForSegment(p2, g);
                if (d !== u2 + 1 && (h += getAbsAngleDiff(m, _)), Math.abs(h) > STRAIGHT_ANGLE_TOLERANCE)
                  break;
                if (calcFitness(f2 += s2[d - 1], l) < i2) {
                  var y = Vector$1.mult(Vector$1.add(c2, g), 0.5);
                  return this.angle = -m, Math.abs(this.angle - Math.PI / 2) < VERTICAL_ANGLE_TOLERANCE && (this.angle = -Math.PI / 2, "number" == typeof r.orientation && (this.offset[1] *= -1)), this.position = y, this.breach = !this.inTileBounds(), true;
                }
                _ = m, d++;
              }
            return false;
          } }, { key: "getBoundingCircles", value: function() {
            var e, t2, r, i2, n, o, a3, s2, l, u2, c2, h, f2, d;
            return this._circles || (e = this.unit_scale, n = -(r = (t2 = this.size[0] / 2 * e) * Math.cos(this.angle)), o = -(i2 = t2 * Math.sin(this.angle)), a3 = this.offset[0] * e, s2 = this.offset[1] * e, u2 = (l = _slicedToArray(this.position, 2))[0], c2 = l[1], c2 *= -1, a3 && (h = [r, i2], Vector$1.normalize(h), h[0] *= a3, h[1] *= a3, u2 += h[0], c2 += h[1]), s2 && (f2 = [i2, -r], Vector$1.normalize(f2), f2[0] *= s2, f2[1] *= s2, u2 -= f2[0], c2 -= f2[1]), r += u2, i2 += c2, n += u2, o += c2, d = this.size[1] / 2 * e, this._circles = encircleLine(r, i2, n, o, d)), this._circles;
          } }, { key: "getAABB", value: function() {
            var e, t2, r, i2, n;
            return this._aabb || (e = this.unit_scale, t2 = this.size, r = this.layout.buffer, i2 = (t2[0] + 2 * r[0]) * e, n = (t2[1] + 2 * r[1]) * e, this._aabb = this.getAABBForSegment(this.position, i2, n, this.angle)), this._aabb;
          } }]), s;
        }(), LabelLineCurved = function() {
          _inherits(j, LabelLineBase);
          var o = _createSuper(j);
          function j(e, t2, r, i2) {
            var n;
            return _classCallCheck(this, j), (n = o.call(this, r, i2)).type = "curved", n.positions = [], n.angles = [], n._aabbs = [], n.pre_angles = [], n.offsets = [], n.num_segments = e.length, n.sizes = e, n.alt_angles = [], n.alt_pre_angles = [], n.alt_offsets = [], n.throw_away = !n.fit(n.sizes, t2, i2), n;
          }
          return _createClass(j, [{ key: "toJSON", value: function() {
            return { id: this.id, type: this.type, is_flat: this._is_flat, position: this.position, breach: this.breach, layout: textLayoutToJSON(this.layout), circles: this.getBoundingCircles() };
          } }, { key: "fit", value: function(e, t2, r) {
            var i2, n = this.unit_scale, o2 = Math.max.apply(Math, _toConsumableArray(e.map(function(e2) {
              return e2[1];
            }))), a2 = o2 * n, s = _slicedToArray(LabelLineBase.splitLineByOrientation(t2), 2);
            t2 = s[0], i2 = s[1], "number" == typeof r.orientation && (this.offset[1] += ORIENTED_LABEL_OFFSET_FACTOR * (o2 - r.vertical_buffer), i2 && (this.offset[1] *= -1), -1 === r.orientation && (this.offset[1] *= -1));
            var l = getLineLengths(t2), u2 = e.map(function(e2) {
              return e2[0] * n;
            }), c2 = l.reduce(function(e2, t3) {
              return e2 + t3;
            }, 0), h = u2.reduce(function(e2, t3) {
              return e2 + t3;
            }, 0);
            if (c2 < h)
              return false;
            var f2 = t2.length - 1;
            if (f2 < 2)
              return false;
            var d = j.curvaturePlacement(t2, c2, l, h, 0, f2), _ = t2[d];
            if (-1 === d || f2 - d < 2)
              return false;
            this.position = _;
            for (var p2 = 0; p2 < u2.length; p2++) {
              this.positions[p2] = [], this.offsets[p2] = [], this.angles[p2] = [], this.pre_angles[p2] = [];
              for (var g = 0; g < STOPS.length; g++) {
                var m = STOPS[g], y = _slicedToArray(j.scaleLine(m, t2), 2), v = y[0], x2 = y[1], _ = v[d], b2 = j.placeAtIndex(d, v, x2, u2), T2 = b2.positions, A2 = b2.offsets, E2 = b2.angles, w = b2.pre_angles, S2 = A2.map(function(e2) {
                  return Math.sqrt(e2[0] * e2[0] + e2[1] * e2[1]) / n;
                });
                if (0 === m) {
                  this.angle = 1 / E2.length * E2.reduce(function(e2, t3) {
                    return e2 + t3;
                  });
                  for (var k = 0; k < T2.length; k++) {
                    var P2 = T2[k], R2 = w[k], M2 = u2[k], L2 = R2 + E2[k];
                    this._aabbs.push(this.getAABBForSegment(P2, M2, a2, L2));
                  }
                }
                this.positions[p2].push(T2[p2]), this.offsets[p2].push(S2[p2]), this.angles[p2].push(E2[p2]), this.pre_angles[p2].push(w[p2]);
              }
            }
            for (var u2 = e.slice().reverse().map(function(e2) {
              return e2[0] * n;
            }), O2 = 0; O2 < u2.length; O2++) {
              this.alt_offsets[O2] = [], this.alt_angles[O2] = [], this.alt_pre_angles[O2] = [];
              for (var C2 = 0; C2 < STOPS.length; C2++) {
                var N2 = STOPS[C2], I = _slicedToArray(j.scaleLine(N2, t2), 2), B2 = I[0], z2 = I[1];
                _ = B2[d];
                var U2 = j.placeAtIndex(d, B2, z2, u2), F2 = U2.offsets, G = U2.angles, D2 = U2.pre_angles, $ = F2.map(function(e2) {
                  return Math.sqrt(e2[0] * e2[0] + e2[1] * e2[1]) / n;
                });
                0 === N2 && (this.alt_angle = 1 / G.length * G.reduce(function(e2, t3) {
                  return e2 + t3;
                })), this.alt_offsets[O2].push($[O2]), this.alt_angles[O2].push(G[O2]), this.alt_pre_angles[O2].push(D2[O2]);
              }
            }
            return true;
          } }, { key: "getBoundingCircles", value: function() {
            if (!this._circles) {
              for (var e = [], t2 = this.unit_scale, r = 0; r < this.positions.length; r++) {
                var i2 = this.sizes[r], n = this.angles[r][0], o2 = this.positions[r][0], a2 = i2[0] / 2 * t2, s = a2 * Math.cos(n), l = a2 * Math.sin(n), u2 = -s, c2 = -l, h = _slicedToArray(o2, 2), f2 = h[0], d = h[1], _ = encircleLine(s += f2, l += d *= -1, u2 += f2, c2 += d, i2[1] / 2 * t2);
                Array.prototype.push.apply(e, _);
              }
              this._circles = e;
            }
            return this._circles;
          } }, { key: "getAABB", value: function() {
            if (!this._aabb) {
              for (var e = 1 / 0, t2 = -1 / 0, r = -1 / 0, i2 = 1 / 0, n = 0; n < this._aabbs.length; n++)
                var o2 = this._aabbs[n], e = Math.min(e, o2.left), t2 = Math.max(t2, o2.top), r = Math.max(r, o2.right), i2 = Math.min(i2, o2.bottom);
              this._aabb = { left: e, top: t2, right: r, bottom: i2 };
            }
            return this._aabb;
          } }], [{ key: "curvaturePlacement", value: function(e, t2, r, i2, n, o2) {
            n = n || 0, o2 = o2 || e.length - 1;
            for (var a2 = [], s = n + 1; s < o2; s++) {
              var l = e[s - 1], u2 = e[s], c2 = e[s + 1], h = Vector$1.perp(u2, l), f2 = Vector$1.perp(c2, u2), d = Vector$1.angleBetween(h, f2);
              CURVE_MAX_ANGLE < d && (d = 1 / 0), a2.push(d);
            }
            a2.push(1 / 0);
            for (var _ = [], p2 = [], g = n, m = 0, y = 0; y < n; y++)
              m += r[y];
            for (; m + i2 < t2; ) {
              for (var v = m + i2, x2 = m, b2 = g, T2 = 0; b2 < o2 && x2 + r[b2] < v && (T2 += a2[b2]) !== 1 / 0; )
                x2 += r[b2], b2++;
              if (0 === T2)
                return g;
              var A2 = T2 / (b2 - g);
              _.push(T2), p2.push(A2), m += r[g], g++;
            }
            if (0 === _.length)
              return -1;
            var E2 = Math.min.apply(null, _), w = p2[_.indexOf(E2)];
            return E2 < CURVE_MIN_TOTAL_COST && w < CURVE_MIN_AVG_COST ? _.indexOf(E2) : -1;
          } }, { key: "scaleLine", value: function(n, o2) {
            var a2 = [o2[0]], s = [];
            return o2.forEach(function(e, t2) {
              var r, i2;
              t2 !== o2.length - 1 && (r = Vector$1.sub(o2[t2 + 1], o2[t2]), i2 = Vector$1.mult(r, 1 + n), a2.push(Vector$1.add(a2[t2], i2)), s.push(Vector$1.length(i2)));
            }), [a2, s];
          } }, { key: "placeAtIndex", value: function(e, t2, r, i2) {
            var n = t2[e], o2 = _slicedToArray(j.getIndicesAndOffsets(e, r, i2), 2), a2 = o2[0], s = o2[1], l = j.getPositionsFromIndicesAndOffsets(t2, a2, s), u2 = _slicedToArray(j.getAnglesFromIndicesAndOffsets(n, a2, t2, l), 3);
            return { positions: l, offsets: u2[0], angles: u2[1], pre_angles: u2[2] };
          } }, { key: "getIndicesAndOffsets", value: function(e, t2, r) {
            for (var i2 = r.length, n = [], o2 = [], a2 = 0, s = 0, l = 0; a2 < i2; ) {
              for (var u2 = r[a2]; a2 < i2 && s + 0.5 * u2 <= l + t2[e]; ) {
                var c2 = s - l + 0.5 * u2;
                o2.push(c2), n.push(e), s += u2, u2 = r[++a2];
              }
              l += t2[e], e++;
            }
            return [n, o2];
          } }, { key: "getPositionsFromIndicesAndOffsets", value: function(e, t2, r) {
            for (var i2 = [], n = 0; n < t2.length; n++) {
              var o2 = t2[n], a2 = r[n], s = getAngleForSegment(e[o2], e[o2 + 1]), l = Vector$1.rot([a2, 0], s), u2 = Vector$1.add(e[o2], l);
              i2.push(u2);
            }
            return i2;
          } }, { key: "getAnglesFromIndicesAndOffsets", value: function(e, t2, r, i2) {
            for (var n = [], o2 = [], a2 = [], s = 0; s < i2.length; s++) {
              var l, u2, c2 = i2[s], h = t2[s], f2 = Vector$1.sub(c2, e), d = -Vector$1.angle(f2), _ = getTextAngleForSegment(r[h], r[h + 1]) - d;
              0 < s && (l = n[s - 1], u2 = o2[s - 1], Math.abs(d - l) > Math.PI && (d += l < d ? -2 * Math.PI : 2 * Math.PI), Math.abs(u2 - _) > Math.PI && (_ += u2 < _ ? -2 * Math.PI : 2 * Math.PI)), n.push(d), o2.push(_), a2.push(f2);
            }
            return [a2, n, o2];
          } }]), j;
        }();
        function calcFitness(e, t2) {
          return t2 / e;
        }
        function getAngleForSegment(e, t2) {
          var r = Vector$1.sub(t2, e);
          return Vector$1.angle(r);
        }
        function getTextAngleForSegment(e, t2) {
          return -getAngleForSegment(e, t2);
        }
        function getLineLengths(e) {
          for (var t2 = [], r = 0; r < e.length - 1; r++) {
            var i2 = e[r], n = e[r + 1], o = Math.hypot(i2[0] - n[0], i2[1] - n[1]);
            t2.push(o);
          }
          return t2;
        }
        function getAbsAngleDiff(e, t2) {
          for (var r, i2 = t2 < e ? (r = t2, e) : (r = e, t2); i2 - r > Math.PI; )
            r += 2 * Math.PI;
          return Math.abs(i2 - r);
        }
        var TextStyle = Object.create(Points);
        Object.assign(TextStyle, { name: "text", super: Points, built_in: true, init: function(e) {
          var t2 = 0 < arguments.length && void 0 !== e ? e : {};
          Style.init.call(this, t2), this.setupDefines(), this.defines.TANGRAM_HAS_SHADER_POINTS = false, this.defines.TANGRAM_IS_TEXT_STYLE = true, this.reset();
        }, makeVertexTemplate: function(e, t2) {
          this.super.makeVertexTemplate.apply(this, arguments);
          var r = t2.vertex_data.vertex_layout;
          return this.fillVertexTemplate(r, "a_pre_angles", 0, { size: 4 }), this.fillVertexTemplate(r, "a_offsets", 0, { size: 4 }), this.fillVertexTemplate(r, "a_angles", 0, { size: 4 }), this.fillVertexTemplate(r, "a_offsets_alt", 0, { size: 4 }), this.fillVertexTemplate(r, "a_pre_angles_alt", 0, { size: 4 }), this.fillVertexTemplate(r, "a_angles_alt", 0, { size: 4 }), this.vertex_template;
        }, reset: function() {
          this.queues = {}, this.resetText();
        }, addFeature: function(t2, e, r) {
          var i2 = this, n = r.tile, o = t2.geometry.type;
          e.can_articulate = "LineString" === o || "MultiLineString" === o, e.supersample_text = "LineString" === o || "MultiLineString" === o;
          var a2 = this.parseTextFeature(t2, e, r, n);
          a2 && (a2 instanceof Array ? a2.forEach(function(e2) {
            e2.feature = t2, e2.context = r, e2.layout.vertex = false, i2.queueFeature(e2, n);
          }) : (a2.feature = t2, a2.context = r, a2.layout.vertex = false, this.queueFeature(a2, n)), Collision.addStyle(this.name, n.id));
        }, endData: function(n) {
          var o = this, e = this.queues[n.id];
          return delete this.queues[n.id], this.collideAndRenderTextLabels(n, this.name, e).then(function(e2) {
            var t2 = e2.labels, r = e2.texts;
            return t2 && r && (o.texts[n.id] = r, t2.forEach(function(e3) {
              var t3 = e3.text_settings_key, r2 = o.texts[n.id][t3] && o.texts[n.id][t3][e3.text], i2 = o.feature_style;
              i2.label = e3.label, e3.label.text_data = { text_info: r2, text_settings_key: t3, text: e3.text }, i2.label_texture = o.textureManager.default, r2.text_settings.can_articulate ? (i2.size = {}, "straight" === e3.label.type ? i2.size.straight = r2.size.logical_size : i2.size.curved = r2.segment_sizes.map(function(e4) {
                return e4.logical_size;
              })) : i2.size = r2.size.logical_size, Style.addFeature.call(o, e3.feature, e3.draw, e3.context);
            })), o.freeText(n), Style.endData.call(o, n).then(function(e3) {
              if (e3) {
                for (var t3 in e3.meshes)
                  e3.meshes[t3].uniforms.u_apply_color_blocks = true;
                n.mesh_data[o.name] = e3;
              }
              return e3;
            });
          });
        }, _preprocess: function(e) {
          return this.preprocessText(e);
        }, buildTextLabels: function(e, t2) {
          for (var r = [], i2 = 0; i2 < t2.length; i2++) {
            var n, o = t2[i2], a2 = this.texts[e.id][o.text_settings_key][o.text], s = void 0;
            o.layout.vertical_buffer = a2.vertical_buffer, s = a2.text_settings.can_articulate ? (n = a2.segment_sizes.map(function(e2) {
              return e2.collision_size;
            }), o.layout.no_curving = a2.no_curving, this.buildLabels(n, o.feature.geometry, o.layout, a2.size.collision_size)) : this.buildLabels(a2.size.collision_size, o.feature.geometry, o.layout);
            for (var l = 0; l < s.length; l++) {
              var u2 = Object.create(o);
              u2.label = s[l], r.push(u2);
            }
          }
          return r;
        }, buildLabels: function(e, t2, r, i2) {
          var n, o, a2 = "Point" !== t2.type, s = [];
          if ("LineString" === t2.type)
            Array.prototype.push.apply(s, this.buildLineLabels(t2.coordinates, e, a2, r, i2));
          else if ("MultiLineString" === t2.type)
            for (var l = t2.coordinates, u2 = 0; u2 < l.length; ++u2)
              Array.prototype.push.apply(s, this.buildLineLabels(l[u2], e, a2, r, i2));
          else if ("Point" === t2.type)
            s.push(new LabelPoint(t2.coordinates, e, a2, r));
          else if ("MultiPoint" === t2.type)
            for (var c2 = t2.coordinates, h = 0; h < c2.length; ++h)
              s.push(new LabelPoint(c2[h], e, a2, r));
          else {
            "Polygon" === t2.type ? (n = Geo$1.centroid(t2.coordinates), s.push(new LabelPoint(n, e, a2, r))) : "MultiPolygon" === t2.type && (o = Geo$1.multiCentroid(t2.coordinates), s.push(new LabelPoint(o, e, a2, r)));
          }
          return s;
        }, buildLineLabels: function(e, t2, r, i2, n) {
          var o, a2 = [], s = Math.min(i2.subdiv, e.length - 1);
          if (1 < s)
            for (var l = (e.length - 1) / s, u2 = 0; u2 < s; u2++) {
              var c2 = Math.floor(u2 * l), h = Math.floor((u2 + 1) * l) + 1, f2 = e.slice(c2, h), d = LabelLine.create(t2, n, f2, r, i2);
              d && a2.push(d);
            }
          return a2.length < s && ((o = LabelLine.create(t2, n, e, r, i2)) && a2.push(o)), a2;
        }, vertexLayoutForMeshVariant: function() {
          var e;
          return this.vertex_layout || (e = [{ name: "a_position", size: 4, type: gl$1.SHORT, normalized: false }, { name: "a_shape", size: 4, type: gl$1.SHORT, normalized: false }, { name: "a_texcoord", size: 2, type: gl$1.UNSIGNED_SHORT, normalized: true }, { name: "a_offset", size: 2, type: gl$1.SHORT, normalized: false }, { name: "a_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_angles", size: 4, type: gl$1.SHORT, normalized: false }, { name: "a_offsets", size: 4, type: gl$1.UNSIGNED_SHORT, normalized: false }, { name: "a_pre_angles", size: 4, type: gl$1.BYTE, normalized: false }, { name: "a_selection_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_is_flat", size: 1, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_offsets_alt", size: 4, type: gl$1.UNSIGNED_SHORT, normalized: false }, { name: "a_pre_angles_alt", size: 4, type: gl$1.BYTE, normalized: false }, { name: "a_angles_alt", size: 4, type: gl$1.SHORT, normalized: false }], this.vertex_layout = new VertexLayout(e)), this.vertex_layout;
        }, getMeshVariantTypeForDraw: Points.getMeshVariantTypeForDraw }), TextStyle.texture_id = 0;
        var RasterStyle = Object.create(Polygons);
        Object.assign(RasterStyle, { name: "raster", super: Polygons, built_in: true, init: function() {
          this.raster = this.raster || "color", this.super.init.apply(this, arguments), this.selection = false, this.defines.SNAP_TO_PIXEL_GRID = true;
        }, _preprocess: function(e) {
          return e.color = e.color || StyleParser.defaults.color, this.super._preprocess.apply(this, arguments);
        } });
        var CustomIcons = Object.create(Points);
        Object.assign(CustomIcons, { name: "custom_icons", collision: false, init: function(e) {
          var t2 = 0 < arguments.length && void 0 !== e ? e : {};
          Points.init.call(this, t2);
        }, loadTexture: function(e, t2, r) {
          var i2, n = e.width, o = e.height, a2 = e.items, s = document.createElement("canvas"), l = Utils$1.device_pixel_ratio, u2 = this.sources[t2], c2 = { sprites: {} };
          if (s.width = n * l, s.height = o * l, u2) {
            var h, f2 = a2.length, d = s.getContext("2d");
            for (d.scale(l, l); h = a2[--f2]; ) {
              var _, p2 = u2.getIconBitmapByObjectId(h.meta.objectId, h.meta.id);
              p2 && ((_ = isTainting(p2)) ? log("error", _) : (d.drawImage(p2, h.x, h.y, h.width, h.height), c2.sprites[h.meta.id] = [h.x, h.y, h.width, h.height]));
            }
          }
          return c2.element = s, (i2 = this.textureManager.create(this.gl, r, c2)).retain(), i2.loading.then(function(e2) {
            return e2.name;
          });
        }, buildRasterTextures: function(e, t2) {
          return WorkerBroker.postMessage(this.main_thread_target + ".loadTexture", e.rasters, e.source, e.texture_name).then(function(e2) {
            return t2.textures.push(e2), t2;
          });
        }, addFeature: function(e, t2, r) {
          var i2 = r.tile.rasters, n = {};
          i2.items.forEach(function(e2) {
            n[e2.meta.id] = [e2.x, e2.y, e2.width, e2.height];
          });
          var o = "".concat(r.tile.source, "_dyn_").concat(r.tile.coords.key, "_").concat(this.generation, "_").concat(r.tile.id);
          t2.texture = r.tile.texture_name = o;
          var a2 = Object.assign({}, DEFAULT_TEXTURE_INFO, { name: o, width: i2.width, height: i2.height, sprites: n, manager: this.textureManager });
          Texture.prototype.calculateSprites.apply(a2), this.textureManager.textures[o] = a2, Points.addFeature.apply(this, arguments), delete this.textureManager.textures[o];
        } });
        var DEFAULT_TEXTURE_INFO = { filtering: "linear", density: 1, valid: true, power_of_2: false, texcoords: {}, sizes: {}, css_sizes: {}, aspects: {} }, OverlayStyle = Object.create(Polygons);
        Object.assign(OverlayStyle, { name: "overlays", super: Polygons, init: function(e) {
          var t2 = 0 < arguments.length && void 0 !== e ? e : {};
          this.selection = t2.selection || true, this.raster = this.raster || "color", this.super.init.apply(this, arguments);
        }, setupRasters: function() {
          if (!Thread.is_main)
            return false;
          if (this.super.setupRasters.call(this))
            return true;
          var e = false;
          for (var t2 in this.sources)
            if (this.sources[t2] instanceof ObjectSource) {
              e = true;
              break;
            }
          return !!e && (this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING = true, this.replaceShaderBlock("raster", shaderSrc_rasters, "Raster"), true);
        }, loadTextures: function(a2, e) {
          var s, l, u2, c2 = this.sources[e], t2 = a2.name;
          if (a2.overlays_config.forEach(function(e2) {
            var t3, r2 = e2.texcoords, i3 = e2.id, n = c2.getMapObjectById(i3), o = n.getBitmap();
            o && ((t3 = isTainting(o = bitmapToCanvas(o, o.width, o.height))) ? log("error", t3) : (s || ((s = document.createElement("canvas")).width = a2.width, s.height = a2.height, l = s.getContext("2d")), l.save(), l.globalAlpha = n.getOpacity(), r2.forEach(function(e3) {
              return l.drawImage(o, e3[0], e3[1], e3[2], e3[3]);
            }), l.restore(), u2 = true));
          }), u2) {
            a2.element = s;
            var r = {};
            return r[t2] = a2, this.super.loadTextures.call(this, r);
          }
          var i2 = this.textureManager.textures[this.textureManager.default];
          return Promise.resolve([{ name: i2.name, width: i2.width, height: i2.height, loaded: i2.loaded }]);
        }, buildRasterTextures: function(e, r) {
          var t2 = this.sources[e.source].tileTexture(e);
          return t2 ? WorkerBroker.postMessage(this.main_thread_target + ".loadTextures", t2, e.source).then(function(e2) {
            if (!e2 || e2.length < 1)
              return r;
            if (e2.some(function(e3) {
              return !e3.loaded;
            }))
              return null;
            var t3 = e2[0].name;
            return r.uniforms = r.uniforms || {}, r.textures = r.textures || [], r.uniforms.u_raster = t3, r.uniforms.u_raster_offset = [0, 0, 1], r.textures.push(t3), r;
          }) : Promise.resolve(r);
        } });
        var shaderSrc_Vertex = "uniform float u_horizon;uniform float u_tilt;uniform float u_zoom;attribute vec2 a_position;attribute float a_is_sky;attribute float a_is_top;attribute vec4 a_color;varying vec4 v_color;const float SIN_THRESHOLD_ANGLE=0.96126069082;void main(){v_color=a_color;float sin_tilt=sin(u_tilt);float sky_bottom_alpha=1.-max(sin_tilt-SIN_THRESHOLD_ANGLE,0.)*3.;if((a_position.y==1.&&a_is_sky==0.)||(a_position.y==0.&&a_is_sky==1.)){v_color.w=sky_bottom_alpha;}float fog_height=max((22.-u_zoom)*0.04,0.)*(sin_tilt-.7);float position_z=u_zoom<17. ? .942 : .9418;gl_Position=vec4(a_position.x,a_is_sky*(a_position.y+a_is_top)+1.0-u_horizon-(1.0-a_is_sky)*(1.0-a_position.y)*fog_height,position_z,1.0);}", shaderSrc_Fragment = "varying vec4 v_color;void main(void){gl_FragColor=v_color;}", STYLE_NAME = "skybox", SkyBox = Object.create(Style), positions = [-1, 0, 1, 0, -1, 1, -1, 1, 1, 0, 1, 1, -1, 0, 1, 0, -1, 1, -1, 1, 1, 0, 1, 1];
        Object.assign(SkyBox, { name: STYLE_NAME, built_in: true, vertex_shader_src: shaderSrc_Vertex, fragment_shader_src: shaderSrc_Fragment, selection: false, blend: "inlay", blend_order: 1, init: function() {
          Style.init.apply(this, arguments), this.selection = false;
        }, _preprocess: function(e) {
          return e.color = { top: StyleParser.createColorPropertyCache(e.color.zenith), bottom: StyleParser.createColorPropertyCache(e.color.horizon), fog: StyleParser.createColorPropertyCache(e.color.fog) }, e;
        }, vertexLayoutForMeshVariant: function() {
          var e;
          return this.vertex_layout || (e = [{ name: "a_position", size: 2, type: gl$1.FLOAT, normalized: false }, { name: "a_is_sky", size: 1, type: gl$1.FLOAT, normalized: true }, { name: "a_color", size: 4, type: gl$1.UNSIGNED_BYTE, normalized: true }, { name: "a_is_top", size: 1, type: gl$1.FLOAT, normalized: true }], this.vertex_layout = new VertexLayout(e)), this.vertex_layout;
        }, makeVertexTemplate: function() {
          var e = 0;
          return this.vertex_template[e++] = 0, this.vertex_template[1] = 0, this.vertex_template;
        }, parseFeature: function(e, t2, r) {
          var i2 = this.feature_style;
          return t2.color && t2.color.top && t2.color.bottom && (i2.color_top = this.parseColor(t2.color.top, r), i2.color_bottom = this.parseColor(t2.color.bottom, r), i2.color_fog = this.parseColor(t2.color.fog || "white", r), Array.isArray(i2.color_fog) && (i2.color_fog = i2.color_fog.slice(), i2.color_fog[3] = 0)), i2;
        }, buildGeometry: function(e, t2, r) {
          for (var i2 = this.makeVertexTemplate(t2), n = r.vertex_data, o = r.vertex_data.vertex_layout, a2 = n.vertex_layout.index.a_position, s = { top: t2.color_top, bottom: t2.color_bottom }, l = { top: t2.color_bottom, bottom: t2.color_fog }, u2 = 0, c2 = positions.length - 1; u2 < c2; u2 += 2) {
            i2[a2 + 0] = positions[u2], i2[a2 + 1] = positions[u2 + 1];
            var h = u2 < 12, f2 = 0 < positions[u2 + 1], d = h ? s : l;
            this.fillVertexTemplate(o, "a_is_sky", h ? 1 : 0, { size: 1 }), this.fillVertexTemplate(o, "a_is_top", f2 ? 1 : 0, { size: 1 }), this.fillVertexTemplate(o, "a_color", Vector$1.mult(f2 ? d.top : d.bottom, 255), { size: 4 }), n.addVertex(i2);
          }
          return 4;
        } });
        var shaderSrc_accessors = "#ifdef TANGRAM_VERTEX_SHADER\nvec4 modelPosition(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE*exp2(u_tile_origin.z-u_tile_origin.w),1.)+vec4(0.,1.,0.,0.);}vec4 modelPositionBaseZoom(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE,1.)+vec4(0.,1.,0.,0.);}\n#endif\nvec4 worldPosition(){return v_world_position;}\n#ifdef TANGRAM_VERTEX_SHADER\nvec4 wrapWorldPosition(vec4 world_position){\n#if defined(TANGRAM_WORLD_POSITION_WRAP)\nvec2 anchor=u_tile_origin.xy-mod(u_tile_origin.xy,TANGRAM_WORLD_POSITION_WRAP);world_position.xy-=anchor;\n#endif\nreturn world_position;}\n#endif\n#if defined(TANGRAM_VERTEX_SHADER)\nvec3 worldNormal(){return TANGRAM_NORMAL;}\n#elif defined(TANGRAM_FRAGMENT_SHADER)\nvec3 worldNormal(){return u_inverseNormalMatrix*TANGRAM_NORMAL;}\n#endif\n", shaderSrc_layerOrder = "void applyLayerOrder(float layer,inout vec4 position){position.z-=layer*TANGRAM_LAYER_DELTA*position.w;}", shaderSrc_selectionGlobals = "\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nattribute vec4 a_selection_color;varying vec4 v_selection_color;uniform vec4 u_selection_discard0;uniform vec4 u_selection_discard1;uniform vec4 u_selection_discard2;uniform vec4 u_selection_discard3;uniform vec4 u_selection_discard4;uniform vec4 u_selection_discard5;uniform vec4 u_selection_discard6;uniform vec4 u_selection_discard7;uniform vec4 u_selection_discard8;uniform vec4 u_selection_discard9;\n#endif\n", shaderSrc_selectionVertex = "\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nif(a_selection_color.rgb==vec3(0.)||a_selection_color==u_selection_discard0||a_selection_color==u_selection_discard1||a_selection_color==u_selection_discard2||a_selection_color==u_selection_discard3||a_selection_color==u_selection_discard4||a_selection_color==u_selection_discard5||a_selection_color==u_selection_discard6||a_selection_color==u_selection_discard7||a_selection_color==u_selection_discard8||a_selection_color==u_selection_discard9){gl_Position=vec4(0.,0.,0.,1.);return;}v_selection_color=a_selection_color;\n#endif\n", shaderSrc_utils = "#ifndef UTILS\n#define UTILS\nbool isLocalSpacePixelOutsideTile(vec4 pixel_local_space_position,float tile_scale){return pixel_local_space_position.x<0.||pixel_local_space_position.x>=tile_scale||pixel_local_space_position.y>0.||pixel_local_space_position.y<=-tile_scale;}\n#endif\n", shaderSrc_snapToPixelGrid = "uniform float u_view_pan_snap_timer;void snapToPixelGrid(inout vec4 position){vec2 position_fract=fract((((position.xy/position.w)+1.)*.5)*u_resolution);vec2 position_snap=position.xy+((step(0.5,position_fract)-position_fract)*position.w*2./u_resolution);\n#ifdef TANGRAM_VIEW_PAN_SNAP_RATE\nposition.xy=mix(position.xy,position_snap,clamp(u_view_pan_snap_timer*TANGRAM_VIEW_PAN_SNAP_RATE,0.,1.));\n#else\nposition.xy=position_snap;\n#endif\n}", StyleManager = function() {
          function e() {
            _classCallCheck(this, e), this.styles = {}, this.base_styles = {}, this.register(Object.create(Polygons)), this.register(Object.create(Lines)), this.register(Object.create(PatternLines)), this.register(Object.create(Points)), this.register(Object.create(TextStyle)), this.register(Object.create(RasterStyle)), this.register(Object.create(CustomIcons)), this.register(Object.create(OverlayStyle)), this.register(Object.create(SkyBox));
          }
          return _createClass(e, [{ key: "init", value: function() {
            ShaderProgram.removeBlock("global"), ShaderProgram.removeBlock("setup"), ShaderProgram.addBlock("global", shaderSrc_accessors), ShaderProgram.addBlock("global", shaderSrc_layerOrder), ShaderProgram.addBlock("global", shaderSrc_selectionGlobals), ShaderProgram.addBlock("global", shaderSrc_snapToPixelGrid), ShaderProgram.replaceBlock("utils", shaderSrc_utils), ShaderProgram.replaceBlock("setup", shaderSrc_selectionVertex), ShaderProgram.defines.TANGRAM_EPSILON = 1e-5, ShaderProgram.defines.TANGRAM_LAYER_DELTA = 1 / 16384, ShaderProgram.defines.TANGRAM_TILE_SCALE = "vec3(".concat(Geo$1.tile_scale, "., ").concat(Geo$1.tile_scale, "., u_meters_per_pixel * ").concat(Geo$1.tile_size, ".)"), ShaderProgram.defines.TANGRAM_HEIGHT_SCALE = Geo$1.height_scale, ShaderProgram.defines.TANGRAM_ALPHA_TEST = 0.1, Lines.dash_textures = {};
          } }, { key: "destroy", value: function(r) {
            var i2 = this;
            Object.keys(this.styles).forEach(function(e2) {
              var t2 = i2.styles[e2];
              t2.gl === r && (log("trace", "StyleManager.destroy: destroying render style ".concat(t2.name)), t2.base && i2.remove(t2.name), t2.destroy());
            });
          } }, { key: "register", value: function(e2) {
            this.styles[e2.name] = e2, this.base_styles[e2.name] = e2;
          } }, { key: "remove", value: function(e2) {
            delete this.styles[e2];
          } }, { key: "mix", value: function(t2, r) {
            if (t2.mixed)
              return t2;
            t2.mixed = {};
            var e2 = [];
            t2.mix && (Array.isArray(t2.mix) ? e2.push.apply(e2, _toConsumableArray(t2.mix)) : e2.push(t2.mix), (e2 = e2.map(function(e3) {
              return r[e3];
            }).filter(function(e3) {
              return e3 && e3 !== t2;
            })).forEach(function(e3) {
              return t2.mixed[e3.name] = true;
            })), e2.push(t2), t2.animated = e2.some(function(e3) {
              return e3 && e3.animated;
            }), t2.texcoords = e2.some(function(e3) {
              return e3 && e3.texcoords;
            }), t2.base = e2.map(function(e3) {
              return e3.base;
            }).filter(function(e3) {
              return e3;
            }).pop(), t2.lighting = e2.map(function(e3) {
              return e3.lighting;
            }).filter(function(e3) {
              return null != e3;
            }).pop(), t2.texture = e2.map(function(e3) {
              return e3.texture;
            }).filter(function(e3) {
              return e3;
            }).pop(), t2.raster = e2.map(function(e3) {
              return e3.raster;
            }).filter(function(e3) {
              return null != e3;
            }).pop(), t2.dash = e2.map(function(e3) {
              return e3.dash;
            }).filter(function(e3) {
              return null != e3;
            }).pop(), t2.dash_background_color = e2.map(function(e3) {
              return e3.dash_background_color;
            }).filter(function(e3) {
              return null != e3;
            }).pop(), e2.some(function(e3) {
              return e3.hasOwnProperty("blend") && e3.blend;
            }) && (t2.blend = e2.map(function(e3) {
              return e3.hasOwnProperty("blend") && e3.blend;
            }).filter(function(e3) {
              return e3;
            }).pop()), t2.blend_order = e2.map(function(e3) {
              return e3.blend_order;
            }).filter(function(e3) {
              return null != e3;
            }).pop(), t2.defines = Object.assign.apply(Object, [{}].concat(_toConsumableArray(e2.map(function(e3) {
              return e3.defines;
            }).filter(function(e3) {
              return e3;
            })))), t2.material = Object.assign.apply(Object, [{}].concat(_toConsumableArray(e2.map(function(e3) {
              return e3.material;
            }).filter(function(e3) {
              return e3;
            }))));
            var i2 = e2.map(function(e3) {
              return e3.draw;
            }).filter(function(e3) {
              return e3;
            });
            return 0 < i2.length && (t2.draw = mergeObjects.apply(void 0, [{}].concat(_toConsumableArray(i2)))), this.mixShaders(t2, r, e2), t2;
          } }, { key: "mixShaders", value: function(e2, r, t2) {
            var a2 = {}, i2 = t2.map(function(e3) {
              return e3.shaders;
            }).filter(function(e3) {
              return e3;
            });
            if (a2.defines = Object.assign.apply(Object, [{}].concat(_toConsumableArray(i2.map(function(e3) {
              return e3.defines;
            }).filter(function(e3) {
              return e3;
            })))), a2.uniforms = {}, a2._uniforms = e2.shaders && e2.shaders.uniforms || {}, a2._uniform_scopes = {}, t2.filter(function(e3) {
              return e3.shaders && e3.shaders.uniforms;
            }).forEach(function(e3) {
              for (var t3 in e3.shaders.uniforms)
                !function(t4) {
                  a2._uniform_scopes[t4] = e3.name, Object.defineProperty(a2.uniforms, t4, { enumerable: true, configurable: true, get: function() {
                    return void 0 !== a2._uniforms[t4] ? a2._uniforms[t4] : r[a2._uniform_scopes[t4]].shaders.uniforms !== a2.uniforms ? r[a2._uniform_scopes[t4]].shaders.uniforms[t4] : void 0;
                  }, set: function(e4) {
                    a2._uniforms[t4] = e4;
                  } });
                }(t3);
            }), a2.extensions = Object.keys(i2.map(function(e3) {
              return e3.extensions;
            }).filter(function(e3) {
              return e3;
            }).reduce(function(t3, e3) {
              return "string" == typeof e3 ? t3[e3] = true : e3.forEach(function(e4) {
                return t3[e4] = true;
              }), t3;
            }, {}) || {}), e2.shaders && e2.shaders.blocks)
              for (var n in e2.shaders.block_scopes = e2.shaders.block_scopes || {}, e2.shaders.blocks) {
                var o, s = e2.shaders.blocks[n];
                e2.shaders.block_scopes[n] = e2.shaders.block_scopes[n] || [], Array.isArray(s) ? (o = e2.shaders.block_scopes[n]).push.apply(o, _toConsumableArray(s.map(function() {
                  return e2.name;
                }))) : e2.shaders.block_scopes[n].push(e2.name);
              }
            var l = {};
            return i2.forEach(function(e3) {
              if (e3.blocks) {
                a2.blocks = a2.blocks || {}, a2.block_scopes = a2.block_scopes || {};
                var t3 = {};
                for (var r2 in e3.blocks) {
                  var i3 = e3.blocks[r2], n2 = e3.block_scopes[r2];
                  a2.blocks[r2] = a2.blocks[r2] || [], a2.block_scopes[r2] = a2.block_scopes[r2] || [], i3 = Array.isArray(i3) ? i3 : [i3], n2 = Array.isArray(n2) ? n2 : [n2];
                  for (var o2 = 0; o2 < i3.length; o2++)
                    l[n2[o2]] || (t3[n2[o2]] = true, a2.blocks[r2].push(i3[o2]), a2.block_scopes[r2].push(n2[o2]));
                }
                Object.assign(l, t3);
              }
            }), Object.assign(e2.mixed, l), e2.shaders = a2, e2;
          } }, { key: "create", value: function(e2, t2, r) {
            var i2 = 2 < arguments.length && void 0 !== r ? r : {}, n = mergeObjects({}, t2);
            return n.name = e2, (n = this.mix(n, i2)).base && this.base_styles[n.base] ? this.styles[e2] = n = Object.assign(Object.create(this.base_styles[n.base]), n) : n.base = null, n;
          } }, { key: "build", value: function(r) {
            var i2 = this, e2 = Object.keys(r).sort(function(e3, t3) {
              return i2.inheritanceDepth(e3, r) - i2.inheritanceDepth(t3, r);
            });
            for (var t2 in this.styles)
              this.base_styles[t2] ? this.styles[t2].reset() : delete this.styles[t2];
            var n = {};
            return e2.forEach(function(e3) {
              n[e3] = i2.create(e3, r[e3], n);
            }), this.styles;
          } }, { key: "initStyles", value: function(e2) {
            var t2 = 0 < arguments.length && void 0 !== e2 ? e2 : {};
            for (var r in this.styles)
              this.styles[r].init(t2);
          } }, { key: "inheritanceDepth", value: function(t2, r) {
            for (var i2 = this, e2 = 0; ; ) {
              var n = r[t2];
              if (!n)
                break;
              if (!n.mix)
                break;
              if (e2++, Array.isArray(n.mix)) {
                e2 += Math.max.apply(Math, _toConsumableArray(n.mix.map(function(e3) {
                  if (t2 !== e3)
                    return i2.inheritanceDepth(e3, r);
                })));
                break;
              }
              if (t2 === n.mix)
                break;
              t2 = n.mix;
            }
            return e2;
          } }]), e;
        }();
        function isNothing(e) {
          return null == e;
        }
        function isObject$2(e) {
          return "object" == typeof e && null !== e;
        }
        function toArray(e) {
          return Array.isArray(e) ? e : isNothing(e) ? [] : [e];
        }
        function extend$1(e, t2) {
          var r, i2, n, o;
          if (t2)
            for (r = 0, i2 = (o = Object.keys(t2)).length; r < i2; r += 1)
              e[n = o[r]] = t2[n];
          return e;
        }
        function repeat(e, t2) {
          for (var r = "", i2 = 0; i2 < t2; i2 += 1)
            r += e;
          return r;
        }
        function isNegativeZero(e) {
          return 0 === e && Number.NEGATIVE_INFINITY === 1 / e;
        }
        var isNothing_1 = isNothing, isObject_1 = isObject$2, toArray_1 = toArray, repeat_1 = repeat, isNegativeZero_1 = isNegativeZero, extend_1 = extend$1, common = { isNothing: isNothing_1, isObject: isObject_1, toArray: toArray_1, repeat: repeat_1, isNegativeZero: isNegativeZero_1, extend: extend_1 };
        function YAMLException(e, t2) {
          Error.call(this), Error.captureStackTrace ? Error.captureStackTrace(this, this.constructor) : this.stack = new Error().stack || "", this.name = "YAMLException", this.reason = e, this.mark = t2, this.message = (this.reason || "(unknown reason)") + (this.mark ? " " + this.mark.toString() : "");
        }
        YAMLException.prototype = Object.create(Error.prototype), YAMLException.prototype.constructor = YAMLException, YAMLException.prototype.toString = function(e) {
          var t2 = this.name + ": ";
          return t2 += this.reason || "(unknown reason)", !e && this.mark && (t2 += " " + this.mark.toString()), t2;
        };
        var exception = YAMLException;
        function Mark(e, t2, r, i2, n) {
          this.name = e, this.buffer = t2, this.position = r, this.line = i2, this.column = n;
        }
        Mark.prototype.getSnippet = function(e, t2) {
          var r, i2, n, o, a2;
          if (!this.buffer)
            return null;
          for (e = e || 4, t2 = t2 || 75, r = "", i2 = this.position; 0 < i2 && -1 === "\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(i2 - 1)); )
            if (--i2, this.position - i2 > t2 / 2 - 1) {
              r = " ... ", i2 += 5;
              break;
            }
          for (n = "", o = this.position; o < this.buffer.length && -1 === "\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(o)); )
            if ((o += 1) - this.position > t2 / 2 - 1) {
              n = " ... ", o -= 5;
              break;
            }
          return a2 = this.buffer.slice(i2, o), common.repeat(" ", e) + r + a2 + n + "\n" + common.repeat(" ", e + this.position - i2 + r.length) + "^";
        }, Mark.prototype.toString = function(e) {
          var t2, r = "";
          return this.name && (r += 'in "' + this.name + '" '), r += "at line " + (this.line + 1) + ", column " + (this.column + 1), e || (t2 = this.getSnippet()) && (r += ":\n" + t2), r;
        };
        var mark = Mark, TYPE_CONSTRUCTOR_OPTIONS = ["kind", "resolve", "construct", "instanceOf", "predicate", "represent", "defaultStyle", "styleAliases"], YAML_NODE_KINDS = ["scalar", "sequence", "mapping"];
        function compileStyleAliases(e) {
          var r = {};
          return null !== e && Object.keys(e).forEach(function(t2) {
            e[t2].forEach(function(e2) {
              r[String(e2)] = t2;
            });
          }), r;
        }
        function Type(t2, e) {
          if (e = e || {}, Object.keys(e).forEach(function(e2) {
            if (-1 === TYPE_CONSTRUCTOR_OPTIONS.indexOf(e2))
              throw new exception('Unknown option "' + e2 + '" is met in definition of "' + t2 + '" YAML type.');
          }), this.tag = t2, this.kind = e.kind || null, this.resolve = e.resolve || function() {
            return true;
          }, this.construct = e.construct || function(e2) {
            return e2;
          }, this.instanceOf = e.instanceOf || null, this.predicate = e.predicate || null, this.represent = e.represent || null, this.defaultStyle = e.defaultStyle || null, this.styleAliases = compileStyleAliases(e.styleAliases || null), -1 === YAML_NODE_KINDS.indexOf(this.kind))
            throw new exception('Unknown kind "' + this.kind + '" is specified for "' + t2 + '" YAML type.');
        }
        var type = Type;
        function compileList(e, t2, i2) {
          var n = [];
          return e.include.forEach(function(e2) {
            i2 = compileList(e2, t2, i2);
          }), e[t2].forEach(function(r) {
            i2.forEach(function(e2, t3) {
              e2.tag === r.tag && n.push(t3);
            }), i2.push(r);
          }), i2.filter(function(e2, t3) {
            return -1 === n.indexOf(t3);
          });
        }
        function compileMap() {
          var e, t2, r = {};
          function i2(e2) {
            r[e2.tag] = e2;
          }
          for (e = 0, t2 = arguments.length; e < t2; e += 1)
            arguments[e].forEach(i2);
          return r;
        }
        function Schema(e) {
          this.include = e.include || [], this.implicit = e.implicit || [], this.explicit = e.explicit || [], this.implicit.forEach(function(e2) {
            if (e2.loadKind && "scalar" !== e2.loadKind)
              throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");
          }), this.compiledImplicit = compileList(this, "implicit", []), this.compiledExplicit = compileList(this, "explicit", []), this.compiledTypeMap = compileMap(this.compiledImplicit, this.compiledExplicit);
        }
        Schema.DEFAULT = null, Schema.create = function(e, t2) {
          var r, i2;
          switch (arguments.length) {
            case 1:
              r = Schema.DEFAULT, i2 = e;
              break;
            case 2:
              r = e, i2 = t2;
              break;
            default:
              throw new exception("Wrong number of arguments for Schema.create function");
          }
          if (r = common.toArray(r), i2 = common.toArray(i2), !r.every(function(e2) {
            return e2 instanceof Schema;
          }))
            throw new exception("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");
          if (!i2.every(function(e2) {
            return e2 instanceof type;
          }))
            throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");
          return new Schema({ include: r, explicit: i2 });
        };
        var schema = Schema, str = new type("tag:yaml.org,2002:str", { kind: "scalar", construct: function(e) {
          return null !== e ? e : "";
        } }), seq = new type("tag:yaml.org,2002:seq", { kind: "sequence", construct: function(e) {
          return null !== e ? e : [];
        } }), map = new type("tag:yaml.org,2002:map", { kind: "mapping", construct: function(e) {
          return null !== e ? e : {};
        } }), failsafe = new schema({ explicit: [str, seq, map] });
        function resolveYamlNull(e) {
          if (null === e)
            return true;
          var t2 = e.length;
          return 1 === t2 && "~" === e || 4 === t2 && ("null" === e || "Null" === e || "NULL" === e);
        }
        function constructYamlNull() {
          return null;
        }
        function isNull$1(e) {
          return null === e;
        }
        var _null = new type("tag:yaml.org,2002:null", { kind: "scalar", resolve: resolveYamlNull, construct: constructYamlNull, predicate: isNull$1, represent: { canonical: function() {
          return "~";
        }, lowercase: function() {
          return "null";
        }, uppercase: function() {
          return "NULL";
        }, camelcase: function() {
          return "Null";
        } }, defaultStyle: "lowercase" });
        function resolveYamlBoolean(e) {
          if (null === e)
            return false;
          var t2 = e.length;
          return 4 === t2 && ("true" === e || "True" === e || "TRUE" === e) || 5 === t2 && ("false" === e || "False" === e || "FALSE" === e);
        }
        function constructYamlBoolean(e) {
          return "true" === e || "True" === e || "TRUE" === e;
        }
        function isBoolean$1(e) {
          return "[object Boolean]" === Object.prototype.toString.call(e);
        }
        var bool = new type("tag:yaml.org,2002:bool", { kind: "scalar", resolve: resolveYamlBoolean, construct: constructYamlBoolean, predicate: isBoolean$1, represent: { lowercase: function(e) {
          return e ? "true" : "false";
        }, uppercase: function(e) {
          return e ? "TRUE" : "FALSE";
        }, camelcase: function(e) {
          return e ? "True" : "False";
        } }, defaultStyle: "lowercase" });
        function isHexCode(e) {
          return 48 <= e && e <= 57 || 65 <= e && e <= 70 || 97 <= e && e <= 102;
        }
        function isOctCode(e) {
          return 48 <= e && e <= 55;
        }
        function isDecCode(e) {
          return 48 <= e && e <= 57;
        }
        function resolveYamlInteger(e) {
          if (null === e)
            return false;
          var t2, r = e.length, i2 = 0, n = false;
          if (!r)
            return false;
          if ("-" !== (t2 = e[i2]) && "+" !== t2 || (t2 = e[++i2]), "0" === t2) {
            if (i2 + 1 === r)
              return true;
            if ("b" === (t2 = e[++i2])) {
              for (i2++; i2 < r; i2++)
                if ("_" !== (t2 = e[i2])) {
                  if ("0" !== t2 && "1" !== t2)
                    return false;
                  n = true;
                }
              return n;
            }
            if ("x" === t2) {
              for (i2++; i2 < r; i2++)
                if ("_" !== (t2 = e[i2])) {
                  if (!isHexCode(e.charCodeAt(i2)))
                    return false;
                  n = true;
                }
              return n;
            }
            for (; i2 < r; i2++)
              if ("_" !== (t2 = e[i2])) {
                if (!isOctCode(e.charCodeAt(i2)))
                  return false;
                n = true;
              }
            return n;
          }
          for (; i2 < r; i2++)
            if ("_" !== (t2 = e[i2])) {
              if (":" === t2)
                break;
              if (!isDecCode(e.charCodeAt(i2)))
                return false;
              n = true;
            }
          return !!n && (":" !== t2 || /^(:[0-5]?[0-9])+$/.test(e.slice(i2)));
        }
        function constructYamlInteger(e) {
          var t2, r, i2 = e, n = 1, o = [];
          return -1 !== i2.indexOf("_") && (i2 = i2.replace(/_/g, "")), "-" !== (t2 = i2[0]) && "+" !== t2 || ("-" === t2 && (n = -1), t2 = (i2 = i2.slice(1))[0]), "0" === i2 ? 0 : "0" === t2 ? "b" === i2[1] ? n * parseInt(i2.slice(2), 2) : "x" === i2[1] ? n * parseInt(i2, 16) : n * parseInt(i2, 8) : -1 !== i2.indexOf(":") ? (i2.split(":").forEach(function(e2) {
            o.unshift(parseInt(e2, 10));
          }), i2 = 0, r = 1, o.forEach(function(e2) {
            i2 += e2 * r, r *= 60;
          }), n * i2) : n * parseInt(i2, 10);
        }
        function isInteger(e) {
          return "[object Number]" === Object.prototype.toString.call(e) && e % 1 == 0 && !common.isNegativeZero(e);
        }
        var int_1 = new type("tag:yaml.org,2002:int", { kind: "scalar", resolve: resolveYamlInteger, construct: constructYamlInteger, predicate: isInteger, represent: { binary: function(e) {
          return "0b" + e.toString(2);
        }, octal: function(e) {
          return "0" + e.toString(8);
        }, decimal: function(e) {
          return e.toString(10);
        }, hexadecimal: function(e) {
          return "0x" + e.toString(16).toUpperCase();
        } }, defaultStyle: "decimal", styleAliases: { binary: [2, "bin"], octal: [8, "oct"], decimal: [10, "dec"], hexadecimal: [16, "hex"] } }), YAML_FLOAT_PATTERN = new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)\\.[0-9_]*(?:[eE][-+][0-9]+)?|\\.[0-9_]+(?:[eE][-+][0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");
        function resolveYamlFloat(e) {
          return null !== e && !!YAML_FLOAT_PATTERN.test(e);
        }
        function constructYamlFloat(e) {
          var t2, r = e.replace(/_/g, "").toLowerCase(), i2 = "-" === r[0] ? -1 : 1, n = [];
          return 0 <= "+-".indexOf(r[0]) && (r = r.slice(1)), ".inf" === r ? 1 == i2 ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY : ".nan" === r ? NaN : 0 <= r.indexOf(":") ? (r.split(":").forEach(function(e2) {
            n.unshift(parseFloat(e2, 10));
          }), r = 0, t2 = 1, n.forEach(function(e2) {
            r += e2 * t2, t2 *= 60;
          }), i2 * r) : i2 * parseFloat(r, 10);
        }
        var SCIENTIFIC_WITHOUT_DOT = /^[-+]?[0-9]+e/;
        function representYamlFloat(e, t2) {
          var r;
          if (isNaN(e))
            switch (t2) {
              case "lowercase":
                return ".nan";
              case "uppercase":
                return ".NAN";
              case "camelcase":
                return ".NaN";
            }
          else if (Number.POSITIVE_INFINITY === e)
            switch (t2) {
              case "lowercase":
                return ".inf";
              case "uppercase":
                return ".INF";
              case "camelcase":
                return ".Inf";
            }
          else if (Number.NEGATIVE_INFINITY === e)
            switch (t2) {
              case "lowercase":
                return "-.inf";
              case "uppercase":
                return "-.INF";
              case "camelcase":
                return "-.Inf";
            }
          else if (common.isNegativeZero(e))
            return "-0.0";
          return r = e.toString(10), SCIENTIFIC_WITHOUT_DOT.test(r) ? r.replace("e", ".e") : r;
        }
        function isFloat(e) {
          return "[object Number]" === Object.prototype.toString.call(e) && (e % 1 != 0 || common.isNegativeZero(e));
        }
        var float_1$1 = new type("tag:yaml.org,2002:float", { kind: "scalar", resolve: resolveYamlFloat, construct: constructYamlFloat, predicate: isFloat, represent: representYamlFloat, defaultStyle: "lowercase" }), json = new schema({ include: [failsafe], implicit: [_null, bool, int_1, float_1$1] }), core = new schema({ include: [json] }), YAML_TIMESTAMP_REGEXP = new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?)?$");
        function resolveYamlTimestamp(e) {
          return null !== e && null !== YAML_TIMESTAMP_REGEXP.exec(e);
        }
        function constructYamlTimestamp(e) {
          var t2, r, i2, n, o, a2, s, l = 0, u2 = null, c2 = YAML_TIMESTAMP_REGEXP.exec(e);
          if (null === c2)
            throw new Error("Date resolve error");
          if (t2 = +c2[1], r = c2[2] - 1, i2 = +c2[3], !c2[4])
            return new Date(Date.UTC(t2, r, i2));
          if (n = +c2[4], o = +c2[5], a2 = +c2[6], c2[7]) {
            for (l = c2[7].slice(0, 3); l.length < 3; )
              l += "0";
            l = +l;
          }
          return c2[9] && (u2 = 6e4 * (60 * +c2[10] + +(c2[11] || 0)), "-" === c2[9] && (u2 = -u2)), s = new Date(Date.UTC(t2, r, i2, n, o, a2, l)), u2 && s.setTime(s.getTime() - u2), s;
        }
        function representYamlTimestamp(e) {
          return e.toISOString();
        }
        var timestamp = new type("tag:yaml.org,2002:timestamp", { kind: "scalar", resolve: resolveYamlTimestamp, construct: constructYamlTimestamp, instanceOf: Date, represent: representYamlTimestamp });
        function resolveYamlMerge(e) {
          return "<<" === e || null === e;
        }
        var merge = new type("tag:yaml.org,2002:merge", { kind: "scalar", resolve: resolveYamlMerge }), NodeBuffer = bufferEs6.Buffer, BASE64_MAP = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";
        function resolveYamlBinary(e) {
          if (null === e)
            return false;
          for (var t2, r = 0, i2 = e.length, n = BASE64_MAP, o = 0; o < i2; o++)
            if (!(64 < (t2 = n.indexOf(e.charAt(o))))) {
              if (t2 < 0)
                return false;
              r += 6;
            }
          return r % 8 == 0;
        }
        function constructYamlBinary(e) {
          for (var t2, r = e.replace(/[\r\n=]/g, ""), i2 = r.length, n = BASE64_MAP, o = 0, a2 = [], s = 0; s < i2; s++)
            s % 4 == 0 && s && (a2.push(o >> 16 & 255), a2.push(o >> 8 & 255), a2.push(255 & o)), o = o << 6 | n.indexOf(r.charAt(s));
          return 0 == (t2 = i2 % 4 * 6) ? (a2.push(o >> 16 & 255), a2.push(o >> 8 & 255), a2.push(255 & o)) : 18 == t2 ? (a2.push(o >> 10 & 255), a2.push(o >> 2 & 255)) : 12 == t2 && a2.push(o >> 4 & 255), NodeBuffer ? new NodeBuffer(a2) : a2;
        }
        function representYamlBinary(e) {
          for (var t2, r = "", i2 = 0, n = e.length, o = BASE64_MAP, a2 = 0; a2 < n; a2++)
            a2 % 3 == 0 && a2 && (r += o[i2 >> 18 & 63], r += o[i2 >> 12 & 63], r += o[i2 >> 6 & 63], r += o[63 & i2]), i2 = (i2 << 8) + e[a2];
          return 0 == (t2 = n % 3) ? (r += o[i2 >> 18 & 63], r += o[i2 >> 12 & 63], r += o[i2 >> 6 & 63], r += o[63 & i2]) : 2 == t2 ? (r += o[i2 >> 10 & 63], r += o[i2 >> 4 & 63], r += o[i2 << 2 & 63], r += o[64]) : 1 == t2 && (r += o[i2 >> 2 & 63], r += o[i2 << 4 & 63], r += o[64], r += o[64]), r;
        }
        function isBinary(e) {
          return NodeBuffer && NodeBuffer.isBuffer(e);
        }
        var binary = new type("tag:yaml.org,2002:binary", { kind: "scalar", resolve: resolveYamlBinary, construct: constructYamlBinary, predicate: isBinary, represent: representYamlBinary }), _hasOwnProperty = Object.prototype.hasOwnProperty, _toString = Object.prototype.toString;
        function resolveYamlOmap(e) {
          if (null === e)
            return true;
          for (var t2, r, i2, n = [], o = e, a2 = 0, s = o.length; a2 < s; a2 += 1) {
            if (t2 = o[a2], i2 = false, "[object Object]" !== _toString.call(t2))
              return false;
            for (r in t2)
              if (_hasOwnProperty.call(t2, r)) {
                if (i2)
                  return false;
                i2 = true;
              }
            if (!i2)
              return false;
            if (-1 !== n.indexOf(r))
              return false;
            n.push(r);
          }
          return true;
        }
        function constructYamlOmap(e) {
          return null !== e ? e : [];
        }
        var omap = new type("tag:yaml.org,2002:omap", { kind: "sequence", resolve: resolveYamlOmap, construct: constructYamlOmap }), _toString$1 = Object.prototype.toString;
        function resolveYamlPairs(e) {
          if (null === e)
            return true;
          for (var t2, r, i2 = e, n = new Array(i2.length), o = 0, a2 = i2.length; o < a2; o += 1) {
            if (t2 = i2[o], "[object Object]" !== _toString$1.call(t2))
              return false;
            if (1 !== (r = Object.keys(t2)).length)
              return false;
            n[o] = [r[0], t2[r[0]]];
          }
          return true;
        }
        function constructYamlPairs(e) {
          if (null === e)
            return [];
          for (var t2, r, i2 = e, n = new Array(i2.length), o = 0, a2 = i2.length; o < a2; o += 1)
            t2 = i2[o], r = Object.keys(t2), n[o] = [r[0], t2[r[0]]];
          return n;
        }
        var pairs = new type("tag:yaml.org,2002:pairs", { kind: "sequence", resolve: resolveYamlPairs, construct: constructYamlPairs }), _hasOwnProperty$1 = Object.prototype.hasOwnProperty;
        function resolveYamlSet(e) {
          if (null === e)
            return true;
          var t2, r = e;
          for (t2 in r)
            if (_hasOwnProperty$1.call(r, t2) && null !== r[t2])
              return false;
          return true;
        }
        function constructYamlSet(e) {
          return null !== e ? e : {};
        }
        var set$2 = new type("tag:yaml.org,2002:set", { kind: "mapping", resolve: resolveYamlSet, construct: constructYamlSet }), default_safe = new schema({ include: [core], implicit: [timestamp, merge], explicit: [binary, omap, pairs, set$2] });
        function resolveJavascriptUndefined() {
          return true;
        }
        function constructJavascriptUndefined() {
        }
        function representJavascriptUndefined() {
          return "";
        }
        function isUndefined$1(e) {
          return void 0 === e;
        }
        var _undefined = new type("tag:yaml.org,2002:js/undefined", { kind: "scalar", resolve: resolveJavascriptUndefined, construct: constructJavascriptUndefined, predicate: isUndefined$1, represent: representJavascriptUndefined });
        function resolveJavascriptRegExp(e) {
          if (null === e)
            return false;
          if (0 === e.length)
            return false;
          var t2 = e, r = /\/([gim]*)$/.exec(e), i2 = "";
          if ("/" === t2[0]) {
            if (r && (i2 = r[1]), 3 < i2.length)
              return false;
            if ("/" !== t2[t2.length - i2.length - 1])
              return false;
          }
          return true;
        }
        function constructJavascriptRegExp(e) {
          var t2 = e, r = /\/([gim]*)$/.exec(e), i2 = "";
          return "/" === t2[0] && (r && (i2 = r[1]), t2 = t2.slice(1, t2.length - i2.length - 1)), new RegExp(t2, i2);
        }
        function representJavascriptRegExp(e) {
          var t2 = "/" + e.source + "/";
          return e.global && (t2 += "g"), e.multiline && (t2 += "m"), e.ignoreCase && (t2 += "i"), t2;
        }
        function isRegExp$1(e) {
          return "[object RegExp]" === Object.prototype.toString.call(e);
        }
        var regexp = new type("tag:yaml.org,2002:js/regexp", { kind: "scalar", resolve: resolveJavascriptRegExp, construct: constructJavascriptRegExp, predicate: isRegExp$1, represent: representJavascriptRegExp }), esprima;
        try {
          var _require = commonjsRequire, esprima = _require("esprima");
        } catch (e) {
          "undefined" != typeof window && (esprima = window.esprima);
        }
        function resolveJavascriptFunction(e) {
          if (null === e)
            return false;
          try {
            var t2 = "(" + e + ")", r = esprima.parse(t2, { range: true });
            return "Program" !== r.type || 1 !== r.body.length || "ExpressionStatement" !== r.body[0].type || "FunctionExpression" !== r.body[0].expression.type ? false : true;
          } catch (e2) {
            return false;
          }
        }
        function constructJavascriptFunction(e) {
          var t2, r = "(" + e + ")", i2 = esprima.parse(r, { range: true }), n = [];
          if ("Program" !== i2.type || 1 !== i2.body.length || "ExpressionStatement" !== i2.body[0].type || "FunctionExpression" !== i2.body[0].expression.type)
            throw new Error("Failed to resolve function");
          return i2.body[0].expression.params.forEach(function(e2) {
            n.push(e2.name);
          }), t2 = i2.body[0].expression.body.range, new Function(n, r.slice(t2[0] + 1, t2[1] - 1));
        }
        function representJavascriptFunction(e) {
          return e.toString();
        }
        function isFunction$1(e) {
          return "[object Function]" === Object.prototype.toString.call(e);
        }
        var _function = new type("tag:yaml.org,2002:js/function", { kind: "scalar", resolve: resolveJavascriptFunction, construct: constructJavascriptFunction, predicate: isFunction$1, represent: representJavascriptFunction }), default_full = schema.DEFAULT = new schema({ include: [default_safe], explicit: [_undefined, regexp, _function] }), _hasOwnProperty$2 = Object.prototype.hasOwnProperty, CONTEXT_FLOW_IN = 1, CONTEXT_FLOW_OUT = 2, CONTEXT_BLOCK_IN = 3, CONTEXT_BLOCK_OUT = 4, CHOMPING_CLIP = 1, CHOMPING_STRIP = 2, CHOMPING_KEEP = 3, PATTERN_NON_PRINTABLE = /[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/, PATTERN_NON_ASCII_LINE_BREAKS = /[\x85\u2028\u2029]/, PATTERN_FLOW_INDICATORS = /[,\[\]\{\}]/, PATTERN_TAG_HANDLE = /^(?:!|!!|![a-z\-]+!)$/i, PATTERN_TAG_URI = /^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;
        function is_EOL(e) {
          return 10 === e || 13 === e;
        }
        function is_WHITE_SPACE(e) {
          return 9 === e || 32 === e;
        }
        function is_WS_OR_EOL(e) {
          return 9 === e || 32 === e || 10 === e || 13 === e;
        }
        function is_FLOW_INDICATOR(e) {
          return 44 === e || 91 === e || 93 === e || 123 === e || 125 === e;
        }
        function fromHexCode(e) {
          var t2;
          return 48 <= e && e <= 57 ? e - 48 : 97 <= (t2 = 32 | e) && t2 <= 102 ? t2 - 97 + 10 : -1;
        }
        function escapedHexLen(e) {
          return 120 === e ? 2 : 117 === e ? 4 : 85 === e ? 8 : 0;
        }
        function fromDecimalCode(e) {
          return 48 <= e && e <= 57 ? e - 48 : -1;
        }
        function simpleEscapeSequence(e) {
          return 48 === e ? "\0" : 97 === e ? "\x07" : 98 === e ? "\b" : 116 === e || 9 === e ? "	" : 110 === e ? "\n" : 118 === e ? "\v" : 102 === e ? "\f" : 114 === e ? "\r" : 101 === e ? "\x1B" : 32 === e ? " " : 34 === e ? '"' : 47 === e ? "/" : 92 === e ? "\\" : 78 === e ? "" : 95 === e ? "" : 76 === e ? "\u2028" : 80 === e ? "\u2029" : "";
        }
        function charFromCodepoint(e) {
          return e <= 65535 ? String.fromCharCode(e) : String.fromCharCode(55296 + (e - 65536 >> 10), 56320 + (e - 65536 & 1023));
        }
        for (var simpleEscapeCheck = new Array(256), simpleEscapeMap = new Array(256), i = 0; i < 256; i++)
          simpleEscapeCheck[i] = simpleEscapeSequence(i) ? 1 : 0, simpleEscapeMap[i] = simpleEscapeSequence(i);
        function State$1(e, t2) {
          this.input = e, this.filename = t2.filename || null, this.schema = t2.schema || default_full, this.onWarning = t2.onWarning || null, this.legacy = t2.legacy || false, this.json = t2.json || false, this.listener = t2.listener || null, this.implicitTypes = this.schema.compiledImplicit, this.typeMap = this.schema.compiledTypeMap, this.length = e.length, this.position = 0, this.line = 0, this.lineStart = 0, this.lineIndent = 0, this.documents = [];
        }
        function generateError(e, t2) {
          return new exception(t2, new mark(e.filename, e.input, e.position, e.line, e.position - e.lineStart));
        }
        function throwError(e, t2) {
          throw generateError(e, t2);
        }
        function throwWarning(e, t2) {
          e.onWarning && e.onWarning.call(null, generateError(e, t2));
        }
        var directiveHandlers = { YAML: function(e, t2, r) {
          var i2, n, o;
          null !== e.version && throwError(e, "duplication of %YAML directive"), 1 !== r.length && throwError(e, "YAML directive accepts exactly one argument"), null === (i2 = /^([0-9]+)\.([0-9]+)$/.exec(r[0])) && throwError(e, "ill-formed argument of the YAML directive"), n = parseInt(i2[1], 10), o = parseInt(i2[2], 10), 1 !== n && throwError(e, "unacceptable YAML version of the document"), e.version = r[0], e.checkLineBreaks = o < 2, 1 !== o && 2 !== o && throwWarning(e, "unsupported YAML version of the document");
        }, TAG: function(e, t2, r) {
          var i2, n;
          2 !== r.length && throwError(e, "TAG directive accepts exactly two arguments"), i2 = r[0], n = r[1], PATTERN_TAG_HANDLE.test(i2) || throwError(e, "ill-formed tag handle (first argument) of the TAG directive"), _hasOwnProperty$2.call(e.tagMap, i2) && throwError(e, 'there is a previously declared suffix for "' + i2 + '" tag handle'), PATTERN_TAG_URI.test(n) || throwError(e, "ill-formed tag prefix (second argument) of the TAG directive"), e.tagMap[i2] = n;
        } };
        function captureSegment(e, t2, r, i2) {
          var n, o, a2, s;
          if (t2 < r) {
            if (s = e.input.slice(t2, r), i2)
              for (n = 0, o = s.length; n < o; n += 1)
                9 === (a2 = s.charCodeAt(n)) || 32 <= a2 && a2 <= 1114111 || throwError(e, "expected valid JSON character");
            else
              PATTERN_NON_PRINTABLE.test(s) && throwError(e, "the stream contains non-printable characters");
            e.result += s;
          }
        }
        function mergeMappings(e, t2, r, i2) {
          var n, o, a2, s;
          for (common.isObject(r) || throwError(e, "cannot merge mappings; the provided source object is unacceptable"), a2 = 0, s = (n = Object.keys(r)).length; a2 < s; a2 += 1)
            o = n[a2], _hasOwnProperty$2.call(t2, o) || (t2[o] = r[o], i2[o] = true);
        }
        function storeMappingPair(e, t2, r, i2, n, o) {
          var a2, s;
          if (n = String(n), null === t2 && (t2 = {}), "tag:yaml.org,2002:merge" === i2)
            if (Array.isArray(o))
              for (a2 = 0, s = o.length; a2 < s; a2 += 1)
                mergeMappings(e, t2, o[a2], r);
            else
              mergeMappings(e, t2, o, r);
          else
            e.json || _hasOwnProperty$2.call(r, n) || !_hasOwnProperty$2.call(t2, n) || throwError(e, "duplicated mapping key"), t2[n] = o, delete r[n];
          return t2;
        }
        function readLineBreak(e) {
          var t2 = e.input.charCodeAt(e.position);
          10 === t2 ? e.position++ : 13 === t2 ? (e.position++, 10 === e.input.charCodeAt(e.position) && e.position++) : throwError(e, "a line break is expected"), e.line += 1, e.lineStart = e.position;
        }
        function skipSeparationSpace(e, t2, r) {
          for (var i2 = 0, n = e.input.charCodeAt(e.position); 0 !== n; ) {
            for (; is_WHITE_SPACE(n); )
              n = e.input.charCodeAt(++e.position);
            if (t2 && 35 === n)
              for (; 10 !== (n = e.input.charCodeAt(++e.position)) && 13 !== n && 0 !== n; )
                ;
            if (!is_EOL(n))
              break;
            for (readLineBreak(e), n = e.input.charCodeAt(e.position), i2++, e.lineIndent = 0; 32 === n; )
              e.lineIndent++, n = e.input.charCodeAt(++e.position);
          }
          return -1 !== r && 0 !== i2 && e.lineIndent < r && throwWarning(e, "deficient indentation"), i2;
        }
        function testDocumentSeparator(e) {
          var t2 = e.position, r = e.input.charCodeAt(t2);
          return 45 !== r && 46 !== r || r !== e.input.charCodeAt(t2 + 1) || r !== e.input.charCodeAt(t2 + 2) || (t2 += 3, 0 !== (r = e.input.charCodeAt(t2)) && !is_WS_OR_EOL(r)) ? void 0 : 1;
        }
        function writeFoldedLines(e, t2) {
          1 === t2 ? e.result += " " : 1 < t2 && (e.result += common.repeat("\n", t2 - 1));
        }
        function readPlainScalar(e, t2, r) {
          var i2, n, o, a2, s, l, u2, c2 = e.kind, h = e.result, f2 = e.input.charCodeAt(e.position);
          if (!is_WS_OR_EOL(f2) && !is_FLOW_INDICATOR(f2) && 35 !== f2 && 38 !== f2 && 42 !== f2 && 33 !== f2 && 124 !== f2 && 62 !== f2 && 39 !== f2 && 34 !== f2 && 37 !== f2 && 64 !== f2 && 96 !== f2 && (63 !== f2 && 45 !== f2 || !(is_WS_OR_EOL(i2 = e.input.charCodeAt(e.position + 1)) || r && is_FLOW_INDICATOR(i2)))) {
            for (e.kind = "scalar", e.result = "", n = o = e.position, a2 = false; 0 !== f2; ) {
              if (58 === f2) {
                if (is_WS_OR_EOL(i2 = e.input.charCodeAt(e.position + 1)) || r && is_FLOW_INDICATOR(i2))
                  break;
              } else if (35 === f2) {
                if (is_WS_OR_EOL(e.input.charCodeAt(e.position - 1)))
                  break;
              } else {
                if (e.position === e.lineStart && testDocumentSeparator(e) || r && is_FLOW_INDICATOR(f2))
                  break;
                if (is_EOL(f2)) {
                  if (s = e.line, l = e.lineStart, u2 = e.lineIndent, skipSeparationSpace(e, false, -1), e.lineIndent >= t2) {
                    a2 = true, f2 = e.input.charCodeAt(e.position);
                    continue;
                  }
                  e.position = o, e.line = s, e.lineStart = l, e.lineIndent = u2;
                  break;
                }
              }
              a2 && (captureSegment(e, n, o, false), writeFoldedLines(e, e.line - s), n = o = e.position, a2 = false), is_WHITE_SPACE(f2) || (o = e.position + 1), f2 = e.input.charCodeAt(++e.position);
            }
            if (captureSegment(e, n, o, false), e.result)
              return 1;
            e.kind = c2, e.result = h;
          }
        }
        function readSingleQuotedScalar(e, t2) {
          var r, i2, n = e.input.charCodeAt(e.position);
          if (39 === n) {
            for (e.kind = "scalar", e.result = "", e.position++, r = i2 = e.position; 0 !== (n = e.input.charCodeAt(e.position)); )
              if (39 === n) {
                if (captureSegment(e, r, e.position, true), 39 !== (n = e.input.charCodeAt(++e.position)))
                  return 1;
                r = i2 = e.position, e.position++;
              } else
                is_EOL(n) ? (captureSegment(e, r, i2, true), writeFoldedLines(e, skipSeparationSpace(e, false, t2)), r = i2 = e.position) : e.position === e.lineStart && testDocumentSeparator(e) ? throwError(e, "unexpected end of the document within a single quoted scalar") : (e.position++, i2 = e.position);
            throwError(e, "unexpected end of the stream within a single quoted scalar");
          }
        }
        function readDoubleQuotedScalar(e, t2) {
          var r, i2, n, o, a2, s = e.input.charCodeAt(e.position);
          if (34 === s) {
            for (e.kind = "scalar", e.result = "", e.position++, r = i2 = e.position; 0 !== (s = e.input.charCodeAt(e.position)); ) {
              if (34 === s)
                return captureSegment(e, r, e.position, true), e.position++, 1;
              if (92 === s) {
                if (captureSegment(e, r, e.position, true), is_EOL(s = e.input.charCodeAt(++e.position)))
                  skipSeparationSpace(e, false, t2);
                else if (s < 256 && simpleEscapeCheck[s])
                  e.result += simpleEscapeMap[s], e.position++;
                else if (0 < (a2 = escapedHexLen(s))) {
                  for (n = a2, o = 0; 0 < n; n--)
                    0 <= (a2 = fromHexCode(s = e.input.charCodeAt(++e.position))) ? o = (o << 4) + a2 : throwError(e, "expected hexadecimal character");
                  e.result += charFromCodepoint(o), e.position++;
                } else
                  throwError(e, "unknown escape sequence");
                r = i2 = e.position;
              } else
                is_EOL(s) ? (captureSegment(e, r, i2, true), writeFoldedLines(e, skipSeparationSpace(e, false, t2)), r = i2 = e.position) : e.position === e.lineStart && testDocumentSeparator(e) ? throwError(e, "unexpected end of the document within a double quoted scalar") : (e.position++, i2 = e.position);
            }
            throwError(e, "unexpected end of the stream within a double quoted scalar");
          }
        }
        function readFlowCollection(e, t2) {
          var r, i2, n, o, a2, s, l, u2, c2, h = true, f2 = e.tag, d = e.anchor, _ = {}, p2 = e.input.charCodeAt(e.position);
          if (91 === p2)
            s = !(n = 93), i2 = [];
          else {
            if (123 !== p2)
              return;
            n = 125, s = true, i2 = {};
          }
          for (null !== e.anchor && (e.anchorMap[e.anchor] = i2), p2 = e.input.charCodeAt(++e.position); 0 !== p2; ) {
            if (skipSeparationSpace(e, true, t2), (p2 = e.input.charCodeAt(e.position)) === n)
              return e.position++, e.tag = f2, e.anchor = d, e.kind = s ? "mapping" : "sequence", e.result = i2, 1;
            h || throwError(e, "missed comma between flow collection entries"), c2 = null, o = a2 = false, 63 === p2 && is_WS_OR_EOL(e.input.charCodeAt(e.position + 1)) && (o = a2 = true, e.position++, skipSeparationSpace(e, true, t2)), r = e.line, composeNode(e, t2, CONTEXT_FLOW_IN, false, true), u2 = e.tag, l = e.result, skipSeparationSpace(e, true, t2), p2 = e.input.charCodeAt(e.position), !a2 && e.line !== r || 58 !== p2 || (o = true, p2 = e.input.charCodeAt(++e.position), skipSeparationSpace(e, true, t2), composeNode(e, t2, CONTEXT_FLOW_IN, false, true), c2 = e.result), s ? storeMappingPair(e, i2, _, u2, l, c2) : o ? i2.push(storeMappingPair(e, null, _, u2, l, c2)) : i2.push(l), skipSeparationSpace(e, true, t2), 44 === (p2 = e.input.charCodeAt(e.position)) ? (h = true, p2 = e.input.charCodeAt(++e.position)) : h = false;
          }
          throwError(e, "unexpected end of the stream within a flow collection");
        }
        function readBlockScalar(e, t2) {
          var r, i2, n, o = CHOMPING_CLIP, a2 = false, s = t2, l = 0, u2 = false, c2 = e.input.charCodeAt(e.position);
          if (124 === c2)
            i2 = false;
          else {
            if (62 !== c2)
              return;
            i2 = true;
          }
          for (e.kind = "scalar", e.result = ""; 0 !== c2; )
            if (43 === (c2 = e.input.charCodeAt(++e.position)) || 45 === c2)
              CHOMPING_CLIP === o ? o = 43 === c2 ? CHOMPING_KEEP : CHOMPING_STRIP : throwError(e, "repeat of a chomping mode identifier");
            else {
              if (!(0 <= (n = fromDecimalCode(c2))))
                break;
              0 === n ? throwError(e, "bad explicit indentation width of a block scalar; it cannot be less than one") : a2 ? throwError(e, "repeat of an indentation width identifier") : (s = t2 + n - 1, a2 = true);
            }
          if (is_WHITE_SPACE(c2)) {
            for (; is_WHITE_SPACE(c2 = e.input.charCodeAt(++e.position)); )
              ;
            if (35 === c2)
              for (; !is_EOL(c2 = e.input.charCodeAt(++e.position)) && 0 !== c2; )
                ;
          }
          for (; 0 !== c2; ) {
            for (readLineBreak(e), e.lineIndent = 0, c2 = e.input.charCodeAt(e.position); (!a2 || e.lineIndent < s) && 32 === c2; )
              e.lineIndent++, c2 = e.input.charCodeAt(++e.position);
            if (!a2 && e.lineIndent > s && (s = e.lineIndent), is_EOL(c2))
              l++;
            else {
              if (e.lineIndent < s) {
                o === CHOMPING_KEEP ? e.result += common.repeat("\n", l) : o === CHOMPING_CLIP && a2 && (e.result += "\n");
                break;
              }
              for (i2 ? is_WHITE_SPACE(c2) ? (u2 = true, e.result += common.repeat("\n", l + 1)) : u2 ? (u2 = false, e.result += common.repeat("\n", l + 1)) : 0 === l ? a2 && (e.result += " ") : e.result += common.repeat("\n", l) : e.result += a2 ? common.repeat("\n", l + 1) : common.repeat("\n", l), a2 = true, l = 0, r = e.position; !is_EOL(c2) && 0 !== c2; )
                c2 = e.input.charCodeAt(++e.position);
              captureSegment(e, r, e.position, false);
            }
          }
          return 1;
        }
        function readBlockSequence(e, t2) {
          var r, i2, n = e.tag, o = e.anchor, a2 = [], s = false;
          for (null !== e.anchor && (e.anchorMap[e.anchor] = a2), i2 = e.input.charCodeAt(e.position); 0 !== i2 && 45 === i2 && is_WS_OR_EOL(e.input.charCodeAt(e.position + 1)); )
            if (s = true, e.position++, skipSeparationSpace(e, true, -1) && e.lineIndent <= t2)
              a2.push(null), i2 = e.input.charCodeAt(e.position);
            else if (r = e.line, composeNode(e, t2, CONTEXT_BLOCK_IN, false, true), a2.push(e.result), skipSeparationSpace(e, true, -1), i2 = e.input.charCodeAt(e.position), (e.line === r || e.lineIndent > t2) && 0 !== i2)
              throwError(e, "bad indentation of a sequence entry");
            else if (e.lineIndent < t2)
              break;
          return !!s && (e.tag = n, e.anchor = o, e.kind = "sequence", e.result = a2, true);
        }
        function readBlockMapping(e, t2, r) {
          var i2, n, o, a2, s = e.tag, l = e.anchor, u2 = {}, c2 = {}, h = null, f2 = null, d = null, _ = false, p2 = false;
          for (null !== e.anchor && (e.anchorMap[e.anchor] = u2), a2 = e.input.charCodeAt(e.position); 0 !== a2; ) {
            if (i2 = e.input.charCodeAt(e.position + 1), o = e.line, 63 !== a2 && 58 !== a2 || !is_WS_OR_EOL(i2)) {
              if (!composeNode(e, r, CONTEXT_FLOW_OUT, false, true))
                break;
              if (e.line === o) {
                for (a2 = e.input.charCodeAt(e.position); is_WHITE_SPACE(a2); )
                  a2 = e.input.charCodeAt(++e.position);
                if (58 === a2)
                  is_WS_OR_EOL(a2 = e.input.charCodeAt(++e.position)) || throwError(e, "a whitespace character is expected after the key-value separator within a block mapping"), _ && (storeMappingPair(e, u2, c2, h, f2, null), h = f2 = d = null), n = _ = !(p2 = true), h = e.tag, f2 = e.result;
                else {
                  if (!p2)
                    return e.tag = s, e.anchor = l, 1;
                  throwError(e, "can not read an implicit mapping pair; a colon is missed");
                }
              } else {
                if (!p2)
                  return e.tag = s, e.anchor = l, 1;
                throwError(e, "can not read a block mapping entry; a multiline key may not be an implicit key");
              }
            } else
              63 === a2 ? (_ && (storeMappingPair(e, u2, c2, h, f2, null), h = f2 = d = null), n = _ = p2 = true) : _ ? n = !(_ = false) : throwError(e, "incomplete explicit mapping pair; a key node is missed"), e.position += 1, a2 = i2;
            if ((e.line === o || e.lineIndent > t2) && (composeNode(e, t2, CONTEXT_BLOCK_OUT, true, n) && (_ ? f2 = e.result : d = e.result), _ || (storeMappingPair(e, u2, c2, h, f2, d), h = f2 = d = null), skipSeparationSpace(e, true, -1), a2 = e.input.charCodeAt(e.position)), e.lineIndent > t2 && 0 !== a2)
              throwError(e, "bad indentation of a mapping entry");
            else if (e.lineIndent < t2)
              break;
          }
          return _ && storeMappingPair(e, u2, c2, h, f2, null), p2 && (e.tag = s, e.anchor = l, e.kind = "mapping", e.result = u2), p2;
        }
        function readTagProperty(e) {
          var t2, r, i2, n = false, o = false, a2 = e.input.charCodeAt(e.position);
          if (33 === a2) {
            if (null !== e.tag && throwError(e, "duplication of a tag property"), 60 === (a2 = e.input.charCodeAt(++e.position)) ? (n = true, a2 = e.input.charCodeAt(++e.position)) : 33 === a2 ? (o = true, r = "!!", a2 = e.input.charCodeAt(++e.position)) : r = "!", t2 = e.position, n) {
              for (; 0 !== (a2 = e.input.charCodeAt(++e.position)) && 62 !== a2; )
                ;
              e.position < e.length ? (i2 = e.input.slice(t2, e.position), a2 = e.input.charCodeAt(++e.position)) : throwError(e, "unexpected end of the stream within a verbatim tag");
            } else {
              for (; 0 !== a2 && !is_WS_OR_EOL(a2); )
                33 === a2 && (o ? throwError(e, "tag suffix cannot contain exclamation marks") : (r = e.input.slice(t2 - 1, e.position + 1), PATTERN_TAG_HANDLE.test(r) || throwError(e, "named tag handle cannot contain such characters"), o = true, t2 = e.position + 1)), a2 = e.input.charCodeAt(++e.position);
              i2 = e.input.slice(t2, e.position), PATTERN_FLOW_INDICATORS.test(i2) && throwError(e, "tag suffix cannot contain flow indicator characters");
            }
            return i2 && !PATTERN_TAG_URI.test(i2) && throwError(e, "tag name cannot contain such characters: " + i2), n ? e.tag = i2 : _hasOwnProperty$2.call(e.tagMap, r) ? e.tag = e.tagMap[r] + i2 : "!" === r ? e.tag = "!" + i2 : "!!" === r ? e.tag = "tag:yaml.org,2002:" + i2 : throwError(e, 'undeclared tag handle "' + r + '"'), 1;
          }
        }
        function readAnchorProperty(e) {
          var t2, r = e.input.charCodeAt(e.position);
          if (38 === r) {
            for (null !== e.anchor && throwError(e, "duplication of an anchor property"), r = e.input.charCodeAt(++e.position), t2 = e.position; 0 !== r && !is_WS_OR_EOL(r) && !is_FLOW_INDICATOR(r); )
              r = e.input.charCodeAt(++e.position);
            return e.position === t2 && throwError(e, "name of an anchor node must contain at least one character"), e.anchor = e.input.slice(t2, e.position), 1;
          }
        }
        function readAlias(e) {
          var t2, r, i2 = e.input.charCodeAt(e.position);
          if (42 === i2) {
            for (i2 = e.input.charCodeAt(++e.position), t2 = e.position; 0 !== i2 && !is_WS_OR_EOL(i2) && !is_FLOW_INDICATOR(i2); )
              i2 = e.input.charCodeAt(++e.position);
            return e.position === t2 && throwError(e, "name of an alias node must contain at least one character"), r = e.input.slice(t2, e.position), e.anchorMap.hasOwnProperty(r) || throwError(e, 'unidentified alias "' + r + '"'), e.result = e.anchorMap[r], skipSeparationSpace(e, true, -1), 1;
          }
        }
        function composeNode(e, t2, r, i2, n) {
          var o, a2, s, l, u2, c2, h, f2, d = 1, _ = false, p2 = false;
          if (null !== e.listener && e.listener("open", e), e.tag = null, e.anchor = null, e.kind = null, e.result = null, o = a2 = s = CONTEXT_BLOCK_OUT === r || CONTEXT_BLOCK_IN === r, i2 && skipSeparationSpace(e, true, -1) && (_ = true, e.lineIndent > t2 ? d = 1 : e.lineIndent === t2 ? d = 0 : e.lineIndent < t2 && (d = -1)), 1 === d)
            for (; readTagProperty(e) || readAnchorProperty(e); )
              skipSeparationSpace(e, true, -1) ? (_ = true, s = o, e.lineIndent > t2 ? d = 1 : e.lineIndent === t2 ? d = 0 : e.lineIndent < t2 && (d = -1)) : s = false;
          if (s = s && (_ || n), 1 !== d && CONTEXT_BLOCK_OUT !== r || (h = CONTEXT_FLOW_IN === r || CONTEXT_FLOW_OUT === r ? t2 : t2 + 1, f2 = e.position - e.lineStart, 1 === d ? s && (readBlockSequence(e, f2) || readBlockMapping(e, f2, h)) || readFlowCollection(e, h) ? p2 = true : (a2 && readBlockScalar(e, h) || readSingleQuotedScalar(e, h) || readDoubleQuotedScalar(e, h) ? p2 = true : readAlias(e) ? (p2 = true, null === e.tag && null === e.anchor || throwError(e, "alias node should not have any properties")) : readPlainScalar(e, h, CONTEXT_FLOW_IN === r) && (p2 = true, null === e.tag && (e.tag = "?")), null !== e.anchor && (e.anchorMap[e.anchor] = e.result)) : 0 === d && (p2 = s && readBlockSequence(e, f2))), null !== e.tag && "!" !== e.tag)
            if ("?" === e.tag) {
              for (l = 0, u2 = e.implicitTypes.length; l < u2; l += 1)
                if ((c2 = e.implicitTypes[l]).resolve(e.result)) {
                  e.result = c2.construct(e.result), e.tag = c2.tag, null !== e.anchor && (e.anchorMap[e.anchor] = e.result);
                  break;
                }
            } else
              _hasOwnProperty$2.call(e.typeMap, e.tag) ? (c2 = e.typeMap[e.tag], null !== e.result && c2.kind !== e.kind && throwError(e, "unacceptable node kind for !<" + e.tag + '> tag; it should be "' + c2.kind + '", not "' + e.kind + '"'), c2.resolve(e.result) ? (e.result = c2.construct(e.result), null !== e.anchor && (e.anchorMap[e.anchor] = e.result)) : throwError(e, "cannot resolve a node with !<" + e.tag + "> explicit tag")) : throwError(e, "unknown tag !<" + e.tag + ">");
          return null !== e.listener && e.listener("close", e), null !== e.tag || null !== e.anchor || p2;
        }
        function readDocument(e) {
          var t2, r, i2, n, o = e.position, a2 = false;
          for (e.version = null, e.checkLineBreaks = e.legacy, e.tagMap = {}, e.anchorMap = {}; 0 !== (n = e.input.charCodeAt(e.position)) && (skipSeparationSpace(e, true, -1), n = e.input.charCodeAt(e.position), !(0 < e.lineIndent || 37 !== n)); ) {
            for (a2 = true, n = e.input.charCodeAt(++e.position), t2 = e.position; 0 !== n && !is_WS_OR_EOL(n); )
              n = e.input.charCodeAt(++e.position);
            for (i2 = [], (r = e.input.slice(t2, e.position)).length < 1 && throwError(e, "directive name must not be less than one character in length"); 0 !== n; ) {
              for (; is_WHITE_SPACE(n); )
                n = e.input.charCodeAt(++e.position);
              if (35 === n) {
                for (; 0 !== (n = e.input.charCodeAt(++e.position)) && !is_EOL(n); )
                  ;
                break;
              }
              if (is_EOL(n))
                break;
              for (t2 = e.position; 0 !== n && !is_WS_OR_EOL(n); )
                n = e.input.charCodeAt(++e.position);
              i2.push(e.input.slice(t2, e.position));
            }
            0 !== n && readLineBreak(e), _hasOwnProperty$2.call(directiveHandlers, r) ? directiveHandlers[r](e, r, i2) : throwWarning(e, 'unknown document directive "' + r + '"');
          }
          skipSeparationSpace(e, true, -1), 0 === e.lineIndent && 45 === e.input.charCodeAt(e.position) && 45 === e.input.charCodeAt(e.position + 1) && 45 === e.input.charCodeAt(e.position + 2) ? (e.position += 3, skipSeparationSpace(e, true, -1)) : a2 && throwError(e, "directives end mark is expected"), composeNode(e, e.lineIndent - 1, CONTEXT_BLOCK_OUT, false, true), skipSeparationSpace(e, true, -1), e.checkLineBreaks && PATTERN_NON_ASCII_LINE_BREAKS.test(e.input.slice(o, e.position)) && throwWarning(e, "non-ASCII line breaks are interpreted as content"), e.documents.push(e.result), e.position === e.lineStart && testDocumentSeparator(e) ? 46 === e.input.charCodeAt(e.position) && (e.position += 3, skipSeparationSpace(e, true, -1)) : e.position < e.length - 1 && throwError(e, "end of the stream or a document separator is expected");
        }
        function loadDocuments(e, t2) {
          t2 = t2 || {}, 0 !== (e = String(e)).length && (10 !== e.charCodeAt(e.length - 1) && 13 !== e.charCodeAt(e.length - 1) && (e += "\n"), 65279 === e.charCodeAt(0) && (e = e.slice(1)));
          var r = new State$1(e, t2);
          for (r.input += "\0"; 32 === r.input.charCodeAt(r.position); )
            r.lineIndent += 1, r.position += 1;
          for (; r.position < r.length - 1; )
            readDocument(r);
          return r.documents;
        }
        function loadAll(e, t2, r) {
          for (var i2 = loadDocuments(e, r), n = 0, o = i2.length; n < o; n += 1)
            t2(i2[n]);
        }
        function load(e, t2) {
          var r = loadDocuments(e, t2);
          if (0 !== r.length) {
            if (1 === r.length)
              return r[0];
            throw new exception("expected a single document in the stream, but found more");
          }
        }
        function safeLoadAll(e, t2, r) {
          loadAll(e, t2, common.extend({ schema: default_safe }, r));
        }
        function safeLoad(e, t2) {
          return load(e, common.extend({ schema: default_safe }, t2));
        }
        var loadAll_1 = loadAll, load_1 = load, safeLoadAll_1 = safeLoadAll, safeLoad_1 = safeLoad, loader = { loadAll: loadAll_1, load: load_1, safeLoadAll: safeLoadAll_1, safeLoad: safeLoad_1 }, _toString$2 = Object.prototype.toString, _hasOwnProperty$3 = Object.prototype.hasOwnProperty, CHAR_TAB = 9, CHAR_LINE_FEED = 10, CHAR_CARRIAGE_RETURN = 13, CHAR_SPACE = 32, CHAR_EXCLAMATION = 33, CHAR_DOUBLE_QUOTE = 34, CHAR_SHARP = 35, CHAR_PERCENT = 37, CHAR_AMPERSAND = 38, CHAR_SINGLE_QUOTE = 39, CHAR_ASTERISK = 42, CHAR_COMMA = 44, CHAR_MINUS = 45, CHAR_COLON = 58, CHAR_GREATER_THAN = 62, CHAR_QUESTION = 63, CHAR_COMMERCIAL_AT = 64, CHAR_LEFT_SQUARE_BRACKET = 91, CHAR_RIGHT_SQUARE_BRACKET = 93, CHAR_GRAVE_ACCENT = 96, CHAR_LEFT_CURLY_BRACKET = 123, CHAR_VERTICAL_LINE = 124, CHAR_RIGHT_CURLY_BRACKET = 125, ESCAPE_SEQUENCES = { 0: "\\0", 7: "\\a", 8: "\\b", 9: "\\t", 10: "\\n", 11: "\\v", 12: "\\f", 13: "\\r", 27: "\\e", 34: '\\"', 92: "\\\\", 133: "\\N", 160: "\\_", 8232: "\\L", 8233: "\\P" }, DEPRECATED_BOOLEANS_SYNTAX = ["y", "Y", "yes", "Yes", "YES", "on", "On", "ON", "n", "N", "no", "No", "NO", "off", "Off", "OFF"];
        function compileStyleMap(e, t2) {
          var r, i2, n, o, a2, s, l;
          if (null === t2)
            return {};
          for (r = {}, n = 0, o = (i2 = Object.keys(t2)).length; n < o; n += 1)
            a2 = i2[n], s = String(t2[a2]), "!!" === a2.slice(0, 2) && (a2 = "tag:yaml.org,2002:" + a2.slice(2)), (l = e.compiledTypeMap[a2]) && _hasOwnProperty$3.call(l.styleAliases, s) && (s = l.styleAliases[s]), r[a2] = s;
          return r;
        }
        function encodeHex(e) {
          var t2, r, i2 = e.toString(16).toUpperCase();
          if (e <= 255)
            t2 = "x", r = 2;
          else if (e <= 65535)
            t2 = "u", r = 4;
          else {
            if (!(e <= 4294967295))
              throw new exception("code point within a string may not be greater than 0xFFFFFFFF");
            t2 = "U", r = 8;
          }
          return "\\" + t2 + common.repeat("0", r - i2.length) + i2;
        }
        function State$2(e) {
          this.schema = e.schema || default_full, this.indent = Math.max(1, e.indent || 2), this.skipInvalid = e.skipInvalid || false, this.flowLevel = common.isNothing(e.flowLevel) ? -1 : e.flowLevel, this.styleMap = compileStyleMap(this.schema, e.styles || null), this.sortKeys = e.sortKeys || false, this.lineWidth = e.lineWidth || 80, this.noRefs = e.noRefs || false, this.implicitTypes = this.schema.compiledImplicit, this.explicitTypes = this.schema.compiledExplicit, this.tag = null, this.result = "", this.duplicates = [], this.usedDuplicates = null;
        }
        function indentString(e, t2) {
          for (var r, i2 = common.repeat(" ", t2), n = 0, o = -1, a2 = "", s = e.length; n < s; )
            n = -1 === (o = e.indexOf("\n", n)) ? (r = e.slice(n), s) : (r = e.slice(n, o + 1), o + 1), r.length && "\n" !== r && (a2 += i2), a2 += r;
          return a2;
        }
        function generateNextLine(e, t2) {
          return "\n" + common.repeat(" ", e.indent * t2);
        }
        function testImplicitResolving(e, t2) {
          for (var r = 0, i2 = e.implicitTypes.length; r < i2; r += 1)
            if (e.implicitTypes[r].resolve(t2))
              return 1;
        }
        function StringBuilder(e) {
          this.source = e, this.result = "", this.checkpoint = 0;
        }
        function writeScalar(e, t2, r, i2) {
          var n, o, a2, s, l, u2, c2, h, f2, d, _, p2, g, m, y, v, x2, b2, T2, A2;
          if (0 !== t2.length)
            if (-1 === DEPRECATED_BOOLEANS_SYNTAX.indexOf(t2)) {
              for (n = true, o = t2.length ? t2.charCodeAt(0) : 0, a2 = CHAR_SPACE === o || CHAR_SPACE === t2.charCodeAt(t2.length - 1), CHAR_MINUS !== o && CHAR_QUESTION !== o && CHAR_COMMERCIAL_AT !== o && CHAR_GRAVE_ACCENT !== o || (n = false), l = s = a2 || -1 < e.flowLevel && e.flowLevel <= r ? (a2 && (n = false), false) : !i2, u2 = true, c2 = new StringBuilder(t2), h = false, d = f2 = 0, _ = e.indent * r, -1 === (p2 = e.lineWidth) && (p2 = 9007199254740991), _ < 40 ? p2 -= _ : p2 = 40, m = 0; m < t2.length; m++) {
                if (g = t2.charCodeAt(m), n) {
                  if (simpleChar(g))
                    continue;
                  n = false;
                }
                u2 && g === CHAR_SINGLE_QUOTE && (u2 = false), y = ESCAPE_SEQUENCES[g], v = needsHexEscape(g), (y || v) && (g !== CHAR_LINE_FEED && g !== CHAR_DOUBLE_QUOTE && g !== CHAR_SINGLE_QUOTE ? l = s = false : g === CHAR_LINE_FEED && (u2 = !(h = true), 0 < m && t2.charCodeAt(m - 1) === CHAR_SPACE && (s = l = false), s && (x2 = m - f2, f2 = m, d < x2 && (d = x2))), g !== CHAR_DOUBLE_QUOTE && (u2 = false), c2.takeUpTo(m), c2.escapeChar());
              }
              if (n && testImplicitResolving(e, t2) && (n = false), b2 = "", (s || l) && (T2 = 0, t2.charCodeAt(t2.length - 1) === CHAR_LINE_FEED && (T2 += 1, t2.charCodeAt(t2.length - 2) === CHAR_LINE_FEED && (T2 += 1)), 0 === T2 ? b2 = "-" : 2 === T2 && (b2 = "+")), (l && d < p2 || null !== e.tag) && (s = false), h || (l = false), n)
                e.dump = t2;
              else if (u2)
                e.dump = "'" + t2 + "'";
              else if (s)
                A2 = fold(t2, p2), e.dump = ">" + b2 + "\n" + indentString(A2, _);
              else if (l)
                b2 || (t2 = t2.replace(/\n$/, "")), e.dump = "|" + b2 + "\n" + indentString(t2, _);
              else {
                if (!c2)
                  throw new Error("Failed to dump scalar value");
                c2.finish(), e.dump = '"' + c2.result + '"';
              }
            } else
              e.dump = "'" + t2 + "'";
          else
            e.dump = "''";
        }
        function fold(e, t2) {
          var r, i2 = "", n = 0, o = e.length, a2 = /\n+$/.exec(e);
          for (a2 && (o = a2.index + 1); n < o; )
            n = o < (r = e.indexOf("\n", n)) || -1 === r ? (i2 && (i2 += "\n\n"), i2 += foldLine(e.slice(n, o), t2), o) : (i2 && (i2 += "\n\n"), i2 += foldLine(e.slice(n, r), t2), r + 1);
          return a2 && "\n" !== a2[0] && (i2 += a2[0]), i2;
        }
        function foldLine(e, t2) {
          if ("" === e)
            return e;
          for (var r, i2, n = /[^\s] [^\s]/g, o = "", a2 = 0, s = 0, l = n.exec(e); l; )
            t2 < (r = l.index) - s && (i2 = a2 !== s ? a2 : r, o && (o += "\n"), o += e.slice(s, i2), s = i2 + 1), a2 = r + 1, l = n.exec(e);
          return o && (o += "\n"), s !== a2 && e.length - s > t2 ? o += e.slice(s, a2) + "\n" + e.slice(a2 + 1) : o += e.slice(s), o;
        }
        function simpleChar(e) {
          return CHAR_TAB !== e && CHAR_LINE_FEED !== e && CHAR_CARRIAGE_RETURN !== e && CHAR_COMMA !== e && CHAR_LEFT_SQUARE_BRACKET !== e && CHAR_RIGHT_SQUARE_BRACKET !== e && CHAR_LEFT_CURLY_BRACKET !== e && CHAR_RIGHT_CURLY_BRACKET !== e && CHAR_SHARP !== e && CHAR_AMPERSAND !== e && CHAR_ASTERISK !== e && CHAR_EXCLAMATION !== e && CHAR_VERTICAL_LINE !== e && CHAR_GREATER_THAN !== e && CHAR_SINGLE_QUOTE !== e && CHAR_DOUBLE_QUOTE !== e && CHAR_PERCENT !== e && CHAR_COLON !== e && !ESCAPE_SEQUENCES[e] && !needsHexEscape(e);
        }
        function needsHexEscape(e) {
          return !(32 <= e && e <= 126 || 133 === e || 160 <= e && e <= 55295 || 57344 <= e && e <= 65533 || 65536 <= e && e <= 1114111);
        }
        function writeFlowSequence(e, t2, r) {
          for (var i2 = "", n = e.tag, o = 0, a2 = r.length; o < a2; o += 1)
            writeNode(e, t2, r[o], false, false) && (0 !== o && (i2 += ", "), i2 += e.dump);
          e.tag = n, e.dump = "[" + i2 + "]";
        }
        function writeBlockSequence(e, t2, r, i2) {
          for (var n = "", o = e.tag, a2 = 0, s = r.length; a2 < s; a2 += 1)
            writeNode(e, t2 + 1, r[a2], true, true) && (i2 && 0 === a2 || (n += generateNextLine(e, t2)), n += "- " + e.dump);
          e.tag = o, e.dump = n || "[]";
        }
        function writeFlowMapping(e, t2, r) {
          for (var i2, n, o, a2 = "", s = e.tag, l = Object.keys(r), u2 = 0, c2 = l.length; u2 < c2; u2 += 1)
            o = "", 0 !== u2 && (o += ", "), n = r[i2 = l[u2]], writeNode(e, t2, i2, false, false) && (1024 < e.dump.length && (o += "? "), o += e.dump + ": ", writeNode(e, t2, n, false, false) && (a2 += o += e.dump));
          e.tag = s, e.dump = "{" + a2 + "}";
        }
        function writeBlockMapping(e, t2, r, i2) {
          var n, o, a2, s, l, u2, c2 = "", h = e.tag, f2 = Object.keys(r);
          if (true === e.sortKeys)
            f2.sort();
          else if ("function" == typeof e.sortKeys)
            f2.sort(e.sortKeys);
          else if (e.sortKeys)
            throw new exception("sortKeys must be a boolean or a function");
          for (n = 0, o = f2.length; n < o; n += 1)
            u2 = "", i2 && 0 === n || (u2 += generateNextLine(e, t2)), s = r[a2 = f2[n]], writeNode(e, t2 + 1, a2, true, true, true) && ((l = null !== e.tag && "?" !== e.tag || e.dump && 1024 < e.dump.length) && (e.dump && CHAR_LINE_FEED === e.dump.charCodeAt(0) ? u2 += "?" : u2 += "? "), u2 += e.dump, l && (u2 += generateNextLine(e, t2)), writeNode(e, t2 + 1, s, true, l) && (e.dump && CHAR_LINE_FEED === e.dump.charCodeAt(0) ? u2 += ":" : u2 += ": ", c2 += u2 += e.dump));
          e.tag = h, e.dump = c2 || "{}";
        }
        function detectType(e, t2, r) {
          for (var i2, n, o, a2 = r ? e.explicitTypes : e.implicitTypes, s = 0, l = a2.length; s < l; s += 1)
            if (((n = a2[s]).instanceOf || n.predicate) && (!n.instanceOf || "object" == typeof t2 && t2 instanceof n.instanceOf) && (!n.predicate || n.predicate(t2))) {
              if (e.tag = r ? n.tag : "?", n.represent) {
                if (o = e.styleMap[n.tag] || n.defaultStyle, "[object Function]" === _toString$2.call(n.represent))
                  i2 = n.represent(t2, o);
                else {
                  if (!_hasOwnProperty$3.call(n.represent, o))
                    throw new exception("!<" + n.tag + '> tag resolver accepts not "' + o + '" style');
                  i2 = n.represent[o](t2, o);
                }
                e.dump = i2;
              }
              return 1;
            }
        }
        function writeNode(e, t2, r, i2, n, o) {
          e.tag = null, e.dump = r, detectType(e, r, false) || detectType(e, r, true);
          var a2 = _toString$2.call(e.dump);
          i2 = i2 && (e.flowLevel < 0 || e.flowLevel > t2);
          var s, l, u2 = "[object Object]" === a2 || "[object Array]" === a2;
          if (u2 && (l = -1 !== (s = e.duplicates.indexOf(r))), (null !== e.tag && "?" !== e.tag || l || 2 !== e.indent && 0 < t2) && (n = false), l && e.usedDuplicates[s])
            e.dump = "*ref_" + s;
          else {
            if (u2 && l && !e.usedDuplicates[s] && (e.usedDuplicates[s] = true), "[object Object]" === a2)
              i2 && 0 !== Object.keys(e.dump).length ? (writeBlockMapping(e, t2, e.dump, n), l && (e.dump = "&ref_" + s + e.dump)) : (writeFlowMapping(e, t2, e.dump), l && (e.dump = "&ref_" + s + " " + e.dump));
            else if ("[object Array]" === a2)
              i2 && 0 !== e.dump.length ? (writeBlockSequence(e, t2, e.dump, n), l && (e.dump = "&ref_" + s + e.dump)) : (writeFlowSequence(e, t2, e.dump), l && (e.dump = "&ref_" + s + " " + e.dump));
            else {
              if ("[object String]" !== a2) {
                if (e.skipInvalid)
                  return;
                throw new exception("unacceptable kind of an object to dump " + a2);
              }
              "?" !== e.tag && writeScalar(e, e.dump, t2, o);
            }
            null !== e.tag && "?" !== e.tag && (e.dump = "!<" + e.tag + "> " + e.dump);
          }
          return 1;
        }
        function getDuplicateReferences(e, t2) {
          var r, i2, n = [], o = [];
          for (inspectNode(e, n, o), r = 0, i2 = o.length; r < i2; r += 1)
            t2.duplicates.push(n[o[r]]);
          t2.usedDuplicates = new Array(i2);
        }
        function inspectNode(e, t2, r) {
          var i2, n, o;
          if (null !== e && "object" == typeof e)
            if (-1 !== (n = t2.indexOf(e)))
              -1 === r.indexOf(n) && r.push(n);
            else if (t2.push(e), Array.isArray(e))
              for (n = 0, o = e.length; n < o; n += 1)
                inspectNode(e[n], t2, r);
            else
              for (n = 0, o = (i2 = Object.keys(e)).length; n < o; n += 1)
                inspectNode(e[i2[n]], t2, r);
        }
        function dump(e, t2) {
          var r = new State$2(t2 = t2 || {});
          return r.noRefs || getDuplicateReferences(e, r), writeNode(r, 0, e, true, true) ? r.dump + "\n" : "";
        }
        function safeDump(e, t2) {
          return dump(e, common.extend({ schema: default_safe }, t2));
        }
        StringBuilder.prototype.takeUpTo = function(e) {
          var t2;
          if (e < this.checkpoint)
            throw (t2 = new Error("position should be > checkpoint")).position = e, t2.checkpoint = this.checkpoint, t2;
          return this.result += this.source.slice(this.checkpoint, e), this.checkpoint = e, this;
        }, StringBuilder.prototype.escapeChar = function() {
          var e = this.source.charCodeAt(this.checkpoint), t2 = ESCAPE_SEQUENCES[e] || encodeHex(e);
          return this.result += t2, this.checkpoint += 1, this;
        }, StringBuilder.prototype.finish = function() {
          this.source.length > this.checkpoint && this.takeUpTo(this.source.length);
        };
        var dump_1 = dump, safeDump_1 = safeDump, dumper = { dump: dump_1, safeDump: safeDump_1 };
        function deprecated(e) {
          return function() {
            throw new Error("Function " + e + " is deprecated and cannot be used.");
          };
        }
        var Type$1 = type, Schema$1 = schema, FAILSAFE_SCHEMA = failsafe, JSON_SCHEMA = json, CORE_SCHEMA = core, DEFAULT_SAFE_SCHEMA = default_safe, DEFAULT_FULL_SCHEMA = default_full, load$1 = loader.load, loadAll$1 = loader.loadAll, safeLoad$1 = loader.safeLoad, safeLoadAll$1 = loader.safeLoadAll, dump$1 = dumper.dump, safeDump$1 = dumper.safeDump, YAMLException$1 = exception, MINIMAL_SCHEMA = failsafe, SAFE_SCHEMA = default_safe, DEFAULT_SCHEMA = default_full, scan = deprecated("scan"), parse = deprecated("parse"), compose = deprecated("compose"), addConstructor = deprecated("addConstructor"), jsYaml = { Type: Type$1, Schema: Schema$1, FAILSAFE_SCHEMA, JSON_SCHEMA, CORE_SCHEMA, DEFAULT_SAFE_SCHEMA, DEFAULT_FULL_SCHEMA, load: load$1, loadAll: loadAll$1, safeLoad: safeLoad$1, safeLoadAll: safeLoadAll$1, dump: dump$1, safeDump: safeDump$1, YAMLException: YAMLException$1, MINIMAL_SCHEMA, SAFE_SCHEMA, DEFAULT_SCHEMA, scan, parse, compose, addConstructor }, jsYaml$1 = jsYaml, SceneBundle = function() {
          function i2(e, t2) {
            var r = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : null;
            _classCallCheck(this, i2), this.url = e, !t2 || isRelativeURL(t2) && !isRelativeURL(this.url) ? this.path = pathForURL(this.url) : this.path = t2, this.path_for_parent = t2 || this.path, this.parent = r, this.container = null, this.parent && (this.parent.container ? this.container = this.parent.container : this.parent.isContainer() && (this.container = this.parent));
          }
          return _createClass(i2, [{ key: "load", value: function() {
            return loadResource(this.url);
          } }, { key: "resourceFor", value: function(e) {
            return { url: this.urlFor(e), path: this.pathFor(e), type: this.typeFor(e) };
          } }, { key: "urlFor", value: function(e) {
            return isGlobal(e) ? e : isRelativeURL(e) && this.container ? this.parent.urlFor(this.path_for_parent + e) : addBaseURL(e, this.path);
          } }, { key: "pathFor", value: function(e) {
            return pathForURL(e);
          } }, { key: "typeFor", value: function(e) {
            return extensionForURL(e);
          } }, { key: "isContainer", value: function() {
            return false;
          } }]), i2;
        }();
        function createSceneBundle(e, t2, r) {
          return new SceneBundle(e, t2, r);
        }
        function isGlobal(e) {
          return !(!e || "global." !== e.slice(0, 7));
        }
        function parseResource(e) {
          var t2;
          try {
            t2 = jsYaml$1.safeLoad(e, { json: true });
          } catch (e2) {
            throw e2;
          }
          return t2;
        }
        function loadResource(e) {
          return new Promise(function(r, i2) {
            "string" == typeof e ? Utils$1.io(e).then(function(e2) {
              try {
                var t2 = parseResource(e2);
                r(t2);
              } catch (e3) {
                i2(e3);
              }
            }, i2) : (e = Object.assign({}, e), r(e));
          });
        }
        function notNull(e) {
          return null != e;
        }
        function wrap$1(e) {
          return "(" + e + ")";
        }
        function maybeQuote(e) {
          return "string" == typeof e ? '"' + e + '"' : e;
        }
        function lookUp(e) {
          return "$" === e[0] ? "context['" + e.substring(1) + "']" : "context.feature.properties['" + e + "']";
        }
        function nullValue(e, t2) {
          return " true ";
        }
        function propertyEqual(e, t2) {
          return wrap$1(maybeQuote(t2) + " === " + lookUp(e));
        }
        function propertyOr(t2, e) {
          return wrap$1(e.map(function(e2) {
            return propertyEqual(t2, e2);
          }).join(" || "));
        }
        function printNested(e, t2) {
          return wrap$1(e.filter(notNull).map(function(e2) {
            return wrap$1(e2.join(" && "));
          }).join(" " + t2 + " "));
        }
        function any(e, t2, r) {
          return t2 && 0 < t2.length ? printNested(t2.map(function(e2) {
            return parseFilter(e2, r);
          }), "||") : "true";
        }
        function all(e, t2, r) {
          return t2 && 0 < t2.length ? printNested(t2.map(function(e2) {
            return parseFilter(e2, r);
          }), "&&") : "true";
        }
        function not(e, t2, r) {
          return "!" + wrap$1(parseFilter(t2, r).join(" && "));
        }
        function none(e, t2, r) {
          return "!" + wrap$1(any(null, t2, r));
        }
        function propertyMatchesBoolean(e, t2) {
          return wrap$1(lookUp(e) + (t2 ? " != " : " == ") + "null");
        }
        function rangeMatch(e, t2, r) {
          var i2, n, o = [], a2 = r && "function" == typeof r.rangeTransform && r.rangeTransform;
          return t2.max && (i2 = a2 ? a2(t2.max) : t2.max, o.push(lookUp(e) + " < " + i2)), t2.min && (n = a2 ? n = a2(t2.min) : t2.min, o.push(lookUp(e) + " >= " + n)), wrap$1(o.join(" && "));
        }
        function parseFilter(e, t2) {
          var r = [];
          if ("function" == typeof e)
            return [wrap$1(e.toString() + "(context)")];
          if (Array.isArray(e))
            return [any(null, e, t2)];
          if (null == e)
            return ["true"];
          for (var i2 = Object.keys(e), n = 0; n < i2.length; n++) {
            var o = i2[n], a2 = e[o], s = _typeof(a2);
            if ("string" === s || "number" === s)
              r.push(propertyEqual(o, a2));
            else if ("boolean" === s)
              r.push(propertyMatchesBoolean(o, a2));
            else if ("not" === o)
              r.push(not(o, a2, t2));
            else if ("any" === o)
              r.push(any(o, a2, t2));
            else if ("all" === o)
              r.push(all(o, a2, t2));
            else if ("none" === o)
              r.push(none(o, a2, t2));
            else if (Array.isArray(a2))
              r.push(propertyOr(o, a2));
            else if ("object" === s && null != a2)
              (a2.max || a2.min) && r.push(rangeMatch(o, a2, t2));
            else {
              if (null != a2)
                throw new Error("Unknown Query syntax: " + a2);
              r.push(nullValue(o, a2));
            }
          }
          return 0 === i2.length ? ["true"] : r;
        }
        function filterToString(e) {
          return wrap$1(e.join(" && "));
        }
        function buildFilter(e, t2) {
          return null == e ? function() {
            return true;
          } : new Function("context", "return " + filterToString(parseFilter(e, t2)) + ";");
        }
        var reserved = ["filter", "draw", "visible", "enabled", "data"], layer_cache = {};
        function cacheKey(e) {
          if (1 < e.length) {
            for (var t2 = e[0], r = 1; r < e.length; r++)
              t2 += "/" + e[r];
            return t2;
          }
          return e[0];
        }
        function mergeTrees(e, r) {
          for (var i2, t2 = 0, n = 0; n < e.length; n++)
            e[n].length > t2 && (t2 = e[n].length);
          if (0 === t2)
            return null;
          for (var o = { visible: true }, a2 = 0; a2 < t2; a2++)
            (function(t3) {
              if (i2 = [], e.forEach(function(e2) {
                e2[t3] && e2[t3][r] && -1 === i2.indexOf(e2[t3][r]) && i2.push(e2[t3][r]);
              }), 0 === i2.length)
                return;
              i2.sort(function(e2, t4) {
                return (e2 && e2.layer_name) > (t4 && t4.layer_name) ? 1 : -1;
              }), mergeObjects.apply(void 0, [o].concat(_toConsumableArray(i2))), delete o.layer_name;
            })(a2);
          return false === o.visible ? null : o;
        }
        var blacklist = ["any", "all", "not", "none"], Layer = function() {
          function h(e) {
            var t2, r = e.layer, i2 = e.name, n = e.parent, o = e.draw, a2 = e.visible, s = e.enabled, l = e.filter, u2 = e.styles;
            if (_classCallCheck(this, h), this.id = h.id++, this.config_data = r.data, this.parent = n, this.name = i2, this.full_name = this.parent ? this.parent.full_name + ":" + this.name : this.name, this.draw = o, this.filter = l, this.styles = u2, this.is_built = false, s = void 0 === s ? a2 : s, this.parent && false === this.parent.visible ? this.enabled = false : this.enabled = false !== s, this.draw)
              for (var c2 in this.draw) {
                this.draw[c2] = null == this.draw[c2] ? {} : this.draw[c2], "object" !== _typeof(this.draw[c2]) ? (t2 = "Draw group '".concat(c2, "' for layer ").concat(this.full_name, " is invalid, must be an object, "), log("warn", t2 += "but was set to `".concat(c2, ": ").concat(this.draw[c2], "` instead")), delete this.draw[c2]) : this.draw[c2].layer_name = this.full_name;
              }
          }
          return _createClass(h, [{ key: "build", value: function() {
            log("trace", "Building layer '".concat(this.full_name, "'")), this.buildFilter(), this.buildDraw(), this.is_built = true;
          } }, { key: "buildDraw", value: function() {
            this.draw = Utils$1.stringsToFunctions(this.draw, StyleParser.wrapFunction), this.calculatedDraw = calculateDraw(this);
          } }, { key: "buildFilter", value: function() {
            this.filter_original = this.filter, this.filter = Utils$1.stringsToFunctions(this.filter, StyleParser.wrapFunction);
            var e = _typeof(this.filter);
            if (null == this.filter || "object" === e || "function" === e)
              try {
                this.buildZooms(), this.buildPropMatches(), null != this.filter && ("function" == typeof this.filter || 0 < Object.keys(this.filter).length) ? this.filter = buildFilter(this.filter, FilterOptions) : this.filter = null;
              } catch (e2) {
                var t2 = "Filter for layer ".concat(this.full_name, " is invalid, `filter: ").concat(JSON.stringify(this.filter), "` ");
                log("warn", t2 += "failed with error '".concat(e2.message, "', stack trace: ").concat(e2.stack));
              }
            else {
              var r = "Filter for layer ".concat(this.full_name, " is invalid, filter value must be an object or function, ");
              log("warn", r += "but was set to `filter: ".concat(this.filter, "` instead"));
            }
          } }, { key: "buildZooms", value: function() {
            var e = this.filter && this.filter.$zoom, t2 = _typeof(e);
            if (null != e && "function" !== t2) {
              if (this.zooms = {}, "number" === t2)
                this.zooms[e] = true;
              else if (Array.isArray(e))
                for (var r = 0; r < e.length; r++)
                  this.zooms[e[r]] = true;
              else if ("object" === t2 && (null != e.min || null != e.max))
                for (var i2 = e.min || 0, n = e.max || 25, o = i2; o < n; o++)
                  this.zooms[o] = true;
              delete this.filter.$zoom;
            }
          } }, { key: "buildPropMatches", value: function() {
            var n = this;
            this.filter && !Array.isArray(this.filter) && "function" != typeof this.filter && Object.keys(this.filter).forEach(function(e) {
              if (-1 === blacklist.indexOf(e)) {
                var t2 = n.filter[e], r = _typeof(t2), i2 = Array.isArray(t2);
                if (!i2 && "string" !== r && "number" !== r)
                  return;
                "$" === e[0] ? (n.context_prop_matches = n.context_prop_matches || [], n.context_prop_matches.push([e.substring(1), i2 ? t2 : [t2]])) : (n.feature_prop_matches = n.feature_prop_matches || [], n.feature_prop_matches.push([e, i2 ? t2 : [t2]])), delete n.filter[e];
              }
            });
          } }, { key: "doPropMatches", value: function(e) {
            if (this.feature_prop_matches)
              for (var t2 = 0; t2 < this.feature_prop_matches.length; t2++) {
                var r = this.feature_prop_matches[t2], i2 = e.feature.properties[r[0]];
                if (null == i2 || -1 === r[1].indexOf(i2))
                  return false;
              }
            if (this.context_prop_matches)
              for (var n = 0; n < this.context_prop_matches.length; n++) {
                var o = this.context_prop_matches[n], a2 = e[o[0]];
                if (null == a2 || -1 === o[1].indexOf(a2))
                  return false;
              }
            return true;
          } }, { key: "doesMatch", value: function(t2) {
            if (!this.enabled)
              return false;
            if (this.is_built || this.build(), null != this.zooms && !this.zooms[t2.zoom])
              return false;
            if (!this.doPropMatches(t2))
              return false;
            var e;
            if (this.filter instanceof Function)
              try {
                e = this.filter(t2);
              } catch (e2) {
                var r = "Filter for this ".concat(this.full_name, ": `filter: ").concat(this.filter_original, "` ");
                log("error", r += "failed with error '".concat(e2.message, "', stack trace: ").concat(e2.stack), t2.feature);
              }
            else
              e = null == this.filter;
            return !!e && (this.children_to_parse && (parseLayerChildren(this, this.children_to_parse, this.styles), delete this.children_to_parse), true);
          } }]), h;
        }();
        Layer.id = 0;
        var LayerLeaf = function() {
          _inherits(i2, Layer);
          var r = _createSuper(i2);
          function i2(e) {
            var t2;
            return _classCallCheck(this, i2), (t2 = r.call(this, e)).is_leaf = true, t2;
          }
          return i2;
        }(), LayerTree = function() {
          _inherits(i2, Layer);
          var r = _createSuper(i2);
          function i2(e) {
            var t2;
            return _classCallCheck(this, i2), (t2 = r.call(this, e)).is_tree = true, t2.layers = e.layers || [], t2;
          }
          return _createClass(i2, [{ key: "addLayer", value: function(e) {
            this.layers.push(e);
          } }, { key: "buildDrawGroups", value: function(e) {
            var t2 = [], r2 = [];
            if (matchFeature(e, [this], t2, r2), 0 < t2.length) {
              var i3 = cacheKey(r2);
              if (void 0 === layer_cache[i3]) {
                for (var n = t2.map(function(e2) {
                  return e2 && false !== e2.visible && e2.calculatedDraw;
                }), o = {}, a2 = 0; a2 < n.length; a2++) {
                  var s = n[a2];
                  if (s)
                    for (var l = 0; l < s.length; l++) {
                      var u2 = s[l];
                      for (var c2 in u2)
                        o[c2] = true;
                    }
                }
                for (var h in o)
                  layer_cache[i3] = layer_cache[i3] || {}, layer_cache[i3][h] = mergeTrees(n, h), layer_cache[i3][h] ? (layer_cache[i3][h].key = i3 + "/" + h, layer_cache[i3][h].layers = t2.map(function(e2) {
                    return e2 && e2.full_name;
                  }), layer_cache[i3][h].group = h) : delete layer_cache[i3][h];
                layer_cache[i3] && 0 === Object.keys(layer_cache[i3]).length && (layer_cache[i3] = null);
              }
              return layer_cache[i3];
            }
          } }]), i2;
        }(), FilterOptions = { rangeTransform: function(e) {
          return "string" == typeof e && "px2" === e.trim().slice(-3) ? "".concat(parseFloat(e), " * context.meters_per_pixel_sq") : e;
        } }, SceneLoader;
        function isReserved(e) {
          return -1 < reserved.indexOf(e);
        }
        function isEmpty(e) {
          return 0 === Object.keys(e).length;
        }
        function groupProps(e) {
          var t2 = {}, r = {};
          for (var i2 in e)
            isReserved(i2) ? t2[i2] = e[i2] : r[i2] = e[i2];
          return [t2, r];
        }
        function calculateDraw(e) {
          var t2, r = [];
          return e.parent && (t2 = e.parent.calculatedDraw || [], r.push.apply(r, _toConsumableArray(t2))), r.push(e.draw), r;
        }
        function parseLayerNode(e, t2, r, i2) {
          var n = { name: e, layer: t2 = null == t2 ? {} : t2, parent: r, styles: i2 }, o = _slicedToArray(groupProps(t2), 2), a2 = o[0], s = o[1], l = isEmpty(s), u2 = l && null != r ? LayerLeaf : LayerTree, c2 = new u2(Object.assign(n, a2));
          return c2.enabled && (r && r.addLayer(c2), c2.children_to_parse = l ? null : s), c2;
        }
        function parseLayerChildren(e, t2, r) {
          for (var i2 in t2) {
            var n, o = t2[i2];
            "object" !== _typeof(o) || Array.isArray(o) ? (n = "Layer value must be an object: cannot create layer '".concat(i2, ": ").concat(JSON.stringify(o), "'"), n += ", under parent layer '".concat(e.full_name, "'."), r[e.name] && (n += " The parent name '".concat(e.name, "' is also the name of a style, did you mean to create a 'draw' group"), e.parent && (n += " under '".concat(e.parent.name, "'")), n += " instead?"), log("warn", n)) : parseLayerNode(i2, o, e, r);
          }
        }
        function parseLayers(e, t2) {
          layer_cache = {};
          var r = {};
          for (var i2 in e) {
            var n = e[i2];
            n && (r[i2] = parseLayerNode(i2, n, null, t2));
          }
          return r;
        }
        function matchFeature(e, t2, r, i2) {
          var n = false;
          if (0 !== t2.length) {
            for (var o = 0; o < t2.length; o++) {
              var a2 = t2[o];
              a2.is_leaf ? a2.doesMatch(e) && (n = true, r.push(a2), i2.push(a2.id)) : a2.is_tree && a2.doesMatch(e) && (n = true, matchFeature(e, a2.layers, r, i2) || (r.push(a2), i2.push(a2.id)));
            }
            return n;
          }
        }
        var GLOBAL_PROP_RGX = /^global\.(.+)$/, SceneLoader$1 = SceneLoader = { loadScene: function(e, t2) {
          var i2 = this, r = 1 < arguments.length && void 0 !== t2 ? t2 : {}, n = r.path, o = r.type, a2 = [];
          return this.loadSceneRecursive({ url: e, path: n, type: o }, null, a2).then(function(e2) {
            return i2.finalize(e2);
          }).then(function(e2) {
            var t3 = e2.config, r2 = e2.bundle;
            return t3 ? (0 < a2.length && a2.forEach(function(e3) {
              var t4 = "Failed to import scene: ".concat(e3.url);
              log("error", t4, e3), i2.trigger("error", { type: "scene_import", message: t4, error: e3, url: e3.url });
            }), { config: t3, bundle: r2 }) : Promise.reject(a2[0]);
          });
        }, loadSceneRecursive: function(e, t2, r) {
          var i2 = this, n = e.url, o = e.path, a2 = e.type, s = 2 < arguments.length && void 0 !== r ? r : [];
          if (!n)
            return Promise.resolve({});
          var l = createSceneBundle(n, o, t2, a2);
          return l.load().then(function(r2) {
            if (null == r2.import)
              return i2.normalize(r2, l), { config: r2, bundle: l };
            Array.isArray(r2.import) || (r2.import = [r2.import]);
            var t3 = [];
            return r2.import.forEach(function(e2) {
              "object" === _typeof(e2) && (e2 = createObjectURL(new Blob([JSON.stringify(e2)]))), t3.push(l.resourceFor(e2));
            }), delete r2.import, Promise.all(t3.map(function(e2) {
              return i2.loadSceneRecursive(e2, l, s);
            })).then(function(e2) {
              e2.forEach(function(e3) {
                return i2.normalize(e3.config, e3.bundle);
              });
              var t4 = e2.map(function(e3) {
                return e3.config;
              });
              return r2 = mergeObjects.apply(void 0, _toConsumableArray(t4).concat([r2])), i2.normalize(r2, l), { config: r2, bundle: l };
            });
          }).catch(function(e2) {
            return e2.url = n, s.push(e2), {};
          });
        }, normalize: function(e, t2) {
          return this.normalizeDataSources(e, t2), this.normalizeFonts(e, t2), this.normalizeTextures(e, t2), this.hoistTextures(e, t2), { config: e, bundle: t2 };
        }, normalizeDataSources: function(e, t2) {
          for (var r in e.sources = e.sources || {}, e.sources)
            this.normalizeDataSource(e.sources[r], t2);
          return e;
        }, normalizeDataSource: function(e, t2) {
          if (e.url && (e.url = t2.urlFor(e.url)), e.scripts)
            for (var r in Array.isArray(e.scripts) && (e.scripts = e.scripts.reduce(function(e2, t3) {
              return e2[t3] = t3, e2;
            }, {})), e.scripts)
              e.scripts[r] = t2.urlFor(e.scripts[r]);
          return e;
        }, normalizeFonts: function(e, t2) {
          for (var r in e.fonts = e.fonts || {}, e.fonts) {
            var i2;
            Array.isArray(e.fonts[r]) ? e.fonts[r].forEach(function(e2) {
              e2.url = e2.url && t2.urlFor(e2.url);
            }) : (i2 = e.fonts[r]).url = i2.url && t2.urlFor(i2.url);
          }
          return e;
        }, normalizeTextures: function(e, t2) {
          if (e.textures = e.textures || {}, e.textures)
            for (var r in e.textures) {
              var i2 = e.textures[r];
              i2.url && (i2.url = t2.urlFor(i2.url));
            }
        }, hoistTextures: function(i2, n) {
          var o = this;
          if (i2.styles) {
            for (var e in i2.styles)
              !function(e2) {
                var r2 = i2.styles[e2], t3 = r2.texture;
                "string" != typeof t3 || i2.textures[t3] || (r2.texture = o.hoistTexture(t3, i2, n)), r2.material && ["emission", "ambient", "diffuse", "specular", "normal"].forEach(function(e3) {
                  var t4 = null != r2.material[e3] && r2.material[e3].texture;
                  "string" != typeof t4 || i2.textures[t4] || (r2.material[e3].texture = o.hoistTexture(t4, i2, n));
                });
              }(e);
          }
          if (this.hoistStyleShaderUniformTextures(i2, n, { include_globals: false }), i2.layers)
            for (var t2 = [i2.layers]; 0 < t2.length; ) {
              var r = t2.pop();
              if ("object" === _typeof(r) && !Array.isArray(r))
                for (var a2 in r)
                  if ("draw" === a2) {
                    var s, l, u2 = r[a2];
                    for (var c2 in u2) {
                      u2[c2].texture && ("string" != typeof (s = u2[c2].texture) || i2.textures[s] || (u2[c2].texture = this.hoistTexture(s, i2, n))), u2[c2].outline && u2[c2].outline.texture && ("string" != typeof (l = u2[c2].outline.texture) || i2.textures[l] || (u2[c2].outline.texture = this.hoistTexture(l, i2, n)));
                    }
                  } else {
                    if (isReserved(a2))
                      continue;
                    t2.push(r[a2]);
                  }
            }
        }, hoistStyleShaderUniformTextures: function(o, a2, e) {
          var s = this, l = e.include_globals;
          if (o.styles)
            for (var t2 in o.styles) {
              var r = o.styles[t2];
              r.shaders && r.shaders.uniforms && GLSL.parseUniforms(r.shaders.uniforms).forEach(function(e2) {
                var t3 = e2.type, r2 = e2.value, i2 = e2.key, n = e2.uniforms;
                "sampler2D" !== t3 || "string" != typeof r2 || o.textures[r2] || !l && isGlobal(r2) || (n[i2] = s.hoistTexture(r2, o, a2));
              });
            }
        }, hoistTexture: function(e, t2, r) {
          var i2 = isGlobal(e), n = i2 ? e : r.urlFor(e), o = i2 ? "texture-".concat(n) : n;
          return t2.textures[o] = { url: n }, o;
        }, applyGlobalProperties: function(e) {
          if (!e.global || 0 === Object.keys(e.global).length)
            return e;
          var o = flattenProperties(e.global);
          return function e2(t2) {
            if ("string" == typeof t2) {
              var r = function e3(t3, r2, i3) {
                var n2 = 2 < arguments.length && void 0 !== i3 ? i3 : [];
                if (-1 < n2.indexOf(t3))
                  log({ level: "warn", once: true }, "Global properties: cyclical reference detected", n2);
                else {
                  n2.push(t3);
                  var o2 = GLOBAL_PROP_RGX.exec(t3);
                  if (o2) {
                    var a2 = o2[1];
                    if (a2) {
                      var s = r2[a2];
                      if (void 0 !== s)
                        return "string" == typeof s && GLOBAL_PROP_RGX.exec(s) ? e3(s, r2, n2) : s;
                      log({ level: "warn", once: true }, "Global property not found: " + t3);
                    } else
                      log({ level: "warn", once: true }, "Invalid global property reference: " + t3);
                  }
                }
              }(t2, o);
              void 0 !== r && (t2 = r);
            } else if (Array.isArray(t2))
              for (var i2 = 0; i2 < t2.length; i2++)
                t2[i2] = e2(t2[i2]);
            else if ("object" === _typeof(t2))
              for (var n in t2)
                t2[n] = e2(t2[n]);
            return t2;
          }(e);
        }, finalize: function(e) {
          var t2 = e.config, r = e.bundle;
          return t2 ? (t2.global = t2.global || {}, t2.scene = t2.scene || {}, t2.cameras = t2.cameras || {}, t2.lights = t2.lights || {}, t2.styles = t2.styles || {}, t2.layers = t2.layers || {}, t2.camera && (t2.cameras.default = t2.camera), 0 === Object.keys(t2.cameras).length && (t2.cameras.default = {}), 0 !== Object.keys(t2.lights).length && !Object.keys(t2.lights).every(function(e2) {
            return false === t2.lights[e2].visible;
          }) || (t2.lights.default_light = { type: "directional" }), { config: t2, bundle: r }) : {};
        } };
        function flattenProperties(e) {
          var t2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : ".", r = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {}, i2 = (i2 = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : null) ? i2 + t2 : "";
          for (var n in e) {
            var o = i2 + n, a2 = e[n];
            "object" !== _typeof(r[o] = a2) || Array.isArray(a2) || flattenProperties(a2, t2, o, r);
          }
          return r;
        }
        subscribeMixin(SceneLoader);
        var TilePyramid = function() {
          function e() {
            _classCallCheck(this, e), this.coords = {}, this.max_proxy_descendant_depth = 6, this.max_proxy_ancestor_depth = 10;
          }
          return _createClass(e, [{ key: "sourceTiles", value: function(e2, t2) {
            return this.coords[e2.key] && this.coords[e2.key].sources && this.coords[e2.key].sources[t2.name];
          } }, { key: "addTile", value: function(e2) {
            var t2 = e2.coords.key, r = this.coords[t2];
            (r = r || (this.coords[t2] = { descendants: 0 })).sources || (r.sources = {}), r.sources[e2.source.name] || (r.sources[e2.source.name] = {});
            for (var i2 = (r.sources[e2.source.name][e2.style_zoom] = e2).coords.z - 1; 0 <= i2; i2--) {
              var n = Tile.coordinateAtZoom(e2.coords, i2);
              this.coords[n.key] || (this.coords[n.key] = { descendants: 0 }), this.coords[n.key].descendants++;
            }
          } }, { key: "removeTile", value: function(e2) {
            var t2 = this.sourceTiles(e2.coords, e2.source), r = e2.coords.key;
            t2 && (delete t2[e2.style_zoom], 0 === Object.keys(t2).length && (delete this.coords[r].sources[e2.source.name], 0 === Object.keys(this.coords[r].sources).length && (delete this.coords[r].sources, 0 === this.coords[r].descendants && delete this.coords[r])));
            for (var i2 = e2.coords.z - 1; 0 <= i2; i2--) {
              var n = Tile.coordinateAtZoom(e2.coords, i2);
              this.coords[n.key] && 0 < this.coords[n.key].descendants && (this.coords[n.key].descendants--, 0 !== this.coords[n.key].descendants || this.coords[n.key].sources || delete this.coords[n.key]);
            }
          } }, { key: "getAncestor", value: function(e2, t2) {
            var r = e2.coords, i2 = e2.style_zoom, n = e2.source, o = 1 < arguments.length && void 0 !== t2 ? t2 : 1;
            if (!(o > this.max_proxy_ancestor_depth)) {
              if (i2 > n.max_coord_zoom) {
                var a2 = this.sourceTiles(r, n);
                if (a2) {
                  for (var s = i2 - 1; s >= n.max_coord_zoom; s--)
                    if (a2[s] && a2[s].loaded)
                      return a2[s];
                }
                i2 = n.max_coord_zoom;
              }
              i2--;
              var l = Tile.coordinateAtZoom(r, r.z - 1), u2 = this.sourceTiles(l, n);
              return u2 && u2[i2] && u2[i2].loaded ? u2[i2] : 0 < l.z ? this.getAncestor({ coords: l, style_zoom: i2, source: n }, o + 1) : void 0;
            }
          } }, { key: "getDescendants", value: function(e2, t2) {
            var r = e2.coords, i2 = e2.style_zoom, n = e2.source, o = 1 < arguments.length && void 0 !== t2 ? t2 : 1, a2 = [];
            if (i2 >= n.max_coord_zoom) {
              var s = this.sourceTiles(r, n);
              if (s) {
                for (var l = Math.max(Geo$1.default_view_max_zoom, i2 + this.max_proxy_descendant_depth), u2 = i2 + 1; u2 <= l; u2++)
                  if (s[u2] && s[u2].loaded)
                    return a2.push(s[u2]), a2;
              }
              return a2;
            }
            if (this.coords[r.key] && 0 < this.coords[r.key].descendants) {
              i2++;
              for (var c2 = Tile.childrenForCoordinate(r), h = 0; h < c2.length; h++) {
                var f2 = c2[h], d = this.sourceTiles(f2, n);
                d && d[i2] && d[i2].loaded ? a2.push(d[i2]) : o <= this.max_proxy_descendant_depth && f2.z <= n.max_coord_zoom && a2.push.apply(a2, _toConsumableArray(this.getDescendants({ coords: f2, source: n, style_zoom: i2 }, o + 1)));
              }
            }
            return a2;
          } }]), e;
        }(), LabelMainPass = function() {
          function o(e, t2, r, i2) {
            _classCallCheck(this, o), Object.assign(this, e), this.placed = null, this._tile = i2;
            var n = Geo$1.unitsPerMeter(i2.coords.z) * Math.pow(2, r - i2.style_zoom);
            this.layout = Object.assign({}, e.layout), this.layout.repeat_scale = 0.75, this.layout.repeat_distance = this.layout.repeat_distance || 0, this.layout.repeat_distance /= n, this.position = Geo$1.tileSpaceToMeters(this.position, i2.coords.z, i2.min), this._worldToScreen = t2, this._screenSpaceBoundingBox = void 0, this._boundingCircles = void 0;
          }
          return _createClass(o, [{ key: "getTile", value: function() {
            return this._tile;
          } }, { key: "isFlat", value: function() {
            return this.is_flat;
          } }, { key: "getScreenSpaceBoundingBox", value: function() {
            var e, t2, r, i2, n, o2, a2;
            return this._screenSpaceBoundingBox || ((e = this._worldToScreen(this.position, true))[0] += this.offset[0], e[1] += this.offset[1], t2 = this.size[0] / 2 + this.layout.buffer[0], r = this.size[1] / 2 + this.layout.buffer[1], i2 = e[0] - t2, n = e[0] + t2, o2 = e[1] - r, a2 = e[1] + r, this._screenSpaceBoundingBox = { left: i2, bottom: a2, right: n, top: o2 }), this._screenSpaceBoundingBox;
          } }, { key: "getBoundingCircles", value: function() {
            return this._boundingCircles || (this._boundingCircles = "point" === this.type ? this._convertSidesToScreenSpaceCircles() : this._convertCirclesToScreenSpace()), this._boundingCircles;
          } }, { key: "_convertSidesToScreenSpaceCircles", value: function() {
            var e = this._tile.coords.z, t2 = this._tile.min, r = Geo$1.tileSpaceToMeters([this.sides[0], this.sides[1]], e, t2), i2 = Geo$1.tileSpaceToMeters([this.sides[2], this.sides[3]], e, t2), n = _slicedToArray(this._worldToScreen(r, true), 2), o2 = n[0], a2 = n[1], s = _slicedToArray(this._worldToScreen(i2, true), 2);
            return encircleLine(o2, a2, s[0], s[1], this.size[1] / 2 + this.layout.buffer[1]);
          } }, { key: "_convertCirclesToScreenSpace", value: function() {
            for (var e = [], t2 = this.circles, r = this._tile.coords.z, i2 = this._tile.min, n = 0; n < t2.length - 2; n += 3) {
              var o2 = Geo$1.tileSpaceToMeters([t2[n], -t2[n + 1]], r, i2), a2 = t2[n + 2] / Geo$1.unitsPerMeter(r), s = [o2[0] + a2, o2[1]], l = this._worldToScreen(o2, true), u2 = this._worldToScreen(s, true), c2 = MathUtils$1.getLineLength(l[0], l[1], u2[0], u2[1]);
              e.push(l[0], l[1], c2);
            }
            return e;
          } }]), o;
        }(), labelsMainPass = { mainThreadLabelCollisionPass }, visible = {}, prev_visible = {}, IS_LITTLE_ENDIAN = 120 === new Uint8Array(new Uint32Array([305419896]).buffer)[0];
        function _createContainer(e, t2, r, i2, n) {
          var o = e.container, a2 = o.label, s = o.linked, l = e.ranges;
          return { label: new LabelMainPass(a2, r, i2, n), linked: s, ranges: l, mesh: t2 };
        }
        function mainThreadLabelCollisionPass(t2, a2, e, u2, r, i2) {
          prev_visible = visible, visible = {};
          var s = {}, l = {}, n = [], c2 = e.worldToScreen.bind(e), h = new TextMeshHelper(i2);
          for (var o in t2.forEach(function(o2) {
            for (var e2 in o2.meshes)
              o2.meshes[e2].forEach(function(e3) {
                if (e3.labels) {
                  for (var t3 in h.trackMesh(e3), e3.labels["non-collision"]) {
                    var r2 = _createContainer(e3.labels["non-collision"][t3], e3, c2, a2, o2);
                    r2.label.text_data && h.insertLabel(r2, o2);
                  }
                  for (var i3 in e3.labels.collision) {
                    var n2;
                    s[i3] || (n2 = _createContainer(e3.labels.collision[i3], e3, c2, a2, o2), s[i3] = n2.label, l[i3] = n2);
                  }
                }
              });
          }), l) {
            var f2 = l[o];
            f2.linked && (f2.linked = l[f2.linked]), n.push(f2);
          }
          var d = e.getViewport(), _ = d.width, p2 = d.height;
          return Collision.startTile("main", { apply_repeat_groups: true, return_hidden: true, grid_index: new GridIndex(_, p2, 30) }), Collision.addStyle("main", "main"), Collision.collide(n, "main", "main").then(function(e2) {
            return e2.forEach(function(e3) {
              var r2, i3, n2, t3, o2, a3, s2 = e3.mesh, l2 = e3.label.getTile();
              s2.valid && (!(r2 = 0) !== e3.show || u2 && e3.label.breach && !prev_visible[e3.label.id] || (r2 = 1), r2 && (visible[e3.label.id] = true), e3.label.text_data && h.insertLabel(e3, l2), i3 = s2.vertex_layout.offset.a_shape, n2 = s2.vertex_layout.stride, o2 = (t3 = s2.vertex_layout.attribs.find(function(e4) {
                return "a_shape" === e4.name;
              })).byte_size / t3.size, i3 += 3 * o2, a3 = true, e3.ranges.forEach(function(e4) {
                if (a3) {
                  for (var t4 = 0; t4 < e4[1]; t4++) {
                    if (s2.vertex_data[e4[0] + t4 * n2 + i3] === r2)
                      return void (a3 = false);
                    s2.vertex_data[e4[0] + t4 * n2 + i3] = r2;
                  }
                  h.trackMesh(s2);
                }
              }));
            }), h.createTextures(r).then(function() {
              return h.updateMeshes();
            });
          }).then(function(e2) {
            e2.forEach(function(e3) {
              return e3.valid && e3.upload();
            }), t2.forEach(function(e3) {
              e3.labeled = true;
            }), n = [], l = {}, s = {};
          });
        }
        var TextMeshHelper = function() {
          function t2(e) {
            _classCallCheck(this, t2), this.textureManager = getTextureManager(e), this.tiles = {}, this.meshes = [], this.containers = [];
          }
          return _createClass(t2, [{ key: "insertLabel", value: function(e, t3) {
            var r = e.label.text_data, i2 = r.text_settings_key, n = r.text, o = r.text_info;
            this.containers.push(e);
            var a2 = this._ensureTextSection(t3, i2);
            a2[n] ? e.label.text_data.text_info = a2[n] : a2[n] = o;
          } }, { key: "trackMesh", value: function(e) {
            -1 === this.meshes.indexOf(e) && this.meshes.push(e);
          } }, { key: "updateMeshes", value: function() {
            var h = this;
            return this.containers.forEach(function(e) {
              var t3, r, i2, n, o, a2, s, l, u2, c2;
              e.label.text_data && (t3 = e.label.getTile(), (r = e.mesh).valid ? (i2 = e.label.type, n = e.label.text_data.text_info, h.tiles[t3.id] && h.tiles[t3.id].textures && (o = h.tiles[t3.id].textures[0], r.uniforms.u_texture = o, -1 === r.textures.indexOf(o) && r.textures.push(o), "point" === i2 || "straight" === i2 ? (a2 = "point" === i2 ? n.align[e.label.align].texcoords : n.texcoords[i2].texcoord, h.setTexCoords(r, e, a2)) : "curved" === i2 && (s = n.segments.length, l = n.texcoords_stroke, u2 = n.texcoords.curved, h.setTexCoords(r, e, function(e2) {
                return e2 < s ? l[e2] : u2[e2 - s].texcoord;
              })))) : h.tiles[t3.id] && h.tiles[t3.id].textures && (c2 = h.tiles[t3.id].textures[0], h.textureManager.release(c2)));
            }), this.meshes;
          } }, { key: "setTexCoords", value: function(e, t3, _) {
            var r, i2, n, o, a2, p2, g = _ instanceof Function;
            g || (i2 = (r = _slicedToArray(_, 4))[0], n = r[1], o = r[2], a2 = r[3], p2 = [[i2, n], [o, n], [o, a2], [i2, a2]]);
            var m = e.vertex_layout.stride, y = new DataView(e.vertex_data.buffer), v = e.vertex_layout.offset.a_texcoord;
            t3.ranges.forEach(function(e2, t4) {
              var r2, i3, n2, o2, a3, s = _slicedToArray(e2, 3), l = s[0], u2 = s[1], c2 = s[2];
              g && (i3 = (r2 = _slicedToArray(_(t4), 4))[0], n2 = r2[1], o2 = r2[2], a3 = r2[3], p2 = [[i3, n2], [o2, n2], [o2, a3], [i3, a3]]);
              for (var h = c2 ? u2 / 2 : 0; h < u2; h++) {
                var f2 = p2[h % 4], d = l + h * m;
                y.setUint16(d + v, f2[0] * texcoord_normalize, IS_LITTLE_ENDIAN), y.setUint16(d + v + 2, f2[1] * texcoord_normalize, IS_LITTLE_ENDIAN);
              }
            });
          } }, { key: "createTextures", value: function(n) {
            var o = this;
            return Promise.all(Object.values(this.tiles).map(function(e) {
              var t3 = e.id, r = e.key, i2 = e.texts;
              return o._createTexturesForTile(n, i2, "labels-".concat(r, "-").concat(t3), t3, o.textureManager).then(function(e2) {
                e2.length && (e2.forEach(function(e3) {
                  o.textureManager.retain(e3), 1 < o.textureManager.getRetainCount(e3) && o.textureManager.release(e3);
                }), o.tiles[t3].textures = e2);
              });
            }));
          } }, { key: "_createTexturesForTile", value: function(e, t3, r, i2, n) {
            var o = new CanvasText(), a2 = o.setTextureTextPositions(t3);
            return o.rasterize(t3, a2, i2, r, e, n);
          } }, { key: "_ensureTile", value: function(e) {
            var t3 = e.id, r = e.key;
            return this.tiles[t3] || (this.tiles[t3] = { id: t3, key: r, texts: {} }), this.tiles[t3];
          } }, { key: "_ensureTextSection", value: function(e, t3) {
            var r = this._ensureTile(e).texts;
            return r[t3] || (r[t3] = {}), r[t3];
          } }]), t2;
        }(), TILE_VISIBILITY_COUNTER_THRESHOLD = 30, TileManager = function() {
          function n(e) {
            var i2 = this, t2 = e.scene, r = e.view;
            _classCallCheck(this, n), this._scene = t2, this._view = r, this._visible_tiles = {}, this._pyramid = new TilePyramid(), this._visible_coords = {}, this._building_tiles = null, this._renderable_tiles = [], this._active_styles = [], this._tile_visibility_counters = {}, this._update_labels_on_queue_check = false, this._all_visible_tiles_are_cached = false, this._debouncedUpdateLabels = debounce(this._updateLabels.bind(this), 100, 200), this._main_thread_target = ["TileManager", this._scene.id].join("_"), WorkerBroker.addTarget(this._main_thread_target, this), this._keepCoordinate = this._keepCoordinate.bind(this), this._removeTilesFilter = this._removeTilesFilter.bind(this), this._removeCachedTilesFilter = this._removeCachedTilesFilter.bind(this), this._is_labeled = false, this._tile_cache = new H.util.Cache(getMaxTileCacheSize(), function(e2, t3, r2) {
              i2._visible_tiles[e2] && i2._visible_tiles[e2] === t3 || t3.destroy();
            });
          }
          return _createClass(n, [{ key: "destroy", value: function() {
            this._tile_cache.removeAll(), this.forEachVisibleTile(function(e) {
              return e.destroy();
            }), this._visible_tiles = {}, this._pyramid = null, this._visible_coords = {}, this._scene = null, this._view = null;
          } }, { key: "keepTile", value: function(e) {
            this._visible_tiles[e.key] = e, this._pyramid.addTile(e);
          } }, { key: "hasTile", value: function(e) {
            return void 0 !== this._visible_tiles[e];
          } }, { key: "_forgetTile", value: function(e) {
            var t2, r;
            this.hasTile(e) && (t2 = this._visible_tiles[e], this._pyramid.removeTile(t2), delete this._visible_tiles[e], t2.loaded ? this._tile_cache.add(t2.key, t2, getTileByteLength(t2)) : (r = this._tile_cache.get(t2.key)) ? this._tile_cache.drop(r.key) : t2.destroy(), this._tileBuildStop(t2));
          } }, { key: "removeTile", value: function(e) {
            this._forgetTile(e), this._scene.requestRedraw();
          } }, { key: "forEachVisibleTile", value: function(e) {
            for (var t2 in this._visible_tiles)
              e(this._visible_tiles[t2]);
          } }, { key: "removeTiles", value: function(e) {
            for (var t2 in this._visible_tiles)
              e(this._visible_tiles[t2]) && this.removeTile(t2);
          } }, { key: "removeCachedTiles", value: function(r) {
            var i2 = this;
            this._tile_cache.forEach(function(e, t2) {
              r(t2) && i2._tile_cache.drop(e);
            });
          } }, { key: "updateTilesForView", value: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e && e;
            this._visible_coords = {};
            for (var r = this._view.findVisibleTileCoordinates(), i2 = 0; i2 < r.length; i2++) {
              var n2 = r[i2];
              this._visible_coords[n2.key] = n2;
            }
            this.updateTileStates(t2);
          } }, { key: "updateTileStates", value: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e && e;
            for (var r in this._all_visible_tiles_are_cached = true, this._visible_coords)
              this._keepCoordinate(r, t2);
            this._all_visible_tiles_are_cached && (this._is_labeled = false, this._debouncedUpdateLabels()), this._tile_cache.removeAll(this._removeCachedTilesFilter), this._updateProxyTiles(), this.removeTiles(this._removeTilesFilter), this._updateRenderableTiles(), this._updateActiveStyles();
          } }, { key: "_removeTilesFilter", value: function(e) {
            if (e.style_zoom === this._view.lookAtManipulator.getLookAtData().tile_level) {
              if (this._visible_coords[e.coords.key])
                return false;
              for (var t2 in this._visible_coords)
                if (Tile.isDescendant(e.coords, this._visible_coords[t2]))
                  return false;
            }
            return !e.isProxy();
          } }, { key: "_updateLabels", value: function() {
            var e, t2 = this;
            this._building_tiles && 0 !== Object.keys(this._building_tiles).length || (CanvasText.pruneTextCache(), e = this._renderable_tiles.sort(compareTileCoords), labelsMainPass.mainThreadLabelCollisionPass(e, roundPrecision(this._view.lookAtManipulator.getLookAtData().zoom, 2), this._view.lookAtManipulator, this.isLoadingVisibleTiles(), this._scene.gl, this._scene.id).then(function() {
              t2._is_labeled = !Task.hasPendingTasks(), t2._scene && t2._scene.immediateRedraw(), t2._update_labels_on_queue_check = false;
            }));
          } }, { key: "_updateProxyTiles", value: function() {
            var n2, o = this, a2 = this._view.lookAtManipulator.getZoomDirection();
            0 !== a2 && (n2 = false, this.forEachVisibleTile(function(e) {
              var t2;
              if (e.setProxyFor(null), 1 === a2)
                e.built || (t2 = o._pyramid.getAncestor(e)) && (t2.setProxyFor(e), n2 = true);
              else if (-1 === a2 && !e.built)
                for (var r = o._pyramid.getDescendants(e), i2 = 0; i2 < r.length; i2++)
                  r[i2].setProxyFor(e), n2 = true;
            }), n2 || this._view.lookAtManipulator.resetZoomDirection());
          } }, { key: "getRenderableTiles", value: function() {
            return this._renderable_tiles;
          } }, { key: "_updateRenderableTiles", value: function() {
            for (var e in this._renderable_tiles = [], this._visible_tiles) {
              var t2 = this._visible_tiles[e], r = this._tile_cache.get(e);
              t2.loaded ? (this._renderable_tiles.push(t2), r && r !== t2 && this._tile_cache.drop(e)) : r && (r.generation === this._scene.generation ? this._renderable_tiles.push(r) : this._tile_cache.drop(e));
            }
            return this._renderable_tiles;
          } }, { key: "getWorkerForTile", value: function(e, t2) {
            var r = t2.has_volatile_data ? this._scene.getWorkers(WorkerType.FAKE)[0] : t2.tiled ? this._scene.getWorkers(WorkerType.NATIVE)[Math.abs(e.x + e.y + e.z) % this._scene.num_workers] : this._scene.getWorkers(WorkerType.NATIVE)[t2.id % this._scene.num_workers];
            return r;
          } }, { key: "getActiveStyles", value: function() {
            return this._active_styles;
          } }, { key: "_updateActiveStyles", value: function() {
            for (var e = this._renderable_tiles, t2 = {}, r = 0; r < e.length; r++) {
              var i2 = e[r];
              Object.keys(i2.meshes).forEach(function(e2) {
                return t2[e2] = true;
              });
            }
            return this._active_styles = Object.keys(t2), this._active_styles;
          } }, { key: "isLoadingVisibleTiles", value: function() {
            var e = false;
            for (var t2 in this._visible_tiles) {
              if (!this._visible_tiles[t2].built) {
                e = true;
                break;
              }
            }
            return e;
          } }, { key: "updateTilesVisibilityCounters", value: function() {
            var t2 = this;
            Object.keys(this._visible_coords).forEach(function(e2) {
              e2 in t2._tile_visibility_counters || (t2._tile_visibility_counters[e2] = 0);
            });
            var e = Object.keys(this._tile_visibility_counters), r = [];
            e.forEach(function(e2) {
              e2 in t2._visible_coords ? (t2._tile_visibility_counters[e2]++, t2._tile_visibility_counters[e2] >= TILE_VISIBILITY_COUNTER_THRESHOLD && r.push(t2._visible_coords[e2])) : (t2._tile_visibility_counters[e2]--, t2._tile_visibility_counters[e2] <= 0 && delete t2._tile_visibility_counters[e2]);
            }), r.length && this.loadCoordinates(r);
          } }, { key: "loadCoordinates", value: function(e) {
            var l = this;
            e.sort(function(e2, t2) {
              var r = l._view.lookAtManipulator.getLookAtData().position, i2 = Geo$1.metersPerTile(e2.z) / 2, n2 = Geo$1.metersForTile(e2);
              n2.x += i2, n2.y -= i2;
              var o = Geo$1.metersForTile(t2);
              o.x += i2, o.y -= i2;
              var a2 = Math.abs(r[0] - n2.x) + Math.abs(r[1] - n2.y), s = Math.abs(r[0] - o.x) + Math.abs(r[1] - o.y);
              return (e2.center_dist = a2) < (t2.center_dist = s) ? -1 : s === a2 ? 0 : 1;
            }), e.forEach(function(e2) {
              return l.loadCoordinate(e2);
            });
          } }, { key: "_keepCoordinate", value: function(e, t2) {
            var r = 1 < arguments.length && void 0 !== t2 && t2, i2 = this._visible_coords[e];
            if (i2.z === this._view.center_tile.z)
              for (var n2 in this._scene.sources) {
                var o, a2, s, l = this._scene.sources[n2];
                l.builds_geometry_tiles && l.includesTile(i2, this._view.lookAtManipulator.getLookAtData().tile_level) && ((o = Tile.normalizedKey(i2, l, this._view.lookAtManipulator.getLookAtData().tile_level)) && !this.hasTile(o) && ((a2 = r && this._tile_cache.get(o)) || (this._all_visible_tiles_are_cached = false), s = a2 || new Tile({ source: l, coords: i2, worker: this.getWorkerForTile(i2, l), style_zoom: Utils$1.zoomToTileLevel(i2.z), view: this._view, sceneId: this._scene.id }), "ObjectSource" === l.config.type && (s.syncedAt = l.getSyncedAt()), this.keepTile(s)));
              }
          } }, { key: "loadCoordinate", value: function(e) {
            if (e.z === this._view.center_tile.z)
              for (var t2 in this._scene.sources) {
                var r, i2 = this._scene.sources[t2];
                i2.builds_geometry_tiles && i2.includesTile(e, this._view.lookAtManipulator.getLookAtData().tile_level) && (r = Tile.normalizedKey(e, i2, this._view.lookAtManipulator.getLookAtData().tile_level), this.hasTile(r) && this.buildTile(this._visible_tiles[r]));
              }
          } }, { key: "buildTile", value: function(e, t2) {
            this._building_tiles && this._building_tiles[e.key] || e.built && e.generation === this._scene.generation || (this._tileBuildStart(e.key), e.build(this._scene.generation, t2));
          } }, { key: "buildTileStylesCompleted", value: function(e) {
            var t2 = e.tile, r = e.progress;
            if (null == this._visible_tiles[t2.key])
              Tile.abortBuild(t2, this._scene.id);
            else if (t2.generation !== this._scene.generation)
              Tile.abortBuild(t2, this._scene.id);
            else {
              if (t2.id < this._visible_tiles[t2.key].id)
                return void Tile.abortBuild(t2, this._scene.id);
              t2 = this._visible_tiles[t2.key].merge(t2), r.done && (t2.built = true), t2.buildMeshes(this._scene.styles, r), this.updateTileStates(), this._scene.requestRedraw();
            }
            r.done && this._tileBuildStop(t2);
          } }, { key: "buildTileError", value: function(e) {
            this._forgetTile(e.key), Tile.abortBuild(e, this._scene.id);
          } }, { key: "_tileBuildStart", value: function(e) {
            this._is_labeled = false, this._building_tiles = this._building_tiles || {}, this._building_tiles[e] = true;
          } }, { key: "_tileBuildStop", value: function(e) {
            this._building_tiles && (e.source && e.source.hasLabeledData() && (this._update_labels_on_queue_check = true), delete this._building_tiles[e.key], Task.removeForTile(e.id), this.checkBuildQueue());
          } }, { key: "isReady", value: function() {
            return this._is_labeled && !this.isLoadingVisibleTiles();
          } }, { key: "checkBuildQueue", value: function() {
            this._building_tiles && 0 !== Object.keys(this._building_tiles).length || (this._building_tiles = null, this._update_labels_on_queue_check ? this._updateLabels() : (this._is_labeled = !Task.hasPendingTasks(), this._scene.immediateRedraw()));
          } }, { key: "_removeCachedTilesFilter", value: function(e, t2) {
            var r = t2.source;
            return !this._visible_tiles[e] && (t2.generation !== this._scene.generation || "ObjectSource" === r.config.type && r.getSyncedAt() > t2.syncedAt);
          } }]), n;
        }();
        function compareTileCoords(e, t2) {
          var r = e.coords, i2 = t2.coords;
          return r.z - i2.z || r.x - i2.x || r.y - i2.y;
        }
        function roundPrecision(e, t2) {
          var r = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : 2, i2 = Math.pow(10, r);
          return Math.round(Math.floor(e * t2) / t2 * i2) / i2;
        }
        function getTileByteLength(e) {
          var t2 = 0;
          for (var r in e.meshes)
            for (var i2 = e.meshes[r], n = 0; n < i2.length; n++) {
              var o = i2[n];
              t2 += o.buffer_size;
              for (var a2 = 0; a2 < o.textures.length; a2++)
                t2 += e.textureManager.getByteLength(o.textures[a2]);
            }
          return t2;
        }
        function getMaxTileCacheSize() {
          var e = 0.1;
          return navigator && navigator.deviceMemory ? e = 5 * navigator.deviceMemory / 100 : window && window.screen && (e = window.screen.width / 512 * window.screen.height / 512 * 0.03 * 3, e = Math.min(e, 1)), 1024 * e * 1024 * 1024;
        }
        var RenderState = function() {
          function r(e, t2) {
            _classCallCheck(this, r), t2(e), this.value = e, this.setup = t2;
          }
          return _createClass(r, [{ key: "get", value: function() {
            return this.value;
          } }, { key: "set", value: function(e) {
            JSON.stringify(this.value) !== JSON.stringify(e) && (this.setup(e), this.value = e);
          } }]), r;
        }(), RenderStateManager = function e(t2) {
          _classCallCheck(this, e), this.defaults = {}, this.defaults.culling = true, this.defaults.culling_face = t2.BACK, this.defaults.blending = false, this.defaults.blending_src = t2.ONE_MINUS_SRC_ALPHA, this.defaults.blending_dst = t2.ONE_MINUS_SRC_ALPHA, this.defaults.blending_src_alpha = t2.ONE, this.defaults.blending_dst_alpha = t2.ONE_MINUS_SRC_ALPHA, this.defaults.depth_write = true, this.defaults.depth_test = true, t2.depthFunc(t2.LESS), this.culling = new RenderState({ cull: this.defaults.culling, face: this.defaults.culling_face }, function(e2) {
            e2.cull ? (t2.enable(t2.CULL_FACE), t2.cullFace(e2.face)) : t2.disable(t2.CULL_FACE);
          }), this.blending = new RenderState({ blend: this.defaults.blending, src: this.defaults.blending_src, dst: this.defaults.blending_dst, src_alpha: this.defaults.blending_src_alpha, dst_alpha: this.defaults.blending_dst_alpha }, function(e2) {
            e2.blend ? (t2.enable(t2.BLEND), e2.src_alpha && e2.dst_alpha ? t2.blendFuncSeparate(e2.src, e2.dst, e2.src_alpha, e2.dst_alpha) : t2.blendFunc(e2.src, e2.dst)) : t2.disable(t2.BLEND);
          }), this.depth_write = new RenderState({ depth_write: this.defaults.depth_write }, function(e2) {
            t2.depthMask(e2.depth_write);
          }), this.depth_test = new RenderState({ depth_test: this.defaults.depth_test }, function(e2) {
            e2.depth_test ? t2.enable(t2.DEPTH_TEST) : t2.disable(t2.DEPTH_TEST);
          });
        }, MediaCapture = function() {
          function e() {
            _classCallCheck(this, e), this.canvas = null, this.gl = null, this.screenshot_canvas = null, this.screenshot_context = null, this.queue_screenshot = null, this.video_capture = null;
          }
          return _createClass(e, [{ key: "setCanvas", value: function(e2, t2) {
            this.canvas = e2, this.gl = t2;
          } }, { key: "screenshot", value: function(e2) {
            var r = this, t2 = (0 < arguments.length && void 0 !== e2 ? e2 : {}).background;
            return null != this.queue_screenshot || (this.queue_screenshot = { background: t2 }, this.queue_screenshot.promise = new Promise(function(e3, t3) {
              r.queue_screenshot.resolve = e3, r.queue_screenshot.reject = t3;
            })), this.queue_screenshot.promise;
          } }, { key: "completeScreenshot", value: function() {
            if (null != this.queue_screenshot) {
              var e2 = this.canvas.width, t2 = this.canvas.height, r = new Uint8Array(e2 * t2 * 4);
              this.gl.readPixels(0, 0, e2, t2, this.gl.RGBA, this.gl.UNSIGNED_BYTE, r);
              for (var i2 = (i2 = this.queue_screenshot.background) && "transparent" !== i2 ? StyleParser.parseColor(i2).slice(0, 3).map(function(e3) {
                return 255 * e3;
              }) : null, n = new Uint8ClampedArray(e2 * t2 * 4), o = 0; o < t2; o++)
                for (var a2 = 0; a2 < e2; a2++) {
                  var s = 4 * ((t2 - o - 1) * e2 + a2), l = 4 * (o * e2 + a2), u2 = r[3 + s];
                  n[0 + l] = 255 * r[0 + s] / u2, n[1 + l] = 255 * r[1 + s] / u2, n[2 + l] = 255 * r[2 + s] / u2, n[3 + l] = u2, i2 && (u2 /= 255, n[0 + l] = n[0 + l] * u2 + i2[0] * (1 - u2), n[1 + l] = n[1 + l] * u2 + i2[1] * (1 - u2), n[2 + l] = n[2 + l] * u2 + i2[2] * (1 - u2), n[3 + l] = 255);
                }
              this.screenshot_canvas = this.screenshot_canvas || document.createElement("canvas");
              var c2 = this.screenshot_canvas;
              c2.width = e2, c2.height = t2, this.screenshot_context = this.screenshot_context || c2.getContext("2d");
              var h = this.screenshot_context, f2 = new ImageData(n, e2, t2);
              h.putImageData(f2, 0, 0);
              for (var d = c2.toDataURL("image/png"), _ = atob(d.slice(22)), p2 = new Uint8Array(_.length), g = 0; g < _.length; ++g)
                p2[g] = _.charCodeAt(g);
              var m = new Blob([p2], { type: "image/png" });
              this.queue_screenshot.resolve({ url: d, blob: m, type: "png" }), this.queue_screenshot = null;
            }
          } }, { key: "startVideoCapture", value: function() {
            var i2 = this;
            if ("function" != typeof window.MediaRecorder || !this.canvas || "function" != typeof this.canvas.captureStream)
              return log("warn", "Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser"), false;
            if (this.video_capture)
              return log("warn", "Video capture already in progress, call Scene.stopVideoCapture() first"), false;
            try {
              var n = this.video_capture = {};
              n.chunks = [], n.stream = this.canvas.captureStream(), n.options = { mimeType: "video/webm" }, n.media_recorder = new MediaRecorder(n.stream, n.options), n.media_recorder.ondataavailable = function(e2) {
                var t2, r;
                0 < e2.data.size && n.chunks.push(e2.data), n.resolve && (r = createObjectURL(t2 = new Blob(n.chunks, { type: n.options.mimeType })), n.stream && (n.stream.getTracks() || []).forEach(function(e3) {
                  e3.stop(), n.stream.removeTrack(e3);
                }), n.stream = null, n.media_recorder = null, i2.video_capture = null, n.resolve({ url: r, blob: t2, type: "webm" }));
              }, n.media_recorder.start();
            } catch (e2) {
              return this.video_capture = null, log("error", "Scene video capture failed", e2), false;
            }
            return true;
          } }, { key: "stopVideoCapture", value: function() {
            var r = this;
            return this.video_capture ? (this.video_capture.promise = new Promise(function(e2, t2) {
              r.video_capture.resolve = e2, r.video_capture.reject = t2;
            }), this.video_capture.media_recorder.stop(), this.video_capture.promise) : (log("warn", "No scene video capture in progress, call Scene.startVideoCapture() first"), Promise.resolve({}));
          } }]), e;
        }(), SceneWorker = function() {
          function e() {
            _classCallCheck(this, e), this.sources = {}, this.styles = {}, this.layers = {}, this.tiles = {}, this._isConfigured = false;
          }
          return _createClass(e, [{ key: "init", value: function(e2, t2, r, i2, n, o, a2) {
            return this.setMeshVariantMaxLife(a2), this.scene_id = e2, this.textureManager = getTextureManager(e2), this._worker_id = t2, log.setLevel(r), Utils$1.device_pixel_ratio = i2, VertexElements.setElementIndexUint(n), FeatureSelection.setPrefix(this._worker_id), this._style_manager = new StyleManager(), this._importExternalScripts(o), Label.id_prefix = t2, this._isConfigured = false, t2;
          } }, { key: "dispose", value: function() {
            this._last_config_sources = null, this._config_sources = null, this.sources = null, this._style_manager = null, this.styles = null, this.layers = null, this.tiles = null;
          } }, { key: "_importExternalScripts", value: function(e2) {
            var t2;
            0 !== e2.length && (log("debug", "loading custom data source scripts in worker:", e2), t2 = Object.getOwnPropertyNames(window), importScripts.apply(void 0, _toConsumableArray(e2)), Object.getOwnPropertyNames(window).forEach(function(e3) {
              -1 === t2.indexOf(e3) && (self[e3] = window[e3]);
            }));
          } }, { key: "updateConfig", value: function(e2, t2) {
            var r = e2.config, i2 = e2.generation, n = e2.introspection, r = JSON.parse(r);
            for (var o in mergeDebugSettings(t2), this._generation = i2, this._isConfigured = false, r.layers)
              r.layers[o] && (r.layers[o].data = Utils$1.stringsToFunctions(r.layers[o].data));
            this.global = Utils$1.stringsToFunctions(r.global), this._createDataSources(r), r.styles = Utils$1.stringsToFunctions(r.styles, StyleParser.wrapFunction), this.styles = this._style_manager.build(r.styles), self.is_fake_worker = Thread.is_main, this._style_manager.initStyles({ generation: this._generation, styles: this.styles, sources: this.sources, introspection: n, id: this.scene_id }), delete self.is_fake_worker, this.layers = parseLayers(r.layers, this._style_manager.styles), this._configuring = this._syncTextures(r.textures);
          } }, { key: "setMeshVariantMaxLife", value: function(e2) {
            this.meshVariantMaxLife = e2;
          } }, { key: "_createDataSources", value: function(t2) {
            var r = this;
            this._last_config_sources = this._config_sources || {}, this._config_sources = t2.sources;
            var e2 = this.sources, i2 = [];
            for (var n in t2.sources = Utils$1.stringsToFunctions(t2.sources), this.sources = {}, self.is_fake_worker = Thread.is_main, t2.sources)
              if (JSON.stringify(this._last_config_sources[n]) !== JSON.stringify(t2.sources[n])) {
                var o = void 0;
                try {
                  o = DataSource.create(Object.assign({}, t2.sources[n], { name: n }), this.sources);
                } catch (e3) {
                  log("error", "Error creating source.", e3.message, t2.sources[n]);
                  continue;
                }
                o && (this.sources[n] = o, i2.push(n));
              } else
                this.sources[n] = e2[n];
            delete self.is_fake_worker, i2.forEach(function(e3) {
              for (var t3 in r.tiles)
                r.tiles[t3].source === e3 && delete r.tiles[t3];
            });
          } }, { key: "awaitConfiguration", value: function() {
            return this._configuring;
          } }, { key: "_onConfig", value: function(t2) {
            var r = this;
            if ((this._isConfigured = true) !== t2.loaded)
              t2.loading = true, t2.loaded = false, t2.error = null, this._loadTileSourceData(t2).then(function() {
                if (r.getTile(t2.id)) {
                  t2.loading = false, t2.loaded = true;
                  try {
                    Tile.buildGeometry(t2, r);
                  } catch (e2) {
                    t2.error = e2.toString(), WorkerBroker.postMessage("TileManager_".concat(r.scene_id, ".buildTileError"), Tile.slice(t2));
                  }
                } else
                  log("trace", "stop tile build after data source load because tile was removed. Key: ".concat(t2.key, ", id: ").concat(t2.id));
              }, function(e2) {
                t2.loading = false, t2.loaded = false, t2.error = e2.stack, log("error", "tile load error for tile with key ".concat(t2.key, " and id ").concat(t2.id, ": ").concat(t2.error)), WorkerBroker.postMessage("TileManager_".concat(r.scene_id, ".buildTileError"), Tile.slice(t2));
              });
            else {
              log("trace", "used worker cache for tile with key ".concat(t2.key, " and id ").concat(t2.id));
              try {
                Tile.buildGeometry(t2, this);
              } catch (e2) {
                t2.error = e2.toString(), WorkerBroker.postMessage("TileManager_".concat(this.scene_id, ".buildTileError"), Tile.slice(t2));
              }
            }
          } }, { key: "buildTile", value: function(e2) {
            var t2, r = e2.tile, i2 = this.getTile(r.id);
            i2 && i2.loading || (r = this.tiles[r.id] = Object.assign(i2 || {}, r), this._isConfigured ? this._onConfig(r) : (t2 = this).awaitConfiguration().then(function() {
              return t2._onConfig(r);
            }));
          } }, { key: "_loadTileSourceData", value: function(e2) {
            return this.sources[e2.source] ? this.sources[e2.source].load(e2) : (e2.source_data = {}, Promise.resolve(e2));
          } }, { key: "getTile", value: function(e2) {
            return this.tiles[e2];
          } }, { key: "removeTile", value: function(e2) {
            var t2 = this.tiles[e2];
            null != t2 && (true === t2.loading && (log("trace", "cancel tile load for tile id ".concat(e2)), t2.loading = false, Tile.cancel(t2)), delete this.tiles[e2], log("trace", "remove tile from cache, tile id: ".concat(e2)));
          } }, { key: "queryFeatures", value: function(e2) {
            var o = this, a2 = e2.filter, s = e2.visible, l = e2.geometry, t2 = e2.tile_ids, u2 = [], r = t2.map(function(e3) {
              return o.tiles[e3];
            }).filter(function(e3) {
              return e3;
            });
            return null != a2 && (a2 = -1 < ["{", "["].indexOf(a2[0]) ? JSON.parse(a2) : a2, a2 = Utils$1.stringsToFunctions(a2, StyleParser.wrapFunction)), a2 = buildFilter(a2, FilterOptions), r.forEach(function(n) {
              for (var e3 in n.source_data.layers)
                !function(i2) {
                  n.source_data.layers[i2].features.forEach(function(e4) {
                    var t3, r2;
                    true === s && e4.generation !== o._generation || false === s && e4.generation === o._generation || ((t3 = StyleParser.getFeatureParseContext(e4, n, o.global)).source = n.source, t3.layer = i2, a2(t3) && (r2 = { type: e4.type, properties: e4.properties }, true === l && (r2.geometry = Geo$1.copyGeometry(e4.geometry), Geo$1.tileSpaceToLatlng(r2.geometry, n.coords.z, n.min)), u2.push(r2)));
                  });
                }(e3);
            }), u2;
          } }, { key: "resetFeatureSelection", value: function() {
            FeatureSelection.reset();
          } }, { key: "_syncTextures", value: function(e2) {
            var t2 = [];
            return e2 && t2.push.apply(t2, _toConsumableArray(Object.keys(e2))), log("trace", "sync textures to worker:", t2), 0 < t2.length ? this.textureManager.syncTexturesToWorker(t2) : Promise.resolve();
          } }, { key: "profile", value: function(e2) {
            console.profile("worker ".concat(this._worker_id, ": ").concat(e2));
          } }, { key: "profileEnd", value: function(e2) {
            console.profileEnd("worker ".concat(this._worker_id, ": ").concat(e2));
          } }, { key: "terminate", value: function() {
            this.dispose();
          } }]), e;
        }();
        (Thread.is_worker || self.H && self.H.DEBUG) && WorkerBroker.addTarget("self", new SceneWorker());
        var Scene = function() {
          function l(e, t2) {
            _classCallCheck(this, l), t2 = t2 || {}, subscribeMixin(this), this.id = l.id++, this.textureManager = getTextureManager(this.id), this.initialized = false, this.initializing = null, this.sources = {}, this.view = new View(this, t2), this.tile_manager = new TileManager({ scene: this, view: this.view }), this.num_workers = t2.numWorkers || 2, true === t2.disableVertexArrayObjects && (VertexArrayObject.disabled = true), Utils$1.device_pixel_ratio = t2.devicePixelRatio, this.config = null, this.config_source = e, this.config_bundle = null, this.last_valid_config_source = null, this.styles = null, this.style_manager = new StyleManager(), this.building = null, this.dirty = true, t2.preUpdate && this.subscribe({ pre_update: t2.preUpdate }), t2.postUpdate && this.subscribe({ post_update: t2.postUpdate }), this.render_loop = !t2.disableRenderLoop, this.render_loop_active = false, this.render_loop_stop = false, this.render_count = 0, this.last_render_count = 0, this.render_count_changed = false, this.frame = 0, this.last_main_render = -1, this.last_selection_render = -1, this.media_capture = new MediaCapture(), this.selection = null, this.introspection = true === t2.introspection, this.viewport = t2.viewport, this.adjustMeshVariantMaxLife(), this.container = t2.container, this.canvas = null, this.contextOptions = t2.webGLContextOptions, this.lights = null, this.background = null, this.createListeners(), this.updating = 0, this.generation = l.generation, this.last_complete_generation = l.generation, this.log_level = t2.logLevel || "warn", log.setLevel(this.log_level), log.reset();
          }
          return _createClass(l, [{ key: "load", value: function(e, t2) {
            var i2 = this, r = 0 < arguments.length && void 0 !== e ? e : null, n = 1 < arguments.length && void 0 !== t2 ? t2 : {};
            return this.initializing || (log.reset(), this.updating++, this.initialized = false, this.initial_build_time = null, (n = "string" == typeof n ? { base_path: n } : n).blocking = void 0 === n.blocking || n.blocking, false !== this.render_loop && this.setupRenderLoop(), this.createCanvas(), this.textureManager.destroy(this.gl), this.initializing = this.loadScene(r, n).then(function() {
              return i2.createWorkers();
            }).then(function() {
              i2.resetFeatureSelection();
              var e2 = "object" === _typeof(i2.config_source) || i2.hasSubscribersFor("load"), t3 = i2.updateConfig({ serialize_funcs: e2, normalize: false, load_event: true, fade_in: true });
              if (true === n.blocking)
                return t3;
            }).then(function() {
              i2.updating--, i2.initializing = null, i2.initialized = true, i2.last_valid_config_source = i2.config_source, i2.last_valid_options = { base_path: n.base_path, file_type: n.file_type }, i2.requestRedraw();
            }).catch(function(e2) {
              var t3, r2;
              if (i2.initializing = null, i2.updating = 0, r2 = "YAMLException" === e2.name ? (t3 = "yaml", "Error parsing scene YAML") : "Error initializing scene", i2.trigger("error", { type: t3, message: r2, error: e2, url: i2.config_source }), r2 = "Scene.load() failed to load ".concat(i2.config_source, ": ").concat(e2.message), i2.last_valid_config_source)
                return log("warn", r2, e2), log("info", "Scene.load() reverting to last valid configuration"), i2.load(i2.last_valid_config_source, i2.last_valid_base_path);
              throw log("error", r2, e2), e2;
            })), this.initializing;
          } }, { key: "destroy", value: function() {
            var e;
            this.initialized = false, this.render_loop_stop = true, this.destroyListeners(), this.canvas && this.canvas.parentNode && (this.canvas.parentNode.removeChild(this.canvas), this.canvas = null), this.container = null, this.selection && this.selection.destroy(), this.gl && (this.textureManager.destroy(this.gl), this.style_manager.destroy(this.gl), this.styles = {}, ShaderProgram.reset(), (e = this.gl.getExtension("WEBGL_lose_context")) && e.loseContext(), this.gl = null), this.sources = {}, this.tile_manager.destroy(), this.tile_manager = null, this.destroyWorkers(), log.reset();
          } }, { key: "createCanvas", value: function() {
            if (!this.canvas) {
              this.container = this.container || document.body, this.canvas = document.createElement("canvas"), this.canvas.style.position = "absolute", this.canvas.style.top = 0, this.canvas.style.left = 0, this.container.style.backgroundColor = "transparent", this.container.appendChild(this.canvas);
              try {
                this.gl = Context$1.getContext(this.canvas, Object.assign({ alpha: true, premultipliedAlpha: false, stencil: true, device_pixel_ratio: Utils$1.device_pixel_ratio }, this.contextOptions));
              } catch (e) {
                throw new Error("Couldn't create WebGL context. Your browser may not support WebGL, or it's turned off? Visit http://webglreport.com/ for more info.");
              }
              this.handleViewportUpdate(), VertexArrayObject.init(this.gl), this.render_states = new RenderStateManager(this.gl), this.media_capture.setCanvas(this.canvas, this.gl);
            }
          } }, { key: "getWorkerUrl", value: function() {
            var e, t2;
            if (void 0 !== __worker_src__ && (t2 = "(" + __worker_src__ + ")()", __worker_src_origin__ && "" !== __worker_src_map__ && (t2 += "\n//# sourceMappingURL=" + __worker_src_origin__.slice(0, __worker_src_origin__.lastIndexOf("/") + 1) + __worker_src_map__), e = createObjectURL(new Blob([t2], { type: "application/javascript" }))), !e)
              throw new Error("Couldn't find internal Tangram source variable (may indicate the library did not build correctly)");
            return e;
          } }, { key: "updateExternalScripts", value: function() {
            var r = _toConsumableArray(this.external_scripts || []), e = [];
            if (this.config.scene.scripts)
              for (var t2 in this.config.scene.scripts)
                -1 === e.indexOf(this.config.scene.scripts[t2]) && e.push(this.config.scene.scripts[t2]);
            for (var i2 in this.config.sources) {
              var n = this.config.sources[i2];
              if (n.scripts)
                for (var o in n.scripts)
                  -1 === e.indexOf(n.scripts[o]) && e.push(n.scripts[o]);
            }
            return this.external_scripts = e, !(this.external_scripts.length === r.length && this.external_scripts.every(function(e2, t3) {
              return e2 === r[t3];
            }));
          } }, { key: "createWorkers", value: function() {
            return this.updateExternalScripts() && this.destroyWorkers(), this._workers ? Promise.resolve() : this.makeWorkers(this.getWorkerUrl());
          } }, { key: "makeWorkers", value: function(r) {
            var i2 = this, n = !!this.gl.getExtension("OES_element_index_uint"), o = [];
            this._workers = [];
            for (var a2 = 0; a2 < this.num_workers; a2++)
              !function() {
                var e2 = new Worker(r);
                i2._workers[a2] = e2, WorkerBroker.addWorker(e2), log("debug", "Scene.makeWorkers: initializing worker ".concat(a2));
                var t2 = a2;
                o.push(WorkerBroker.postMessage(e2, "self.init", i2.id, a2, i2.log_level, Utils$1.device_pixel_ratio, n, i2.external_scripts, i2.meshVariantMaxLife).then(function(e3) {
                  return log("debug", "Scene.makeWorkers: initialized worker ".concat(e3)), e3;
                }, function(e3) {
                  return log("error", "Scene.makeWorkers: failed to initialize worker ".concat(t2, ":"), e3), Promise.reject(e3);
                }));
              }();
            var e = new SceneWorker();
            return this._workers.push(e), o.push(e.init(this.id, a2, this.log_level, Utils$1.device_pixel_ratio, n, [], this.meshVariantMaxLife)), this.next_worker = 0, Promise.all(o).then(function() {
              log.setWorkers(i2._workers.slice(0, i2.num_workers)), revokeObjectURL(r);
            });
          } }, { key: "getWorkers", value: function(t2) {
            return this._workers.filter(function(e) {
              switch (t2) {
                case WorkerType.NATIVE:
                  return e instanceof Worker;
                case WorkerType.FAKE:
                  return e instanceof SceneWorker;
                default:
                  return true;
              }
            });
          } }, { key: "destroyWorkers", value: function() {
            this.selection = null, Array.isArray(this._workers) && (log.setWorkers(null), this._workers.forEach(function(e) {
              e.terminate();
            }), this._workers = null);
          } }, { key: "ready", value: function() {
            return !(!this.view.ready() || 0 === Object.keys(this.sources).length);
          } }, { key: "handleViewportUpdate", value: function() {
            var e = this.viewport, t2 = e.width, r = e.height;
            0 < t2 && 0 < r && (this.dirty = true, this.view.handleViewportUpdate(), this.gl && Context$1.resize(this.gl, t2, r, Utils$1.device_pixel_ratio)), this.adjustMeshVariantMaxLife() && this.syncMeshVariantMaxLife();
          } }, { key: "adjustMeshVariantMaxLife", value: function() {
            var e = this.viewport, t2 = e.width, r = e.height, i2 = Utils$1.device_pixel_ratio, n = t2 / i2 / 256 * (r / i2 / 256), o = Math.max(Math.ceil(2 * n), 8);
            if (this.meshVariantMaxLife !== o)
              return this.meshVariantMaxLife = o, true;
          } }, { key: "syncMeshVariantMaxLife", value: function() {
            this._workers && WorkerBroker.postMessage(this._workers, "self.setMeshVariantMaxLife", this.meshVariantMaxLife);
          } }, { key: "requestRedraw", value: function() {
            this.dirty = true;
          } }, { key: "immediateRedraw", value: function() {
            this.dirty = true, this.update();
          } }, { key: "renderLoop", value: function() {
            this.render_loop_active = true, this.initialized && this.update(), Task.setState({ user_moving_view: this.view.user_input_active }), Task.processAll(), this.render_loop_stop ? (this.render_loop_stop = false, this.render_loop_active = false) : window.requestAnimationFrame(this.renderLoop.bind(this));
          } }, { key: "setupRenderLoop", value: function() {
            var e = this;
            this.render_loop_active || setTimeout(function() {
              e.renderLoop();
            }, 0);
          } }, { key: "update", value: function() {
            var e = this.dirty, t2 = !!this.selection && this.selection.hasPendingRequests(), r = !(false === e && false === t2 || false === this.initialized || 0 < this.updating || false === this.ready());
            return this.trigger("pre_update", r), this.view.update(), r && (this.dirty = false, this.render({ main: e, selection: t2 }), this.updateViewComplete(), this.media_capture.completeScreenshot(), this.trigger("post_update", r), true !== this.animated && !this.view.isAnimating() || (this.dirty = true), this.frame++, log("trace", "Scene.render()"), true);
          } }, { key: "render", value: function(e) {
            var t2 = this, r = e.main, i2 = e.selection, n = this.gl;
            if (Object.keys(this.lights).forEach(function(e2) {
              return t2.lights[e2].update();
            }), r && (this.render_count = this.renderPass(), this.last_main_render = this.frame), i2) {
              if (this.view.panning || this.view.user_input_active)
                return void this.selection.clearPendingRequests();
              (this.last_selection_render < this.last_main_render || this.selection.has_dirty_buffer) && (this.selection.bind(), this.renderPass("selection_program", { allow_blend: false }), n.bindFramebuffer(n.FRAMEBUFFER, null), n.viewport(0, 0, this.canvas.width, this.canvas.height), n.clearColor.apply(n, _toConsumableArray(this.background.color)), this.last_selection_render = this.frame, this.selection.has_dirty_buffer = false), this.selection.read(this.tile_manager.getRenderableTiles()), this.selection.has_dirty_buffer && this.render({ main: false, selection: i2 });
            }
            return this.render_count_changed = false, this.render_count !== this.last_render_count && (this.render_count_changed = true), this.last_render_count = this.render_count, true;
          } }, { key: "renderPass", value: function(e, t2) {
            var r = this, i2 = 0 < arguments.length && void 0 !== e ? e : "program", n = (1 < arguments.length && void 0 !== t2 ? t2 : {}).allow_blend, o = this.gl, n = null == n || n;
            this.clearFrame();
            for (var a2, s = Style.sortByBlendOrderWithinLayers(this.tile_manager.getActiveStyles().map(function(e2) {
              return r.styles[e2];
            }).filter(function(e2) {
              return e2;
            })), l2 = 0, u2 = 0, c2 = 0; c2 < s.length; c2++) {
              var h, f2, d = s[c2], _ = u2 - (h = parseInt(d.name));
              (d.clean_depth || _) && (this.render_states.depth_write.value.depth_write ? o.clear(o.DEPTH_BUFFER_BIT) : (o.depthMask(true), o.clear(o.DEPTH_BUFFER_BIT), o.depthMask(false)), _ && (u2 = h)), d.blend !== a2 && (f2 = Object.assign({}, Style.render_states[d.blend], { blend: n && d.blend }), this.setRenderState(f2));
              var p2 = "translucent" === d.blend && "program" === i2;
              p2 && (this.gl.colorMask(false, false, false, false), this.renderStyle(d.name, i2), this.gl.colorMask(true, true, true, true), this.gl.depthFunc(this.gl.EQUAL), this.gl.enable(this.gl.STENCIL_TEST), this.gl.clear(this.gl.STENCIL_BUFFER_BIT), this.gl.stencilFunc(this.gl.EQUAL, this.gl.ZERO, 255), this.gl.stencilOp(this.gl.KEEP, this.gl.KEEP, this.gl.INCR)), l2 += this.renderStyle(d.name, i2), p2 && (this.gl.disable(this.gl.STENCIL_TEST), this.gl.depthFunc(this.gl.LESS)), a2 = d.blend;
            }
            return l2;
          } }, { key: "renderStyle", value: function(s, l2) {
            for (var u2, c2 = this, h = this.styles[s], f2 = true, d = 0, _ = this.tile_manager.getRenderableTiles(), e = Math.max.apply(Math, _toConsumableArray(_.map(function(e2) {
              return e2.meshes[s] ? Math.max.apply(Math, _toConsumableArray(e2.meshes[s].map(function(e3) {
                return e3.variant.order;
              }))) : -1;
            }))), t2 = 0; t2 < e + 1; t2++) {
              var r = function(t3) {
                for (var e2 = 0; e2 < _.length; e2++) {
                  var r2 = _[e2];
                  if (null != r2.meshes[s] && r2.shouldProxyForStyle(s))
                    for (var i2 = r2.meshes[s].filter(function(e3) {
                      return e3.variant.order === t3;
                    }), n = 0, o = i2.length; n < o; n += 1) {
                      var a2 = i2[n];
                      if (true === f2 && (f2 = false, !(u2 = c2.setupStyle(h, l2))))
                        return { v: 0 };
                      c2.view.setupTile(r2, u2), c2.selection.setupDiscards(u2), h.render(a2) && c2.requestRedraw(), d += a2.geometry_count;
                    }
                }
              }(t2);
              if ("object" === _typeof(r))
                return r.v;
            }
            return d;
          } }, { key: "setupStyle", value: function(t2, e) {
            var r;
            try {
              if (!(r = t2.getProgram(e)))
                return;
            } catch (e2) {
              return void this.trigger("warning", { type: "styles", message: "Error compiling style ".concat(t2.name), style: t2, shader_errors: t2.program && t2.program.shader_errors });
            }
            for (var i2 in r.use(), t2.setup(), this.view.setupProgram(r), this.lights)
              this.lights[i2].setupProgram(r);
            return r;
          } }, { key: "clearFrame", value: function() {
            this.initialized && (this.render_states.depth_write.set({ depth_write: true }), this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT | this.gl.STENCIL_BUFFER_BIT));
          } }, { key: "setRenderState", value: function(e) {
            var t2, r, i2 = 0 < arguments.length && void 0 !== e ? e : {}, n = i2.depth_test, o = i2.depth_write, a2 = i2.cull_face, s = i2.blend;
            this.initialized && (t2 = this.render_states, n = false !== n && t2.defaults.depth_test, o = false !== o && t2.defaults.depth_write, a2 = false !== a2 && t2.defaults.culling, s = null != s ? s : t2.defaults.blending, r = this.gl, t2.depth_test.set({ depth_test: n }), t2.depth_write.set({ depth_write: o }), t2.culling.set({ cull: a2, face: t2.defaults.culling_face }), !s || "opaque" === s ? t2.blending.set({ blend: false }) : "overlay" === s || "inlay" === s || "translucent" === s ? t2.blending.set({ blend: true, src: r.SRC_ALPHA, dst: r.ONE_MINUS_SRC_ALPHA, src_alpha: r.ONE, dst_alpha: r.ONE_MINUS_SRC_ALPHA }) : "add" === s ? t2.blending.set({ blend: true, src: r.ONE, dst: r.ONE }) : "multiply" === s && t2.blending.set({ blend: true, src: r.ZERO, dst: r.SRC_COLOR }));
          } }, { key: "getFeatureAt", value: function(e, t2, r) {
            var i2, n = t2.radius, o = t2.top_most_only;
            this.initialized ? (i2 = { x: e.x / this.view.size.css.width, y: e.y / this.view.size.css.height }, n = 0 < n ? { x: n / this.view.size.css.width, y: n / this.view.size.css.height } : null, this.selection.getFeatureAt(i2, { radius: n, top_most_only: o }, r)) : log("debug", "Scene.getFeatureAt() called before scene was initialized");
          } }, { key: "queryFeatures", value: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e ? e : {}, r = t2.filter, i2 = t2.unique, l2 = void 0 === i2 || i2, n = t2.group_by, u2 = void 0 === n ? null : n, o = t2.visible, a2 = void 0 === o ? null : o, s = t2.geometry, c2 = void 0 !== s && s, r = Utils$1.serializeWithFunctions(r), h = this.tile_manager.getRenderableTiles().map(function(e2) {
              return e2.id;
            });
            return WorkerBroker.postMessage(this._workers, "self.queryFeatures", { filter: r, visible: a2, geometry: c2, tile_ids: h }).then(function(e2) {
              var i3 = [], n2 = {}, o2 = {}, a3 = (l2 = "string" == typeof l2 ? [l2] : l2) && function(e3) {
                return JSON.stringify(Array.isArray(l2) ? sliceObject(e3, l2) : e3);
              }, s2 = (u2 = ("string" == typeof u2 || Array.isArray(u2)) && u2) && function(e3) {
                return Array.isArray(u2) ? JSON.stringify(sliceObject(e3, u2)) : e3[u2];
              };
              return e2.forEach(function(e3) {
                return e3.forEach(function(e4) {
                  if (a3) {
                    var t3 = a3(e4);
                    if (n2[t3])
                      return;
                    n2[t3] = true;
                  }
                  var r2;
                  s2 ? (r2 = s2(e4.properties), o2[r2] = o2[r2] || [], o2[r2].push(e4)) : i3.push(e4);
                });
              }), s2 ? o2 : i3;
            });
          } }, { key: "loadScene", value: function(e, t2) {
            var i2 = this, r = 0 < arguments.length && void 0 !== e ? e : null, n = 1 < arguments.length && void 0 !== t2 ? t2 : {}, o = n.base_path, a2 = n.file_type;
            return this.config_source = r || this.config_source, "string" == typeof this.config_source ? this.base_path = pathForURL(o || this.config_source) : this.base_path = pathForURL(o), this.config_path = this.base_path, SceneLoader$1.loadScene(this.config_source, { path: this.base_path, type: a2 }).then(function(e2) {
              var t3 = e2.config, r2 = e2.bundle;
              return i2.config = t3, i2.config_bundle = r2, i2.config;
            });
          } }, { key: "createDataSources", value: function() {
            var t2 = this, r = [], e = Object.keys(this.sources), i2 = 0;
            for (var n in this.config.sources) {
              var o = this.config.sources[n], a2 = this.sources[n];
              try {
                var s = Object.assign({}, o, { name: n, id: i2++ });
                if (this.sources[n] = DataSource.create(s, this.sources), !this.sources[n])
                  throw {};
              } catch (e2) {
                delete this.sources[n];
                var l2 = "Could not create data source: ".concat(e2.message);
                log("warn", "Scene: ".concat(l2), o), this.trigger("warning", { type: "sources", source: o, message: l2 });
              }
              DataSource.sameConfig(this.sources[n], a2) || r.push(n);
            }
            for (var u2 in e.forEach(function(e2) {
              t2.config.sources[e2] || (delete t2.sources[e2], r.push(e2));
            }), 0 < r.length && this.tile_manager.removeTiles(function(e2) {
              return -1 < r.indexOf(e2.source.name);
            }), this.config.layers) {
              var c2 = this.config.layers[u2];
              false !== c2.enabled && c2.data && this.sources[c2.data.source] && (this.sources[c2.data.source].builds_geometry_tiles = true);
            }
          } }, { key: "loadTextures", value: function() {
            var e = this;
            return this.textureManager.createFromObject(this.gl, this.config.textures).then(function() {
              return e.textureManager.createDefault(e.gl);
            });
          } }, { key: "updateStyles", value: function() {
            if (!this.initialized && !this.initializing)
              throw new Error("Scene.updateStyles() called before scene was initialized");
            for (var e in this.styles = this.style_manager.build(this.config.styles), this.style_manager.initStyles(this), this.styles)
              this.styles[e].setGL(this.gl);
            this.dirty = true;
          } }, { key: "createLights", value: function() {
            for (var e in this.lights = {}, this.config.lights) {
              var t2;
              this.config.lights[e] && "object" === _typeof(this.config.lights[e]) && ((t2 = this.config.lights[e]).name = e.replace("-", "_"), t2.visible = false !== t2.visible, t2.visible && (this.lights[t2.name] = Light.create(this.view, t2)));
            }
            Light.inject(this.lights);
          } }, { key: "setBackground", value: function() {
            var e, t2 = this.config.scene.background;
            this.background = {}, t2 && t2.color && (this.background.color = StyleParser.parseColor(t2.color)), this.background.color || (this.background.color = [0, 0, 0, 0]), 1 === this.background.color[3] ? this.canvas.style.backgroundColor = "rgba(".concat(this.background.color.map(function(e2) {
              return Math.floor(255 * e2);
            }).join(", "), ")") : this.canvas.style.backgroundColor = "transparent", (e = this.gl).clearColor.apply(e, _toConsumableArray(this.background.color));
          } }, { key: "setIntrospection", value: function(e) {
            var t2 = this;
            return e !== this.introspection ? (this.introspection = e || false, this.updating++, this.updateConfig({ normalize: false }).then(function() {
              return t2.updating--;
            })) : Promise.resolve();
          } }, { key: "updateConfig", value: function(e) {
            var t2 = 0 < arguments.length && void 0 !== e ? e : {}, r = t2.load_event, i2 = void 0 !== r && r, n = t2.serialize_funcs, o = t2.normalize, a2 = void 0 === o || o;
            t2.fade_in;
            this.generation = ++l.generation, this.updating++, this.config = SceneLoader$1.applyGlobalProperties(this.config), a2 ? SceneLoader$1.normalize(this.config, this.config_bundle) : (SceneLoader$1.hoistStyleShaderUniformTextures(this.config, this.config_bundle, { include_globals: true }), SceneLoader$1.normalizeTextures(this.config, this.config_bundle)), this.trigger(i2 ? "load" : "update", { config: this.config }), this.style_manager.init(), this.createLights(), this.createDataSources(), this.loadTextures(), this.setBackground(), FontManager.loadFonts(this.config.fonts), this.updateStyles();
            var s = this.syncConfigToWorker({ serialize_funcs: n });
            return this.updating--, this.view.updateBounds(), this.requestRedraw(), s;
          } }, { key: "syncConfigToWorker", value: function(e) {
            var t2 = (0 < arguments.length && void 0 !== e ? e : {}).serialize_funcs, r = void 0 === t2 || t2 ? Utils$1.serializeWithFunctions(this.config) : JSON.stringify(this.config);
            return WorkerBroker.postMessage(this._workers, "self.updateConfig", { config: r, generation: this.generation, introspection: this.introspection }, debugSettings$1);
          } }, { key: "createListeners", value: function() {
            var t2 = this;
            this.listeners = {}, this.listeners.view = { move: function() {
              return t2.trigger("move");
            } }, this.view.subscribe(this.listeners.view), this.listeners.texture = { update: function() {
              return t2.dirty = true;
            }, warning: function(e) {
              return t2.trigger("warning", Object.assign({ type: "textures" }, e));
            } }, this.textureManager.subscribe(this.listeners.texture), this.listeners.scene_loader = { error: function(e) {
              return t2.trigger("error", Object.assign({ type: "scene" }, e));
            } }, SceneLoader$1.subscribe(this.listeners.scene_loader);
          } }, { key: "destroyListeners", value: function() {
            this.unsubscribeAll(), this.view.unsubscribe(this.listeners.view), this.textureManager.unsubscribe(this.listeners.texture), SceneLoader$1.unsubscribe(this.listeners.scene_loader), this.listeners = null;
          } }, { key: "resetFeatureSelection", value: function() {
            this.selection ? this._workers && WorkerBroker.postMessage(this._workers, "self.resetFeatureSelection") : this.selection = new FeatureSelection(this.gl, this.id);
          } }, { key: "updateViewComplete", value: function() {
            (this.render_count_changed || this.generation !== this.last_complete_generation) && this.tile_manager.isReady() && (this.last_complete_generation = this.generation, this.trigger("view_complete"));
          } }, { key: "resetViewComplete", value: function() {
            this.last_complete_generation = null;
          } }, { key: "screenshot", value: function(e) {
            var t2 = (0 < arguments.length && void 0 !== e ? e : {}).background, r = void 0 === t2 ? "white" : t2;
            return this.requestRedraw(), this.media_capture.screenshot({ background: r });
          } }, { key: "pixelRatio", value: function() {
            return Utils$1.device_pixel_ratio;
          } }, { key: "startVideoCapture", value: function() {
            return this.requestRedraw(), this.media_capture.startVideoCapture();
          } }, { key: "stopVideoCapture", value: function() {
            return this.media_capture.stopVideoCapture();
          } }, { key: "_profile", value: function(e) {
            console.profile("main thread: ".concat(e)), WorkerBroker.postMessage(this._workers, "self.profile", e);
          } }, { key: "_profileEnd", value: function(e) {
            console.profileEnd("main thread: ".concat(e)), WorkerBroker.postMessage(this._workers, "self.profileEnd", e);
          } }, { key: "getCameraMatrix", value: function() {
            return this.view.lookAtManipulator.getCameraMatrix();
          } }, { key: "animated", get: function() {
            var t2 = this;
            return void 0 !== this.config.scene.animated ? this.config.scene.animated : this.tile_manager.getActiveStyles().some(function(e) {
              return t2.styles[e] && t2.styles[e].animated;
            });
          } }], [{ key: "create", value: function(e, t2) {
            return new l(e, 1 < arguments.length && void 0 !== t2 ? t2 : {});
          } }]), l;
        }();
        Scene.id = 0, Scene.generation = 0;
        var RemoteTexture = function() {
          _inherits(u2, Texture);
          var l = _createSuper(u2);
          function u2(e, t2, r) {
            var i2 = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {};
            _classCallCheck(this, u2);
            var n = Math.pow(2, i2.coords.z), o = Math.abs(Math.floor(i2.coords.x / n)), a2 = Math.abs(n * o - Math.abs(i2.coords.x)), s = i2.coords;
            return i2.coords = { x: a2, y: s.y, z: s.z }, l.call(this, e, t2, r, i2);
          }
          return _createClass(u2, [{ key: "load", value: function(i2) {
            var n = this;
            if (!i2 || !i2.uid)
              return _get(_getPrototypeOf(u2.prototype), "load", this).call(this, i2);
            var o = i2.coords, a2 = new Uint8Array([0, 0, 0, 0]);
            return this.loading = new Promise(function(e, t2) {
              var r = H.map.DataModel.invoke(i2.uid, "requestTileAsPromise", [o.x, o.y, o.z]) || null;
              r ? r.then(function(e2) {
                var t3 = e2.data;
                n.loaded = true, t3 && !(t3 instanceof ArrayBuffer) && ("IMG" === t3.tagName.toUpperCase() || "CANVAS" === t3.tagName.toUpperCase()) ? n.setElement(t3, i2) : n.setData(1, 1, a2, { filtering: "nearest" });
              }, function() {
                n.loaded = false;
              }).then(e, function(e2) {
                return t2(e2);
              }) : t2(new Error("Unable to invoke on target " + i2.uid));
            }), this.loading;
          } }]), u2;
        }();
        TextureManager.register(RemoteTexture, function(e) {
          return e && e.uid;
        }), self.H = self.H || {}, self.H.gl = { DataSource, Geo: Geo$1, MathUtils: MathUtils$1, Scene, Task, Tile, WorkerBroker, log, SceneLoader: SceneLoader$1, yaml: jsYaml$1 };
      }();
    };
    f();
  }();
  this.H = this.H || {}, this.H.venues = function(e) {
    "use strict";
    function D2(e2, t3) {
      var n2, r2, t3 = (t3 = void 0 === t3 ? {} : t3).insertAt;
      e2 && "undefined" != typeof document && (n2 = document.head || document.getElementsByTagName("head")[0], (r2 = document.createElement("style")).type = "text/css", "top" === t3 && n2.firstChild ? n2.insertBefore(r2, n2.firstChild) : n2.appendChild(r2), r2.styleSheet ? r2.styleSheet.cssText = e2 : r2.appendChild(document.createTextNode(e2)));
    }
    function j(t3, e2) {
      var n2, r2 = Object.keys(t3);
      return Object.getOwnPropertySymbols && (n2 = Object.getOwnPropertySymbols(t3), e2 && (n2 = n2.filter(function(e3) {
        return Object.getOwnPropertyDescriptor(t3, e3).enumerable;
      })), r2.push.apply(r2, n2)), r2;
    }
    function f2(t3) {
      for (var e2 = 1; e2 < arguments.length; e2++) {
        var n2 = null != arguments[e2] ? arguments[e2] : {};
        e2 % 2 ? j(Object(n2), true).forEach(function(e3) {
          c2(t3, e3, n2[e3]);
        }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t3, Object.getOwnPropertyDescriptors(n2)) : j(Object(n2)).forEach(function(e3) {
          Object.defineProperty(t3, e3, Object.getOwnPropertyDescriptor(n2, e3));
        });
      }
      return t3;
    }
    function G() {
      G = function() {
        return a3;
      };
      var a3 = {}, e2 = Object.prototype, u3 = e2.hasOwnProperty, t3 = "function" == typeof Symbol ? Symbol : {}, r2 = t3.iterator || "@@iterator", n2 = t3.asyncIterator || "@@asyncIterator", i3 = t3.toStringTag || "@@toStringTag";
      function o2(e3, t4, n3) {
        return Object.defineProperty(e3, t4, { value: n3, enumerable: true, configurable: true, writable: true }), e3[t4];
      }
      try {
        o2({}, "");
      } catch (e3) {
        o2 = function(e4, t4, n3) {
          return e4[t4] = n3;
        };
      }
      function s2(e3, t4, n3, r3) {
        var i4, o3, a4, s3, t4 = t4 && t4.prototype instanceof h2 ? t4 : h2, t4 = Object.create(t4.prototype), r3 = new E3(r3 || []);
        return t4._invoke = (i4 = e3, o3 = n3, a4 = r3, s3 = "suspendedStart", function(e4, t5) {
          if ("executing" === s3)
            throw new Error("Generator is already running");
          if ("completed" === s3) {
            if ("throw" === e4)
              throw t5;
            return S3();
          }
          for (a4.method = e4, a4.arg = t5; ; ) {
            var n4 = a4.delegate;
            if (n4) {
              n4 = function e5(t6, n5) {
                var r4 = t6.iterator[n5.method];
                if (void 0 === r4) {
                  if (n5.delegate = null, "throw" === n5.method) {
                    if (t6.iterator.return && (n5.method = "return", n5.arg = void 0, e5(t6, n5), "throw" === n5.method))
                      return c3;
                    n5.method = "throw", n5.arg = new TypeError("The iterator does not provide a 'throw' method");
                  }
                  return c3;
                }
                r4 = l2(r4, t6.iterator, n5.arg);
                if ("throw" === r4.type)
                  return n5.method = "throw", n5.arg = r4.arg, n5.delegate = null, c3;
                r4 = r4.arg;
                return r4 ? r4.done ? (n5[t6.resultName] = r4.value, n5.next = t6.nextLoc, "return" !== n5.method && (n5.method = "next", n5.arg = void 0), n5.delegate = null, c3) : r4 : (n5.method = "throw", n5.arg = new TypeError("iterator result is not an object"), n5.delegate = null, c3);
              }(n4, a4);
              if (n4) {
                if (n4 === c3)
                  continue;
                return n4;
              }
            }
            if ("next" === a4.method)
              a4.sent = a4._sent = a4.arg;
            else if ("throw" === a4.method) {
              if ("suspendedStart" === s3)
                throw s3 = "completed", a4.arg;
              a4.dispatchException(a4.arg);
            } else
              "return" === a4.method && a4.abrupt("return", a4.arg);
            s3 = "executing";
            n4 = l2(i4, o3, a4);
            if ("normal" === n4.type) {
              if (s3 = a4.done ? "completed" : "suspendedYield", n4.arg === c3)
                continue;
              return { value: n4.arg, done: a4.done };
            }
            "throw" === n4.type && (s3 = "completed", a4.method = "throw", a4.arg = n4.arg);
          }
        }), t4;
      }
      function l2(e3, t4, n3) {
        try {
          return { type: "normal", arg: e3.call(t4, n3) };
        } catch (e4) {
          return { type: "throw", arg: e4 };
        }
      }
      a3.wrap = s2;
      var c3 = {};
      function h2() {
      }
      function d2() {
      }
      function p3() {
      }
      var t3 = {}, f3 = (o2(t3, r2, function() {
        return this;
      }), Object.getPrototypeOf), f3 = f3 && f3(f3(_2([]))), g2 = (f3 && f3 !== e2 && u3.call(f3, r2) && (t3 = f3), p3.prototype = h2.prototype = Object.create(t3));
      function v2(e3) {
        ["next", "throw", "return"].forEach(function(t4) {
          o2(e3, t4, function(e4) {
            return this._invoke(t4, e4);
          });
        });
      }
      function y2(a4, s3) {
        var t4;
        this._invoke = function(n3, r3) {
          function e3() {
            return new s3(function(e4, t5) {
              !function t6(e5, n4, r4, i4) {
                var o3, e5 = l2(a4[e5], a4, n4);
                if ("throw" !== e5.type)
                  return (n4 = (o3 = e5.arg).value) && "object" == typeof n4 && u3.call(n4, "__await") ? s3.resolve(n4.__await).then(function(e6) {
                    t6("next", e6, r4, i4);
                  }, function(e6) {
                    t6("throw", e6, r4, i4);
                  }) : s3.resolve(n4).then(function(e6) {
                    o3.value = e6, r4(o3);
                  }, function(e6) {
                    return t6("throw", e6, r4, i4);
                  });
                i4(e5.arg);
              }(n3, r3, e4, t5);
            });
          }
          return t4 = t4 ? t4.then(e3, e3) : e3();
        };
      }
      function m2(e3) {
        var t4 = { tryLoc: e3[0] };
        1 in e3 && (t4.catchLoc = e3[1]), 2 in e3 && (t4.finallyLoc = e3[2], t4.afterLoc = e3[3]), this.tryEntries.push(t4);
      }
      function I2(e3) {
        var t4 = e3.completion || {};
        t4.type = "normal", delete t4.arg, e3.completion = t4;
      }
      function E3(e3) {
        this.tryEntries = [{ tryLoc: "root" }], e3.forEach(m2, this), this.reset(true);
      }
      function _2(t4) {
        if (t4) {
          var n3, e3 = t4[r2];
          if (e3)
            return e3.call(t4);
          if ("function" == typeof t4.next)
            return t4;
          if (!isNaN(t4.length))
            return n3 = -1, (e3 = function e4() {
              for (; ++n3 < t4.length; )
                if (u3.call(t4, n3))
                  return e4.value = t4[n3], e4.done = false, e4;
              return e4.value = void 0, e4.done = true, e4;
            }).next = e3;
        }
        return { next: S3 };
      }
      function S3() {
        return { value: void 0, done: true };
      }
      return o2(g2, "constructor", d2.prototype = p3), o2(p3, "constructor", d2), d2.displayName = o2(p3, i3, "GeneratorFunction"), a3.isGeneratorFunction = function(e3) {
        e3 = "function" == typeof e3 && e3.constructor;
        return !!e3 && (e3 === d2 || "GeneratorFunction" === (e3.displayName || e3.name));
      }, a3.mark = function(e3) {
        return Object.setPrototypeOf ? Object.setPrototypeOf(e3, p3) : (e3.__proto__ = p3, o2(e3, i3, "GeneratorFunction")), e3.prototype = Object.create(g2), e3;
      }, a3.awrap = function(e3) {
        return { __await: e3 };
      }, v2(y2.prototype), o2(y2.prototype, n2, function() {
        return this;
      }), a3.AsyncIterator = y2, a3.async = function(e3, t4, n3, r3, i4) {
        void 0 === i4 && (i4 = Promise);
        var o3 = new y2(s2(e3, t4, n3, r3), i4);
        return a3.isGeneratorFunction(t4) ? o3 : o3.next().then(function(e4) {
          return e4.done ? e4.value : o3.next();
        });
      }, v2(g2), o2(g2, i3, "Generator"), o2(g2, r2, function() {
        return this;
      }), o2(g2, "toString", function() {
        return "[object Generator]";
      }), a3.keys = function(n3) {
        var e3, r3 = [];
        for (e3 in n3)
          r3.push(e3);
        return r3.reverse(), function e4() {
          for (; r3.length; ) {
            var t4 = r3.pop();
            if (t4 in n3)
              return e4.value = t4, e4.done = false, e4;
          }
          return e4.done = true, e4;
        };
      }, a3.values = _2, E3.prototype = { constructor: E3, reset: function(e3) {
        if (this.prev = 0, this.next = 0, this.sent = this._sent = void 0, this.done = false, this.delegate = null, this.method = "next", this.arg = void 0, this.tryEntries.forEach(I2), !e3)
          for (var t4 in this)
            "t" === t4.charAt(0) && u3.call(this, t4) && !isNaN(+t4.slice(1)) && (this[t4] = void 0);
      }, stop: function() {
        this.done = true;
        var e3 = this.tryEntries[0].completion;
        if ("throw" === e3.type)
          throw e3.arg;
        return this.rval;
      }, dispatchException: function(n3) {
        if (this.done)
          throw n3;
        var r3 = this;
        function e3(e4, t5) {
          return o3.type = "throw", o3.arg = n3, r3.next = e4, t5 && (r3.method = "next", r3.arg = void 0), !!t5;
        }
        for (var t4 = this.tryEntries.length - 1; 0 <= t4; --t4) {
          var i4 = this.tryEntries[t4], o3 = i4.completion;
          if ("root" === i4.tryLoc)
            return e3("end");
          if (i4.tryLoc <= this.prev) {
            var a4 = u3.call(i4, "catchLoc"), s3 = u3.call(i4, "finallyLoc");
            if (a4 && s3) {
              if (this.prev < i4.catchLoc)
                return e3(i4.catchLoc, true);
              if (this.prev < i4.finallyLoc)
                return e3(i4.finallyLoc);
            } else if (a4) {
              if (this.prev < i4.catchLoc)
                return e3(i4.catchLoc, true);
            } else {
              if (!s3)
                throw new Error("try statement without catch or finally");
              if (this.prev < i4.finallyLoc)
                return e3(i4.finallyLoc);
            }
          }
        }
      }, abrupt: function(e3, t4) {
        for (var n3 = this.tryEntries.length - 1; 0 <= n3; --n3) {
          var r3 = this.tryEntries[n3];
          if (r3.tryLoc <= this.prev && u3.call(r3, "finallyLoc") && this.prev < r3.finallyLoc) {
            var i4 = r3;
            break;
          }
        }
        var o3 = (i4 = i4 && ("break" === e3 || "continue" === e3) && i4.tryLoc <= t4 && t4 <= i4.finallyLoc ? null : i4) ? i4.completion : {};
        return o3.type = e3, o3.arg = t4, i4 ? (this.method = "next", this.next = i4.finallyLoc, c3) : this.complete(o3);
      }, complete: function(e3, t4) {
        if ("throw" === e3.type)
          throw e3.arg;
        return "break" === e3.type || "continue" === e3.type ? this.next = e3.arg : "return" === e3.type ? (this.rval = this.arg = e3.arg, this.method = "return", this.next = "end") : "normal" === e3.type && t4 && (this.next = t4), c3;
      }, finish: function(e3) {
        for (var t4 = this.tryEntries.length - 1; 0 <= t4; --t4) {
          var n3 = this.tryEntries[t4];
          if (n3.finallyLoc === e3)
            return this.complete(n3.completion, n3.afterLoc), I2(n3), c3;
        }
      }, catch: function(e3) {
        for (var t4 = this.tryEntries.length - 1; 0 <= t4; --t4) {
          var n3, r3, i4 = this.tryEntries[t4];
          if (i4.tryLoc === e3)
            return "throw" === (n3 = i4.completion).type && (r3 = n3.arg, I2(i4)), r3;
        }
        throw new Error("illegal catch attempt");
      }, delegateYield: function(e3, t4, n3) {
        return this.delegate = { iterator: _2(e3), resultName: t4, nextLoc: n3 }, "next" === this.method && (this.arg = void 0), c3;
      } }, a3;
    }
    function a2(e2) {
      return (a2 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e3) {
        return typeof e3;
      } : function(e3) {
        return e3 && "function" == typeof Symbol && e3.constructor === Symbol && e3 !== Symbol.prototype ? "symbol" : typeof e3;
      })(e2);
    }
    function R2(e2, t3, n2, r2, i3, o2, a3) {
      try {
        var s2 = e2[o2](a3), u3 = s2.value;
      } catch (e3) {
        return void n2(e3);
      }
      s2.done ? t3(u3) : Promise.resolve(u3).then(r2, i3);
    }
    function u2(e2, t3) {
      if (!(e2 instanceof t3))
        throw new TypeError("Cannot call a class as a function");
    }
    function V(e2, t3) {
      for (var n2 = 0; n2 < t3.length; n2++) {
        var r2 = t3[n2];
        r2.enumerable = r2.enumerable || false, r2.configurable = true, "value" in r2 && (r2.writable = true), Object.defineProperty(e2, r2.key, r2);
      }
    }
    function l(e2, t3, n2) {
      return t3 && V(e2.prototype, t3), n2 && V(e2, n2), Object.defineProperty(e2, "prototype", { writable: false }), e2;
    }
    function c2(e2, t3, n2) {
      return t3 in e2 ? Object.defineProperty(e2, t3, { value: n2, enumerable: true, configurable: true, writable: true }) : e2[t3] = n2, e2;
    }
    function h(e2, t3) {
      if ("function" != typeof t3 && null !== t3)
        throw new TypeError("Super expression must either be null or a function");
      e2.prototype = Object.create(t3 && t3.prototype, { constructor: { value: e2, writable: true, configurable: true } }), Object.defineProperty(e2, "prototype", { writable: false }), t3 && z2(e2, t3);
    }
    function o(e2) {
      return (o = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(e3) {
        return e3.__proto__ || Object.getPrototypeOf(e3);
      })(e2);
    }
    function z2(e2, t3) {
      return (z2 = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(e3, t4) {
        return e3.__proto__ = t4, e3;
      })(e2, t3);
    }
    function B2() {
      if ("undefined" == typeof Reflect || !Reflect.construct)
        return false;
      if (Reflect.construct.sham)
        return false;
      if ("function" == typeof Proxy)
        return true;
      try {
        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
        })), true;
      } catch (e2) {
        return false;
      }
    }
    function F2(e2, t3, n2) {
      return (F2 = B2() ? Reflect.construct.bind() : function(e3, t4, n3) {
        var r2 = [null];
        r2.push.apply(r2, t4);
        t4 = new (Function.bind.apply(e3, r2))();
        return n3 && z2(t4, n3.prototype), t4;
      }).apply(null, arguments);
    }
    function Y2(e2, t3) {
      if (null == e2)
        return {};
      var n2, r2 = function(e3, t4) {
        if (null == e3)
          return {};
        for (var n3, r3 = {}, i4 = Object.keys(e3), o3 = 0; o3 < i4.length; o3++)
          n3 = i4[o3], 0 <= t4.indexOf(n3) || (r3[n3] = e3[n3]);
        return r3;
      }(e2, t3);
      if (Object.getOwnPropertySymbols)
        for (var i3 = Object.getOwnPropertySymbols(e2), o2 = 0; o2 < i3.length; o2++)
          n2 = i3[o2], 0 <= t3.indexOf(n2) || Object.prototype.propertyIsEnumerable.call(e2, n2) && (r2[n2] = e2[n2]);
      return r2;
    }
    function Z2(e2) {
      if (void 0 === e2)
        throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
      return e2;
    }
    function d(n2) {
      var r2 = B2();
      return function() {
        var e2, t3 = o(n2), t3 = (e2 = r2 ? (e2 = o(this).constructor, Reflect.construct(t3, arguments, e2)) : t3.apply(this, arguments), this);
        if (e2 && ("object" == typeof e2 || "function" == typeof e2))
          return e2;
        if (void 0 !== e2)
          throw new TypeError("Derived constructors may only return object or undefined");
        return Z2(t3);
      };
    }
    function W2() {
      return (W2 = "undefined" != typeof Reflect && Reflect.get ? Reflect.get.bind() : function(e2, t3, n2) {
        var r2 = function(e3, t4) {
          for (; !Object.prototype.hasOwnProperty.call(e3, t4) && null !== (e3 = o(e3)); )
            ;
          return e3;
        }(e2, t3);
        if (r2)
          return r2 = Object.getOwnPropertyDescriptor(r2, t3), r2.get ? r2.get.call(arguments.length < 3 ? e2 : n2) : r2.value;
      }).apply(this, arguments);
    }
    function g(e2, t3) {
      return function(e3) {
        if (Array.isArray(e3))
          return e3;
      }(e2) || function(e3, t4) {
        var n2 = null == e3 ? null : "undefined" != typeof Symbol && e3[Symbol.iterator] || e3["@@iterator"];
        if (null != n2) {
          var r2, i3, o2 = [], a3 = true, s2 = false;
          try {
            for (n2 = n2.call(e3); !(a3 = (r2 = n2.next()).done) && (o2.push(r2.value), !t4 || o2.length !== t4); a3 = true)
              ;
          } catch (e4) {
            s2 = true, i3 = e4;
          } finally {
            try {
              a3 || null == n2.return || n2.return();
            } finally {
              if (s2)
                throw i3;
            }
          }
          return o2;
        }
      }(e2, t3) || K2(e2, t3) || function() {
        throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
      }();
    }
    function v(e2) {
      return function(e3) {
        if (Array.isArray(e3))
          return J2(e3);
      }(e2) || function(e3) {
        if ("undefined" != typeof Symbol && null != e3[Symbol.iterator] || null != e3["@@iterator"])
          return Array.from(e3);
      }(e2) || K2(e2) || function() {
        throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
      }();
    }
    function K2(e2, t3) {
      if (e2) {
        if ("string" == typeof e2)
          return J2(e2, t3);
        var n2 = Object.prototype.toString.call(e2).slice(8, -1);
        return "Map" === (n2 = "Object" === n2 && e2.constructor ? e2.constructor.name : n2) || "Set" === n2 ? Array.from(e2) : "Arguments" === n2 || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n2) ? J2(e2, t3) : void 0;
      }
    }
    function J2(e2, t3) {
      (null == t3 || t3 > e2.length) && (t3 = e2.length);
      for (var n2 = 0, r2 = new Array(t3); n2 < t3; n2++)
        r2[n2] = e2[n2];
      return r2;
    }
    D2(".H_l_right .venues-ui__drawings .trigger.button--active .arrow {\n  transform: rotate(90deg);\n}\n.H_l_right .venues-ui__drawings .drawings {\n  right: 45px;\n  left: initial;\n}");
    var X2 = function() {
      h(r2, H.map.Feature);
      var n2 = d(r2);
      function r2(e2) {
        var t3;
        return u2(this, r2), (t3 = n2.call(this)).id = e2.id, t3.model = e2, t3;
      }
      return l(r2, [{ key: "getData", value: function() {
        return this.model;
      } }, { key: "getAddress", value: function() {
        return this.model.getInternalAddress();
      } }, { key: "getCenter", value: function() {
        var e2 = g(this.model.getCenter(), 2), t3 = e2[0], e2 = e2[1];
        return new H.geo.Point(e2, t3);
      } }, { key: "getId", value: function() {
        return this.model.getId();
      } }, { key: "getIdentifier", value: function() {
        return this.model.getIdentifier();
      } }, { key: "getName", value: function() {
        return this.model.getDisplayName();
      } }, { key: "toGeoJSON", value: function() {
        return this.model.toJSON();
      } }, { key: "getLevel", value: function() {
        return this.getParentEventTarget();
      } }, { key: "getVenue", value: function() {
        return this.getLevel().getDrawing().getParentEventTarget();
      } }]), r2;
    }(), Q = function() {
      h(r2, H.map.Feature);
      var n2 = d(r2);
      function r2(e2) {
        var t3;
        return u2(this, r2), (t3 = n2.call(this)).id = e2.id, t3.model = e2, t3;
      }
      return l(r2, [{ key: "getData", value: function() {
        return this.model;
      } }, { key: "getBoundingBox", value: function() {
        return F2(H.geo.Rect, v(this.model.getBoundingBox()));
      } }, { key: "getCenter", value: function() {
        var e2 = g(this.model.getCenter(), 2), t3 = e2[0], e2 = e2[1];
        return new H.geo.Point(e2, t3);
      } }, { key: "getId", value: function() {
        return this.model.getId();
      } }, { key: "getIdentifier", value: function() {
        return this.model.getIdentifier();
      } }, { key: "getName", value: function() {
        return this.model.getDisplayName();
      } }, { key: "getLevel", value: function(t3) {
        return this.getLevels().find(function(e2) {
          return e2.getIdentifier() === t3;
        });
      } }, { key: "getLevels", value: function() {
        var t3 = this.getData().getLevels().map(function(e2) {
          return e2.getIdentifier();
        });
        return this.getVenue().getLevels().filter(function(e2) {
          return -1 !== t3.indexOf(e2.id);
        });
      } }, { key: "getMainLevel", value: function() {
        return this.getLevel(this.model.getMainLevel().getIdentifier());
      } }, { key: "getVenue", value: function() {
        return this.getParentEventTarget();
      } }]), r2;
    }(), q = function() {
      h(r2, H.map.Feature);
      var n2 = d(r2);
      function r2(e2) {
        var t3;
        return u2(this, r2), (t3 = n2.call(this)).id = e2.id, t3.model = e2, t3;
      }
      return l(r2, [{ key: "getGeometry", value: function(t3) {
        return this.getGeometries().find(function(e2) {
          return e2.getIdentifier() === t3;
        });
      } }, { key: "getGeometries", value: function() {
        var t3 = this.getData().getGeometries().map(function(e2) {
          return e2.getIdentifier();
        });
        return this.getDrawing().getVenue().getGeometries().filter(function(e2) {
          return -1 !== t3.indexOf(e2.id);
        });
      } }, { key: "getData", value: function() {
        return this.model;
      } }, { key: "getId", value: function() {
        return this.model.getId();
      } }, { key: "getIdentifier", value: function() {
        return this.model.getIdentifier();
      } }, { key: "getName", value: function() {
        return this.model.getDisplayName();
      } }, { key: "getShortName", value: function() {
        return this.model.getShortName();
      } }, { key: "getZIndex", value: function() {
        return this.model.getZIndex();
      } }, { key: "isMain", value: function() {
        return this.model.isMain();
      } }, { key: "getDrawing", value: function() {
        return this.getParentEventTarget();
      } }, { key: "getVenue", value: function() {
        return this.getDrawing().getParentEventTarget();
      } }]), r2;
    }();
    function $(e2, t3, n2, r2) {
      for (var i3, o2 = r2, a3 = n2 - t3 >> 1, s2 = n2 - t3, u3 = e2[t3], l2 = e2[t3 + 1], c3 = e2[n2], h2 = e2[n2 + 1], d2 = t3 + 3; d2 < n2; d2 += 3) {
        var p3 = function(e3, t4, n3, r3, i4, o3) {
          var a4 = i4 - n3, s3 = o3 - r3;
          {
            var u4;
            0 === a4 && 0 === s3 || (1 < (u4 = ((e3 - n3) * a4 + (t4 - r3) * s3) / (a4 * a4 + s3 * s3)) ? (n3 = i4, r3 = o3) : 0 < u4 && (n3 += a4 * u4, r3 += s3 * u4));
          }
          return (a4 = e3 - n3) * a4 + (s3 = t4 - r3) * s3;
        }(e2[d2], e2[d2 + 1], u3, l2, c3, h2);
        o2 < p3 ? (i3 = d2, o2 = p3) : p3 === o2 && (p3 = Math.abs(d2 - a3)) < s2 && (i3 = d2, s2 = p3);
      }
      r2 < o2 && (3 < i3 - t3 && $(e2, t3, i3, r2), e2[i3 + 2] = o2, 3 < n2 - i3 && $(e2, i3, n2, r2));
    }
    function b2(e2, t3, n2, r2) {
      var e2 = { id: void 0 === e2 ? null : e2, type: t3, geometry: n2, tags: r2, minX: 1 / 0, minY: 1 / 0, maxX: -1 / 0, maxY: -1 / 0 }, i3 = e2, o2 = i3.geometry, t3 = i3.type;
      if ("Point" === t3 || "MultiPoint" === t3 || "LineString" === t3)
        ee2(i3, o2);
      else if ("Polygon" === t3 || "MultiLineString" === t3)
        for (var a3 = 0; a3 < o2.length; a3++)
          ee2(i3, o2[a3]);
      else if ("MultiPolygon" === t3)
        for (a3 = 0; a3 < o2.length; a3++)
          for (var s2 = 0; s2 < o2[a3].length; s2++)
            ee2(i3, o2[a3][s2]);
      return e2;
    }
    function ee2(e2, t3) {
      for (var n2 = 0; n2 < t3.length; n2 += 3)
        e2.minX = Math.min(e2.minX, t3[n2]), e2.minY = Math.min(e2.minY, t3[n2 + 1]), e2.maxX = Math.max(e2.maxX, t3[n2]), e2.maxY = Math.max(e2.maxY, t3[n2 + 1]);
    }
    function p2(e2, t3, n2, r2) {
      if (t3.geometry) {
        var i3 = t3.geometry.coordinates, o2 = t3.geometry.type, a3 = Math.pow(n2.tolerance / ((1 << n2.maxZoom) * n2.extent), 2), s2 = [], u3 = t3.id;
        if (n2.promoteId ? u3 = t3.properties[n2.promoteId] : n2.generateId && (u3 = r2 || 0), "Point" === o2)
          te2(i3, s2);
        else if ("MultiPoint" === o2)
          for (var l2 = 0; l2 < i3.length; l2++)
            te2(i3[l2], s2);
        else if ("LineString" === o2)
          ne2(i3, s2, a3, false);
        else if ("MultiLineString" === o2) {
          if (n2.lineMetrics) {
            for (l2 = 0; l2 < i3.length; l2++)
              ne2(i3[l2], s2 = [], a3, false), e2.push(b2(u3, "LineString", s2, t3.properties));
            return;
          }
          re2(i3, s2, a3, false);
        } else if ("Polygon" === o2)
          re2(i3, s2, a3, true);
        else {
          if ("MultiPolygon" !== o2) {
            if ("GeometryCollection" !== o2)
              throw new Error("Input data is not a valid GeoJSON object.");
            for (l2 = 0; l2 < t3.geometry.geometries.length; l2++)
              p2(e2, { id: u3, geometry: t3.geometry.geometries[l2], properties: t3.properties }, n2, r2);
            return;
          }
          for (l2 = 0; l2 < i3.length; l2++) {
            var c3 = [];
            re2(i3[l2], c3, a3, true), s2.push(c3);
          }
        }
        e2.push(b2(u3, o2, s2, t3.properties));
      }
    }
    function te2(e2, t3) {
      t3.push(ie2(e2[0])), t3.push(oe2(e2[1])), t3.push(0);
    }
    function ne2(e2, t3, n2, r2) {
      for (var i3, o2, a3 = 0, s2 = 0; s2 < e2.length; s2++) {
        var u3 = ie2(e2[s2][0]), l2 = oe2(e2[s2][1]);
        t3.push(u3), t3.push(l2), t3.push(0), 0 < s2 && (a3 += r2 ? (i3 * l2 - u3 * o2) / 2 : Math.sqrt(Math.pow(u3 - i3, 2) + Math.pow(l2 - o2, 2))), i3 = u3, o2 = l2;
      }
      var c3 = t3.length - 3;
      t3[2] = 1, $(t3, 0, c3, n2), t3[2 + c3] = 1, t3.size = Math.abs(a3), t3.start = 0, t3.end = t3.size;
    }
    function re2(e2, t3, n2, r2) {
      for (var i3 = 0; i3 < e2.length; i3++) {
        var o2 = [];
        ne2(e2[i3], o2, n2, r2), t3.push(o2);
      }
    }
    function ie2(e2) {
      return e2 / 360 + 0.5;
    }
    function oe2(e2) {
      e2 = Math.sin(e2 * Math.PI / 180), e2 = 0.5 - 0.25 * Math.log((1 + e2) / (1 - e2)) / Math.PI;
      return e2 < 0 ? 0 : 1 < e2 ? 1 : e2;
    }
    function S2(e2, t3, n2, r2, i3, o2, a3, s2) {
      if (r2 /= t3, (n2 /= t3) <= o2 && a3 < r2)
        return e2;
      if (a3 < n2 || r2 <= o2)
        return null;
      for (var u3 = [], l2 = 0; l2 < e2.length; l2++) {
        var c3 = e2[l2], h2 = c3.geometry, d2 = c3.type, p3 = 0 === i3 ? c3.minX : c3.minY, f3 = 0 === i3 ? c3.maxX : c3.maxY;
        if (n2 <= p3 && f3 < r2)
          u3.push(c3);
        else if (!(f3 < n2 || r2 <= p3)) {
          var g2 = [];
          if ("Point" === d2 || "MultiPoint" === d2) {
            S3 = _2 = E3 = I2 = m2 = y2 = v2 = void 0;
            for (var v2 = h2, y2 = g2, m2 = n2, I2 = r2, E3 = i3, _2 = 0; _2 < v2.length; _2 += 3) {
              var S3 = v2[_2 + E3];
              m2 <= S3 && S3 <= I2 && (y2.push(v2[_2]), y2.push(v2[_2 + 1]), y2.push(v2[_2 + 2]));
            }
          } else if ("LineString" === d2)
            ae2(h2, g2, n2, r2, i3, false, s2.lineMetrics);
          else if ("MultiLineString" === d2)
            ue2(h2, g2, n2, r2, i3, false);
          else if ("Polygon" === d2)
            ue2(h2, g2, n2, r2, i3, true);
          else if ("MultiPolygon" === d2)
            for (var M3 = 0; M3 < h2.length; M3++) {
              var L3 = [];
              ue2(h2[M3], L3, n2, r2, i3, true), L3.length && g2.push(L3);
            }
          if (g2.length)
            if (s2.lineMetrics && "LineString" === d2)
              for (M3 = 0; M3 < g2.length; M3++)
                u3.push(b2(c3.id, d2, g2[M3], c3.tags));
            else
              "LineString" !== d2 && "MultiLineString" !== d2 || (1 === g2.length ? (d2 = "LineString", g2 = g2[0]) : d2 = "MultiLineString"), "Point" !== d2 && "MultiPoint" !== d2 || (d2 = 3 === g2.length ? "Point" : "MultiPoint"), u3.push(b2(c3.id, d2, g2, c3.tags));
        }
      }
      return u3.length ? u3 : null;
    }
    function ae2(e2, t3, n2, r2, i3, o2, a3) {
      for (var s2, u3, l2 = se2(e2), c3 = 0 === i3 ? ce2 : he2, h2 = e2.start, d2 = 0; d2 < e2.length - 3; d2 += 3) {
        var p3 = e2[d2], f3 = e2[d2 + 1], g2 = e2[d2 + 2], v2 = e2[d2 + 3], y2 = e2[d2 + 4], m2 = 0 === i3 ? p3 : f3, I2 = 0 === i3 ? v2 : y2, E3 = false;
        a3 && (s2 = Math.sqrt(Math.pow(p3 - v2, 2) + Math.pow(f3 - y2, 2))), m2 < n2 ? n2 < I2 && (u3 = c3(l2, p3, f3, v2, y2, n2), a3 && (l2.start = h2 + s2 * u3)) : r2 < m2 ? I2 < r2 && (u3 = c3(l2, p3, f3, v2, y2, r2), a3 && (l2.start = h2 + s2 * u3)) : le2(l2, p3, f3, g2), I2 < n2 && n2 <= m2 && (u3 = c3(l2, p3, f3, v2, y2, n2), E3 = true), r2 < I2 && m2 <= r2 && (u3 = c3(l2, p3, f3, v2, y2, r2), E3 = true), !o2 && E3 && (a3 && (l2.end = h2 + s2 * u3), t3.push(l2), l2 = se2(e2)), a3 && (h2 += s2);
      }
      var _2 = e2.length - 3, p3 = e2[_2], f3 = e2[1 + _2], g2 = e2[2 + _2];
      n2 <= (m2 = 0 === i3 ? p3 : f3) && m2 <= r2 && le2(l2, p3, f3, g2), _2 = l2.length - 3, o2 && 3 <= _2 && (l2[_2] !== l2[0] || l2[1 + _2] !== l2[1]) && le2(l2, l2[0], l2[1], l2[2]), l2.length && t3.push(l2);
    }
    function se2(e2) {
      var t3 = [];
      return t3.size = e2.size, t3.start = e2.start, t3.end = e2.end, t3;
    }
    function ue2(e2, t3, n2, r2, i3, o2) {
      for (var a3 = 0; a3 < e2.length; a3++)
        ae2(e2[a3], t3, n2, r2, i3, o2, false);
    }
    function le2(e2, t3, n2, r2) {
      e2.push(t3), e2.push(n2), e2.push(r2);
    }
    function ce2(e2, t3, n2, r2, i3, o2) {
      r2 = (o2 - t3) / (r2 - t3);
      return e2.push(o2), e2.push(n2 + (i3 - n2) * r2), e2.push(1), r2;
    }
    function he2(e2, t3, n2, r2, i3, o2) {
      i3 = (o2 - n2) / (i3 - n2);
      return e2.push(t3 + (r2 - t3) * i3), e2.push(o2), e2.push(1), i3;
    }
    function de2(e2, t3) {
      for (var n2 = [], r2 = 0; r2 < e2.length; r2++) {
        var i3 = e2[r2], o2 = i3.type;
        if ("Point" === o2 || "MultiPoint" === o2 || "LineString" === o2)
          a3 = pe2(i3.geometry, t3);
        else if ("MultiLineString" === o2 || "Polygon" === o2)
          for (var a3 = [], s2 = 0; s2 < i3.geometry.length; s2++)
            a3.push(pe2(i3.geometry[s2], t3));
        else if ("MultiPolygon" === o2)
          for (a3 = [], s2 = 0; s2 < i3.geometry.length; s2++) {
            for (var u3 = [], l2 = 0; l2 < i3.geometry[s2].length; l2++)
              u3.push(pe2(i3.geometry[s2][l2], t3));
            a3.push(u3);
          }
        n2.push(b2(i3.id, o2, a3, i3.tags));
      }
      return n2;
    }
    function pe2(e2, t3) {
      var n2 = [];
      n2.size = e2.size, void 0 !== e2.start && (n2.start = e2.start, n2.end = e2.end);
      for (var r2 = 0; r2 < e2.length; r2 += 3)
        n2.push(e2[r2] + t3, e2[r2 + 1], e2[r2 + 2]);
      return n2;
    }
    function fe2(e2, t3) {
      if (!e2.transformed) {
        for (var n2, r2 = 1 << e2.z, i3 = e2.x, o2 = e2.y, a3 = 0; a3 < e2.features.length; a3++) {
          var s2 = e2.features[a3], u3 = s2.geometry, l2 = s2.type;
          if (s2.geometry = [], 1 === l2)
            for (n2 = 0; n2 < u3.length; n2 += 2)
              s2.geometry.push(ge2(u3[n2], u3[n2 + 1], t3, r2, i3, o2));
          else
            for (n2 = 0; n2 < u3.length; n2++) {
              for (var c3 = [], h2 = 0; h2 < u3[n2].length; h2 += 2)
                c3.push(ge2(u3[n2][h2], u3[n2][h2 + 1], t3, r2, i3, o2));
              s2.geometry.push(c3);
            }
        }
        e2.transformed = true;
      }
      return e2;
    }
    function ge2(e2, t3, n2, r2, i3, o2) {
      return [Math.round(n2 * (e2 * r2 - i3)), Math.round(n2 * (t3 * r2 - o2))];
    }
    function ve2(e2, t3, n2, r2, i3) {
      for (var o2 = t3 === i3.maxZoom ? 0 : i3.tolerance / ((1 << t3) * i3.extent), a3 = { features: [], numPoints: 0, numSimplified: 0, numFeatures: 0, source: null, x: n2, y: r2, z: t3, transformed: false, minX: 2, minY: 1, maxX: -1, maxY: 0 }, s2 = 0; s2 < e2.length; s2++) {
        a3.numFeatures++, h2 = I2 = m2 = y2 = v2 = g2 = f3 = p3 = d2 = h2 = c3 = l2 = u3 = void 0;
        var u3 = a3, l2 = e2[s2], c3 = o2, h2 = i3, d2 = l2.geometry, p3 = l2.type, f3 = [];
        if ("Point" === p3 || "MultiPoint" === p3)
          for (var g2 = 0; g2 < d2.length; g2 += 3)
            f3.push(d2[g2]), f3.push(d2[g2 + 1]), u3.numPoints++, u3.numSimplified++;
        else if ("LineString" === p3)
          ye2(f3, d2, u3, c3, false, false);
        else if ("MultiLineString" === p3 || "Polygon" === p3)
          for (g2 = 0; g2 < d2.length; g2++)
            ye2(f3, d2[g2], u3, c3, "Polygon" === p3, 0 === g2);
        else if ("MultiPolygon" === p3)
          for (var v2 = 0; v2 < d2.length; v2++) {
            var y2 = d2[v2];
            for (g2 = 0; g2 < y2.length; g2++)
              ye2(f3, y2[g2], u3, c3, true, 0 === g2);
          }
        if (f3.length) {
          var m2 = l2.tags || null;
          if ("LineString" === p3 && h2.lineMetrics) {
            for (var I2 in m2 = {}, l2.tags)
              m2[I2] = l2.tags[I2];
            m2.mapbox_clip_start = d2.start / d2.size, m2.mapbox_clip_end = d2.end / d2.size;
          }
          h2 = { geometry: f3, type: "Polygon" === p3 || "MultiPolygon" === p3 ? 3 : "LineString" === p3 || "MultiLineString" === p3 ? 2 : 1, tags: m2 };
          null !== l2.id && (h2.id = l2.id), u3.features.push(h2);
        }
        var h2 = e2[s2].minX, E3 = e2[s2].minY, _2 = e2[s2].maxX, S3 = e2[s2].maxY;
        h2 < a3.minX && (a3.minX = h2), E3 < a3.minY && (a3.minY = E3), _2 > a3.maxX && (a3.maxX = _2), S3 > a3.maxY && (a3.maxY = S3);
      }
      return a3;
    }
    function ye2(e2, t3, n2, r2, i3, o2) {
      var a3 = r2 * r2;
      if (0 < r2 && t3.size < (i3 ? a3 : r2))
        n2.numPoints += t3.length / 3;
      else {
        for (var s2 = [], u3 = 0; u3 < t3.length; u3 += 3)
          (0 === r2 || t3[u3 + 2] > a3) && (n2.numSimplified++, s2.push(t3[u3]), s2.push(t3[u3 + 1])), n2.numPoints++;
        if (i3) {
          for (var l2 = s2, i3 = o2, c3 = 0, h2 = 0, d2 = l2.length, p3 = d2 - 2; h2 < d2; p3 = h2, h2 += 2)
            c3 += (l2[h2] - l2[p3]) * (l2[h2 + 1] + l2[p3 + 1]);
          if (0 < c3 === i3)
            for (h2 = 0, d2 = l2.length; h2 < d2 / 2; h2 += 2) {
              var f3 = l2[h2], g2 = l2[h2 + 1];
              l2[h2] = l2[d2 - 2 - h2], l2[h2 + 1] = l2[d2 - 1 - h2], l2[d2 - 2 - h2] = f3, l2[d2 - 1 - h2] = g2;
            }
        }
        e2.push(s2);
      }
    }
    function r(e2, t3) {
      var n2 = (t3 = this.options = function(e3, t4) {
        for (var n3 in t4)
          e3[n3] = t4[n3];
        return e3;
      }(Object.create(this.options), t3)).debug;
      if (n2 && console.time("preprocess data"), t3.maxZoom < 0 || 24 < t3.maxZoom)
        throw new Error("maxZoom should be in the 0-24 range");
      if (t3.promoteId && t3.generateId)
        throw new Error("promoteId and generateId cannot be used together.");
      var r2, i3, o2, a3, s2, e2 = function(e3, t4) {
        var n3 = [];
        if ("FeatureCollection" === e3.type)
          for (var r3 = 0; r3 < e3.features.length; r3++)
            p2(n3, e3.features[r3], t4, r3);
        else
          "Feature" === e3.type ? p2(n3, e3, t4) : p2(n3, { geometry: e3 }, t4);
        return n3;
      }(e2, t3);
      this.tiles = {}, this.tileCoords = [], n2 && (console.timeEnd("preprocess data"), console.log("index: maxZoom: %d, maxPoints: %d", t3.indexMaxZoom, t3.indexMaxPoints), console.time("generate tiles"), this.stats = {}, this.total = 0), r2 = e2, i3 = (t3 = t3).buffer / t3.extent, a3 = S2(o2 = r2, 1, -1 - i3, i3, 0, -1, 2, t3), s2 = S2(r2, 1, 1 - i3, 2 + i3, 0, -1, 2, t3), (a3 || s2) && (o2 = S2(r2, 1, -i3, 1 + i3, 0, -1, 2, t3) || [], a3 && (o2 = de2(a3, 1).concat(o2)), s2 && (o2 = o2.concat(de2(s2, -1)))), (e2 = o2).length && this.splitTile(e2, 0, 0, 0), n2 && (e2.length && console.log("features: %d, points: %d", this.tiles[0].numFeatures, this.tiles[0].numPoints), console.timeEnd("generate tiles"), console.log("tiles generated:", this.total, JSON.stringify(this.stats)));
    }
    function me2(e2, t3, n2) {
      return 32 * ((1 << e2) * n2 + t3) + e2;
    }
    r.prototype.options = { maxZoom: 14, indexMaxZoom: 5, indexMaxPoints: 1e5, tolerance: 3, extent: 4096, buffer: 64, lineMetrics: false, promoteId: null, generateId: false, debug: 0 }, r.prototype.splitTile = function(e2, t3, n2, r2, i3, o2, a3) {
      for (var s2 = [e2, t3, n2, r2], u3 = this.options, l2 = u3.debug; s2.length; ) {
        r2 = s2.pop(), n2 = s2.pop(), t3 = s2.pop(), e2 = s2.pop();
        var c3, h2, d2, p3, f3, g2, v2, y2, m2, I2 = 1 << t3, E3 = me2(t3, n2, r2), _2 = this.tiles[E3];
        if (_2 || (1 < l2 && console.time("creation"), _2 = this.tiles[E3] = ve2(e2, t3, n2, r2, u3), this.tileCoords.push({ z: t3, x: n2, y: r2 }), l2 && (1 < l2 && (console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)", t3, n2, r2, _2.numFeatures, _2.numPoints, _2.numSimplified), console.timeEnd("creation")), this.stats[E3 = "z" + t3] = (this.stats[E3] || 0) + 1, this.total++)), _2.source = e2, i3) {
          if (t3 === u3.maxZoom || t3 === i3)
            continue;
          var E3 = 1 << i3 - t3;
          if (n2 !== Math.floor(o2 / E3) || r2 !== Math.floor(a3 / E3))
            continue;
        } else if (t3 === u3.indexMaxZoom || _2.numPoints <= u3.indexMaxPoints)
          continue;
        _2.source = null, 0 !== e2.length && (1 < l2 && console.time("clipping"), c3 = 0.5 - (E3 = 0.5 * u3.buffer / u3.extent), d2 = 1 + E3, v2 = p3 = f3 = g2 = null, y2 = S2(e2, I2, n2 - E3, n2 + (h2 = 0.5 + E3), 0, _2.minX, _2.maxX, u3), m2 = S2(e2, I2, n2 + c3, n2 + d2, 0, _2.minX, _2.maxX, u3), e2 = null, y2 && (v2 = S2(y2, I2, r2 - E3, r2 + h2, 1, _2.minY, _2.maxY, u3), p3 = S2(y2, I2, r2 + c3, r2 + d2, 1, _2.minY, _2.maxY, u3), y2 = null), m2 && (f3 = S2(m2, I2, r2 - E3, r2 + h2, 1, _2.minY, _2.maxY, u3), g2 = S2(m2, I2, r2 + c3, r2 + d2, 1, _2.minY, _2.maxY, u3), m2 = null), 1 < l2 && console.timeEnd("clipping"), s2.push(v2 || [], t3 + 1, 2 * n2, 2 * r2), s2.push(p3 || [], t3 + 1, 2 * n2, 2 * r2 + 1), s2.push(f3 || [], t3 + 1, 2 * n2 + 1, 2 * r2), s2.push(g2 || [], t3 + 1, 2 * n2 + 1, 2 * r2 + 1));
      }
    }, r.prototype.getTile = function(e2, t3, n2) {
      var r2 = this.options, i3 = r2.extent, r2 = r2.debug;
      if (e2 < 0 || 24 < e2)
        return null;
      var o2 = 1 << e2, o2 = me2(e2, t3 = (t3 % o2 + o2) % o2, n2);
      if (this.tiles[o2])
        return fe2(this.tiles[o2], i3);
      1 < r2 && console.log("drilling down to z%d-%d-%d", e2, t3, n2);
      for (var a3, s2 = e2, u3 = t3, l2 = n2; !a3 && 0 < s2; )
        s2--, u3 = Math.floor(u3 / 2), l2 = Math.floor(l2 / 2), a3 = this.tiles[me2(s2, u3, l2)];
      return a3 && a3.source ? (1 < r2 && console.log("found parent tile z%d-%d-%d", s2, u3, l2), 1 < r2 && console.time("drilling down"), this.splitTile(a3.source, s2, u3, l2, e2, t3, n2), 1 < r2 && console.timeEnd("drilling down"), this.tiles[o2] ? fe2(this.tiles[o2], i3) : null) : null;
    };
    function Ie2(e2) {
      var t3 = [], n2 = e2 && e2.features;
      if (n2)
        for (var r2 = 0, i3 = n2.length; r2 < i3; r2 += 1) {
          var o2 = n2[r2], a3 = o2.type, s2 = void 0, u3 = false;
          switch (a3) {
            case Oe2:
              s2 = { type: y.MULTI_POINT, coordinates: o2.geometry.map(function(e3) {
                return e3.slice();
              }) };
              break;
            case Ne2:
            case ke2:
              s2 = { type: y.MULTI_LINESTRING, coordinates: o2.geometry.map(function(e3) {
                return e3.map(function(e4) {
                  return e4.slice();
                });
              }) }, a3 === ke2 && null == (s2 = function(e3) {
                for (var t4, n3 = [], r3 = [], i4 = 0, o3 = e3.coordinates.length; i4 < o3; i4 += 1) {
                  var a4 = e3.coordinates[i4], s3 = Pe2(a4);
                  null !== s3 && (s3 === (t4 = t4 || s3) && r3.length && (n3.push(r3), r3 = []), r3.push(a4));
                }
                return 0 < r3.length && n3.push(r3), 1 === n3.length ? (e3.type = y.POLYGON, e3.coordinates = n3[0]) : 1 < n3.length ? (e3.type = y.MULTI_POLYGON, e3.coordinates = n3) : e3 = null, e3;
              }(s2)) && (u3 = true);
              break;
            default:
              u3 = true;
          }
          u3 || t3.push({ geometry: s2, id: o2.id, properties: o2.tags, type: "Feature" });
        }
      return { type: "FeatureCollection", features: t3 };
    }
    function Ee2(e2, t3, n2, r2, i3) {
      r2 = r2, i3 = i3, t3 = 1 << (t3 = t3), (o2 = [])[0] = ((e2 = e2)[0] / i3 + n2) / t3, o2[1] = (e2[1] / i3 + r2) / t3;
      var o2, n2 = { x: o2[0], y: o2[1] };
      return i3 = (e2 = n2).x, e2 = e2.y, i3 = 360 * (i3 - 0.5), r2 = Math.exp(Math.PI * (0.5 - e2) / 0.25) - 1, e2 = Math.exp(Math.PI * (0.5 - e2) / 0.25) + 1, [i3, 180 * Math.asin(r2 / e2) / Math.PI];
    }
    var y = { POINT: "Point", LINE_STRING: "LineString", POLYGON: "Polygon", MULTI_POINT: "MultiPoint", MULTI_LINESTRING: "MultiLineString", MULTI_POLYGON: "MultiPolygon", GEOMETRY_COLLECTION: "GeometryCollection" }, _e = { fillColor: "#e0e0e0", outlineColor: "#829DB4", outlineWidth: 1 }, Se2 = { fill: "#333333", size: 13 }, Me2 = { fillColor: "#F2F285", outlineColor: "#0088BF", outlineWidth: 1.2 }, Le2 = 16, be2 = 18, Te2 = 24, s = { FOOTPRINT: "FOOTPRINT", ICON: "ICON", TEXT: "TEXT", VECTOR: "VECTOR" }, Ae2 = Object.freeze({ v1: 1, v2: 2 }), Oe2 = 1, Ne2 = 2, ke2 = 3, we2 = "CW", xe2 = "CCW", Pe2 = function(e2) {
      e2 = function(e3) {
        for (var t3 = 0, n2 = e3.length, r2 = 0; r2 < n2 - 1; r2 += 1) {
          var i3 = e3[r2], o2 = e3[r2 + 1];
          t3 += i3[0] * o2[1] - o2[0] * i3[1];
        }
        return t3 += e3[n2 - 1][0] * e3[0][1] - e3[0][0] * e3[n2 - 1][1];
      }(e2);
      return 0 < e2 ? we2 : e2 < 0 ? xe2 : void 0;
    };
    (function(e2) {
      function i3(e3) {
        if (r2[e3])
          return r2[e3].exports;
        var t3 = r2[e3] = { i: e3, l: false, exports: {} };
        return n2[e3].call(t3.exports, t3, t3.exports, i3), t3.l = true, t3.exports;
      }
      var n2, r2;
      e2.exports = (n2 = [function(e3, t3, n3) {
        function c3(e4) {
          return (c3 = "function" == typeof Symbol && "symbol" == a2(Symbol.iterator) ? function(e5) {
            return a2(e5);
          } : function(e5) {
            return e5 && "function" == typeof Symbol && e5.constructor === Symbol && e5 !== Symbol.prototype ? "symbol" : a2(e5);
          })(e4);
        }
        var o2 = n3(1), n3 = n3(7), E3 = n3.get, x3 = (n3.deepValue, n3.isArray), n3 = function() {
          function I2(e5, t5) {
            var n5 = t5.location, n5 = void 0 === n5 ? 0 : n5, r4 = t5.distance, r4 = void 0 === r4 ? 100 : r4, i4 = t5.threshold, i4 = void 0 === i4 ? 0.6 : i4, o3 = t5.maxPatternLength, o3 = void 0 === o3 ? 32 : o3, a3 = t5.caseSensitive, a3 = void 0 !== a3 && a3, s2 = t5.tokenSeparator, s2 = void 0 === s2 ? / +/g : s2, u3 = t5.findAllMatches, u3 = void 0 !== u3 && u3, l2 = t5.minMatchCharLength, l2 = void 0 === l2 ? 1 : l2, c4 = t5.id, c4 = void 0 === c4 ? null : c4, h2 = t5.keys, h2 = void 0 === h2 ? [] : h2, d2 = t5.shouldSort, d2 = void 0 === d2 || d2, p3 = t5.getFn, p3 = void 0 === p3 ? E3 : p3, f3 = t5.sortFn, f3 = void 0 === f3 ? function(e6, t6) {
              return e6.score - t6.score;
            } : f3, g2 = t5.tokenize, g2 = void 0 !== g2 && g2, v2 = t5.matchAllTokens, v2 = void 0 !== v2 && v2, y2 = t5.includeMatches, y2 = void 0 !== y2 && y2, m2 = t5.includeScore, m2 = void 0 !== m2 && m2, t5 = t5.verbose, t5 = void 0 !== t5 && t5;
            if (!(this instanceof I2))
              throw new TypeError("Cannot call a class as a function");
            this.options = { location: n5, distance: r4, threshold: i4, maxPatternLength: o3, isCaseSensitive: a3, tokenSeparator: s2, findAllMatches: u3, minMatchCharLength: l2, id: c4, keys: h2, includeMatches: y2, includeScore: m2, shouldSort: d2, getFn: p3, sortFn: f3, verbose: t5, tokenize: g2, matchAllTokens: v2 }, this.setCollection(e5), this._processKeys(h2);
          }
          for (var e4 = I2.prototype, t4 = [{ key: "setCollection", value: function(e5) {
            return this.list = e5;
          } }, { key: "_processKeys", value: function(e5) {
            if (this._keyWeights = {}, this._keyNames = [], e5.length && "string" == typeof e5[0])
              for (var t5 = 0, n5 = e5.length; t5 < n5; t5 += 1) {
                var r4 = e5[t5];
                this._keyWeights[r4] = 1, this._keyNames.push(r4);
              }
            else {
              for (var i4 = null, o3 = null, a3 = 0, s2 = 0, u3 = e5.length; s2 < u3; s2 += 1) {
                var l2 = e5[s2];
                if (!l2.hasOwnProperty("name"))
                  throw new Error('Missing "name" property in key object');
                var c4 = l2.name;
                if (this._keyNames.push(c4), !l2.hasOwnProperty("weight"))
                  throw new Error('Missing "weight" property in key object');
                l2 = l2.weight;
                if (l2 < 0 || 1 < l2)
                  throw new Error('"weight" property in key must bein the range of [0, 1)');
                o3 = null == o3 ? l2 : Math.max(o3, l2), i4 = null == i4 ? l2 : Math.min(i4, l2), a3 += this._keyWeights[c4] = l2;
              }
              if (1 < a3)
                throw new Error("Total of weights cannot exceed 1");
            }
          } }, { key: "search", value: function(e5) {
            var t5 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : { limit: false }, e5 = (this._log('---------\nSearch pattern: "'.concat(e5, '"')), this._prepareSearchers(e5)), n5 = e5.tokenSearchers, e5 = e5.fullSearcher, n5 = this._search(n5, e5);
            return this._computeScore(n5), this.options.shouldSort && this._sort(n5), t5.limit && "number" == typeof t5.limit && (n5 = n5.slice(0, t5.limit)), this._format(n5);
          } }, { key: "_prepareSearchers", value: function() {
            var e5 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "", t5 = [];
            if (this.options.tokenize)
              for (var n5 = e5.split(this.options.tokenSeparator), r4 = 0, i4 = n5.length; r4 < i4; r4 += 1)
                t5.push(new o2(n5[r4], this.options));
            return { tokenSearchers: t5, fullSearcher: new o2(e5, this.options) };
          } }, { key: "_search", value: function() {
            var e5 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : [], t5 = 1 < arguments.length ? arguments[1] : void 0, n5 = this.list, r4 = {}, i4 = [];
            if ("string" == typeof n5[0])
              for (var o3 = 0, a3 = n5.length; o3 < a3; o3 += 1)
                this._analyze({ key: "", value: n5[o3], record: o3, index: o3 }, { resultMap: r4, results: i4, tokenSearchers: e5, fullSearcher: t5 });
            else
              for (var s2 = 0, u3 = n5.length; s2 < u3; s2 += 1)
                for (var l2 = n5[s2], c4 = 0, h2 = this._keyNames.length; c4 < h2; c4 += 1) {
                  var d2 = this._keyNames[c4];
                  this._analyze({ key: d2, value: this.options.getFn(l2, d2), record: l2, index: s2 }, { resultMap: r4, results: i4, tokenSearchers: e5, fullSearcher: t5 });
                }
            return i4;
          } }, { key: "_analyze", value: function(e5, t5) {
            var T3 = this, A3 = e5.key, n5 = e5.arrayIndex, r4 = e5.value, i4 = e5.record, e5 = e5.index, o3 = t5.tokenSearchers, O3 = void 0 === o3 ? [] : o3, N3 = t5.fullSearcher, o3 = t5.resultMap, k2 = void 0 === o3 ? {} : o3, o3 = t5.results, w2 = void 0 === o3 ? [] : o3;
            !function e6(t6, n6, r5, i5) {
              if (null != n6) {
                if ("string" == typeof n6) {
                  var o4 = false, a3 = -1, s2 = 0, u3 = (T3._log("\nKey: ".concat("" === A3 ? "--" : A3)), N3.search(n6));
                  if (T3._log('Full text: "'.concat(n6, '", score: ').concat(u3.score)), T3.options.tokenize) {
                    for (var l2 = n6.split(T3.options.tokenSeparator), c4 = l2.length, h2 = [], d2 = 0, p3 = O3.length; d2 < p3; d2 += 1) {
                      var f3 = O3[d2];
                      T3._log('\nPattern: "'.concat(f3.pattern, '"'));
                      for (var g2 = false, v2 = 0; v2 < c4; v2 += 1) {
                        var y2 = l2[v2], m2 = f3.search(y2), I3 = {};
                        m2.isMatch ? (I3[y2] = m2.score, g2 = o4 = true, h2.push(m2.score)) : (I3[y2] = 1, T3.options.matchAllTokens || h2.push(1)), T3._log('Token: "'.concat(y2, '", score: ').concat(I3[y2]));
                      }
                      g2 && (s2 += 1);
                    }
                    for (var a3 = h2[0], E4 = h2.length, _2 = 1; _2 < E4; _2 += 1)
                      a3 += h2[_2];
                    T3._log("Token score average:", a3 /= E4);
                  }
                  var S3 = u3.score, M3 = (T3._log("Score average:", S3 = -1 < a3 ? (S3 + a3) / 2 : S3), !T3.options.tokenize || !T3.options.matchAllTokens || s2 >= O3.length);
                  T3._log("\nCheck Matches: ".concat(M3)), (o4 || u3.isMatch) && M3 && (M3 = { key: A3, arrayIndex: t6, value: n6, score: S3 }, T3.options.includeMatches && (M3.matchedIndices = u3.matchedIndices), (t6 = k2[i5]) ? t6.output.push(M3) : (k2[i5] = { item: r5, output: [M3] }, w2.push(k2[i5])));
                } else if (x3(n6))
                  for (var L3 = 0, b3 = n6.length; L3 < b3; L3 += 1)
                    e6(L3, n6[L3], r5, i5);
              }
            }(void 0 === n5 ? -1 : n5, r4, i4, e5);
          } }, { key: "_computeScore", value: function(e5) {
            this._log("\n\nComputing score:\n");
            for (var t5 = this._keyWeights, n5 = !!Object.keys(t5).length, r4 = 0, i4 = e5.length; r4 < i4; r4 += 1) {
              for (var o3 = e5[r4], a3 = o3.output, s2 = a3.length, u3 = 1, l2 = 0; l2 < s2; l2 += 1) {
                var c4 = a3[l2], h2 = c4.key, d2 = n5 ? t5[h2] : 1, h2 = 0 === c4.score && t5 && 0 < t5[h2] ? Number.EPSILON : c4.score;
                u3 *= Math.pow(h2, d2);
              }
              o3.score = u3, this._log(o3);
            }
          } }, { key: "_sort", value: function(e5) {
            this._log("\n\nSorting...."), e5.sort(this.options.sortFn);
          } }, { key: "_format", value: function(e5) {
            var n5, t5 = [], r4 = (this.options.verbose && (n5 = [], this._log("\n\nOutput:\n\n", JSON.stringify(e5, function(e6, t6) {
              if ("object" === c3(t6) && null !== t6) {
                if (-1 !== n5.indexOf(t6))
                  return;
                n5.push(t6);
              }
              return t6;
            }, 2)), n5 = null), []);
            this.options.includeMatches && r4.push(function(e6, t6) {
              var n6 = e6.output;
              t6.matches = [];
              for (var r5 = 0, i5 = n6.length; r5 < i5; r5 += 1) {
                var o4, a4 = n6[r5];
                0 !== a4.matchedIndices.length && (o4 = { indices: a4.matchedIndices, value: a4.value }, a4.key && (o4.key = a4.key), a4.hasOwnProperty("arrayIndex") && -1 < a4.arrayIndex && (o4.arrayIndex = a4.arrayIndex), t6.matches.push(o4));
              }
            }), this.options.includeScore && r4.push(function(e6, t6) {
              t6.score = e6.score;
            });
            for (var i4 = 0, o3 = e5.length; i4 < o3; i4 += 1) {
              var a3 = e5[i4];
              if (this.options.id && (a3.item = this.options.getFn(a3.item, this.options.id)[0]), r4.length) {
                for (var s2 = { item: a3.item }, u3 = 0, l2 = r4.length; u3 < l2; u3 += 1)
                  r4[u3](a3, s2);
                t5.push(s2);
              } else
                t5.push(a3.item);
            }
            return t5;
          } }, { key: "_log", value: function() {
            var e5;
            this.options.verbose && (e5 = console).log.apply(e5, arguments);
          } }], n4 = 0; n4 < t4.length; n4++) {
            var r3 = t4[n4];
            r3.enumerable = r3.enumerable || false, r3.configurable = true, "value" in r3 && (r3.writable = true), Object.defineProperty(e4, r3.key, r3);
          }
          return I2;
        }();
        e3.exports = n3;
      }, function(e3, t3, n3) {
        var s2 = n3(2), u3 = n3(3), h2 = n3(6), n3 = function() {
          function c3(e5, t5) {
            var n5 = t5.location, n5 = void 0 === n5 ? 0 : n5, r4 = t5.distance, r4 = void 0 === r4 ? 100 : r4, i4 = t5.threshold, i4 = void 0 === i4 ? 0.6 : i4, o2 = t5.maxPatternLength, o2 = void 0 === o2 ? 32 : o2, a3 = t5.isCaseSensitive, a3 = void 0 !== a3 && a3, s3 = t5.tokenSeparator, s3 = void 0 === s3 ? / +/g : s3, u4 = t5.findAllMatches, u4 = void 0 !== u4 && u4, l2 = t5.minMatchCharLength, l2 = void 0 === l2 ? 1 : l2, t5 = t5.includeMatches, t5 = void 0 !== t5 && t5;
            if (!(this instanceof c3))
              throw new TypeError("Cannot call a class as a function");
            this.options = { location: n5, distance: r4, threshold: i4, maxPatternLength: o2, isCaseSensitive: a3, tokenSeparator: s3, findAllMatches: u4, includeMatches: t5, minMatchCharLength: l2 }, this.pattern = a3 ? e5 : e5.toLowerCase(), this.pattern.length <= o2 && (this.patternAlphabet = h2(this.pattern));
          }
          for (var e4 = c3.prototype, t4 = [{ key: "search", value: function(e5) {
            var t5 = this.options, n5 = t5.isCaseSensitive, t5 = t5.includeMatches;
            if (n5 || (e5 = e5.toLowerCase()), this.pattern === e5)
              return n5 = { isMatch: true, score: 0 }, t5 && (n5.matchedIndices = [[0, e5.length - 1]]), n5;
            var n5 = this.options, r4 = n5.maxPatternLength, n5 = n5.tokenSeparator;
            if (this.pattern.length > r4)
              return s2(e5, this.pattern, n5);
            var r4 = this.options, n5 = r4.location, i4 = r4.distance, o2 = r4.threshold, a3 = r4.findAllMatches, r4 = r4.minMatchCharLength;
            return u3(e5, this.pattern, this.patternAlphabet, { location: n5, distance: i4, threshold: o2, findAllMatches: a3, minMatchCharLength: r4, includeMatches: t5 });
          } }], n4 = 0; n4 < t4.length; n4++) {
            var r3 = t4[n4];
            r3.enumerable = r3.enumerable || false, r3.configurable = true, "value" in r3 && (r3.writable = true), Object.defineProperty(e4, r3.key, r3);
          }
          return c3;
        }();
        e3.exports = n3;
      }, function(e3, t3) {
        var u3 = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;
        e3.exports = function(e4, t4) {
          var n3 = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : / +/g, t4 = new RegExp(t4.replace(u3, "\\$&").replace(n3, "|")), r3 = e4.match(t4), n3 = !!r3, i4 = [];
          if (n3)
            for (var o2 = 0, a3 = r3.length; o2 < a3; o2 += 1) {
              var s2 = r3[o2];
              i4.push([e4.indexOf(s2), s2.length - 1]);
            }
          return { score: n3 ? 0.5 : 1, isMatch: n3, matchedIndices: i4 };
        };
      }, function(e3, t3, n3) {
        var N3 = n3(4), k2 = n3(5);
        e3.exports = function(e4, t4, n4, r3) {
          for (var i4 = r3.location, o2 = r3.distance, a3 = void 0 === o2 ? 100 : o2, o2 = r3.threshold, s2 = r3.findAllMatches, u3 = void 0 !== s2 && s2, s2 = r3.minMatchCharLength, s2 = void 0 === s2 ? 1 : s2, r3 = r3.includeMatches, r3 = void 0 !== r3 && r3, l2 = void 0 === i4 ? 0 : i4, c3 = e4.length, h2 = void 0 === o2 ? 0.6 : o2, d2 = e4.indexOf(t4, l2), p3 = t4.length, f3 = [], g2 = 0; g2 < c3; g2 += 1)
            f3[g2] = 0;
          -1 !== d2 && (i4 = N3(t4, { errors: 0, currentLocation: d2, expectedLocation: l2, distance: a3 }), h2 = Math.min(i4, h2), -1 !== (d2 = e4.lastIndexOf(t4, l2 + p3)) && (o2 = N3(t4, { errors: 0, currentLocation: d2, expectedLocation: l2, distance: a3 }), h2 = Math.min(o2, h2)));
          for (var d2 = -1, v2 = [], y2 = 1, m2 = p3 + c3, I2 = 1 << (p3 <= 31 ? p3 - 1 : 30), E3 = 0; E3 < p3; E3 += 1) {
            for (var _2 = 0, S3 = m2; _2 < S3; )
              N3(t4, { errors: E3, currentLocation: l2 + S3, expectedLocation: l2, distance: a3 }) <= h2 ? _2 = S3 : m2 = S3, S3 = Math.floor((m2 - _2) / 2 + _2);
            var m2 = S3, M3 = Math.max(1, l2 - S3 + 1), L3 = u3 ? c3 : Math.min(l2 + S3, c3) + p3, b3 = Array(L3 + 2);
            b3[L3 + 1] = (1 << E3) - 1;
            for (var T3 = L3; M3 <= T3; --T3) {
              var A3 = T3 - 1, O3 = n4[e4.charAt(A3)];
              if (O3 && (f3[A3] = 1), b3[T3] = (b3[T3 + 1] << 1 | 1) & O3, 0 !== E3 && (b3[T3] |= (v2[T3 + 1] | v2[T3]) << 1 | 1 | v2[T3 + 1]), b3[T3] & I2 && (y2 = N3(t4, { errors: E3, currentLocation: A3, expectedLocation: l2, distance: a3 })) <= h2) {
                if (h2 = y2, (d2 = A3) <= l2)
                  break;
                M3 = Math.max(1, 2 * l2 - d2);
              }
            }
            if (N3(t4, { errors: E3 + 1, currentLocation: l2, expectedLocation: l2, distance: a3 }) > h2)
              break;
            v2 = b3;
          }
          i4 = { isMatch: 0 <= d2, score: 0 === y2 ? 1e-3 : y2 };
          return r3 && (i4.matchedIndices = k2(f3, s2)), i4;
        };
      }, function(e3, t3) {
        e3.exports = function(e4, t4) {
          var n3 = t4.errors, r3 = t4.currentLocation, i4 = t4.expectedLocation, t4 = t4.distance, t4 = void 0 === t4 ? 100 : t4, n3 = (void 0 === n3 ? 0 : n3) / e4.length, e4 = Math.abs((void 0 === i4 ? 0 : i4) - (void 0 === r3 ? 0 : r3));
          return t4 ? n3 + e4 / t4 : e4 ? 1 : n3;
        };
      }, function(e3, t3) {
        e3.exports = function() {
          for (var e4 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : [], t4 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 1, n3 = [], r3 = -1, i4 = 0, o2 = e4.length; i4 < o2; i4 += 1) {
            var a3 = e4[i4];
            a3 && -1 === r3 ? r3 = i4 : a3 || -1 === r3 || ((a3 = i4 - 1) - r3 + 1 >= t4 && n3.push([r3, a3]), r3 = -1);
          }
          return e4[i4 - 1] && t4 <= i4 - r3 && n3.push([r3, i4 - 1]), n3;
        };
      }, function(e3, t3) {
        e3.exports = function(e4) {
          for (var t4 = {}, n3 = e4.length, r3 = 0; r3 < n3; r3 += 1)
            t4[e4.charAt(r3)] = 0;
          for (var i4 = 0; i4 < n3; i4 += 1)
            t4[e4.charAt(i4)] |= 1 << n3 - i4 - 1;
          return t4;
        };
      }, function(e3, t3) {
        function c3(e4) {
          return Array.isArray ? Array.isArray(e4) : "[object Array]" === Object.prototype.toString.call(e4);
        }
        function h2(e4) {
          if (null == e4)
            return "";
          if ("string" == typeof e4)
            return e4;
          var t4 = e4 + "";
          return "0" == t4 && 1 / e4 == -1 / 0 ? "-0" : t4;
        }
        function d2(e4) {
          return "string" == typeof e4;
        }
        function p3(e4) {
          return "number" == typeof e4;
        }
        e3.exports = { get: function(e4, t4) {
          var l2 = [];
          return function e5(t5, n3) {
            if (n3) {
              var r3 = n3.indexOf("."), i4 = n3, o2 = null, a3 = (-1 !== r3 && (i4 = n3.slice(0, r3), o2 = n3.slice(r3 + 1)), t5[i4]);
              if (null != a3)
                if (o2 || !d2(a3) && !p3(a3))
                  if (c3(a3))
                    for (var s2 = 0, u3 = a3.length; s2 < u3; s2 += 1)
                      e5(a3[s2], o2);
                  else
                    o2 && e5(a3, o2);
                else
                  l2.push(h2(a3));
            } else
              l2.push(t5);
          }(e4, t4), l2;
        }, isArray: c3, isString: d2, isNum: p3, toString: h2 };
      }], r2 = {}, i3.m = n2, i3.c = r2, i3.d = function(e3, t3, n3) {
        i3.o(e3, t3) || Object.defineProperty(e3, t3, { enumerable: true, get: n3 });
      }, i3.r = function(e3) {
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e3, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e3, "__esModule", { value: true });
      }, i3.t = function(t3, e3) {
        if (1 & e3 && (t3 = i3(t3)), 8 & e3)
          return t3;
        if (4 & e3 && "object" == a2(t3) && t3 && t3.__esModule)
          return t3;
        var n3 = /* @__PURE__ */ Object.create(null);
        if (i3.r(n3), Object.defineProperty(n3, "default", { enumerable: true, value: t3 }), 2 & e3 && "string" != typeof t3)
          for (var r3 in t3)
            i3.d(n3, r3, (function(e4) {
              return t3[e4];
            }).bind(null, r3));
        return n3;
      }, i3.n = function(e3) {
        var t3 = e3 && e3.__esModule ? function() {
          return e3.default;
        } : function() {
          return e3;
        };
        return i3.d(t3, "a", t3), t3;
      }, i3.o = function(e3, t3) {
        return Object.prototype.hasOwnProperty.call(e3, t3);
      }, i3.p = "", i3(i3.s = 0));
    })(t2 = { exports: {} });
    var t2 = t2.exports, Ce2 = (n = t2) && n.__esModule && Object.prototype.hasOwnProperty.call(n, "default") ? n.default : n, De2 = (t2.Fuse, l(function e2(t3) {
      var n2 = t3.addressList, n2 = void 0 === n2 ? [] : n2, r2 = t3.geometries, r2 = void 0 === r2 ? [] : r2, i3 = t3.entity, i3 = void 0 === i3 ? null : i3, o2 = t3.name, o2 = void 0 === o2 ? "" : o2, t3 = t3.icon, t3 = void 0 === t3 ? "" : t3;
      u2(this, e2), this.addressList = n2, this.geometries = r2, this.icon = t3, this.entity = i3, this.name = o2;
    })), je2 = { keys: [{ name: "name", weight: 0.6 }, { name: "addressList", weight: 0.4 }], threshold: 0.2 }, Ge2 = function() {
      function t3(e2) {
        u2(this, t3), this.fuseSearch = null, this.levels_ = null, this.searchListEntities_ = [], this.searchListIcons_ = [], this.searchList_ = [], this.venueModel = e2, this.init();
      }
      return l(t3, [{ key: "init", value: function() {
        var e2 = this.venueModel.getGeometries().reduce(function(e3, t4) {
          return e3[t4.getId()] = t4, e3;
        }, {}), e2 = (this.initEntityList(this.venueModel.getOccupant()), this.initIconList(e2), this.levels_ = this.venueModel.getLevels().map(function(e3) {
          return { levelId: e3.getId(), levelName: e3.getName(), drawingId: e3.getDrawing().getId(), drawingName: e3.getDrawing().getName() };
        }), [].concat(v(this.searchListEntities_), v(this.searchListIcons_)));
        this.searchList_ = e2.sort(function(e3, t4) {
          return e3.name.localeCompare(t4.name);
        }), this.fuseSearch_ = new Ce2(this.searchList_, je2);
      } }, { key: "initEntityList", value: function() {
        var e2 = (0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : []).map(function(e3) {
          return e3.spaceIds ? new De2({ geometries: e3.space, addressList: e3.spaceIds || [], name: e3.properties.name || "", entity: e3 }) : null;
        }).filter(function(e3) {
          return null !== e3;
        });
        this.searchListEntities_ = e2;
      } }, { key: "initIconList", value: function() {
        this.searchListIcons_ = Object.values(0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {}).filter(function(e2) {
          return e2.isIcon();
        }).map(function(e2) {
          var t4 = e2.getIcon();
          return new De2({ geometries: [e2], icon: t4, name: e2.properties.name || "" });
        });
      } }, { key: "all", value: function() {
        return this.searchList_;
      } }, { key: "allIconTypes", value: function() {
        var e2 = this.searchListIcons_.reduce(function(e3, t4) {
          return e3[t4.name] = t4.name, e3;
        }, {});
        return Object.keys(e2);
      } }, { key: "find", value: function() {
        var e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "";
        return "" === e2 ? this.searchList_ : this.fuseSearch_.search(e2);
      } }]), t3;
    }(), m = Object.freeze({ SITE: "SITE", IMAGES: "IMAGES", THEME: "THEME" }), Re2 = "indoor.Site", Ve2 = "indoor.Structure", He2 = "indoor.Occupant", ze2 = "indoor.Space", Be2 = "indoor.SpaceGroups", Ue2 = "Address", Fe2 = "indoor.Level", Ye2 = "indoor.Entrance", Ze2 = "OCCUPANT_NAMES", We2 = "SPACE_NAME", Ke2 = "INTERNAL_ADDRESS_SHORT", Je2 = "INTERNAL_ADDRESS", Xe2 = "INTERNAL_ADDRESS_LONG", Qe2 = "SPACE_TYPE_NAME", qe2 = "SPACE_CATEGORY_NAME", $e2 = "Point", et2 = "LineString", tt2 = "Polygon", nt2 = "MultiPoint", rt2 = "MultiLineString", it2 = "MultiPolygon", I = Object.freeze({ STANDARD: "STANDARD", FLATTEN: "FLATTEN", OUTDOOR_MAIN: "OUTDOOR_MAIN", INDOOR_MAIN: "INDOOR_MAIN", NO_OUTDOORS: "NO_OUTDOORS", FLATTEN_INDOOR_MAIN: "FLATTEN_INDOOR_MAIN", FLATTEN_OUTDOOR_COPY: "FLATTEN_OUTDOOR_COPY" }), ot2 = "9999999999999", at2 = "icons", st2 = "config", ut2 = "https://interactive.data.api.platform.here.com/interactive/v1/catalogs", n = Object.freeze({ THEME: "THEME", THEME_MAP: "THEME_MAP", PRESETS: "PRESETS", SDK_STRINGS: "SDK_STRINGS", ICON_FILE: "ICON_FILE", INPUT_COLORS: "INPUT_COLORS", BASE_MAP_INFO: "BASE_MAP_INFO", CONFIG_PROFILE: "CONFIG_PROFILE", NAV_THEME: "NAV_THEME", NAV_NAME_THEME: "NAV_NAME_THEME", NAV_PROP_MAP: "NAV_PROP_MAP", NAV_STRINGS: "NAV_STRINGS", NAV_THEME_MAP: "NAV_THEME_MAP", NAV_NAME_THEME_MAP: "NAV_NAME_THEME_MAP", V4_THEME_FAMILY: "V4_THEME_FAMILY", V4_MAPTYPE_THEME: "V4_MAPTYPE_THEME", ICON: "ICON", MARKER: "MARKER", PERMISSIONS: "PERMISSIONS", NAICS_ARRAY: "NAICS_ARRAY", NAICS_MAP: "NAICS_MAP" }), n = (Object.freeze((c2(t2 = {}, n.THEME, "themeUrls"), c2(t2, n.THEME_MAP, "themeMapUrl"), c2(t2, n.PRESETS, "presetsUrl"), c2(t2, n.SDK_STRINGS, "stringsUrl"), t2)), Object.freeze((c2(t2 = {}, n.THEME, "themeOverrides"), c2(t2, n.THEME_MAP, "themeMapOverrides"), c2(t2, n.PRESETS, "presetOverrides"), c2(t2, n.SDK_STRINGS, "stringsOverrides"), c2(t2, n.INPUT_COLORS, "inputColorOverrides"), t2)), Object.freeze((c2(t2 = {}, n.THEME, ["Modern", "Standard", "Factory", "Navteq", "TheBase", "Westfield_noLabels", "Westfield", "TDM_noLabel"]), c2(t2, n.SDK_STRINGS, ["Standard", "SDK", "sdk/standard"]), c2(t2, n.V4_THEME_FAMILY, ["modern", "standard"]), c2(t2, n.V4_MAPTYPE_THEME, ["Airport Terminal", "Airport", "Casino", "College Building", "College Campus", "Convention", "General", "Hospital", "Outdoor", "Retail", "School Building", "School Campus", "Shopping Mall", "Traffic", "Train Station"]), c2(t2, n.NAV_THEME, ["Factory", "MapEditor"]), c2(t2, n.ICON, ["Multicolor", "Standard", "TheBase", "Factory"]), t2)), Object.freeze((c2(t2 = {}, n.THEME, "Modern"), c2(t2, n.THEME_MAP, "Standard"), c2(t2, n.PRESETS, "Standard"), c2(t2, n.SDK_STRINGS, "Standard"), c2(t2, n.ICON_FILE, "Standard"), c2(t2, n.INPUT_COLORS, "Standard"), c2(t2, n.BASE_MAP_INFO, "Standard"), c2(t2, n.CONFIG_PROFILE, "factory"), c2(t2, n.NAV_THEME, "Factory"), c2(t2, n.NAV_NAME_THEME, "FactoryName"), c2(t2, n.NAV_PROP_MAP, "Standard"), c2(t2, n.NAV_STRINGS, "Standard"), c2(t2, n.NAV_THEME_MAP, "Standard"), c2(t2, n.NAV_NAME_THEME_MAP, "StandardName"), c2(t2, n.V4_THEME_FAMILY, "Standard"), c2(t2, n.V4_MAPTYPE_THEME, "Standard"), c2(t2, n.ICON, "Multicolor"), c2(t2, n.MARKER, "Standard"), t2)), Object.freeze({ GEO_JSON: "GEO_JSON", V5_MAP: "V5_MAP", V5_NAV: "V5_NAV", V5_INFO: "V5_INFO", KML: "KML", SVG: "SVG", PNG: "PNG" })), E2 = (Object.freeze(c2({}, n.GEO_JSON, { COMMUNITY_MAP: "COMMUNITY_MAP", COMMUNITY_ENTITY: "COMMUNITY_ENTITY", PATH_LEVEL_GEOMETRY: "PATH_LEVEL_GEOMETRY", GEOJSON_LEVEL_GEOMETRY: "GEOJSON_LEVEL_GEOMETRY" })), Object.freeze({ ACCOUNT_API: "ACCOUNT_API", DEFAULT_COLLECTION: "DEFAULT_COLLECTION", CATALOG_LAYER: "CATALOG_LAYER" })), lt2 = Object.freeze((c2(t2 = {}, E2.ACCOUNT_API, { BASE_URL: "https://account.api.here.com/authorization/v1.1/projects/me" }), c2(t2, E2.DEFAULT_COLLECTION, { BASE_URL: "https://config.data.api.platform.here.com/config/v1/catalogs", PARAMS: { CREATED_BY: "created", COLLECTION: "-collection" } }), c2(t2, E2.CATALOG_LAYER, { BASE_URL: "https://interactive.data.api.platform.here.com/interactive/v1/catalogs", MOMDATA_LAYER: "9999999999999", ICON_LAYER: "icons", THEMERULE_LAYER: "config", COLLECTION_LAYER: "layers/9999999999999/search", PARAMS: { FEATURE_TYPE: { KEY: "p.featureType", VALUE: "indoor.Site" } } }), t2)), ct2 = Object.freeze({ isIconsEnabled: true, isMetaEnabled: true, metaOptions: {}, iconOptions: {} }), ht2 = Object.freeze({ GET: "GET", POST: "POST", PUT: "PUT", DELETE: "DELETE", PATCH: "PATCH", OPTIONS: "OPTIONS", HEAD: "HEAD" });
    function _() {
    }
    function i2() {
      i2.init.call(this);
    }
    function dt2(e2) {
      return void 0 === e2._maxListeners ? i2.defaultMaxListeners : e2._maxListeners;
    }
    function pt2(e2, t3, n2, r2) {
      var i3, o2;
      if ("function" != typeof n2)
        throw new TypeError('"listener" argument must be a function');
      return (i3 = e2._events) ? (i3.newListener && (e2.emit("newListener", t3, n2.listener || n2), i3 = e2._events), o2 = i3[t3]) : (i3 = e2._events = new _(), e2._eventsCount = 0), o2 ? ("function" == typeof o2 ? o2 = i3[t3] = r2 ? [n2, o2] : [o2, n2] : r2 ? o2.unshift(n2) : o2.push(n2), o2.warned || (r2 = dt2(e2)) && 0 < r2 && o2.length > r2 && (o2.warned = true, (r2 = new Error("Possible EventEmitter memory leak detected. " + o2.length + " " + t3 + " listeners added. Use emitter.setMaxListeners() to increase limit")).name = "MaxListenersExceededWarning", r2.emitter = e2, r2.type = t3, r2.count = o2.length, r2 = r2, "function" == typeof console.warn ? console.warn(r2) : console.log(r2))) : (o2 = i3[t3] = n2, ++e2._eventsCount), e2;
    }
    function ft2(e2, t3, n2) {
      var r2 = false;
      function i3() {
        e2.removeListener(t3, i3), r2 || (r2 = true, n2.apply(e2, arguments));
      }
      return i3.listener = n2, i3;
    }
    function gt2(e2) {
      var t3 = this._events;
      if (t3) {
        t3 = t3[e2];
        if ("function" == typeof t3)
          return 1;
        if (t3)
          return t3.length;
      }
      return 0;
    }
    function U2(e2, t3) {
      for (var n2 = new Array(t3); t3--; )
        n2[t3] = e2[t3];
      return n2;
    }
    _.prototype = /* @__PURE__ */ Object.create(null), (i2.EventEmitter = i2).usingDomains = false, i2.prototype.domain = void 0, i2.prototype._events = void 0, i2.prototype._maxListeners = void 0, i2.defaultMaxListeners = 10, i2.init = function() {
      this.domain = null, i2.usingDomains && (void 0).active, this._events && this._events !== Object.getPrototypeOf(this)._events || (this._events = new _(), this._eventsCount = 0), this._maxListeners = this._maxListeners || void 0;
    }, i2.prototype.setMaxListeners = function(e2) {
      if ("number" != typeof e2 || e2 < 0 || isNaN(e2))
        throw new TypeError('"n" argument must be a positive number');
      return this._maxListeners = e2, this;
    }, i2.prototype.getMaxListeners = function() {
      return dt2(this);
    }, i2.prototype.emit = function(e2) {
      var t3, n2, r2, i3 = "error" === e2, o2 = this._events;
      if (o2)
        i3 = i3 && null == o2.error;
      else if (!i3)
        return false;
      if (a3 = this.domain, i3) {
        var a3, i3 = arguments[1];
        if (a3)
          return (i3 = i3 || new Error('Uncaught, unspecified "error" event')).domainEmitter = this, i3.domain = a3, i3.domainThrown = false, a3.emit("error", i3), false;
        throw i3 instanceof Error ? i3 : ((a3 = new Error('Uncaught, unspecified "error" event. (' + i3 + ")")).context = i3, a3);
      }
      if (!(t3 = o2[e2]))
        return false;
      var s2, u3 = "function" == typeof t3;
      switch (s2 = arguments.length) {
        case 1:
          var l2 = t3, c3 = u3, h2 = this;
          if (c3)
            l2.call(h2);
          else
            for (var d2 = l2.length, D3 = U2(l2, d2), p3 = 0; p3 < d2; ++p3)
              D3[p3].call(h2);
          break;
        case 2:
          var c3 = t3, l2 = u3, f3 = this, g2 = arguments[1];
          if (l2)
            c3.call(f3, g2);
          else
            for (var v2 = c3.length, j2 = U2(c3, v2), y2 = 0; y2 < v2; ++y2)
              j2[y2].call(f3, g2);
          break;
        case 3:
          var m2 = t3, I2 = u3, E3 = this, _2 = arguments[1], S3 = arguments[2];
          if (I2)
            m2.call(E3, _2, S3);
          else
            for (var M3 = m2.length, G2 = U2(m2, M3), L3 = 0; L3 < M3; ++L3)
              G2[L3].call(E3, _2, S3);
          break;
        case 4:
          var I2 = t3, m2 = u3, b3 = this, T3 = arguments[1], A3 = arguments[2], O3 = arguments[3];
          if (m2)
            I2.call(b3, T3, A3, O3);
          else
            for (var N3 = I2.length, R3 = U2(I2, N3), k2 = 0; k2 < N3; ++k2)
              R3[k2].call(b3, T3, A3, O3);
          break;
        default:
          for (n2 = new Array(s2 - 1), r2 = 1; r2 < s2; r2++)
            n2[r2 - 1] = arguments[r2];
          var w2 = t3, V2 = u3, x3 = this, P3 = n2;
          if (V2)
            w2.apply(x3, P3);
          else
            for (var z3 = w2.length, B3 = U2(w2, z3), C3 = 0; C3 < z3; ++C3)
              B3[C3].apply(x3, P3);
      }
      return true;
    }, i2.prototype.on = i2.prototype.addListener = function(e2, t3) {
      return pt2(this, e2, t3, false);
    }, i2.prototype.prependListener = function(e2, t3) {
      return pt2(this, e2, t3, true);
    }, i2.prototype.once = function(e2, t3) {
      if ("function" != typeof t3)
        throw new TypeError('"listener" argument must be a function');
      return this.on(e2, ft2(this, e2, t3)), this;
    }, i2.prototype.prependOnceListener = function(e2, t3) {
      if ("function" != typeof t3)
        throw new TypeError('"listener" argument must be a function');
      return this.prependListener(e2, ft2(this, e2, t3)), this;
    }, i2.prototype.removeListener = function(e2, t3) {
      var n2, r2, i3, o2, a3;
      if ("function" != typeof t3)
        throw new TypeError('"listener" argument must be a function');
      if ((r2 = this._events) && (n2 = r2[e2])) {
        if (n2 === t3 || n2.listener && n2.listener === t3)
          0 == --this._eventsCount ? this._events = new _() : (delete r2[e2], r2.removeListener && this.emit("removeListener", e2, n2.listener || t3));
        else if ("function" != typeof n2) {
          for (i3 = -1, o2 = n2.length; 0 < o2--; )
            if (n2[o2] === t3 || n2[o2].listener && n2[o2].listener === t3) {
              a3 = n2[o2].listener, i3 = o2;
              break;
            }
          if (i3 < 0)
            return this;
          if (1 === n2.length) {
            if (n2[0] = void 0, 0 == --this._eventsCount)
              return this._events = new _(), this;
            delete r2[e2];
          } else {
            for (var s2 = n2, u3 = i3, l2 = u3 + 1, c3 = s2.length; l2 < c3; u3 += 1, l2 += 1)
              s2[u3] = s2[l2];
            s2.pop();
          }
          r2.removeListener && this.emit("removeListener", e2, a3 || t3);
        }
      }
      return this;
    }, i2.prototype.removeAllListeners = function(e2) {
      var t3, n2 = this._events;
      if (n2) {
        if (!n2.removeListener)
          return 0 === arguments.length ? (this._events = new _(), this._eventsCount = 0) : n2[e2] && (0 == --this._eventsCount ? this._events = new _() : delete n2[e2]), this;
        if (0 === arguments.length) {
          for (var r2, i3 = Object.keys(n2), o2 = 0; o2 < i3.length; ++o2)
            "removeListener" !== (r2 = i3[o2]) && this.removeAllListeners(r2);
          return this.removeAllListeners("removeListener"), this._events = new _(), this._eventsCount = 0, this;
        }
        if ("function" == typeof (t3 = n2[e2]))
          this.removeListener(e2, t3);
        else if (t3)
          for (; this.removeListener(e2, t3[t3.length - 1]), t3[0]; )
            ;
      }
      return this;
    }, i2.prototype.listeners = function(e2) {
      var t3 = this._events, e2 = t3 && (t3 = t3[e2]) ? "function" == typeof t3 ? [t3.listener || t3] : function(e3) {
        for (var t4 = new Array(e3.length), n2 = 0; n2 < t4.length; ++n2)
          t4[n2] = e3[n2].listener || e3[n2];
        return t4;
      }(t3) : [];
      return e2;
    }, i2.listenerCount = function(e2, t3) {
      return "function" == typeof e2.listenerCount ? e2.listenerCount(t3) : gt2.call(e2, t3);
    }, i2.prototype.listenerCount = gt2, i2.prototype.eventNames = function() {
      return 0 < this._eventsCount ? Reflect.ownKeys(this._events) : [];
    };
    function vt2(e2, t3, n2) {
      return n2 === Yt2.ObjectType.SEGMENT_START_MARKER ? 0 === e2 ? Ut2 : null : n2 === Yt2.ObjectType.SEGMENT_FINISH_MARKER ? 1 === t3.length || e2 === t3.length - 1 ? Ft2 : null : "indoor" === t3[e2].departure.place.type ? zt2 : Bt2;
    }
    var M2 = "venues-ui-button--active", L2 = "venues-ui-button", yt2 = "venues-ui__drawings", mt2 = "data-drawing", It2 = function() {
      function o2(e2, t3, n2) {
        var r2 = this, i3 = (u2(this, o2), this.clickHandler = n2, this.containerDiv = document.createElement("div"), this.containerDiv.setAttribute("class", yt2), document.createElement("div")), n2 = (i3.setAttribute("class", "trigger ".concat(L2)), document.createElement("div"));
        n2.setAttribute("class", "arrow arrow--down"), i3.appendChild(n2), i3.addEventListener("click", function() {
          i3.classList.toggle(M2), r2.containerButtons.classList.toggle("drawings--open");
        }), this.containerDiv.appendChild(i3), this.containerButtons = document.createElement("div"), this.containerButtons.setAttribute("class", "drawings"), this.containerDiv.appendChild(this.containerButtons), t3 && this.update(t3), e2.appendChild(this.containerDiv);
      }
      return l(o2, [{ key: "drawButton", value: function(e2, t3, n2) {
        var r2 = this, i3 = document.createElement("div"), n2 = Number(n2) === Number(e2);
        i3.setAttribute("class", n2 ? "".concat(L2, " ").concat(M2) : L2), i3.innerHTML = t3, i3.setAttribute(mt2, e2), i3.addEventListener("click", function() {
          r2.switch(e2), r2.clickHandler(e2);
        }), this.containerButtons.appendChild(i3);
      } }, { key: "switch", value: function(e2) {
        this.containerButtons.querySelectorAll(".".concat(yt2, " .").concat(M2)).forEach(function(e3) {
          return e3.setAttribute("class", L2);
        });
        e2 = this.containerButtons.querySelector("[".concat(mt2, "='").concat(e2, "']"));
        e2 && e2.setAttribute("class", "".concat(L2, " ").concat(M2));
      } }, { key: "update", value: function(n2) {
        var r2 = this, e2 = (this.containerButtons.innerHTML = "", function(e3) {
          e3 = e3.getDrawings();
          return new Map(e3.map(function(e4) {
            var t3 = e4.getDisplayName() || e4.getName();
            return [e4.getId(), t3];
          }));
        }(n2));
        0 < e2.size && e2.forEach(function(e3, t3) {
          return r2.drawButton(t3, e3, n2.getRootDrawing().getId());
        });
      } }]), o2;
    }(), Et2 = "venues-ui-button--active", T2 = "venues-ui-button", _t = "data-level", St2 = "venues-ui__levels", Mt2 = function() {
      function o2(e2, t3, n2, r2) {
        var i3 = 4 < arguments.length && void 0 !== arguments[4] ? arguments[4] : 4;
        u2(this, o2), this.clickHandler = r2, this.levelButtonCount = i3, this.currentScrollIndex = 0, this.containerUI = document.createElement("div"), this.containerUI.setAttribute("class", "".concat(St2)), this.containerButtons = document.createElement("div"), this.containerButtons.setAttribute("class", "levels"), this.containerUI.appendChild(this.containerButtons), t3 && this.update(t3, n2), e2.appendChild(this.containerUI);
      }
      return l(o2, [{ key: "clear", value: function() {
        this.containerButtons.innerHTML = "", this.buttonScrollUp && (this.containerUI.removeChild(this.buttonScrollUp), this.buttonScrollUp = null), this.buttonScrollDown && (this.containerUI.removeChild(this.buttonScrollDown), this.buttonScrollDown = null);
      } }, { key: "drawLevelButton", value: function(e2, t3) {
        var n2 = this, r2 = document.createElement("div");
        r2.innerHTML = t3, r2.style.fontSize = "".concat(Math.max(Math.min(28.8 / t3.length, 11.52), 10), "px"), r2.style.display = "block", r2.setAttribute("class", T2), r2.setAttribute(_t, e2), r2.addEventListener("click", function() {
          n2.switch(e2), n2.clickHandler(e2);
        }), this.containerButtons.appendChild(r2);
      } }, { key: "drawScrollButtons", value: function() {
        var e2 = this, t3 = (this.buttonScrollUp = document.createElement("div"), this.buttonScrollUp.setAttribute("class", "".concat(T2, " ").concat(T2, "--up")), document.createElement("div")), t3 = (t3.setAttribute("class", "arrow arrow--up"), this.buttonScrollUp.appendChild(t3), this.buttonScrollUp.addEventListener("click", function() {
          return e2.scroll(1);
        }), this.containerUI.insertBefore(this.buttonScrollUp, this.containerButtons), this.buttonScrollDown = document.createElement("div"), this.buttonScrollDown.setAttribute("class", "".concat(T2, " ").concat(T2, "--down")), document.createElement("div"));
        t3.setAttribute("class", "arrow arrow--down"), this.buttonScrollDown.appendChild(t3), this.buttonScrollDown.addEventListener("click", function() {
          return e2.scroll(-1);
        }), this.containerUI.appendChild(this.buttonScrollDown);
      } }, { key: "scroll", value: function() {
        var e2, t3, n2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : 0, r2 = Array.from(this.containerButtons.querySelectorAll(".".concat(T2))).reverse(), i3 = [];
        0 <= n2 ? (this.currentScrollIndex = Math.min(this.currentScrollIndex + n2, r2.length - this.levelButtonCount), e2 = Math.min(this.currentScrollIndex, r2.length - this.levelButtonCount), t3 = Math.min(this.currentScrollIndex + this.levelButtonCount, r2.length), i3 = r2.slice(e2, t3)) : n2 < 0 && (this.currentScrollIndex = Math.max(this.currentScrollIndex + n2, 0), e2 = Math.max(0, this.currentScrollIndex), t3 = Math.min(r2.length, this.currentScrollIndex + this.levelButtonCount), i3 = r2.slice(e2, t3)), r2.forEach(function(e3) {
          -1 !== i3.indexOf(e3) ? e3.style.display = "block" : e3.style.display = "none";
        }), this.buttonScrollDown && (0 === this.currentScrollIndex ? this.buttonScrollDown.setAttribute("disabled", "disabled") : this.buttonScrollDown.removeAttribute("disabled")), this.buttonScrollUp && (this.currentScrollIndex === r2.length - this.levelButtonCount ? this.buttonScrollUp.setAttribute("disabled", "disabled") : this.buttonScrollUp.removeAttribute("disabled"));
      } }, { key: "switch", value: function(e2) {
        this.containerButtons.querySelectorAll(".".concat(Et2)).forEach(function(e3) {
          return e3.setAttribute("class", T2);
        });
        var t3, e2 = this.containerButtons.querySelector(".".concat(St2, " [").concat(_t, "='").concat(e2, "']"));
        e2 && (t3 = Array.from(this.containerButtons.querySelectorAll(".".concat(T2))).reverse(), e2.setAttribute("class", "".concat(T2, " ").concat(Et2)), ((t3 = t3.indexOf(e2)) < this.currentScrollIndex || t3 >= this.currentScrollIndex + 4) && this.scroll(t3 - this.currentScrollIndex));
      } }, { key: "update", value: function(e2, t3) {
        var n2, r2 = this, t3 = function() {
          return new Map((0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : []).map(function(e3) {
            return [e3.getZIndex(), e3.getShortName() || e3.getDisplayName() || e3.getName()];
          }));
        }((n2 = e2, ((t3 = t3) === I.FLATTEN ? (t3 = n2.getVenueModel().getLevelMapFlattenedByZIndex_(), Object.values(t3).map(function(e3) {
          return e3[0];
        })) : n2.getLevels()).sort(function(e3, t4) {
          return t4.getZIndex() - e3.getZIndex();
        }))), i3 = e2.getMainLevel().getZIndex();
        this.clear(), t3.forEach(function(e3, t4) {
          return r2.drawLevelButton(t4, e3);
        }), t3.size > this.levelButtonCount && (t3.size > this.levelButtonCount + 1 ? this.currentScrollIndex = Math.min(Array.from(t3).reverse().findIndex(function(e3) {
          return e3[0] === i3;
        }), t3.size - this.levelButtonCount) : this.currentScrollIndex = 0, this.drawScrollButtons(), this.scroll(0)), this.switch(i3);
      } }]), o2;
    }(), Lt2 = function() {
      function n2(e2, t3) {
        u2(this, n2), this.baseTheme = e2, this.metaInformation = t3, this.labelStyleMap = {}, this.styleMap = {}, this.setStyleMap();
      }
      return l(n2, [{ key: "setStyleMap", value: function() {
        this.styleMap.ENTRANCE = this.baseTheme.entranceRules.default.styleProperties, this.labelStyleMap.ENTRANCE = this.baseTheme.entranceRules.default.textLabelStyleProperties;
        for (var e2 = 0, t3 = Object.entries(this.baseTheme.spaceRules); e2 < t3.length; e2++) {
          var n3 = g(t3[e2], 2), r2 = n3[0], n3 = n3[1], i3 = n3.properties.behavioralAppearance.default.styleProperties, o2 = n3.properties.behavioralAppearance.default.textLabelStyleProperties;
          if (this.styleMap[r2] = i3, this.labelStyleMap[r2] = o2, n3.spaceTypes)
            for (var a3 = 0, s2 = Object.entries(n3.spaceTypes); a3 < s2.length; a3++) {
              var u3 = g(s2[a3], 2), l2 = u3[0], u3 = u3[1], c3 = u3.behavioralAppearance.default.styleProperties, u3 = u3.behavioralAppearance.default.textLabelStyleProperties;
              this.styleMap["".concat(r2, "_").concat(l2)] = c3 && 0 !== Object.keys(c3) ? c3 : i3, this.labelStyleMap["".concat(r2, "_").concat(l2)] = u3 && 0 !== Object.keys(u3) ? u3 : o2;
            }
        }
      } }, { key: "getBaseTheme", value: function() {
        return this.baseTheme;
      } }, { key: "getStyleMap", value: function() {
        return this.styleMap;
      } }, { key: "getGeometryStyle", value: function(e2) {
        return this.styleMap && Object.getOwnPropertyNames(this.styleMap) ? this.styleMap[e2] : null;
      } }, { key: "getLabelStyle", value: function(e2) {
        return this.labelStyleMap && Object.getOwnPropertyNames(this.labelStyleMap) ? this.labelStyleMap[e2] : null;
      } }], [{ key: "getGeometryDefaultStyle", value: function() {
        return { fill: "#e5e5e5", fillOpacity: 1, stroke: "#6c7a89", strokeOpacity: 1, strokeWidth: 2 };
      } }, { key: "getLabelDefaultStyle", value: function() {
        return { stroke: "#6c7a89", zmin: 15 };
      } }]), n2;
    }(), bt2 = function() {
      function e2() {
        u2(this, e2), this.config = Object.seal({ emitEventOnOverrideUpdate: true }), this.imageCache = {}, this.releaseSettings_ = { displayOptions: {}, mom: [] }, this.theme = {};
      }
      return l(e2, [{ key: "getMomData", value: function() {
        return this.releaseSettings_.mom;
      } }, { key: "getTheme", value: function() {
        return this.theme || {};
      } }, { key: "getStyle", value: function(e3) {
        var t3 = 1 < arguments.length && void 0 !== arguments[1] && arguments[1], n2 = this.getTheme(), r2 = Lt2.getGeometryDefaultStyle(), i3 = e3.properties.spaceType, e3 = e3.properties.spaceCategory, o2 = e3;
        return i3 && (o2 = "".concat(e3, "_").concat(i3)), { m: (e3 = (e3 = n2.getGeometryStyle(o2)) && !t3 ? e3 : r2).fill && e3.fill.toLowerCase() || "#fff", w: e3.strokeWidth / 10 || 0.1, o: e3.stroke && e3.stroke.toLowerCase() || "#fff", l: "Dark" };
      } }, { key: "getLabelStyle", value: function(e3) {
        this.getTheme();
        var t3 = Lt2.getLabelDefaultStyle();
        return { fill: t3.stroke, zmin: t3.zmin };
      } }]), e2;
    }(), A2 = Math.PI / 180, Tt2 = 180 / Math.PI, O2 = function() {
      function h2() {
        u2(this, h2);
      }
      return l(h2, null, [{ key: "toRadians", value: function(e2) {
        return e2 * A2;
      } }, { key: "toDegrees", value: function(e2) {
        return e2 * Tt2;
      } }, { key: "getBoundingBox", value: function(e2, t3) {
        var n2 = [];
        switch (e2) {
          case $e2:
            n2 = [t3, t3];
            break;
          case nt2:
          case et2:
            n2 = t3;
            break;
          case rt2:
          case tt2:
            n2 = t3.reduce(function(e3, t4) {
              return e3.concat(t4);
            }, []);
            break;
          case it2:
            n2 = t3.reduce(function(e3, t4) {
              return e3.concat(t4);
            }, []).reduce(function(e3, t4) {
              return e3.concat(t4);
            }, []);
        }
        return h2.getBoundingBoxVertices(n2);
      } }, { key: "getInverseTransform", value: function(e2) {
        var t3 = e2[0] * e2[3] - e2[1] * e2[2], t3 = [e2[3] / t3, -e2[1] / t3, -e2[2] / t3, e2[0] / t3, 0, 0];
        return t3[4] = -(t3[0] * e2[4] + t3[2] * e2[5]), t3[5] = -(t3[1] * e2[4] + t3[3] * e2[5]), t3;
      } }, { key: "applyTransformToPoint", value: function(e2, t3) {
        return [t3[0] * e2[0] + t3[1] * e2[2] + e2[4], t3[0] * e2[1] + t3[1] * e2[3] + e2[5]];
      } }, { key: "transformProduct", value: function(e2, t3) {
        var n2 = [0, 0, 0, 0, 0, 0];
        return n2[0] = t3[0] * e2[0] + t3[2] * e2[1], n2[1] = t3[1] * e2[0] + t3[3] * e2[1], n2[2] = t3[0] * e2[2] + t3[2] * e2[3], n2[3] = t3[1] * e2[2] + t3[3] * e2[3], n2[4] = t3[0] * e2[4] + t3[2] * e2[5] + t3[4], n2[5] = t3[1] * e2[4] + t3[3] * e2[5] + t3[5], n2;
      } }, { key: "convertLonLatToMerc", value: function(e2) {
        var t3 = e2[0] * A2, e2 = e2[1] * A2, e2 = Math.sin(e2);
        return [0.5 + t3 / (2 * Math.PI), 0.5 - Math.log((1 + e2) / (1 - e2)) / (4 * Math.PI)];
      } }, { key: "convertMercToLatLon", value: function(e2) {
        var t3 = 2 * Math.PI * (e2[0] - 0.5), e2 = Math.atan(Math.sinh(2 * Math.PI * (0.5 - e2[1])));
        return [t3 / A2, e2 / A2];
      } }, { key: "getTransformScale", value: function(e2) {
        return Math.sqrt(e2[0] * e2[3] - e2[1] * e2[2]);
      } }, { key: "getLonLatToMercTransform", value: function(e2) {
        var t3 = [1 / 360, 0, 0, -1 / (360 * Math.cos(e2[1] * A2)), 0, 0], n2 = h2.applyTransformToPoint(t3, e2), e2 = h2.convertLonLatToMerc(e2);
        return t3[4] = e2[0] - n2[0], t3[5] = e2[1] - n2[1], t3;
      } }, { key: "getNatToMercTransform", value: function(e2) {
        var t3 = [e2[4], e2[5]], t3 = h2.getLonLatToMercTransform(t3);
        return h2.transformProduct(e2, t3);
      } }, { key: "convertMxMy2LonLat", value: function(e2, t3) {
        return e2.length && t3.length ? h2.applyTransformToPoint(e2, t3) : [];
      } }, { key: "convertLonLat2MxMy", value: function(e2, t3) {
        if (!e2.length || !t3.length)
          return [];
        e2 = h2.getInverseTransform(e2);
        return h2.applyTransformToPoint(e2, t3);
      } }, { key: "getFlattenedQuadraticBezierCurve", value: function(e2, t3, n2) {
        var r2 = [], i3 = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : 10;
        i3 < 1 && (i3 = 6);
        for (var o2 = 0; o2 <= i3; o2 += 1) {
          var a3 = o2 / i3, s2 = (1 - a3) * (1 - a3), u3 = 2 * a3 * (1 - a3), a3 = a3 * a3, l2 = s2 * e2[0] + u3 * t3[0] + a3 * n2[0], s2 = s2 * e2[1] + u3 * t3[1] + a3 * n2[1];
          r2.push([l2, s2]);
        }
        return r2;
      } }, { key: "getFlattenedCubicBezierCurve", value: function(e2, t3, n2, r2) {
        var i3 = [], o2 = 4 < arguments.length && void 0 !== arguments[4] ? arguments[4] : 10;
        o2 < 1 && (o2 = 6);
        for (var a3 = 0; a3 <= o2; a3 += 1) {
          var s2 = a3 / o2, u3 = (1 - s2) * (1 - s2) * (1 - s2), l2 = 3 * s2 * (1 - s2) * (1 - s2), c3 = 3 * s2 * s2 * (1 - s2), s2 = s2 * s2 * s2, h3 = u3 * e2[0] + l2 * t3[0] + c3 * n2[0] + s2 * r2[0], u3 = u3 * e2[1] + l2 * t3[1] + c3 * n2[1] + s2 * r2[1];
          i3.push([h3, u3]);
        }
        return i3;
      } }, { key: "getRectangularCoordinatesOfLabelArea", value: function(e2, t3) {
        var n2 = !(2 < arguments.length && void 0 !== arguments[2]) || arguments[2], r2 = g(e2, 6), i3 = r2[0], o2 = r2[1], a3 = r2[2], s2 = r2[3], r2 = r2[5], u3 = h2.getDeltaLonLatForMeterAtGivenLonLat(i3, o2), e2 = e2[4];
        return n2 ? (r2 && (e2 *= -1), null != t3 && (e2 = (e2 += t3 < 0 ? 2 * Math.PI + t3 : t3) < 0 ? 2 * Math.PI + e2 : e2)) : e2 = 0, h2.getRectVerticesFromSignatureRectRepresentation([i3, o2], { xLength: a3, yLength: s2 }, e2, u3);
      } }, { key: "getRotatedPoint", value: function(e2, t3) {
        var n2 = !(2 < arguments.length && void 0 !== arguments[2]) || arguments[2], r2 = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : [0, 0], i3 = Math.cos(t3), t3 = Math.sin(t3), o2 = e2[0] - r2[0], e2 = e2[1] - r2[1], a3 = [];
        return [(a3 = n2 ? [o2 * i3 + e2 * t3, e2 * i3 - o2 * t3] : [o2 * i3 - e2 * t3, e2 * i3 + o2 * t3])[0] + r2[0], a3[1] + r2[1]];
      } }, { key: "getRectVerticesFromSignatureRectRepresentation", value: function(e2, t3, n2, r2) {
        var i3 = t3.xLength, t3 = t3.yLength, o2 = !(4 < arguments.length && void 0 !== arguments[4]) || arguments[4], e2 = g(e2, 2), a3 = e2[0], s2 = e2[1], u3 = i3 / 2, H2 = t3 / 2, e2 = g(r2, 2), l2 = e2[0], c3 = e2[1];
        return [[1, 1], [-1, 1], [-1, -1], [1, -1]].map(function(e3) {
          return [e3[0] * u3, e3[1] * H2];
        }).map(function(e3) {
          return h2.getRotatedPoint(e3, n2, o2);
        }).map(function(e3) {
          return [e3[0] * l2, e3[1] * c3];
        }).map(function(e3) {
          return [e3[0] + a3, e3[1] + s2];
        });
      } }, { key: "getScaleFactorForRectInSpace", value: function(e2, t3, n2, r2) {
        e2 /= n2, n2 = t3 / r2;
        return n2 < e2 ? n2 : e2;
      } }, { key: "getDeltaLonLatForMeterAtGivenLonLat", value: function(e2, t3) {
        return [1 / 6371e3 * (180 / Math.PI) / Math.cos(t3 * Math.PI / 180), 1 / 6371e3 * (180 / Math.PI)];
      } }, { key: "getBoundingBoxVertices", value: function() {
        var e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : [], t3 = [[Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY], [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY]];
        return e2.reduce(function(e3, t4) {
          return [[Math.min(t4[0], e3[0][0]), Math.min(t4[1], e3[0][1])], [Math.max(t4[0], e3[1][0]), Math.max(t4[1], e3[1][1])]];
        }, t3);
      } }, { key: "isPointInBoundingBox", value: function(e2, t3) {
        var n2, r2, i3, o2;
        if (e2 && t3)
          return e2 = g(e2, 2), n2 = e2[0], e2 = e2[1], t3 = g(t3, 2), i3 = g(t3[0], 2), r2 = i3[0], i3 = i3[1], t3 = g(t3[1], 2), o2 = t3[0], t3 = t3[1], n2 <= o2 && r2 <= n2 && e2 <= t3 && i3 <= e2;
      } }, { key: "isPointOnLineSegment", value: function(e2, t3, n2) {
        var e2 = g(e2, 2), r2 = e2[0], e2 = e2[1], t3 = g(t3, 2), i3 = t3[0], t3 = t3[1], n2 = g(n2, 2), o2 = n2[0], n2 = n2[1], a3 = (t3 - e2) * (n2 - e2) <= 0;
        return i3 === o2 ? i3 === r2 && a3 : e2 - n2 == (n2 - t3) / (o2 - i3) * (r2 - o2) && a3;
      } }, { key: "rayIntersectLineSegment", value: function(e2, t3, n2) {
        var e2 = g(e2, 2), r2 = e2[0], e2 = e2[1], t3 = g(t3, 2), i3 = t3[0], t3 = t3[1], n2 = g(n2, 2), o2 = n2[0], n2 = n2[1];
        if (i3 === o2)
          return false;
        r2 = (r2 - i3) / (o2 - i3);
        return 0 <= r2 && r2 < 1 && e2 < (n2 - t3) * r2 + t3;
      } }, { key: "isPointInPolygon", value: function(e2, t3) {
        var e2 = g(e2, 2), n2 = e2[0], r2 = e2[1], e2 = t3.length;
        if (e2 < 3)
          return false;
        var i3 = 0, o2 = t3[e2 - 1];
        return t3.forEach(function(e3) {
          h2.rayIntersectLineSegment([n2, r2], o2, e3) && (i3 += 1), o2 = e3;
        }), i3 % 2 != 0;
      } }, { key: "isPointOnLineString", value: function(e2, t3) {
        var e2 = g(e2, 2), n2 = e2[0], r2 = e2[1], i3 = t3.length;
        if (!(i3 < 2))
          for (var o2 = t3[i3 - 1], a3 = 0; a3 < i3; a3 += 1) {
            var s2 = t3[a3];
            if (h2.isPointOnLineSegment([n2, r2], o2, s2))
              return true;
            o2 = t3[a3];
          }
        return false;
      } }, { key: "getAreaOfPolygon", value: function(e2) {
        var t3 = e2.length;
        if (t3 < 3)
          return null;
        var o2 = 0, a3 = e2[t3 - 1];
        return e2.forEach(function(e3) {
          var t4, n2, r2, i3;
          o2 += 0.5 * (n2 = e3, t4 = g(t4 = a3, 2), r2 = t4[0], t4 = t4[1], n2 = g(n2, 2), i3 = n2[0], r2 * n2[1] - t4 * i3), a3 = e3;
        }), o2;
      } }, { key: "getDistanceBetweenPoints", value: function(e2, t3) {
        var e2 = g(e2, 2), n2 = e2[0], e2 = e2[1], t3 = g(t3, 2), n2 = n2 - t3[0], e2 = e2 - t3[1];
        return Math.sqrt(n2 * n2 + e2 * e2);
      } }]), h2;
    }(), At2 = function() {
      function e2() {
        u2(this, e2), this.spaceRules = {};
      }
      return l(e2, null, [{ key: "getDataEntriesOne", value: function(e3, t3) {
        var n2, e3 = [e3, ""];
        return null !== t3 && Array.isArray(t3) ? e3[1] = t3.toString() : null !== t3 && "object" === a2(t3) ? 0 < (n2 = Object.entries(t3)).length && (n2 = this.getDataEntriesOne(n2[0][0], n2[0][1]), e3[0] = "".concat(e3[0], ".").concat(n2[0]), e3[1] = n2[1]) : e3[1] = t3, e3;
      } }, { key: "getDataEntriesAll", value: function(e3) {
        for (var t3 = [], n2 = 0, r2 = Object.entries(e3); n2 < r2.length; n2++) {
          var i3 = g(r2[n2], 2), o2 = i3[0], i3 = i3[1], o2 = this.getDataEntriesOne(o2, i3);
          t3.push(o2);
        }
        return t3;
      } }, { key: "doFindComboMatch", value: function(e3, t3) {
        var r2 = "";
        if (e3 && e3.configuration && e3.configuration.combinations)
          for (var i3 = this.getDataEntriesAll(t3), t3 = Object.entries(e3.configuration.combinations), o2 = 0, a3 = 0, s2 = t3; a3 < s2.length; a3++)
            !function() {
              var n2 = s2[a3], e4 = Object.keys(n2[1]).filter(function(t4) {
                return i3.some(function(e5) {
                  return t4 === e5[0] && n2[1][t4] === e5[1];
                });
              });
              e4.length === Object.keys(n2[1]).length && e4.length > o2 && (r2 = n2[0], o2 = e4.length);
            }();
        return r2;
      } }, { key: "getIconFromCombinations", value: function(e3, t3) {
        if (e3 && e3.configuration.combinations && t3 && 0 < Object.keys(t3).length && e3.behavioralAppearance.combinations && 0 < Object.keys(e3.behavioralAppearance.combinations).length) {
          t3 = this.doFindComboMatch(e3, t3);
          if ("" === t3 || !e3.behavioralAppearance.combinations[t3].labelIcon)
            return "";
          if (e3.behavioralAppearance.combinations && e3.behavioralAppearance.combinations[t3] && e3.behavioralAppearance.combinations[t3].labelIcon)
            return e3.behavioralAppearance.combinations[t3].labelIcon.referenceUri;
        }
        return "";
      } }, { key: "findSpace", value: function(e3, t3) {
        if (t3.spaceTypes && t3.spaceTypes[e3])
          return t3.spaceTypes[e3];
      } }, { key: "findCategory", value: function(e3) {
        if (this.spaceRules[e3])
          return this.spaceRules[e3];
      } }, { key: "setSpaceRules", value: function(e3) {
        this.spaceRules = e3;
      } }, { key: "getSpaceIcon", value: function(e3, t3, n2) {
        var r2, i3 = "", t3 = this.findCategory(t3);
        return t3 && (e3 = this.findSpace(e3, t3)) && (r2 = "", (r2 = n2 ? this.getIconFromCombinations(e3, n2) : r2) && "" !== r2 ? i3 = r2 : e3.behavioralAppearance.default.labelIcon ? i3 = e3.behavioralAppearance.default.labelIcon.referenceUri : t3.properties.behavioralAppearance.default.labelIcon && (i3 = t3.properties.behavioralAppearance.default.labelIcon.referenceUri)), i3;
      } }]), e2;
    }(), N2 = function() {
      function e2() {
        u2(this, e2), this.themeRule = {}, this.svgList = {}, this.defaultLang = "ENG";
      }
      return l(e2, null, [{ key: "getNumberFromAlphaNumeric", value: function(e3) {
        try {
          var t3 = e3.split("").reverse().join("").replace(/[^0-9]/g, "").substr(0, 6);
          return parseInt(t3, 10);
        } catch (e4) {
          return null;
        }
      } }, { key: "extractNumFromSting", value: function(t3) {
        try {
          var e3 = t3.replace(/[^0-9]/g, "");
          return parseInt(e3, 10);
        } catch (e4) {
          return console.warn("Exception in converting string to Id"), this.getNumberFromAlphaNumeric(t3);
        }
      } }, { key: "getVenueId", value: function(e3) {
        var t3;
        return "number" != typeof e3 ? (t3 = e3.substr(e3.length - 6), parseInt(t3, 10)) : e3;
      } }, { key: "getStringFormatIdentifier", value: function(e3) {
        return "number" == typeof e3 || e3.length < 13 ? "indoormap-00000000-0000-4000-a000-".concat(e3.toString().padStart(12, "0")) : e3;
      } }, { key: "setSite", value: function(e3, t3) {
        var n2 = this.getName(e3), e3 = { id: this.getStringFormatIdentifier(t3), location: e3.referencePoint, properties: e3.properties, geometry: e3.geometry, map_version: e3.properties.indoorSiteMetadata.legacyVersion.mapVersion, identifier: this.getVenueId(t3), obj_type: "CommunityMap" };
        return e3.properties.name = n2, e3.properties.display_name = n2, e3;
      } }, { key: "setEntrance", value: function(e3) {
        var t3 = this.themeRule.entranceRules.default.labelIcon.referenceUri, n2 = this.extractNumFromSting(e3.id), r2 = this.getName(e3), i3 = e3.properties;
        return i3.icon = true, i3.svg = this.svgList[t3.toLowerCase()], i3.name = r2 || "entrance", i3.display_name = r2 || "entrance", i3.level = { id: e3.properties.level.id }, { id: e3.id, levelId: e3.properties.level.id, momType: Ye2, geometry: e3.geometry, location: e3.geometry, properties: i3, identifier: n2, label_area: [e3.referencePoint.coordinates[0], e3.referencePoint.coordinates[1], 50, 50, 180] };
      } }, { key: "setStructure", value: function(e3) {
        var t3 = this.extractNumFromSting(e3.id), n2 = this.getName(e3), r2 = e3.properties;
        return r2.is_root = 0 === e3.properties.drawOrder, r2.display_name = n2, r2.map_type = e3.properties.structureType, r2.name = n2, { id: e3.id, obj_type: "Drawing", identifier: t3, properties: r2 };
      } }, { key: "getNameByPriority", value: function(e3, t3) {
        for (var n2, r2 = this, i3 = "", o2 = 0; o2 < e3.length; o2++) {
          var a3 = e3[o2];
          if (("OFFICIAL" === (n2 = a3).nameType && n2.languageCode && n2.languageCode === r2.defaultLang || "OFFICIAL" === n2.nameType) && (t3 && t3 === a3.nameType || !t3)) {
            i3 = a3.name;
            break;
          }
          if ("ABBREVIATION" === a3.nameType && (t3 && t3 === a3.nameType || !t3)) {
            i3 = a3.name;
            break;
          }
          if ("UNCLASSIFIED" === a3.nameType && (t3 && t3 === a3.nameType || !t3)) {
            i3 = a3.name;
            break;
          }
          if (!a3.nameType && a3.name) {
            i3 = a3.name;
            break;
          }
        }
        return i3;
      } }, { key: "getName", value: function(e3, t3) {
        return e3.properties && e3.properties.names ? this.getNameByPriority(e3.properties.names, t3) : e3.properties.placeProperties && e3.properties.placeProperties && e3.properties.placeProperties.names ? this.getNameByPriority(e3.properties.placeProperties.names, t3) : e3.properties.locationDetails && e3.properties.locationDetails[0] && e3.properties.locationDetails[0].names ? this.getNameByPriority(e3.properties.locationDetails[0].names, t3) : "";
      } }, { key: "setLevel", value: function(e3) {
        var t3 = this.extractNumFromSting(e3.id), n2 = e3.properties.names, r2 = e3.properties;
        return r2["short name"] = this.getNameByPriority(n2, n2 && 1 !== n2.length ? "ABBREVIATION" : ""), r2.name = this.getNameByPriority(n2, n2 && 1 !== n2.length ? "ABBREVIATION" : ""), { id: e3.id, obj_type: "Level", identifier: t3, properties: r2 };
      } }, { key: "setLevelConnector", value: function(e3) {
        var t3 = this.extractNumFromSting(e3.id);
        return { id: e3.id, obj_type: "LevelConnector", properties: e3.properties, geometry: e3.geometry, identifier: t3, location: e3.geometry };
      } }, { key: "setOccupant", value: function(e3) {
        var t3 = this.getName(e3), n2 = this.extractNumFromSting(e3.id), r2 = e3.properties;
        return r2.occupantName = t3, r2.email = e3.properties.placeProperties && e3.properties.placeProperties.contacts && e3.properties.placeProperties.contacts.find(function(e4) {
          return "EMAIL" === e4.contactType;
        }) && e3.properties.placeProperties.contacts.find(function(e4) {
          return "EMAIL" === e4.contactType;
        }).value, r2.name = t3, r2.tags = e3.properties.attributes && e3.properties.attributes.tags, { geometry: e3.geometry, id: e3.id, obj_type: "Geometry", properties: r2, identifier: n2, spaceIds: e3.properties.spaces || [], type: "Feature", momType: He2 };
      } }, { key: "getIcon", value: function(e3) {
        var t3 = false, n2 = "";
        return this.svgList[e3] && (t3 = true, n2 = this.svgList[e3]), { icon: t3, svg: n2 };
      } }, { key: "setSpace", value: function(e3) {
        var t3 = At2.getSpaceIcon(e3.properties.spaceType, e3.properties.spaceCategory, e3.properties.spaceTypeProperties), n2 = this.getName(e3), t3 = this.getIcon(t3), r2 = t3.icon, t3 = t3.svg, i3 = this.extractNumFromSting(e3.id), o2 = (e3.properties.level.id.includes("out"), e3.properties.level.id), a3 = e3.properties, n2 = (a3.spaceName = n2, a3[e3.properties.spaceCategory] = e3.properties.spaceType, a3.spaceType = e3.properties.spaceType, a3.spaceCategory = e3.properties.spaceCategory, a3.icon = r2, a3.svg = t3, { geometry: e3.geometry, id: e3.id, levelId: o2, label_area: [e3.referencePoint.coordinates[0], e3.referencePoint.coordinates[1], 50, 50, 180], location: e3.referencePoint, obj_type: "Geometry", identifier: i3, properties: a3, momType: ze2, type: "Feature" });
        return e3.properties.spaceAddress && e3.properties.spaceAddress.id && (n2.addressId = e3.properties.spaceAddress.id), n2;
      } }, { key: "setSpaceGroups", value: function(e3) {
        var t3 = this.extractNumFromSting(e3.id);
        return { id: e3.id, obj_type: "SpaceGroups", properties: e3.properties, geometry: e3.geometry, location: e3.referencePoint, identifier: t3 };
      } }, { key: "setTopology", value: function(e3) {
        var t3 = this.extractNumFromSting(e3.id);
        return { id: e3.id, obj_type: "Topology", properties: e3.properties, geometry: e3.geometry, identifier: t3 };
      } }, { key: "setAddress", value: function(e3) {
        var t3 = this.extractNumFromSting(e3.id), n2 = this.getName(e3), r2 = e3.properties;
        return r2.addressName = n2, r2.name = n2, { id: e3.id, properties: r2, obj_type: "Address", identifier: t3 };
      } }, { key: "manageSvgDimensions", value: function(e3) {
        for (var t3 = {}, n2 = 0, r2 = Object.entries(e3); n2 < r2.length; n2++) {
          var i3, o2, a3 = g(r2[n2], 2), s2 = a3[0], a3 = a3[1];
          "string" == typeof a3 && (i3 = -1 !== a3.indexOf("<g") && a3.indexOf("<g") || a3.indexOf("<p"), o2 = a3.indexOf("</s"), i3 && o2 && (a3 = a3.substring(i3 - 1, o2 - 1), t3[s2] = "<svg width='64' height='64' viewBox='0 0 24 32' fill='none' xmlns='http://www.w3.org/2000/svg'>".concat(a3, "</svg>")));
        }
        return t3;
      } }, { key: "getSiteBoundingBox", value: function(e3) {
        if (e3) {
          var e3 = g(O2.getBoundingBox(e3.geometry.type, e3.geometry.coordinates), 2), t3 = e3[0], e3 = e3[1];
          if (t3)
            return "".concat(t3[0], ",").concat(t3[1], ",").concat(e3[0], ",").concat(e3[1]);
        }
        return "null, null, null, null";
      } }]), e2;
    }(), k = function() {
      function e2() {
        u2(this, e2);
      }
      return l(e2, null, [{ key: "get", value: function(t3) {
        return fetch(t3, 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : { method: "GET" }).then(function(e3) {
          return e3.ok ? e3.json() : Promise.reject(new Error("Call failed for ".concat(t3, " : ").concat(e3.status, " ").concat(e3.statusText)));
        });
      } }, { key: "getFormattedIndoorMapId", value: function(e3) {
        return "number" == typeof e3 ? "indoormap-00000000-0000-4000-a000-".concat(e3.toString().padStart(12, "0")) : e3.includes("indoormap") ? e3 : "indoormap-00000000-0000-4000-a000-".concat(e3.padStart(12, "0"));
      } }, { key: "getConfigUrl", value: function(e3, t3, n2) {
        var r2 = n2.apiKey, i3 = n2.url, o2 = n2.token, n2 = n2.hrn, a3 = { method: "GET", mode: "cors", cache: "default" }, i3 = "".concat(i3 || ut2, "/").concat(n2), n2 = "";
        return t3 === m.SITE && (n2 = "".concat(i3, "/layers/").concat(ot2, "/search?p.featureType=indoor.Site&p.indoorMapId='").concat(this.getFormattedIndoorMapId(e3), "'")), t3 === m.IMAGES && (n2 = "".concat(i3, "/layers/").concat(at2, "/features/svg")), t3 === m.Theme && (n2 = "".concat(i3, "/layers/").concat(st2, "/features/indoorMapRules")), o2 ? a3.headers = { Authorization: "Bearer ".concat(o2) } : n2 = n2.concat("".concat(t3 === m.SITE ? "&" : "?", "apiKey=").concat(r2)), this.get(n2, a3);
      } }, { key: "getMomData", value: function(e3, t3) {
        var n2 = t3.apiKey, r2 = t3.url, i3 = t3.token, t3 = t3.hrn, o2 = { method: "GET", mode: "cors", cache: "default" }, r2 = "".concat(r2 || ut2, "/").concat(t3), t3 = e3 && e3.features && e3.features.find(function(e4) {
          return e4.momType === Re2;
        }), e3 = N2.getSiteBoundingBox(t3), r2 = "".concat(r2, "/layers/").concat(ot2, "/bbox?bbox=").concat(e3, "&f.momType=indoor.Level,indoor.Space,indoor.Site,indoor.Structure,indoor.Occupant,indoor.SpaceGroups,Address,indoor.Entrance");
        return i3 ? o2.headers = { Authorization: "Bearer ".concat(i3) } : r2 = r2.concat("&apiKey=".concat(n2)), { mom: this.get(r2, o2), site: t3 };
      } }, { key: "getDefaultCollection", value: function(e3) {
        var e3 = e3.token, t3 = lt2[E2.DEFAULT_COLLECTION], n2 = t3.PARAMS, t3 = t3.BASE_URL, t3 = encodeURI("".concat(t3, "?sortBy=").concat(n2.CREATED_BY, "&q=").concat(n2.COLLECTION));
        return e3 ? (n2 = { method: "GET", headers: { Authorization: "Bearer ".concat(e3) } }, this.get(t3, n2)) : Promise.reject(new Error("Please provide valid token"));
      } }, { key: "getProjectAccountDetails", value: function(e3) {
        var e3 = e3.token, t3 = lt2[E2.ACCOUNT_API].BASE_URL;
        return e3 ? (e3 = { method: "GET", mode: "cors", headers: { Authorization: "Bearer ".concat(e3) } }, this.get(t3, e3)) : Promise.reject(new Error("Please provide valid token"));
      } }, { key: "fetchIndoorMapList", value: function() {
        var e3 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {}, t3 = e3.hrn, n2 = e3.url, r2 = lt2[E2.CATALOG_LAYER], i3 = r2.PARAMS, r2 = r2.COLLECTION_LAYER, n2 = n2 || ut2;
        return t3 ? (n2 = encodeURI("".concat(n2, "/").concat(t3, "/").concat(r2, "?").concat(i3.FEATURE_TYPE.KEY, "=").concat(i3.FEATURE_TYPE.VALUE)), r2 = (t3 = this.createBaseUrl(n2, ht2.GET, {}, e3)).URL, i3 = t3.options, this.get(r2, i3)) : Promise.reject(new Error("Please provide valid hrn"));
      } }, { key: "createBaseUrl", value: function() {
        var e3 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "", t3 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : ht2.GET, n2 = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : {}, r2 = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {}, i3 = r2.token, r2 = r2.apiKey, o2 = e3, t3 = { method: t3, mode: "cors" };
        return i3 ? t3.headers = f2({ Authorization: "Bearer ".concat(i3) }, n2) : o2 = e3.concat("&apiKey=".concat(r2)), { URL: o2, options: t3 };
      } }]), e2;
    }(), w = function() {
      function i3() {
        u2(this, i3);
      }
      return l(i3, null, [{ key: "isPointOnGeoJSONLineString", value: function(e2, t3) {
        var n2 = false;
        if (t3 && 1 < t3.length) {
          for (var r2, i4, o2 = 1; o2 < t3.length; o2 += 1)
            if (r2 = t3[o2 - 1], i4 = t3[o2], O2.isPointOnLineSegment(e2, r2, i4)) {
              n2 = true;
              break;
            }
        }
        return n2;
      } }, { key: "isPointOnGeoJSONMultiLineString", value: function(e2, t3) {
        for (var n2 = false, r2 = 0; r2 < t3.length; r2 += 1)
          if (i3.isPointOnGeoJSONLineString(e2, t3[r2])) {
            n2 = true;
            break;
          }
        return n2;
      } }, { key: "isPointInsideGeoJSONPolygon", value: function(e2, t3) {
        var n2 = false;
        if (n2 = O2.isPointInPolygon(e2, t3[0]) ? true : n2) {
          for (var r2 = 1; r2 < t3.length; r2 += 1)
            if (O2.isPointInPolygon(e2, t3[r2])) {
              n2 = false;
              break;
            }
        }
        return n2;
      } }, { key: "isPointInsideGeoJSONMultiPolygon", value: function(e2, t3) {
        for (var n2 = t3.length, r2 = 0; r2 < n2; r2 += 1)
          if (i3.isPointInsideGeoJSONPolygon(e2, t3[r2]))
            return true;
        return false;
      } }, { key: "getGeometriesByLonLat", value: function(t3, e2) {
        for (var n2 = 2 < arguments.length && void 0 !== arguments[2] && arguments[2], r2 = [], i4 = e2.filter(function(e3) {
          return O2.isPointInBoundingBox(t3, e3.getBoundingBox());
        }), o2 = 0; o2 < i4.length; o2 += 1) {
          var a3 = i4[o2];
          if (a3.isPointInsideGeometry(t3, true) && (r2.push(a3), !n2))
            break;
        }
        return r2.sort(function(e3, t4) {
          return t4.getZIndex() - e3.getZIndex();
        });
      } }]), i3;
    }(), Ot2 = function() {
      function r2() {
        var e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {}, t3 = 1 < arguments.length ? arguments[1] : void 0, n2 = 2 < arguments.length ? arguments[2] : void 0;
        u2(this, r2), this.id = e2.id, this.properties = e2.properties || {}, this.labelArea = e2.label_area || [], this.geometry = e2.geometry || {}, this.location = e2.location || {}, this.address = e2.address || {}, this.level = t3, this.zIndex = n2, this.spaceId = e2.spaceId, this.state_ = { isHighlighted: false, highlightedStyle: {} }, this.geometryData = e2;
      }
      return l(r2, [{ key: "getId", value: function() {
        return this.geometryData && this.geometryData.identifier;
      } }, { key: "getIdentifier", value: function() {
        return this.id;
      } }, { key: "getProperties", value: function() {
        return this.properties;
      } }, { key: "getInternalAddress", value: function() {
        return this.address ? this.address.properties && this.address.properties.name : null;
      } }, { key: "getCenter", value: function() {
        return this.location.coordinates || [];
      } }, { key: "getCoordinates", value: function() {
        return this.geometry.coordinates || [];
      } }, { key: "getDisplayName", value: function() {
        return this.properties.display_name || "";
      } }, { key: "getName", value: function() {
        return this.properties.name || "";
      } }, { key: "getStyle", value: function() {
        return this.getMetaInformation_().getStyle(this);
      } }, { key: "getIcon", value: function() {
        return this.properties.svg;
      } }, { key: "getLabelArea", value: function() {
        return this.labelArea || [];
      } }, { key: "getLabelStyle", value: function() {
        return this.getMetaInformation_().getLabelStyle(this) || null;
      } }, { key: "getLevel", value: function() {
        return this.level;
      } }, { key: "getType", value: function() {
        return this.geometry.type;
      } }, { key: "getZIndex", value: function() {
        return this.zIndex;
      } }, { key: "getBoundingBox", value: function() {
        var e2 = this.getType(), t3 = this.getCoordinates(), n2 = [];
        switch (e2) {
          case $e2:
            n2 = [t3, t3];
            break;
          case nt2:
          case et2:
            n2 = t3;
            break;
          case rt2:
          case tt2:
            n2 = t3.reduce(function(e3, t4) {
              return e3.concat(t4);
            }, []);
            break;
          case it2:
            n2 = t3.reduce(function(e3, t4) {
              return e3.concat(t4);
            }, []).reduce(function(e3, t4) {
              return e3.concat(t4);
            }, []);
        }
        return O2.getBoundingBoxVertices(n2);
      } }, { key: "isIcon", value: function() {
        return !!this.properties.icon;
      } }, { key: "isPointInsideGeometry", value: function(e2) {
        var t3, n2 = 1 < arguments.length && void 0 !== arguments[1] && arguments[1], r3 = false;
        switch (this.getType()) {
          case $e2:
            t3 = this.getLabelArea() && O2.getRectangularCoordinatesOfLabelArea(this.getLabelArea()), r3 = O2.isPointInPolygon(e2, t3);
            break;
          case nt2:
            break;
          case et2:
            r3 = n2 && w.isPointOnGeoJSONLineString(e2, this.getCoordinates());
            break;
          case rt2:
            r3 = n2 && w.isPointOnGeoJSONMultiLineString(e2, this.getCoordinates());
            break;
          case tt2:
            r3 = w.isPointInsideGeoJSONPolygon(e2, this.getCoordinates());
            break;
          case it2:
            r3 = w.isPointInsideGeoJSONMultiPolygon(e2, this.getCoordinates());
        }
        return r3;
      } }, { key: "highlight", value: function() {
        var e2 = !(0 < arguments.length && void 0 !== arguments[0]) || arguments[0], t3 = 1 < arguments.length ? arguments[1] : void 0;
        this.state_.isHighlighted = e2, this.state_.highlightedStyle = e2 ? t3 : {};
      } }, { key: "isHighlighted", value: function() {
        return Boolean(this.state_.isHighlighted);
      } }, { key: "getHighlightedStyle", value: function() {
        return this.state_.highlightedStyle || {};
      } }, { key: "toJSON", value: function() {
        return f2({}, this.geometry);
      } }, { key: "getMetaInformation_", value: function() {
        return this.getLevel() ? this.getLevel().getDrawing().getVenueModel().metaInformation_ : null;
      } }]), r2;
    }(), Nt2 = function() {
      function r2(e2, t3) {
        var n2 = this;
        u2(this, r2), this.id = e2 && e2.id, this.properties = e2 && e2.properties, this.zIndexCount = 0, this.geometries = e2 && e2.features && Object.values(e2.features).reduce(function(e3, t4) {
          return e3[[t4.id]] = new Ot2(t4, n2, t4.properties.drawOrder), e3;
        }, {}), this.drawing = t3, this.levelData = e2;
      }
      return l(r2, [{ key: "getId", value: function() {
        return this.levelData && this.levelData.identifier;
      } }, { key: "getIdentifier", value: function() {
        return this.id;
      } }, { key: "getProperties", value: function() {
        return this.properties;
      } }, { key: "getName", value: function() {
        return this.properties && this.properties.name || "";
      } }, { key: "getDisplayName", value: function() {
        return this.properties && this.properties.display_name || "";
      } }, { key: "getDrawing", value: function() {
        return this.drawing;
      } }, { key: "getShortName", value: function() {
        return this.properties && this.properties["short name"] || "";
      } }, { key: "getZIndex", value: function() {
        return this.properties && this.properties.zLevel;
      } }, { key: "getFeatureCollectionArray", value: function() {
        return this.getGeometries().map(function(e2) {
          return e2.toJSON();
        });
      } }, { key: "getGeometryById", value: function(e2) {
        return this.geometries[e2];
      } }, { key: "getGeometries", value: function() {
        return 0 < arguments.length && void 0 !== arguments[0] && arguments[0] ? this.geometries && Object.values(this.geometries).sort(function(e2, t3) {
          return t3.getZIndex() - e2.getZIndex();
        }) : this.geometries && Object.values(this.geometries).sort(function(e2, t3) {
          return e2.getZIndex() - t3.getZIndex();
        });
      } }, { key: "getGeometriesByAddress", value: function(t3) {
        return Object.values(this.geometries).filter(function(e2) {
          return e2.address && e2.address.properties && e2.address.properties.name && e2.address.properties.name === t3;
        });
      } }, { key: "isMain", value: function() {
        return Boolean(this.properties.isMain);
      } }]), r2;
    }(), kt2 = function() {
      function o2(e2) {
        var t3 = this, n2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {}, r2 = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : [], i3 = 3 < arguments.length ? arguments[3] : void 0;
        u2(this, o2), this.venueModel = i3, this.levels = r2.map(function(e3) {
          return new Nt2(e3, t3);
        }), this.structure = e2, this.id = e2 && e2.id, this.properties = n2;
      }
      return l(o2, [{ key: "getId", value: function() {
        return this.structure && this.structure && this.structure.identifier;
      } }, { key: "getIdentifier", value: function() {
        return this.id;
      } }, { key: "getProperties", value: function() {
        return this.properties;
      } }, { key: "isRoot", value: function() {
        return Boolean(this.properties.is_root);
      } }, { key: "getDisplayName", value: function() {
        return this.properties.display_name || "";
      } }, { key: "getName", value: function() {
        return this.properties.name || "";
      } }, { key: "getBoundingBox", value: function() {
        if (this.structure && this.structure.geometry) {
          var e2 = g(O2.getBoundingBox(this.structure.geometry.type, this.structure.geometry.coordinates), 2), t3 = e2[0], e2 = e2[1];
          if (t3)
            return [e2[1], t3[0], t3[1], e2[0]];
        }
        return [null, null, null, null];
      } }, { key: "getCenter", value: function() {
        return this.structure && this.structure.location && this.structure.location.coordinates;
      } }, { key: "getGeometryById", value: function(t3) {
        return this.getGeometries().find(function(e2) {
          return e2.getId() === t3 || e2.getIdentifier() === t3;
        });
      } }, { key: "getGeometries", value: function() {
        return this.levels.flatMap(function(e2) {
          return e2.getGeometries();
        });
      } }, { key: "getLevelById", value: function(t3) {
        return this.levels.find(function(e2) {
          return e2.getId() === t3 || e2.getIdentifier() === t3;
        });
      } }, { key: "getLevelByZIndex", value: function(t3) {
        return this.levels.find(function(e2) {
          return e2.getZIndex() === t3;
        });
      } }, { key: "getLevels", value: function() {
        return this.levels;
      } }, { key: "getMainLevel", value: function() {
        return this.levels.find(function(e2) {
          return e2.isMain();
        });
      } }, { key: "getVenueModel", value: function() {
        return this.venueModel;
      } }]), o2;
    }(), wt2 = I.STANDARD, xt2 = function() {
      function t3(n2) {
        var r2 = this, e2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : new bt2();
        u2(this, t3), this.metaInformation_ = e2, this.momStructure = n2, this.id = n2 && n2.site && n2.site.id, this.location = n2 && n2.site && n2.site.location || {}, this.properties = n2 && n2.site && f2({}, n2.site.properties), this.drawings = n2 && n2.structure && Object.values(n2.structure).map(function(e3) {
          var t4 = n2.getStructureWiseGeometry(e3.id);
          return new kt2(e3, e3.properties, Object.values(t4), r2);
        });
      }
      return l(t3, [{ key: "getDisplaySettings", value: function() {
        return (this.metaInformation_.releaseSettings_ ? this.metaInformation_.releaseSettings_.displayOptions : "").display || wt2;
      } }, { key: "getId", value: function() {
        return this.momStructure && this.momStructure.site && this.momStructure.site.identifier;
      } }, { key: "getIdentifier", value: function() {
        return this.id;
      } }, { key: "getName", value: function() {
        return this.properties.name;
      } }, { key: "getBoundingBox", value: function() {
        if (this.momStructure) {
          var e2 = g(O2.getBoundingBox(this.momStructure.site.geometry.type, this.momStructure.site.geometry.coordinates), 2), t4 = e2[0], e2 = e2[1];
          if (t4)
            return [e2[1], t4[0], t4[1], e2[0]];
        }
        return [null, null, null, null];
      } }, { key: "getCenter", value: function() {
        return this.location.coordinates;
      } }, { key: "getGeometryById", value: function(t4) {
        return this.getGeometries().find(function(e2) {
          return e2.getId() === t4 || e2.getIdentifier() === t4;
        });
      } }, { key: "getGeometries", value: function() {
        return this.getLevels().sort(function(e2, t4) {
          return e2.getZIndex() - t4.getZIndex();
        }).flatMap(function(e2) {
          return e2.getGeometries();
        });
      } }, { key: "getGeometriesByLonLat", value: function(t4) {
        var n2 = this, e2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : [], r2 = !(2 < arguments.length && void 0 !== arguments[2]) || arguments[2], e2 = e2.map(function(e3) {
          return n2.getLevelById(e3);
        });
        return 0 === e2.length && (e2 = this.drawings.filter(function(e3) {
          e3 = e3.getBoundingBox();
          return O2.isPointInBoundingBox(t4, e3);
        }).flatMap(function(e3) {
          return e3.getLevels();
        })), w.getGeometriesByLonLat(t4, e2.flatMap(function(e3) {
          return e3.getGeometries(true);
        }), r2);
      } }, { key: "getDrawingById", value: function(t4) {
        return this.drawings.find(function(e2) {
          return e2.getId() === t4 || e2.getIdentifier() === t4;
        });
      } }, { key: "getDrawings", value: function() {
        return this.drawings;
      } }, { key: "getRootDrawing", value: function() {
        return this.drawings.find(function(e2) {
          return e2.isRoot();
        });
      } }, { key: "getLevelById", value: function(t4) {
        return this.getLevels().find(function(e2) {
          return e2.getId() === t4 || e2.getIdentifier() === t4;
        });
      } }, { key: "getLevelsByZIndex", value: function() {
        var t4 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : 0;
        return this.getLevels().filter(function(e2) {
          return Number(e2.getZIndex()) === Number(t4);
        });
      } }, { key: "getLevels", value: function() {
        return this.drawings.flatMap(function(e2) {
          return e2.getLevels();
        });
      } }, { key: "getMomStructure", value: function() {
        return this.momStructure;
      } }, { key: "getLevelMapFlattenedByZIndex_", value: function() {
        return this.getLevels().reduce(function(e2, t4) {
          var n2 = t4.getZIndex();
          return e2[n2] || (e2[n2] = []), e2[n2].push(t4), e2;
        }, {});
      } }, { key: "getOccupant", value: function() {
        var e2 = this.momStructure.occupant;
        return Object.values(e2);
      } }]), t3;
    }(), Pt2 = function() {
      function t3(e2) {
        u2(this, t3), this.theme = e2 && e2.theme, this.level = e2 && e2.level, this.site = e2 && e2.site, this.spaces = e2 && e2.spaces, this.address = e2 && e2.address, this.levelConnector = e2 && e2.levelConnector, this.topology = e2 && e2.topology, this.entrance = e2 && e2.entrance, this.occupant = e2 && e2.occupant, this.structure = e2 && e2.structure, this.spaceGroups = e2 && e2.spaceGroups, this.levelWiseGeometry = {}, this.levelStructureMapping = e2 && e2.levelStructureMapping, this.outdoorLevelMapping = e2 && e2.outdoorLevelMapping || {}, this.labelTextPreference = e2 && e2.labelTextPreference || null;
      }
      return l(t3, [{ key: "setSpaceWithLevel", value: function() {
        var r2 = this;
        this.spaces && Object.values(this.spaces).forEach(function(e2) {
          var t4 = "", n2 = (e2.addressId && (t4 = r2.address && r2.address[e2.addressId] && r2.address[e2.addressId].properties.addressName), e2.properties), t4 = (n2.addressName = t4, r2.getLabelAsPerPreference(f2(f2({}, e2), {}, { properties: n2 }))), n2 = e2.properties, t4 = (n2.name = t4, n2.display_name = t4, e2.properties.icon && (n2.name = e2.id, n2.display_name = e2.id), e2), n2 = (t4.properties = n2, t4.address = r2.address[e2.addressId], (r2.spaces[e2.id] = e2).levelId);
          r2.outdoorLevelMapping[n2] && (n2 = r2.outdoorLevelMapping[n2]), r2.levelWiseGeometry[n2] || (r2.levelWiseGeometry[n2] = {}), r2.levelWiseGeometry[n2][t4.id] = t4;
        });
      } }, { key: "setOccupantWithLevel", value: function() {
        var s2 = this;
        this.occupant && Object.values(this.occupant).forEach(function(i3) {
          var o2, a3;
          i3.spaceIds && i3.properties.occupantName && (o2 = [], a3 = [], i3.spaceIds.forEach(function(t4) {
            function n2(e3) {
              var t5 = false, t5 = (s2.labelTextPreference && s2.labelTextPreference.length && (t5 = -1 !== s2.labelTextPreference.indexOf("OCCUPANT_NAMES")), null === s2.labelTextPreference || t5), n3 = e3, r3 = e3.properties, t5 = (r3.name = e3.properties.icon || !t5 ? e3.properties.name : i3.properties.occupantName, r3.display_name = e3.properties.icon || !t5 ? e3.properties.display_name : i3.properties.occupantName, r3.address = e3.address, r3.occupantName = i3.properties.occupantName, e3.levelId);
              s2.outdoorLevelMapping[t5] && (t5 = s2.outdoorLevelMapping[t5]), s2.levelWiseGeometry[t5] || (s2.levelWiseGeometry[t5] = {}), s2.levelWiseGeometry[t5][e3.id] = n3, o2.push(n3), a3.push(e3.id);
            }
            var e2 = t4.id, e2 = s2.spaces[e2], r2 = null;
            s2.spaceGroups && Object.values(s2.spaceGroups).forEach(function(e3) {
              e3.properties.spaceGroups && e3.properties.spaceGroups && e3.properties.spaceGroups.forEach(function(e4) {
                e4.mainSpace && e4.mainSpace.id === t4.id && (r2 = e4.spaces.map(function(e5) {
                  return e5.id;
                }));
              });
            });
            r2 && 0 < r2.length && r2.forEach(function(e3) {
              n2(s2.spaces[e3]);
            }), e2 && n2(e2);
          }), s2.occupant[i3.id] = i3, s2.occupant[i3.id].space = o2, s2.occupant[i3.id].spaceIds = a3);
        });
      } }, { key: "setEntrance", value: function() {
        var n2 = this;
        this.entrance && Object.values(this.entrance).forEach(function(e2) {
          var t4 = e2.properties.level.id;
          n2.levelWiseGeometry[t4] || (n2.levelWiseGeometry[e2.properties.level.id] = {}), n2.outdoorLevelMapping[t4] && (t4 = n2.outdoorLevelMapping[t4]), n2.levelWiseGeometry[t4][e2.id] = e2;
        });
      } }, { key: "setLevelWiseGeometry", value: function() {
        var t4 = this;
        this.level && Object.keys(this.level).forEach(function(e2) {
          t4.levelWiseGeometry[e2] = {};
        }), this.setSpaceWithLevel(), this.setOccupantWithLevel(), this.setEntrance();
      } }, { key: "getStructureWiseGeometry", value: function(e2) {
        for (var t4 = {}, n2 = 0, r2 = Object.entries(this.levelWiseGeometry); n2 < r2.length; n2++) {
          var i3 = g(r2[n2], 2), o2 = i3[0], i3 = i3[1];
          e2 === this.levelStructureMapping[o2] && (t4[o2] = this.level[o2], t4[o2].features = i3);
        }
        return t4;
      } }, { key: "getLabelAsPerPreference", value: function(e2) {
        var e2 = e2.properties, t4 = e2.spaceType, n2 = e2.occupantName, r2 = e2.spaceName, i3 = e2.addressName, e2 = e2.spaceCategory, o2 = (c2(s2 = {}, Ze2, n2), c2(s2, We2, r2), c2(s2, Qe2, t4 ? t4.charAt(0).toUpperCase() + t4.slice(1).toLowerCase() : ""), c2(s2, qe2, e2 ? e2.charAt(0).toUpperCase() + e2.slice(1).toLowerCase() : ""), c2(s2, Ke2, i3), c2(s2, Je2, i3), c2(s2, Xe2, i3), s2), n2 = this.theme.spaceRules, a3 = "", r2 = e2 && t4 && n2[e2] && n2[e2].spaceTypes && n2[e2].spaceTypes[t4].behavioralAppearance.default.labelType;
        if ("NONE" === r2) {
          if (!this.labelTextPreference)
            return "";
          o2[Qe2] = "";
        }
        i3 = e2 && t4 && n2[e2] && n2[e2].properties && n2[e2].properties.behavioralAppearance && n2[e2].properties.behavioralAppearance.default && n2[e2].properties.behavioralAppearance.default.labelType;
        if (("NONE" === i3 || void 0 === i3) && void 0 === r2) {
          if (!this.labelTextPreference)
            return "";
          o2[Qe2] = "", o2[qe2] = "";
        }
        var s2 = e2 && t4 && n2[e2] && n2[e2].properties && n2[e2].properties.behavioralAppearance && n2[e2].properties.behavioralAppearance.default && n2[e2].properties.behavioralAppearance.default.labelTextPreference, u3 = s2 && this.labelTextPreference ? this.labelTextPreference : s2;
        if (u3) {
          for (var l2 = 0; l2 < u3.length; l2++)
            if (o2[u3[l2]]) {
              a3 = o2[u3[l2]];
              break;
            }
        }
        return a3;
      } }]), t3;
    }(), Ct2 = function() {
      function i3(e3) {
        var t3 = e3.apiKey, n2 = e3.baseUrl, r2 = e3.token, e3 = e3.hrn;
        u2(this, i3), this.hostOptions_ = { apiKey: t3, url: n2, token: r2, hrn: e3 }, this.momData = [], this.theme = {}, this.loadOptions = {};
      }
      var s2, e2;
      return l(i3, [{ key: "setHostOptions", value: function(e3) {
        0 !== Object.keys(e3).length && (this.hostOptions_ = f2(f2({}, this.hostOptions_), e3));
      } }, { key: "getToken", value: function() {
        return this.hostOptions_.token;
      } }, { key: "getHrn", value: function() {
        return this.hostOptions_.hrn;
      } }, { key: "load", value: function(e3) {
        var t3 = this, n2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {};
        return this.loadOptions = f2(f2(f2({}, ct2), n2), {}, { venueId: e3 }), this.hostOptions_.mapData = n2.mapData, this.hostOptions_.themeRule = n2.themeRule, this.hostOptions_.svgList = n2.svgList, this.hostOptions_.labelTextPreference = n2.labelTextPreferenceOverride, this.getHrn() ? this.getVenueModalInstance() : this.getToken() ? this.getDefaultCollectionWithToken().then(function() {
          return t3.getVenueModalInstance();
        }).catch(function() {
          return Promise.reject(new Error("Unable to find indoor map collection. Please contact your administrator"));
        }) : Promise.reject(new Error("In order to load indoor map, Please provide either hrn or token"));
      } }, { key: "getVenueModalInstance", value: function() {
        var t3 = this;
        return Promise.resolve().then(function() {
          return t3.loadOptions.isMetaEnabled ? t3.getMeta_(t3.loadOptions.isIconsEnabled).catch(function(e3) {
            return console.warn(e3), Promise.resolve();
          }) : Promise.reject();
        }).then(function(e3) {
          return t3.getVenue_(e3);
        }).then(function(e3) {
          return e3;
        }).catch(function(e3) {
          console.debug("Captured event VENUE_ERROR_STATE", e3);
        });
      } }, { key: "createMomStructure", value: function() {
        var r2 = this, i4 = { site: {}, structure: {}, level: {}, levelConnector: {}, occupant: {}, spaces: {}, spaceGroups: {}, topology: {}, address: {}, outdoorLevelMapping: {}, entrance: {}, levelStructureMapping: {} };
        return this.momData.forEach(function(e3) {
          var t3 = "indoormap-00000000-0000-4000-a000-".concat(r2.loadOptions.venueId.toString().padStart(12, "0")), n2 = e3.id;
          e3.momType !== Ue2 && !r2.hostOptions_.mapData && e3.properties.indoorMapId != r2.loadOptions.venueId && e3.properties.indoorMapId !== t3 || (e3.momType === Re2 ? i4.site = N2.setSite(e3, r2.loadOptions.venueId) : e3.momType === Ve2 ? i4.structure[n2] = N2.setStructure(e3) : e3.momType !== Fe2 || e3.properties.isOutdoor && (!e3.properties.isOutdoor || e3.properties.parentIndoorLevel) ? e3.momType === Fe2 && e3.properties.isOutdoor && e3.properties.parentIndoorLevel ? i4.outdoorLevelMapping[e3.id] = e3.properties.parentIndoorLevel.id : e3.momType === Ye2 ? i4.entrance[n2] = N2.setEntrance(e3) : e3.momType === He2 ? i4.occupant[n2] = N2.setOccupant(e3) : e3.momType === ze2 ? i4.spaces[n2] = N2.setSpace(e3) : e3.momType === Be2 ? i4.spaceGroups[n2] = N2.setSpaceGroups(e3) : e3.momType === Ue2 && (i4.address[n2] = N2.setAddress(e3)) : (i4.level[n2] = N2.setLevel(e3), i4.levelStructureMapping[n2] = e3.properties.structure.id));
        }), i4.theme = this.theme, i4.labelTextPreference = this.hostOptions_.labelTextPreference, new Pt2(i4);
      } }, { key: "getVenue_", value: function(e3) {
        this.momData = e3.getMomData();
        var t3 = this.createMomStructure();
        return t3.setLevelWiseGeometry(), new xt2(t3, e3);
      } }, { key: "setConfigData", value: function(e3) {
        var t3 = e3.themeRule, n2 = e3.svgList, e3 = e3.defaultLang;
        At2.setSpaceRules(t3.spaceRules), N2.svgList = n2, N2.themeRule = t3, N2.defaultLang = e3, this.theme = t3;
      } }, { key: "getMeta_", value: function() {
        var a3 = this, s3 = !(0 < arguments.length && void 0 !== arguments[0]) || arguments[0], u3 = new bt2(), e3 = this.hostOptions_.mapData ? {} : this.getMetaConfig_(this.loadOptions.venueId, m.SITE), t3 = this.hostOptions_.themeRule || this.getMetaConfig_(this.loadOptions.venueId, m.Theme), n2 = [];
        return s3 && (n2 = this.hostOptions_.svgList || this.getMetaConfig_(this.loadOptions.venueId, m.IMAGES)), new Promise(function(o2) {
          Promise.all([e3, t3, n2]).then(function(e4) {
            var e4 = g(e4, 3), t4 = e4[0], n3 = e4[1], r2 = e4[2], i4 = a3.hostOptions_.mapData ? { mom: new Promise(function(e5) {
              return e5(a3.hostOptions_.mapData);
            }), site: a3.hostOptions_.mapData.features.find(function(e5) {
              return e5.momType === Re2;
            }) } : k.getMomData(t4, a3.hostOptions_);
            i4.mom.then(function(e5) {
              var t5 = n3.properties;
              u3.imageCache = s3 ? N2.manageSvgDimensions(r2.properties) : [], a3.setConfigData({ themeRule: t5, svgList: u3.imageCache, defaultLang: i4 && i4.site && i4.site.properties.defaultLanguageCode }), u3.releaseSettings_ = { displayOptions: { display: t5.entranceRules.default.displayName || I.STANDARD }, mom: e5.features }, u3.theme = new Lt2(t5, u3), o2(u3);
            });
          });
        });
      } }, { key: "getMetaConfig_", value: function(e3, t3) {
        return k.getConfigUrl(e3, t3, this.hostOptions_);
      } }, { key: "fetchCollections", value: function() {
        return k.getDefaultCollection(this.hostOptions_);
      } }, { key: "fetchUserProjects", value: function() {
        return k.getProjectAccountDetails(this.hostOptions_);
      } }, { key: "getDefaultCollectionWithToken", value: (s2 = G().mark(function e3() {
        var n2 = this;
        return G().wrap(function(e4) {
          for (; ; )
            switch (e4.prev = e4.next) {
              case 0:
                return e4.abrupt("return", Promise.all([this.fetchCollections(), this.fetchUserProjects()]).then(function(e5) {
                  var e5 = g(e5, 2), t3 = e5[0], e5 = e5[1], t3 = n2.getHrnFromDefaultCollection(t3, e5);
                  return t3.hrn ? (e5 = { hrn: t3.hrn }, n2.setHostOptions(e5), Promise.resolve()) : Promise.reject();
                }).catch(function(e5) {
                  return Promise.reject(e5);
                }));
              case 1:
              case "end":
                return e4.stop();
            }
        }, e3, this);
      }), e2 = function() {
        var e3 = this, a3 = arguments;
        return new Promise(function(t3, n2) {
          var r2 = s2.apply(e3, a3);
          function i4(e4) {
            R2(r2, t3, n2, i4, o2, "next", e4);
          }
          function o2(e4) {
            R2(r2, t3, n2, i4, o2, "throw", e4);
          }
          i4(void 0);
        });
      }, function() {
        return e2.apply(this, arguments);
      }) }, { key: "getHrnFromDefaultCollection", value: function(e3, t3) {
        var n2, e3 = e3.results.items;
        return Array.isArray(e3) && e3.length ? (n2 = this.getProjectRealm(t3), e3.find(function(e4) {
          return e4.hrn.includes(n2);
        })) : Promise.reject(new Error("Error while accessing default collection"));
      } }, { key: "getProjectRealm", value: function(e3) {
        if (Array.isArray(e3.items) && e3.items.length && e3.items[0].id.includes("indoor-"))
          return e3 = e3.items[0].hrn, this.getRealmNameFromHrn(e3);
        return "";
      } }, { key: "getRealmNameFromHrn", value: function(e3) {
        return e3 ? (e3 = e3.split(":")).length && e3[4] : "";
      } }, { key: "getSupportedMapList", value: function() {
        var e3 = this, t3 = this.hostOptions_, n2 = t3.hrn, t3 = t3.token;
        return n2 ? this.fetchMapInfoList() : t3 ? this.getDefaultCollectionWithToken().then(function() {
          return e3.fetchMapInfoList();
        }).catch(function() {
          return Promise.reject(new Error("Unable to find indoor map collection. Please contact your administrator"));
        }) : Promise.reject(new Error("In order to load map list, Please provide either hrn or token"));
      } }, { key: "fetchMapInfoList", value: function() {
        var r2 = this;
        return k.fetchIndoorMapList(this.hostOptions_).then(function(e3) {
          e3 = e3.features;
          return 0 < e3.length ? e3.map(function(e4) {
            var e4 = e4.properties, t3 = e4.placeProperties, e4 = e4.indoorMapId, n2 = e4.split("-").pop(), n2 = n2.substring(n2.length - 5);
            return { mapIdentifier: e4, mapName: r2.getMapName(t3.names).name, mapId: n2 };
          }) : [];
        }).catch(function(e3) {
          Promise.reject(new Error("".concat(e3, ": Error while fetching map list")));
        });
      } }, { key: "getMapName", value: function(e3) {
        return Array.isArray(e3) && 0 < e3.length ? e3.find(function(e4) {
          return "OFFICIAL" === e4.nameType;
        }) : {};
      } }]), i3;
    }(), Dt2 = ["origin", "destination"], jt2 = function() {
      function t3() {
        var e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {};
        if (u2(this, t3), !e2.apiKey && !e2.token)
          throw new Error("API key or Token is missing");
        this.config_ = f2({ baseUrl: "https://meta-indoor-routing.api-gateway.ls.hereapi.com" }, e2);
      }
      return l(t3, [{ key: "calculateRoute", value: function(e2) {
        var t4 = e2.origin, t4 = void 0 === t4 ? {} : t4, n2 = e2.destination, n2 = void 0 === n2 ? {} : n2, e2 = Y2(e2, Dt2);
        if (!t4.coordinates || !n2.coordinates)
          throw new Error("Waypoint coordinates are missing");
        function r2(e3) {
          var t5 = e3.coordinates, n3 = e3.venueId, e3 = e3.levelId, t5 = t5.join(",");
          return n3 && e3 ? t5.concat(";indoorMapId=", n3, ";levelId=", e3) : t5;
        }
        var i3 = new URL("".concat(this.config_.baseUrl, "/v1/routes")), o2 = new URLSearchParams({ origin: r2(t4), destination: r2(n2), apiKey: this.config_.apiKey });
        return Object.entries(e2).forEach(function(e3) {
          var e3 = g(e3, 2), t5 = e3[0], e3 = e3[1];
          o2.append(t5, "object" === a2(e3) ? JSON.stringify(e3) : e3);
        }), i3.search = o2, fetch(i3, { headers: { "X-Api-Key": this.config_.apiKey } }).then(function(e3) {
          return e3.json();
        });
      } }]), t3;
    }(), x2 = { VENUE_DATA_LOADED: "VENUE_DATA_LOADED", VENUE_THEME_LOADED: "VENUE_THEME_LOADED", VENUE_ICONS_LOADED: "VENUE_ICONS_LOADED", VENUE_MOM_DATA_LOADED: "VENUE_MOM_DATA_LOADED", VENUE_ERROR_STATE: "VENUE_ERROR_STATE", VENUE_MAP_DATA_LOADED: "VENUE_MAP_DATA_LOADED", VENUE_ENTITY_DATA_LOADED: "VENUE_ENTITY_DATA_LOADED", VENUE_DATA_MODEL_LOADED: "VENUE_DATA_MODEL_LOADED", VENUE_NAV_DATA_LOADED: "VENUE_NAV_DATA_LOADED", META_DATA_LOADED: "META_DATA_LOADED", META_DATA_MODEL_LOADED: "META_DATA_MODEL_LOADED", META_DATA_MODEL_UPDATED: "META_DATA_MODEL_UPDATED" }, t2 = (Object.freeze((c2(n = {}, x2.VENUE_DATA_LOADED, { description: "event fired when all requested files along with metadata & overrides are loaded", emitTemplate: {} }), c2(n, x2.VENUE_MAP_DATA_LOADED, { description: "event fired when requested levels, drawings & community files are loaded", emitTemplate: {} }), c2(n, x2.VENUE_ENTITY_DATA_LOADED, { description: "event fired when requested entity data is loaded", emitTemplate: {} }), c2(n, x2.VENUE_DATA_MODEL_LOADED, { description: "event fired when a map file is loaded", emitTemplate: {} }), c2(n, x2.VENUE_NAV_DATA_LOADED, { description: "event fired when requested navigation product is loaded", emitTemplate: {} }), c2(n, x2.META_DATA_LOADED, { description: "event fired when all requested meta files are loaded except icon & marker", emitTemplate: {} }), c2(n, x2.META_DATA_MODEL_LOADED, { description: "event fired when a specific model is loaded except icon & marker", emitTemplate: {} }), c2(n, x2.META_DATA_MODEL_UPDATED, { description: "event fired when a specific meta override is added or removed", emitTemplate: {} }), c2(n, x2.VENUE_ICONS_LOADED, { description: "event fired when all icons of venue are loaded", emitTemplate: {} }), n)), new i2()), P2 = (t2.EVENT_NAME = x2, t2.on("newListener", function(e2) {
      x2[e2] || console.warn("subscribing for un-registered/documented event");
    }), function() {
      h(s2, H.map.Feature);
      var t3 = d(s2);
      function s2(e2) {
        var n2;
        if (u2(this, s2), n2 = t3.call(this), e2 instanceof xt2)
          return n2.venueModel = e2, n2.search_ = new Ge2(e2), n2.status_ = { activeDrawingId: e2.getRootDrawing().getIdentifier(), activeLevelIndex: e2.getRootDrawing().getMainLevel().getZIndex() }, n2.mapObjectStore_ = n2.getDefaultMapObjectsStore_(), n2.drawings = e2.getDrawings().map(function(e3) {
            e3 = new Q(e3);
            return e3.setParentEventTarget(Z2(n2)), e3;
          }), n2.levels = e2.getLevels().map(function(e3) {
            var t4 = new q(e3);
            return t4.setParentEventTarget(n2.drawings.find(function(e4) {
              return e4.getIdentifier() === t4.getData().getDrawing().getIdentifier();
            })), t4;
          }), n2.geometries = e2.getGeometries().map(function(e3) {
            var t4 = new X2(e3);
            return t4.setParentEventTarget(n2.levels.find(function(e4) {
              return e4.getIdentifier() === t4.getData().getLevel().getIdentifier();
            })), t4;
          }), n2.mutualExclusiveHighlight_ = false, n2;
        throw new Error("It is mandatory to provide valid instance of venueModel");
      }
      return l(s2, [{ key: "getData", value: function() {
        return this.venueModel;
      } }, { key: "getBoundingBox", value: function() {
        return F2(H.geo.Rect, v(this.venueModel.getBoundingBox()));
      } }, { key: "getCenter", value: function() {
        var e2 = g(this.venueModel.getCenter(), 2), t4 = e2[0], e2 = e2[1];
        return new H.geo.Point(e2, t4);
      } }, { key: "getId", value: function() {
        return this.venueModel.getId();
      } }, { key: "getIdentifier", value: function() {
        return this.venueModel.getIdentifier();
      } }, { key: "getName", value: function() {
        return this.venueModel.getName();
      } }, { key: "getDrawing", value: function(t4) {
        return this.drawings.find(function(e2) {
          return e2.getIdentifier() === t4;
        });
      } }, { key: "getDrawings", value: function() {
        return this.drawings;
      } }, { key: "getLevel", value: function(t4) {
        return this.levels.find(function(e2) {
          return e2.getIdentifier() === t4;
        });
      } }, { key: "getLevels", value: function() {
        return this.levels;
      } }, { key: "getGeometry", value: function(t4) {
        return this.getGeometries().find(function(e2) {
          return e2.getIdentifier() === t4;
        });
      } }, { key: "getGeometries", value: function() {
        return this.geometries;
      } }, { key: "getActiveLevels", value: function() {
        var t4 = this;
        return this.getData().getDisplaySettings() === I.FLATTEN ? this.venueModel.getLevelsByZIndex(this.status_.activeLevelIndex).map(function(e2) {
          return t4.getLevel(e2.getIdentifier());
        }) : [this.venueModel.getDrawingById(this.status_.activeDrawingId).getLevelByZIndex(this.status_.activeLevelIndex)].map(function(e2) {
          return t4.getLevel(e2.getIdentifier());
        });
      } }, { key: "getActiveDrawing", value: function() {
        return this.getDrawing(this.status_.activeDrawingId);
      } }, { key: "setActiveDrawing", value: function(e2) {
        if (this.status_.activeDrawingId !== e2) {
          var t4 = this.venueModel.getDrawingById(e2);
          if (!t4)
            throw new Error("Drawing ".concat(e2, " was not found"));
          var n2 = this.status_.activeDrawingId;
          this.status_.activeDrawingId = t4.id, this.setActiveLevelIndex(t4.getMainLevel().getZIndex()), this.dispatchEvent(new H.util.ChangeEvent(s2.EVENTS.DRAWING_CHANGE, e2, n2));
        }
      } }, { key: "getActiveLevelIndex", value: function() {
        return this.status_.activeLevelIndex;
      } }, { key: "setActiveLevelIndex", value: function(e2) {
        var t4;
        this.venueModel.getLevelsByZIndex(e2) && (t4 = this.status_.activeLevelIndex, this.status_.activeLevelIndex = e2, this.dispatchEvent(new H.util.ChangeEvent(s2.EVENTS.LEVEL_CHANGE, e2, t4)));
      } }, { key: "isActive", value: function() {
        var e2 = this.getParentEventTarget();
        return !!e2 && this === e2.activeVenue;
      } }, { key: "getHighlightedGeometries", value: function() {
        var t4 = this;
        return this.venueModel.getGeometries().filter(function(e2) {
          return e2.isHighlighted();
        }).map(function(e2) {
          return t4.getGeometry(e2.getIdentifier());
        });
      } }, { key: "setHighlightedGeometries", value: function() {
        var t4 = !(0 < arguments.length && void 0 !== arguments[0]) || arguments[0], e2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : [], n2 = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : {}, r2 = 3 < arguments.length && void 0 !== arguments[3] && arguments[3], n2 = f2(f2({}, Me2), n2), i3 = n2.fillColor, o2 = n2.outlineColor, a3 = n2.outlineWidth;
        this.mutualExclusiveHighlight_ = !!r2, this.mutualExclusiveHighlight_ && this.getHighlightedGeometries().forEach(function(e3) {
          e3.getData().highlight(false);
        }), e2.forEach(function(e3) {
          e3.getData().highlight(t4, { m: i3, o: o2, w: a3 });
        }), this.dispatchEvent(s2.EVENTS.GEOMETRY_HIGHLIGHT);
      } }, { key: "getMapObjects", value: function() {
        var e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : this.getActiveLevelIndex(), t4 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : this.getActiveDrawing();
        return this.mapObjectStore_[e2][t4.getIdentifier()];
      } }, { key: "setMapObjects", value: function() {
        var e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : [], t4 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : this.getActiveLevelIndex(), n2 = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : this.getActiveDrawing();
        this.mapObjectStore_[t4] && this.mapObjectStore_[t4][n2.getIdentifier()] && (this.mapObjectStore_[t4][n2.getIdentifier()] = v(e2)), this.updateMapObjectsVisibility_();
      } }, { key: "search", value: function() {
        var t4 = this;
        return this.search_.find(0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "").flatMap(function(e2) {
          return e2.geometries.map(function(e3) {
            return t4.getGeometry(e3.id);
          });
        });
      } }, { key: "updateMapObjectsVisibility_", value: function() {
        Object.values(this.mapObjectStore_).forEach(function(e2) {
          Object.values(e2).forEach(function(e3) {
            return e3.forEach(function(e4) {
              return e4.setVisibility(false);
            });
          });
        }), this.isActive() && this.mapObjectStore_[this.getActiveLevelIndex()][this.getActiveDrawing().getIdentifier()].forEach(function(e2) {
          return e2.setVisibility(true);
        });
      } }, { key: "getDefaultMapObjectsStore_", value: function() {
        var r2 = this, i3 = this.getData().getDisplaySettings() === I.FLATTEN;
        return this.venueModel.getLevels().reduce(function(e2, t4) {
          var n2 = t4.getZIndex(), e2 = f2({}, e2);
          return e2[n2] || (e2[n2] = {}), e2[n2][t4.getDrawing().getIdentifier()] = [], i3 && (e2[n2][r2.venueModel.getRootDrawing().getIdentifier()] = []), e2;
        }, {});
      } }]), s2;
    }()), C2 = (P2.EVENTS = { ACTIVE_VENUE_CHANGE: "activevenuechange", DRAWING_CHANGE: "drawingchange", LEVEL_CHANGE: "levelchange", GEOMETRY_HIGHLIGHT: "geometryhighlight" }, function() {
      function e2() {
        u2(this, e2);
      }
      return l(e2, null, [{ key: "getIconLayer", value: function() {
        return { type: "FeatureCollection", features: (0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : []).flatMap(function(e3) {
          return e3.getData().getGeometries();
        }).filter(function(e3) {
          return e3.isIcon() && e3.getIcon();
        }).map(function(e3) {
          var t3 = g(e3.getLabelArea(), 2), n2 = t3[0], t3 = t3[1], r2 = e3.getLevel(), i3 = e3.getIcon(), o2 = e3.properties.spaceType || e3.properties.spaceCategory || e3.getDisplayName();
          return { type: "Feature", properties: { id: e3.getIdentifier(), geometryId: e3.getIdentifier(), levelId: r2.getIdentifier(), name: o2, venueId: r2.getDrawing().getVenueModel().getIdentifier(), url: i3 ? "data:image/svg+xml;utf8,".concat(encodeURIComponent(i3)) : "" }, geometry: { type: y.POINT, coordinates: [n2, t3] } };
        }) };
      } }, { key: "getLabelLayer", value: function() {
        return { type: "FeatureCollection", features: (0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : []).flatMap(function(e3) {
          return e3.getData().getGeometries();
        }).filter(function(e3) {
          return e3.getDisplayName() && !e3.isIcon();
        }).map(function(e3) {
          var t3 = g(e3.getLabelArea(), 2), n2 = t3[0], t3 = t3[1], r2 = e3.getLabelStyle(), i3 = r2.fill, r2 = r2.zmin, o2 = e3.getLevel();
          return { type: "Feature", properties: { id: e3.getIdentifier(), geometryId: e3.getIdentifier(), levelId: o2.getIdentifier(), venueId: o2.getDrawing().getVenueModel().getIdentifier(), name: e3.getDisplayName(), minZoom: r2 || 15, textFillColor: i3.toLowerCase() }, geometry: { type: y.POINT, coordinates: [n2, t3] } };
        }) };
      } }, { key: "getGeometryLayer", value: function() {
        return { type: "FeatureCollection", features: (0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : []).flatMap(function(e3) {
          return e3.getData().getGeometries();
        }).filter(function(e3) {
          return e3.getType() !== y.POINT;
        }).map(function(e3) {
          var t3 = e3.getHighlightedStyle() || {}, n2 = t3.m, r2 = t3.o, t3 = t3.w, i3 = f2({}, e3.getStyle()), o2 = i3.m, a3 = i3.o, i3 = i3.w, s2 = _e, u3 = s2.fillColor, l2 = s2.outlineColor, s2 = s2.outlineWidth, c3 = e3.getLevel();
          return { type: "Feature", properties: { id: e3.getIdentifier(), fillColor: (n2 || o2 || u3).toLowerCase(), geometryId: e3.getIdentifier(), levelId: c3.getIdentifier(), venueId: c3.getDrawing().getVenueModel().getIdentifier(), outlineColor: (r2 || a3 || l2).toLowerCase(), outlineWidth: Number(((t3 || i3 || s2) / 3).toFixed(2)), zIndex: e3.getZIndex() }, geometry: { type: e3.getType(), coordinates: e3.getCoordinates() } };
        }) };
      } }, { key: "getFootprintLayer", value: function(e3) {
        return { type: "FeatureCollection", features: e3.flatMap(function(e4) {
          var t3 = e4.getData().getRootDrawing().getMainLevel().getIdentifier(), n2 = e4.getLevel(t3).getData().getGeometries().filter(function(e5) {
            return e5.getType() === y.POLYGON;
          });
          return [{ type: "Feature", properties: { isFootprint: true, levelId: t3, venueId: e4.getIdentifier(), zIndex: 1 }, geometry: { type: "MultiPolygon", coordinates: n2.map(function(e5) {
            return e5.getCoordinates();
          }) } }, { type: "Feature", properties: { isFootprint: true, levelId: t3, venueId: e4.getIdentifier(), zIndex: 2, venueName: e4.getName() }, geometry: { type: "Point", coordinates: e4.getCenter().toGeoJSON().coordinates.slice(0, 2) } }];
        }) };
      } }]), e2;
    }()), Gt2 = function() {
      function e2() {
        u2(this, e2);
      }
      return l(e2, null, [{ key: "getStyle", value: function() {
        var e3 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : [], t3 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : [], o2 = { styles: [{ layer: s.FOOTPRINT, when: ["==", ["geometry-type"], "Polygon"], technique: "solid-line", color: "#613F8E", lineWidth: "2px", renderOrder: 1 }, { layer: s.FOOTPRINT, when: ["==", ["geometry-type"], "Polygon"], technique: "fill", color: "#AF91B4", renderOrder: 2 }, { layer: s.FOOTPRINT, when: ["==", ["geometry-type"], "Point"], technique: "text", color: "black", size: 16, text: ["get", "venueName"], priority: 61 }, { layer: s.VECTOR, when: ["==", ["geometry-type"], "Polygon"], technique: "fill", color: ["get", "fillColor"], renderOrder: ["get", "zIndex"] }, { layer: s.VECTOR, technique: "solid-line", color: ["get", "outlineColor"], lineWidth: ["get", "outlineWidth"], renderOrder: ["get", "zIndex"] }, { layer: s.TEXT, minZoomLevel: ["get", "minZoom"], technique: "text", color: ["get", "textFillColor"], size: Se2.size, text: ["get", "name"], priority: 60 }, { layer: s.ICON, minZoomLevel: Le2, when: ["==", ["geometry-type"], "Point"], technique: "labeled-icon", textIsOptional: true, size: 0, imageTexture: ["concat", "texture", ["get", "name"]], screenWidth: ["interpolate", ["linear"], ["zoom"], 15, 3, 21, 70], screenHeight: ["interpolate", ["linear"], ["zoom"], 15, 3, 21, 70], priority: 61 }], images: {}, imageTextures: [] };
        return e3.forEach(function(e4) {
          var t4 = "texture" + e4.properties.name;
          o2.images[t4] || (o2.images[t4] = { url: e4.properties.url, preload: true }, o2.imageTextures.push({ name: t4, image: t4 }));
        }), t3.forEach(function(e4) {
          var t4, n2 = e4.getData().getHighlightedStyle(), r2 = n2.m, i3 = n2.o, n2 = n2.w;
          (t4 = o2.styles).push.apply(t4, [{ layer: s.VECTOR, when: ["==", ["get", "id"], e4.id], technique: "fill", color: r2, renderOrder: ["get", "zIndex"] }, { layer: s.VECTOR, when: ["==", ["get", "id"], e4.id], technique: "solid-line", color: i3, lineWidth: n2, renderOrder: ["get", "zIndex"] }]);
        }), new H.map.render.harp.Style(o2);
      } }]), e2;
    }(), Rt2 = function() {
      function r2() {
        u2(this, r2);
      }
      return l(r2, null, [{ key: "getIconsTextures", value: function() {
        var i3 = {}, o2 = {}, a3 = (0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : []).reduce(function(e2, t3) {
          var n2 = t3.properties.name;
          return e2[n2] || (e2[n2] = []), e2[n2].push(t3), e2;
        }, {});
        return Object.keys(a3).forEach(function(e2) {
          var t3 = "texture".concat(e2), n2 = "sprite".concat(e2), r3 = a3[e2][0].properties.url;
          i3[t3] = { url: r3, sprites: c2({}, n2, [0, 0, 50, 50]) }, a3[e2].forEach(function(e3) {
            e3 = e3.properties;
            o2["icon".concat(e3.name)] = { filter: { name: e3.name, $zoom: { min: Le2 } }, draw: { points: { interactive: true, priority: 1, size: [[15, "50%"], [16, "55%"], [17, "60%"], [18, "65%"], [19, "75%"], [20, "80%"], [21, "100%"]], texture: t3, sprite: n2 } } };
          });
        }), { textures: i3, iconLayers: o2 };
      } }, { key: "getFootprintLayer", value: function() {
        return { data: { source: "venues", layer: s.FOOTPRINT }, draw: { polygons: { interactive: true, color: "#AF91B4", order: 2 }, lines: { color: "#613F8E", width: "2px", order: 1 }, points: { color: "[0, 0, 0, 0]", size: "0px", order: 3, priority: 1, text: { anchor: "center", collide: false, font: { fill: "black", size: "16px" }, text_source: "function() { return feature.venueName }" } } } };
      } }, { key: "getGeometryLayer", value: function() {
        var e2, t3, n2, r3 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : [], i3 = {};
        return r3.length && (e2 = (n2 = r3[0].getData().getHighlightedStyle()).m, t3 = n2.o, n2 = n2.w, i3 = { filter: { id: r3.map(function(e3) {
          return e3.id;
        }) }, draw: { polygons: { interactive: true, color: e2 }, lines: { color: t3, width: n2 } } }), { data: { source: "venues", layer: s.VECTOR }, draw: { polygons: { interactive: true, color: "function() { return feature.fillColor }", order: "function() { return feature.zIndex }" }, lines: { color: "function() { return feature.outlineColor }", order: "function() { return feature.zIndex }", width: "function() { return feature.outlineWidth }" } }, highlighted: i3 };
      } }, { key: "getTextLayer", value: function() {
        return { filter: { $zoom: { min: be2 } }, data: { source: "venues", layer: s.TEXT }, draw: { points: { filter: "function() { return $zoom > feature.minZoom }", color: "[0, 0, 0, 0]", size: "0px", offset: ["0px", "-10px"], priority: 2, text: { font: { fill: "function() { return feature.textFillColor }", size: Se2.size }, text_source: "function() { return feature.name }" } } } };
      } }, { key: "getIconLayer", value: function(e2) {
        return f2({ data: { source: "venues", layer: s.ICON } }, e2);
      } }, { key: "getStyle", value: function() {
        var e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : [], t3 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : [], e2 = r2.getIconsTextures(e2), n2 = e2.textures, e2 = e2.iconLayers, t3 = { venue_footprints: r2.getFootprintLayer(), venue_geometries: r2.getGeometryLayer(t3), venue_labels: r2.getTextLayer(), venue_icons: r2.getIconLayer(e2) }, e2 = H.gl.yaml.safeDump({ sources: { venues: { max_zoom: Te2, type: "GeoJSONTileSource" } }, layers: t3, textures: n2 });
        return new H.map.render.webgl.Style(e2);
      } }]), r2;
    }(), Vt2 = { type: "FeatureCollection", features: [] }, Ht2 = { extent: 4096, indexMaxZoom: 0, maxZoom: 24, tolerance: 3 }, n = function() {
      h(n2, H.map.provider.RemoteTileProvider);
      var t3 = d(n2);
      function n2(e2) {
        return u2(this, n2), (e2 = t3.call(this, e2)).venues = [], e2.activeVenue = null, e2.dataLayers_ = {}, e2.tileIndexes_ = {}, e2.addEventListener(P2.EVENTS.ACTIVE_VENUE_CHANGE, e2.activeVenueChangeHandler_, void 0, Z2(e2)), e2;
      }
      return l(n2, [{ key: "setStyle", value: function(e2) {
        return this.setStyleInternal(e2);
      } }, { key: "getStyle", value: function() {
        return this.getStyleInternal();
      } }, { key: "isFeatureVisible_", value: function(e2, t4) {
        var n3 = e2.properties;
        return this.activeVenue && n3.venueId === this.activeVenue.getIdentifier() ? t4 !== s.FOOTPRINT && this.activeVenue.getActiveLevels().some(function(e3) {
          return e3.id === n3.levelId;
        }) : true === n3.isFootprint && t4 === s.FOOTPRINT;
      } }, { key: "requestInternal", value: function(s2, u3, l2, e2) {
        function c3(e3) {
          for (var t4 = 0; t4 < e3.length; t4 += 1)
            e3[t4] = e3[t4].map(function(e4) {
              return Ee2(e4, l2, s2, u3, Ht2.extent);
            });
        }
        var h2 = this, d2 = {};
        return Object.keys(this.tileIndexes_).forEach(function(t4) {
          var e3 = h2.tileIndexes_[t4].getTile(l2, s2, u3);
          d2[t4] = e3 ? Ie2(e3) : Vt2, d2[t4].features = d2[t4].features.filter(function(e4) {
            return h2.isFeatureVisible_(e4, t4);
          });
          for (var n3 = 0; n3 < d2[t4].features.length; n3 += 1) {
            var r2 = d2[t4].features[n3], i3 = r2.geometry.type;
            if (i3 === y.POLYGON || i3 === y.MULTI_LINESTRING)
              c3(r2.geometry.coordinates);
            else if (i3 === y.MULTI_POLYGON)
              r2.geometry.coordinates.map(c3);
            else
              for (var o2 = r2.geometry.coordinates, a3 = 0; a3 < o2.length; a3 += 1)
                o2[a3] = Ee2(o2[a3], l2, s2, u3, Ht2.extent);
          }
        }), e2(d2), { cancel: function() {
        } };
      } }, { key: "getActiveVenue", value: function() {
        return this.activeVenue;
      } }, { key: "getVenue", value: function(t4) {
        return t4 ? this.venues.find(function(e2) {
          return e2.getIdentifier() === t4;
        }) : this.activeVenue;
      } }, { key: "setActiveVenue", value: function(e2) {
        var t4 = this.activeVenue;
        this.activeVenue = e2, this.dispatchEvent(new H.util.ChangeEvent(P2.EVENTS.ACTIVE_VENUE_CHANGE, e2, t4)), this.reload();
      } }, { key: "addVenue", value: function(e2) {
        var t4 = 1 < arguments.length && void 0 !== arguments[1] && arguments[1];
        if (!(e2 instanceof P2))
          throw new Error("Invalid argument");
        var n3 = e2.getIdentifier();
        if (this.getVenue(n3))
          throw new Error("Please invoke provider.removeVenue to remove old instance of venue ".concat(n3, " before adding new"));
        e2.setParentEventTarget(this), this.venues.push(e2), t4 || (this.reloadData_(), this.reloadStyle_());
      } }, { key: "addVenues", value: function() {
        var t4 = this, e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : [];
        0 < e2.length && (e2.forEach(function(e3) {
          e3 instanceof P2 && t4.addVenue(e3, true);
        }), this.reloadData_(), this.reloadStyle_());
      } }, { key: "removeVenue", value: function(e2) {
        var t4;
        e2 instanceof P2 && -1 < this.venues.indexOf(e2) && (t4 = e2.getIdentifier(), this.activeVenue && this.activeVenue.getIdentifier() === t4 && this.setActiveVenue(null), this.venues.splice(this.venues.indexOf(e2), 1), this.reloadData_(), this.reloadStyle_(), this.reload());
      } }, { key: "getFeatureProxy", value: function(e2, t4, n3) {
        var r2 = e2.geometryId, e2 = e2.venueId, e2 = this.getVenue(e2);
        return r2 ? n3(e2.getGeometries().find(function(e3) {
          return e3.id === r2;
        })) : e2 && n3(e2), true;
      } }, { key: "addVenueEventListeners_", value: function(e2) {
        e2 && (e2.addEventListener(P2.EVENTS.GEOMETRY_HIGHLIGHT, this.geometryHighlightHandler_, void 0, this), e2.addEventListener(P2.EVENTS.LEVEL_CHANGE, this.levelChangeHandler_, void 0, this), e2.addEventListener(P2.EVENTS.DRAWING_CHANGE, this.drawingChangeHandler_, void 0, this));
      } }, { key: "removeVenueEventListeners_", value: function(e2) {
        e2 && (e2.removeEventListener(P2.EVENTS.GEOMETRY_HIGHLIGHT, this.geometryHighlightHandler_, void 0, this), e2.removeEventListener(P2.EVENTS.LEVEL_CHANGE, this.levelChangeHandler_, void 0, this), e2.removeEventListener(P2.EVENTS.DRAWING_CHANGE, this.drawingChangeHandler_, void 0, this));
      } }, { key: "activeVenueChangeHandler_", value: function(e2) {
        var t4 = e2.oldValue, e2 = e2.newValue;
        t4 && (this.removeVenueEventListeners_(t4), t4.updateMapObjectsVisibility_()), e2 && (this.addVenueEventListeners_(e2), e2.updateMapObjectsVisibility_());
      } }, { key: "drawingChangeHandler_", value: function() {
        this.reload();
      } }, { key: "levelChangeHandler_", value: function() {
        this.activeVenue && (this.activeVenue.updateMapObjectsVisibility_(), this.reload());
      } }, { key: "geometryHighlightHandler_", value: function() {
        this.reloadStyle_(this.activeVenue.getHighlightedGeometries());
      } }, { key: "createDataLayers_", value: function() {
        var t4 = this, e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : Object.keys(s), n3 = s.FOOTPRINT, r2 = s.ICON, i3 = s.TEXT, o2 = s.VECTOR;
        e2.forEach(function(e3) {
          switch (e3) {
            case o2:
              t4.dataLayers_[o2] = C2.getGeometryLayer(t4.venues);
              break;
            case n3:
              t4.dataLayers_[n3] = C2.getFootprintLayer(t4.venues);
              break;
            case r2:
              t4.dataLayers_[r2] = C2.getIconLayer(t4.venues);
              break;
            case i3:
              t4.dataLayers_[i3] = C2.getLabelLayer(t4.venues);
              break;
            default:
              throw new Error("Unsupported Layer ".concat(e3));
          }
        });
      } }, { key: "createTileIndexes_", value: function() {
        var t4 = this;
        (0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : Object.keys(s)).forEach(function(e2) {
          t4.tileIndexes_[e2] = new r(t4.dataLayers_[e2], Ht2);
        });
      } }, { key: "reloadData_", value: function() {
        var e2 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : Object.keys(s);
        this.createDataLayers_(e2), this.createTileIndexes_(e2);
      } }, { key: "reloadStyle_", value: function(e2) {
        var t4 = this.dataLayers_[s.ICON] ? this.dataLayers_[s.ICON].features : [];
        this.getEngineType() === H.Map.EngineType.WEBGL ? this.setStyle(Rt2.getStyle(t4, e2)) : this.getEngineType() === H.Map.EngineType.HARP && this.setStyle(Gt2.getStyle(t4, e2));
      } }, { key: "providesGeoJSON", value: function() {
        return true;
      } }]), n2;
    }(), zt2 = new H.map.SpatialStyle({ strokeColor: "#1ab4bf", lineWidth: 3 }), Bt2 = new H.map.SpatialStyle({ strokeColor: "#1ab4bf", lineWidth: 3 }), Ut2 = new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImIiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PG1hc2sgaWQ9ImMiIHdpZHRoPSIzOCIgaGVpZ2h0PSI0NiIgeD0iMCIgeT0iMCIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZWxsaXBzZSBjeD0iMjAiIGN5PSI0NS4xNiIgZmlsbD0iI0ZGRiIgc3Ryb2tlPSIjOTc5Nzk3IiBzdHJva2Utd2lkdGg9Ii4yNSIgcng9IjMuNSIgcnk9IjMuNSIvPjx1c2UgZmlsbD0iIzAxQjZCMiIgeGxpbms6aHJlZj0iI2IiLz48cGF0aCBmaWxsPSIjMzIzMjMyIiBmaWxsLW9wYWNpdHk9Ii41IiBkPSJNMTEuODEgMzcuNjZoMTYuMzhsLTguMiA4eiIvPjx1c2Ugc3Ryb2tlPSIjNDE2QTg2IiBzdHJva2Utd2lkdGg9Ii41IiBtYXNrPSJ1cmwoI2MpIiB4bGluazpocmVmPSIjYSIvPjxlbGxpcHNlIGN4PSIxOS44MSIgY3k9IjE5LjE5IiBmaWxsPSIjRkZGIiByeD0iNC44MSIgcnk9IjQuODEiLz48L2c+PC9zdmc+"), Ft2 = new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzMi44MyAzMy4xMDRjLjQwNy0uMzc0IDEuNDE5LTEuNDUyIDEuNDE5LTEuNDUyeiIvPjxtYXNrIGlkPSJjIiB3aWR0aD0iMzgiIGhlaWdodD0iNDYiIHg9IjAiIHk9IjAiIGZpbGw9IiNmZmYiPjx1c2UgeGxpbms6aHJlZj0iI2EiLz48L21hc2s+PGVsbGlwc2UgaWQ9ImIiIGN4PSIxOS44MDciIGN5PSIxOS4xNjgiIHJ4PSIxMi4zNjMiIHJ5PSIxMi4xOTciLz48bWFzayBpZD0iZCIgd2lkdGg9IjI1LjcyNSIgaGVpZ2h0PSIyNS4zOTQiIHg9Ii0uNSIgeT0iLS41Ij48cGF0aCBmaWxsPSIjZmZmIiBkPSJNNi45NDQgNi40NzFoMjUuNzI1djI1LjM5NEg2Ljk0NHoiLz48dXNlIHhsaW5rOmhyZWY9IiNiIi8+PC9tYXNrPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxlbGxpcHNlIGN4PSIyMCIgY3k9IjQ1LjE2IiBmaWxsPSIjRkZGIiBzdHJva2U9IiM5Nzk3OTciIHN0cm9rZS13aWR0aD0iLjI1IiByeD0iMy41IiByeT0iMy41Ii8+PHVzZSBmaWxsPSIjMzIzMjMyIiB4bGluazpocmVmPSIjYSIvPjxwYXRoIGZpbGw9IiM3RDdEN0QiIGQ9Ik0xMi4wMTEgMzcuODA1aDE1Ljk3OGwtNy45MTYgOHoiLz48dXNlIHN0cm9rZT0iIzdDN0M3QyIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNlKSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIHN0cm9rZT0iI0ZGRiIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNjKSIgeGxpbms6aHJlZj0iI2EiLz48ZWxsaXBzZSBmaWxsPSIjRkZGIiBjeD0iMTkuODA3IiBjeT0iMTkuMTY4IiByeD0iMTIuMzYzIiByeT0iMTIuMTk3Ii8+PHBhdGggZmlsbD0iIzMyMzIzMiIgZD0iTTYuODEyIDYuOTQ4aDYuNDV2Ni4zNjRoLTYuNDV6bTAgMTIuNzI3aDYuNDV2Ni4zNjRoLTYuNDV6bTYuNDUtNi4zNjNoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS0xOS4wOTFoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS02LjM2M2g2LjQ1djYuMzY0aC02LjQ1em0wIDEyLjcyN2g2LjQ1djYuMzY0aC02LjQ1eiIvPjx1c2Ugc3Ryb2tlPSIjRkZGIiBtYXNrPSJ1cmwoI2QpIiB4bGluazpocmVmPSIjYiIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIvPjwvZz48L3N2Zz4="), Yt2 = function() {
      function p3(e2, t3) {
        u2(this, p3), this.indoorMapObjects_ = null, this.outdoorMapObjects_ = null, this.createRouteObjects_(e2, t3);
      }
      return l(p3, [{ key: "createRouteObjects_", value: function(e2) {
        for (var c3 = this, e2 = e2.sections, h2 = void 0 === e2 ? [] : e2, d2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : vt2, t3 = (this.indoorMapObjects_ = {}, this.outdoorMapObjects_ = new H.map.Group(), function(e3) {
          var n3, t4 = h2[e3], r2 = t4.departure.place, i3 = r2.id, r2 = r2.type, o2 = H.util.flexiblePolyline.decode(t4.polyline).polyline, a3 = void 0, s2 = void 0, u3 = d2(e3, h2, p3.ObjectType.SEGMENT_START_MARKER), u3 = (u3 && (a3 = new H.map.Marker(t4.departure.place.location, { icon: u3 })), d2(e3, h2, p3.ObjectType.SEGMENT_FINISH_MARKER)), l2 = (u3 && (s2 = new H.map.Marker(t4.arrival.place.location, { icon: u3 })), d2(e3, h2, p3.ObjectType.SEGMENT_POLYLINE));
          "indoor" === r2 ? (u3 = function() {
            var e4 = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : [], t5 = /* @__PURE__ */ new Map(), n4 = new H.geo.LineString(), r3 = g(e4[0], 3)[2];
            return t5.set(r3, [n4]), e4.forEach(function(e5) {
              e5[2] !== r3 && (r3 = e5[2], n4 = new H.geo.LineString(), t5.has(r3) ? t5.get(r3).push(n4) : t5.set(r3, [n4])), n4.pushLatLngAlt.apply(n4, v(e5));
            }), t5;
          }(o2), n3 = Array.from(u3.keys()).reduce(function(e4, t5) {
            return e4[t5] || (e4[t5] = new H.map.Group()), e4;
          }, {}), l2 && u3.forEach(function(e4, t5) {
            e4.forEach(function(e5) {
              1 < e5.getPointCount() && (e5 = new H.map.Polyline(e5, { style: l2 }), n3[t5].addObject(e5));
            });
          }), a3 && n3[t4.departure.place.location.lvl].addObject(a3), s2 && n3[t4.arrival.place.location.lvl].addObject(s2), c3.indoorMapObjects_[i3] = f2(f2({}, c3.indoorMapObjects_[i3] || {}), n3)) : (l2 && (e3 = new H.geo.LineString(o2.flatMap(function(e4) {
            return [e4[0], e4[1], 0];
          })), r2 = new H.map.Polyline(e3, { style: l2 }), c3.outdoorMapObjects_.addObject(r2)), a3 && c3.outdoorMapObjects_.addObject(a3), s2 && c3.outdoorMapObjects_.addObject(s2));
        }), n2 = 0; n2 < h2.length; n2++)
          t3(n2);
      } }, { key: "getIndoorObjects", value: function() {
        return this.indoorMapObjects_;
      } }, { key: "getOutdoorObjects", value: function() {
        return this.outdoorMapObjects_;
      } }]), p3;
    }(), Zt2 = (Yt2.ObjectType = { SEGMENT_START_MARKER: 1, SEGMENT_FINISH_MARKER: 2, SEGMENT_POLYLINE: 3 }, function() {
      h(a3, H.service.Service);
      var o2 = d(a3);
      function a3(e2) {
        u2(this, a3), t3 = o2.call(this, a3, f2(f2({}, e2), {}, { baseUrl: void 0 }));
        var t3, n2 = { apiKey: e2.apikey, baseUrl: e2.baseUrl, token: e2.token }, r2 = { apiKey: n2.apiKey, token: n2.token }, i3 = (n2.apiKey || (n2.apiKey = t3.getUrl().getQuery().apikey), e2.useLegacy || false);
        return t3.venueService_ = new Ct2(n2, i3), r2.apiKey || (r2.apiKey = t3.getUrl().getQuery().apikey), e2.routingBaseUrl && (r2.baseUrl = e2.routingBaseUrl), t3.routingService_ = new jt2(r2), t3;
      }
      return l(a3, [{ key: "loadVenue", value: function(e2) {
        return console.warn("Venue service version 1 is no longer supported hence " + e2 + " could not be loaded"), Promise.resolve();
      } }, { key: "calculateRoute", value: function(e2) {
        return console.warn("HERE Indoor Routing is deprecated and will be removed soon."), this.routingService_.calculateRoute(e2);
      } }]), a3;
    }()), Wt2 = (Zt2.CONFIG_KEY = "venues", function() {
      h(i3, H.service.Service);
      var r2 = d(i3);
      function i3(e2) {
        u2(this, i3), t3 = r2.call(this, i3, f2(f2({}, e2), {}, { baseUrl: void 0 }));
        var t3, n2 = { apiKey: e2.apikey, baseUrl: e2.baseUrl, token: e2.token, hrn: e2.hrn }, e2 = (n2.apiKey || (n2.apiKey = t3.getUrl().getQuery().apikey), e2.useLegacy || false);
        return t3.venueService_ = new Ct2(n2, e2), t3;
      }
      return l(i3, [{ key: "loadVenue", value: function(e2) {
        return this.venueService_.load(e2, 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {}).then(function(e3) {
          return new P2(e3);
        });
      } }, { key: "getMapInfoList", value: function() {
        return this.venueService_.getSupportedMapList();
      } }]), i3;
    }()), t2 = (Wt2.CONFIG_KEY = "indoorMaps", H.service.Platform.prototype.getVenuesService = function(e2, t3) {
      var n2 = Wt2;
      return 1 !== t3 && t3 ? t3 !== Ae2.v2 || e2.token || (e2.hrn ? e2.apikey || console.error("Venue Service version 2 requires either apikey or token") : console.error("Token is mandatory when Hrn is not provided in Venue Service version 2")) : (console.warn("Venue service version 1 is no longer supported"), n2 = Zt2), this.createService(n2, e2);
    }, Wt2.LABEL_TEXT_PREFERENCE_OVERRIDE = { OCCUPANT_NAMES: "OCCUPANT_NAMES", SPACE_NAME: "SPACE_NAME", SPACE_TYPE_NAME: "SPACE_TYPE_NAME", SPACE_CATEGORY_NAME: "SPACE_CATEGORY_NAME", INTERNAL_ADDRESS: "INTERNAL_ADDRESS" }, function() {
      h(i3, H.ui.Control);
      var r2 = d(i3);
      function i3(e2) {
        var t3, n2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {};
        return u2(this, i3), (t3 = r2.call(this)).provider_ = null, t3.levelSelectorUI_ = null, t3.setAlignment(n2 && n2.alignment || H.ui.LayoutAlignment.RIGHT_BOTTOM), t3.addClass("venues-ui"), e2 instanceof P2 && t3.setVenue(e2), t3;
      }
      return l(i3, [{ key: "renderInternal", value: function(e2, t3) {
        W2(o(i3.prototype), "renderInternal", this).call(this, e2, t3), this.createLevelSelectorUI_(e2), this.venue && this.setVenue(this.venue);
      } }, { key: "setVenue", value: function(e2) {
        e2 instanceof P2 && (this.removeEventListeners_(), this.venue = e2, this.provider_ = e2.getParentEventTarget(), this.update_(), this.addEventListeners_());
      } }, { key: "createLevelSelectorUI_", value: function(e2) {
        var t3 = this;
        e2.innerHTML = "", this.levelSelectorUI_ = null;
        this.levelSelectorUI_ = new Mt2(e2, null, null, function(e3) {
          return t3.venue.setActiveLevelIndex(e3);
        });
      } }, { key: "update_", value: function() {
        var e2, t3;
        this.levelSelectorUI_ && (e2 = this.venue.getActiveDrawing().getData(), t3 = this.venue.getData().getDisplaySettings(), this.levelSelectorUI_.update(e2, t3), this.levelChangeHandler_());
      } }, { key: "addEventListeners_", value: function() {
        this.venue && (this.venue.addEventListener(P2.EVENTS.LEVEL_CHANGE, this.levelChangeHandler_, void 0, this), this.venue.addEventListener(P2.EVENTS.DRAWING_CHANGE, this.drawingChangeHandler_, void 0, this)), this.provider_ && this.provider_.addEventListener(P2.EVENTS.ACTIVE_VENUE_CHANGE, this.activeVenueChangeHandler_, void 0, this);
      } }, { key: "removeEventListeners_", value: function() {
        this.venue && (this.venue.removeEventListener(P2.EVENTS.LEVEL_CHANGE, this.levelChangeHandler_, void 0, this), this.venue.removeEventListener(P2.EVENTS.DRAWING_CHANGE, this.drawingChangeHandler_, void 0, this)), this.provider_ && this.provider_.removeEventListener(P2.EVENTS.ACTIVE_VENUE_CHANGE, this.activeVenueChangeHandler_, void 0, this);
      } }, { key: "levelChangeHandler_", value: function() {
        this.levelSelectorUI_.switch(this.venue.getActiveLevelIndex());
      } }, { key: "drawingChangeHandler_", value: function() {
        this.update_();
      } }, { key: "activeVenueChangeHandler_", value: function(e2) {
        this.setVenue(e2.newValue);
      } }]), i3;
    }()), Kt2 = function() {
      h(i3, H.ui.Control);
      var r2 = d(i3);
      function i3(e2) {
        var t3, n2 = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {};
        return u2(this, i3), (t3 = r2.call(this)).provider_ = null, t3.drawingSelectorUI_ = null, t3.addClass("venues-ui"), t3.setAlignment(n2 && n2.alignment || H.ui.LayoutAlignment.RIGHT_BOTTOM), e2 instanceof P2 && t3.setVenue(e2), t3;
      }
      return l(i3, [{ key: "renderInternal", value: function(e2, t3) {
        W2(o(i3.prototype), "renderInternal", this).call(this, e2, t3), this.createDrawingSelectorUI_(e2), this.venue && this.setVenue(this.venue);
      } }, { key: "setVenue", value: function(e2) {
        e2 instanceof P2 && (this.removeEventListeners_(), this.venue = e2, this.provider_ = e2.getParentEventTarget(), this.drawingSelectorUI_ && this.drawingSelectorUI_.update(e2.getData()), this.addEventListeners_());
      } }, { key: "createDrawingSelectorUI_", value: function(e2) {
        var t3 = this;
        e2.innerHTML = "", this.drawingSelectorUI_ = null, this.drawingSelectorUI_ = new It2(e2, null, function(e3) {
          return t3.venue.setActiveDrawing(e3);
        });
      } }, { key: "addEventListeners_", value: function() {
        this.venue && this.venue.addEventListener(P2.EVENTS.DRAWING_CHANGE, this.drawingChangeHandler_, void 0, this), this.provider_ && this.provider_.addEventListener(P2.EVENTS.ACTIVE_VENUE_CHANGE, this.activeVenueChangeHandler_, void 0, this);
      } }, { key: "removeEventListeners_", value: function() {
        this.venue && this.venue.removeEventListener(P2.EVENTS.DRAWING_CHANGE, this.drawingChangeHandler_, void 0, this), this.provider_ && this.provider_.removeEventListener(P2.EVENTS.ACTIVE_VENUE_CHANGE, this.activeVenueChangeHandler_, void 0, this);
      } }, { key: "drawingChangeHandler_", value: function() {
        this.drawingSelectorUI_.switch(this.venue.getActiveDrawing().id);
      } }, { key: "activeVenueChangeHandler_", value: function(e2) {
        this.setVenue(e2.newValue);
      } }]), i3;
    }(), Kt2 = Object.freeze({ __proto__: null, DrawingControl: Kt2, LevelControl: t2 });
    return D2(`.venues-ui * {
  font-family: "Fira Sans", "Helvetica Neue", Helvetica, sans-serif;
  color: #0F1621;
}
.venues-ui .arrow {
  display: block;
  width: 100%;
  height: 100%;
  background-repeat: no-repeat;
  background-position: center;
}
.venues-ui .arrow--up {
  background-image: url("data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-426.000000, -584.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls-Copy' transform='translate(417.753906, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(15.000000, 16.499023) rotate(-180.000000) translate(-15.000000, -16.499023) translate(9.000000, 12.749023)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
.venues-ui .arrow--down {
  background-image: url("data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-347.000000, -704.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls' transform='translate(338.251953, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(9.000000, 132.746094)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
.venues-ui .venues-ui-button {
  display: block;
  width: 40px;
  height: 40px;
  line-height: 40px;
  font-size: 16px;
  font-weight: 600;
  background-color: #fff;
  border: none;
  border-bottom: 1px solid #9FA2A6;
  cursor: pointer;
  overflow: hidden;
  color: #6e737a;
  text-align: center;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.venues-ui .venues-ui-button:hover, .venues-ui .venues-ui-button--active {
  background-color: #f0f0f0;
  color: #0F1621;
}
@keyframes fade {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}
.venues-ui__drawings .drawings {
  position: absolute;
  top: 0;
  right: 45px;
  display: none;
  opacity: 0;
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__drawings .drawings--open {
  display: block;
  opacity: 1;
  animation: fade 1s;
}
.venues-ui__drawings .drawings .venues-ui-button {
  width: auto;
  padding: 0 10px;
}
.venues-ui__drawings .drawings .venues-ui-button:first-of-type {
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
}
.venues-ui__drawings .drawings .venues-ui-button:last-of-type {
  border-bottom-left-radius: 5px;
  border-bottom-right-radius: 5px;
}
.venues-ui__drawings .trigger {
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__drawings .trigger .arrow {
  transform: rotate(0);
  transition: 0.4s;
}
.venues-ui__drawings .trigger.venues-ui-button--active .arrow {
  transform: rotate(90deg);
  transition: 0.4s;
}
.venues-ui__levels {
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__levels .levels {
  overflow: hidden;
}
.venues-ui__levels .venues-ui-button--up + .levels .venues-ui-button {
  border-radius: 0;
}
.venues-ui__levels .venues-ui-button:first-of-type {
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
}
.venues-ui__levels .venues-ui-button:last-of-type {
  border-bottom-left-radius: 5px;
  border-bottom-right-radius: 5px;
}
.venues-ui__levels .venues-ui-button[disabled=disabled] .arrow {
  opacity: 0.5;
}
.venues-ui__directory {
  position: absolute;
  top: 10px;
  right: 60px;
  bottom: calc(100% - 45px);
  width: 350px;
  overflow: hidden;
  background: white;
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__directory.active {
  bottom: 10px;
}
.venues-ui__directory .directory__list {
  top: 80px;
  bottom: 20px;
  position: absolute;
  overflow-y: scroll;
  right: 10px;
  left: 10px;
  font-size: 12px;
}
.venues-ui__directory .directory__list svg {
  width: 25px;
  height: 25px;
}
.venues-ui__directory .directory__heading {
  margin: 8px;
  font-size: 15px;
  font-weight: normal;
  cursor: pointer;
}
.venues-ui__directory .directory__input {
  margin: 10px;
}
.venues-ui__directory .directory__input input {
  width: 100%;
  padding: 5px 0;
}
.venues-ui__directory .directory__trigger {
  position: absolute;
  right: 10px;
  top: 15px;
  width: 10px;
  height: 10px;
}
.venues-ui__directory .directory__trigger .arrow {
  transform: rotate(0);
  transition: 0.4s;
}
.venues-ui__directory .directory__trigger--active .arrow {
  transform: rotate(-180deg);
  transition: 0.4s;
}`), e.Drawing = Q, e.Geometry = X2, e.Level = q, e.Provider = n, e.Route = Yt2, e.Service = Zt2, e.Service2 = Wt2, e.Venue = P2, e.ui = Kt2, Object.defineProperty(e, "__esModule", { value: true }), e;
  }({});
}).call(self);
var mapsjs_bundle_default = H;
export {
  mapsjs_bundle_default as default
};
//# sourceMappingURL=@here_maps-api-for-javascript.js.map
